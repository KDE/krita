cli_noarg :
-v + -version
-e[] "[gmic] No commands, options or data provided (type 'gmic -h' to get help)."
-if {@{!,u}>0} -e[] "[gmic] Running in demo mode." -v - -demo , -e[] ""
-else -e[] "\n"
-endif -v -
cli_start :
h :
-help $*
help : -skip ${1=""},${2=1}
-if {!@#} -return -endif
-y -a y
--_help $1,$2 -k[0]
-if {narg(@{})} -_help[0] @{},0 -endif
-rm
_help : -skip ${1=""}
-v -1 -use_vt100
-if {!narg("$1")} _is_example=0 -__help ascii -v + -e[] "" -v - -rm -u "" -return -endif
({'"$1"'}) -autocrop[-1] {'-'}
-if {@{-1,100%}=={']'}" && "i!={'['}} -l[-1] -s -,{'['} -k[0] -endl -endif
command=@{-1,t} -rm[-1]
ks0="0" ks1="-k[0]"
-if $2 -__help_header_ascii[] -endif
-r 1,{h+1},1,1,0,0,0,1
-s +,{'"#@gmic "$command" :"'} -s +,{'"#@gmic "$command":"'} -s +,{'"#@gmic "$command"\n"'}
-if {@#==1}
-l[] -m "foo : -"$command
-repeat 16 -uncommand $command -done
-foo -uncommand foo
-onfail ({'@{}'}) -s -,{'" (did you mean "'} -if {@#>1} -s[1] -,39 -k[1] misspelling=@{-1,t} -endif -rm
-endl
-if {narg($misspelling)} misspelling=" (did you mean '"$misspelling"' ?)" -endif
-v + -e[] "\n[gmic] Command '"$command"' has no description"$misspelling". Try 'gmic -h' for global help.\n\n" -v -
-rm -u "" -return
-endif
-rm[0] -a y -s -,10
stopflag=0
_is_example=0
-_document_gmic_header_ascii[] 0
-repeat @# -l[$>] -if {h>7" && "{@{-1,0-5}'=='{'"#@gmic"'}}}
-rows 7,100% -autocrop {'" "'}
-if {i!={':'}}
-s -,{'": "'} -autocrop {'" "'} -autocrop {':'} -autocrop {'" "'}
-if {@{0,t}'=='$command}
-_document_gmic_declaration_ascii
-if $_shortcut
-v + -e[] "\n    "$_gmic_m$_gmic_b"-"$command":"$_gmic_n$_gmic_m" Equivalent to '"$_gmic_b$_shortcutlink0$_gmic_n"'." -v -
-u $_shortcutlink0 -return
-endif
-else stopflag=1
-endif
-else
-rows 1,100%
-if {i=={':'}} stopflag=1
-else
_is_tutorial=
-autocrop {'" "'}
-if {i=={'$'}}
-rows 1,100% -autocrop {'" "'}
-if {i=={'$'}}
-v + -e[] "" -v -
-if {h==1&&i=={'$'}} tuturl=http://gmic.eu/tutorial/_$command.shtml
-else -autocrop {'$'} -autocrop {'" "'} tuturl=http://gmic.eu/tutorial/@{0,t}.shtml
-endif
-rm ({'$_gmic_c${_gmic_b}"Tutorial:"$_gmic_n$_gmic_c" "$tuturl'}) -y
_is_tutorial=1
-else
-if $_is_example -i[0] ({'"         "'})
-else -i[0] ({'"\n        "$_gmic_c${_gmic_b}"Example: "$_gmic_n$_gmic_c'}) _is_example=1 -endif
-y[0] -a y
-endif
-endif
-_document_gmic_description_ascii
-endif
-endif
-else stopflag=1 -endif ${ks{@#!=0}} -endl -if $stopflag -break -endif -done
-v + -e[] $_gmic_n"\n" -v - -rm
-u ""
__help :
-m "_help_section : -_help_section_$1 \"$""1\""
-m "_help_paragraph : -_help_paragraph_$1 \"$""1\""
-_help_header_$1[]
-_help_usage[]
-s -,{'__help_end\ :'} -k[0]
-document_gmic $1,"img/",0
-_help_examples[]
-_help_footer_$1[]
_help_usage :
-m "GMIC : -u ${_gmic_g}G\47MIC$_gmic_n"
g=$_gmic_g c=$_gmic_c n=$_gmic_n
-_help_paragraph " "$c${b}"gmic [command1 [arg1_1,arg1_2,..]] .. [commandN [argN_1,argN_2,..]]"$n"
\n
\n '"${g}"gmic"$n"' is an open-source interpreter of the "@{-GMIC}" language, a script-based programming
\n  language dedicated to the design of "${g}"image processing pipelines"$n". It can be used to convert,
\n  manipulate, filter and visualize datasets made of one or several 1d/2d or 3d multi-
\n  spectral images.
\n
\n This documentation proposes a complete description of the "@{-GMIC}" language basics and rules."
-_help_section "Overall context"
-_help_paragraph "  - At any time, "@{-GMIC}" manages one list of numbered (and optionally named) pixel-based
\n     images, entirely stored in computer memory.
\n  - The first image of the list has indice '0' and is denoted by '"$c"[0]"$n"'. The second image of
\n     the list is denoted by '"$c"[1]"$n"', the third by '"$c"[2]"$n"' and so on.
\n  - Negative indices are treated in a periodic way: '"$c"[-1]"$n"' refers to the last image of the
\n     list, '"$c"[-2]"$n"' to the penultimate one, etc. Thus, if the list has 4 images, '"$c"[1]"$n"' and '"$c"[-3]"$n"'
\n     both designate the second image of the list.
\n  - A named image may be indicated by '"$c"[name]"$n"', if 'name' uses the characters set [a-zA-Z0-9_] and
\n     does not start with a number. Image names can be set or reassigned at any moment during
\n     the processing pipeline (see commands '"$c"-name"$n"' and '"$c"-input"$n"' for this purpose).
\n  - "@{-GMIC}" defines a set of various commands and substitution mechanisms to allow the design
\n     of complex pipelines managing this list of images, in a very flexible way:
\n     You can insert or remove images in the list, rearrange image indices, process images
\n     (individually or as a group), merge image data together and output image files.
\n  - Such a pipeline can be written itself as a custom "@{-GMIC}" command storable in a custom
\n     commands file, and can be re-used afterwards in another bigger pipeline if necessary."
-_help_section "Image definition and terminology"
-_help_paragraph "  - In "@{-GMIC}", an image is modeled as a 1d, 2d, 3d or 4d array of scalar values, uniformly
\n     discretized on a rectangular/parallelepipedic domain.
\n  - The four dimensions of these arrays are respectively denoted by:
\n    . '"${g}"width"$n"', the number of image columns (size along the "$g"'x'-axis"$n").
\n    . '"${g}"height"$n"', the number of image rows (size along the "$g"'y'-axis"$n").
\n    . '"${g}"depth"$n"', the number of image slices (size along the "$g"'z'-axis"$n").
\n        The depth is equal to 1 for usual 2d color or grayscale images.
\n    . '"${g}"spectrum"$n"', the number of image channels (size along the "$g"'c'-axis"$n").
\n        The spectrum is respectively equal to 3 and 4 for usual RGB and RGBA color images.
\n  - There are no limitations on the size of each image dimension. For instance, the number of image
\n     slices or channels can be of arbitrary size within the limits of available memory.
\n  - The "${g}"width, height"$n" and "${g}"depth"$n" of an image are considered as '"${g}"spatial"$n"' dimensions, while the
\n     "${g}"spectrum"$n" has a '"${g}"multi-spectral"$n"' meaning. Thus, a 4d image in "@{-GMIC}" should be most often
\n     regarded as a 3d dataset of multi-spectral voxels. Most of the "@{-GMIC}" commands will stick
\n     with this idea (e.g. command '-blur' will blur images only along the 'xyz' axes).
\n  - "@{-GMIC}" internally stores all its images as buffers of '"${g}"float"$n"' values (32 bits,
\n    value range "$g"[-3.4E38,+3.4E38]"$n"). It performs all its image processing operations with
\n    floating point numbers. Each image pixel is thus represented with 32bits/channel.
\n  - Considering '"${g}"float"$n"'-valued pixels ensure to keep the numerical precision when executing image
\n     processing pipelines. For image input/output operations, you may want to prescribe the image
\n     datatype to be different than '"${g}"float"$n"' (like '"${g}"bool"$n"', '"${g}"char"$n"', '"${g}"int"$n"', etc...).
\n     This is possible by specifying the desired datatype as a file option when using I/O commands."
-_help_section "Items of a processing pipeline"
-_help_paragraph "  - In "@{-GMIC}", an image processing pipeline is described as a "${g}"sequence of items"$n" separated by
\n     the space character ' '. Such items are interpreted and executed from the left to the
\n     right. For instance, the expression:
\n\n       "${c}"input.jpg -blur 3,0 -sharpen 10 -resize 200%,200% -output output.jpg"$n"\n
\n     defines a valid pipeline composed of nine "@{-GMIC}" items.
\n  - Each "@{-GMIC}" item is a string which represents either a command, a sequence of command arguments,
\n     a filename, or a special input string.
\n  - Escape characters '"$g"\\"$n"' and double quotes '"$g"\""$n"' can be used to define items containing
\n     spaces or special characters. For instance, the two strings
\n     '"${c}"single\\ item"$n"' and '"${c}"\"single item\""$n"' define the same item, with a space in it."
-_help_section "Input data items"
-_help_paragraph "  - If a specified "@{-GMIC}" item appears to be an existing "${g}"filename"$n", the corresponding image
\n     data are loaded and inserted at the end of the image list.
\n  - Special filenames '"$g"-"$n"' and '"$g"-.ext"$n"' stand for the standard input/output streams, optionally
\n     forced to be in a specific '"${g}"ext"$n"' file format (e.g. '"$c"-.jpg"$n"' or '"$c"-.png"$n"').
\n  - The following special input strings may be used as "@{-GMIC}" items to create and insert new
\n     images with prescribed values, at the end of the image list:
\n    . '"$g"[selection]"$n"' or '"$g"[selection]xN"$n"': Insert 1 or N copies of selected existing images.
\n       '"${g}"selection"$n"' may contain one or several images (see next section for details).
\n    . '"${g}"width[%],_height[%],_depth[%],_spectrum[%],_values"$n"': Insert a new image with
\n       specified size and values (adding '"$g"%"$n"' to a dimension means 'percentage of the size
\n       along the same axis, taken from the last image '"$g"[-1]"$n"''). Any specified dimension
\n       can be also written as '"$g"[image]"$n"', and is then set to the size (along the same axis)
\n       of the existing specified image "$g"[image]"$n". '"${g}"values"$n"' can be either a sequence of numbers
\n       separated by commas '"$g","$n"', or a mathematical expression, as e.g. in input item
\n       '"${c}"256,256,1,3,if(c==0,x,if(c==1,y,0))"$n"' which creates a 256x256 RGB color image with a
\n       spatial shading on the red and green channels.
\n    . '"$g"(v1,v2,..)"$n"': Insert a new image from specified prescribed values.
\n       Value separator inside parentheses can be '"$g","$n"' (column separator), '"$g";"$n"' (row sep.),
\n       '"$g"/"$n"' (slice sep.) or '"$g"^"$n"' (channel sep.). For instance, expression
\n       '"$c"(1,2,3;4,5,6;7,8,9)"$n"' creates a 3x3 matrix (scalar image), with values running from 1 to 9.
\n    . '"${g}"0"$n"': Insert a new 'empty' image, containing no pixel data. Empty images are used only
\n       in rare occasions.
\n  - Input item '"${g}"name=value"$n"' declares a new local or global variable '"${g}"name"$n"', or assign a new
\n     value to an existing variable. Variable names use characters set [a-zA-Z0-9_] and cannot
\n     start with a number. A variable definition is always local to the current command except
\n     when it starts by the underscore character '"${g}"_"$n"'. In that case, it becomes also accessible
\n     by any command invoked outside the current command scope (global variable).
\n  - If the name of a variable starts with two underscores '"${g}"__"$n"', the global variable is also shared
\n     among different threads and can be read/set by commands running in parallel (see command
\n     '-parallel'). Otherwise, it remains local to the thread that defined it."
-_help_section "Command items and selections"
-_help_paragraph "  - A "@{-GMIC}" item starting by '"$g"-"$n"' designates a "${g}"command"$n", most of the time. Generally, commands
\n     perform image processing operations on one or several available images of the list.
\n  - Very common commands have two equivalent names ("${g}"regular"$n" and "${g}"short"$n"). For instance, command
\n     names '"$c"-resize"$n"' and '"$c"-r"$n"' refer to the same image resizing action.
\n  - A "@{-GMIC}" command may have mandatory or optional "${g}"arguments"$n". Command arguments must be
\n     specified in the next item on the command line. Commas '"$g","$n"' are used to separate multiple
\n     arguments when required.
\n  - The execution of a "@{-GMIC}" command may be restricted only to a "${g}"subset"$n" of the image list, by
\n     appending '"$c"[selection]"$n"' to the command name. Examples of valid syntaxes for '"${g}"selection"$n"' are:
\n    . '"$c"-com[0,1,3]"$n"': Apply command only on images "$g"[0],[1]"$n" and "$g"[3]"$n".
\n    . '"$c"-com[3-5]"$n"': Apply command only on images "$g"[3]"$n" to "$g"[5]"$n" (i.e, "$g"[3],[4]"$n" and "$g"[5]"$n").
\n    . '"$c"-com[50%-100%]"$n"': Apply command only on the second half of the image list.
\n    . '"$c"-com[0,-4--1]"$n"': Apply command only on the first and the four latest images.
\n    . '"$c"-com[0-9:3]"$n"': Apply command only on images "$g"[0]"$n" to "$g"[9]"$n", with a step of 3
\n                      (i.e. on images "$g"[0], [3], [6]"$n" and "$g"[9]"$n").
\n    . '"$c"-com[0--1:2]"$n"': Apply command only on images of the list with even indices.
\n    . '"$c"-com[0,2-4,50%--1]"$n"': Apply command on images "$g"[0],[2],[3],[4]"$n" and on the second half
\n                             of the image list.
\n    . '"$c"-com[^0,1]"$n"': Apply command on all images except the first two.
\n    . '"$c"-com[name1,name2]"$n"': Apply command on named images '"${g}"name1"$n"' and '"${g}"name2"$n"'.
\n  - Indices in selections are always sorted in "${g}"increasing order"$n", and duplicate indices are
\n     discarded. For instance, selections '"$c"[3-1,1-3]"$n"' and '"$c"[1,1,1,3,2]"$n"' are both equivalent to
\n     '"$c"[1-3]"$n"'. If you want to repeat a single command multiple times on an image, use a
\n     '"$c"-repeat..-done"$n"' loop. Inverting the order of images for a command is achieved by
\n     explicitely inverting  the order of the images in the list, with command '"$c"-reverse[selection]"$n"'.
\n  - "@{-GMIC}" commands invoked without '"$c"[selection]"$n"' are applied on "${g}"all images"$n" of the list, i.e.
\n     default selection is '"$c"[0--1]"$n"' (except for command '"$c"-input"$n"' whose default selection is '"$c"[-1]"$n"').
\n  - A "@{-GMIC}" command starting with '"$g"--"$n"' instead of '"$g"-"$n"' does not act 'in-place' but inserts its
\n     result as one or several new images at the end of the image list.
\n  - There are two different types of commands that can be run by the "@{-GMIC}" interpreter:
\n    . "${g}"Native commands"$n", are hard-coded functionalities in the interpreter core.
\n       They are thus compiled as machine code and "${g}"run faster"$n", most of the time.
\n       Omitting an argument when invoking a native command is not permitted, except if all
\n       following arguments are also omitted. For instance, call to '"$c"-plasma 10,,5"$n"' is invalid
\n       but '"$c"-plasma 10"$n"' is correct.
\n    . "${g}"Custom commands"$n", are defined as "@{-GMIC}" pipelines of native or custom commands.
\n       They are interpreted by the "@{-GMIC}" interpreter, and thus "${g}"run a bit slower"$n" than native commands.
\n       But omitting arguments when invoking a custom command is permitted. For instance,
\n       expressions '"$c"-flower ,,,100,,2"$n"' or '"$c"-flower ,"$n"' are correct.
\n  - Most of the existing commands available in "@{-GMIC}" are actually "${g}"custom commands"$n".
\n  - A user may easily add its own custom commands to the "@{-GMIC}" interpreter (see section
\n     "${c}"'Adding custom commands"$n"'). Native commands cannot be added unless you modify the "@{-GMIC}"
\n     interpreter source code."
-_help_section "Inputs/outputs properties"
-_help_paragraph "  - "@{-GMIC}" is able to read/write most of the classical image file formats, including:
\n    . 2d grayscale/color files: "$g".png, .jpeg, .gif, .pnm, .tif, .bmp, .."$n"
\n    . 3d volumetric files: "$g".dcm, .hdr, .nii, .pan, .inr, .pnk, .."$n"
\n    . video files: "$g".mpeg, .avi, .mov, .ogg, .flv, .."$n"
\n    . Generic ascii or binary data files: "$g".gmz, .cimg, .cimgz, .dlm, .asc, .pfm, .raw, .txt, .h."$n"
\n    . 3d object files: "$g".off."$n"
\n  - When dealing with color images, "@{-GMIC}" generally reads, writes and displays data using the
\n     usual RGB color space.
\n  - "@{-GMIC}" is able to manage "${g}"3d objects"$n" that may be read from files or generated by "@{-GMIC}"
\n     commands. A 3d object is stored as a one-column scalar image containing the object data, in the
\n     following order: "$g"{ magic_number; sizes; vertices; primitives; colors; opacities }"$n".
\n     These 3d representations can be processed as regular images.
\n     (see command '"$c"-split3d"$n"' for accessing each of these 3d object data separately).
\n  - Be aware that usual file formats may be sometimes not adapted to store all the available
\n     image data, since "@{-GMIC}" consider float-valued image pixels. For instance, saving
\n     an image that was initially loaded as a 16bits/channel image, as a "$g".jpg"$n" file will result
\n     in loss of information. Use the "$g".gmz"$n" file extension to ensure that all data precision
\n     will be preserved when saving images.
\n  - File options can/must be set for these specific file formats:
\n    . "${g}"Video files:"$n" Only sub-frames of an image sequence may be loaded, using the input
\n       expression '"${c}"filename.ext,[first_frame[,last_frame[,step]]]"$n"'.
\n       Set 'last_frame==-1' to tell it must be the last frame of the video.
\n       Set 'step' to 0 to force an opened video file to be opened/closed.
\n       Output framerate and codec can be also set by using the output expression
\n       '"${c}"filename.avi,_fps,_codec,_keep_open={ 0 | 1 }"$n"'.
\n       'codec' is a 4-char string (see http://www.fourcc.org/codecs.php) or '0' for the default codec.
\n       'keep_open' tells if the output video file must be kept open for appending new frames afterwards.
\n    . "$g".cimg[z] files:"$n" Only crops and sub-images of .cimg files can be loaded, using the input
\n      expressions '"${c}"filename.cimg,N0,N1"$n"', '"${c}"filename.cimg,N0,N1,x0,x1"$n"',
\n      '"${c}"filename.cimg,N0,N1,x0,y0,x1,y1"$n"', '"${c}"filename.cimg,N0,N1,x0,y0,z0,x1,y1,z1"$n"' or
\n      '"${c}"filename.cimg,N0,N1,x0,y0,z0,c0,x1,y1,z1,c1"$n"'.
\n      Specifying '"${g}"-1"$n"' for one coordinates stands for the maximum possible value.
\n      Output expression '"${c}"filename.cimg[z][,datatype]"$n"' can be used to force the output pixel type.
\n      '"${c}"datatype"$n"' can be "$c"{ uchar | char | ushort | short | uint | int | ulong | long | float | double }"$n".
\n    . "$g".raw binary files:"$n" Image dimensions and input pixel type may be specified when loading
\n       "$g".raw"$n" files with input expresssion '"${c}"filename.raw[,datatype][,width][,height[,depth[,dim]]]]"$n"'.
\n       If no dimensions are specified, the resulting image is a one-column vector with
\n       maximum possible height. Pixel type can also be specified with the output
\n       expression '"${c}"filename.raw[,datatype]"$n"'.
\n       '"${c}"datatype"$n"' can be "$c"{ uchar | char | ushort | short | uint | int | ulong | long | float | double }"$n".
\n    . "$g".yuv files:"$n" Image dimensions must be specified, and only sub-frames of an image
\n       sequence may be loaded, using the input expression
\n      '"${c}"filename.yuv,width,height[,first_frame[,last_frame[,step]]]"$n"'.
\n    . "$g".tiff files:"$n" Only sub-images of multi-pages tiff files can be loaded, using the input
\n       expression '"${c}"filename.tif,[first_frame,[last_frame,[step]]]"$n"'.
\n       Output expression '"${c}"filename.tiff,[datatype[,compression[,force_multipage]]"$n"' can be used to specify the
\n       output pixel type, as well as the compression method. '"${c}"compression"$n"' can be "$c"{ none | lzw | jpeg }"$n"
\n       and '"${c}"force_multipage"$n" can be { 0=no | 1=yes }.
\n      '"${c}"datatype"$n"' can be "$c"{ uchar | char | ushort | short | uint | int | ulong | long | float | double }"$n".
\n    . "$g".gif files:"$n" Animated gif files can be saved, using the input expression
\n      '"${c}"filename.gif,fps,nb_loops"$n"'.
\n       Specify '"${c}"nb_loops=0"$n"' to get an infinite number of animation loops.
\n    . "$g".jpeg files:"$n" The output quality may be specified (in %), using the output expression
\n       '"${c}"filename.jpg,30"$n"' (here, to get a 30% quality output).
\n    . "$g".mnc files:"$n" The output header can set from another file, using the output expression
\n       '"${c}"filename.mnc,header_template.mnc"$n"'.
\n    . "$g".pan, .cpp, .hpp, .c and .h files:"$n" The output datatype can be selected with output expression
\n       '"${c}"filename[,datatype]"$n"'.
\n      '"${c}"datatype"$n"' can be "$c"{ uchar | char | ushort | short | uint | int | ulong | long | float | double }"$n".
\n    . "$g".gmic files:"$n" These filenames are assumed to be "@{-GMIC}" custom commands files. Loading
\n       such a file will add the commands it defines to the interpreter. Debug infos can be
\n       enabled/disabled by the input expression '"${c}"filename.gmic,add_debug_infos={ 0 | 1 }"$n"'.
\n    . Inserting '"${g}"ext:"$n"' on the beginning of a filename (e.g. '"${c}"jpg:filename"$n"') forces "@{-GMIC}" to
\n       read/write the file as it would have been done if it had the specified extension.
\n  - Some input/output formats and options may not be supported by your current version of
\n     '"${g}"gmic"$n"', depending on the configuration flags set during the build of the '"${g}"gmic"$n"' binaries."
-_help_section "Substitution rules"
-_help_paragraph "  - "@{-GMIC}" items containing '"$g"@"$n"', '"$g"$"$n"' or '"$g"{}"$n"' may be substituted before being interpreted. Use
\n     the substituting expressions below to access data from the interpreter environment:
\n    . '"$c"@#"$n"' is substituted by the current "${g}"number of images"$n" in the list.
\n    . '"$c"@*"$n"' is substituted by the number of "${g}"available cpus"$n".
\n    . '"$c"@."$n"' is substituted by the current "${g}"version number"$n" of the "@{-GMIC}" interpreter
\n    . '"$c"@^"$n"' is substituted by the current "${g}"verbosity level"$n".
\n    . '"$c"@%"$n"' is substituted by the "${g}"pid"$n" of the current process.
\n    . '"$c"@|"$n"' is substituted by the current value (expressed in seconds) of a "${g}"millisecond
\n       precision timer"$n".
\n    . '"$c"@/"$n"' is substituted by the current "${g}"number of levels in the command scope"$n".
\n    . '"$c"@{/}"$n"' or '"$c"@{/,subset}"$n"' are substituted by the content of the "${g}"global scope"$n", or a
\n       subset of it. If specified subset refers to multiple scope items, they are separated
\n       by slashes '"$g"/"$n"'.
\n    . '"$c"@>"$n"' and '"$c"@<"$n"' are equivalent. They are both substituted by "${g}"the number of nested
\n       'repeat-done' loops"$n" that are currently running.
\n    . '"$c"@{>}"$n"' or '"$c"@{>,subset}"$n"' are substituted by the indice values (or a subset of them) of
\n       the running 'repeat-done' loops, expressed in the ascending order, starting from 0.
\n       If specified subset refers to multiple indices, they are separated by commas '"$g","$n"'.
\n    . '"$c"@{<}"$n"' or '"$c"@{<,subset}"$n"' do the same but in descending order.
\n    . '"$c"@indice"$n"' or '"$c"@{indice,feature}"$n"' are substituted by the "${g}"list of pixel values"$n" of the
\n       image "$c"[indice]"$n" (separated by commas), or by a "${g}"specific feature (or subset)"$n" of it.
\n       '"${g}"indice"$n"' denotes either a numbered image indice or an image name. Requested '"${g}"feature"$n"' can be one of:
\n         . '"${g}"w"$n"': image width (number of image columns).
\n         . '"${g}"h"$n"': image height (number of image rows).
\n         . '"${g}"d"$n"': image depth (number of image slices).
\n         . '"${g}"s"$n"': image spectrum (number of image channels).
\n         . '"${g}"wh"$n"': image width x image height.
\n         . '"${g}"whd"$n"': image width x image height x image depth.
\n         . '"${g}"whds"$n"': image width x image height x image depth x image spectrum.
\n                   (i.e. number of values in the specified image, eq. to '#').
\n         . '"${g}"r"$n"': image shared state (1, if the pixel buffer is shared, 0 otherwise).
\n         . '"${g}"n"$n"': image name or filename (if the image has been read from a file).
\n         . '"${g}"b"$n"': image basename (i.e. filename without the folder path nor extension).
\n         . '"${g}"x"$n"': image extension (i.e last characters after the last '.' in the filename).
\n         . '"${g}"f"$n"': image folder name.
\n         . '"$g"#"$n"': number of image values (i.e. width x height x depth x spectrum).
\n         . '"$g"+"$n"': sum of all pixel values.
\n         . '"$g"-"$n"': difference of all pixel values.
\n         . '"$g"*"$n"': product of all pixel values.
\n         . '"$g"/"$n"': quotient of all pixel values.
\n         . '"${g}"m"$n"': minimum pixel value.
\n         . '"${g}"M"$n"': maximum pixel value.
\n         . '"${g}"a"$n"': average pixel value.
\n         . '"${g}"v"$n"': variance of pixel values.
\n         . '"${g}"t"$n"': text string built from the image values, regarded as ascii codes.
\n         . '"${g}"c"$n"': (x,y,z,c) coordinates of the minimum value, separated by commas ','.
\n         . '"${g}"C"$n"': (x,y,z,c) coordinates of the maximum value, separated by commas ','.
\n         . '"$g"(x[%],_y[%],_z[%],_c[%],_boundary)"$n"': pixel value at "$g"(x[%],y[%],z[%],c[%])"$n", with
\n            specified boundary conditions "$c"{ 0=dirichlet | 1=neumann | 2=periodic }"$n".
\n         . Any other '"${g}"feature"$n"' is considered either as a specified "${g}"subset of image values"$n", or
\n            as a "${g}"mathematical expression"$n" which is evaluated (associated to the selected image).
\n            For instance, '"$c"@{-1,0-50%}"$n"' is substituted by the sequence of numerical values
\n            coming from the first half data of the last image, separated by commas '"$g","$n"'.
\n            Expression '"$c"@{0,w+h}"$n"' is substituted by the sum of the width and height of the
\n            first image.
\n    . '"$c"@!"$n"' is substituted by the "${g}"visibility state"$n" of the instant display window "$c"[0]"$n"
\n       (can be "$c"{ 0=closed | 1=visible }"$n").
\n    . '"$c"@{!,feature}"$n"' or '"$c"@{!indice,feature}"$n"' is substituted by a "${g}"specific feature"$n" of the
\n       instant display window "$c"[0]"$n" (or "$c"[indice]"$n", if specified). Requested '"${g}"feature"$n"' can be:
\n         . '"${g}"w"$n"': display width (i.e. width of the display area managed by the window).
\n         . '"${g}"h"$n"': display height (i.e. height of the display area managed by the window).
\n         . '"${g}"wh"$n"': display width x display height.
\n         . '"${g}"d"$n"': window width (i.e. width of the window widget).
\n         . '"${g}"e"$n"': window height (i.e. height of the window widget).
\n         . '"${g}"de"$n"': window width x window height.
\n         . '"${g}"u"$n"': screen width (actually independent on the window size).
\n         .' "${g}"v"$n"': screen height (actually independent on the window size).
\n         . '"${g}"uv"$n"': screen width x screen height.
\n         . '"${g}"n"$n"': current normalization type of the instant display.
\n         . '"${g}"x"$n"': X-coordinate of the mouse position (or -1, if outside the display area).
\n         . '"${g}"y"$n"': Y-coordinate of the mouse position (or -1, if outside the display area).
\n         . '"${g}"b"$n"': state of the mouse buttons { 1=left-but. | 2=right-but. | 4=middle-but. }.
\n         . '"${g}"o"$n"': state of the mouse wheel.
\n         . '"${g}"k"$n"': decimal code of the pressed key if any, 0 otherwise.
\n         . '"${g}"c"$n"': boolean (0 or 1) telling if the instant display has been closed recently.
\n         . '"${g}"r"$n"': boolean telling if the instant display has been resized recently.
\n         . '"${g}"m"$n"': boolean telling if the instant display has been moved recently.
\n         . Any other '"${g}"feature"$n"' stands for a "${g}"keycode name"$n" (in capital letters), and is substi-
\n            tuted by a boolean describing the current key state "$c"{ 0=pressed | 1=released }"$n".
\n         . You can also prepend a dash '"$c"-"$n"' to a '"${g}"feature"$n"' (that supports it) to flush
\n            the corresponding event immediately after reading its state.
\n    . '"$c"@{\"command line\"}"$n"' is substituted by the "${g}"status value"$n" set by the execution of the
\n       specified command line (see command '"$c"-status"$n"' to learn more about status).
\n    . Expression '"$c"@{}"$n"' stands thus for the "${g}"current status value"$n".
\n  - '"$c"$name"$n"' and '"$c"${name}"$n"' are both substituted by the "${g}"value of the specified named variable"$n"
\n     (set previously by item '"${c}"name=value"$n"'), or by the current positive "${g}"indice of the named
\n     image '[name]'"$n", or by the value of the named "${g}"OS environment variable"$n" (evaluated in this order).
\n  - '"$c"$>"$n"' and '"$c"$<"$n"' (resp. '"$c"${>}"$n"' and '"$c"${<}"$n"') are shortcuts respectively for '"$c"@{>,-1}"$n"' and
\n     '"$c"@{<,-1}"$n"'. They refer to the "${g}"increasing/decreasing indice"$n" of the latest (currently running)
\n     '"${c}"repeat..done"$n"' loop.
\n  - Any other expression inside braces (as in '"$c"{expression}"$n"') is considered as a "${g}"mathematical
\n     expression"$n", and is evaluated, except for the three following cases:
\n    . If expression starts and ends by "${g}"single quotes"$n", it is substituted by the "${g}"sequence of
\n       ascii codes"$n" that composes the specified string, separated by commas '"$g","$n"'. For instance,
\n       item '"$c"{'foo'}"$n"' is substituted by '"${c}"102,111,111"$n"'.
\n    . If expression starts and ends with "${g}"backquotes"$n" '"$g"\47"$n"', it is substituted by the "${g}"string
\n       whose ascii codes are given by the list of values"$n" in between the backquotes.
\n       For instance, item '"$c"{`102,111,111`}"$n"' is substituted by '"${c}"foo"$n"'.
\n    . If expression contains operator '"$c"'=='"$n"' or '"$c"'!='"$n"', it is substituted by "${c}"0"$n" or "${c}"1"$n", whether
\n       the two strings beside the operator "${g}"are the same or not"$n" (case-sensitive). For instance,
\n       both items '"$c"{foo'=='foo}"$n"' and '"$c"{foo'!='FOO}"$n"' are substituted by '"${c}"1"$n"'.
\n    . If expression starts with an underscore '"$g"_"$n"', it is substituted by the mathematical
\n       evaluation of the expression, but "${g}"truncated to a readable format"$n". For instance,
\n       item '"$c"{_pi}"$n"' is substituted by '"${c}"3.14159"$n"' (while '"$c"{pi}"$n"' is '"${c}"3.141592653589793"$n"').
\n  - Item substitution is "${g}"never performed in items between double quotes"$n". One must break the quotes
\n    to enable substitution if needed, as in "$c"\"3+8 kg = \"{3+8}\" kg\""$n". Using double quotes
\n    is then a convenient way to "${g}"disable the substitutions mechanism"$n" in items, when necessary.
\n  - One can also disable the substitution mechanism on items outside double quotes, by
\n     "${g}"escaping"$n" the '"$g"@"$n"','"$g"{"$n"','"$g"}"$n"' or '"$g"$"$n"' characters, as in '"$c"\\{3+4\\}\\ doesn\47t\\ evaluate"$n"'."
-_help_section "Mathematical expressions"
-_help_paragraph "  - "@{-GMIC}" has an embedded "${g}"mathematical parser"$n". It is used to evaluate expressions inside
\n     braces '"$g"{}"$n"', or formulas in commands that may take one as an argument (e.g. '"$c"-fill"$n"').
\n  - When used as a command argument, a formula is evaluated "${g}"for each pixel"$n" of the selected images.
\n  - The mathematical parser understands the following set of functions, operators and variables:
\n    _ "${g}"Usual operators:"$n" "$c"||"$n" (logical or), "$c"&&"$n" (logical and), "$c"|"$n" (bitwise or), "$c"&"$n" (bitwise and),
\n       "$c"!=, ==, <=, >=, <, >, <<"$n" (left bitwise shift), "$c">>"$n" (right bitwise shift), "$c"-, +, *, /,
\n       %"$n" (modulo), "$c"^"$n" (power), "$c"!"$n" (logical not), "$c"~"$n" (bitwise not).
\n    _ "${g}"Usual functions:"$n" "${c}"sin(), cos(), tan(), asin(), acos(), atan(), sinh(), cosh(), tanh(),
\n       log(), log2(), log10(), exp(), sign(), abs(), atan2(), round(), narg(), arg(),
\n       isval(), isnan(), isinf(), isint(), isbool(), rol()"$n" (left bit rotation),
\n       "${c}"ror()"$n" (right bit rotation), "${c}"min(), max(), med(), kth(), sinc(), int()"$n".
\n       Function '"${c}"atan2()"$n"' is the version of '"${c}"atan()"$n"' with two arguments 'y' and 'x' (as in C/C++).
\n       Function '"${c}"narg()"$n"' returns the number of specified arguments.
\n       Function '"${c}"arg(i,a_1,..,a_n)"$n"' returns the ith argument a_i.
\n       Functions '"${c}"min()"$n"', '"${c}"max()"$n"', '"${c}"med()"$n"' and '"${c}"kth()"$n"' can be called with an arbitrary number of arguments.
\n       Functions '"${c}"isval()"$n"', '"${c}"isnan()"$n"', '"${c}"isinf()"$n"', '"${c}"isbool()"$n"' can be used to test the type of
\n       a given number or expression.
\n    _ "${g}"Variable names"$n" below are pre-defined. They can be overloaded.
\n         . '"${c}"w"$n"': width of the associated image, if any (0 otherwise).
\n         . '"${c}"h"$n"': height of the associated image, if any (0 otherwise).
\n         . '"${c}"d"$n"': depth of the associated image, if any (0 otherwise).
\n         . '"${c}"s"$n"': spectrum of the associated image, if any (0 otherwise).
\n         . '"${c}"x"$n"': current processed column of the associated image, if any (0 otherwise).
\n         . '"${c}"y"$n"': current processed row of the associated image, if any (0 otherwise).
\n         . '"${c}"z"$n"': current processed slice of the associated image, if any (0 otherwise).
\n         . '"${c}"c"$n"': current processed channel of the associated image, if any (0 otherwise).
\n         . '"${c}"e"$n"': value of e, i.e. 2.71828..
\n         . '"${c}"pi"$n"': value of pi, i.e. 3.1415926..
\n         . '"$c"?"$n"' or '"${c}"u"$n"': a random value between [0,1], following a uniform distribution.
\n         . '"${c}"g"$n"': a random value, following a gaussian distribution of variance 1
\n            (roughly in [-5,5]).
\n         . '"${c}"i"$n"': current processed pixel value (i.e. value located at (x,y,z,c)) of the
\n            associated image, if any (0 otherwise).
\n         . '"${c}"im"$n"','"${c}"iM"$n"','"${c}"ia"$n"','"${c}"iv"$n"','"${c}"ic"$n"': Respectively the minimum, maximum, average values,
\n            variance and median value of the associated image, if any (0 otherwise).
\n         . '"${c}"xm"$n"','"${c}"ym"$n"','"${c}"zm"$n"','"${c}"cm"$n"': The pixel coordinates of the minimum value in the associated
\n            image, if any (0 otherwise).
\n         . '"${c}"xM"$n"','"${c}"yM"$n"','"${c}"zM"$n"','"${c}"cM"$n"': The pixel coordinates of the maximum value in the
\n            associated image, if any (0 otherwise).
\n    _ "${g}"Special operators"$n" can be used:
\n         . '"$c";"$n"': expression separator. The returned value is always the last encountered
\n            expression. For instance expression '"${c}"1;2;pi"$n"' is evaluated as '"${c}"pi"$n"'.
\n         . '"$c"="$n"': variable assignment. Variables in mathematical parser can only refer to.
\n            numerical values. Variable names are case-sensitive. Use this operator in
\n            conjunction with '"$c";"$n"' to define complex evaluable expressions, such as
\n             '"${c}"t=cos(x);3*t^2+2*t+1"$n"'.
\n            These variables remain "${g}"local to the mathematical parser"$n" and cannot be accessed
\n            outside the evaluated expression.
\n    _ The following "${g}"specific functions"$n" are also defined:
\n         . '"${c}"if(expr_cond,expr_then,expr_else)"$n"': return value of '"${c}"expr_then"$n"' or '"${c}"expr_else"$n"',
\n            depending on the value of '"${c}"expr_cond"$n"' "${g}"(0=false, other=true)"$n". For instance,
\n            "@{-GMIC}" command '"${c}"-fill if(x%10==0,255,i)"$n"' will draw blank vertical lines on every
\n            10th column of an image.
\n         . '"$c"?(max)"$n"' or '"$c"?(min,max)"$n"': return a random value between "$g"[0,max]"$n" or "$g"[min,max]"$n",
\n            following a uniform distribution. '"${c}"u(max)"$n"' and '"${c}"u(0,max)"$n"' mean the same.
\n         . '"${c}"i(_a,_b,_c,_d,_interpolation,_boundary)"$n"': return the value of the pixel located
\n            at position "$g"(a,b,c,d)"$n" in the associated image, if any (0 otherwise).
\n            Interpolation parameter can be "$c"{ 0=nearest neighbor | other=linear }"$n".
\n            Boundary conditions can be "$c"{ 0=dirichlet | 1=neumann | 2=periodic }"$n".
\n            Omitted coordinates are replaced by their default values which are respectively
\n            "${c}"x, y, z, c"$n" and "${c}"0"$n".
\n         . '"${c}"j(_dx,_dy,_dz,_dc,_interpolation,_boundary)"$n"': does the same for the pixel located
\n            at position "$g"(x+dx,y+dy,z+dz,c+dc)"$n".
\n         . '"${c}"i[offset]"$n"': return the value of the pixel located at "${g}"specified offset"$n" in the associated
\n            image buffer.
\n         . '"${c}"j[offset]"$n"': does the same for an offset relative to the current pixel "$g"(x,y,z,c)"$n".
\n            For instance command '"${c}"-fill 0.5*(i(x+1)-i(x-1))"$n"' will estimate the X-derivative
\n            of an image with a classical finite difference scheme.
\n         . If specified formula starts with '"$c">"$n"' or '"$c"<"$n"', the operators '"${c}"i(..)"$n"' and '"${c}"j(..)"$n"' will return
\n            values of the image currently being modified, in forward ('"$c">"$n"') or backward ('"$c"<"$n"') order.
\n  - The last image of the list is always associated to the evaluations of '"$c"{expressions}"$n"',
\n     e.g. "@{-GMIC}" sequence '"${c}"256,128 -f {w}"$n"' will create a 256x128 image filled with value 256."
-_help_section "Image and data viewers"
-_help_paragraph "  - "@{-GMIC}" has some very handy "${g}"embedded visualization modules"$n", for 1d signals
\n     (command '"$c"-plot"$n"'), 1d/2d/3d images (command '"$c"-display"$n"') and 3d objects
\n     (command '"$c"-display3d"$n"'). It enables an interactive view of the selected image data.
\n  - The following keyboard shortcuts are available in the interactive viewers:
\n    . "${g}"CTRL+D"$n": Increase window size.
\n    . "${g}"CTRL+C"$n": Decrease window size.
\n    . "${g}"CTRL+R"$n": Reset window size.
\n    . "${g}"CTRL+F"$n": Toggle fullscreen mode.
\n    . "${g}"CTRL+S"$n": Save current window snapshot as numbered file 'gmic_xxxx.bmp'.
\n    . "${g}"CTRL+O"$n": Save current instance of the viewed data, as numbered file 'gmic_xxxx.cimgz'.
\n  - Shortcuts specific to the 1d/2d/3d image viewer (command '"$c"-display"$n"') are:
\n    . "${g}"CTRL+A"$n": Switch cursor mode.
\n    . "${g}"CTRL+P"$n": Play z-stack of frames as a movie (for volumetric 3d images).
\n    . "${g}"CTRL+V"$n": Show/hide 3D view (for volumetric 3d images).
\n    . "${g}"CTRL+(mousewheel)"$n": Zoom in/out.
\n    . "${g}"SHIFT+(mousewheel)"$n": Go left/right.
\n    . "${g}"ALT+(mousewheel)"$n": Go up/down.
\n    . "${g}"Numeric PAD"$n": Zoom in/out (+/-) and move through zoomed image (digits).
\n    . "${g}"BACKSPACE"$n": Reset zoom scale.
\n  - Shortcuts specific to the 3d object viewer (command '"$c"-display3d"$n"') are:
\n    . "$g"(mouse)+(left mouse button)"$n": Rotate 3d object.
\n    . "$g"(mouse)+(right mouse button)"$n": Zoom 3d object.
\n    . "$g"(mouse)+(middle mouse button)"$n": Shift 3d object.
\n    . "$g"(mousewheel)"$n": Zoom in/out.
\n    . "${g}"CTRL+F1 .. CTRL+F6"$n": Toggle between different 3d rendering modes.
\n    . "${g}"CTRL+Z"$n": Enable/disable z-buffered rendering.
\n    . "${g}"CTRL+A"$n": Show/hide 3d axes.
\n    . "${g}"CTRL+G"$n": Save 3d object, as numbered file 'gmic_xxxx.off'.
\n    . "${g}"CTRL+T"$n": Switch between single/double-sided 3d modes."
-_help_section "Adding custom commands"
-_help_paragraph "  - Custom commands can be defined by a user, through the use of "@{-GMIC}" "${g}"custom commands files"$n".
\n  - A command file is a simple "${g}"ascii text file"$n", where each line starts either by
\n     '"${c}"command_name: command_definition"$n"' or '"${c}"command_definition (continuation)"$n"'.
\n  - At startup, "@{-GMIC}" automatically includes user's command file "$g"$HOME/.gmic"$n" (on Unix) or
\n     "$g"%APPDATA%/gmic"$n" (on Windows), and runs command '"${c}"-start"$n"' if defined.
\n  - Custom command names must use characters [a-zA-Z0-9_] and cannot start with a number.
\n  - Any '"$c" \# comment"$n"' expression found in a custom commands file is "${g}"discarded"$n" by the "@{-GMIC}"
\n     parser, wherever it is located in a line.
\n  - In a custom command, the following "$g"$-expressions"$n" are substituted:
\n    . '"$c"$""\*"$n"' is substituted by a copy of the specified string of arguments.
\n    . '"$c"$\"*\""$n"' is substituted by a copy of the specified string of arguments, each being double-quoted.
\n    . '"$c"$""\#"$n"' is substituted by the maximum indice of known arguments (either specified by the
\n       user or set to a default value in the custom command).
\n    . '"$c"$""?"$n"' is substituted by a string telling about the command subset restriction (only
\n       useful when custom commands need to output descriptive messages).
\n    . '"$c"$i"$n"' and '"$c"${i}"$n"' are both substituted by the i-th specified argument. Negative indices
\n       such as '"$c"${-j}"$n"' are allowed and refer to the j^th latest argument. '"$c"$""0"$n"' is substituted
\n       by the custom command name.
\n    . '"$c"${i=default}"$n"' is substituted by the value of $i (if defined) or by its new value set
\n        to '"${g}"default"$n"' otherwise ('"${g}"default"$n"' may be a $-expression as well).
\n    . '"$c"${subset}"$n"' is substituted by the arguments values (separated by commas '"$g","$n"') of a
\n       specified argument subset. For instance expression '"$c"$""{2--2}"$n"' is substitued by all
\n       specified arguments except the first and the last one. Expression '"$c"$""{^0}"$n"' is then
\n       substituted by all arguments of the invoked command (eq. to '"$c"$""*"$n"' if all specified
\n       arguments have indeed a value).
\n    . '"$c"$""=var"$n"' is substituted by the set of instructions that will assign each argument "$c"$i"$n"
\n       to the named variable '"${c}"var$i"$n"' (for i in "$g"[0..$""\#]"$n"). This is particularly useful when a
\n       custom command want to manage variable numbers of arguments. Variables names must
\n       use characters [a-zA-Z0-9_] and cannot start with a number.
\n  - These particular "$g"$-expressions"$n" are "${g}"always substituted"$n", even in double quoted items or
\n     when the dollar sign '"$g"$"$n"' is escaped with a backslash '"$g"\\"$n"'. To avoid substitution, place
\n     an empty double quoted string just after the '"$g"$"$n"' (as in '"$c"$\"\"1"$n"').
\n  - Specifying arguments may be skipped when invoking a custom command, by replacing them by
\n     commas '"$g","$n"' as in expression '"${c}"-flower ,,3"$n"'. Omitted arguments are set to their default
\n     values, which must be thus explicitly defined in the code of the corresponding custom
\n     command (using default argument expressions as '"$c"$""{1=default}"$n"').
\n  - If one numbered argument required by a custom command does not have a value, an error is
\n     thrown by the interpreter."
-_help_section "List of commands"
-_help_paragraph " All available "@{-GMIC}" commands are listed below, classified by themes.
\n When several choices of command arguments are possible, they appear separated by '"$g"|"$n"'.
\n An argument specified inside '"$g"[]"$n"' or starting by '"$g"_"$n"' is optional except when standing for an
\n existing image "$c"[image]"$n", where '"${g}"image'"$n"' can be either an indice number or an image name.
\n In this case, the '"$g"[]"$n"' characters are mandatory when writing the item.
\n A command marked with '"$g"(+)"$n"' is a "${g}"native"$n" command.
\n Note also that all images that serve as illustrations in this reference documentation are normalized
\n in "$g"[0,255]"$n" before being displayed. You may need to do this manually (command '"$c"-normalize 0,255"$n"') if you
\n want to save image files having the same aspect than those illustrated in the example codes."
_help_examples :
g=$_gmic_g c=$_gmic_c n=$_gmic_n
-_help_section "Examples of use"
-_help_paragraph " '"${g}"gmic"$n"' is a generic image processing tool which can be used in a wide variety of situations.
\n The few examples below illustrate possible uses of this tool:
\n
\n  - View a list of images:
\n     "${c}"gmic file1.bmp file2.jpeg"$n"
\n
\n  - Convert an image file:
\n     "${c}"gmic input.bmp -o output.jpg"$n"
\n
\n  - Create a volumetric image from a movie sequence:
\n     "${c}"gmic input.mpg -a z -o output.hdr"$n"
\n
\n  - Compute image gradient norm:
\n     "${c}"gmic input.bmp -gradient_norm"$n"
\n
\n  - Denoise a color image:
\n     "${c}"gmic image.jpg -denoise 30,10 -o denoised.jpg"$n"
\n
\n  - Compose two images using overlay layer blending:
\n     "${c}"gmic image1.jpg image2.jpg -blend overlay -o blended.jpg"$n"
\n
\n  - Evaluate a mathematical expression:
\n     "${c}"gmic -e \"cos(pi/4)^2+sin(pi/4)^2={cos(pi/4)^2+sin(pi/4)^2}\""$n"
\n
\n  - Plot a 2d function:
\n     "${c}"gmic 1000,1,1,2 -f \"X=3*(x-500)/500;X^2*sin(3*X^2)+if(c==0,u(0,-1),cos(X*10))\" -plot"$n"
\n
\n  - Plot a 3d elevated function in random colors:
\n     "${c}"gmic 128,128,1,3,\"?(0,255)\" -plasma 10,3 -blur 4 -sharpen 10000 \\\
\n      -elevation3d[-1] \"'X=(x-64)/6;Y=(y-64)/6;100*exp(-(X^2+Y^2)/30)*abs(cos(X)*sin(Y))'\""$n"
\n
\n  - Plot the isosurface of a 3d volume:
\n     "${c}"gmic -m3d 5 -md3d 5 -db3d 0 -isosurface3d \"'x^2+y^2+abs(z)^abs(4*cos(x*y*z*3))'\",3"$n"
\n
\n  - Render a "@{-GMIC}" 3d logo:
\n     "${c}"gmic 0 -text G\\\47MIC,0,0,53,1,1,1,1 -expand_xy 10,0 -blur 1 -n 0,100 --plasma 0.4 -+ \\\
\n      -blur 1 -elevation3d -0.1 -md3d 4"$n"
\n
\n  - Generate a 3d ring of torii:
\n     "${c}"gmic -repeat 20 -torus3d 15,2 -color3d[-1] \"{?(60,255)},{?(60,255)},{?(60,255)}\" \\\
\n      -*3d[-1] 0.5,1 -if \"{$>%2}\" -r3d[-1] 0,1,0,90 -endif -+3d[-1] 70 -+3d \\\
\n      -r3d 0,0,1,18 -done -md3d 3 -m3d 5 -db3d 0"$n"
\n
\n  - Create a vase from a 3d isosurface:
\n     "${c}"gmic -md3d 4 -isosurface3d \"'x^2+2*abs(y/2)*sin(2*y)^2+z^2-3',0\" -sphere3d 1.5 \\\
\n      --3d[-1] 0,5 -plane3d 15,15 -r3d[-1] 1,0,0,90 -center3d[-1] -+3d[-1] 0,3.2 \\\
\n      -color3d[-1] 180,150,255 -color3d[-2] 128,255,0 -color3d[-3] 255,128,0 -+3d"$n"
\n
\n  - Display filtered webcam stream:
\n     "${c}"gmic -apply_camera \\\"--mirror x --mirror y -+ -/ 4\\\""$n"
\n
\n  - Launch a set of "@{-GMIC}" interactive demos:
\n     "${c}"gmic -demo"$n"
\n"
_help_header_ascii :
-__help_header_ascii
_section=0 _space1="" _space2=" "
-_help_section "Usage"
__help_header_ascii :
-if {narg($_gmic_is_beta)} strbeta=" (beta)" -else strbeta="" -endif
-if {narg($_gmic_version)} strver=$_gmic_version -else strver=@{-strver} -endif
-v +
-e[] "
\n "${_gmic_b}"gmic: GREYC's Magic for Image Computing."$_gmic_n"
\n
\n        "$_gmic_r${_gmic_b}"Version "$strver$strbeta$_gmic_n", Copyright (c) 2008-2015, David Tschumperle.
\n        "$_gmic_r"(http://gmic.eu)"$_gmic_n
-v -
_help_section_ascii :
_section={$_section+1}
{narg({'"$1"'})},1,1,1,{'-'}
-v +
-e[] "\n "$_gmic_m$_gmic_b$_section". $1"
-e[] "    "${_space{narg({'$_section'})}}@{-1,t}$_gmic_n"\n"
-v -
-rm[-1]
_help_paragraph_ascii :
-v +
-e[] "$*"
-v -
_help_footer_ascii :
-v +
-e[] " "$_gmic_r$_gmic_b"** G\47MIC comes with ABSOLUTELY NO WARRANTY; for details visit: http://gmic.eu **"$_gmic_n
-v -
_help_header_html :
_section=0
-if {narg($_gmic_is_beta)} strbeta=" (beta)" -else strbeta="" -endif
-if {narg($_gmic_version)} strver=$_gmic_version -else strver=@{-strver} -endif
_gmic_n="</font></b>" _gmic_r="<b><font color=\"#900000\">" _gmic_g="<b><font color=\"#009000\">"
_gmic_m="<b><font color=\"#900090\">" _gmic_c="<b><font color=\"#005090\">"
-v +
-e[] "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">
\n<!--#include file=\"header.html\" -->
\n<link href=\"style.css\" rel=\"stylesheet\" type=\"text/css\">
\n<div id=\"bloc_option\">
\n<div id=\"top_rouge\"><div id=\"text_top\">Reference</div></div>
\n<div id=\"center\"><div id=\"text_centre_intro\">
\n<h2>Preamble</h2>
\n<ul>
\n<li>This document is distributed under the <a href=\"http://www.gnu.org/licenses/fdl-1.3.txt\">GNU Free Documentation License</a>, version 1.3.</li>
\n<li>A <a href=\"gmic_reference.pdf\">.pdf version</a> of this document is available.</li>
\n<li>We also suggest you read <a href=\"tutorial/index.shtml\">these tutorial pages</a> which provide a more user-friendly explanation of most of the G\47MIC basics.</li>
\n</ul>
\n<h2><a id=\"toc\">Table of contents</a></h2>
\n<ul>
\n<li><a href=\"#section0\">Version</a></li>
\n<li><a href=\"#section1\">Usage</a></li>
\n<ul>
\n<li><a href=\"#section2\">Overall context</a></li>
\n<li><a href=\"#section3\">Image definition and terminology</a></li>
\n<li><a href=\"#section4\">Items of a processing pipeline</a></li>
\n<li><a href=\"#section5\">Input data items</a></li>
\n<li><a href=\"#section6\">Command items and selections</a></li>
\n<li><a href=\"#section7\">Input/output properties</a></li>
\n<li><a href=\"#section8\">Substitution rules</a></li>
\n<li><a href=\"#section9\">Mathematical expressions</a></li>
\n<li><a href=\"#section10\">Image and data viewers</a></li>
\n<li><a href=\"#section11\">Adding custom commands</a></li>
\n</ul>
\n<li><a href=\"#section12\">List of commands</a></li>
\n<ul>
\n<li><a href=\"#subsection1\">Global options</a></li>
\n<li><a href=\"#subsection2\">Inputs/outputs</a></li>
\n<li><a href=\"#subsection3\">List manipulation</a></li>
\n<li><a href=\"#subsection4\">Mathematical operators</a></li>
\n<li><a href=\"#subsection5\">Values manipulation</a></li>
\n<li><a href=\"#subsection6\">Colors manipulation</a></li>
\n<li><a href=\"#subsection7\">Geometry manipulation</a></li>
\n<li><a href=\"#subsection8\">Filtering</a></li>
\n<li><a href=\"#subsection9\">Features extraction</a></li>
\n<li><a href=\"#subsection10\">Image drawing</a></li>
\n<li><a href=\"#subsection11\">Matrix computation</a></li>
\n<li><a href=\"#subsection12\">3d rendering</a></li>
\n<li><a href=\"#subsection13\">Program control</a></li>
\n<li><a href=\"#subsection14\">Arrays,tiles and frames</a></li>
\n<li><a href=\"#subsection15\">Artistic</a></li>
\n<li><a href=\"#subsection16\">Warpings</a></li>
\n<li><a href=\"#subsection17\">Degradations</a></li>
\n<li><a href=\"#subsection18\">Blending and fading</a></li>
\n<li><a href=\"#subsection19\">Image sequences and videos</a></li>
\n<li><a href=\"#subsection20\">PINK-library operators</a></li>
\n<li><a href=\"#subsection21\">Convenience functions</a></li>
\n<li><a href=\"#subsection22\">Other interactive commands</a></li>
\n<li><a href=\"#subsection23\">Commands shortcuts</a></li>
\n</ul>
\n<li><a href=\"#section13\">Examples of use</a></li>
\n</ul>
\n<a id=\"section0\"><h2>Version</h2></a>
\n<pre><font color=\"blue\"><b>gmic:</b> GREYC's Magic for Image Computing.</font>
\n
\n       Version <font color=\"brown\"><b>"$strver$strbeta"</b></font>, Copyright (c) 2008-2015, David Tschumperle
\n       (<a href=\"http://gmic.eu\">http://gmic.eu</a>)
\n</pre>
"
-v -
-_help_section "Usage"
_help_section_html :
_section={$_section+1}
-v +
-e[] "<h2><a href=\"#toc\"><img src=\"img/back_top.png\"></img>&nbsp;&nbsp;</a><a id=\"section"$_section"\">$1</a></h2>"
-v -
_help_paragraph_html :
-v +
-e[] "<pre>$*</pre>"
-v -
_help_footer_html :
-v +
-e[] "
\n<br/><b><font color=\"brown\">** G\47MIC comes with ABSOLUTELY NO WARRANTY; for details visit: <a href=\"http://gmic.eu\">http://gmic.eu **</a></font></b>
\n</tt>
\n</div>
\n</div>
\n<div id=\"footer\"><img src=\"images/footer.jpg\" /></div>
\n</div>
\n<!--#include file=\"copyright.html\" -->
\n<!--#include file=\"footer.html\" -->
"
-v -
_help_header_latex :
-if {narg($_gmic_is_beta)} strbeta=" (beta)" -else strbeta="" -endif
-if {narg($_gmic_version)} strver=$_gmic_version -else strver=@{-strver} -endif
-v + -e[] "\\documentclass[a4paper,11pt,twoside]{book}
\n\\usepackage{hyperref,fancyhdr,graphicx,amssymb,amsmath,times,makeidx,listings,color}
\n\\graphicspath{{img/}}
\n\\pagestyle{fancyplain}
\n\\lhead[\\fancyplain{}{\\textbf\\thepage}]{\\fancyplain{}{\\rightmark}}
\n\\rhead[\\fancyplain{}{\\leftmark}]{\\fancyplain{}{\\textbf\\thepage}}
\n\\cfoot{}
\n\\setlength{\\textwidth}{5.875in}
\n\\setlength{\\parindent}{0pc}
\n\\setlength{\\hoffset}{-0.8cm}
\n\\setcounter{tocdepth}{1}
\n\\sloppy{}
\n\\definecolor{ca}{rgb}{0.8,0,0}
\n\\definecolor{cb}{rgb}{0,0.2,0.6}
\n\\definecolor{cc}{rgb}{0,0.5,0}
\n\\definecolor{cd}{rgb}{0.6,0.6,0.6}
\n\\newcommand{\\Ca}[1]{\\textcolor{ca}{#1}}
\n\\newcommand{\\Cb}[1]{\\textcolor{cb}{#1}}
\n\\newcommand{\\Cc}[1]{\\textcolor{cc}{#1}}
\n\\newcommand{\\Cd}[1]{\\textcolor{cd}{#1}}
\n\\title{\\fbox{\\parbox{\\textwidth}{\\begin{center}\\vspace*{2cm}\\includegraphics[width=12cm]{logo3.jpg}\\\\\\vspace*{1cm}{\\Huge \\textbf{The Handbook}\\\\{\\small Version "$strver$strbeta"}\\\\\\vspace*{1cm}}\\end{center}}}}
\n\\author{\\Large \\bf David Tschumperl\\'e}
\n\\renewcommand\\indexname{Index of commands}
\n\\makeindex
\n\\lstset{columns=fullflexible,basicstyle=\\normalfont}
\n\\begin{document}
\n\\maketitle
\n\\tableofcontents
\n\\chapter*{Preamble}
\n\\section*{License}
\nThis document is distributed under the \\textbf{GNU Free Documentation License}, version 1.3.\\\\
\nRead the full license terms at \\texttt{http://www.gnu.org/licenses/fdl-1.3.txt}.\\\\~\\\\
\nAn online version of this documentation is available at:\\\\\\texttt{http://gmic.eu/reference.shtml}.
\n\\section*{Motivations}
\nG\47MIC is an open and full-featured framework for image processing, providing several different user interfaces to
\nconvert/manipulate/filter/visualize generic image datasets, from 1d scalar signales to 3d+t sequences of multi-spectral volumetric images.
\nTechnically speaking, what it does is:
\n\\begin{itemize}
\n\\item Define a lightweight but powerful script language (the G\47MIC language) dedicated to the design of image processing pipelines.
\n\\item Provide several user interfaces embedding the corresponding interpreter:
\n\\begin{itemize}
\n\\item A command-line executable 'gmic', to use the G\47MIC framework from a shell.
\nIn this setting, G\47MIC may be seen as a direct (and friendly) competitor of the ImageMagick or GraphicsMagick software suites.
\n\\item A plug-in 'gmic\\_gimp', to bring G\47MIC capabilities to the GIMP image retouching software.
\n\\item A web-service 'G\47MIC Online', to allow users applying image processing algorithms directly in a web brower.
\n\\item A Qt-based interface 'ZArt', for real-time manipulation of webcam images.
\n\\item A C++ library 'libgmic', to be linked with third-party applications.
\n\\end{itemize}
\n\\end{itemize}
\nG\47MIC is focused on the design of possibly complex pipelines for converting, manipulating, filtering and visualizing generic 1d/2d/3d multi-spectral image datasets. This includes of course color images, but also more complex data as image sequences or 3d(+t) volumetric float-valued datasets.\\\\
\n
\nG\47MIC is an open framework: the default language can be extended with custom G\47MIC-written commands, defining thus new available image filters or effects. By the way, G\47MIC already contains a substantial set of pre-defined image processing algorithms and pipelines (more than 1000).\\\\
\n
\nG\47MIC has been designed with portability in mind and runs on different platforms (Windows, Unix, MacOSX). It is distributed under the CeCILL license (GPL-compatible). Since 2008, it is developed in the Image Team of the GREYC laboratory, in Caen/France, by permanent researchers working in the field of image processing on a daily basis.
\n\\section*{Version}
\n
\n \\Ca{\\textbf{gmic:} GREYC's Magic for Image Computing.}\\\\
\n
\n        \\Cb{Version \\textbf{"$strver$strbeta"}, Copyright (c) 2008-2015, David Tschumperl\\'e}\\\\
\n        \\Cb{(http://gmic.eu)}
\n\\chapter{Usage}
"
-v -
_help_section_latex : -skip "$1"
-v +
-e[] "\\section{$1}"
-v -
_help_paragraph_latex : -skip "$1"
-v +
-e[] "\\small"
-e[] "\\begin{lstlisting}"
-e[] "$1"
-e[] "\\end{lstlisting}"
-e[] "\\normalsize"
-v -
_help_footer_latex :
-v +
-e[] "
\n\\printindex
\n~\\\\$\\square$~End of document.
\n\n\\end{document}"
-v -
_help_header_man :
-v + -e[] ".TH G\47MIC 1\n\
.SH NAME\n\
gmic \\- Perform generic image processing operations, through the G\47MIC language interpreter.\n\
\n\
.SH HELP\n" -v -
_gmic_n="\\fR" _gmic_b="\\fB" _gmic_r="" _gmic_g="" _gmic_c="\\fB" _gmic_m=""
_gmic_is_beta=
-__help_header_ascii
_gmic_n="__N" _gmic_b="__B" _gmic_r="__B" _gmic_c="__B"
_section=0 _space1="" _space2=" "
-_help_section "Usage"
_help_section_man :
_section={$_section+1}
{narg({'"$1"'})},1,1,1,{'-'}
-v +
-e[] "\n \\fB"$_section". $1"
-e[] "    "${_space{narg({'$_section'})}}@{-1,t}"\\fR\n"
-v -
-rm[-1]
_help_paragraph_man :
-l[] ({'"$*"'})
-replace_str "\\fR","__N"
-replace_str "\\fB","__B"
-replace_str "\\","\\\\\\\\"
-replace_str "__N","\\\\fR"
-replace_str "__B","\\\\fB"
-v +
-e[] @{0,t}
-v -
-rm -endl
_help_footer_man :
-_help_footer_ascii $"*"
use_vt100 :
-v - -if {narg($_gmic_vt100)}
_gmic_n="\33[0;0;0m" _gmic_r="\33[0;31;59m" _gmic_g="\33[0;32;59m" _gmic_m="\33[0;35;59m"
_gmic_c="\33[0;36;59m" _gmic_b="\33[1m"
-endif -v +
version :
-v - -__help_header_ascii[] -v +
-e[] ""
v :
-version
cupid : -check "${1=480}>=1"
-e[^-1] "Input $1x$1 cupid binary mask." -v -
-l[]
(480,480,1,1,1)
({'"                                                                                                   -WHX         /ZL[         1\\N]         2k         2l         4m         4m         4m         4m      "\
"   4m         4m         4m         3l         3k         2k         1i         0i         /g         .g         -e         +c         )a         (`         &^         $\\         !Y          NW       "\
"   LU          IQ                                                                                                                                                                                       "\
"                                :R>Z         9ZD^      8T  *^G`      :X@Q  ?`Ib      ;ZCS  AcMe      ;[FTAQ \"{      ;\\GTBS $}      ;\\JVBS $}      ;]LWBT %}      ;hBV (~P      ;gBXNT 0~P      ;hC^ 0~P "\
"     GQEhC^ 0~P      KZKpK_ 0~P      M~TM_ 0~P      ~h 0~P     !~i 0~P     \"~j 0~P     \#~k 0~     \#~m 1~     $~n 0}     %~o 0|     %~q 1|     &~r 0{     \47~t 1z     (~w 1y     *~z 2x     +~| 2w     +~~"\
" 2v     ,~~P 1t     ,~~\\ <t     -~~_ =r     -~~` <p     .~~d =n     /~~f =m     0~~i =l     0~~i <j     0~~j ;h     0~~j 9f     /~~a /d     /~~a -b   4U  ~~` *_   3V !~~_ (\\   2X \"~~^ &Z   1Z $~~^ %X "\
"  0[ %~~^ \#U   /\\ &~~^     ,] \47~~^     ,^ (~~_     -_ )~~_     -` *~~_     -a +~~`     -a ,~~`     -c .~~a     -c /~~a     -d 0~~a     ,e 2~~b     -f 3~~b     ,f 4~~b     +f 5~~b     +h 8~~c     *i ;~"\
"~d     *k =~~d     )l @~~e     )o D~~f     (p F~~f     \47q I~~g     &r K~~g     %t N~~g     %w\"~~g     $x$~~g     .UJz\47~~f     .YL|*~~f KP    3ZL~-~~f LR    5~b1~~f MS    5~e4~~f MR    4~g5~~d MS    4~"\
"i8~~e MS    3~j:~~e MS    3~k;~~d LS    3~l<~~d LS    2~l=~~c KS    1~l>~~c LU    2~m?~~b KU    0~k?~~b KV    0~k@~~b KX    2~l@~~` KZ    2~k@~~` K[    1~j@~~_ LTKU   2U&~i?~~] LSHU   4X\47~i@~~] MTGT  "\
" 5[\47~g@~~\\ MTET   6\\\47~f?~~[ MSCT   7]&~e@~~Z MTCU   8_1VL~dA~~Z MTAU   9a5~pA~~Z NU@T   9c7~pA~~Y MT>U   :d:~qB~~Y LS=V   ;f<~rC~~Y MT<V   <h>~rC~~Y NT:V   <i@~rC~~Y U9V   =j@~qC~~Y T8W   =kB~qC~~Z\"T6"\
"V   <nD~oB~~Y\"T5V   =qF~oA~~X$T3U   <sH~n=~~T%T1U   ;vK~l:~~R\47T/U   <~~h9~~Q(U.U   <~~g8~~P(T-V   <~~g8~~P*T+U   ;~~f8~~P+U*U   ;~~e7~~+T(T   ;~~e6~|+T\47U   :~~d7~|+T&U   :~~c7~|,T%V   ;~~c6~{,S\#U   9~"\
"~b7~z-U\#V   9~~a7~z-T!U   7~~_7~y-U T   5~~^8~y.U NU   ?RH~~]8~x-T LU   BXK~~\\9~y.U LU   C~~k:~y/U JU   E~~l;~y.T IU   E~~l<~y.U HU   F~~m>~z/U GU   F~~m>~y.T FV   G~~m?~y.T DU   G~~m@~y.U DU   G~~n@~"\
"w-T BU   G~~m@UH~i-T AU   F~~m*~^-U AU   E~~l*~]-U ?U   E~~l*~Z+T >U   C~~l,~Y+U >U   B~~t5~X+U =V   A~~v9~W+U ;U   @~~w;~W+U ;U   >~~y@~W+U :U   <~~zC~W+T 9V   ;~~zF~W+U 9V   8~~yH~W,U 7U   5~~xL~X+U"\
" 7U   3~~~~S,U 6U   ?~~~~^,U 5U   @~~~~^+U 5V   B~~~~QIV+U 4V   C~~~~Q MU 3V   C~~~~P LT 2V   C~~~~ LU 2V   C~~~~ MU 1V   C~~~} MU 0V   B~~~| MT /V   A~~~{ NU /V   @~~~y NU /W   >~~~w NU /V   :~~~t U "\
".V   8~~~r!U -V   4~~~o\"U -V   .~~~j$U -W   1~~~r*V -V   3~~~y/V ,V   4~~~|1U ,W   5~~~~3V ,W   6~~~~R6V +V   5~~~~T8U +W   4~~~~U:T *W   4~~~~Z@U +W   3~~~~]DU +W   1~~~~^FT *W   0~~~~^HT *W   -~~~~^"\
"KT *X   +~~~~^NU +X   \"~~~~\\ +X   !~~~~\\ ,X    ~~~~[ +W    ~~~~\\ ,W    N~~~~\\ -W    N~~~~] .X    N~~~~] /X    M~~~~] 0Y    L~~~~] 1X    J~~~~\\ 2X    G~~~~[ 4X    @~~~~V 6Y    >~~~~U 7X    >~~~~X :X   "\
" >~~~~Z <Y    >~~~~] @Z    >~~~~t)Z    >~~~~{0[    =~~~~}4\\    =~~~~~Q9^    ;~~~~~R>a    4~~~~~Fd    4~~~~~n    5~~~~~o*S   1~~~~~q-X   4~~~~~y6Z   5~~~~~~UB]   7~~~~~~[J`   6~~~~~~p   /~~~~~hEu   /~~"\
"~~~f=o   0~~~~~f2d   /~~~~~e1c   /~~~~~e0a   ,~~~~~c/^   \#~~~~~\\.\\   !~~~~~[-Y    N~~~~~Z*T    K~~~~~Z    !~~~~~Z     ~~~~~X     K~~~~~T     C~~~~{     B~~~~y     @~~~~x     >~~~~v     =~~~~v     ;~~~"\
"~s     3~~~~l     1~~~~[M\\     0~~kKX:vGZ     .~~hHT4oDZ     ,TK`L~xGR\47_?Y     !]I~vGQ 5Y      ZG~vFP 4Y      NWF~vFP 4Y      =~wGQ 5Y      =~wGQ 5Y      =~wGQ 4X      >~xFP 4X      ?~zGQ 5X      @~{G"\
"Q 5Y      D~~GQ 4X      F~~QGR 5X      G~~RFQ 5X      H~~SFQ 4X      J~~TFR 5X      K~~UEQ 4W      L~~VEQ 4X      N~~WEQ 4X      ~~XER 4W      ~~XDQ 4X     \"~~YDQ 4X     \#~~ZDQ 3W     $~~[DR 4X     %~"\
"~[DR 4X     &~~\\CQ 4X     &~~\\CQ 4X     &~~\\CQ 4X     \47~~]CR 5X     \47~~]BQ 5X     \47~~\\AQ 5X     \47~~\\AQ 5X     (~~]AR 6X     (~~]@Q 6X     (~~]@Q 7Y     )~~]?Q 7X    LV 2~~]?R 8X   !] 5~~]>Q 8X   \#a 7~"\
"~]>Q 9Y   %d 8~~\\=R :X   &g 9~~\\=R :X   )k :~~\\<Q ;Y   7y :~~\\<Q ;X   8| ;~~[;R <X   9} ;~~[;R =Y   :~ ;~~[;R =X   :~Q <~~Z9Q >Y   ;~R <~~Z9R ?X   :~R <~~Y8R @Y   ;~S <~~X6Q @X   :~S <~~X6Q AY   ;~T ="\
"~~X5R BX   :~T >~~X4R CX   9~U B~~Z2Q CX   9~U F~~]1Q DX   8~V I~~_1Q EX   7~X L~~^/R GY   7~d*~~_/R HY   5~f/~~a.Q HX   4~h2~~a-Q IX   1TJ~_7~~c-R KY   $~^;~~e-R LY   \"~^=~~f,Q MY    ~_@~~h-Q NY    K"\
"~]B~~i-R!Y    H~[C~~k.R\"Y    B~WE~~l-Q\#Y    =~TG~~m-R%Y    ;~TH~~n.R\47Z    9~TJ~~p/R(Z    7~TL~~q.Q)Z    5~~~x.R,[    3~~~x/R-[    1~~~w/R.Z    /~~~w.Q0[    -~~~v.Q2\\    +~~~v/R4[    (~~~u/R6[    &~~~u"\
".Q8\\    $~~~t.Q9\\    \"~~~s.Q;\\     N~~~s/R>]     L~~~r.Q@]     I~~~q.QB^     G~~~p.QC]     D~~~p.QF\\     @~~~o.QH\\     =~~~n.RK\\     :~~~m.b     8~~~l.`     5~~~k.]     1~~~j.Y     +~~~h.W     (~~~g.U"\
"     &~~~g.T     \#~~~e.S     !~~VJ~X.S      N~~RF~V.R      L~~PD~U.R      J~{A~U/Q      G~w>~T      \#~s;~S      !~m6~R       N~i3~Q       J~a.~P       G~Z)~       E~ M}       Ds C|       Cf 6{       A"\
"a 2z       @] .z       ?Y +y       <S (y         C| 1R       :~R BVHX       ?~T CYKZ       A~U D[N]       C~V El       E~W El       G~X Dl       H~Y En       J~Z En       J~Y Dn       L~[ Dn       L~Z"\
" Cm       L~Z Al       M~Z @l       M~Z @l       N~Z ?k       M~Y =j       N~Y <i       M~X :h       N~W 8g       M~V 6e       M~V 4c       M~U 1a       L~T 0a       M~T ._       M~T ,]       M~S )[  "\
"     N~S %W       L~Q \"U       N~S  S       ~S         L~T         K~T         L~T         K~S         J~S         J~Q         G~P         G~         E|         Cz         Ax         ?v         =t    "\
"     ;r         9p         7p         6n         5n         4n         5n         4m         3l         2k         1j         0i         .g         -f         -f         ,e         ,e         ,f      "\
"   -f         ,e         ,f         -g         .g         .h         .g         .h         -f         -f         +c         \47`         \#Y                                                               "\
"                                            2"'})
--[-1] {47+32} -a x -y -uncompress_rle -r $1,$1,1,1,5 -if {$1>480} -b[-1] 0.2% -endif ->= 40%
-nm "[Cupid binary mask]"
-endl -v +
d0 :
-_display0
display0 :
-_$0
_display0 :
-v -
w=0 h=0 d=0 s=0
-repeat @# -l[$>] w={$w+w} h={max($h,h)} d={max($d,d)} s={max($s,s)} -endl -done
-if {@#==1} -w -1,-1,0,0,-1,-1,@{0,n}\ ($wx$hx$dx$s)
-elif {@#==2} -w -1,-1,0,0,-1,-1,@{0,n},@{-1,n}\ ($wx$hx$dx$s)
-else -w -1,-1,0,0,-1,-1,@{0,n},..,@{-1,n}\ ($wx$hx$dx$s)
-endif
-v + -d
-v - -w[] 0 -v +
da :
-v - _gmic_s="$?" -v +
-_display_array $*
display_array :
-v - _gmic_s="$?" -v +
-_$0 $*
_display_array : -check ${1=13}>0" && "${2=$1}>0
-e[0--3] "Display $1x$2 array of pixel values for image"$_gmic_s"."
-v -
dxb={round($1/2,1,1)} dxf={$1-1-$dxb}
dyb={round($2/2,1,1)} dyf={$2-1-$dyb}
-repeat @# -l[$>]
-if {w<128" && "h<128} -r 128,128,100%,100%,0,0,0.5,0.5 -endif
x0=0 y0=0 w={w} h={h}
wmax={0.9*@{!,u}} hmax={0.9*@{!,v}}
-do
-if {w>=$wmax||h>=$hmax}
n=@{-1,n} -nm[-1] "Image "'@{-1,b}.@{-1,x}'" is too large, please select a sub-image."
--select[-1] 2 x0={i[0]} y0={i[1]} w={1+i[3]-i[0]} h={1+i[4]-i[1]}
-rm[-1] -nm[-1] $n
-endif
--z[-1] $x0,$y0,0,{$x0+$w-1},{$y0+$h-1},0 -round[-1] 1 -n[-1] 0,255
-while {w>=$wmax||h>=$hmax}
x1=-1 y1=-1 c1=0 ox1=-1 oy1=-1 oc1=-1
x2=-1 y2=-1 c2=0 ox2=-1 oy2=-1 oc2=-1
x3=-1 y3=-1 c3=0 ox3=-1 oy3=-1 oc3=-1
c0=0 oxm=-1 oym=-1
-w[-1] -1,-1,0,0,-1,-1,@{-2,b}.@{-2,x}
-do
-wait[0-3]
oc0=$c0
-repeat 4
-if {$>" && "!@{!$>}" && "${x$>}>=0} -w$> 0 x$>=-1 y$>=-1 c$>=0 -endif
-if @{!$>,o} c$>={(${c$>}+sign(@{!$>,o}))%s} -wait[$>] -1 -endif
-if {@{!$>,SPACE}" || "@{!$>,ENTER}" || "@{!$>,ARROWRIGHT}" || "@{!$>,ARROWDOWN}} c$>={(${c$>}+1)%s} -wait[$>] -1 -endif
-if {@{!$>,BACKSPACE}" || "@{!$>,ARROWLEFT}" || "@{!$>,ARROWUP}} c$>={(${c$>}-1)%s} -wait[$>] -1 -endif
-done
-if {$oc0!=$c0} c1=$c0 c2=$c0 c3=$c0 -endif
xm=@{!,x} ym=@{!,y}
-if {$xm>=0" && "@{!,b}&1} x1=$xm y1=$ym -endif
-if {$xm>=0" && "@{!,b}&2} x2=$xm y2=$ym -endif
-if {$xm>=0" && "@{!,b}&4} x3=$xm y3=$ym -endif
-if {$xm>=0" && "($oxm!=$xm" || "$oym!=$ym)} -w[] -1,-1,-1,-1,-1,-1,@{-2,b}.@{-2,x}" - ("$xm,$ym")" -endif
-if {$x1!=$ox1" || "$y1!=$oy1" || "$x2!=$ox2" || "$y2!=$oy2" || "$x3!=$ox3" || "$y3!=$oy3}
[-1]
-if {$x1>=0}
xb={$x1-$dxb} yb={$y1-$dyb} xe={$x1+$dxf} ye={$y1+$dyf}
-rectangle[-1] $xb,$yb,$xe,$ye,0.2,0,255,255
-rectangle[-1] $xb,$yb,$xe,$ye,1,0xFFFFFFFF,0,255,255
-endif
-if {$x2>=0}
xb={$x2-$dxb} yb={$y2-$dyb} xe={$x2+$dxf} ye={$y2+$dyf}
-rectangle[-1] $xb,$yb,$xe,$ye,0.2,255,32,255
-rectangle[-1] $xb,$yb,$xe,$ye,1,0xFFFFFFFF,255,32,255
-endif
-if {$x3>=0}
xb={$x3-$dxb} yb={$y3-$dyb} xe={$x3+$dxf} ye={$y3+$dyf}
-rectangle[-1] $xb,$yb,$xe,$ye,0.2,255,255,0
-rectangle[-1] $xb,$yb,$xe,$ye,1,0xFFFFFFFF,255,255,0
-endif
-w[-1] @{-2,w},@{-2,h} -rm[-1] oxm=$xm oym=$ym
-endif
-if {$x1>=0" && "($ox1!=$x1" || "$oy1!=$y1" || "$oc1!=$c1)}
--z[-2] {$x1-$dxb},{$y1-$dyb},0,$c1,{$x1+$dxf},{$y1+$dyf},0,$c1
--z[-2] {$x1-$dxb},{$y1-$dyb},0,{$x1+$dxf},{$y1+$dyf},0
-__display_array[-2,-1] $1,$2,0,255,255
-w1[-1] {w},{h},0,0,-1,-1,@{-3,b}" - ("$x1,$y1,c=$c1")"
-rm[-1] ox1=$x1 oy1=$y1 oc1=$c1
-endif
-if {$x2>=0" && "($ox2!=$x2" || "$oy2!=$y2" || "$oc2!=$c2)}
--z[-2] {$x2-$dxb},{$y2-$dyb},0,$c2,{$x2+$dxf},{$y2+$dyf},0,$c2
--z[-2] {$x2-$dxb},{$y2-$dyb},0,{$x2+$dxf},{$y2+$dyf},0
-__display_array[-2,-1] $1,$2,255,32,255
-w2[-1] {w},{h},0,0,-1,-1,@{-3,b}" - ("$x2,$y2,c=$c2")"
-rm[-1] ox2=$x2 oy2=$y2 oc2=$c2
-endif
-if {$x3>=0" && "($ox3!=$x3" || "$oy3!=$y3" || "$oc3!=$c3)}
--z[-2] {$x3-$dxb},{$y3-$dyb},0,$c3,{$x3+$dxf},{$y3+$dyf},0,$c3
--z[-2] {$x3-$dxb},{$y3-$dyb},0,{$x3+$dxf},{$y3+$dyf},0
-__display_array[-2,-1] $1,$2,255,255,0
-w3[-1] {w},{h},0,0,-1,-1,@{-3,b}" - ("$x3,$y3,c=$c3")"
-rm[-1] ox3=$x3 oy3=$y3 oc3=$c3
-endif
-while {@!" && "\
!@{!,ESC}" && "!@{!,Q}" && "\
!@{!1,ESC}" && "!@{!1,Q}" && "\
!@{!2,ESC}" && "!@{!2,Q}" && "\
!@{!3,ESC}" && "!@{!3,Q}}
-k[0] -w 0 -w1 0 -w2 0 -w3 0
-endl -done -v +
__display_array :
-round[-2] 1 -c[-2] 0,999 -r[-1] 100%,100%,1,3,{if(s==1,1,0)}
--luminance[-1] -r[-2] {$1*24},{$2*24} -grid[-2] {100/$1}%,{100/$2}%,0,0,1,0
xb={24*int($1/2)} yb={24*int($2/2)} xe={$xb+24} ye={$yb+24}
-rectangle[-2] $xb,$yb,$xe,$ye,1,0xFFFFFFFF,$3,$4,$5
-repeat $2 yg=$>
-repeat $1 xg=$>
-t[-2] @{-3,($xg,$yg)},{5+$xg*24},{5+$yg*24},13,0.8,{if(@{-1,($xg,$yg)}>128,0,255)}
-done
-done
-rm[-3,-1]
dfft :
-_display_fft
display_fft :
-_$0
_display_fft :
-e[0--3] "Render fourier transform of image$? with centered log-module and argument."
-v - -repeat @# -l[$>] -fftpolar -+[-2] 1 -log[-2] -n 0,255 -a x -endl -done -s x,2 -v +
dg : -check "${1=640}>32 && ${2=480}>32" -skip ${3=1},${4=0},${5=0},${6=0},${7=0},${8=0},"${9=x-axis}","${10=y-axis}"
-_display_graph ${1-8},"$9","$10"
display_graph : -check "${1=640}>32 && ${2=480}>32" -skip ${3=1},${4=0},${5=0},${6=0},${7=0},${8=0},"${9=x-axis}","${10=y-axis}"
-_display_graph ${1-8},"$9","$10"
_display_graph : -check "${1=640}>32 && ${2=480}>32" -skip ${3=1},${4=0},${5=0},${6=0},${7=0},${8=0},"${9=x-axis}","${10=y-axis}"
-e[0--3] "Render $1x$2 graph plot from data of image$?."
-v - -repeat @# -l[$>] nm=@{0,n}
one={$3!=3} siz={w*h*d}
-if {$5==$6} xmin=0 xmax={$siz-$one} -else xmin={min($5,$6)} xmax={max($5,$6)} -endif
-if {$7==$8} ymin={im-(iM-im)/20} ymax={iM+(iM-im)/20} -else ymin={min($7,$8)} ymax={max($7,$8)} -endif
gw={$1-32} gh={$2-32} gg={($gw-$one)/($siz-$one)}
$gw,$gh,1,3,255
-if {$siz<32} -grid[-1] $gg,$gg,0,0,0.25,0xCCCCCCCC,0
-else -grid[-1] 10%,10%,0,0,0.25,0xCCCCCCCC,0
-endif
-if {@{-2,s}==1} (120,120,200)
-elif {@{-2,s}<=3} (220,10,10;10,220,10;10,10,220)
-else
(0,255) -r[-1] 256,1,1,1,3 -map[-1] 2 -z[-1] 2,100% -permute[-1] cxyz -r[-1] 3,{max(3,@{-3,s})},1,1,0,2
-sh[-1] 0,2,0,0 -f[-1] 255,0,0,0,255,0,0,0,255 -rm[-1]
-endif
-repeat @{-3,s} -sh[-3] $>,$> -graph[-3] [-1],$3,$4,$ymax,$ymin,1,@{-2,0-2} -rm[-1] -shift[-1] 0,-1 -done
-rm[-3,-1]
-line[-1] 0,0,100%,0,1,110 -line[-1] 100%,0,100%,100%,1,110
-line[-1] 100%,100%,0,100%,1,255 -line[-1] 0,100%,0,0,1,255
100%,100%,1,1,255
xmax_={$xmin+($xmax-$xmin)*($siz-$one)/($siz-1)}
-axes[-1] $xmin,$xmax_,$ymax,$ymin,13,1,0
-if {$xmin>0} -axes[-1] 0,0,$ymax,$ymin,13,1,160 -endif
-if {$xmax<0} -axes[-1] {w-1},{w-1},$ymax,$ymin,13,1,160 -endif
-if {$ymin>0} -axes[-1] $xmin,$xmax_,{h-1},{h-1},13,1,160 -endif
-if {$ymax<0} -axes[-1] $xmin,$xmax_,0,0,13,1,160 -endif
--erode[-1] 3 -!=[-1] 255 -r[-2] 100%,100%,1,3 -j[-3] [-2],0,0,0,0,1,[-1],1 -rm[-2,-1]
-frame[-1] 16,16,220
0 -t[-1] "$9",0,0,13,1,-220,-220,-220 -j[-2] [-1],{(@{-2,w}-w)/2},{@{-2,h}-16},0,0,-1 -rm[-1]
0 -t[-1] "$10",0,0,13,1,-220,-220,-220 -rotate[-1] -90 -j[-2] [-1],2,{(@{-2,h}-h)/2},0,0,-1 -rm[-1]
-nm $nm -endl -done -c 0,255 -v +
dh :
-v - _gmic_s="$?" -v +
-_display_histogram $"*"
display_histogram :
-v - _gmic_s="$?" -v +
-_$0 $"*"
_display_histogram : -check "${1=512}>0 && ${2=300}>0 && ${3=256}>0" -skip ${4=0%},${5=100%},${6=1},"${7=i}"
-e[0--3] "Render $1x$2 channel-by-channel histogram of image"$_gmic_s", with $3 clusters, minimum value $4 and maximum value $5."
-v - -repeat @# -l[$>] nm=@{0,n}
-if @{-is_percent\ $4} m={im+(iM-im)*$4} -else m=$4 -endif
-if @{-is_percent\ $5} M={im+(iM-im)*$5} -else M=$5 -endif
s={s} -s c
-repeat $s -l[{-1-$>}] -s z -histogram $3,$m,$M -a z -endl -done
-a c -f '"$7"' vM={iM} -s z
-repeat @# -l[$>]
$1,$2,1,{s},-255
-repeat {s} -sh[-2,-1] $>,$> -graph[-1] [-2],3,0,$vM,0,1,0 -rm[-2,-1] -done
-rm[-2] -+ 255
-if $6 100%,100% -axes[-1] $m,$M,$vM,0,13,1,255 --dilate[-1] 3 -r[-2] [-3] -j[-3] [-2],0,0,0,0,1,[-1],255 -rm[-2,-1] -endif
-endl -done
-a z -nm $nm
-endl -done -v +
display_parametric : -check "${1=512}>0 && ${2=$1}>0 && ${4=0}>=0" -skip ${3=3},${5=1},${6=1},"${7=x-axis}","${8=y-axis}"
-v - s0="no " s1="" o0="" o1="colored "
-v + -e[^-1] "Render $1x$2 parametric graph plot from data of image$?, with "${o{$3>1}}"outline opacity "{if($3>1,$3-1,$3)}\
", vertex radius $4, "${s{$5!=0}}"antialiasing and "${s{$6!=0}}"decoration." -v -
-repeat @# -l[$>]
nm=@{0,n} N={w*h*d}
-i[0] ({'CImg3d'}) -+[0] 0.5 -i[1] ($N;$N)
-if {s==4} --channels[-1] 3,3 -r[-1] 100%,100%,1,2 -a[-2,-1] c is_grayscale=1
-else is_grayscale={s<4} -channels[-1] 0,5
-endif
-sh[-1] 0,0 xm={im} xM={iM} -rm[-1]
-sh[-1] 1,1 ym={im} yM={iM} -rm[-1]
-sh[-1] 2,2 zm={im} zM={iM} -rm[-1]
-permute[-1] cxyz -s[-1] x,2
-i[-2] (1,0;1,{$N-1}) -r[-2] 2,$N,1,1,3 -round[-2] 1,$N,1,1,1
-y -a y -c3d -n3d -*3d 1,-1,1
{if($6,max(1,$1-32),$1)},{if($6,max(1,$2-32),$2)},1,{if($is_grayscale,1,3)},255
-*3d[0] {0.96*min(w,h)}
-if $6 L={0.1*max($1,$2)} -grid[1] $L,$L,0,0,0.25,0xCCCCCCCC,0 -endif
-if $5
-r[1] 200%,200%,1,100%,1 -*3d[0] 2
-if $4 --circles3d[0] {2*$4} -j3d[1] [2],50%,50%,0,1,3,0,0 -rm[2] -endif
-elif $4
--circles3d[0] $4 -j3d[1] [2],50%,50%,0,1,3,0,0 -rm[2]
-endif
-if $3 -l[0] -s3d -f[1] 'i-y' -rm[3] -i[3] (2,0,1;2,{$N-2},{$N-1}) -r[3] 3,{$N-1},1,1,3 -round[3]
-r[5] 1,{h-1},1,1,0
-if {$3>1} -r[4] 3,@{4,h/3},1,1,-1 -r[4] 3,@{4,h-1},1,1,2 -else -rm[4] -i[4] 3,{$N-1} -endif
-y -a y -endl -j3d[1] [0],50%,50%,0,{if($3>1,$3-1,$3)},2,0,0
-endif
-rm[0]
-if $5 -r[-1] 50%,50%,1,100%,2 -endif
-if $6
xc={0.5*($xm+$xM)} yc={0.5*($ym+$yM)} dx={0.5*($xM-$xm)/0.96} dy={0.5*($yM-$ym)/0.96}
xm={$xc-$dx} xM={$xc+$dx} ym={$yc-$dy} yM={$yc+$dy}
100%,100% -axes[-1] $xm,$xM,$yM,$ym,13,1,1
-if {$xm>0} -axes[-1] 0,0,$yM,$ym,13,1,160 -endif
-if {$xM<0} -axes[-1] {w-1},{w-1},$yM,$ym,13,1,160 -endif
-if {$ym>0} -axes[-1] $xm,$xM,{h-1},{h-1},13,1,160 -endif
-if {$yM<0} -axes[-1] $xm,$xM,0,0,13,1,160 -endif
--dilate[-1] 3 --[-1] [-2] -*[-1] 200 -==[-2] 0
-*[-3,-2] -+[-2,-1] -c[-1] 0,255
-frame 1,1,128 -frame 15,15,220
0 -t[-1] "$7",0,0,13,1,-220,-220,-220 -j[-2] [-1],{(@{-2,w}-w)/2},{@{-2,h}-16},0,0,-1 -rm[-1]
0 -t[-1] "$8",0,0,13,1,-220,-220,-220 -rotate[-1] -90 -j[-2] [-1],2,{(@{-2,h}-h)/2},0,0,-1 -rm[-1]
-endif
-nm[-1] $nm
-endl -done -v +
dp :
-v - _gmic_s="$?" -v +
-_display_polar $*
display_polar :
-v - _gmic_s="$?" -v +
-_$0 $*
_display_polar : -check "${1=500}>32 && ${2=$1}>32" -skip ${3=1},${4=200},${5=$4},${6=$5},${7=0},${8=360},"${9=x-axis}","${10=y-axis}"
-e[0--3] "Render $1x$2 polar graph plot from data of image"$_gmic_s", with outline $4 and fill color ($4,$5,$6)."
-v - -repeat @# -l[$>] nm=@{0,n}
M={max(abs(iM),abs(im))}
-* {0.48*min($1,$2)/$M}
-y ({$7*pi/180};{-$8*pi/180}) -r[-1] 1,[-2],1,1,3
--sin[-1] -cos[-2] -*[-1] [-3] -*[-3,-2]
-a[-2,-1] x N={h}
-nm[-1] coords
-if $3
({'CImg3d'}) -+[-1] 0.5 ($N,$N)
--z[coords] 0,2
1,$N,1,1,2 1,$N,1,1,'y' --+[-1] 1 -a[-3--1] x -=[-1] 0,2,100%
3,$N,1,1,0 1,$N,1,1,1 -y[-6--1] -a[-6--1] y
-nm[-1] _plot_polar_outline
-endif
-if {"$4>=0 && $5>=0 && $6>=0"}
({'CImg3d'}) -+[-1] 0.5 ({$N+1},$N)
--z[coords] 0,-1,2,100% -z[-1] 0,2
1,$N,1,1,3 1,$N 1,$N,1,1,'1+y' --+[-1] 1 -a[-4--1] x -=[-1] 1,3,100%
3,$N,1,1,$4,$5,$6 1,$N,1,1,1
-y[-6--1] -a[-6--1] y
-nm[-1] _plot_polar_fill
-endif
-rm[coords]
{$1-32},{$2-32},1,3,255
L={0.1*max($1,$2)} -grid[-1] $L,$L,0,0,0.25,0xCCCCCCCC,0
-if {"$4>=0 && $5>=0 && $6>=0"}
-j3d[-1] [_plot_polar_fill],50%,50%,0,1,2,1,0
-rm[_plot_polar_fill]
-endif
-if $3
-if {$3>=0}
-j3d[-1] [_plot_polar_outline],50%,50%,0,1,1,0,0
-endif
-if {$3!=0}
-if {abs($3)>1} -circles3d[_plot_polar_outline] {abs($3)} -endif
-j3d[-1] [_plot_polar_outline],50%,50%,0,0.2,2,0,0
-endif
-rm[_plot_polar_outline]
-endif
nM={$M/0.96}
100%,100% -axes[-1] {-$nM},$nM,$nM,{-$nM},13,1,1
--dilate[-1] 3 --[-1] [-2] -*[-1] 200 -==[-2] 0
-*[-3,-2] -+[-2,-1] -c[-1] 0,255
-frame[-1] 1,1,128 -frame[-1] 15,15,220
0 -t[-1] "$9",0,0,13,1,-220,-220,-220 -j[-2] [-1],{(@{-2,w}-w)/2},{@{-2,h}-16},0,0,-1 -rm[-1]
0 -t[-1] "$10",0,0,13,1,-220,-220,-220 -rotate[-1] -90 -j[-2] [-1],2,{(@{-2,h}-h)/2},0,0,-1 -rm[-1]
-nm $nm -endl -done -v +
drgba :
-_display_rgba
display_rgba :
-_$0
_display_rgba :
-e[0--3] "Render RGBA image$? over a checkerboard background."
-v - -to_a -repeat @# -l[$>]
-i[0] (160,128;128,160) -nm[0] @{1,n} -r[0] 16,16 -r[0] [1],[1],1,{s-1},0,2 -blend alpha
-endl -done -v +
dt :
-v - _gmic_s="$?" -v +
-_display_tensors $*
display_tensors :
-v - _gmic_s="$?" -v +
-_$0 $*
_display_tensors : -check "${1=16}>0 && ${2=0.92}>=0" -skip "${3=1}"
-e[0--3] "Render field of 2x2 tensors from image"$_gmic_s", with size factor $1, ellipse factor $2 in "@{-arg\ 1+!$3,colored,masked}" mode."
-v -
-if {$3} -repeat @# -l[$>]
--_display_tensors $1,$2,0
-s[0] c --min[0,2] -*[1] -1 -+[1,-1] -a[0-2] c
-r[0] [-1],[-1] -n[0] 0,255 -*
-endl -done -else -repeat @# -l[$>]
w={w} h={h}
-* {($2*$1/2)^2/max(abs(im),abs(iM))}
-s c -i[-2] [-2] -a c -s yx -r 2,2,1,1,-1
(0.5,0;0,0.5) -+[^-1] [-1] -rm[-1]
-invert -y c -r $1,$1
$1,$1,1,1,'x' --[-1] {w/2}
$1,$1,1,1,'y' --[-1] {h/2}
--sqr[-1] -*[-2] [-3] -sqr[-3] -i[-2] [-2] -a[-4--1] c
-*[^-1] [-1] -rm[-1] -compose_channels + -<= 1
-append_tiles $w,$h
-endl -done -endif
-v +
dw :
-v - _gmic_s="$?" -v +
-_display_warp $*
display_warp :
-v - _gmic_s="$?" -v +
-_$0 $*
_display_warp : -check "${1=15}>0"
-e[0--3] "Render 2d warping field"$_gmic_s", with cell size $1."
-v - -repeat @# -l[$>]
-if {d!=1||s!=2}
-error[0--3] "Command '-display_warp': Invalid image ["{@#-$>-1}"]: Dimensions "{w}","{h}","{d}","{s}" does not represent a 2d field of 2d vectors."
-endif
-i[0] 100%,100%,1,1,1 -grid[0] $1,$1 -nm[0] @{1,n}
-warp[0] [1],1,1,0 -rm[1]
-endl -done -* 255 -v +
document_gmic : -skip ${1="ascii"},${2=""},${3=1}
-if {!@#} -return -endif
-v -1
_name=@{0,b}
-if {@#>1} -i[1--2] (10) -endif -a y -m @{-1,t} -s -,10
-_document_gmic_header_$1[] $3
_subsection=0
_example=0
_command=0
_is_example=0
_path="$2"
ks0="0" ks1="-k[0]"
-repeat @# -l[$>] -if {h>7" && "{@{-1,0-5}'=='{'"#@gmic"'}}" && "(i[6]=={'" "'}" || "i[6]=={':'})}
-rows 7,100% -autocrop {'" "'}
_is_example=0
-if {i!={':'}}
_command={$_command+1}
-s -,{'": "'} -autocrop {'" "'}
-_document_gmic_declaration_$1
-else
-rows 1,100%
-if {i=={':'}}
_subsection={$_subsection+1}
-rows 1,100% -autocrop {'" "'}
-_document_gmic_subsection_$1
-else
-autocrop {'" "'}
-if {i=={'$'}}
-rows 1,100% -autocrop {'" "'}
_is_example=1
-if {i!={'$'}} _example={$_example+1} -endif
_filename=$_path$_name$_example.jpg
-_document_gmic_example_$1
-else
-_document_gmic_description_$1
-endif
-endif
-endif
-endif ${ks{@#!=0}} -endl -done
-rm
-_document_gmic_footer_$1[] $3
_document_gmic_header_ascii : -skip $1
_shortcut=0
_document_gmic_subsection_ascii :
-v +
-e[] "\n "$_gmic_r$_gmic_b"** "@{0,t}":"$_gmic_n
-v -
_document_gmic_declaration_ascii :
-if {@{-1,t}'=='"(+)"} qualifier=" "@{-1,t} -rm[-1] -else qualifier="" -endif
-if {@#>1" && "{@{-1,0-6}'=='{'"eq. to "'}}}
-rows[-1] 7,100% -autocrop[-1] {'.'} -autocrop[-1] {'" "'} -autocrop[-1] 39
_shortcut$_shortcut=@{0,t}
_shortcutlink$_shortcut=@{-1,t}
_shortcutqualifier$_shortcut=$qualifier
_shortcut={$_shortcut+1}
-else
-v + -e[] "\n    "$_gmic_m${_gmic_b}"-"@{0,t}${qualifier}":"$_gmic_n -v - -rm[0]
-if @#
s="                        "
-y x
-repeat {@#-1} ({'" |"'}) -a[$>,-1] x -done
-repeat @# -l[$>] -_document_gmic_split_ascii 80,0
-repeat {@#-1} ({'\n$s"  "'}) -a[$>,-1] x -done
-a x -v + -e[] $_gmic_g$s@{0,t}$_gmic_n -v -
-endl -done
-endif
-v + -e[] "" -v -
-endif
_document_gmic_description_ascii :
s="        " bs0="\n" bs1="\\\\\n         "
-y x -if {!narg($_is_tutorial)} -_document_gmic_split_ascii 96 -endif
-if {@#==1" && "narg($_gmic_vt100)" && "{@{0,0-7}'=='{'"(eq. to "'}}} -i[0] ({'$_gmic_b'}) ({'$_gmic_n\n'}) -a x -endif
-repeat {@#-1} ({'${bs$_is_example}$s"  "'}) -a[$>,-1] x -done -a x
-if {narg($_gmic_vt100)}
-replace_str "Default values:","\n"$s${_gmic_b}"Default values:"$_gmic_n
-replace_str "Default value:","\n"$s${_gmic_b}"Default value:"$_gmic_n
-endif
-v + -repeat @# -e[] $s@{$>,t} -v - -done
_document_gmic_example_ascii :
_document_gmic_footer_ascii : -skip $1
-if $_shortcut
({'"Commands shortcuts"'}) -_document_gmic_subsection_ascii[-1] -v + -e[] "" -v - -rm[-1]
-v + -repeat $_shortcut
-e[] "    "$_gmic_m$_gmic_b"-"${_shortcut$>}" "${_shortcutqualifier$>}":"$_gmic_n" eq. to '"$_gmic_g${_shortcutlink$>}$_gmic_n"'."
-done -v -
-endif
-v + -e[] "\n   "$_gmic_c"[ Total number of commands: "$_command" ]"$_gmic_n -v -
_document_gmic_split_ascii :
-do -if {w>$1}
i={$1-1}
-repeat {$1/2} -if {C=i($1-1-$>);C==32||C==38||C==42||C==43||C==44||C==46||C==47||C==58||C==59||C==63||C==92||C==124} i={$1-1-$>} -break
-endif -done
--z[-1] {$i+1},100% -z[-2] 0,$i
-endif -while {w>$1}
_document_gmic_header_bash : -skip $1
-v +
-e[] "\#
\n\#  Bash completion rules for 'gmic'.
\n\#
\n\# This file has been generated automatically.
\n\# Do not edit!
\n\#
\n\# This file should be copied/renamed in '/etc/bash_completion.d/gmic'.
\n\#
\n
\n_"$_name"()
\n{
\n\tlocal cur prev opts coms
\n\tCOMPREPLY=()
\n\tcur=\"${COMP_WORDS[COMP_CWORD]}\"
\n\tprev=\"${COMP_WORDS[COMP_CWORD-1]}\"
"
-v -
_opts=
_coms=
_argcommand=0
_shortcut=0
_nbopts=0
_nbcoms=0
_document_gmic_subsection_bash :
_document_gmic_description_bash :
_document_gmic_example_bash :
_document_gmic_declaration_bash :
_opts$_nbopts=-@{0,t}" "--@{0,t}
_nbopts={$_nbopts+1}
_coms$_nbcoms=@{0,t}
_nbcoms={$_nbcoms+1}
-if {{@{0,t}'=='"input"}" || "{@{0,t}'=='"i"}" || "\
{@{0,t}'=='"output"}" || "{@{0,t}'=='"o"}" || "\
{@{0,t}'=='"command"}" || "{@{0,t}'=='"m"}} -return -endif
-repeat @# -if {@{$<,t}'=='"(+)"} -rm[$<] -endif -done
-if {@#==2" && "{@{-1,0-6}'=='{'"eq. to "'}}}
-rows[-1] 7,100% -autocrop[-1] {'.'} -autocrop[-1] {'" "'} -autocrop[-1] 39 -autocrop[-1] {'-'}
_shortcut$_shortcut=@{0,t}
_shortcutlink$_shortcut=@{-str2hex\ @{1,t}}
-rm[-1]
_shortcut={$_shortcut+1}
-elif {@#>1}
_command$_argcommand=@{0,t}
-if {@{0,t}'=='"help"} _argument$_argcommand="$coms\" -- \"$cur"
-else
-if {@#==2} ({'>'}) -endif
-discard[^0] {'" "'} -i[2--2] ({'" "'}) -a[^0] y
_argument$_argcommand=@{1,t}
-endif
_argumentlink@{-str2hex\ @{0,t}}=${_argument$_argcommand}
_argcommand={$_argcommand+1}
-endif
_document_gmic_footer_bash : -skip $1
-v +
-e[] "\topts=\"\\" -repeat $_nbopts -e[] "\t      "${_opts$>}\\ -done -e[] "\t     \""
-e[] "\n\tcoms=\"\\" -repeat $_nbcoms -e[] "\t      "${_coms$>}\\ -done -e[] "\t     \""
-e[] "\n\tcase \"${prev}\" in"
-repeat $_argcommand
-e[] "\t\t\"-"${_command$>}"\" | \"--"${_command$>}"\")"
-e[] "\t\tCOMPREPLY=( $(compgen -W \""${_argument$>}"\") )\n\t\treturn 0\n\t\t;;"
-done
-repeat $_shortcut
-if {narg(${_argumentlink${_shortcutlink$>}})}
-e[] "\t\t\"-"${_shortcut$>}"\" | \"--"${_shortcut$>}"\")"
-e[] "\t\tCOMPREPLY=( $(compgen -W \""${_argumentlink${_shortcutlink$>}}"\") )\n\t\treturn 0\n\t\t;;"
-endif
-done
-e[] "\tesac"
-e[] "\n\tif [[ \"$cur\" == -* ]] ; then
\n\t\tCOMPREPLY=( $(compgen -W \"$opts\" -- \"$cur\") )
\n\telse
\n\t\t_filedir
\n\tfi
\n
\n}
\n
complete -F _"$_name" -o filenames gmic"
-v -
_document_gmic_header_html :
-if $1 -v + -e[] "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">
\n<head>
\n<script type=\"text/javascript\" src=\"highslide/highslide.js\"></script>
\n<link rel=\"stylesheet\" type=\"text/css\" href=\"highslide/highslide.css\" />
\n<script type=\"text/javascript\">
\nhs.graphicsDir = 'highslide/graphics/';
\nhs.wrapperClassName = 'wide-border';
\n</script>
\n</head>
\n<body>
\n"
-v - -endif
-m "don : -_document_gmic_desc_on_html"
-m "doff : -_document_gmic_desc_off_html"
-m "eon : -_document_gmic_ex_on_html"
-m "eoff : -_document_gmic_ex_off_html"
_is_desc=0
_is_ex=0
_shortcut=0
_document_gmic_desc_on_html :
-v -
-if $_is_desc
-u "<br/>"
-else
-u "<p style=\"margin-left:100px\"><tt>"
_is_desc=1
-endif
-v +
_document_gmic_desc_off_html :
-v -
-if $_is_desc
-u "</tt></p>"
_is_desc=0
-else -u ""
-endif
-v +
_document_gmic_ex_on_html :
-v -
-if $_is_ex
-u ""
-else
-u "<br/><table style=\"margin-left:100px\" width=\"75%\" bgcolor=\"\#FFFFFF\" bordercolor=\"black\" border=\"1\" cellpadding=\"4\" cellspacing=\"0\">"\
"<tr><td colspan=\"2\" bgcolor=\"#000000\"><font color=\"white\"><b>Example of use:</b></font></td></tr>"
_is_ex=1
-endif
-v +
_document_gmic_ex_off_html :
-v -
-if $_is_ex
-u "</table>"
_is_ex=0
-else
-u ""
-endif
-v +
_document_gmic_subsection_html :
-v +
-e[] @{-eoff}@{-doff}"<br/><h2><a href=\"#toc\"><img src=\"img/back_top.png\"></img></a>&nbsp;&nbsp;"\
"<a id=\"subsection"$_subsection"\"><font color=\"#B00000\">"@{0,t}"</font></a></h2>"
-v -
_document_gmic_declaration_html :
-if {@{-1,t}'=='"(+)"} qualifier=" "@{-1,t} -rm[-1] -else qualifier="" -endif
s1="\n" s0=" |<br/>"
-if {@#>1" && "{@{-1,0-6}'=='{'"eq. to "'}}}
-rows[-1] 7,100% -autocrop[-1] {'.'} -autocrop[-1] {'" "'} -autocrop[-1] 39
_shortcut$_shortcut=@{0,t}
_shortcutlink$_shortcut=@{-1,t}
_shortcutqualifier$_shortcut=$qualifier
_shortcut={$_shortcut+1}
-else
_command_name=@{0,t}
-v +
-e[] @{-eoff}@{-doff}"<p style=\"margin-left:20px\"><a id=\""@{0,t}"\"><font color=\"#005090\">&nbsp;&nbsp;<b>-"@{0,t}$qualifier"</b>:</font></a>"
-if {@#>1}
-e[] "<p style=\"margin-left:120px\"><tt><i><font color=\"#900090\">"
-repeat {@#-1} -l[{1+$>}]
-if {h>48} -v - -replace_str ",",", " -v + -endif
-e[] @{0,t}${s{$<==0}}
-endl -done
-e[] "</font></i></tt></p>"
-else -e[] ""
-endif
-v -
-endif
_document_gmic_description_html :
-if {@{-1,0-12}'=='{'"Default value"'}}
-s +,{':'} -l[^0] -a y -endl -autocrop {':'} -autocrop {'" "'}
-v +
-if {@#>1} -e[] @{-don}"<br/><b>"@{0,t}"</b>: "@{-1,t}
-else -e[] @{-don}"<br/>"@{0,t}
-endif
-v -
-elif {@{-1,0-7}'=='{'"(eq. to "'}}
-v + -e[] @{-don}"<i><font color=\"blue\">"@{-1,t}"</font></i>" -v -
-else
-if {(i<{'A'}" || "i>{'Z'})" && "i!=40" && "i!=39} -v + -e[] @{-don}"&nbsp;"@{-1,t} -v -
-else -v + -e[] @{-don}@{-1,t} -v -
-endif
-endif
_document_gmic_example_html :
-if {i=={'$'}}
-if {h==1&&i=={'$'}} tuturl=http://gmic.eu/tutorial/_$_command_name.shtml
-else -autocrop {'$'} -autocrop {'" "'} tuturl=http://gmic.eu/tutorial/@{0,t}.shtml
-endif
-v +
-e[] @{-eon}"<tr><td width=\"24\" align=\"center\"><a target=\"_blank\" href=\""$tuturl"\"><img src=\"img/moreinfos.png\"></img></td>"\
"<td><a target=\"_blank\" href=\""$tuturl"\">A tutorial page exists for this command.</a></td></tr>"
-v -
-else
-if $_filename -else
-m "foo : "@{-1,t}
-l[] -v -99 -reset -foo -v -1 -_document_gmic -o $_filename,85 -rm -endl
-uncommand foo
-endif
-v +
-e[] @{-eon}"<tr><td width=\"24\" align=\"center\"><div><a href=\""$_filename"\" class=\"highslide\" onclick=\"return hs.expand(this)\">"\
"<font color=\"blue\"><img src=\"img/zoom.png\"></img></font></a><div class=\"highslide-caption\">"@{-1,t}"</div></div></td><td><tt>"@{-1,t}"</tt></td></tr>"
-v -
-endif
_document_gmic_footer_html : -skip $1
-if $_shortcut
_subsection={$_subsection+1}
({'"Commands shortcuts"'}) -_document_gmic_subsection_html[-1] -rm[-1]
-v + -e[] "<p style=\"margin-left:20px\">"
-repeat $_shortcut
-e[] "<font color=\"green\"><b>&nbsp;&nbsp;-"${_shortcut$>}" "${_shortcutqualifier$>}"</b>:</font>"
-e[] "<font color=\"blue\"><i>eq. to '"${_shortcutlink$>}"'</i></font><br/>"
-done
-e[] "</p>" -v -
-endif
-v +
-e[] @{-eoff}@{-doff}"<p style=\"margin-left:100px\"><font color=\"blue\"><b>[ Total number of commands: "$_command" ]</b></font>"
-v -
-uncommand don,doff,eon,eoff
_document_gmic_header_images : -skip $1
-v +
-e[] "\n - Generate example images from set of commands '"$_name"'.\n"
-v -
_document_gmic_subsection_images :
-v +
-e[] "\n ** Section \#"$_subsection": "@{0,t}".\n"
-v -
_document_gmic_declaration_images : _command_name=@{0,t}
_document_gmic_description_images :
_document_gmic_example_images :
-if {i=={'$'}} -return -endif
-v +
-e[] "    ["$_example"] Command '-"$_command_name"': $ "@{-1,t}
-v -
-if $_filename -else
-m "foo"$_example" : "@{-1,t}
-l[] -v -1 -reset -v -99 -foo$_example -v -1 -_document_gmic -o $_filename,85 -rm -endl
-uncommand foo$_example
-endif
_document_gmic_footer_images : -skip $1
-v +
-e[] " - [ All done! ]\n\n"
-v -
_document_gmic_header_latex :
-if $1 -v +
-e[] "\\documentclass[a4paper,10pt,twoside]{book}
\n\\usepackage{hyperref,fancyhdr,graphicx,amssymb,amsmath,times,makeidx,color}
\n\\graphicspath{{"$_path"}}
\n\\pagestyle{fancyplain}
\n\\lhead[\\fancyplain{}{\\textbf\\thepage}]{\\fancyplain{}{\\rightmark}}
\n\\rhead[\\fancyplain{}{\\leftmark}]{\\fancyplain{}{\\textbf\\thepage}}
\n\\cfoot{}
\n\\setlength{\\textwidth}{5.875in}
\n\\setlength{\\parindent}{0pc}
\n\\setlength{\\hoffset}{-0.8cm}
\n\\setcounter{tocdepth}{1}
\n\\sloppy{}
\n\\definecolor{ca}{rgb}{0.8,0,0}
\n\\definecolor{cb}{rgb}{0,0.2,0.6}
\n\\definecolor{cc}{rgb}{0,0.5,0}
\n\\definecolor{cd}{rgb}{0.6,0.6,0.6}
\n\\newcommand{\\Ca}[1]{\\textcolor{ca}{#1}}
\n\\newcommand{\\Cb}[1]{\\textcolor{cb}{#1}}
\n\\newcommand{\\Cc}[1]{\\textcolor{cc}{#1}}
\n\\newcommand{\\Cd}[1]{\\textcolor{cd}{#1}}
\n\\renewcommand\\indexname{Index of commands}
\n\\makeindex
\n\\begin{document}
\n\\tableofcontents"
-v - -endif
-v + -e[] "\n\\chapter{List of commands}" -v -
-m "eon : -_document_gmic_ex_on_latex"
-m "eoff : -_document_gmic_ex_off_latex"
_is_desc=0
_is_ex=0
_shortcut=0
_document_gmic_ex_on_latex :
-v -
-if $_is_ex
-u "\\\\"
-else
-u "\\begin{center}"
_is_ex=1
-endif
-v +
_document_gmic_ex_off_latex :
-v -
-if $_is_ex
-u "\\end{center}"
_is_ex=0
-else
-u ""
-endif
-v +
_document_gmic_subsection_latex :
_is_desc=0
-_document_gmic_replace_latex
-v + -e[] @{-eoff}"\n\\section{"@{0,t}"}" -v -
_document_gmic_declaration_latex :
_is_desc=0
-if {@{-1,t}'=='"(+)"} qualifier=@{-1,t} -rm[-1] -else qualifier="" -endif
e1="\\\\~\\\\" e0="~~~$|$\\\\"
s1="\\hspace*{2.2cm}" s0=""
-if {@#>1" && "{@{-1,0-6}'=='{'"eq. to "'}}}
-_document_gmic_replace_latex
-rows[-1] 7,100% -autocrop[-1] {'.'} -autocrop[-1] {'" "'} -autocrop[-1] 39
_shortcut$_shortcut=@{0,t}
_shortcutlink$_shortcut=@{-1,t}
_shortcutqualifier$_shortcut=$qualifier
_shortcut={$_shortcut+1}
-else
-_document_gmic_replace_latex[0]
_command_name=@{0,t}
-v + -e[] @{-eoff}"\n\n\\subsection{\\emph{-"@{0,t}"\\index{-"@{0,t}"}} "$qualifier"}\\vspace*{-0.5em}"
-if {@#>1}
-e[] "~\\\\\\textbf{\\Cb{Arguments: }} "
-repeat {@#-1} -l[{1+$>}]
-v - -s y,-60 -if {@#>1} -i[1--2] ({'\\-'}) -endif -y -a y
-_document_gmic_replace_latex -v +
-e[] ${s{$>!=0}}"{\\small \\Cb{\\texttt{"@{0,t}"}}}"${e{$<==0}}
-endl -done
-endif
-v -
-endif
_document_gmic_description_latex :
s0="" s1="~\\\\" s=${s$_is_desc}
-_document_gmic_replace_latex
-if {@{-1,0-12}'=='{'"Default value"'}}
-s +,{':'} -l[^0] -a y -endl -autocrop {':'} -autocrop {'" "'}
-if {@#>1}
-replace_str[1] " and ","} and \\\\texttt{"
-v + -e[] @{-eoff}$s"~\\\\\\Cc{\\textbf{"@{0,t}"}: {\\small \\texttt{"@{-1,t}"}}}" -v -
-else -v + -e[] @{-eoff}$s"~\\\\"@{0,t} -v -
-endif
-elif {@{-1,0-7}'=='{'"(eq. to "'}}
-rows[-1] 8,100% -autocrop[-1] {'.'} -autocrop[-1] {')'} -autocrop[-1] {'" "'}
-v + -e[] @{-eoff}$s"(\\emph{eq. to} {\\small \\texttt{"@{-1,t}"}})." -v -
-else
-if {(i<{'A'}" || "i>{'Z'})" && "i!=40" && "i!=39} -v + -e[] @{-eoff}@{-1,t} -v -
-else -v + -e[] @{-eoff}$s@{-1,t} -v -
-endif
-endif
_is_desc=1
_document_gmic_example_latex :
-if {i=={'$'}}
-if {h==1&&i=={'$'}} tuturl=http://gmic.eu/tutorial/\\_$_command_name.shtml
-else -autocrop {'$'} -autocrop {'" "'} tuturl=http://gmic.eu/tutorial/@{0,t}.shtml
-endif
-l[] ({'$tuturl'}) -replace_str "_","\\_"
-s x,-60 -if {@#>1} -i[1--2] ({'\\\\-'}) -endif -a x
-replace_str[-1] "_","\\_" tuturl=@{-1,t} -rm -endl
-v +
-e[] @{-eoff}
-if {!$_is_ex} -e[] "~\\\\" -endif
-e[] "~\\textbf{Tutorial page: }\\\\\\tt{"$tuturl"}"
-v -
-else
_is_desc=0
-if $_filename -else
-m "foo : "@{-1,t}
-l[] -v -99 -reset -foo -v -1 -_document_gmic -o $_filename,85 -rm -endl
-uncommand foo
-endif
-_document_gmic_replace_latex
-v +
-e[] @{-eon}"\\includegraphics[keepaspectratio=true,height=7cm,width=\\textwidth]{"$_filename"}\\\\"
-e[] "{\\footnotesize \\textbf{Example "$_example"~:} \\texttt{"@{-1,t}"}}"
-v -
-endif
_document_gmic_footer_latex :
-if $_shortcut
({'"Commands shortcuts"'}) -_document_gmic_subsection_latex[-1] -rm[-1]
-v + -repeat $_shortcut
-e[] "$\\bullet$~'\\texttt{\\Ca{-"${_shortcut$>}"}}' "${_shortcutqualifier$>}"~is equivalent to~~'\\texttt{\\Ca{"${_shortcutlink$>}"}}'.\\\\"
-done -v -
-endif
-if $1
-v +
-e[] "
\n\\printindex
\n~\\\\$\\square$~End of document.
\n\n\\end{document}"
-v -
-endif
-uncommand eon,eoff
_document_gmic_replace_latex :
-replace_str "\\","\\\\textbackslash "
-replace_str "_","\\\\_"
-replace_str "%","\\\\%"
-replace_str "#","\\\\%"
-replace_str "^","\\\\textasciicircum "
-replace_str "$","\\\\$"
-replace_str "\{","\\\\\{"
-replace_str "\}","\\\\\}"
-replace_str "&","\\\\&"
-replace_str "|","~$|$~"
-replace_str "<","$\<$"
-replace_str ">","$\>$"
-replace_str "\\\\textbackslash -","\\\\-"
_document_gmic_header_man : -skip $1
_gmic_n="\\fR" _gmic_b="\\fB" _gmic_r="" _gmic_g="" _gmic_c="\\fB" _gmic_m=""
-_document_gmic_header_ascii $"*"
_document_gmic_subsection_man :
-v +
-e[] "\n "$_gmic_b"** "@{0,t}":"$_gmic_n
-v -
_document_gmic_declaration_man :
-if {@{-1,t}'=='"(+)"} qualifier=" "@{-1,t} -rm[-1] -else qualifier="" -endif
-if {@#>1" && "{@{-1,0-6}'=='{'"eq. to "'}}}
-rows[-1] 7,100% -autocrop[-1] {'.'} -autocrop[-1] {'" "'} -autocrop[-1] 39
_shortcut$_shortcut=@{0,t}
_shortcutlink$_shortcut=@{-1,t}
_shortcutqualifier$_shortcut=$qualifier
_shortcut={$_shortcut+1}
-else
-v + -e[] "\n    "${_gmic_b}"-"@{0,t}${qualifier}":"$_gmic_n -v - -rm[0]
-if @#
s="                        "
-y x
-repeat {@#-1} ({'" |"'}) -a[$>,-1] x -done
-repeat @# -l[$>] -_document_gmic_split_ascii 80,0
-repeat {@#-1} ({'\n$s"  "'}) -a[$>,-1] x -done
-a x -v + -e[] $s@{0,t} -v -
-endl -done
-endif
-v + -e[] "" -v -
-endif
_document_gmic_description_man :
s="        " bs0="\n" bs1="\\\\\n         "
-y x -if {!narg($_is_tutorial)} -_document_gmic_split_ascii 96 -endif
-repeat {@#-1} ({'${bs$_is_example}$s"  "'}) -a[$>,-1] x -done -a x
-replace_str "Default values:","Default values:"
-replace_str "Default value:","Default value:"
-replace_str "\\","\\\\"
-v + -repeat @# -e[] $s@{$>,t} -v - -done
_document_gmic_example_man :
_document_gmic_footer_man : -skip $1
-_document_gmic_footer_ascii $"*"
_document_gmic :
-repeat @# -l[$>] W$>={w} H$>={h} D$>={d} S$>={s} IS_3D$>=@{-is_3d} -endl -done
-repeat @# -l[$>] -if @{-is_3d} -r3d 1,1,0,-80 -r3d 0,1,0,80 -snapshot3d 400 -else -n 0,255 -endif -endl -done
--append_tiles , -if {w>900} r={round(900*100/w,0.1)} -r[^-1] $r%,$r%,1,100%,2 -endif -rm[-1]
-repeat @# -l[$>]
-if {s==1} -r {w},{h},1,3 -else -r {w},{h},1,3,0 -endif
-if {w<=h&&h<256} -r2dy 256,2 -elif {h<=w&&w<256} -r2dx 256,2 -endif
-if {w<=h&&h>512} -r2dy 512,2 -elif {h<=w&&w>512} -r2dx 512,2 -endif
-if {h<48} -r 100%,48 -endif
-if {w<48} -r 48,100% -endif
-frame 1,1,0 -frame 4,4,255
-endl -done
N=@# -repeat $N -l[$>]
{w},16,1,3,255
-if {w>75}
-if {$N>1} -if {w>110} -t[-1] Image\ [$>]:,3,3,15 -else -t[-1] [$>]:,3,3,15 -endif -endif
-if ${IS_3D$>} 0 -t[-1] (3d\ object),0,0,13,1,255
-else 0 -t[-1] (${W$>}x${H$>}x${D$>}x${S$>}),0,0,13,1,255
-endif
-negative[-1] -n[-1] 0,255 -+[-1] 164 -c[-1] 0,255 -to_rgb[-1]
-j[-2] [-1],{@{-2,w}-w-5},{@{-2,h}-h-1} -rm[-1]
-else -t[-1] [$>]:,3,3,15 -endif
-rv[-2,-1] -a[-2,-1] y
-endl -done
-- 255 -append_tiles , -+ 255
-if {w<256} -- 255 -r 256,100%,1,3,0,0,0.5,0.5 -+ 255 -endif
-if {h<256} -- 255 -r 100%,256,1,3,0,0,0.5,0.5 -+ 255 -endif
echo_file : -skip "${2='\n'}"
-v - ({"'${2--1}\n'"}) -o[-1] raw:$1,char -rm[-1] -v +
echo_stdout :
-v - ({'"$*"\n'}) -o[-1] -.raw,char -rm[-1] -v +
function1d : -check "${1=1}>=0 && $1<=1" -skip ${2=0},${3=0}
-e[^-1] "Input continuous 1d function, with smoothness $1 and keypoints (${2--1})."
-v - -l[]
smoothness={max(0,min(1,$1))}
(${2--1}) -r 2,{int(w/2)},1,1,-1
-sort +,y -s x size=@{0,if(iM>=0,1+int(iM),0)}
-if {!$size} -rm 0 -break -endif
-a x
--f '0.5*(j(0,1,0,0,0,1)-j(0,-1,0,0,0,1))' -s[-1] x -max[-2] 0.01 -/[-1] [-2] -rm[-2] -a x
$size,1,1,1,-1
-repeat @{0,h-1}
x0=@{0,i(0,$>)} y0=@{0,i(1,$>)} x1=@{0,i(0,$>+1)} y1=@{0,i(1,$>+1)}
slope={($y1-$y0)/max(0.01,$x1-$x0)}
yp0=@{0,i(2,$>)*$smoothness+(1-$smoothness)*$slope}
yp1=@{0,i(2,$>+1)*$smoothness+(1-$smoothness)*$slope}
i={round($x0,1,1)} j={round($x1,1,0)}
-line[1] $i,0,$j,0,1,$>
-if {$j-$i<=1}
({$y0-$x0*$slope}^{$slope}^0^0)
-else
(1,$x0,{($x0)^2},{($x0)^3};\
1,$x1,{($x1)^2},{($x1)^3};\
0,1,{2*$x0},{3*($x0)^2};\
0,1,{2*$x1},{3*($x1)^2})
($y0;$y1;$yp0;$yp1)
-solve[-1] [-2] -rm[-2] -y[-1] c
-endif
-done
-a[2--1] x -map[-2] [-1] -rm[-1]
100%,1,1,1,1
(0,{w-1}) -r[-1] @{-2,w},1,1,1,3 -round[-1]
--sqr[-1] --*[-2,-1] -a[-4--1] c -*[-2,-1] -s[-1] c -+[-4--1] -rm[-2]
-endl -v +
gmicky :
-e[^-1] "Load image of the G\47MIC mascot 'Gmicky'."
-v - -i http://gmic.eu/img/gmicky_large.cimgz -nm[-1] [gmicky] -v +
gmicky_wilber :
-e[^-1] "Load image of the G\47MIC mascot 'Gmicky' together with GIMP mascot 'Wilber'."
-v - -i http://gmic.eu/img/gmicky_wilber_large.cimgz -nm[-1] [gmicky_wilber] -v +
heart : -check "${1=512}>=1 && ${2=$1}>=1"
-e[^-1] "Input $1x$2 heart binary mask."
-v - -l[]
2048,1,1,1,'t=2*pi*x/w;16*sin(t)^3'
2048,1,1,1,'t=2*pi*x/w;13*cos(t)-5*cos(2*t)-2*cos(3*t)-cos(4*t)'
-a c -display_parametric $1,$2,1,0,0,0
-flood 50%,50%,0,0,0,1,0 -==[-1] 0
-nm "[Heart binary mask]"
-endl -v +
input_gpl :
-e[^-1] "Input GIMP palette file '$*'."
-v - -l[]
-i raw:"$*",char -replace 9,32 -s -,10
colors=0
-repeat @# -l[$>]
-s -,32
-if {@#>=3" && "isint(@{0,t})" && "isint(@{1,t})" && "isint(@{2,t})} colors=$colors;@{0,t},@{1,t},@{2,t} -endif
-rm 0
-onfail -rm 0 -endl -done
-rm ($colors) -rows 1,100% -nm "$1" -permute yzcx
-endl -v +
output_ggr : -skip "${2=}"
-e[^-1] "Output image$? as GIMP gradient file '$1'."
-v - N=@#
-repeat $N --l[$>] -r 1,{w*h*d},1,100%,-1 -to_rgba -/ 255
-if {narg("$2")} name="$2"
-else -l[] 1 -nm[-1] "$1" ({'@{-1,b}'}) -f "if(x==0&&i>="{'a'}"&&i<="{'z'}",i-"{'a'}"+"{'A'}",i)" name=@{-1,t} -rm -endl
-endif
({'"GIMP Gradient\nName: "$name\n@{0,h}\n'})
-repeat @{0,h}
start={_$>/@{0,h}}
end={_($>+1)/@{0,h}}
mid={_0.5*($start+$end)}
rgba=@{-at[0]\ 0,$>}
r={arg(1,$rgba)} g={arg(2,$rgba)} b={arg(3,$rgba)} a={arg(4,$rgba)}
({'$start" "$mid" "$end" "$r" "$g" "$b" "$a" "$r" "$g" "$b" "$a" 0 0\n"'})
-done
-rm[0] -a x
-if {$N>1} -o raw:@{"-filename \"$1\",$>"},char -else -o raw:"$1",char -endif
-rm
-endl -done -v +
on :
-v - _gmic_s="$?" -v +
-_outputn $*
outputn :
-v - _gmic_s="$?" -v +
-_$0 $*
_outputn :
-v - filename=@{-filename\ "$1",@{>}} -v +
-e[0--3] "Output image"$_gmic_s" as file '"$filename"'."
-v - -o $filename -v +
op :
-v - _gmic_s="$?" -v +
-_outputp $*
outputp :
-v - _gmic_s="$?" -v +
-_$0 $*
_outputp : -skip ${1="_"}
-if {@#>1} -e[0--4] "Output image"$_gmic_s" as their initial locations, prefixed by '$1'."
-else -e[0--4] "Output image"$_gmic_s" as its initial location, prefixed by '$1'."
-endif
-v - -repeat @# -o[$>] @{$>,f}$1@{$>,b}.@{$>,x} -done -v +
ow :
-v - _gmic_s="$?" -v +
-_outputw
outputw :
-v - _gmic_s="$?" -v +
-_$0 $*
_outputw :
-if {@#>1} -e[0--4] "Output image"$_gmic_s" as their initial location."
-else -e[0--4] "Output image"$_gmic_s" as its initial location."
-endif
-v - -repeat @# -o[$>] @{$>,n} -done -v +
ox :
-v - _gmic_s="$?" -v +
-_outputx $*
outputx :
-v - _gmic_s="$?" -v +
-_$0 $*
_outputx :
-v -
$=arg
is_last_arg=0 is_same_location=0
-if {isval($-1)} is_last_arg={isint($-1)&&$-1>=0&&$-1<=1} is_same_location=$-1 -endif
N={$#-$is_last_arg} s0= s1=s
-if {!$N} -v + -e[0--3] "Output image"$_gmic_s" at same location, with same base filename but extension '' (skipped, no extension provided)." -return
-endif
-if $is_same_location
-v +
-if $is_last_arg -e[0--4] "Output image"$_gmic_s" at same location, with same base filename but extension"${s{$N>1}}"' ${^-1}'."
-else -e[0--4] "Output image"$_gmic_s" at same location, with same base filename but extension"${s{$N>1}}" '$*'."
-endif
-v -  -repeat @# -l[$>]
-repeat $N -o @{0,f}@{0,b}.${arg{1+$>}} -done
-endl -done
-else
-v +
-if $is_last_arg -e[0--4] "Output image"$_gmic_s" with same base filename but extension"${s{$N>1}}"' ${^-1}'."
-else -e[0--4] "Output image"$_gmic_s" with same base filename but extension"${s{$N>1}}" '$*'."
-endif
-v -  -repeat @# -l[$>]
-repeat $N -o @{0,b}.${arg{1+$>}} -done
-endl -done
-endif
-v +
rainbow_lut :
-e[^-1] "Input RGB colormap of 256 rainbow colors."
-v -
(2,10,13,13,15,16,15,15,18,23,26,31,33,37,38,39,42,42,44,45,44,44,45,45,44,42,44,45,45,49,50,52,54,55,56,57,\
56,56,57,57,58,57,58,58,59,58,60,59,58,59,59,59,59,59,60,60,59,59,59,59,60,59,59,59,59,59,59,59,58,58,58,56,\
56,54,51,48,44,39,33,20,5,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,25,50,66,81,90,102,109,118,129,137,144,152,158,168,178,183,190,199,207,\
213,220,227,230,236,242,246,250,255,255,253,253,253,252,251,250,250,249,248,248,247,248,246,246,246,245,246,\
245,245,245,246,246,246,246,246,246,246,246,245,245,245,245,245,244,245,244,245,245,245,245,245,245,245,245,\
245,244,244,245,245,243,239,235,230,226,220,216,211,204,201,194,190,184,176,171,164,160,152,144,138,130,122,\
114,107,96,87,78,69,57,50,46,38,31,19,5^3,10,14,15,17,18,19,18,19,23,25,30,31,35,37,39,42,44,45,48,49,50,51,\
52,53,56,59,63,66,66,68,69,71,73,74,75,76,76,77,78,79,79,80,81,81,82,82,83,84,84,84,84,84,85,85,86,86,86,86,\
87,88,87,86,86,86,86,88,89,89,90,92,92,94,96,99,102,104,107,111,117,120,126,130,136,142,149,155,161,167,172,\
176,178,179,179,178,178,178,178,177,177,177,176,176,176,176,175,173,173,174,173,172,171,171,171,171,171,171,\
171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,173,173,173,175,176,178,178,178,181,182,184,\
186,186,190,192,193,195,198,200,201,204,206,209,211,208,206,202,197,194,190,185,182,178,172,167,162,157,152,\
144,139,132,127,121,115,108,102,98,92,87,79,75,69,64,62,58,55,52,50,49,47,47,47,47,47,47,47,47,46,46,46,46,\
45,44,44,42,42,41,41,40,39,38,37,36,34,31,30,29,30,30,31,32,32,32,33,33,34,34,33,34,33,32,31,31,30,29,26,25,\
23,21,19,15,13,13,16,18,18,18,17,15,13,12,9,2^6,19,25,32,41,49,55,65,71,79,84,90,96,102,106,111,117,121,128,\
132,134,139,143,146,149,152,155,156,157,159,159,160,161,162,163,164,164,165,166,167,166,165,166,166,167,167,\
168,168,168,169,169,169,169,170,170,170,170,170,170,170,171,170,170,170,170,170,171,171,172,173,173,173,175,\
177,179,180,183,185,187,190,193,198,201,206,213,219,225,227,227,223,218,214,204,199,192,184,179,172,168,162,\
156,151,145,139,133,126,120,113,106,98,90,85,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,84,84,82,82,82,\
82,82,83,83,81,81,81,80,80,78,78,78,76,74,73,73,71,72,69,68,67,65,62,59,58,56,51,50,49,45,43,40,38,37,35,32,\
31,32,32,33,33,34,34,35,36,36,37,38,39,42,44,45,46,46,47,48,49,48,48,48,48,48,48,48,48,48,48,47,47,47,47,46,\
45,45,43,43,42,41,40,39,38,37,38,38,37,37,38,38,38,38,39,40,39,40,39,40,40,39,39,38,38,37,35,34,32,30,28,26,\
23,20,16,14,12,16,16,18,18,17,16,14,13,9,2)
-nm[-1] [rainbow\ lut]
-v +
roddy :
-e[^-1] "Load image of the G\47MIC Rodilius mascot 'Roddy'."
-v - -i http://gmic.eu/img/roddy_large.cimgz -nm[-1] [roddy] -v +
testimage2d : -check "${1=512}>0 && ${2=$1}>0 && ${3=3}>0"
-e[^-1] "Input 2d synthetic image of size $1x$2x$3."
-v -
Dmax2={0.15*min($1,$2)^2}
$1,$2,1,$3,'X=x-w/2;Y=y-h/2;a=atan2(Y,X);if(X^2+Y^2<=$Dmax2,255*abs(cos(c+200*(x/w-0.5)*(y/h-0.5))),850*(a%(0.1*(c+1))))'
-polygon[-1] 4,20%,20%,60%,20%,70%,70%,35%,45%,0.9,0,255,0
-torus3d {$1/7},{$1/20} -r3d[-1] 0,1,1,80 -col3d[-1] 128,200,255
-j3d[-2] [-1],30%,70%,0,1,5,0,0 -rm[-1] -round[-1] 1
-nm[-1] "[2d test image]"
-v +
uniform_distribution : -check "isint($1) && $1>0 && isint($2) && $2>0"
-e[^1] "Input set of $1 uniformly distributed $2-d points in [0,1]^$2."
-v - n={round($1^(1/$2),1,1)}
(0,1) -r[-1] $n,1,1,1,3
-repeat {$2-1} --channels[-1] 100% -r[-1] {$n*w},1,1,1,1 -r[-2] [-1],1,1,100%,0,2 -a[-2,-1] c -done
-r[-1] $1,1,1,$2,1 -nm[-1] "[uniform $2d distribution]" -v +
up :
-_update
update :
-_$0
_update :
-e[0--3] "Update commands from the latest definition file on the G\47MIC server."
-v -
-if @{-is_windows} out=$APPDATA/update@..gmic -else out=$HOME/.update@..gmic -endif
-l[] cimgz:http://gmic.eu/update@..gmic
-if {h>7" && "{@{-1,0-5}'=='{'"#@gmic"'}}} -o raw:$out,char -endif
-rm
-onfail -error[0--3] "Command '-update' : Unreachable update file."
-endl
-m $out
-v +
update_film_emulation_html :
-if {!@#} -error[^-1] "Command '-update_film_emulation': Missing input images !" -endif
-v -
jpeg_quality=70
thumb_width=180
thumb_height=90
categories=bw,instant_consumer,instant_pro,negative_color,negative_new,negative_old,print,colorslide,various
category_names="Black and White","Instant [consumer]","Instant [pro]","Negative [color]","Negative [new]","Negative [old]","Print films","Slide [color]","Various"
film_path=@{-path_user}
-if {!@{-is_windows}} film_path=$film_path/.gmic_film_presets -endif
-m "_thumb : -frame 3%,3%,255 -to_rgba -drop_shadow 2,2,3 -repeat @# -l[$>] -i[0] 100%,100%,1,3,245 -blend alpha -endl -done"
-m "_title : ({'\"$""*\"'}) -replace[-1] {'_'},32 -f[-1] if((x==0||j(-1)==32)&&i>={'a'}&&i<={'z'},i+{'A'}-{'a'},i) -u @{-1,t} -rm[-1]"
nb_presets=0
-repeat {narg($categories)}
category=@{-arg\ {1+$>},$categories}
presets=@{-_gimp_emulate_film_$category}
nb_presets={$nb_presets+narg($presets)}
-done
-v + -e[] "\n > Update film emulation pages, for "@#" image samples and "$nb_presets" presets." -v -
-v + -e[] "\n  * Prepare folder structure." -v -
-x "ln -fs ../copyright.html ."
-x "ln -fs ../favicon.ico ."
-x "ln -fs ../favicon.png ."
-x "ln -fs ../footer.html ."
-x "ln -fs ../header.html ."
-x "ln -fs ../header.css ."
-x "ln -fs ../jquery-1.11.0.min.js ."
-x "ln -fs ../images ."
-x "mkdir -p img"
-x "cd img && ln -fs ../../img/logo4.jpg ."
-x "cd img && ln -fs ../../img/logos.jpg ."
-x "cd img && ln -fs ../../img/rss.png ."
-x "ln -fs ../highslide ."
-v + -e[] "\n  * Generate thumbnails from samples." -v -
-if original -else -x "mkdir original" -endif
nb_samples=@#
-to_rgb -repeat $nb_samples -l[$<]
-nm[0] sample_{1+$<}
basename=@{0,b} basename$<=$basename
-v + -e[] "    - "$basename -v -
--r2dx $thumb_width
--text_outline[0] "Reference",4,@{0,h-28},20,2 -frame[-1] 1,1,0
-o[-1] original/$basename.jpg,$jpeg_quality -rm[-1]
--_thumb[1] -o[-1] original/thumb_$basename.jpg,$jpeg_quality -rm[-1]
--r2dy[0] $thumb_height -_thumb[-1] -o[-1] original/minithumb_$basename.jpg,$jpeg_quality -rm[-1]
-endl -done
ind_preset=0
-repeat {narg($categories)}
category=@{-arg\ {1+$>},$categories}
presets=@{-_gimp_emulate_film_$category}
-v + -e[] "\n  * Category \#"{1+$>}": "$category" ***\n" -v -
-if $category -else -x "mkdir "$category -endif
-if $category/clut -else -x "mkdir "$category/clut -endif
-repeat {narg($presets)}
preset=@{-arg\ {1+$>},$presets}
filename=$film_path/gmic_$preset.cimgz
-v + -e[] "    - "$preset -v -
-i $filename -to_rgb[-1] s={sqrt(w*h*d)}
-if {!isint($s)}
-v + -warn[] "Preset '"$preset"' must be resampled." -v -
-r[-1] 64,64,64,3,3
-endif
s={sqrt(w*h*d)} --r[-1] $s,$s,1,3,-1
-if {iM<=255} -*[-1] 257 -endif
-o[-1] $category/clut/$preset.png
-rm[-1]
-repeat $nb_samples -l[{2*$>},{2*$>+1},-1]
basename=@{0,b}
-if $category/$basename/$preset.jpg -else
-if $category/$basename -else -x "mkdir \""$category/$basename"\"" -endif
--map_clut[^-1] [-1]
-text_outline[-2] @{-_title\ $preset},4,@{-2,h-28},20,2 -frame[-2] 1,1,0
-o[-2] $category/$basename/$preset.jpg,$jpeg_quality
-_thumb[-1] -o[-1] $category/$basename/thumb_$preset.jpg,$jpeg_quality
-rm[-2,-1]
-endif
-endl -done
-rm[-1]
ind_preset={$ind_preset+1}
-done
-done
-rm[1--1:2]
-v + -e[] "\n  * Generate html code.\n" -v -
-repeat {narg($categories)}
category=@{-arg\ {1+$>},$categories}
-arg {1+$>},$category_names
category_name=@{}
presets=@{-_gimp_emulate_film_$category}
-repeat $nb_samples
width=@{$>,64+w} height=@{$>,64+h}
basename=@{$>,b}
-v + -e[] "    - "$category_name" / "$basename -v -
({'"
<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n
\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n\n
<!--#include file=\"header.html\" -->\n
<script type="text/javascript">\n
hs.align = 'center';\n
</script>\n
<link href=\"../style.css\" rel=\"stylesheet\" type=\"text/css\">\n\n
<div id=\"bloc_option\"><div id=\"top_bleu\"><div id=\"text_top\">Film Emulation</div></div>\n
<div id=\"center\"><div id=\"text_centre_intro\">\n
<p>Among all features available in <b><font color=\"#000066\">G\47MIC</font></b>, our <b>Film Emulation</b> filters are able to apply various pre-defined <b>color presets</b> on your images.\n
Most of those <b>300+</b> presets have been designed by <a href=\"http://blog.patdavid.net/2013/08/film-emulation-presets-in-gmic-gimp.html\">Patrick David</a>, in order to emulate the look of\n
analog films. They have a dedicated section in the open-source <a href=\"../gimp.shtml\"><b><font color=\"#000066\">G\47MIC</font></b> plug-in for GIMP</a>, so you can apply all these easily in GIMP.</p>\n\n
<p>Below, you can navigate through the different proposed color presets and see how they modify the colors of some sample images.\na
You can also download each color preset separately as its corresponding <a href=\"http://www.quelsolaar.com/technology/clut.html\">Hald-CLUT</a> file (in <b>.png</b> format), to use it in\n
other softwares that support this feature.</p>\n\n
<p><b>Image credits:</b> All sample images below have been borrowed from <a href=\"https://www.flickr.com/photos/patdavid/\">Patrick David\47s Flickr</a> and are distributed under\n
<a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-by-SA 2.0</a>.</p>\n\n
<p><font size=\"-1\"><b>Disclaimer:</b><br/>\n
<i>The trademarked names which may appear in the filenames of the Hald CLUT images are there for informational purposes only. They serve only to inform the user which film stock the given Hald CLUT image\n
is designed to approximate. As there is no way to convey this information other than by using the trademarked name, we believe this constitutes fair use. Neither the publisher nor the authors are affiliated\n
with or endorsed by the companies that own the trademarks.</i></font></p>\n\n
</div></div><div id="footer"><img src="images/footer.jpg" /></div></div>\n
<div id=\"bloc_option\"><div id=\"top_bleu\"><div id=\"text_top\"><a id=\"browse\">Browse</a></div></div>\n
<div id=\"center\"><div id=\"text_centre_intro\">\n
<table><tr>\n
<td valign=\"top\" width=\"300\">Select film category:\n
<ul>\n"'})
-repeat {narg($categories)}
_category=@{-arg\ {1+$>},$categories}
-arg {1+$>},$category_names
_category_name=@{}
-if {$_category'=='$category}
({'"
<li><font color="#CC7700"><b>"$_category_name"</b></font></li>\n
"'})
-else
({'"
<li><a href=\""${_category}_$basename.shtml"#browse\">"$_category_name"</a></li>\n
"'})
-endif
-done
({'"
</ul>\n
</td>\n
<td valign=\"top\">Select sample image:<br/><br/>\n
"'})
-repeat {$nb_samples}
_basename=${basename$>}
-if {$_basename'=='$basename}
({'"
<a href=\""${category}_$_basename.shtml"#browse\"><img style=\"border-color:#CC7700;\" border=\"3\" src=\""original/minithumb_$_basename.jpg"\"/></a>\n
"'})
-else
({'"
<a href=\""${category}_$_basename.shtml"#browse\"><img src=\""original/minithumb_$_basename.jpg"\"/></a>\n
"'})
-endif
-done
({'"
</td>\n
</tr></table>\n
</div></div><div id="footer"><img src="images/footer.jpg" /></div></div>\n
"'})
({'"\n
<div id=\"bloc_option\"><div id=\"top_bleu\"><div id=\"text_top\">Presets ("{narg($presets)}")</div></div>\n
<div id=\"center\"><div id=\"text_centre_intro\">\n
<center><table>\n
<tr><td>\n
<div><a href=\"original/"$basename".jpg\" class=\"highslide\" onclick=\"return hs.expand(this)\"><img src=\"original/thumb_"$basename".jpg\" /></a>\n
<div class=\"highslide-caption\"><b>Reference Image</b></div></div>\n
</td></tr>\n
<tr><td align=\"center\"><b>Refence Image</b></td></tr>\n\n
"'})
-repeat {narg($presets)}
preset=@{-arg\ {1+$>},$presets}
({'$preset'}) -replace_seq[-1] 39,"92,92,39" preset_esc=@{-1,t} -rm[-1]
title=@{-_title\ $preset}
-if {$>%4==0} -if $> ({'"</tr>\n"'}) -endif ({'"<tr>"'}) -endif
({'"
<td><table>\n
<tr><td>\n
<div><a href=\"#\" onclick=\"return hs.htmlExpand(this, { width: "$width", height: "$height" })\">\n
<img src=\""$category/$basename/thumb_$preset".jpg\" />\n
</a>\n
<div class=\"highslide-maincontent\"><center>\n
<img src=\""$category/$basename/$preset.jpg"\" onclick=\"hs.close()\" onmouseover=\"javascript:this.src='"$category/$basename/$preset_esc.jpg"';\" onmouseout=\"javascript:this.src='original/"$basename".jpg';\" >\n
</center></div>\n
<div class=\"highslide-caption\"><b>Preset:</b> <i>"$title"</i> [<a href=\""$category/clut/$preset.png"\">Download CLUT</a>]</div></div>\n
</td></tr>\n
<tr><td align=\"center\"><font size=\"-1\">"$title"</font></td></tr>\n
</table></td>\n\n"'})
-done
({'"
</table></center>\n
</div></div><div id="footer"><img src=\"images/footer.jpg\" /></div></div>\n
"'})
({'"<!--#include file=\"copyright.html\" -->\n
<!--#include file=\"footer.html\" -->\n
"'})
-a[$nb_samples--1] x -o[-1] raw:${category}_$basename.shtml,char -rm[-1]
-done
-done
-rm
category=@{-arg\ 1,$categories}
-x "ln -fs "${category}_$basename0.shtml" index.shtml"
-v + -e[] "\n > All done, for "$nb_presets" presets.\n"
update_gallery_html :
-e[^-1] "Generate gallery for the G'MIC web site."
-v -
thumb_size=128
-x "rm -f gallery.shtml img/gallery_*.jpg"
img/chloe.jpg
img/fawn.jpg
img/house.jpg
img/statue.jpg
img/beach.jpg
nb_imgs=@#
-repeat @# --r2dy[$>] $thumb_size width$>={w} -rm[-1] -done
_nb_coms=-1
-_update_gallery_html " "
-_update_gallery_html " "
-_update_gallery_html " "
-_update_gallery_html " "
-_update_gallery_html " "
-_update_gallery_html "-luminance"
-_update_gallery_html "-solarize"
-_update_gallery_html "-negative"
-_update_gallery_html "-select_color 100,0,0,0 -n 0,255"
-_update_gallery_html "-array_fade 4,4"
-_update_gallery_html "--mirror[-1] x -fade_x 40,60"
-_update_gallery_html "-shift_tiles 20,20"
-_update_gallery_html "-fisheye 40"
-_update_gallery_html "-fisheye 50"
-_update_gallery_html "-shade_stripes ,"
-_update_gallery_html "-shade_stripes 40,1"
-_update_gallery_html "-tetris 10"
-_update_gallery_html "-blur 1 -gradient_orientation 2 -+ -n 0,255 -smooth 60,0,1,1,3"
-_update_gallery_html "-flower 30,5"
-_update_gallery_html "-water 30,1.5"
-_update_gallery_html "-wave 4,0.4"
-_update_gallery_html "-wave 15,0.2"
-_update_gallery_html "-deform 10"
-_update_gallery_html "-light_patch 4,0.7,1.7"
-_update_gallery_html "-mosaic 0.5,80,1"
-_update_gallery_html "-sponge 13"
-_update_gallery_html "-hearts 15"
-_update_gallery_html "-color_ellipses 1400,10,0.07"
-_update_gallery_html "-whirls 3"
-_update_gallery_html "-edges 15 -n 0,255"
-_update_gallery_html "-to_rgba -gimp_reflect 50,1,110,160,190,64,0,1.5,0,-3.30,7,1.5 -display_rgba"
-_update_gallery_html "-transform_polar R-r"
-_update_gallery_html "-drawing 200"
-_update_gallery_html "-draw_whirl 100"
-_update_gallery_html "-texturize_paper"
-_update_gallery_html "-stencilbw 30"
-_update_gallery_html "-glow 4"
-_update_gallery_html "-ditheredbw"
-_update_gallery_html "-blur_angular 10"
-_update_gallery_html "-blur_radial 10"
-_update_gallery_html "-repeat 3 --deform[0] 10 -done -+ -n 0,255"
-_update_gallery_html "-flood 50%,50%,0,50,0,0.7,155,100,255"
-_update_gallery_html "--mirror x --mirror y -* -equalize 255 -n 0,255"
-_update_gallery_html "-kaleidoscope 0.5,0.5,50,20"
-_update_gallery_html "-noise 40 -cut 0,255 --meancurvature_flow[-1] 20 -sharpen[-1] 100 -a x"
-_update_gallery_html "-gradient_norm -sqrt -n 0,255"
-_update_gallery_html "-to_rgba -rotate_tiles 15,5,5 -display_rgba"
-_update_gallery_html "-taquin 5"
-_update_gallery_html "img/chloe.jpg -drop_shadow[-1] 3 -rotate[-1] 55 -blend alpha"
-_update_gallery_html "[-1] -deform 10 -morph 4,0.05 -a x"
-_update_gallery_html "-polaroid 20 -drop_shadow 3,3 -rotate 10,1 -display_rgba"
-_update_gallery_html "--plasma 10,10 -n[-1] 0.5,2.5 -n 0,255 -and -equalize 256"
-_update_gallery_html "100%,100% -mandelbrot[-1] -1.17229,-0.3038,-1.15209,-0.2836,1000 -map[-1] 0 -*[-2] 1.5 -+ -n 0,255"
-_update_gallery_html "--edges 15 -n 0,255 -fade_y 30,70"
-_update_gallery_html "-split_tiles 5,5 -blur 8 -sharpen 1000 -equalize 255 -append_tiles 5,5"
-_update_gallery_html "-imagecube3d -*3d 256 -r3d 1,1,0,60 512,512,1,3 -plasma[-1] 10,10 -n[-1] 0,128 -m3d 5 -db3d 0 -object3d[1] [0],50%,50% -k[1] -n 0,255"
-_update_gallery_html "-warp_perspective 0.3,0.9,0.5"
-_update_gallery_html "-rodilius ,"
-_update_gallery_html "-blur 3 -gradient2rgb 1"
-_update_gallery_html "-normalize_local 80,7"
-_update_gallery_html "-normalize_local 80,3"
-_update_gallery_html "-normalize_local 80,7"
-_update_gallery_html "-normalize_local 80,6,2"
-_update_gallery_html "-isophotes 4 -dilate 3 -i[0] (0;255^0;255^100;100) -r[0] [1],[1],1,3,3 -blend alpha"
-_update_gallery_html "-crop 30%,30%,70%,70% -resize 200%,200%,1,100%,5 -frame_fuzzy 30,30"
-_update_gallery_html "-cartoon ,"
-_update_gallery_html "-cartoon ,"
-_update_gallery_html "-cartoon ,"
-_update_gallery_html "-cartoon ,"
-_update_gallery_html "-cartoon ,"
-_update_gallery_html "-resize2dx 300 -m3d 2 -elevation3d 0.3 -f3d 200 -snapshot3d 400,1.5"
-_update_gallery_html "-resize2dx 300 -m3d 2 -elevation3d 0.3 -f3d 200 -snapshot3d 400,1.5"
-_update_gallery_html "-resize2dx 300 -m3d 2 -elevation3d 0.3 -f3d 200 -snapshot3d 400,1.5"
-_update_gallery_html "-resize2dx 300 -m3d 2 -elevation3d 0.3 -f3d 200 -snapshot3d 400,1.5"
-_update_gallery_html "-resize2dx 300 -m3d 2 -elevation3d 0.3 -f3d 200 -snapshot3d 400,1.5"
-_update_gallery_html "-topographic_map 16,2"
-_update_gallery_html "-topographic_map 16,2"
-_update_gallery_html "-topographic_map 16,2"
-_update_gallery_html "-topographic_map 16,2"
-_update_gallery_html "-topographic_map 16,2"
-_update_gallery_html "--blur 10 -curvature[-1] -norm[-1] -+[-1] 0.01 -/ -equalize 255 -n 0,255"
-_update_gallery_html "--blur 10 -curvature[-1] -norm[-1] -+[-1] 0.01 -/ -equalize 255 -n 0,255"
-_update_gallery_html "--blur 10 -curvature[-1] -norm[-1] -+[-1] 0.01 -/ -equalize 255 -n 0,255"
-_update_gallery_html "--blur 10 -curvature[-1] -norm[-1] -+[-1] 0.01 -/ -equalize 255 -n 0,255"
-_update_gallery_html "--blur 10 -curvature[-1] -norm[-1] -+[-1] 0.01 -/ -equalize 255 -n 0,255"
-_update_gallery_html "-blur 1 -pencilbw 0.3"
-_update_gallery_html "-blur 1 -pencilbw 0.3"
-_update_gallery_html "-blur 1 -pencilbw 0.3"
-_update_gallery_html "-blur 1 -pencilbw 0.3"
-_update_gallery_html "-blur 1 -pencilbw 0.3"
-_update_gallery_html "-old_photo -drop_shadow 3,3 -rotate -5,1 -display_rgba"
-_update_gallery_html "-old_photo -drop_shadow 3,3 -rotate -10,1 -display_rgba"
-_update_gallery_html "-old_photo -drop_shadow 3,3 -rotate -15,1 -display_rgba"
-_update_gallery_html "-old_photo -drop_shadow 3,3 -rotate -20,1 -display_rgba"
-_update_gallery_html "-old_photo -drop_shadow 3,3 -rotate -25,1 -display_rgba"
-_update_gallery_html "-erode 10 --erode 3 -- -equalize 255 -smooth 40,0,1,1,3 -n 0,255 -negative"
-_update_gallery_html "-erode 10 --erode 3 -- -equalize 255 -smooth 60,0,1,1,3 -n 0,255 -negative"
-_update_gallery_html "-erode 10 --erode 3 -- -equalize 255 -smooth 80,0,1,1,3 -n 0,255 -negative"
-_update_gallery_html "-erode 10 --erode 3 -- -equalize 255 -smooth 100,0,1,1,3 -n 0,255 -negative"
-_update_gallery_html "-erode 10 --erode 3 -- -equalize 255 -smooth 120,0,1,1,3 -n 0,255 -negative"
-_update_gallery_html "-light_relief ,"
-_update_gallery_html "-light_relief ,"
-_update_gallery_html "-light_relief ,"
-_update_gallery_html "-light_relief ,"
-_update_gallery_html "-light_relief ,"
-_update_gallery_html "--warhol 2 -fade_radial 50,70"
-_update_gallery_html "--warhol 3 -fade_radial 50,70"
-_update_gallery_html "--warhol 4 -fade_radial 50,70"
-_update_gallery_html "--warhol 5 -fade_radial 50,70"
-_update_gallery_html "--warhol 6 -fade_radial 50,70"
-_update_gallery_html "--sketchbw , -rv -blend overlay"
-_update_gallery_html "--sketchbw , -rv -blend overlay"
-_update_gallery_html "--mirror x -a x -map_sphere ,"
-_update_gallery_html "--mirror x -a x -map_sphere ,"
-_update_gallery_html "-gimp_painting 2,1.5,2"
-_update_gallery_html "-f3d 800 -rm 512,512,1,3 -chessboard 64,64,0,0,15,1,@{-RGB},@{-RGB} --imagecube3d -*3d[-1] 230 -r3d[-1] 1,1,0.5,50 -m3d 3 -object3d[-2] [-1],50%,50%,0 -rm[-1] -gimp_painting 1,1.5,2 -equalize[-1] 256"
-_update_gallery_html "--histogram 256 -display_graph[-1] @{0,w},@{0,h},3 -to_rgba[-1] -*[-1] 0.5 -blend alpha"
-_update_gallery_html "100%,100%,1,1,'X=(x-w/2)/30;Y=(y-h/2)/30;5*cos(X*Y)*sqrt(X^2+Y^2)' -elevation3d[0] [1] -k[0] -r3d 1,1,0,60 -snapshot3d 500,2"
-_update_gallery_html "-kuwahara 10 -noise 30 -smooth 100,0,1,3,3 -sharpen 400 -n 0,255 -equalize 256"
-_update_gallery_html "-frame 4,4,0 -array_mirror 1,3"
_nb_coms={$_nb_coms+1}
({'"<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n\
\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n\
<!--#include file=\"header.html\" -->\n
<link href=\"style.css\" rel=\"stylesheet\" type=\"text/css\">\n
<div id=\"bloc_option\"><div id=\"top_bleu\"><div id=\"text_top\">Image Gallery</div></div>\n
<div id=\"center\"><div id=\"text_centre_intro\">\n
All the images below have been processed by the command line version <b><a href=\"documentation.shtml\">gmic</a></b>\n
of <b><font color=\"#000066\">G\47MIC</font></b>, from a set of initial 2D color images (displayed on the first row).<br/>\n
Click on an image to zoom-in. The corresponding <b><font color=\"#000066\">G\47MIC</font></b> command used to generate the image appears as a caption.\n
This gallery is intended to show the flexibility and the genericity of the <b><font color=\"#000066\">G\47MIC</font></b> language.\n
Remember, you can easily define your own image filters and effects by writting\n
your custom <b><font color=\"#000066\">G\47MIC</font></b> <a href=\"http://gmic.eu/gmic_def.gmic\">command file</a>,\n
and eventually put them directly in <a href=\"http://www.gimp.org\">GIMP</a> afterwards.\n\n
<ul>\n
<li>See also the <a href=\"gimp.shtml\">GIMP plug-in page</a> to see various screenshots of what <b><font color=\"#000066\">G\47MIC</font></b> can do.</li>\n
<li>See also the <a href=\"reference.shtml\">G\47MIC reference page</a> to have processing examples of almost all <b><font color=\"#000066\">G\47MIC</font></b> commands\n
(scroll down there to view example images).</li>\n
<li>See also the <a href=\"http://www.flickr.com/groups/gmic/pool/\">Flickr slideshow</a>, showing uses of the <a href=\"gimp.shtml\">G\47MIC plug-in</a>\n
by various artists.</li>\n
</ul>\n
<b>Copyrights : </b> All pictures have been shot by <a href=\"http://tschumperle.users.greyc.fr/\">David Tschumperl&eacute;</a>.<br/><br/>\n"'})
({'"<center><table cellpadding=\"1\" border=\"0\" cellspacing=\"2\">"\n'})
row=0
-repeat $_nb_coms
ind={$>%$nb_imgs}
out_img=@{"-filename "img/gallery.jpg,$>}
out_thumb=@{"-filename "img/gallery_thumb.png,$>}
-if {!$ind} ({'"<tr>\n"'}) -endif
com=${_com$>}
-v + -e[] " - Image "{$>+1}/$_nb_coms" : $ "$com -v -
displayed_com$ind=$com
-if {!narg($com)} com="-skip ," -endif
--__update_gallery_html[$ind] $com
iind={$ind%5}
width=@{$iind,w} height=@{$iind,h}
-o[-1] $out_img,75
-r2dy[-1] $thumb_size -if {w>${width$ind}} -r[-1] ${width$ind},100%,100%,100%,2 -endif
-l[-1] -frame 3%,3%,255 -to_rgba -drop_shadow 2,2,3 -endl
-o[-1] $out_thumb -rm[-1]
({'"<td width=\""${width$>}"\"><center><div>\
<a href=\""$out_img"\" class=\"highslide\" onclick=\"return hs.expand(this)\">\
<img src=\""$out_thumb"\"/></a>\
<div class=\"highslide-caption\">gmic "@{$ind,b}.@{$ind,x}" "${displayed_com$ind}"</div>\
</div></center></td>\n"'})
-if {$ind==$nb_imgs-1" || "$>==$_nb_coms-1}
({'"</tr>\n<tr bgcolor=\""$bgcolor"\">"\n'})
-repeat {$ind+1}
({'"<td width=\""${width$>}"\"><center><font size=\"1\">gmic "@{$>,b}.@{$>,x}" "${displayed_com$>}"</font></center></td>\n"'})
-done
({'"</tr>\n"'})
row={$row+1}
-endif
-done
({'"</table></center>\n"'})
({'"</div></div><div id=\"footer\"><img src=\"images/footer.jpg\" /></div></div>\n\
<!--#include file=\"copyright.html\" -->\n\
<!--#include file=\"footer.html\" -->\n"'})
-rm[0-{$nb_imgs-1}] -a x
-o gallery.raw,uchar -x "mv gallery.raw gallery.shtml" -rm
-v + -e[^-1] "All done !"
_update_gallery_html :
_nb_coms={$_nb_coms+1} _com$_nb_coms="$1"
__update_gallery_html :
${1--1}
update_server : -skip ${1=@.},${2=1}
-v -
-_update_server_move "/Artistic/Pastell~art","/Testing/Naggobot"
-_update_server_move "/Artistic/Simple~noise~canvas","/Patterns"
-_update_server_move "/Degradations/Tilt~shift","/Testing/J&#233;J&#233;"
-_update_server_move "/Layers/Fast~median~stack","/Testing/Iain~fergusson"
-_update_server_move "/Rendering/Chryzodes","/Testing/Samj/Rendering"
-_update_server_move "/Testing/J&#233;J&#233;/Rays","/Patterns"
-_update_server_move "/Testing/Iain~fergusson/Halftone~shapes","/Patterns"
-_update_server_move "/Testing/Iain~fergusson/Simple~local~contrast","/Details"
-_update_server_move "/Testing/Garagecoder/Aurora","/Artistic"
-_update_server_move "/Testing/Garagecoder/Despeckle","/Repair"
-_update_server_move "/Testing/Garagecoder/HSL~adjustment","/Colors"
-_update_server_move "/Testing/Garagecoder/HSV~select","/Colors"
-_update_server_move "/Testing/Garagecoder/Stereo~image","/Stereoscopic~3d"
-_update_server_move "/Testing/Garagecoder/Undo~anaglyph","/Stereoscopic~3d"
-_update_server_move "/Testing/Naggobot/Blockism","/Artistic"
-_update_server_move "/Testing/Samj/Chalk~it~up","/Artistic"
-_update_server_move "/Testing/Samj/Denim~texture","/Patterns"
-_update_server_move "/Testing/Zonderr/Spiral","/Rendering"
-_update_server_move "/Finger~paint","/Artistic"
-m "parent : -l[] ({'$""1'}) -s -,{'/'} -if @# -rm[-1] -endif -i[0--1] (47) -a y -u @{0,t} -rm -endl"
-m "_max : ({'\"$""1\"'}) ({'\"$""2\"'}) -f[-2,-1] 'if(i>=97&&i<=122,i-32,i)' -r[-2,-1] {max(w,@{-2,w})},1,1,1,0 --[-2,-1] -autocrop[-1] 0 "\
"-u {i>0} -rm[-1]"
-m "load_gmic : "\
"_nb_sources={$_nb_sources+1} filename=@{\"-basename $""1\"} "\
"-v + -e[] \"  \"$_nb_sources\". \"$filename\"  \" -v - "\
"-l[] "\
"  -i raw:$""1,char -v + -e[] \"      [retrieved from source '$""1']\" -v - "\
"  -l "\
"    -o raw:/tmp/$filename,char "\
"    -_update_server_upload /tmp/$filename,include/$filename "\
"    -v + -e[] \"      [archived]\n\" -v - "\
"  -onfail -v + -e[] \"      [could not be archived!]\n\" -v - -endl "\
"-onfail -l[] "\
"  source=http://gmic.eu/include/$filename "\
"  -i raw:$source,char -v + -e[] \"      [retrieved from archive '\"$source\"']\n\" -v - "\
"  -onfail -v + -e[] \"      [error, not reachable!]\n\" -v -"\
"  -endl -endl"
-m "calibrate_name : "\
"-autocrop 32 "\
"-f 'if(i>=65&&i<=90,i+32,i)' "\
"-replace {'_'},32 -autocrop 32 "\
"-replace_str Fft,FFT "\
"-replace_str rgb,RGB "\
"-replace_str lab,Lab "\
"-replace_str hsv,HSV "\
"-replace_str hsl,HSL "\
"-replace_str ycbcr,YCbCr "\
"-replace_str cmyk,CMYK "\
"-replace_str b&amp;w,B&amp;W "\
"-replace_str gimp,GIMP "\
"-replace_str roddy,Roddy "\
"-replace_str crt,CRT "\
"-replace_str colorabstractionpaint,\"Color abstraction paint\" "\
"-replace_str g\47mic,G\47MIC "\
"-f 'if(y==0&&i>=97&&i<=122,i-32,i)' "
-if {$1==@.}
-v + -e[] "> Upload latest version ("@{-strver}") of commands on G'MIC server.\n" -v -
-_update_server_upload $HOME/work/src/gmic/src/gmic_def.gmic,gmic_def.$1
-_update_server_upload $HOME/work/src/gmic/src/gmic_def.gmic
-endif
-v + -e[] "> Load and archive .gmic source files.\n" -v -
_nb_sources=0
-load_gmic http://gmic.eu/gmic_def.$1
-load_gmic http://gmic.eu/compatibility.gmic
-if {$1!=@.} -l -load_gmic http://gmic.eu/backports$1.gmic -onfail -endl -endif
-load_gmic http://s406833247.websitehome.co.uk/gmic/garagecoder.gmic
-load_gmic http://gentlemanbeggar.bplaced.net/gentlemanbeggar_gmic.gmic
-load_gmic http://www.iain.bplaced.net/iain_fergusson.gmic
-load_gmic http://jaypri.ch/GMIC/jayprich.gmic
-load_gmic https://raw.github.com/jboulanger/jboulanger-gmic/master/jboulanger.gmic
-load_gmic http://particularart.com/static/gmictutor.gmic
-load_gmic http://karo03.bplaced.net/gmic/karos.gmic
-load_gmic http://www.saunalahti.fi/naggobot/naggobot.gmic
-load_gmic http://gmic.eu/photocomix.gmic
-load_gmic http://gmic.eu/ronounours.gmic
-load_gmic http://www.aljacom.com/~gmic/samj.gmic
-load_gmic http://gmic.eu/tomkeil.gmic
-load_gmic http://docgmic.tuxfamily.org/zonderr.gmic
-replace_str[^0] "-apply_channels ","-apply_channels_old "
-replace_str[^0] "-apply_channels[","-apply_channels_old["
-replace_str[^0] "Dtails","Details"
-i[0] (10) -i[2--1] ({"'\n#@gimp ________________\n'"}) -y -a y -discard 13 -replace 9,32
-s +,{'"#@gimp"'}
-repeat {int((@#-1)/2)} -a[{$>+1},{$>+2}] y -done
-nm[0] !header
-v + -e[] "> Start filter parsing.\n" -v -
progress_factor={100/(@#-1)}
merge_request=0
merge_start=0
nb_filters=0
offset=0
path=/
-repeat @#
ind={$>-$offset}
-if {@{{$ind-1},-1}==10" && "{{`@{$ind,0-5}`}'=='"#@gimp"}" && "(@{$ind,6}==32" || "@{$ind,6}=={'_'})} -l[$ind]
is_folder=0
-s +,10
-if {@{0,6}=={'_'}} --rows[0] 9,100% -rows[0] 0,8
-else --rows[0] 6,100% -rows[0] 0,5
-endif
-autocrop[-1] 32 -mv[-1] 1
-if {@{1,0}!={':'}}
-l[1]
-s +,{':'}
-replace_str[0] "<b>"
-replace_str[0] "</b>"
-replace_str[0] "<i>"
-replace_str[0] "</i>"
-replace[0] {'/'},{'-'}
-replace[0] {','},{';'}
-autocrop[0] 32
-if {@#>1}
-calibrate_name[0] --replace[0] 32,{'~'}
name=$path@{-1,t} -rm[-1]
merge_request=1
nb_filters={$nb_filters+1}
-i[0,1] (32) -a y
-v + -e[] "  "$nb_filters". "$name" ("{round($>*$progress_factor)}"%)." -v -
-else
-if {i=={'_'}}
-do path=@{"-parent[] "$path} -shift 0,-1,0,0 -while {i=={'_'}}
-autocrop 0 -autocrop 32
-if {w} -calibrate_name -replace 32,{'~'} path=$path@{0,t}/ -endif
-else
-autocrop 32 -calibrate_name -replace 32,{'~'} path=$path@{0,t}/
-endif
is_folder=1
-endif
-endl
-if $is_folder -rm[0,1] -i[0] (10)
-else -nm[0] $name -endif
-else
-if {@#>=3} -l[1]
-s +,{'='}
-if {@#>=3} -if {@{1,0}=={'='}}
-rows[0] 1,100% -calibrate_name[0]
-i[0] ({':'};32) -i[2] (32)
-endif -endif
-endl -endif
-i[1] (32)
-endif
-a y
-endl -endif
-if {$merge_request" && "$ind>0}
-a[$merge_start-{$ind-1}] y
offset={$offset+$ind-$merge_start-1}
merge_start={$merge_start+1}
merge_request=0
-endif
-done
-a[$merge_start--1] y
-v + -e[] "\n> Force filters to move, if necessary." -v -
-repeat @# ind=$> -repeat $_nbm -if {@{$ind,n}'=='${_to_move$>}}
-v + -e[] "  "$ind". Move '"@{$ind,n}"' to '"${_move_to$>}"'." -v -
-nm[$ind] ${_move_to$>}/@{$ind,b}
-endif -done -done
-v + -e[] "\n> Sort filters by lexicographic order." -v -
-_update_server_sort 0,{@#-1}
-v + -e[] "\n> Remove duplicate filters." -v -
pname=@{-1,n}
-repeat {@#-1} cname=@{$<,n}
-if {$cname'=='$pname}
-v + -e[] "  "$<". Remove duplicate '"$cname"'." -v -
-rm[$<]
-else pname=$cname -endif
-done
-v + -e[] "\n> Rebuild folder structure." -v -
-m "nb_levels : -l[] ({'$""1'}) -s -,{'/'} -u @# -rm -endl"
path=/
-repeat @# -l[$>]
npath=@{"-parent "@{0,n}}
-if {$path'!='$npath}
nc=@{"-nb_levels[] "$path}
nn=@{"-nb_levels[] "$npath}
nb_up=0
nb_down=0
basis=$path nbasis=$npath
-do
nc=@{"-nb_levels[] "$basis}
nn=@{"-nb_levels[] "$nbasis}
-if {$nc>$nn} basis=@{"-parent[] "$basis} nb_up={$nb_up+1}
-elif {$nn>$nc} nbasis=@{"-parent[] "$nbasis} nb_down={$nb_down+1}
-elif {$nbasis'!='$basis} basis=@{"-parent[] "$basis} nb_up={$nb_up+1} nbasis=@{"-parent[] "$nbasis} nb_down={$nb_down+1}
-endif
-while {$nbasis'!='$basis}
command=
-if $nb_up 1,$nb_up,1,1,{'_'} command="#@gimp "@{-1,t}"\n" -rm[-1] -endif
-if $nb_down -l[]
({'$npath'}) -s -,{'/'} -k[-$nb_down--1] -replace {'~'},32
level={@{"-nb_levels "$path}-$nb_up}
balise=@{"-if "{$level<=0" && "{$npath'!='/About/}}" -u b -else -u i -endif"}
-repeat @#
command=$command"#@gimp <"$balise">"@{$>,t}"</"$balise">\n"
balise="i"
-done -rm
-endl -endif
-if {narg($command)} nm=@{0,n} -i[0] ({'$command'}) -y[0] -a y -nm $nm
-endif
path=$npath
-endif
-endl -done
-v + -e[] "> Search and replace strings." -v -
-replace_str "Saturation equalizer","Saturation equalizer"
-replace_str "CMYK tone","CMYK tone"
-replace_str "Texture enhance","Texture enhance"
-replace_str "\#@gmic\n",""
-repeat @# -l[$>] -s -,10 -repeat @# -l[$<]
-if {i[0]=={'\#'}" && "i[1]!={'@'}} -rm -endif
-endl -done -i[^0] ({'\n'}) -a y -endl -done
-repeat @# --l[$>] command_name$>=""
--rows 0,6 head=@{-1,t} -rm[-1]
-if {$head'=='"#@gimp "} -s -,{':'}
-if {@#>=1} -l[1] -s -,{','}
-if @# -autocrop[0] 32 command_name$>=@{0,t} -endif
-endl -endif
-endif
-rm -endl -done
-if {$nb_filters>500}
-v + -e[] "> Save output .gmic file.\n" -v -
--a y
-i[-2] ({'"\#@gmic"\n\
"\#"\n\
"\#  File        : gmic_def.gmic"\n\
"\#                ( G\47MIC commands file )"\n\
"\#"\n\
"\#  Description : Update file for G\47MIC commands and filters (version "@{-strver}")."\n\
"\#                ( http://gmic.eu )"\n\
"\#"\n\
"\#  License     : CeCILL v2.0"\n\
"\#                ( http://www.cecill.info/licences/Licence_CeCILL_V2-en.html )"\n\
"\#"\n\n'})
({'"\n\# Local Variables:"\n\
"\# mode: sh"\n\
"\# End:"\n\
"\#"\n\
"\# (End of G\47MIC update file)"'})
-y[-3,-1] -a[-3--1] y
-o[-1] raw:$HOME/.update$1.gmic,char
-o[-1] /tmp/.update$1.cimgz,char
-_update_server_upload /tmp/.update$1.cimgz,update$1.gmic
-_update_server_upload /tmp/.update$1.cimgz,update1610.gmic
-rm[-1]
-endif
-if {$2" && "$1==@.}
-v + -e[] "> Output list of filters in stdout.\n" -v -
-x "date +%Y,%m,%d,%H >"@{-path_tmp}/date.dlm
@{-path_tmp}/date.dlm
-echo_stdout "*** List of filters in the G\47MIC plug-in for GIMP ("$nb_filters" filters, on "{i}/{i(1)}/{i(2)}" "{i[3]}:00") ***\n"
-rm[-1]
-echo_stdout "* List of filters, sorted by path:\n"
-repeat @# -l[$>]
({'@{0,n}'}) -if {i!={'!'}}
-r[-1] {w-1},1,1,1,0,0,1
-replace_str[-1] "&amp;","&"
-replace_str[-1] "&#233;","e"
-replace_str[-1] "/","~/~"
-replace[-1] {'~'},32
-if {narg(${command_name$>})} -echo_stdout[] "  "@{-1,t}" (command '-"${command_name$>}"')"
-else -echo_stdout[] "  "@{-1,t}
-endif
-endif -rm[-1]
-endl -done
-echo_stdout "\n* List of filters, sorted alphabetically:\n"
-repeat @#
name=@{$>,b}
path=@{$>,f}
-nm[$>] $name"~(in~'"$path"')"
-done
-_update_server_sort 0,{@#-1}
-repeat @# -l[$>]
({'@{0,n}'}) -if {i!={'!'}}
-replace_str[-1] "&amp;","&"
-replace_str[-1] "&#233;","e"
-replace[-1] {'~'},32
-echo_stdout[] "  "@{-1,t}
-endif -rm[-1]
-endl -done
-echo_stdout "\n*** End of list ***\n"
-endif
-rm -v + -e[] "> All done !\n"
_update_server_sort :
mid={int(($1+$2)/2)}
-if @{"-_max[] "@{$1,n},@{$mid,n}} -rv[$1,$mid] -endif
-if @{"-_max[] "@{$mid,n},@{$2,n}} -rv[$2,$mid] -endif
-if @{"-_max[] "@{$1,n},@{$mid,n}} -rv[$1,$mid] -endif
-if {$2-$1>=3}
pivot=@{$mid,n}
i=$1 j=$2
-do
-if @{"-_max[] "$pivot,@{$i,n}} -do i={$i+1} -while @{"-_max[] "$pivot,@{$i,n}} -endif
-if @{"-_max[] "@{$j,n},$pivot} -do j={$j-1} -while @{"-_max[] "@{$j,n},$pivot} -endif
-if {$i<=$j} -rv[$i,$j] i={$i+1} j={$j-1} -endif
-while {$i<=$j}
-if {$1<$j} -_update_server_sort $1,$j -endif
-if {$i<$2} -_update_server_sort $i,$2 -endif
-endif
_update_server_move :
-if {!narg($_nbm)} _nbm=0 -endif
_to_move${_nbm}="$1" _move_to${_nbm}="$2" _nbm={$_nbm+1}
_update_server_upload : -skip "${2=$1}"
GMIC_LOGIN=@{-gmic_ftp\ 0}
GMIC_PASSWD=@{-gmic_ftp\ 1}
-x "lftp ftp://"$GMIC_LOGIN":"$GMIC_PASSWD"@ftp.gmic.eu -e \"put -O /www/gmic/ \\\"$1\\\" -o \\\"$2\\\"; quit\" >/dev/null"
update_tutorial_html :
-e[^-1] "Convert G\47MIC tutorial from Garry Osgood\47s blog (http://www.particularart.com), for the G\47MIC web page."
-v - -rm -m "add_page : -__update_tutorial_html $""*"
-use_vt100
-add_page /,1700,index,_index
-add_page basics,4000
-add_page beginners-cookbook,1000
-add_page beginners-cookbook/cauldron,3500
-add_page beginners-cookbook/dyidiffusion,1000
-add_page beginners-cookbook/dyidiffusion/graduated-blurs,3800
-add_page beginners-cookbook/dyidiffusion/variations-on-a-theme,3800
-add_page beginners-cookbook/dyidiffusion/eigenvalues-and-eigenvectors,2300
-add_page beginners-cookbook/dyidiffusion/directional-blurring,3500
-add_page beginners-cookbook/dyidiffusion/tensors-for-the-tonsorially-challenged,8500
-add_page beginners-cookbook/dyidiffusion/eigen-thingys,4800
-add_page beginners-cookbook/dyidiffusion/fake-depth-of-field,7600
-add_page beginners-cookbook/fingerpainting,12000
-add_page beginners-cookbook/ramps,1200
-add_page beginners-cookbook/ramps/applying-a-curve,600
-add_page beginners-cookbook/ramps/blurring,600
-add_page beginners-cookbook/ramps/general-ramps,2500
-add_page beginners-cookbook/ramps/input-and-fill,1200
-add_page beginners-cookbook/ramps/one-dimensional-functions,800
-add_page beginners-cookbook/ramps/remapping-space,2200
-add_page beginners-cookbook/ramps/resizing,600
-add_page beginners-cookbook/ramps/warp,800
-add_page beginners-cookbook/road-systems,2500
-add_page beginners-cookbook/stained-glass,4000
-add_page beginners-cookbook/spectral-art,1500
-add_page beginners-cookbook/spectral-art/the-spatial-and-the-spectral,2000
-add_page beginners-cookbook/spectral-art/the-spectral-course,2000
-add_page beginners-cookbook/spectral-art/the-spectral-domain,2000
-add_page beginners-cookbook/spectral-art/the-complex-number-field,3300
-add_page beginners-cookbook/spectral-art/painting-with-waves-part-one,2200
-add_page beginners-cookbook/spectral-art/painting-with-waves-part-two,2200
-add_page beginners-cookbook/spectral-art/a-revised-map,1500
-add_page beginners-cookbook/spectral-art/intermezzo-spectral-editing,1500
-add_page beginners-cookbook/spectral-art/a-wave-painting-workflow,2000
-add_page beginners-cookbook/spectral-art/tiletex,5000
-add_page beginners-cookbook/spectral-art/coefficient-values,3000
-add_page beginners-cookbook/spectral-art/coefficient-values-part-two,4500
-add_page beginners-cookbook/spectral-art/coefficient-values-part-three,2500
-add_page beginners-cookbook/spectral-art/cheat-sheet,9000
-add_page beginners-cookbook/spectral-art/appendix,2500
-add_page command-decorations,3500
-add_page images,2000
-add_page images/conjuring-images,1000
-add_page images/images-as-datasets,3500
-add_page images/images-have-edges,1200
-add_page command-guide,5500
-add_page command-guide/color-manipulation/-compose_channels,1000,,,commands-colors-manipulation
-add_page command-guide/color-manipulation/-direction2rgb,1000,,,commands-colors-manipulation
-add_page command-guide/color-manipulation/-gradient2rgb,1000,,,commands-colors-manipulation
-add_page command-guide/color-manipulation/-mix_rgb,4000,,,commands-colors-manipulation
-add_page command-guide/color-manipulation/-select_color,3000,,,commands-colors-manipulation
-add_page command-guide/feature-extraction/-distance,9500,,,commands-features-extraction
-add_page command-guide/feature-extraction/-area,2000,,,commands-features-extraction
-add_page command-guide/feature-extraction/-label,1300,,,commands-features-extraction
-add_page command-guide/filtering/-bandpass,5000,,,commands-filtering
-add_page command-guide/filtering/-blur,2000,,,commands-filtering
-add_page command-guide/filtering/-blur_angular,700,,,commands-filtering
-add_page command-guide/filtering/-blur_linear,700,,,commands-filtering
-add_page command-guide/filtering/-blur_radial,700,,,commands-filtering
-add_page command-guide/filtering/-blur_selective,3500,,,commands-filtering
-add_page command-guide/filtering/-blur_x,700,,,commands-filtering
-add_page command-guide/filtering/-blur_xy,700,,,commands-filtering
-add_page command-guide/filtering/-blur_xyz,700,,,commands-filtering
-add_page command-guide/filtering/-blur_y,700,,,commands-filtering
-add_page command-guide/filtering/-blur_z,2500,,,commands-filtering
-add_page command-guide/filtering/-convolve,3500,,,commands-filtering
-add_page command-guide/filtering/-dct-and-idct,1500,,,commands-filtering
-add_page command-guide/filtering/-deriche,1500,,,commands-filtering
-add_page command-guide/filtering/-diffusiontensors,7200,,,commands-filtering
-add_page command-guide/filtering/-fft,6300,,,commands-filtering
-add_page command-guide/filtering/-gradient,3000,,,commands-filtering
-add_page command-guide/filtering/-gradient_norm,1300,,,commands-filtering
-add_page command-guide/filtering/-gradient_orientation,3300,,,commands-filtering
-add_page command-guide/filtering/-haar,2000,,,commands-filtering
-add_page command-guide/filtering/-smooth,4300,,,commands-filtering
-add_page command-guide/filtering/-structuretensors,3300,,,commands-filtering
-add_page command-guide/geometry-manipulation/-warp,5000,,,commands-geometry-manipulation
-add_page command-guide/image-drawing/-gaussian,2000,,,commands-image-drawing
-add_page command-guide/image-drawing/-plasma,4500,,,commands-image-drawing
-add_page command-guide/image-drawing/-turbulence,5500,,,commands-image-drawing
-add_page command-guide/inputs-outputs/-display,2000,,,commands-inputs-outputs
-add_page command-guide/inputs-outputs/-display_tensors,1500,,,commands-inputs-outputs
-add_page command-guide/inputs-outputs/-input,7500,,,commands-inputs-outputs
-add_page command-guide/inputs-outputs/-shared,2000,,,commands-inputs-outputs
-add_page command-guide/matrix-computation/-eigen,2000,,,commands-matrix-computation
-add_page command-guide/program-control/-local,3500,,,commands-program-control
-add_page command-guide/program-control/-do,6500,,,commands-program-control
-add_page command-guide/program-control/-if,3500,,,commands-program-control
-add_page command-guide/program-control/-repeat,2000,,,commands-program-control
-add_page command-guide/values-manipulation/-eigen2tensor,5500,,,commands-values-manipulation
-add_page command-guide/values-manipulation/-norm,700,,,commands-values-manipulation
-add_page command-guide/values-manipulation/-normalize,1700,,,commands-values-manipulation
-add_page command-guide/values-manipulation/-orientation,5000,,,commands-values-manipulation
-add_page command-guide/values-manipulation/-threshold,1500,,,commands-values-manipulation
-add_page technical-notes/trigometric-and-inverse-trigometric-commands,2500
-add_page technical-notes/wavelet-analysis-and-synthesis-in-gmic,5000
-add_page gimp-filters,1500
-add_page gimp-filters/blur-by-color-filter,22500
-add_page gimp-filters/hedcut-filter,2000
-add_page gimp-filters/the-fingerpainting-filter,2200
-add_page gimp-filters/the-hairlock-filter,8500
-v + -e[] "\n  * Prepare folder structure." -v -
-x "ln -fs ../tutorial.css ."
-x "ln -fs ../copyright.html ."
-x "ln -fs ../favicon.ico ."
-x "ln -fs ../favicon.png ."
-x "ln -fs ../footer.html ."
-x "ln -fs ../header.html ."
-x "ln -fs ../header.css ."
-x "ln -fs ../jquery-1.11.0.min.js ."
-x "ln -fs ../images ."
-x "mkdir -p img"
-x "cd img && ln -fs ../../img/logo4.jpg ."
-x "cd img && ln -fs ../../img/logos.jpg ."
-x "cd img && ln -fs ../../img/rss.png ."
-x "cd img && ln -fs ../../convert_raw_img/* ."
-x "ln -fs ../convert_raw.html ../convert_raw.shtml ."
-x "ln -fs ../tutorial_toc.html ."
-x "ln -fs ../highslide ."
11,11,1,3,255 -frame 1,1,0 -line 3,50%,{w-4},50%,1,0 --line 50%,3,50%,{h-4},1,0
-a x -o img/toc_buttons.png
100%,100%,1,4 -fc[-1] 245,245,245,0 -o[-1] img/toc_void.png
-rm
-if {!narg($_N)} _N=0 -endif
0 -repeat $_N
-o[-1] ${_output_html$>} -o[-1] ${_output_shtml$>}
-done -rm[-1]
-repeat $_N
-v + -_update_tutorial_html[] ${_input$>},${_height$>},${_output_shtml$>},${_output_html$>},${_img_prefix$>},${_tocid$>} -v -
-done
-x "rm -f __tmp.html"
-v + -e[] "\n  * All done !.\n\n"
__update_tutorial_html : -skip ${3=""},${4=""},${5=""}
-if {!narg($_N)} _N=0 -endif
_input$_N=$1 _height$_N=$2
-if {narg("$5")} _tocid$_N="$5"
-else
({'"$1"'}) -s -,{'/'} -if @# _tocid$_N=@{0,t} -rm -else _tocid$_N=index -endif
-endif
({'"$1"'}) -s -,{'/'}
output_base=""
-if @# output_base=@{-1,t} -endif
-if {@#>2" && "i[0]!={'-'}} output_base=@{-2,t}_@{-1,t} -endif
-rm
-if {narg($output_base)}
({'$output_base'}) -if {i=={'-'}} -=[-1] {'_'} output_base=@{-1,t} -endif -rm[-1]
-endif
-if {narg("$3")} _output_shtml$_N="$3".shtml _output_html$_N="$3".html _img_prefix$_N="$3"
-else _output_shtml$_N=$output_base.shtml _output_html$_N=$output_base.html _img_prefix$_N=$output_base
-endif
-if {narg("$4")} _output_html$_N="$4".html -endif
_N={$_N+1}
_update_tutorial_html :
-v -
url="http://particularart.com/tools-and-toys/gmic/$1"
-v + -e[] "\n  * Convert tutorial page '"$url"'." -v -
-v + -e[] "    > Retrieve page '"$url"'." -v -
-x "wget -q "$url" -O __tmp.html"
-i raw:__tmp.html,char
-discard 13
-replace_str "class=\"internal\" "
-replace_str "class=\"external\" "
-replace_str "dir=\"ltr\" "
-replace_str "border: 1px","border: 0px"
-replace_str "G\140MIC","G\47MIC"
-replace_str "CNTL","CTRL"
-replace_str "Rashid","Rachid"
-replace_str "http://gmic.sourceforge.net","http://gmic.eu"
-s -,{'"<!-- GIMMICKRY! -->"'} -k[1]
-s -,{'"<!-- GIMMICKRY! End -->"'} -k[0]
-s +,{'"   </div>\n</div>\n<footer>"'} -k[0]
-i[0] ({'"<!DOCTYPE html>"\n\
"<html lang=\"en-us\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">"\n\
"<link rel=\"stylesheet\" href=\"tutorial.css\">"\n\
"<script type=\"text/javascript\" src=\"highslide/highslide.js\"></script>"\n\
"<link rel=\"stylesheet\" type=\"text/css\" href=\"highslide/highslide.css\" />"\n\
"<script type=\"text/javascript\">"\n\
"hs.graphicsDir = 'highslide/graphics/';"\n\
"hs.wrapperClassName = 'wide-border';"\n\
"</script>"\n\
"<script type=\"text/javascript\" src=\"http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML\"></script>"\n\
"<body>"\n\n'})
({'\n</body></html>'})
-y -a y
-replace_str "\"/static/media/uploads/","\"http://particularart.com/static/media/uploads/"
-replace_str "\"/tools-and-toys/gmic/","\"http://particularart.com/tools-and-toys/gmic/"
-replace_str "\"http://particularart.com/","\"http://www.particularart.com/"
-s +,{'"<a "'}
-repeat @# -if {$>>0" && "{@{{$>-1},t}'=='"<a "}} -l[$>] -s +,{'href=\"'} -l[-1]
-s +,{'\"'}
-if {@#>0}
link=@{0,t}
({'$link'}) -z[-1] 0,48 baselink=@{-1,t} -rm[-1]
-if {$baselink'=='"http://www.particularart.com/tools-and-toys/gmic/"}
-l[] anchor="" ({'$link'}) -s +,{"'\#'"} -if {@#>1} anchor=#@{-1,t} link=@{0,t} -endif -rm -endl
({'$link'}) -autocrop[-1] {'/'}
-l[-1] -s -,{'/'} -if {@#>6" && "{@{-2,t}'!='command-guide}" && "{@{-3,t}'!='command-guide}} relink=@{-2,t}_@{-1,t}.shtml -else relink=@{-1,t}.shtml -endif -rm -endl
({'$relink'}) -if {i=={'-'}} -=[-1] {'_'} relink=@{-1,t} -endif -rm[-1]
-if $relink
relink=$relink$anchor
-v + -e[] "    > Local link '"$link$anchor"' relinked to '"$relink"'." -v -
-rm[0] -i[0] ({'$relink'}) -y[0]
-else
({'$relink'}) -if {i=={'_'}}
-l[-1] -z 1,100% -s -,{'.'} command=@{-basename\ @{0,t}} -k[0] -endl
relink="http://gmic.eu/reference.shtml#"$command
-v + -e[] "    > Local link '"$link$anchor"' relinked to '"$relink"' "${_gmic_g}"(reference command)."${_gmic_n} -v -
-rm[0] -i[0] ({'$relink'}) -y[0]
-else
relink=$link$anchor
-v + -e[] "    > Local link '"$link$anchor"' relinked to '"$relink"' "${_gmic_r}"(no corresponding local page)."${_gmic_n} -v -
-rm[0] -i[0] ({'$relink'}) -y[0]
-endif
-rm[-1]
-endif
-else -l
0 -nm[-1] $link ext=@{-1,x} -rm[-1]
-if {narg($ext)} ext=@{-struncase\ $ext} -endif
-if {{$ext'=='png}||{$ext'=='jpg}||{$ext'=='jpeg}}
relink=img/$5_@{-basename\ $link} 0 -nm[-1] $relink relink=@{-1,f}@{-1,b}.jpg -rm[-1]
-if $relink -v + -e[] "    > External image link '"$link"' relinked to '"$relink"'." -v -
-else
-l[] -i $link -k[0] is_opaque=0
-split_opacity -if {@#==1" || "ia>250} is_opaque=1 -endif -a c
-if {$is_opaque} -to_rgb -else -to_rgba -i[0] 100%,100%,1,3 -fc[0] 245,245,245 -blend alpha -endif
-o $relink,60 -rm
-v + -e[] "    > Image link '"$link"' converted and relinked to '"$relink"'." -v -
-onfail relink=$link -v + -e[] "    > Failed to retrieve image link '"$link"'." -v - -rm
-endl
-endif
-rm[0] -i[0] ({'$relink'})
-i[2] ({'" class=\"highslide\" onclick=\"return hs.expand(this)\""'})
-y[0,2]
-else
-v + -e[] "    > External link '"$link"' found." -v -
-endif
-onfail -endl -endif
-a y
-endif
-endl -a y -endl -endif -done
-a y
-s +,{'"<img"'}
-repeat @# -if {$>>0" && "{@{{$>-1},t}'=='"<img"}}
-l[$>]
-s +,{'"src=\""'}
-l[2]
-s +,{'\"'} link=@{0,t}
relink=img/$5_@{-basename\ $link} 0 -nm[-1] $relink relink=@{-1,f}@{-1,b}.jpg -rm[-1]
-if $relink -v + -e[] "    > Image '"$link"' relinked to '"$relink"'." -v -
-else
-l[] -i $link -k[0] is_opaque=0
-split_opacity -if {@#==1" || "ia>250} is_opaque=1 -endif -a c
-if $is_opaque -to_rgb -frame 1,1,0 -frame 10,10,245
-else -to_rgba -i[0] 100%,100%,1,3 -fc[0] 245,245,245 -blend alpha
-endif
-o $relink,60 -rm
-v + -e[] "    > Image '"$link"' converted and relinked to '"$relink"'." -v -
-onfail relink=$link -v + -e[] "      > Failed to retrieve image '"$link"'." -v - -rm
-endl
-endif
-rm[0] -i[0] ({'$relink'}) -y[0]
-endl
-a y
-endl
-endif -done
-a y
-replace_str "<td><img","<td width=\"256\"><img"
-replace_str "<td>\n<p><img","<td width=\"256\"><p><img"
-replace_str "<td>&nbsp;<img","<td width=\"256\"><img"
-replace_str "<a ","<a target=\"_parent\" "
-o raw:$4,char
-rm
({'"<!DOCTYPE html>"\n\
"<html lang=\"en-us\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">"\n\
"<!--#include file=\"header.html\" -->"\n\
"<link href=\"../style.css\" rel=\"stylesheet\" type=\"text/css\">"\n\
"<div id=\"bloc_option\"><div id=\"top_vert\"><div id=\"text_top\">Tutorial</div></div>"\n\
"<div id=\"center\"><div id=\"text_centre_intro\">"\n\
"<script language=\"javascript\">var gFilename = '$6';</script>"\n\
"<!--#include file=\"tutorial_toc.html\" -->"\n\
"<iframe width=\"100%\" height=\"$2\" frameborder=\"0\" src=\""$4"\" seamless></iframe>"\n\
"</div></div><div id=\"footer\"><img src=\"images/footer.jpg\" /></div></div>"\n\
"<!--#include file=\"copyright.html\" -->"\n\
"<!--#include file=\"footer.html\" -->"\n'})
-o raw:$3,char
-rm
-wait {5000+?(2000)}
-v +
nms :
-v - _gmic_s="$?" -v +
-_names $*
names :
-v - _gmic_s="$?" -v +
-_$0 $*
_names :
-e[0--3] "Set names of image$? to '$*'."
-if {$#!=@#} -warn[0--3] "Number of selected images ("@#") is different than number of provided arguments ($#)." -endif
-v - $=arg -repeat {min(@#,$#)} -nm[$>] ${arg{1+$>}} -done -v +
remove_duplicates :
-e[^-1] "Remove duplicates images in selected list of image$?."
-v - -repeat @#
base=$> off=0
-repeat {@#-$>-1}
comp={$base+1+$>-$off}
-if {$comp>=@#} -break -endif
---[$base,$comp] -abs[-1] is_duplicate={!@{-1,+}} -rm[-1]
-if $is_duplicate -rm[$comp] off={$off+1} -endif
-done
-done -v +
remove_empty :
-e[^-1] "Remove empty images in selected list of image$?."
-v - -repeat @# -if {!@{$<,whds}} -rm[$<] -endif -done -v +
sort_list : -skip ${1=+},${2=i}
-e[^-1] "Sort list of image$? in "@{-arg\ 1+{$1'=='+},descending,ascending}" order, "\
"according to the image criterion '$2'."
-v - -if @#
i=@# -repeat @# (@{$>,$2}) -done -a[$i--1] y --f[-1] 'y' -a[-2,-1] x -sort[-1] $1,y -z[-1] 1,1
-repeat {h} nm$>=@{$>,n} -nm[$>] sortlist$> -done
-repeat {h} -mv[sortlist{i(0,$>)}] -1 -done
-repeat {h} -nm[$>] ${nm{i(0,$>)}} -done
-rm[-1] -endif -v +
sort_str :
-e[^-1] "Sort image$? in lexicographic order."
-v - -y -a x
-repeat {round(h/4,1,1)} y={4*$>}
-repeat @# -l[$<]
--rows $y,{$y+3} -f[1] 'if(i>=97&&i<=122,i-32,i)' --[-1] 32 -c[-1] 0,63 -s[-1] y -*[-2] 64 -*[-3] 4096 -*[-4] 262144 -+[-4--1]
-rv -a y -sort +,x --rows 0 -rows[0] 1,100% -label[1] -%[1] 2
-s[1] +,0 N={@#-1}
x0=0 -repeat {@#-1} x1={$x0+@{{1+$>},h}} --z[0] $x0,{$x1-1} x0=$x1 -done
-rm[0-$N]
-endl -done
-done -s x -v +
mul_channels :
-e[^-1] "Multiply channels of image$? by value sequence ($*)."
-v - $=arg -repeat $#
i=$> fact=${arg{1+($>%$#)}}
-repeat @# -if @{$>,$i<s} -sh[$>] $i,$i -*[-1] $fact -rm[-1] -endif -done
-done -v +
apply_curve : -check "${1=1}>=0 && $1<=1" -skip ${2=0},${3=100}
-e[^-1] "Apply intensity curve with smoothness $1 and keypoints (${2--1}) on image$?."
-v - -function1d ${^0} -map[^-1] [-1],1 -rm[-1]
-v +
apply_gamma : -check $1>=0
-e[^-1] "Apply Gamma-correction to image$?, with gamma $1."
-if {$1==1} -return -endif
-v - -repeat @# -l[$>] mM={im},{iM} -n 0,1 -^ {1/$1} -n $mM -endl -done -v +
balance_gamma : -skip ${1=128}
-e[^-1] "Apply color balance transformation on image$?, with gamma curve and reference color ("${^0}")."
-v - -repeat @# -l[$>]
(${^0}) -r[-1] @{-2,s},1,1,1,0,1 -s[-2] c -/[-1] 255
-repeat {@#-1} -/[$>] 255 -^[$>] {log(@{-1,$>})/log(@{$>,a})} -*[$>] 255 -done
-rm[-1] -a c -c 0,255
-endl -done -v +
complex2polar :
-e[^-1] "Compute complex to polar transforms of image$?."
-v - -repeat {int(@#/2)} -l[{2*$>},{2*$>+1}]
-r[1] [0],3 --atan2[1] [0] -nm[-1] @{1,n} -sqr[-3,-2] -+[-3,-2] -sqrt[-2]
-endl -done -v +
compress_rle : -skip ${1=0} -check "isint(${2=0}) && $2>=0"
-v - s0=" for binary data" s1=""
-if $2 s=", with maximal sequence length "$2 -else s="" -endif
-v + -e[^-1] "Compress image$? using RLE algorithm"${s{!$1}}$s"." -v -
-repeat @# -l[$>] nm=@{0,n} im={im} header={w};{h};{d};{s};$im;{$1!=0}
-- $im -y x ({@{0,-1}+1}) -a x -r 100%,3
-f '>if(y==0,i,if(y==1,if(i(x,0)==i(x+1,0),-1,x),if(i(x-1,1)==-1,i(x-1,2)+1,1)))'
-if $2
-transpose -mirror x
-f[-1] '>if(x==2,i,if(x==0,if(j(0,-1)==$2,1,if(i!=1,j(0,-1)+1,1)),if(i==-1&&j(-1)==$2,y,i)))'
-mirror x -transpose
-endif
-z 0,{w-2} -s y,3 -discard[1] -1 -warp[0,2] [1],0,0 -rm[1]
-if $1
-!=[0] 0 -*[0] 2 --[0] 1 -*
-else
-*[-1] -1 -rv -a x -y -discard -1 -f '>if(i(0,y-1)<0&&i==0&&i(0,y+1)<0,-1,i)' -discard -1
-endif
-i[0] ($header) -a y -nm $nm
-endl -done -v +
eigen2tensor :
-e[^-1] "Recompose pairs in eigen field$? as 2x2 or 3x3 tensor fields."
-v - -repeat {@#/2} -l[$>,{$>+1}] nm=@{0,n}
-if {s==2}
-s[-1] c
--sqr[-1] -*[-2] [-3] -sqr[-3]
-sh[-1] --*[-3] -1
-sh[-5]
-a[-3--1] c -a[-4--2] c
-sh[-3] 0,0 -*[-3,-1]
-sh[-3] 1,1 -*[-2,-1]
-rm[-3] -+[-2,-1]
-elif {s==6}
-s[-1] c
-l[-6--4] --sqr[-2] --*[-2,-3] --sqr[-3] -*[-5] [-6] -*[-4] [-6] -sqr[-6] -a c -endl
-l[-3--1] --sqr[-2] --*[-2,-3] --sqr[-3] -*[-5] [-6] -*[-4] [-6] -sqr[-6] -a c -endl
-s[-3] c
--[-5] [-3] --[-4] [-3] -*[-2] [-5] -*[-1] [-4]
(1^0^0^1^0^1) -r[-1] [-3] -*[-1] [-4] -rm[-6--4] -+[-3--1]
-else -error[0--3] "Command '-eigen2tensor': Invalid image ["{@#-$>-1}"] : Dimensions "{w}","{h}","{d}","{s}" does not represent a field of 2d or 3d eigenvectors."
-endif
-nm $nm -endl -done -v +
float2int8 :
-e[^-1] "Convert float-valued image$? to 8bits integer representations."
-v - -repeat @# -l[$>]
-s c -repeat @# -l[$>]
m={im} M={iM} -quantize 16777216,0,1
-->> 8 -and[-1] 255 --and[-2] 255 ->>[-3] 16
({'$m,$M'}) -a y
-endl -done -a c
-endl -done -v +
int82float :
-e[^-1] "Convert 8bits integer representation$? to float-valued image$?."
-v - -repeat @# -l[$>]
-s c -repeat @# -l[$>]
-sh[-1] {h-1},{h-1},0,0 m=@{-1,t} -rm[-1]
-rows 0,{h-2} -s y,3 -*[-3] 65536 -*[-2] 256 -or
-skip @{-n\ $m}
-endl -done -a c
-endl -done -v +
ir :
-v - _gmic_s="$?" -v +
-_inrange $*
inrange :
-v - _gmic_s="$?" -v +
-_$0 $*
_inrange :
-e[0--3] "Detect pixel values in range [$1,$2] in image"$_gmic_s"."
-v - -repeat @# -l[$>]
m=$1 M=$2
-if @{-is_percent\ $1} m={im+(iM-im)*$m} -endif
-if @{-is_percent\ $2} M={im+(iM-im)*$M} -endif
-- {0.5*($m+$M)} -abs -<= {0.5*abs($M-$m)}
-endl -done -v +
map_clut : -check @{-is_image_arg\ $1}
-e[^-1] "Map color LUT $1 on image$?."
-v -
-if {!@#} -v + -return -endif
-to_color
-pass$1 0 -to_rgb[-1]
l={round((w*h*d)^(1/3))}
-if {w*h*d!=$l^3} -error "Command '-map_clut': Specified CLUT $1 has invalid dimensions "({w},{h},{d},{s}). -endif
-r[-1] $l,$l,$l,3,-1
-repeat {@#-1} -l[$>,-1] -split_opacity[0] -/[0] {256/$l}
--warp[-1] [0],0,1,1
-rm[0] -mv[-1] 0 -a[^-1] c
-endl -done -rm[-1] -v +
mix_channels :
-e[^-1] "Apply matrix $1 to channels of image$?."
-v - -repeat @# -l[$>] nm=@{0,n}
whd={w},{h},{d} -r {w*h*d},{s},1,1,-1 -i[0] ${^0} -** -r $whd,{h},-1
-nm $nm -endl -done -v +
negative :
-e[^-1] "Compute negative of image$?."
-v - -repeat @# -l[$>] -- {iM} -endl -done -* -1 -v +
norm :
-e[^-1] "Compute pointwise euclidean norm of vectors, in image$?."
-v - -sqr -compose_channels + -sqrt -v +
normalize_sum :
-e[^-1] "Normalize image$? with a unitary sum."
-v - -repeat @# -/[$>] {sum=@{$>,+};if(sum!=0,sum,1)} -done -v +
not :
-e[^-1] "Apply boolean not operation on image$?."
-v - -== 0 -v +
orientation :
-e[^-1] "Compute pointwise orientation vectors, in image$?."
-v - -repeat @# --norm[$>] -replace[-1] 0,1 -/[$>,-1] -done -v +
oneminus :
-e[^-1] "Compute one minus selected images$?."
-v + -* -1 -+ 1 -v -
otsu : -check "isint(${1=256}) && $1>0"
-e[^-1] "Hard-threshold image$? using Otsu\47s method, with $1 histogram levels."
-v - -repeat @# -l[$>]
im={im} iM={iM} -n 0,{$1-1}
--histogram $1 total=@{-1,+}
--*[-1] 'x' sum=@{-1,+} -rm[-1]
sumB=0 wB=0 wF=0 varMax=0 threshold=0
-repeat $1
wB={$wB+@{-1,$>}}
-if {$wB==0} -continue -endif
wF={$total-$wB}
-if {$wF==0} -break -endif
sumB={$sumB+$>*@{-1,$>}}
mB={$sumB/$wB}
mF={($sum-$sumB)/$wF}
varBetween={$wB*$wF*($mB-$mF)^2}
-if {$varBetween>$varMax} varMax=$varBetween threshold=$> -endif
-done
-rm[-1] ->=[-1] $threshold
threshold={$im+$threshold*($iM-$im)/($1-1)}
-if $> -u @{},$threshold -else -u $threshold -endif
-endl -done -v +
polar2complex :
-e[^-1] "Compute polar to complex transforms of image$?."
-v - -repeat {int(@#/2)} -l[{2*$>},{2*$>+1}]
-r[1] [0],3 --sin[-1] -cos[-2] -*[-1] [-3] -*[-3,-2]
-endl -done -v +
quantize : -check "isint($1) && $1>=1" -skip ${2=1},${3=0}
-e[^-1] "Quantize image$? using $1 levels, "@{-arg\ 1+!$2,with,without}" keeping value range."
-v - -repeat @# -l[$>]
-if $3
-if {s==1}
-if $2 mM={im},{iM} -n 0,$1 -round 1,-1 -min {$1-1} -n $mM
-else -n 0,$1 -round 1,-1 -min {$1-1} -endif
-else mM={im},{iM} -uniform_distribution $1,{s} -n[-1] $mM -index[-2] [-1],0,$2 -rm[-1]
-endif
-else --colormap $1,0 -index[-2] [-1],0,$2 -rm[-1]
-endif
-endl -done -v +
replace :
-e[^-1] "Replace pixel values $1 with $2 in image$?."
-v - -repeat @# -l[$>] --== $1 -*[-1] {$2-$1} -+ -endl -done -v +
replace_inf :
-e[^-1] "Replace all infinite values in image$? by expression '$1'."
-v - -f "if(i==i+1,$1,i)" -v +
replace_nan :
-e[^-1] "Replace all NaN values in images$? by expression '$1'."
-v - -f "if(i>=0 || i<=0,i,$1)" -v +
replace_seq : -skip "${2=}"
-e[^-1] "Replace value sequence '$1' by value sequence '${2--1}' in image$?."
-v - ns={narg($1)} nd={narg(${2--1})} ratio={$nd*100/$ns}
-repeat @# -l[$>] -if {w}
-s +,$1 --rows[0] 0,{$ns-1} ($1) --[-2,-1] -abs[-1] ind={iM!=0} -rm[-1]
-if {$ind<@#} -if $nd -r[$ind--1:2] 1,$ratio%,1,1,0 -f[$ind--1:2] ${2--1} -else -rm[$ind--1:2] -endif -a y -endif
-endif -endl -done -v +
replace_str : -skip "${2=}"
-e[^-1] "Replace string '$1' by string '${2--1}' in image$? (viewed as string$?)."
-v - -replace_seq @{-quote\ {'"$1"'}},{'"${2--1}"'} -v +
roundify : -check $1>=0
-e[^-1] "Roundify image$?, with gamma $1."
-if {$1==1} -return -endif
-v - -repeat @# -l[$>]
--round 1 --[-2] [-1] --*[-2] 2 -abs[-1] -^[-1] $1 -sign[-3] -*[-3,-1] -*[-2] 0.5 -+
-endl -done -v +
uncompress_rle :
-e[^-1] "Uncompress data vector$?, using RLE algorithm."
-v - -repeat @# -l[$>]
-y whds=@{0,0-3} im=@{0,4} is_binary_data=@{0,5} -rows 6,100%
-if $is_binary_data
-->= 0 -abs[0] -a x
-else
--<[-1] 0 (0;1;1) -erode[-2] [-1],0 -rm[-1] --[-1] 1 -a x -discard -1
--< 0 (1;1;0) -dilate[-2] [-1] -rm[-1] -*[-1] -2 -+[-1] 1
-rv -abs[-1] -a x -discard -1
-r 2,{h/2},1,1,-1
-endif
-s y,-256
-repeat @# -l[$>]
-i[0] ({'CImg3d'}) -+[0] 0.5
-i[1] ({2*h};{h})
-s[-1] x,2 -cumulate[-2] siz=@{-2,-1}
--shift[-2] 0,1 --[-3] 1 -rv[-3,-1] -z[-3,-1] 0,2 -a[-3,-1] x
-i[3] (2,0,1;2,{2*h-2},{2*h-1}) -r[3] 3,{h},1,1,3 -round[3]
-r[4] 3 1,100%,1,1,1 -y -a y
$siz -j3d[-1] [-2],0,0,0,1,2,0,0 -rm[-2]
-endl -done
-a x -r $whds,-1 -+ $im
-endl -done -v +
unrepeat :
-e[^-1] "Remove repetition of adjacent values in image$?."
-v - -repeat @# -l[$>] nm=@{0,n}
-y x ({@{0,-1}+1}) -a x -r 100%,2
-f[-1] '>if(y==0,i,if(i(x,0)==i(x+1,0),-1,x))'
-z 0,{w-2} -s y,2 -discard[1] -1 -map[1] [0]
-rm[0] -nm $nm
-endl -done -v +
vector2tensor :
-e[^-1] "Convert vector field$? to tensor field$?."
-v - -repeat @# -l[$>]
-s c
-if {@#==2} --sqr[-1] -*[-2] [-3] -sqr[-3]
-elif {@#==3} --sqr[-2] --*[-3] [-2] --sqr[-3] -*[-5,-4] [-6] -sqr[-6]
-else -error[0--4] "Command '-vector2tensor': Invalid image ["{@#-$>-1}"] : Dimensions "{w}","{h}","{d}","{s}" does not represent a field of 2d or 3d vectors."
-endif
-a c
-endl -done -v +
ac :
-v - _gmic_s="$?" -v +
-_apply_channels $"*"
apply_channels :
-v - _gmic_s="$?" -v +
-_$0 $"*"
_apply_channels : -check "isint(${3=0}) && $3>=0 && $3<=2"
-v -
-if {isval("$2")} -if {isint("$2")}
mode=@{-arg\ 1+$2,all,rgba,rgb,rgb_r,rgb_g,rgb_b,rgba_a,\
ycbcr_y,ycbcr_cbcr,ycbcr_cb,ycbcr_cr,ycbcr_cg,\
lab_l,lab_ab,lab_a,lab_b,\
lch_ch,lch_c,lch_h,\
hsv_h,hsv_s,hsv_v,hsi_i,hsl_l,\
cmyk_c,cmyk_m,cmyk_y,cmyk_k}
-else mode="$2" -endif -else mode="$2" -endif
-v + -e[^-1] "Apply command '$1' on channel '"$mode"' of image"$_gmic_s"." -v -
-_ac_$mode -m "_ac_precond : "$_p -m "_ac_forward : "$_f -m "_ac_backward : "$_b
-repeat @# -l[$>]
-_ac_precond is_alpha={s==2" || "s==4}
-if $is_alpha -s c,{1-s} -endif
-_ac_forward[0] -a c
-sh $_s -_ac[-1] "$1"
-if {$3==1} -c[-1] 0,255 -elif {$3==2} -n[-1] 0,255 -endif
-rm[-1]
-if $is_alpha -s c,{1-s} -endif
-_ac_backward[0] -a c
-endl -done
-uncommand "_ac_precond" -uncommand "_ac_forward" -uncommand "_ac_backward"
-v +
_ac :
whs={w},{h},1,{s} ${1--1} -k[0] -r $whs,0
_ac_all : _p="" _f="" _b="" _s=0,100%
_ac_rgba : _p="-to_rgba" _f="" _b="" _s=0,3
_ac_rgba_r : _p="-to_color" _f="" _b="" _s=0,0
_ac_rgba_g : _p="-to_color" _f="" _b="" _s=1,1
_ac_rgba_b : _p="-to_color" _f="" _b="" _s=2,2
_ac_rgba_a : _p="-to_rgba" _f="" _b="" _s=3,3
_ac_rgb : _p="-to_color" _f="" _b="" _s=0,2
_ac_rgb_r : -_ac_rgba_r
_ac_rgb_g : -_ac_rgba_g
_ac_rgb_b : -_ac_rgba_b
_ac_ycbcr : _p="-to_color" _f="-rgb2ycbcr" _b="-ycbcr2rgb" _s=0,2
_ac_ycbcr_y : _p="-to_color" _f="-rgb2ycbcr" _b="-ycbcr2rgb" _s=0,0
_ac_ycbcr_cbcr : _p="-to_color" _f="-rgb2ycbcr" _b="-ycbcr2rgb" _s=1,2
_ac_ycbcr_cb : _p="-to_color" _f="-rgb2ycbcr" _b="-ycbcr2rgb" _s=1,1
_ac_ycbcr_cr : _p="-to_color" _f="-rgb2ycbcr" _b="-ycbcr2rgb" _s=2,2
_ac_ycbcr_cg : _p="-to_color" _f="-sh 0,1 -mirror[-1] c -rm[-1] -rgb2ycbcr" _b="-ycbcr2rgb -sh 0,1 -mirror[-1] c -rm[-1]" _s=2,2
_ac_lab : _p="-to_color" _f="-srgb2rgb -rgb2lab8" _b="-lab82rgb -rgb2srgb" _s=0,2
_ac_lab_l : _p="-to_color" _f="-srgb2rgb -rgb2lab8" _b="-lab82rgb -rgb2srgb" _s=0,0
_ac_lab_ab : _p="-to_color" _f="-srgb2rgb -rgb2lab8" _b="-lab82rgb -rgb2srgb" _s=1,2
_ac_lab_a : _p="-to_color" _f="-srgb2rgb -rgb2lab8" _b="-lab82rgb -rgb2srgb" _s=1,1
_ac_lab_b : _p="-to_color" _f="-srgb2rgb -rgb2lab8" _b="-lab82rgb -rgb2srgb" _s=2,2
_ac_lch : _p="-to_color" _f="-srgb2rgb -rgb2lch8" _b="-lch82rgb -rgb2srgb" _s=0,2
_ac_lch_l : -_ac_lab_l
_ac_lch_ch : _p="-to_color" _f="-srgb2rgb -rgb2lch8" _b="-lch82rgb -rgb2srgb" _s=1,2
_ac_lch_c : _p="-to_color" _f="-srgb2rgb -rgb2lch8" _b="-lch82rgb -rgb2srgb" _s=1,1
_ac_lch_h : _p="-to_color" _f="-srgb2rgb -rgb2lch8" _b="-lch82rgb -rgb2srgb" _s=2,2
_ac_hsv : _p="-to_color" _f="-rgb2hsv8" _b="-hsv82rgb" _s=0,2
_ac_hsv_h : _p="-to_color" _f="-rgb2hsv8" _b="-hsv82rgb" _s=0,0
_ac_hsv_s : _p="-to_color" _f="-rgb2hsv8" _b="-hsv82rgb" _s=1,1
_ac_hsv_v : _p="-to_color" _f="-rgb2hsv8" _b="-hsv82rgb" _s=2,2
_ac_hsi : _p="-to_color" _f="-rgb2hsi8" _b="-hsi82rgb" _s=0,2
_ac_hsi_h : _p="-to_color" _f="-rgb2hsi8" _b="-hsi82rgb" _s=0,0
_ac_hsi_s : _p="-to_color" _f="-rgb2hsi8" _b="-hsi82rgb" _s=1,1
_ac_hsi_i : _p="-to_color" _f="-rgb2hsi8" _b="-hsi82rgb" _s=2,2
_ac_hsl : _p="-to_color" _f="-rgb2hsl8" _b="-hsl82rgb" _s=0,2
_ac_hsl_h : _p="-to_color" _f="-rgb2hsl8" _b="-hsl82rgb" _s=0,0
_ac_hsl_s : _p="-to_color" _f="-rgb2hsl8" _b="-hsl82rgb" _s=1,1
_ac_hsl_l : _p="-to_color" _f="-rgb2hsl8" _b="-hsl82rgb" _s=2,2
_ac_cmy : _p="-to_color" _f="-rgb2cmy" _b="-cmy2rgb" _s=0,2
_ac_cmy_c : _p="-to_color" _f="-rgb2cmy" _b="-cmy2rgb" _s=0,0
_ac_cmy_m : _p="-to_color" _f="-rgb2cmy" _b="-cmy2rgb" _s=1,1
_ac_cmy_y : _p="-to_color" _f="-rgb2cmy" _b="-cmy2rgb" _s=2,2
_ac_cmyk : _p="-to_color" _f="-rgb2cmyk" _b="-cmyk2rgb" _s=0,3
_ac_cmyk_c : _p="-to_color" _f="-rgb2cmyk" _b="-cmyk2rgb" _s=0,0
_ac_cmyk_m : _p="-to_color" _f="-rgb2cmyk" _b="-cmyk2rgb" _s=1,1
_ac_cmyk_y : _p="-to_color" _f="-rgb2cmyk" _b="-cmyk2rgb" _s=2,2
_ac_cmyk_k : _p="-to_color" _f="-rgb2cmyk" _b="-cmyk2rgb" _s=3,3
autoindex : -check "isint($1) && $1>0 && ${2=0}>=0" -skip ${3=0}
-e[^-1] "Index colors in images$? by adapted colormap with $1 entries, dithering level $2 and "\
@{-arg\ 1+!$3,k-means,median-cut}" method."
-v - -repeat @# -l[$>]
-if {w>h} -if {w>256} --r2dx 256 -else [0] -endif
-else -if {h>256} --r2dy 256 -else [0] -endif
-endif
-colormap[1] $1,$3,0
-index[0] [1],$2,1 -rm[1]
-endl -done -v +
bayer2rgb : -skip ${1=1},${2=1},${3=0.5}
-e[^-1] "Transform RGB-Bayer image$? to color images, with smoothness ($1,$2,$3)."
-v - -channels 0 -repeat @# -l[$>]
-expand_x {"2 + 4*$1"},0 -expand_y {"2 + 4*$1"},0
(-1,1;1,-1) -r[-1] [-2],[-2],1,1,0,2
--*[-2] [-1]
(0.25,0.5,0.25) -convolve[-2] [-1] -transpose[-1] -convolve[-2] [-1] -rm[-1]
-b[-1] $1
-*[-2] [-1]
--[-3,-2]
(1,-1) -r[-1] [-2],[-2],1,1,0,2
-*[-1] [-3]
(0.25,0.5,0.25) -convolve[-2] [-1] -transpose[-1] -convolve[-2] [-1] -rm[-1]
-blur_y[-1] $2 -blur_x[-1] $3
(1;-1) -r[-1] [-2],[-2],1,1,0,2
-*[-1] [-4]
(0.25,0.5,0.25) -convolve[-2] [-1] -transpose[-1] -convolve[-2] [-1] -rm[-1]
-blur_x[-1] $2 -blur_y[-1] $3
-+[-2,-1] -/[-1] 2
(2,0;0,-2) -r[-1] [-2],[-2],1,1,0,2
-*[-1] [-2]
--[-4,-1]
-a[-3--1] c
-mix_rgb[-1] 1,-1,2,1,1,0,1,-1,-2
-shrink_x {"2 + 4*$1"},0 -shrink_y {"2 + 4*$1"},0
-c 0,255
-endl -done -v +
cmy2rgb :
-e[^-1] "Convert image$? from CMY to RGB color bases."
-v - -rgb2cmy -v +
cmyk2rgb :
-e[^-1] "Convert image$? from CMYK to RGB color bases."
-v - -repeat @# -l[$>]
-s c --/[-1] -255 -+[-1] 1 -*[0-2] [-1] -rm[-1] -+[0-2] [-1] -rm[-1]
-a c -cmy2rgb
-endl -done -v +
colormap : -check "isint($1) && $1>=0" -skip ${2=0},${3=1}
-if $1
-e[0--3] "Estimate colormap with $1 entries for image$?, by "@{-arg\ 1+!$2,k-means,median-cut}" method."
-else
-e[0--3] "Estimate full colormap for image$?."
-endif
-v - -repeat @# -l[$>]
-if $1
-r {w*h},1,1,100%,-1
-if {!$2} -_colormap $1
-else
m={im} M={iM} -n[-1] 0,255
--_colormap $1 --index[-2] [-1] -*[-1] 256 -+[-3,-1]
-do
-repeat {s}
-sh[0] $>,$> --histogram[-1] {$1*256},0,{$1*256-1} -rm[-2]
-i[-2] 256,1,1,1,'x' -r[-2] {w},1,1,1,0,2 -*[-2] [-1] -r[-2,-1] $1,1,1,1,2 -max[-1] 0.01 -/[-2,-1]
-done -a[2--1] c
--[-2] [-1] -abs[-2] diff={@{-2,+}/w} -rm[-2]
-and[-2] 255 --index[-2] [-1],0,0 -*[-1] 256 -+[-3,-1]
-while {$diff>0.5}
-rm[-2] -*[-1] {($M-$m)/255} -+[-1] $m
-endif
-else
-r {w*h*d},1,1,100%,-1
-repeat {s} -ap "-sort +,x" -s x,0 -ap "-shift 0,0,0,1,2" -done
-ap "-discard x" -a x
-endif
-if $3 --norm -rv -a y -sort +,x -rows 1 -endif
-nm "[colormap of "@{-1,b}"]"
-endl -done -v +
_colormap :
-repeat {$1-1}
@#,{s} -repeat {@#-1}
n=$> -repeat @{$n,s} -sh[$n] $>,$> -=[-2] {if(w>1,iv,-1)},$n,$> -rm[-1] -done
-done
c=@{-1,C}
b=@{-arg\ 1,$c}
a=@{-arg\ 2,$c}
-rm[-1] -shift[$b] 0,0,0,{-$a},2 -sort[$b] +,x -shift[$b] 0,0,0,$a,2 -s[$b] x,2
-done
-r 1,1,1,100%,2 -a x
compose_channels : -skip ${1="+"}
-e[^-1] "Compose all channels of image$?, with operator '$1'."
-v - -repeat @# -l[$>]
-sh 0,0
-repeat {@{-2,s}-1} -sh[-2] {$>+1},{$>+1} -l[-2,-1] -$1 -endl -done
-rm[-1] -r 100%,100%,100%,1,-1
-endl -done -v +
direction2rgb :
-e[^-1] "Compute RGB representation of 2d direction field$?."
-v - -channels 0,1 -repeat @# -l[$>] nm=@{0,n}
-s c -complex2polar -round[-2] 0.001
-*[-1] {180/pi} -%[-1] 360 100%,100%,1,1,1 -mv[-3] @#
-if {im!=iM} -n[-1] 0,1 -else -f[-1] 1 -endif
-a c -hsv2rgb
-nm $nm -endl -done -v +
ditheredbw :
-e[^-1] "Create dithered B&W version of image$?."
-v - -repeat @# -l[$>] -split_opacity
-luminance[0] -n[0] 0,255 (0,255) -index[0] [-1],1,1 -rm[-1]
-a c -endl -done -v +
fc :
-v - _gmic_s="$?" -v +
-_fill_color $*
fill_color :
-v - _gmic_s="$?" -v +
-_$0 $*
_fill_color :
-e[0--3] "Fill image"$_gmic_s" with color (${^0})."
-v - -repeat @# -l[$>]
-repeat {s} -sh[0] $>,$> -f[-1] {arg(1+$>,${^0})} -done -k[0]
-nm @{-1,n} -endl -done -v +
gradient2rgb : -check "isbool(${1=0})"
-arg 1+!$1,"orientation ",""
-e[^-1] "Compute RGB representation of 2d gradient "@{}"of image$?."
-v - -norm -repeat @# -l[$>]
-if $1 -gradient_orientation 2 -else -g xy -endif
-a c -direction2rgb
-endl -done -v +
hsi82rgb :
-e[^-1] "Convert image$? from HSI8 to RGB color bases."
-v - -_hsx82rgb -hsi2rgb -v +
hsl82rgb :
-e[^-1] "Convert image$? from HSL8 to RGB color bases."
-v - -_hsx82rgb -hsl2rgb -v +
hsv82rgb :
-e[^-1] "Convert image$? from HSV8 to RGB color bases."
-v - -_hsx82rgb -hsv2rgb -v +
_hsx82rgb :
-repeat @#
-sh[$>] 0,0 -/[-1] 0.708333 -rm[-1]
-sh[$>] 1,2 -/[-1] 255 -rm[-1]
-done
int2rgb :
-e[^-1] "Convert image$? from INT24 scalars to RGB."
-v - -round -repeat @# -l[$>]
-->> 8 -&[1] 255 --&[0] 255 ->>[0] 16 -a c
-endl -done -v +
lab2lch :
-e[^-1] "Convert image$? from Lab to Lch color bases."
-v - -r 100%,100%,100%,3 -repeat @# -l[$>]
-s c -complex2polar[-2,-1] -a c
-endl -done -v +
lab82rgb :
-e[^-1] "Convert image$? from Lab8 to RGB color bases."
-v - -repeat @#
-sh[$>] 0,0 -/[-1] 2.55 -rm[-1]
-sh[$>] 1,1 -/[-1] 1.275 --[-1] 100 -rm[-1]
-sh[$>] 2,2 -/[-1] 1.15909 --[-1] 110 -rm[-1]
-done -lab2rgb -v +
lch2lab :
-e[^-1] "Convert image$? from Lch to Lab color bases."
-v - -r 100%,100%,100%,3 -repeat @# -l[$>]
-s c -polar2complex[-2,-1] -a c
-endl -done -v +
lch2rgb :
-e[^-1] "Convert image$? from Lch to RGB color bases."
-v - -lch2lab -lab2rgb -v +
lch82rgb :
-e[^-1] "Convert image$? from Lch8 to RGB color bases."
-v - -repeat @#
-sh[$>] 0,0 -/[-1] 2.55 -rm[-1]
-sh[$>] 1,1 -/[-1] 1.88889 -rm[-1]
-sh[$>] 2,2 -/[-1] 40.5845 --[-1] 3.14159 -rm[-1]
-done -lch2rgb -v +
luminance :
-e[^-1] "Compute luminance of image$?."
-v - -remove_opacity -srgb2rgb
-repeat @# -l[$>]
-if {s==3} -sh 0,0 -sh[0] 1,1 -sh[0] 2,2 -*[1] 0.299 -*[2] 0.587 -*[3] 0.114 -+[1-3] -rm[1]
-elif {s!=1} -norm -n 0,255
-endif -endl -done
-channels 0 -rgb2srgb -v +
mix_rgb : -skip ${1=1},${2=0},${3=0},${4=0},${5=1},${6=0},${7=0},${8=0},${9=1}
-e[^-1] "Apply matrix [ $1 $2 $3 ; $4 $5 $6 ; $7 $8 $9 ] to RGB colors of image$?."
-v - -r 100%,100%,1,3,0,2 -mix_channels ($1,$2,$3;$4,$5,$6;$7,$8,$9) -v +
pseudogray : -check "isint(${1=5}) && $1>=0 && ${2=2.3}>=0 && isint(${3=8}) && $3>0"
-e[^-1] "Generate pseudogray colormap with increment $1, JND threshold $2 and $3 bits depth."
-v -
{round(2^$3)},1,1,3,'x'
-if {!$1} -n[-1] 0,255 -v + -return -endif
{$1+1},{$1+1},{$1+1},1,'x' --f[-1] 'y' --f[-1] 'z' -a[-3--1] c -r[-1] {w*h*d},1,1,3,-1
-f[-1] 'R=i(x,0,0,0);G=i(x,0,0,1);B=i(x,0,0,2);if(min(R,G,B),-1,i)'
-permute[-1] cxyz -discard[-1] -1 -r[-1] 3,{h/3},1,1,-1 -permute[-1] yzcx
-r[-2] {w*100}% -r[-1] [-2],0,2 -+[-2,-1]
-f[-1] 'R=i(x,0,0,0);G=i(x,0,0,1);B=i(x,0,0,2);if(max(R,G,B)>2^$3-1,-1,i)'
-permute[-1] cxyz -discard[-1] -1 -r[-1] 3,{h/3},1,1,-1 -permute[-1] yzcx
-n[-1] 0,255
--srgb2rgb[-1] -rgb2lab[-1] -rv[-2,-1] -a[-2,-1] y -sort[-1] +,x
-if {!$2} -rows[-1] 1
-else
-s[-1] y -rv[-2,-1] [-1] -sh[-1] 1,2 -f[-1] 0 -rm[-1] --[-2,-1] -norm[-1]
-<=[-1] $2 -*[-1] 'x+1' -discard[-1] 0 --[-1] 1 -map[-1] [-2] -rm[-2]
-repeat 10000
--srgb2rgb[-1] -rgb2lab[-1] --shift[-1] 0,{1-2*($>%2)},0,0,1 --[-2,-1] -norm[-1]
-<=[-1] $2
-if {im} -rm[-1] -break -endif
-*[-1] 'y+1' -discard[-1] 0 --[-1] 1 -map[-1] [-2] -rm[-2]
-done
-transpose[-1]
-endif
-v +
replace_color : -check "$1>=0 && $2>=0"
-v - -l[] (${3--1}) -y c -s c,2 col1=@0 col2=@1 -rm -endl -v +
-e[^-1] "Replace color ("$col1") by color ("$col2") in image$?, with tolerance $1 and smoothness $2."
-v - -repeat @# -l[$>]
1,1,1,100%,$col1 -r[1] [0]
-if $1 --[1] [0] -norm[1] -<=[1] $1 -else -==[1] [0] -l[1] -s c -and -endl -endif
-b[1] $2
1,1,1,@{0,s},$col2 -r[2] [0] -j[0] [2],0,0,0,0,1,[1] -k[0]
-endl -done -v +
rgb2bayer : -skip ${1=0},${2=0}
-e[^-1] "Transform image$? to a RGB-Bayer "@{-arg\ 1+!$2,color,monochrome}" grid, starting from pattern '$1'."
-v - -to_rgb -repeat @# -l[$>]
-_rgb2bayer$1 -r[1] [0],0,2 -* -if {!$2} -s c -+ -endif
-endl -done -v +
_rgb2bayer0 : (1,0;0,0^0,1;1,0^0,0;0,1)
_rgb2bayer1 : (0,0;0,1^0,1;1,0^1,0;0,0)
_rgb2bayer2 : (0,1;0,0^1,0;0,1^0,0;1,0)
_rgb2bayer3 : (0,0;1,0^1,0;0,1^0,1;0,0)
rgb2cmy :
-e[^-1] "Convert image$? from RGB to CMY color bases."
-v - -to_rgb -c 0,255 -* -1 -+ 255 -v +
rgb2cmyk :
-e[^-1] "Convert image$? from RGB to CMYK color bases."
-v - -rgb2cmy -repeat @# -l[$>]
-s c --min --[0-2] [-1] --/[-1] 255 --[-1] 1 -*[-1] -1 --==[-1] 0 -+[-2,-1]
-/[0-2] [-1] -rm[-1] -a c
-endl -done -v +
rgb2hsi8 :
-e[^-1] "Convert image$? from RGB to HSI8 color bases."
-v - -rgb2hsi -_rgb2hsx8 -v +
rgb2hsl8 :
-e[^-1] "Convert image$? from RGB to HSL8 color bases."
-v - -rgb2hsl -_rgb2hsx8 -v +
rgb2hsv8 :
-e[^-1] "Convert image$? from RGB to HSV8 color bases."
-v - -rgb2hsv -_rgb2hsx8 -v +
_rgb2hsx8 :
-repeat @#
-sh[$>] 0,0 -*[-1] 0.708333 -rm[-1]
-sh[$>] 1,2 -*[-1] 255 -rm[-1]
-done
rgb2lab8 :
-e[^-1] "Convert image$? from RGB to Lab8 color bases."
-v - -rgb2lab -repeat @#
-sh[$>] 0,0 -*[-1] 2.55 -rm[-1]
-sh[$>] 1,1 -+[-1] 100 -*[-1] 1.275 -rm[-1]
-sh[$>] 2,2 -+[-1] 110 -*[-1] 1.15909 -rm[-1]
-done -v +
rgb2lch :
-e[^-1] "Convert image$? from RGB to Lch color bases."
-v - -rgb2lab -lab2lch -v +
rgb2lch8 :
-e[^-1] "Convert image$? from RGB to Lch8 color bases."
-v - -rgb2lch -repeat @#
-sh[$>] 0,0 -*[-1] 2.55 -rm[-1]
-sh[$>] 1,1 -*[-1] 1.88889 -rm[-1]
-sh[$>] 2,2 -+[-1] 3.14159 -*[-1] 40.5845 -rm[-1]
-done -v +
rgb2luv :
-e[^-1] "Convert image$? from RGB to LUV color bases."
-v - -repeat @# -l[$>]
--rgb2xyz -rgb2lab[-2] -channels[-2] 0 -s[-1] c
-*[-1] 3 --*[-2] 15 -+[-2,-1] -+[-1] [-3] -+[-1] 1e-8
-*[-3] 4 -*[-2] 9 -/[-3,-2] [-1] -rm[-1]
--[-2] 0.2009 --[-1] 0.4610
--*[-3] 13 -*[-3] [-1] -*[-2,-1] -a c
-endl -done -v +
rgb2int :
-e[^-1] "Convert image$? from RGB to INT24 scalars."
-v - -to_rgb -round -repeat @# -l[$>]
-s c -<<[0] 16 -<<[1] 8 -+
-endl -done -v +
rgb2xyz :
-e[^-1] "Convert image$? from RGB to XYZ color bases."
-v - -/ 255 -mix_rgb 0.412453,0.357580,0.180423,0.212671,0.715160,0.072169,0.019334,0.119193,0.950227 -v +
rgb2xyz8 :
-e[^-1] "Convert image$? from RGB to XYZ8 color bases."
-v - -rgb2xyz -repeat @#
-sh[$>] 0,0 -*[-1] 255 -rm[-1]
-sh[$>] 1,1 -*[-1] 255 -rm[-1]
-sh[$>] 2,2 -*[-1] 231.8182 -rm[-1]
-done -v +
rgb2ycbcr :
-e[^-1] "Convert image$? from RGB to YCbCr color bases."
-v - -mix_rgb 66,129,25,-38,-74,112,112,-94,-18 -+ 128 -/ 256
-repeat @# -l[$>] -sh 0,0 -+[-1] 16 -rm[-1] -sh 1,2 -+[-1] 128 -rm[-1] -endl -done
-v +
rgb2yuv :
-e[^-1] "Convert image$? from RGB to YUV color bases."
-v - -/ 255 -mix_rgb 0.299,0.587,0.114,-0.14713,-0.28886,0.436,0.615,-0.51498,-0.10001 -v +
rgb2yuv8 :
-e[^-1] "Convert image$? from RGB to YUV8 color bases."
-v - -rgb2yuv -repeat @#
-sh[$>] 0,0 -*[-1] 255 -rm[-1]
-sh[$>] 1,1 -+[-1] 0.44 -*[-1] 289.773 -rm[-1]
-sh[$>] 2,2 -+[-1] 0.62 -*[-1] 205.645 -rm[-1]
-done -v +
remove_opacity :
-e[^-1] "Remove opacity channel of image$?."
-v - -repeat @# -l[$>]
-if {s==2} -channels 0
-elif {s==4} -channels 0,2
-endif
-nm @{-1,n} -endl -done -v +
select_color : -skip ${1=0}
-e[^-1] "Select color (${2--1}) in image$?, with tolerance $1."
-v - -repeat @# -l[$>]
--fc ${2--1} -- -norm -<= $1
-endl -done -v +
sepia :
-e[^-1] "Apply sepia tones effect on image$?."
-v - (0,44,115,143,196,244^0,20,84,119,184,235^0,5,44,73,144,200) -r[-1] 256,1,1,3,3
-repeat {@#-1} -l[$>,-1] -split_opacity -luminance[0] -map[0] [-1] -a[^-1] c -endl -done
-rm[-1] -v +
solarize :
-e[^-1] "Solarize image$?."
-v - -luminance -n 0,128 -map 1 -v +
split_colors : -check "${1=0}>=0 && isint(${2=256}) && $2>0 && ${3=8}>=1"
-e[^-1] "Split image$? as single color outputs, with tolerance $1, $2 maximal outputs and minimal color area $3."
-v - -repeat @# -l[$>]
--label 0,1 -norm[-1] -area[-1] 0,1
-repeat {$2-1}
coordsM=@{1,C}
-if {@{1,($coordsM)}<$3} -break -endif
color=@{-at[0]\ $coordsM}
--select_color[0] $1,$color
-==[-1] 0 -*[1] [-1] -==[-1] 0
-done
-if @{1,M} -!=[1] 0 -mv[1] @#
-else -rm[1] -endif
-r[^0] [0],[0],[0],@{0,s+1}
N={@#-1}
-sh[^0] 0,{s-2} -*[-$N--1] [0] -rm[-$N--1]
-sh[^0] 100%,100% -*[-$N--1] 255 -rm[0,-$N--1]
-endl -done -v +
split_opacity :
-e[^-1] "Split color and opacity parts of image$?."
-v - -repeat @# -l[$<] -s c,{if(s==4,-3,if(s==2,-1,-s))} -endl -done -v +
to_a :
-e[^-1] "Force image$? to have an alpha channel."
-v - -repeat @# -l[$>]
-if {s==1||s==3} -channels 0,{s} -sh[-1] {s-1},{s-1} -f[-1] 255 -rm[-1] -endif
-endl -done -v +
to_color :
-e[^-1] "Force image$? to be in color mode."
-v - -repeat @# -l[$>]
-if {s>4} -error[] "Command '-to_color': Image ["@{<,-1}"] is not a G,GA,RGB or RGBA image."
-elif {s==2} -r 100%,100%,1,4,0,1,0,0,0,1
-elif {s==1} -r 100%,100%,1,3,1
-endif
-endl -done -v +
to_colormode : -skip ${1=0}
-if {$1==1} -to_gray
-elif {$1==2} -to_graya
-elif {$1==3} -to_rgb
-elif {$1==4} -to_rgba
-else
s=1 -repeat @#
-if {@{$>,s}>4} -error "Command '-to_colormode': Image ["$>"] is not a G,GA,RGB or RGBA image."
-else s={max($s,@{$>,s})}
-endif
-done -to_colormode $s
-endif
to_gray :
-e[^-1] "Force image$? to be in GRAY mode."
-v - -repeat @# -l[$>]
-if {s>4} -error[] "Command '-to_gray': Image ["@{<,-1}"] is not a G,GA,RGB or RGBA image."
-elif {s>=3} -channels 0,2 -luminance
-elif {s==2} -r 100%,100%,100%,1,0
-endif
-endl -done -v +
to_graya :
-e[^-1] "Force image$? to be in GRAYA mode."
-v - -repeat @# -l[$>]
-if {s>4} -error[] "Command '-to_graya': Image ["@{<,-1}"] is not a G,GA,RGB or RGBA image."
-elif {s==4} --channels 3 -channels[-2] 0,2 -luminance[-2] -a c
-elif {s==3} -luminance -channels 0,1 -sh[-1] 1,1 -f[-1] 255 -rm[-1]
-elif {s==1} -channels 0,1 -sh[-1] 1,1 -f[-1] 255 -rm[-1]
-endif
-endl -done -v +
to_pseudogray : -check "isint(${1=5}) && $1>=0 && isint(${3=8}) && $3>0" -skip ${2=1}
-e[^-1] "Convert scalar image$? to pseudo-gray color images, with steps $1."
-v - -channels 0 -srgb2rgb -pseudogray $1,{2.3*$2},$3
--srgb2rgb[-1] -rgb2lab[-1] -channels[-1] 0 -*[-1] {65535/100} -round[-1] -rows[-1] 0,2
-rv[-2,-1] -permute[-1] xcyz -+[-1] 1 -a[-2,-1] y -pointcloud[-1] 0
--norm[-1] -!=[-1] 0 -distance[-1] 1 -*[-1] -1 -watershed[-2] [-1] -rm[-1] --[-1] 1
-repeat {@#-1}
-to_rgb[$>] -rgb2lab[$>] -channels[$>] 0 -*[$>] {65535/100} -round[$>] -c[$>] 0,65535
-map[$>] [-1]
-done -rm[-1] -v +
to_rgb :
-e[^-1] "Force image$? to be in RGB mode."
-v - -repeat @# -l[$>]
-if {s>4} -error[] "Command '-to_rgb': Image ["@{<,-1}"] is not a G,GA,RGB or RGBA image."
-elif {s==4} -channels 0,2
-elif {s==2} -channels 0,0 -r 100%,100%,100%,3
-elif {s==1} -r 100%,100%,100%,3
-endif
-endl -done -v +
to_rgba :
-e[^-1] "Force image$? to be in RGBA mode."
-v - -repeat @# -l[$>]
-if {s>4} -error[] "Command '-to_rgba': Image ["@{<,-1}"] is not a G,GA,RGB or RGBA image."
-elif {s==3} -channels 0,3 -sh[-1] 3,3 -f[-1] 255 -rm[-1]
-elif {s==2} -r 100%,100%,100%,4 -sh[-1] 2,2 -f[-1] [-2] -rm[-1]
-elif {s==1} -r 100%,100%,100%,4 -sh[-1] 3,3 -f[-1] 255 -rm[-1]
-endif
-endl -done -v +
transfer_colors : -skip ${1=0}
-e[^-1] "Transfer colors of image $1 to image$?."
-v - -pass$1 0 -mv[-1] 0 -to_rgb[0] -to_colormode[^0] {max(3,@{-max_s})} -c 0,255
-repeat @# -l[$>] -split_opacity -rgb2ycbcr[0] -a c -endl -done
-l[0] -s c -histogram_cumul 256,1,0,255 -a c -* 255 -endl
-repeat {@#-1} -l[0,{$<+1}]
-if $1 -repeat 3 -sh[0,1] $>,$> -equalize[-1] 256,0,255 -index[-1] [-2],0,0 -rm[-2,-1] -done
-else -repeat 2 -sh[0,1] {$>+1},{$>+1} -equalize[-1] 256,0,255 -index[-1] [-2],0,0 -rm[-2,-1] -done
-endif
-endl -done -rm[0]
-repeat @# -l[$>] -split_opacity -ycbcr2rgb[0] -a c -endl -done
-v +
_transfer_colors :
-repeat @# -l[$>] -rgb2ycbcr -s c -histogram 256,0,255 -a c -dg 300,200 -endl -done
xyz2rgb :
-e[^-1] "Convert image$? from XYZ to RGB color bases."
-v - -* 255 -mix_rgb 3.240479,-1.537150,-0.498535,-0.969256,1.875992,0.041556,0.055648,-0.204043,1.057311 -c 0,255 -v +
xyz82rgb :
-e[^-1] "Convert image$? from XYZ8 to RGB color bases."
-v - -repeat @#
-sh[$>] 0,0 -/[-1] 255 -rm[-1]
-sh[$>] 1,1 -/[-1] 255 -rm[-1]
-sh[$>] 2,2 -/[-1] 231.8182 -rm[-1]
-done -xyz2rgb -v +
ycbcr2rgb :
-e[^-1] "Convert image$? from YCbCr to RGB color bases."
-v - -repeat @# -l[$>] -sh 0,0 --[-1] 16 -rm[-1] -sh 1,2 --[-1] 128 -rm[-1] -endl -done
-mix_rgb 298,0,409,298,-100,-208,298,516,0 -+ 128 -/ 256 -c 0,255
-v +
yuv2rgb :
-e[^-1] "Convert image$? from YUV to RGB color bases."
-v - -mix_rgb 1,0,1.13983,1,-0.39465,-0.5806,1,2.03211,0 -* 255 -v +
yuv82rgb :
-e[^-1] "Convert image$? from YUV8 to RGB color bases."
-v - -repeat @#
-sh[$>] 0,0 -/[-1] 255 -rm[-1]
-sh[$>] 1,1 -/[-1] 289.773 --[-1] 0.44 -rm[-1]
-sh[$>] 2,2 -/[-1] 205.645 --[-1] 0.62 -rm[-1]
-done -yuv2rgb -v +
append_tiles : -check "isint(${1=0}) && isint(${2=0}) && ${3=0.5}>=0 && $3<=1 && ${4=$3}>=0 && $4<=1"
-if {!@#} -e[0--3] "Append image$? as a 0x0-tiled image." -return -endif
-if {!$1&&!$2}
-v - N={int(sqrt(@#))} M={round(@#/$N,1,1)}
-v + -e[0--3] "Append image$? as a "${M}x${N}"-tiled image (auto-mode)." -v -
MN={$M*$N} -if {@#%$MN} {$MN-(@#%$MN)} -s[-1] x -endif
-elif {!$2}
-v - M=$1 N={round(@#/$1,1,1)}
-v + -e[0--3] "Append image$? as a "${M}x${N}"-tiled image." -v -
-if {$M>@#} -v + -warn[0--3] "Missing images for having one row in a "${M}x${N}"-tiled image." -return -endif
-if {@#%$M} {$M-(@#%$M)} -s[-1] x -endif
-elif {!$1}
-v - M={round(@#/$2,1,1)} N=$2
-v + -e[0--3] "Append image$? as a "${M}x${N}"-tiled image." -v -
-if {$N>@#} -v + -warn[0--3] "Missing images for having one column in a "${M}x${N}"-tiled image." -return -endif
-if {@#%$M} {$M-(@#%$M)} -s[-1] x -endif
-else
-e[0--3] "Append image$?, as $1x$2-tiled images." -v -
M=$1 N=$2
-endif
MN={$M*$N}
-repeat {int(@#/$MN)} -l[$>-{$>+$MN-1}]
$MN,1,1,2 -repeat $MN -point[-1] $>,0,0,1,@{$>,w},@{$>,h} -done -r[-1] $M,$N,1,2,-1
-s[-1] c -l[-2] -s y -max -endl -l[-1] -s x -max -endl
i=0 -repeat $N y=$> -repeat $M -r[$i] @{-2,$>},@{-1,$y},100%,100%,0,0,$3,$4 i={$i+1} -done -done
-rm[-2,-1]
-repeat {int(@#/$M)} -a[$>-{$>+$M-1}] x -done
-repeat {int(@#/$N)} -a[$>-{$>+$N-1}] y -done
-endl -done
-v +
autocrop_components : -skip ${1=0%} -check "${2=0.1%}>=0 && isbool(${3=0}) && isint(${4=1}) && $4>=0 && $4<=2"
-e[^-1] "Autocrop connected components from image$?, with threshold $1, minimal area $2, "@{-arg\ 1+$3,low,high}" connectivity "\
"and output type set to '"@{-arg\ 1+$4,crop,segmentation,coordinates}"'.\n"
-v - -repeat @# -l[$>]
min_area={max(1,round(if(@{-is_percent\ $2},$2*w*h,$2)))}
--channels 100% ->[-1] $1 -area_fg[-1] 0,$3 ->=[-1] $min_area
--area[-1] 0,1 -<[-1] $min_area -or[-2,-1] -label_fg[-1] 0,1
N={iM} -repeat {iM}
n={1+$>}
-v + -e[] "\r  > "$n/$N -v -
-rprogress {100*$n/$N}
--==[1] $n --*[0,-1] -rm[-2]
-if {$4==0} coords=@{-autocrop_coords[-1]\ auto} -rm[-1] --z[0] $coords
-elif {$4==1} -autocrop[-1]
-else coords=@{-autocrop_coords[-1]\ auto} -rm[-1] ($coords) -y[-1]
-endif
-done
-rm[0,1]
-if {!@#} 0 -endif
-if {$4==2} -a x -endif
-endl -done -v +
autocrop_seq : -skip ${1=auto}
-e[^-1] "Auto-crop image$? using crop geometry of last image by vector '$*'."
-if {!@#} -return -endif
-v -
-if {@#==1} -_autocrop$is_auto ${1--1} -v + -return -endif
coords=@{-autocrop_coords[-1]\ ${1--1}}
x0={arg(1,$coords)} y0={arg(2,$coords)} z0={arg(3,$coords)}
x1={arg(4,$coords)} y1={arg(5,$coords)} z1={arg(6,$coords)}
-if {$x0>$x1" || "$y0>$y1" || "$z0>$z1} -i[0--2] 0 -rm[1--1:2]
-else -z $x0,$y0,$z0,$x1,$y1,$z1
-endif
-v +
diagonal :
-e[^-1] "Transform vector$? as diagonal matrix."
-v - -y -repeat @# -r[$>] @{$>,h+1},100%,1,1,0 -r[$>] @{$>,h},100%,1,1,-1 -done -v +
elevate : -check "${1=64}>0" -skip ${2=1},${3=1}
-e[^-1] "Elevate 2d image$? into $1-slices volume(s)."
-v - -r 100%,100%,1,100%
-repeat @# -l[$>] nm=@{0,n}
--norm 100%,100%,$1,{if($3,@{0,s},1)}
m=@{-2,m} d={@{-2,M}-$m}
-repeat $1
-if $2 -->=[1] {$m+$d*($>+1)/$1}
-else --ir[1] {$m+$d*$>/$1},{$m+$d*($>+1)/$1}
-endif
-r[-1] 100%,100%,1,[-2] -if $3 -*[-1] [0] -endif
-j[-2] [-1],0,0,$> -rm[-1]
-done
-rm[0,1] -nm $nm -endl -done -v +
expand_x : -check "$1>=0 && ${2=1}>=0 && $2<=2"
-e[^-1] "Expand image$? along the x-axis with size $1 and border conditions $2."
-v - -repeat @# -r[$>] @{$>,w+2*$1},100%,100%,100%,0,$2,0.5,0.5,0.5 -done -v +
expand_xy : -check "$1>=0 && ${2=1}>=0 && $2<=2"
-e[^-1] "Expand image$? along the xy-axes with size $1 and border conditions $2."
-v - -repeat @# -r[$>] @{$>,w+2*$1},@{$>,h+2*$1},100%,100%,0,$2,0.5,0.5,0.5 -done -v +
expand_xyz : -check "$1>=0 && ${2=1}>=0 && $2<=2"
-e[^-1] "Expand image$? along the xyz-axes with size $1 and border conditions $2."
-v - -repeat @# -r[$>] @{$>,w+2*$1},@{$>,h+2*$1},@{$>,d+2*$1},100%,0,$2,0.5,0.5,0.5 -done -v +
expand_y : -check "$1>=0 && ${2=1}>=0 && $2<=2"
-e[^-1] "Expand image$? along the y-axis with size $1 and border conditions $2."
-v - -repeat @# -r[$>] 100%,@{$>,h+2*$1},100%,100%,0,$2,0.5,0.5,0.5 -done -v +
expand_z : -check "$1>=0 && ${2=1}>=0 && $2<=2"
-e[^-1] "Expand image$? along the z-axis with size $1 and border conditions $2."
-v - -repeat @# -r[$>] 100%,100%,@{$>,d+2*$1},100%,0,$2,0.5,0.5,0.5 -done -v +
montage : -check "isval(${2=2}) && $2>=0 && $2<=3" -skip "${1=X}",${3=0},"${4=}"
-v -
-if {$2<=1} -v + -e[0--3] "Create aligned montage from image$?, with layout code '$1' and centering $2."
-else -v + -e[0--3] "Create scaled montage from image$?, with layout code '$1' and scale "{$2-2}"."
-endif
-v -
-if {{"$1"'=='X}||{"$1"'=='x}} --l
-repeat @# -nm[$>] $> -done
-repeat {@#-1}
-if {@{-2,w>h}" && "w>h} mode=V
-elif {@{-2,h>w}" && "h>w} mode=H
-elif {@{-2,w>h}" && "h>w}
-if {@{-2,h/w}<(w/h)} mode=V -else mode=H -endif
-else
-if {@{-2,w/h}<(h/w)} mode=H -else mode=V -endif
-endif
name=$mode@{-2,n}:@{-1,n}
-montage[-2,-1] $mode,$2
-mv[-1] 0 -nm[0] $name
-done
layout=@{0,n}
-rm -endl -montage $layout,$2,$3,"$4"
-else
N=@#
-l[] _scode="$1" _mode=$2
-if {{"$1"'=='H}||{"$1"'=='h}} -if {$N>1} {$N-1},1,1,1,-1 $N,1,1,1,x -a x -y -else -v + -return -endif
-elif {{"$1"'=='V}||{"$1"'=='v}} -if {$N>1} {$N-1},1,1,1,-2 $N,1,1,1,x -a x -y -else -v + -return -endif
-elif {{"$1"'=='A}||{"$1"'=='a}||{"$1"'=='B}||{"$1"'=='b}}
-if {$N<2} -v + -return -endif
nr={round(sqrt($N))} nc={round($N/$nr,1,1)}
-if {{"$1"'=='B}||{"$1"'=='b}} n=$nr nr=$nc nc=$n -endif
$N,1,1,1,x -s x,-{round(w/$nr,1,1)} -repeat @# -l[$>] -if {w>1} -i[0] {w-1},1,1,1,-1 -a x -endif -endl -done -a x
-if {$nr>1} -i[0] {$nr-1},1,1,1,-2 -a x -endif -y
-else
({'"$1"'}) -f 'if(i==72||i==104,-1,if(i==86||i==118,-2,if(i==82||i==114,-3,if(i==77||i==109,-4,if(i>=48&&i<=57,i-48,-5)))))'
-s +,-1 -s +,-2 -s +,-3 -s +,-4 -s +,-5
-repeat @# -l[$>] -if {im>=0} --+[-1] 48 -=[-2] @{-1,t} -rm[-1] -rows 0 -endif -endl -done -a y -discard -5
-endif
-f 'if(i<0,i,i%$N)'
-endl
-if {@#==$N} -rm -v + -return -endif
-nm[^-1] 0 -repeat {h} c={i[$>]} -if {$c>=0} -if @{$c,n} -i[-2] [$c] i={@#-2} -=[-1] $i,0,$> ref$i=$c -else -nm[$c] 1 ref$c=$c -endif -endif -done
_code=@-1 _lcode={narg($_code)} -rm[-1]
N=@# -repeat $N ($>,0,0,@{$>,w},@{$>,h},0,0,0) -done
-l[$N--1] _p=1 -k[@{-_montage}] w={i[3]} h={i[4]} -f 'if(i(0,y)<0,-1,i)' -discard -1 -r 8,{h/8},1,1,-1 -endl
-if {narg("$4")} -m "__montage : $4 -k[0]"
-else
-m "__montage : -if {$""7%2} -mirror x -endif -if {$""8%2} -mirror y -endif -rotate {90*$""6} -r {max(1,round($""4,1,1))},{max(1,round($""5,1,1))},1,100%,3"
-endif
s=@{-max_s[^-1]}
-repeat {h}
i={i(0,$>)} xi={i(1,$>)} yi={i(2,$>)} wi={i(3,$>)} hi={i(4,$>)} ai={i(5,$>)} mxi={i(6,$>)} myi={i(7,$>)}
-if {$3||!$>} -i[-2] $w,$h,1,$s -endif
-__montage[$i] ${ref$i},$xi,$yi,{max(1,$wi)},{max(1,$hi)},$ai,$mxi,$myi
-j[-2] [$i],$xi,$yi
-done
-uncommand __montage
-rm[0-{$N-1},-1]
-endif
-nm "[Montage '$1']"
-v +
_montage :
-if {$_p>$_lcode} -error "Command '-montage': Incomplete layout code '"$_scode"'." -endif
c={arg($_p,$_code)}
-if {$c>=0} _p={$_p+1} -u $c
-elif {$c==-4}
_p={$_p+1} l=@{-_montage} -f[$l] 'a=i(5,y)%2;if((x==7&&a)||(x==6&&!a),!i,if(x==1,i(3,0)-i(3,y)-i,i))' -u $l
-elif {$c==-3}
_p={$_p+1} l=@{-_montage} -l[$l] -s x -+[2] [4] -rv[1,2] -*[1] -1 -+[1] @{4,0} -rv[3,4] -+[5] 1 -a x -endl -u $l
-else
_p={$_p+1}
l=@{-_montage} lw=@{$l,3} lh=@{$l,4}
r=@{-_montage} rw=@{$r,3} rh=@{$r,4}
-if {$c==-1}
-if {$_mode<2}
h={max($lh,$rh)} -+[$l] '0,0,{($h-$lh)*min(1,$_mode)},0,0,0,0,0' -+[$r] '0,$lw,{($h-$rh)*min(1,$_mode)},0,0,0,0,0'
-else
h={($_mode-2)*max($lh,$rh)+(3-$_mode)*min($lh,$rh)}
lf={$h/$lh} rf={$h/$rh} lw={$lw*$lf} rw={$rw*$rf}
-*[$l] '1,$lf,$lf,$lf,$lf,1,1,1' -*[$r] '1,$rf,$rf,$rf,$rf,1,1,1' -+[$r] '0,$lw,0,0,0,0,0,0'
-endif
-i[$l] (-1,0,0,{$lw+$rw},$h,0,0,0) -a[$l,{$l+1}] y -a[$l] [$r],y -r[$r] 1,1,1,1,0
-else
-if {$_mode<2}
w={max($lw,$rw)} -+[$l] '0,{($w-$lw)*min(1,$_mode)},0,0,0,0,0,0' -+[$r] '0,{($w-$rw)*min(1,$_mode)},$lh,0,0,0,0,0'
-else
w={($_mode-2)*max($lw,$rw)+(3-$_mode)*min($lw,$rw)}
lf={$w/$lw} rf={$w/$rw} lh={$lh*$lf} rh={$rh*$rf}
-*[$l] '1,$lf,$lf,$lf,$lf,1,1,1' -*[$r] '1,$rf,$rf,$rf,$rf,1,1,1' -+[$r] '0,0,$lh,0,0,0,0,0'
-endif
-i[$l] (-1,0,0,$w,{$lh+$rh},0,0,0) -a[$l,{$l+1}] y -a[$l] [$r],y -r[$r] 1,1,1,1,0
-endif
-u $l
-endif
resize_pow2 : -check "isint(${1=0}) && $1>=-1 && $1<=6" -skip ${2=0},${3=0},${4=0},${5=0},${6=0}
-e[^-1] "Resize image$? so that each dimension is a power of 2."
-v - -repeat @#
-r[$>] @{$>,2^(round(log2(w),1,1))},@{$>,2^(round(log2(h),1,1))},@{$>,2^(round(log2(d),1,1))},100%,${1-6}
-done -v +
rr2d :
-v - _gmic_s="$?" -v +
-_resize_ratio2d $*
resize_ratio2d :
-v - _gmic_s="$?" -v +
-_$0 $*
_resize_ratio2d : -check "$1>0 && $2>0 && ${3=0}>=0 && $3<=2 && ${4=6}>=0 && $4<=6"
-e[0--3] "Resize 2d image"$_gmic_s" to $1x$2 with ratio-"@{-arg\ 1+$3,inside,outside,padded}\
" mode and interpolation type $4."
-v - -repeat @#
ratio=@{$>,if($3==1,max($1/w,$2/h),min($1/w,$2/h))}
-r[$>] @{$>,w*$ratio},@{$>,h*$ratio},100%,100%,$4
-done
-if {$3==2} -r $1,$2,100%,100%,0,0,0.5,0.5 -endif
-v +
r2dx :
-v - _gmic_s="$?" -v +
-_resize2dx $*
resize2dx :
-v - _gmic_s="$?" -v +
-_$0 $*
_resize2dx : -check "$1>0 && ${2=3}>=0 && $2<=6 && ${3=0}>=0 && $3<=2 && ${4=0}>=0 && $4<=1 && ${5=0}>=0 && $5<=1 && ${6=0}>=0 && $6<=1 && ${7=0}>=0 && $7<=1"
-e[0--3] "Resize 2d image"$_gmic_s" to $1 pixels along the x-axis, preserving 2d ratio."
-v - -repeat @# -l[$>]
size={if(@{-is_percent\ $1},$1*w,$1)}
-r {max(1,$size)},{max(1,h*$size/w)},100%,100%,${2-7}
-endl -done -v +
r2dy :
-v - _gmic_s="$?" -v +
-_resize2dy $*
resize2dy :
-v - _gmic_s="$?" -v +
-_$0 $*
_resize2dy : -check "$1>=0 && ${2=3}>=0 && $2<=6 && ${3=0}>=0 && $3<=2 && ${4=0}>=0 && $4<=1 && ${5=0}>=0 && $5<=1 && ${6=0}>=0 && $6<=1 && ${7=0}>=0 && $7<=1"
-e[0--3] "Resize 2d image"$_gmic_s" to $1 pixels along the y-axis, preserving 2d ratio."
-v - -repeat @# -l[$>]
size={if(@{-is_percent\ $1},$1*h,$1)}
-r {max(1,w*$size/h)},{max(1,$size)},100%,100%,${2-7}
-endl -done -v +
r3dx :
-v - _gmic_s="$?" -v +
-_resize3dx $*
resize3dx :
-v - _gmic_s="$?" -v +
-_$0 $*
_resize3dx : -check "$1>0 && ${2=3}>=0 && $2<=6 && ${3=0}>=0 && $3<=2 && ${4=0}>=0 && $4<=1 && ${5=0}>=0 && $5<=1 && ${6=0}>=0 && $6<=1 && ${7=0}>=0 && $7<=1"
-e[0--3] "Resize 3d image"$_gmic_s" to $1 pixels along the x-axis, preserving 3d ratio."
-v - -repeat @# -l[$>]
size={if(@{-is_percent\ $1},$1*w,$1)}
-r {max(1,$size)},{max(1,h*$size/w)},{max(1,d*$size/w)},100%,${2-7}
-endl -done -v +
r3dy :
-v - _gmic_s="$?" -v +
-_resize3dy $*
resize3dy :
-v - _gmic_s="$?" -v +
-_$0 $*
_resize3dy : -check "$1>0 && ${2=3}>=0 && $2<=6 && ${3=0}>=0 && $3<=2 && ${4=0}>=0 && $4<=1 && ${5=0}>=0 && $5<=1 && ${6=0}>=0 && $6<=1 && ${7=0}>=0 && $7<=1"
-e[0--3] "Resize 3d image"$_gmic_s" to $1 pixels along the y-axis, preserving 3d ratio."
-v - -repeat @# -l[$>]
size={if(@{-is_percent\ $1},$1*h,$1)}
-r {max(1,w*$size/h)},{max(1,$size)},{max(1,d*$size/h)},100%,${2-7}
-endl -done -v +
r3dz :
-v - _gmic_s="$?" -v +
-_resize3dz $*
resize3dz :
-v - _gmic_s="$?" -v +
-_$0 $*
_resize3dz : -check "$1>0 && ${2=3}>=0 && $2<=6 && ${3=0}>=0 && $3<=2 && ${4=0}>=0 && $4<=1 && ${5=0}>=0 && $5<=1 && ${6=0}>=0 && $6<=1 && ${7=0}>=0 && $7<=1"
-e[0--3] "Resize 3d image"$_gmic_s" to $1 pixels along the z-axis, preserving 3d ratio."
-v - -repeat @# -l[$>]
size={if(@{-is_percent\ $1},$1*d,$1)}
-r[$>] {max(1,w*$size/d)},{max(1,h*$size/d)},{max(1,$size)},100%,${2-7}
-endl -done -v +
rotate_tileable : -check ${2=8}>=0
-e[^-1] "Rotate image$? with angle $1 deg. and make them tileable."
-v -
angle={$1%360}
-if {$angle>=270} -rotate 270 angle={$angle-270}
-elif {$angle>=180} -rotate 180 angle={$angle-180}
-elif {$angle>=90} -rotate 90 angle={$angle-90}
-endif
(0,1;1,8;1,7;1,6;1,5;1,4;1,5;1,3;2,5;1,2;2,5;3,5;2,3;3,4;4,5;1,1;5,4;7,5;3,2;8,5;9,5;2,1;3,1;4,1;5,1;6,1;7,1;8,1)
-s[-1] x,2 --/[-2,-1] -atan[-1] -*[-1] {180/pi}
($angle) -index[-1] [-2] -rm[-2]
p=@{-3,@-1} q=@{-2,@-1} -rm[-3--1]
-if {!$p||!$q} -return -endif
-repeat @# -l[$>]
theta={atan2($p,$q)}
gcd=@{-gcd" "{h*$q},{w*$p}}
pw={h*$q/$gcd}
nw={round($pw*w/cos($theta))}
gcd=@{-gcd" "{h*$p},{w*$q}}
qh={w*$q/$gcd}
nh={round($qh*h/cos($theta))}
-if {!$2" || "($nw<$2*w" && "$nh<$2*h)}
-r {1.5*$nw},{1.5*$nh},1,100%,0,2
-rotate {$theta*180/pi},1,2,50%,50%
-r $nw,$nh,1,100%,0,2,0.5,0.5
-else -v + -error[0--4] "Command '-rotate_tileable': Invalid image dimension "({w},{h},{d},{s}).
-endif
-endl -done -v +
scale2x :
-e[^-1] "Double xy-dimensions of image$?, using Scale2x algorithm."
-v - -repeat @# -l[$>]
-r 200%,200%
-f "dx=x&1;dy=y&1;A=j(0,-2,0,0,0,1);B=j(2,0,0,0,0,1);C=j(-2,0,0,0,0,1);D=j(0,2,0,0,0,1);"\
"!dy*(!dx*if(C==A&&C!=D&&A!=B,A,i) + dx*if(A==B&&A!=C&&B!=D,B,i)) + dy*(dx*if(B==D&&B!=A&&D!=C,D,i) + !dx*if(D==C&&D!=B&&C!=A,C,i))"
-endl -done -v +
scale3x :
-e[^-1] "Triple xy-dimensions of image$?, using Scale3x algorithm."
-v - -repeat @# -l[$>]
-r 300%,300%
-f "dx=x%3;dy=y%3;c0=!dx;c1=(dx==1);c2=(dx==2);"\
"A=j(-3,-3,0,0,0,1);B=j(0,-3,0,0,0,1);C=j(3,-3,0,0,0,1);"\
"D=j(-3,0,0,0,0,1);F=j(3,0,0,0,0,1);"\
"G=j(-3,3,0,0,0,1);H=j(0,3,0,0,0,1);I=j(3,3,0,0,0,1);"\
"!dy*(c0*if(D==B&&D!=H&&B!=F,D,i) + c1*if((D==B&&D!=H&&B!=F&&i!=C)||(B==F&&B!=D&&F!=H&&i!=A),B,i) + c2*if(B==F&&B!=D&&F!=H,F,i)) + "\
"(dy==1)*(c0*if((H==D&&H!=F&&D!=B&&i!=A)||(D==B&&D!=H&&B!=F&&i!=G),D,i) + c1*i + c2*if((B==F&&B!=D&&F!=H&&i!=I)||(F==H&&F!=B&&H!=D&&i!=C),F,i)) + "\
"(dy==2)*(c0*if(H==D&&H!=F&&D!=B,D,i) + c1*if((F==H&&F!=B&&H!=D&&i!=G)||(H==D&&H!=F&&D!=B&&i!=I),H,i) + c2*if(F==H&&F!=B&&H!=D,F,i))"
-endl -done -v +
seamcarve : -check "${2=100%}>=0 && ${5=25%}>=0" -skip ${3=0},${4=1}
-e[^-1] "Resize image$? to $1x$2 using seam-carving algorithm, "@{-arg\ 1+!$3,with,without}" priority channel, "@{-arg\ 1+!$4,with,without}" anti-aliasing and maximum seams $5."
-v - -repeat @# -l[$>]
nw={max(1,round(if(@{-is_percent\ $1},$1*w,$1)))}
nh={max(1,round(if(@{-is_percent\ $2},$2*h,$2)))}
-if {$nw!=w} -_seamcarve $nw,$3,$4,$5 -endif
-if {$nh!=h} -transpose -_seamcarve $nh,$3,$4,$5 -transpose -endif
-endl -done -v +
_seamcarve :
-do
max_seams={max(1,round(if(@{-is_percent\ $4},$4*w,$4)))}
ssms={max(min(round($1-w),w),1-w)}
sms={min($max_seams,abs($ssms))}
-if $2 -s[0] c,{1-s} -/[-1] 256 -endif
--gradient[0] -a[-2,-1] c -abs[-1] -compose_channels[-1] + -n[-1] 0,1
-if $2 -+[-1] [-2] -a[0,1] c -endif
-if $3 100%,1,1,1,x -r[-1] [0],[0] -a[0,-1] c -endif
[-1]
-repeat {h}
--rows[-1] {$<+1} -erode[-1] 3
-j[-2] [-1],0,$<,0,0,-1 -rm[-1]
-done
100%,100% --rows[1] 0
-nm[1] grad -nm[2] low -nm[3] seam -nm[4] top
-repeat @{0,h-1} nr={$>+1}
--rows[low] $nr
--*[4,5] --shift[4] 1 -*[-1] [5] --shift[5] 1 -*[-1] [4]
-+[-2,-1] -j[5] [4] -a[-3--1] c
-f[-1] ">if(c,i,max(j(-1)+j(0,0,0,1),j(-2)+j(0,0,0,2)))"
-s[-1] c -shift[-3] 1 -+[-2] [-3] -shift[-3] 1 -+[-3,-1]
->[-2,-1] -f[-1] "<if(j(1)<0,1,-i)"
-j[seam] [-1],0,$>
-a[-2,-1] c -f[-1] "j(i,0,0,-1)" -channels[-1] 1
--rows[grad] $nr -+[top,-1]
-done
max={iM*2} -repeat $sms -=[-1] $max,@{-1,xm} -done
-j[grad] [-1],0,100% -rm[low,top] -a[-2,-1] c
-f[-1] "<if(c,i,j(j(0,0,0,1),1,0,0,0,1))" -channels[-1] 0
-+[0] 0.1 -!=[-1] $max
w={w} h={h} s=@{0,s}
-if {$ssms<0} -* -discard 0 -r {$w-$sms},$h,1,$s,-1
-elif {$ssms>0}
--[-1] 2 -s[0] c
-repeat $s -if {$><($s-1)} [-1] -endif -a[$>,-1] c -done
-permute cxyz -a c -discard -1 -f "if(i<0,j(0,-1),i)"
-r {$w+$sms},$h,1,$s,-1
-endif
-if $3
-s c,{1-s} -gradient[-1] x,1 -round -!=[-1] 1
(0.5,0.5) --convolve[0] [-1] -rm[-2]
-j[0] [-1],0,0,0,0,1,[1] -rm[-2,-1]
-endif
-rprogress {a=w/$1;if(a<1,a*100,100/a)}
-while {w!=$1}
shrink_x : -check "$1>=0"
-e[^-1] "Shrink image$? along the x-axis with size $1."
-v - -repeat @# -z[$>] $1,@{$>,w-$1-1} -done -v +
shrink_xy : -check "$1>=0"
-e[^-1] "Shrink image$? along the xy-axes with size $1."
-v - -repeat @# -z[$>] $1,$1,@{$>,w-$1-1},@{$>,h-$1-1} -done -v +
shrink_xyz : -check "$1>=0"
-e[^-1] "Shrink image$? along the xyz-axes with size $1."
-v - -repeat @# -z[$>] $1,$1,$1,@{$>,w-$1-1},@{$>,h-$1-1},@{$>,d-$1-1} -done -v +
shrink_y : -check "$1>=0"
-e[^-1] "Shrink image$? along the y-axis with size $1."
-v - -repeat @# -z[$>] 0,$1,100%,@{$>,h-$1-1} -done -v +
shrink_z : -check "$1>=0"
-e[^-1] "Shrink image$? along the z-axis with size $1."
-v - -repeat @# -z[$>] 0,0,$1,100%,100%,@{$>,d-$1-1} -done -v +
split_tiles : -skip ${2=$1},${3=0}
-if $3 -e[^-1] "Split image$? as a $1x$2 array of homogeneous tiles."
-else -e[^-1] "Split image$? as a $1x$2 array of tiles."
-endif
-v - -repeat @# -l[$<] -s y,$2 -s x,$1 -if $3 -r [0],[0],100%,100%,0 -endif -endl -done -v +
upscale_smart : -skip ${2=100%},${3=100%} -check "${4=2}>=0 && ${5=0.4}>=0 && $5<=1 && ${6=10}>=0"
-e[^-1] "Upscale image$? to $1x$2x$3, with smoothness $4, anisotropy $5 and sharpening $6."
-v - -repeat @# -l[$>]
w={w} h={h}
--r[-1] $1,$2,$3,1,0
-if {w<$w" && "h<$h}
-rm[-1] -r[-1] $1,$2,$3,100%,2
-else
-rm[-1] --diffusiontensors 0,$5,1.2,1.2
-r[-2,-1] $1,$2,$3,100%,5
-smooth[-2] [-1],$4 -rm[-1]
-ac "-sharpen[-1] $6,10",ycbcr_y
-endif
-endl -done -v +
bandpass : -skip ${1=0},${2=20%}
-e[^-1] "Apply bandpass filter [$1,$2] to image$?."
-v - -repeat @# -l[$>]
100%,100%,100% -f[-1] "sqrt((x/w-0.5)^2 + (y/h-0.5)^2 + (z/d-0.5)^2)"
-n[-1] 0,1 -ir[-1] $1,$2 -shift[-1] {int(w/2)},{int(h/2)},50%,0,2
-fft[-2] -*[-3] [-1] -*[-2,-1] -ifft -rm[-1]
-endl -done -v +
blur_angular : -skip ${2=50%},${3=50%}
-e[^-1] "Apply angular blur on image$?, with amplitude $1 and center point ($2,$3)."
-v - -euclidean2polar $2,$3,1.3,1 -expand_y 16,2 -blur_y $1 -shrink_y 16 -polar2euclidean $2,$3,1.3,1 -v +
blur_linear : -skip ${2=0},${3=0},${4=1}
-e[^-1] "Apply linear blur on image$?, with angle $3 deg. and amplitudes ($1,$2)."
-v -
std1={if(@{-is_percent\ $1},$1*max(w,h),$1)}
std2={if(@{-is_percent\ $2},$2*max(w,h),$2)}
stdM={round(1.25*max($std1,$std2))}
-if {$stdM<=0} -return -endif
-repeat @# -l[$>]
-expand_xy $stdM,{$4!=0}
{2*$stdM},{2*$stdM} -gaussian[-1] $1,$2,$3 -normalize_sum[-1]
-convolve_fft[0] [1] -rm[-1] -shrink_xy $stdM
-endl -done -v +
blur_radial : -skip ${2=50%},${3=50%}
-e[^-1] "Apply radial blur on image$?, with amplitude $1 and center point ($2,$3)."
-v - -euclidean2polar $2,$3,5,1 -blur_x $1 -polar2euclidean $2,$3,5,1 -v +
blur_selective : -check "${1=5}>=0 && ${2=0.5}>=0 && isint(${3=5}) && $3>0"
-e[^-1] "Blur image$? using $3 selective gaussian scales, with sigma $1 and edges $2."
-v - -repeat @# -l[$>] nm=@{0,n}
--gradient_norm -+[-1] 1 -^[-1] {-max(0.01,$2)} -quantize[-1] {$3+1},0,1 -min[-1] {$3-1} -r[-1] [-2] -/[-1] 100
-repeat $3 --==[-1] {$>/100} -*[-1] [-3] -+[-2,-1] -b[-2] {$1/($3+1)} -done
-rm[-2] -nm $nm -endl -done -v +
blur_x : -skip ${2=1}
-e[^-1] "Blur image$? along the x-axis, with sigma $1 and "@{-arg\ 1+!$2,neumann,dirichlet}" boundary conditions."
-v - -deriche $1,0,x,$2 -v +
blur_xy : -skip ${2=$1},${3=1}
-e[^-1] "Blur image$? along the xy-axes, with sigma $1 and "@{-arg\ 1+!$2,neumann,dirichlet}" boundary conditions."
-v - -deriche $1,0,x,$3 -deriche $2,0,y,$3 -v +
blur_xyz : -skip ${4=1}
-e[^-1] "Blur image$? along the xyz-axes, with sigma $1 and "@{-arg\ 1+!$2,neumann,dirichlet}" boundary conditions."
-v - -deriche $1,0,x,$4 -deriche $2,0,y,$4 -deriche $3,0,z,$4 -v +
blur_y : -skip ${2=1}
-e[^-1] "Blur image$? along the y-axis, with sigma $1 and "@{-arg\ 1+!$2,neumann,dirichlet}" boundary conditions."
-v - -deriche $1,0,y,$2 -v +
blur_z : -skip ${2=1}
-e[^-1] "Blur image$? along the z-axis, with sigma $1 and "@{-arg\ 1+!$2,neumann,dirichlet}" boundary conditions."
-v - -deriche $1,0,z,$2 -v +
bokeh : -check "${1=200}>=0 && ${2=2}>=0 && ${3=0.2}>=0 && $3<=100 && ${4=24}>0 && ${5=10}>=0 && $5<=100 && ${6=2}>=0 && ${7=1}>=0 && ${8=0.1}>=0"
-e[^-1] "Apply bokeh effect to image$?, with amplitude $1, smoothness $2, density $3%, bokeh size $4, bokeh outline size $5 "\
"bokeh outline amplitude $6 and bokeh smoothness $7."
-v -
256,256 -=[-1] 1,50%,50% -distance[-1] 1
--<[-1] 70% -ir[-2] 70%,{70-$5*70/100}% -*[-2] $6 -+[-2,-1] -r[-1] $4,$4,1,1,2
-expand_xy[-1] {3*$7},0 -b[-1] $7,0 -->[-1] 0.1 -*[-2,-1] -autocrop[-1]
-normalize_sum[-1]
-repeat {@#-1} -l[$>,-1]
--remove_pixels[0] {100-$3}% -convolve[-1] [-2],0 -n[-1] 0,$1
-b[0] $2 -+[0,-1] -c[0] 0,255
-endl -done -rm[-1]
-v +
compose_freq :
-e[^-1] "Compose low and high frequency part$? into new images."
-v - -repeat {int(@#/2)} -+[$>,{$>+1}] -done -v +
convolve_fft : -check @{-is_image_arg\ $1}
-e[^-1] "Convolve image$? with mask $1, in the fourier domain."
-v - -repeat @# -pass$1 0 -l[$>,-1]
w2={int(@{0,w}/2)} h2={int(@{0,h}/2)} d2={int(@{0,d}/2)}
-r[1] [0],[0],[0],1,0,0,0.5,0.5,0.5,0.5 -shift[1] -$w2,-$h2,-$d2,0,2
-fft[0] -fft[2]
--*[-4] [-1] --*[-4] [-3] -+[-2,-1]
-*[-5,-3] -*[-3,-2] --[-3,-2]
-ifft -rm[-1]
-endl -done -v +
cross_correlation : -check @{-is_image_arg\ $1}
-e[^-1] "Compute cross-correlation of image$? with mask $1."
-v - -repeat @# -pass$1 0 -l[$>,-1]
-norm -fft[-2] -fft[-1] [-2,-1] -*[-2] [-5] -*[-1] [-6]
--[-2,-1] -*[-5,-3] -*[-3,-2] -+[-3,-2] -ifft -rm[-1]
-endl -done -v +
curvature :
-e[^-1] "Compute isophote curvatures on image$?."
-v - -repeat @# -l[$>]
-if {d==1}
--g xy,0 -hessian[-3] xxxyyy
-*[-3] [-2] -*[-4] [-1] -*[-4] -2
-+[-4,-3] -*[-3] [-2]
-sqr[-2,-1] -*[-4] [-1] -+[-4,-3]
-+[-2,-1] -+[-1] 0.1 -^[-1] 1.5 -/
-else
--inn --gradient_norm[-2] -laplacian[-3]
--[-3,-2] -+[-1] 0.1 -/[-2,-1]
--inn[-1] -laplacian[-2] --
-endif
-endl -done -v +
dct : -skip ${1=0}
-v - ({'"$1"'})
is_axes={im>={'x'}&&iM<={'z'}}
-if $is_axes
-v + -e[0--3] "Compute discrete cosine transform of image$? along axes '$1'." -v -
-repeat {w}
axis={i[$>]}
-if {$axis=={'x'}} -repeat {@#-1} -l[$>] -if {w>1} -_dct -endif -endl -done
-elif {$axis=={'y'}} -repeat {@#-1} -l[$>] -if {h>1} -permute yxzc -_dct -permute yxzc -endif -endl -done
-elif {$axis=={'z'}} -repeat {@#-1} -l[$>] -if {d>1} -permute zxyc -_dct -permute yzxc -endif -endl -done
-endif
-done
-else
-rm[-1]
-v + -e[0--3] "Compute discrete cosine transform of image$?." -v -
-noarg
-repeat @# -l[$>]
-if {w>1} -_dct -endif
-if {h>1} -permute yxzc -_dct -permute yxzc -endif
-if {d>1} -permute zxyc -_dct -permute yzxc -endif
-endl -done
-endif
-v +
_dct :
is_odd={w%2}
-if $is_odd -r {w+1},100%,100%,100%,0,1 -endif
-s x -l[1--1:2] -a x -mirror x -endl -mv[1] @# -a x
-fft x
100%,1,1,1,2*cos(-x*pi/(2*w)) -*[0,2]
100%,1,1,1,2*sin(-x*pi/(2*w)) -*[1,2]
--
-if $is_odd -r {w-1},100%,100%,100%,0 -endif
--z[0] 0,0 -/[-1] {sqrt(2)} -j[-2] [-1],0,0,0 -rm[-1] -* {sqrt(2/w)}
deblur : -check "${2=10}>=0 && ${3=20}>=0 && ${4=0.7}>=0" -skip ${5=1}
-e[^-1] "Deblur image$? with a regularized Jansson-Van Cittert algorithm, with sigma $1, $2 iterations, time step $3 and regularization $4." -v -
-repeat @# -l[$>] nm=@{0,n}
[0]
-repeat $2
-if {$5>=2} --curvature[-1]
-elif {$5>=1} --iee[-1]
-else --laplacian[-1]
-endif
-*[-1] $4
--b[-2] $1 --[-1] [-4]
--[-2,-1]
-*[-1] {$3/(0.0001+max(abs(@{-1,m}),abs(@{-1,M})))}
-+[-2,-1]
-done
-rm[-2]
-nm $nm -endl -done -v +
deblur_goldmeinel : -check "$1>=0 && ${2=8}>=0 && ${3=1}>=0" -skip ${4=1}
-e[^-1] "Deblur image$? using Gold-Meinel algorithm, with sigma $1, $2 iterations, acceleration $3 and "@{-arg\ 1+!$4,"",quasi-}"gaussian kernel."
-v - -repeat @# -l[$>]
[0] -repeat $2
--b[-1] $1,1,$4 --/[0,-1] -rm[-2] -^[-1] $3 -*[-1,-2]
-done -rm[0]
-endl -done -v +
deblur_richardsonlucy : -check "$1>=0 && ${2=50}>=0" -skip ${3=1}
-e[^-1] "Deblur image$? using Richardson-Lucy algorithm, with sigma $1, $2 iterations and "@{-arg\ 1+!$3,"",quasi-}"gaussian kernel."
-v - -repeat @# -l[$>]
[0] -repeat $2
--b[-1] $1,1,{$3!=0} -max[-1] 1e-6 --/[0,-1] -rm[-2] -b[-1] $1,1,{$3!=0} -*[-1,-2]
-done -rm[0]
-endl -done -v +
deconvolve_fft : -check @{-is_image_arg\ $1}" && ${2=.001}>=0"
-e[^-1] "Deconvolve image$? with mask $1 and regularization $2, in the fourier domain."
-v - -repeat @# -pass$1 0 -l[$>,-1]
w2={int(@{0,w}/2)} h2={int(@{0,h}/2)} d2={int(@{0,d}/2)}
-r[1] [0],[0],[0],1,0,0,0.5,0.5,0.5,0.5 -shift[1] -$w2,-$h2,-$d2,0,2
-fft[0] -fft[2]
--l[-1,-2] -sqr -+ -+ $2 -endl
--*[-4] [-3]
--*[-6] [-3]
--[-2,-1]
-*[-6,-4]
-*[-4,-3]
-+[-4,-3]
-/[-1] [-2] -/[-3,-2]
-ifft -rm[-1]
-endl -done -v +
deinterlace : -skip ${1=0}
-e[^-1] "Deinterlace image$? with "@{-arg\ 1+!$1,motion-compensated,standard}" method."
-v - -repeat @# -l[$>]
wh={w},{h}
-s y -a[0--1:2] y -a[^0] y -r[-2] [-1],0 -r 100%,200%,1,100%,5
-if {$1!=0} --displacement[-1] [-2],0.05 -warp[-3] [-1],1,1,1 -rm[-1] -endif
-+ -/ 2 -c 0,255 -r $wh
-endl -done -v +
denoise_haar : -check "${1=1.4}>=0 && isint(${2=0}) && $2>=0 && isint(${3=10}) && $3>0"
-e[^-1] "Denoise image$? using haar-wavelet thresholding, with threshold $1, "\
@{-arg\ 1+($2>0),auto,$2}" scales and $3 spinning cycles."
-v - -repeat @# -l[$>] nm=@{0,n}
nb_scales={min(if($2,$2,32),int(log2(min(w,h))-1))}
w={w} h={h} d={d} sigma=@{-std_noise}
-r {round(w,2^($nb_scales+1),1)},{round(h,2^($nb_scales+1),1)},{if(d==1,1,round(d,2^($nb_scales+1),1))},100%,0,0
--f 0
-repeat $3
dx={round(?(0,{4*$nb_scales}))}
dy={round(?(0,{4*$nb_scales}))}
dz={if($d==1,0,round(?(0,{4*$nb_scales})))}
--shift[0] $dx,$dy,$dz,0,2
-haar[-1] $nb_scales
-threshold[-1] {$1*$sigma},1
-ihaar[-1] $nb_scales
-shift[-1] {-$dx},{-$dy},{-$dz},0,2
-+[-2,-1]
-done
-rm[0] -/ $3 -r $w,$h,$d,100%,0
-nm $nm -endl -done -v +
dilate_circ : -check $1>=0 -skip ${2=1},${3=0}
-e[^-1] "Apply circular dilation of image$? by size $1, boundary $2 and is_normalized $3."
-if {$1<2} -return -endif
-v - -_dt_circle[] $1 -dilate[^-1] [-1],$2,$3 -rm[-1] -v +
dilate_oct : -check $1>=0 -skip ${2=1},${3=0}
-e[^-1] "Apply octagonal dilation of image$? by size $1, boundary $2 and is_normalized $3."
-v -
-if {$1<2} -return -endif
-if {$1&1} ss={$1} -else ss={$1+1} -endif
-i[0] (0,1,0;1,1,1;0,1,0) -i[1] (1,1,1;1,1,1;1,1,1)
-repeat {@#-2}
r={round(($ss-1)*sqrt(2)/(1+sqrt(2))/2)}
q={round(($ss-1)/(1+sqrt(2))/2)}
-if {$r>0} -repeat $r -dilate[-1] [0],$2,$3 -done -endif
-if {$q>0} -repeat $q -dilate[-1] [1],$2,$3 -done -endif
-mv[-1] 2 -done -rm[0,1] -v +
_kr_circle :
-if {$1%2==0} -i 2,2,1,1,1 -else -i 1,1,1,1,1 -endif -r[-1] $1,$1,1,1,0,0,0.5,0.5
-distance[-1] 1 -round[-1] 0.5 -ir[-1] 0,{$1/2}
_jf_circle :
{round($1)},{round($1)}
center={0.5*(w-1)}
-f[-1] 'sqrt((x-$center)^2+(y-$center)^2)'
-if {!(w%2)}
-round[-1] 0.0001,-1
t1={sqrt(((round($1)-1)/2)^2+0.25)}
t2={sqrt(((round($1)+1)/2)^2+0.25)}
k={$1-round($1)+0.5}
t={$t1+($t2-$t1)*$k}
-ir[-1] 0,$t
-else -ir[-1] 0,{$1/2-0.25}
-endif
_dt_circle :
ir={round($1)}
-if {!$ir} 1,1
-elif {$ir<2} $ir,$ir,1,1,1
-else
{int($ir/2)+($ir%2)},{int($ir/2)+($ir%2)} -=[-1] 1,100%,100%
-distance[-1] 1 -<=[-1] {(i+0.4)/sqrt(2)}
--mirror[-1] x
-if {$ir>1&&($ir%2)} -r[-1] {w-1},100%,1,1,0,0,1 -endif
-a[-2,-1] x --mirror[-1] y
-if {$ir>1&&($ir%2)} -r[-1] 100%,{h-1},1,1,0,0,0,1 -endif
-a[-2,-1] y
-endif
_dt_diamond :
ir={round($1)}
-if {$ir<2} $ir,$ir,1,1,1
-else
{int($ir/2)+($ir%2)},{int($ir/2)+($ir%2)} -=[-1] 1,100%,100%
-distance[-1] 1,1 -<=[-1] {i/2}
--mirror[-1] x
-if {$ir>1&&($ir%2)} -r[-1] {w-1},100%,1,1,0,0,1 -endif
-a[-2,-1] x --mirror[-1] y
-if {$ir>1&&($ir%2)} -r[-1] 100%,{h-1},1,1,0,0,0,1 -endif
-a[-2,-1] y
-endif
dilate_threshold : -check "isint($1) && $1>=1 && isint(${2=$1}) && $2>=1 && isint(${3=1}) && $3>=1 && ${4=255}>=0 && isint(${5=1}) && $5>=0"
-e[^-1] "Erode image$? with mask $1x$2x$3, threshold $4 and "@{-arg\ $5,dirichlet,neumann}" boundary conditions."
-v - -l[]
dx1={int($1/2)} dx2={$1-$dx1-1}
dy1={int($2/2)} dy2={$2-$dy1-1}
dz1={int($3/2)} dz2={$3-$dz1-1}
(-$dx1,$dx1) (-$dy1;$dy1) (-$dz1/$dz1) -r $1,$2,$3,1,3 -a c -round -r {w*h*d},3,1,1,-1 -transpose[-1]
-i[-2] 1,100%,1,1,254 1,100%,1,1,255 -a x
({'@-1'}) -rm[-2] -replace_str "254,","(v=j(" -replace_str ",255",",0,0,$5);if(abs(v-i)<=$4,v,-1e20))" list=@{-1,t}
-rm
-endl
-f 'max($list)'
-v +
divergence :
-e[^-1] "Compute divergence of vector field$?."
-v - -repeat @# -l[$>]
-if {s==1} -g x,0
-elif {s==2} -s c -g[-2] x,0 -g[-1] y,0 -+
-elif {s==3} -s c -g[-3] x,0 -g[-2] y,0 -g[-1] z,0 -+
-else -error[] "Command '-divergence': Cannot compute divergence of image ["$>"] (has "{s}">3 channels)."
-endif
-endl -done -v +
dog : -check "${1=2%}>=0 && ${2=3%}>=0"
-e[^-1] "Compute difference of gaussian on image$?, with standard deviations $1 and $2."
-v - -repeat @# -l[$>]
[0] -parallel "-b[0] $1","-b[1] $2" -- -norm
-endl -done -v +
diffusiontensors : -check "${1=0.7}>=0 && ${2=0.3}>=0 && $2<=1" -skip ${3=0.6},${4=1.1},${5=0}
-e[^-1] "Compute diffusion tensors for image$?, with sharpness $1, anisotropy $2, alpha $3 and sigma $4."
-v -
p1={if($5,0.5,1)*max($1,1e-5)}
p2={$p1/(1e-7+1-$2)}
-b $3 -n 0,255 -structuretensors 2 -b $4
-repeat @# -l[$>]
-eigen -max[-2] 0
-if {s==2} -s[-2] c -+[-3,-2] -+[-2] 1 --^[-2] -$p1 -^[-3] -$p2 -a[-3,-1] c
-else -s[-2] c -+[-4--2] -+[-2] 1 --^[-2] -$p1 -r[-1] 100%,100%,100%,2 -^[-3] -$p2 -a[-3,-1] c
-endif
-eigen2tensor
-endl -done -v +
edges : -skip ${1=15%}
-e[^-1] "Estimate image contours of image$?, with threshold $1."
-v - -gradient_norm -b 0.5 ->= $1 -distance 0 -equalize -negative -c 30%,70% -n 0,1 -v +
erode_circ : -check $1>=0 -skip ${2=1},${3=0}
-e[^-1] "Apply circular erosion of image$? by size $1, boundary $2 and is_normalized $3."
-if {$1<2} -return -endif
-v - -_dt_circle[] $1 -erode[^-1] [-1],$2,$3 -rm[-1] -v +
erode_oct : -check $1>=0 -skip ${2=1},${3=0}
-e[^-1] "Apply octagonal erosion of image$? by size $1, boundary $2 and is_normalized $3."
-v -
-if {$1<2} -return -endif
-if {$1&1} ss={$1} -else ss={$1+1} -endif
-i[0] (0,1,0;1,1,1;0,1,0) -i[1] (1,1,1;1,1,1;1,1,1)
-repeat {@#-2}
r={round(($ss-1)*sqrt(2)/(1+sqrt(2))/2)}
q={round(($ss-1)/(1+sqrt(2))/2)}
-if {$r>0} -repeat $r -erode[-1] [0],$2,$3 -done -endif
-if {$q>0} -repeat $q -erode[-1] [1],$2,$3 -done -endif
-mv[-1] 2 -done -rm[0,1] -v +
erode_threshold : -check "isint($1) && $1>=1 && isint(${2=$1}) && $2>=1 && isint(${3=1}) && $3>=1 && ${4=255}>=0 && isint(${5=1}) && $5>=0"
-e[^-1] "Erode image$? with mask $1x$2x$3, threshold $4 and "@{-arg\ $5,dirichlet,neumann}" boundary conditions."
-v - -l[]
dx1={int($1/2)} dx2={$1-$dx1-1}
dy1={int($2/2)} dy2={$2-$dy1-1}
dz1={int($3/2)} dz2={$3-$dz1-1}
(-$dx1,$dx1) (-$dy1;$dy1) (-$dz1/$dz1) -r $1,$2,$3,1,3 -a c -round -r {w*h*d},3,1,1,-1 -transpose[-1]
-i[-2] 1,100%,1,1,254 1,100%,1,1,255 -a x
({'@-1'}) -rm[-2] -replace_str "254,","(v=j(" -replace_str ",255",",0,0,$5);if(abs(v-i)<=$4,v,1e20))" list=@{-1,t}
-rm
-endl
-f 'min($list)'
-v +
gradient_norm :
-e[^-1] "Compute gradient norm of image$?."
-v - -repeat @# -l[$>]
--g x -sqr[-1]
--g[-2] y -sqr[-1] -+[-2,-1]
-g[-2] z -sqr[-2] -+[-2,-1]
s={s} -s[-1] c -+[-$s--1] -sqrt[-1]
-endl -done -v +
gradient_orientation : -check "${1=3}==1 || $1==2 || $1==3"
-e[^-1] "Compute $1-d gradient orientation of image$?."
-v - -repeat @# -l[$<]
-if {$1==1} -g x --abs[-1] -+[-1] 1e-8 -/
-elif {$1==2} -g xy --sqr -+[-2,-1] -+[-1] 1e-8 -sqrt[-1] -/[-3] [-1] -/[-2,-1]
-else -g xyz --sqr -+[-3--1] -+[-1] 1e-8 -sqrt[-1] -/[-4,-3] [-1] -/[-2,-1]
-endif
-endl -done -v +
haar : -check "isint(${1=1}) && $1>=0"
-e[^-1] "Compute haar transform of image$? with $1 scales."
-v - -repeat @# -l[$>]
-_haar
-repeat {$1-1}
w={max(0,round(w/2^(1+$>))-1)}
h={max(0,round(h/2^(1+$>))-1)}
d={max(0,round(d/2^(1+$>))-1)}
--z 0,0,0,$w,$h,$d -_haar[-1] -j[-2] [-1] -rm[-1]
-done
-endl -done -v +
_haar :
-_haar_x -_haar_y -_haar_z
_haar_x :
-if {w<=1} -return -endif
-if {w%2} -error[0--6] "Command '-haar': Invalid image width="{w}" (is not even)." -endif
--shift -1 -r 50% ---[1] [0] -+[0,1] -/ {sqrt(2)} -a x
_haar_y :
-if {h<=1} -return -endif
-if {h%2} -error[0--6] "Command '-haar': Invalid image height="{h}" (is not even)." -endif
--shift 0,-1 -r 100%,50% ---[1] [0] -+[0,1] -/ {sqrt(2)} -a y
_haar_z :
-if {d<=1} -return -endif
-if {d%2} -error[0--6] "Command '-haar': Invalid image depth="{h}" (is not even)." -endif
--shift 0,0,-1 -r 100%,100%,50% ---[1] [0] -+[0,1] -/ {sqrt(2)} -a z
heat_flow : -skip ${1=10},${2=30},${3=0}
-e[^-1] "Apply $1 iterations of the heat flow on image$?, with time step $2."
-v - -pde_flow $1,$2,laplacian,$3 -v +
idct : -skip ${1=0}
-v - ({'"$1"'})
is_axes={im>={'x'}&&iM<={'z'}}
-if $is_axes
-v + -e[0--3] "Compute inverse discrete cosine transform of image$? along axes '$1'." -v -
-repeat {w}
axis={i[$>]}
-if {$axis=={'x'}} -repeat {@#-1} -l[$>] -if {w>1} -_idct -endif -endl -done
-elif {$axis=={'y'}} -repeat {@#-1} -l[$>] -if {h>1} -permute yxzc -_idct -permute yxzc -endif -endl -done
-elif {$axis=={'z'}} -repeat {@#-1} -l[$>] -if {d>1} -permute zxyc -_idct -permute yzxc -endif -endl -done
-endif
-done
-else
-rm[-1]
-v + -e[0--3] "Compute inverse discrete cosine transform of image$?." -v -
-noarg
-repeat @# -l[$>]
-if {w>1} -_idct -endif
-if {h>1} -permute yxzc -_idct -permute yxzc -endif
-if {d>1} -permute zxyc -_idct -permute yzxc -endif
-endl -done
-endif
-v +
_idct :
is_odd={w%2}
-/ {sqrt(2/w)} --z[0] 0,0 -*[-1] {sqrt(2)} -j[-2] [-1],0,0,0 -rm[-1]
-if $is_odd -r {w+1},100%,100%,100%,0,0 -endif
--mirror x -shift[-1] 1 -*[-1] -1
100%,1,1,1,cos(x*pi/(2*w))
100%,1,1,1,sin(x*pi/(2*w))
--*[0,3] --*[1,2] -+[-2,-1]
-*[0,2] -*[1,2] --[0,1]
-ifft x -k[0] -/ 2
-s x,2 -mirror[-1] x
-r[0] 200%,100%,1,100%,4,0,0
-r[1] 200%,100%,1,100%,4,0,1
-+
-if $is_odd -r {w-1},100%,100%,100%,0 -endif
iee :
-e[^-1] "Compute gradient-orthogonal-directed 2nd derivative of image$?."
-v - -repeat @# -l[$>]
-if {d==1}
--g xy,0 -hessian[-3] xxxyyy
-*[-3] [-2] -*[-4] [-1] -*[-4] -2
-+[-4,-3] -*[-3] [-2]
-sqr[-2,-1] -*[-4] [-1] -+[-4,-3]
-+[-2,-1] -+[-1] 1e-8 -/
-else
--inn -laplacian[-2] --
-endif
-endl -done -v +
ihaar : -check "isint(${1=1}) && $1>=0"
-e[^-1] "Compute inverse haar transform of image$? with $1 scales."
-v - -repeat @# -l[$>]
-repeat {$1-1}
w={max(0,round(w/2^(1+$<))-1)}
h={max(0,round(h/2^(1+$<))-1)}
d={max(0,round(d/2^(1+$<))-1)}
--z 0,0,0,$w,$h,$d -_ihaar[-1] -j[-2] [-1] -rm[-1]
-done
-_ihaar
-endl -done -v +
_ihaar :
-_ihaar_x -_ihaar_y -_ihaar_z
_ihaar_x :
-if {w<=1} -return -endif
-if {w%2} -error[0--6] "Command '-ihaar': Invalid image width="{w}" (is not even)." -endif
-s x,2 -r 200% (-1,1) -*[-2,-1] -+ -/ {sqrt(2)}
_ihaar_y :
-if {h<=1} -return -endif
-if {h%2} -error "Command '-ihaar': Invalid image height="{h}" (is not even)." -endif
-s y,2 -r 100%,200% (-1;1) -r[-1] @{-2,w} -*[-2,-1] -+ -/ {sqrt(2)}
_ihaar_z :
-if {d<=1} -return -endif
-if {d%2} -error "Command '-ihaar': Invalid image depth="{h}" (is not even)." -endif
-s z,2 -r 100%,100%,200% (-1/1) -r[-1] @{-2,w},@{-2,h} -*[-2,-1] -+ -/ {sqrt(2)}
inn :
-e[^-1] "Compute gradient-directed 2nd derivative of image$?."
-v - -repeat @# -l[$>]
-if {d==1}
--g xy,0 -hessian[-3] xxxyyy
-*[-5] [-2] -*[-4] [-1] -*[-4] 2
-+[-5,-4] -*[-4] [-2]
-sqr[-2,-1] -*[-3] [-1] -+[-4,-3]
-+[-2,-1] -+[-1] 1e-8 -/
-else
--g xyz,0 -hessian[-4] xxxyxzyyyzzz
-*[-9] [-3] -*[-8] [-2] -*[-8] 2 -*[-7] [-1] -*[-7] 2
-+[-9--7] -*[-7] [-3]
-*[-6] [-2] -*[-5] [-1] -*[-5] 2
-+[-6,-5] -*[-5] [-2] -+[-6,-5]
-sqr[-3--1] -*[-4] [-1] -+[-5,-4]
-+[-3--1] -+[-1] 1e-8 -/
-endif
-endl -done -v +
inpaint_flow : -skip ${1=4},${2=15},${3=15},${4=1},${5=3}
-e[^-1] "Apply $1 iteration of the inpainting flow on image$?."
-v - -norm[0] -quantize[0] 2,1,1 -n[0] 0,1
-repeat @# -if $> -l[0,$>]
-r[0] [1] -inpaint[1] [0]
-repeat $1 --diffusiontensors[1] 0,1,$4,$5,0 -*[2] [0] -smooth[1] [2],$2,$3,0 -rm[2] -done
-endl -endif -done -v +
inpaint_holes : -check "${1=4}>=0 && ${2=0}>=0" -skip ${3=0}
-e[^-1] "Inpaint holes wih area less than $1 pixels in image$?, with tolerance $2 and "@{-arg\ 1+!$3,high,low}" connectivity."
-v - -repeat @# -l[$>]
100%,100%,100%
area={if(@{-is_percent\ $1},$1*w*h*d,$1)}
-repeat @{0,s} -sh[0] $>,$> --area[-1] $2,$3 -<=[-1] $1 -or[1,-1] -rm[-1] -done
-if {im} -k[0] whd={w},{h},{d} -r 1,1,1,100%,2 -r $whd,100%
-else -inpaint[0] [1],0,{2*!$2+!!$3} -k[0] -endif
-endl -done -v +
kuwahara : -check $1>0
-e[^-1] "Apply Kuwahara filter of size $1 on image$?."
-v - -repeat @# -l[$>]
s={s}
--dilate $1 -compose_channels[-1] min
--erode[0] $1 -compose_channels[-1] max
--[-2,-1]
$1,1,1,1,{1/$1} -convolve[0] [-1] -transpose[-1] -convolve[0] [-1] -rm[-1]
p={int($1/2)}
-a[-2,-1] c
-f "v1=i(x-"$p",y-"$p",0,"$s",0,1); \
v2=i(x+"$p",y-"$p",0,"$s",0,1); \
v3=i(x-"$p",y+"$p",0,"$s",0,1); \
v4=i(x+"$p",y+"$p",0,"$s",0,1); \
vm=min(v1,v2,v3,v4); \
if(c>="$s",i, \
if(vm==v1,i(x-"$p",y-"$p",0,c,0,1),
if(vm==v2,i(x+"$p",y-"$p",0,c,0,1),
if(vm==v3,i(x-"$p",y+"$p",0,c,0,1),
i(x+"$p",y+"$p",0,c,0,1)))))"
-channels 0,{s-2}
-endl -done -v +
laplacian :
-e[^-1] "Compute Laplacian of image $?."
-v - -repeat @# -l[$>]
-hessian @{-arg\ 1+(d==1),xxyyzz,xxyy} -+
-endl -done -v +
lic : -skip ${1=30},${2=1}
-e[^-1] "Render LIC representation of 2d vector field$?, with amplitude $1 and $2 channel(s)."
-v - -repeat @# -l[$>] nm=@{0,n}
-channels 0,1 -/ {max(abs(@{-1,m}),abs(@{-1,M}))} -vector2tensor
100%,100%,100%,$2 -rand[-1] 0,255 -smooth[-1] [-2],$1 -rm[-2]
-equalize
-nm $nm -endl -done -v +
map_tones : -skip ${1=0.1},${2=0.8},${3=0.5},${4=30}
-e[^-1] "Apply tone mapping operator on image$?, with threshold $1, gamma $2, smoothness $3 and $4 iterations."
-v - -repeat @# -l[$>]
--l -s c -repeat @# -l[$>]
-g xy,1 -a c --norm -orientation[-2]
m={im} M={iM} -b[-1] $3 -n[-1] $m,$M
-*[-1] 'alpha=$1*iM;(alpha/(1e-10+i))*(i/(1e-10+alpha))^$2'
-* -s c -g[-2] x,-1 -g[-1] y,-1 -+
-endl -done -a c -* 0.25 -endl
-repeat $4 --laplacian[-2] -*[-1] 0.25 -+[-1] [-3] --[-1] [-2] -*[-1] 800 -+[-3,-1] -/[-2] 801 -c[-2] 0,255 -done -rm[-1]
-endl -done  -v +
map_tones_fast : -check "${1=3%}>=0 && ${2=0.3}>=0"
-e[^-1] "Apply fast tone mapping operator on image$?, with radius $1 and power $2."
-v - -repeat @# -l[$>]
--luminance -b[-1] $1 -n 0,1
--*[-1] 2 --[-1] 1 -abs[-1] -*[-1] {$2*log(10)} -exp[-1]
-<=[-2] 0.5 -r[-1] [-3]
--*[-3] -1 -+[-1] 1 -^[-1] [-2] -*[-1] -1 -+[-1] 1 -*[-1] [-3]
-^[-4,-2] -==[-2] 0 -*[-3,-2] -+
-endl -done -n 0,255 -v +
meancurvature_flow : -skip ${1=10},${2=30},${3=0}
-e[^-1] "Apply $1 iterations of the mean curvature flow on image$?, with time step $2."
-v - -pde_flow $1,$2,iee,$3 -v +
nlmeans: -check "${1=4}>0 && ${2=4}>0 && ${3=10}>0" -skip "${4=-norm}"
-e[^-1] "Apply non-local means denoising with patch size $1, spatial bandwidth $2, tonal bandwidth $3 and patch measure command '$4'."
-v - -repeat @# -l[$>]
--l $4 -k[0] -endl
100%,100%,100%,100%,{-1.0/($3*$3)}
-nlmeans_core[0] [1],[2],$1,$2
-rm[-1,-2]
-endl -done -v +
nlmeans_core: -check @{-is_image_arg\ $1}" && "@{-is_image_arg\ $2}" && $3>0 && $4>0"
-e[^-1] "Apply non-local means denoising using weight images $1, scaling map $2, patch size $3 and spatial bandwidth $4."
-v - -pass$1 0 -pass$2 0
-repeat {@#-2} -l[$>,-1,-2]
100%,100%,100%,@{0,s},0 100%,100%,100%,@{1,s},0 100%,100%,100%,@{1,s},0
-if {@{0,d}==1}
-repeat {2*$4+1} j={$>-$4} -repeat {2*$4+1} i={$>-$4}
-if {$i!=0||$j!=0}
--shift[0,1] $i,$j,0,0,2 --[7] [1]
-sqr[7] -blur[7] $3 -*[7] [2] -exp[7]
-*[6] [7] -max[5] [7] -+[4,7] -+[3,6]
-endif
-done -done
-else
-repeat {2*$4+1} k={$>-$4} -repeat {2*$4+1} j={$>-$4} -repeat {2*$4+1} i={$>-$4}
-if {$i!=0||$j!=0||$k!=0}
--shift[0,1] $i,$j,0,0,2 --[7] [1]
-sqr[7] -blur[7] $3 -*[7] [2] -exp[7]
-*[6] [7] -max[5] [7] -+[4,7] -+[3,6]
-endif
-done -done -done
-endif
-max[5] 1e-6 -rm[1,2]
-*[0] [3] -+[1,0] -+[1,2]
-/
-endl -done -v +
normalize_local :
-check "${1=3}>=0 && ${2=16}>0 && isbool(${5=1})" -skip ${3=4%},${4=2%},${6=0},${7=255}
-e[^-1] "Normalize image$? locally, with amplitude $1, radius $2, neighborhood smoothness $3 and average smoothness $4."
-v - -repeat @# -l[$>]
--l -erode {2*$2+1} -s c -min -endl
--l[-2] -dilate {2*$2+1} -s c -max -endl
--b[-3] $4 -b[-3,-2] $3
---[-2] [-3] -+[-1] 0.01 --[-5] [-4] -/[-5,-1]
-*[-3,-2] {$1+1} -*[-1] -$1 -+[-3] [-1] -+[-2,-1]
-if $5 -max[-2] $6 -min[-1] $7 -endif
--[-1] [-2] -*[-3,-1] -+
-if $5 -c $6,$7 -endif
-endl -done -v +
normalized_cross_correlation : -check @{-is_image_arg\ $1}
-e[^-1] "Compute normalized cross-correlation of image$? with mask $1."
-v - -pass$1 0 -norm -repeat {@#-1} [-1] -l[$>,-1]
-fft[-2] -fft[-1] [-2,-1] -*[-2] [-5] -*[-1] [-6]
--[-2,-1] -*[-5,-3] -*[-3,-2] -+[-3,-2] [-2,-1] -a[-2,-1] c -norm[-1]
-/[-3] [-1] -/[-2,-1] -ifft -rm[-1]
-endl -done -rm[-1] -v +
peronamalik_flow : -check "${1=20}>0 && ${2=5}>=0" -skip ${3=5},${4=0}
-e[^-1] "Apply $2 iterations of the Perona-Malik flow on image$?, with K factor $1 and time step $3."
-v -
-m "_peronamalik_flow :
--gradient xy,0 -a[-2,-1] c -norm[-1] -b[-1] 0.8 -/[-1] $1 -sqr[-1] -*[-1] -1 -exp[-1] -a[-2,-1] c
-f[-1] '\"s1=s-1;
C=i(x,y,z,s-1);
if(c>=s1,0,
(C+i(x+1,y,z,s-1,0,1))*(j(1,0,0,0,0,1)-i) -
(C+i(x-1,y,z,s-1,0,1))*(i-j(-1,0,0,0,0,1)) +
(C+i(x,y+1,z,s-1,0,1))*(j(0,1,0,0,0,1)-i) -
(C+i(x,y-1,z,s-1,0,1))*(i-j(0,-1,0,0,0,1)))\"'"
-pde_flow $2,$3,_peronamalik_flow,$4
-uncommand _peronamalik_flow
-v +
phase_correlation : -check @{-is_image_arg\ $1}
-e[^-1] "Estimate shift between source image$? and destination $1."
-v - -repeat @# -pass$1
-normalized_cross_correlation[$>] [-1] -rm[-1]
-l[$>]
(@{-1,C}) -*[-1] 2 -s[-1] x -rm[-1]
-if {@-3>@{-4,w}} --[-3] @{-4,w} --[-3] @{-4,w} -endif
-if {@-2>@{-4,h}} --[-2] @{-4,h} --[-2] @{-4,h} -endif
-if {@-1>@{-4,d}} --[-1] @{-4,d} --[-1] @{-4,d} -endif
-a[-3--1] c -rm[-2] -/ 2 -* -1
-nm [phase\ correlation]
-endl -done -v +
pde_flow : -skip ${1=10},${2=30},${3=laplacian},${4=0}
-e[^-1] "Apply $1 iterations of the velocity flow '$3' on image$?, with time step $2."
-v - -repeat @# -l[$<]
-repeat $1
--$3[-1] -*[-1] {$2/(0.01+max(abs(im),abs(iM)))}
-if $4 -+[-1] [-2] -else -+[-2,-1] -endif
-done
-if $4 -rm[0] -endif
-a x
-endl -done
-if $4 -s x,$1 -endif -v +
periodize_poisson :
-e[^-1] "Periodize image$? using Poisson solver in Fourier space."
-v - -repeat @# -l[$>]
-s c -repeat @# -l[$>]
mM={im},{iM} sum=@{0,+}
-laplacian -fft[-1]
-if {d==1} 100%,100%,1,1,'-(4-2*cos(2*x*pi/w)-2*cos(2*y*pi/h))'
-else 100%,100%,100%,1,'-(6-2*cos(2*x*pi/w)-2*cos(2*y*pi/h)-2*cos(2*z*pi/d))'
-endif
-=[-1] 1 -/[-3,-2] [-1] -rm[-1] -=[-2] $sum -=[-1] 0
-ifft -rm[-1] -c $mM
-endl -done -a c
-endl -done -v +
red_eye : -skip ${1=75},${2=3.5},${3=0.1}
-e[^-1] "Attenuate red-eye effect in image$?, with threshold $1, smoothness $2 and attenuation $3."
-v - -to_rgb -rgb2ycbcr -repeat @# -l[$>]
-s c --[-1] 128 -->=[-1] $1% -b[-1] $2 -sqrt[-1] -*[-1] -1 -+[-1] 1
-n[-1] $3,1 -*[-2,-1] -+[-1] 128 -a c -ycbcr2rgb
-endl -done -v +
remove_hotpixels : -check ${1=3}>0 -skip ${2=10%}
-e[^-1] "Remove hot pixels in image$?, with mask size $1 and threshold $2."
-v - -repeat @# -l[$>]
--median $1 --- -abs[-1] ->=[-1] $2
-*[-2] [-1] -==[-1] 0 -*[-3,-1] -+
-endl -done -v +
remove_pixels : -check "$1>=0"
-e[^-1] "Remove $1 of the non-zero pixels in image$?."
-v - -repeat @# -l[$>]
--norm -!=[-1] 0
N=@{-1,+}
n={round(if(@{"-is_percent $1"},$N*$1,$1))}
-if {$n<=0} -rm[-1]
-elif {$n>=$N} -rm[-1] -f 0
-elif {$n>int($N/2)}
-remove_pixels[-1] {$N-$n} -==[-1] 0 -*
-else
d={d} -r 100%,{d*h},1,100%,-1
100%,1,1,1,x 1,@{-2,h},1,1,y -+[-2,-1] 1 -r[-2,-1] [-2],[-1]
-*[-2,-1] [-3] -rm[-3]
-y[-2,-1] -a[-2,-1] x -discard[-1] y,0
-do
1,100%,1,1 -rand[-1] 0,{h} -<=[-1] {$n*1.25}
-if {@{-1,+}>=$n} -break -else -rm[-1] -endif
-while 1
-r[-1] 2 -*[-2,-1] -discard[-1] y,0
-i[-2] 1,100% -rand[-2] 0,1 -a[-2,-1] x -sort[-1] +,y
-rows[-1] 0,{$n-1} --[-1] 1 -z[-1] 1,3
-i[-2] ({'CImg3d'},{h},{h})
1,100%,1,1,1 1,100%,1,1,y -a[-2,-1] x
3,100% 1,100%,1,1,1 -y[-5--1] -a[-5--1] y
-if @{0,s<=3} -j3d[-2] [-1],0,0,0,1,0,0,0,0
-else [0],[0],1,1,1 -j3d[-1] [-2],0,0,0,1,0,0,0,0 -*[0,-1]
-endif
-rm[-1]
-r 100%,{h/$d},$d,100%,-1
-endif
-endl -done -v +
split_freq :
-e[^-1] "Split image$? into low and high frequency parts, with smoothness $1."
-v - -repeat @# -l[$>] --b $1 --[0] [1] -rv -endl -done -v +
solidify :
-e[^-1] "Replace transparent regions of RGBA image$? by morphologically interpolated colors."
-v - -repeat @# -l[$>] nm=@{0,n} -to_a
[-1] -split_opacity[-2] ->=[-2] 50% -*[-1] [-2]
-replace_color[-1] 0,0,0,0,0,0,-1,-1,-1,-1 -to_rgb[-1]
-do
--dilate[-1] 3
-replace_color[-2] 0,0,-1,-1,-1,1000,1000,1000
-erode[-2] 3
-replace_color[-2] 0,0,1000,1000,1000,-1,-1,-1
-+[-2,-1] -/[-1] 2
-j[-1] [-3],0,0,0,0,1,[-2]
-while {im<0}
-k[-1]
-nm $nm -endl -done -v +
solidify_linear : -check "${1=1.5}>=1 && ${2=1}>=1 && ${3=0.5}>=0 && $3<=1"
-e[^-1] "Replace transparent regions of RGBA image$? by linearly interpolated colors, with sigma $1, dsigma $2 and precision $3."
-v - -repeat @# -l[$>]
-split_opacity
-if {@#>1}
->=[-1] 50% -*[-2] [-1]
sigma=$1 -do
N={v=round(3*$sigma);min(33,max(3,v+1-(v%2)))}
$N,$N -=[-1] 1,50%,50% -distance[-1] 1 -*[-1] {-1/$sigma^2} -exp[-1] -normalize_sum[-1]
--convolve[-3,-2] [-1] -rm[-3]
-max[-1] 1e-5 -/[-2,-1]
--dilate[-2] {v=round((1/3-$N/6)*$3+$N/2);max(3,v+1-(v%2))}
--[-3] [-1] -*[-2] [-3] -rm[-3]
--[-3,-2]
sigma={$sigma*$2}
-while {!im}
-rm[-1]
-endif
-endl -done -v +
solidify_watershed :
-e[^-1] "Replace transparent regions of RGBA image$? by color propagation."
-v - -repeat @# -l[$>]
-split_opacity
-if {@#>1}
-+[0] 1 ->=[1] 50% -*[0] [1] -distance[1] 1 -*[1] -1
-watershed[0] [1] -rm[1]
-endif
-endl -done -v +
solve_poisson : -check "${2=60}>=0 && ${3=5}>0 && ${4=0}>=0"
-e[^-1] "Solve Poisson equation for image$?, for laplacian command '$1', with $2 iterations, time step $3 and "@{-arg\ 1+($4==0),$4,auto}" scales."
-v - -repeat @# -l[$>]
[0]
-repeat {if($4,$4,int(max(log2(max(w,h))-1,1)))}
f={2^$<}
-r[1] @{0,max(1,w/$f)},@{0,max(1,h/$f)},1,100%,3
--r[0] [1],2 -l[-1] -$1 -k[0] -endl
-repeat $2 --laplacian[-2] --[-1] [-2] -*[-1] {$3/max(1e-8,abs(im),abs(iM))} -+[-3,-1] -done
-rm[-1]
-done
-rm[0]
-endl -done -v +
split_details : -check "isint(${1=4}) && $1>0 && ${2=2%}>=0 && ${3=0.5%}>=0"
-e[^-1] "Split image$? using $1 spatial scales with base scale $2 and detail scale $3."
-v - -repeat @# -l[$<]
ss={max(0.3,if(@{-is_percent\ $2},$2*max(w,h),$2))}
se={max(0.3,if(@{-is_percent\ $3},$3*max(w,h),$3))}
ds={$se-$ss}
-repeat {$1-1} --b[-1] {$ss+$>*$ds/($1-2)} --[-2] [-1] -rv[-2,-1] -done
-endl -done -v +
syntexturize : -check "${1=100%}>0 && ${2=$1}>0"
-e[^-1] "Resynthetize $1x$2 versions of texture$? by phase randomization."
-v - -repeat @# -l[$>]
mM={im},{iM} -repeat {s} -sh[-1] $>,$> sum$>=@{-1,+} var$>=@{-1,v} -rm[-1] -done
nw={if(@{-is_percent\ $1},$1*w,$1)}
nh={if(@{-is_percent\ $2},$2*h,$2)}
-repeat {s} sum$>={${sum$>}*$nw*$nh/(w*h)} -done
-if {$nw>w||$nh>h}
-periodize_poisson
100%,100% -rectangle[-1] 5,5,{w-6},{h-6},1,1 -b[-1] 2 -n[-1] 0,1
$nw,$nh,1,@{-2,s} -fc[-1] @{-average_color[-3]}
-j[-1] [-3],{(w-@{-2,w})/2},{(h-@{-2,h})/2},0,0,1,[-2]
-rm[-3,-2]
-else
-r $nw,$nh,1,100%,0,0,0.5,0.5
-periodize_poisson
-endif
-fft
100%,100% -rand[-1] {-pi},{pi}
-=[-1] 0
-if {!(w%2)} -=[-1] {(?<0.5)*pi},{int(w/2)} -endif
-if {!(h%2)} -=[-1] {(?<0.5)*pi},0,{int(h/2)} -endif
-if {!(h%2)&&!(h%2)} -=[-1] {(?<0.5)*pi},{int(w/2)},{int(h/2)} -endif
--sin[-1] -cos[-2]
--*[-4,-1] --*[-4,-3] -+[-2,-1]
-*[-5,-3] -*[-3,-2] --[-3,-2]
-repeat {s} -=[-2] ${sum$>},0,0,0,$> -=[-1] 0,0,0,0,$> -done
-ifft -rm[-1]
-repeat {s} -sh[-1] $>,$> avg={ia} --[-1] $avg -*[-1] {sqrt(${var$>}/if(iv,iv,1))} -+[-1] $avg -rm[-1] -done
-c $mM
-endl -done -v +
tv_flow : -skip ${1=10},${2=30},${3=0}
-e[^-1] "Apply $1 iterations of the total variation flow on image$?, with time step $2."
-v - -pde_flow $1,$2,curvature,$3 -v +
unsharp : -check "${2=2}>=0" -skip ${3=0}
-e[^-1] "Apply unsharp mask on image$?, with radius $1, amount $2 and threshold $3."
-v - -repeat @#
--b[$>] $1 --[-1] [$>]
-if $3 --norm[-1] ->=[-1] $3 -*[-2,-1] -endif
-*[-1] $2 --[$>,-1]
-done -v +
unsharp_octave : -check "${1=4}>0 && ${3=2}>=0" -skip ${2=1},${4=0}
-e[^-1] "Apply octave sharpening on image$?, with $1 scales, radius $2, amount $3 and threshold $4."
-v - -repeat @# -l[$>] nm=@{0,n}
--f 0 weight=0 -repeat $1
--unsharp[0] {$2*2^-@{<,-1}},$3,$4 -*[-1] {2^-$>} weight={$weight+2^-$>} -+[1,-1]
-done -rm[0] -/ $weight
-nm $nm -endl -done -v +
watermark_fourier : -check ${2=33}>0
-e[^-1] "Add textual watermark '$1' with size $2 in the frequency domain of image$?."
-v - -i[0] 0 -t[0] "$1",0,0,$2,1,1 ->=[0] 0.5 -autocrop[0] 0
-repeat {@#-1} w2={int(w/2)} h2={int(h/2)}
-fft[-1]
-shift[-2,-1] $w2,$h2,0,0,2
[0],[0],1,{s}
-j[-3,-2] [-1],3,3,0,0,1,[0]
-mirror[0] x
-j[-3,-2] [-1],{@{-2,w}-2-@{0,w}},3,0,0,1,[0]
-mirror[0] y
-j[-3,-2] [-1],{@{-2,w}-2-@{0,w}},{@{-2,h}-2-@{0,h}},0,0,1,[0]
-mirror[0] x
-j[-3,-2] [-1],3,{@{-2,h}-2-@{0,h}},0,0,1,[0]
-mirror[0] y
-rm[-1]
-shift[-2,-1] -$w2,-$h2,0,0,2
-ifft[-2,-1] -rm[-1]
-mv[-1] 1 -done
-rm[0] -v +
area : -check "$1>=0" -skip ${2=0}
-e[^-1] "Compute area of connected components in image$?, with tolerance $1 and "@{-arg\ 1+!$2,high,low}" connectivity."
-v - -repeat @# -l[$>] -s c
-repeat @# -label[$>] $1,$2 nb=@{$>,1+iM} --histogram[$>] $nb,0,{$nb-1} -map[$>] [-1] -rm[-1] -done
-a c -endl -done -v +
area_fg : -check "$1>=0" -skip ${2=0}
-e[^-1] "Compute area of foreground connected components in image$?, with tolerance $1 and "@{-arg\ 1+!$2,high,low}" connectivity."
-v - -repeat @# -l[$>] -s c
-repeat @# -label_fg[$>] $1,$2 nb=@{$>,1+iM} --histogram[$>] $nb,0,{$nb-1} -=[-1] 0 -map[$>] [-1] -rm[-1] -done
-a c -endl -done -v +
at_line : -check ${7=100%}>=0
-e[^-1] "Retrieve pixels of image$?, belonging to line ($1,$2,$3)-($4,$5,$6)."
-v - -repeat @# -l[$>]
x0={if(@{-is_percent\ $1},(w-1)*$1,$1)}
y0={if(@{-is_percent\ $2},(h-1)*$2,$2)}
z0={if(@{-is_percent\ $3},(d-1)*$3,$3)}
x1={if(@{-is_percent\ $4},(w-1)*$4,$4)}
y1={if(@{-is_percent\ $5},(h-1)*$5,$5)}
z1={if(@{-is_percent\ $6},(d-1)*$6,$6)}
($x0,$x1^$y0,$y1^$z0,$z1)
-r[-1] {1+max(abs($x1-$x0),abs($y1-$y0),abs($z1-$z0))},1,1,3,3
-round[-1] 1 -warp[0] [-1],0,0,0 -rm[-1]
-endl -done -v +
barycenter :
-e[^-1] "Compute the barycenter vector of pixel values of image$?."
-v - -norm -repeat @# -l[$>] nm=@{0,b}
sum=@{-1,+}
-if {$sum>0}
-if {d>1} --* 'z' z=@{-1,+} -rm[-1] -else z=0 -endif
-if {h>1} --* 'y' y=@{-1,+} -rm[-1] -else y=0 -endif
-* 'x' x=@{-1,+} -rm[-1]
({$x/$sum};{$y/$sum};{$z/$sum})
-else ({w/2},{h/2},{d/2}) -rm[-2]
-endif
-nm "[barycenter of '"$nm"']" -endl -done -v +
detect_skin : -check "${1=0.5}>=0 && $1<=1" -skip ${2=-1},${3=-1},${4=-1}
-if {$2<0||$3<=0||$4<=0}
-e[0--3] "Detect skin in image$?, using tolerance $1."
-v -
m0=120.9292108800069
m1=142.5745272918084
A=0.09749985486268997
B=0.06388871371746063
C=0.05250053107738495
-to_rgb -srgb2rgb -rgb2ycbcr -channels 1,2
-repeat @# -l[$>]
whd={w},{h},{d} -r {w*h*d},2,1,1,-1
-s y --[0] $m0 --[1] $m1 -a y
-i[0] ($A,$B;$B,$C) --** -rm[0]
-* -s y -+ -*[-1] {$1-1} -exp[-1]
-r $whd,1,-1
-endl -done
-else
-e[0--3] "Detect skin in image$?, using tolerance $1 and target circle at ($2,$3) with radius $4."
-v -
-to_rgb -srgb2rgb -rgb2ycbcr -channels 1,2
-repeat @# -l[$>]
100%,100% -circle[1] $2,$3,$4,1,1 --f[1] 'if(i,y,-1)' -f[1] 'if(i,x,-1)' -discard[1,2] -1 -a[1,2] c
--warp[0] [1],0,0 -rm[1]
-s[1] c
m0=@{1,a} --[1] $m0
m1=@{2,a} --[2] $m1
M={h} -a[1,2] x --transpose[1] -rv[1,2] -**[1,2] -/[1] $M -invert[1]
-rv whd={w},{h},{d} -r[1] {w*h*d},2,1,1,-1
-s[1] y --[1] $m0 --[2] $m1 -a[1,2] y --** -rm[0]
-* -s y -+ -*[-1] {$1-1} -exp[-1]
-r $whd,1,-1
-endl -done
-endif
-v +
float2fft8 :
-e[^-1] "Convert float-valued image$? to 8bits fourier representations."
-v - -repeat @# -l[$>]
-fftpolar -+[-2] 1 -log[-2] -float2int8[-2,-1] -a y
-endl -done -v +
fft82float :
-e[^-1] "Convert float-valued image$? to 8bits fourier representations."
-v - -repeat @# -l[$>]
-s y,2 -int82float -exp[-2] --[-2] 1 -ifftpolar
-endl -done -v +
fftpolar :
-e[^-1] "Compute fourier transform of image$?, as centered magnitude/phase images."
-v - -repeat @# -l[$<]
-fft -complex2polar -shift {-round(w/2)},{-round(h/2)},{-round(d/2)},0,2
-endl -done -v +
histogram_nd : -check $1>0 -skip ${2=0%},${3=100%}
-e[^-1] "Compute histogram of multi-channels image$?, using $1 levels in range [$1,$2]."
-v -
percent_nblevels=@{"-is_percent $1"}
percent_min=@{"-is_percent $2"}
percent_max=@{"-is_percent $3"}
-repeat @# -l[$>] s={s}
-r {w*h*d},{min(3,s)},1,1,-1
vmin=$2 vmax=$3
-if {$percent_min||$percent_max}
im={im} iM={iM}
vmin={if($percent_min,$im+($iM-$im)*$2,$2)}
vmax={if($percent_max,$im+($iM-$im)*$3,$3)}
-endif
dv={$vmax-$vmin}
nb_levels={max(1,round(if($percent_nblevels,$1*(1+$vmax-$vmin),$1)))}
-f 'if(i>=$vmin&&i<=$vmax,if(i==$vmax,$nb_levels-1,int((i-$vmin)*$nb_levels/($vmax-$vmin))),-1)'
-pointcloud 1,$nb_levels,{if($s>1,$nb_levels,1)},{if($s>2,$nb_levels,1)}
-endl -done -v +
histogram_cumul : -check ${1=256}>0 -skip ${2=0} -skip ${3=0},${4=0}
-arg 1+!$2,"normalized ",""
-e[^-1] "Compute "@{}"cumulative histogram of image$?, using $1 levels."
-v - -histogram $1,$3,$4 -cumulate -if $2 -repeat @# -/[$>] @{$>,M} -done -endif -v +
histogram_pointwise : -skip ${2=0%},${3=100%}
-e[^-1] "Compute the pointwise histogram of vector-valued points in image$?, with $1 levels."
-v - -repeat @# -l[$>] nm=@{0,n}
nb_levels={round(if(@{-is_percent\ $1},(iM-im)*$1,$1))}
value0={if(@{-is_percent\ $2},im+(iM-im)*$2,$2)}
value1={if(@{-is_percent\ $3},im+(iM-im)*$3,$3)}
-- $value0 -* {$nb_levels/max(1,abs($value1-$value0))} -c 0,{$nb_levels-1} -round
w={w} h={h} d={d} -r {w*h*d},{s},1,1,-1
-i[-2] (0,{w-1}) -r[-2] [-1],[-1],1,1,3 -round[-2]
-r[-2,-1] 300%,100%,1,1,4 -shift[-1] 1 -+[-2,-1] -y[-1]
-i[-2] ({'CImg3d'},{h/3},{h/3})
(1,0;1,{h/3-1}) -r[-1] 2,@{-2,h/3},1,1,3 -round[-1]
3,100%,1,1,1 1,100%,1,1,-1 -y[-5,-3,-2] -a[-5--1] y
{$w*$h*$d},$nb_levels -j3d[-1] [-2],0,0,0,1,0,0,0 -rm[-2]
-r $w,$h,$d,$nb_levels,-1
-nm $nm -endl -done -v +
hough : -check "${1=512}>0 && ${2=$1}>0" -skip ${3=1}
-e[^-1] "Compute $1x$2 hough transform of image$?, "@{-arg\ 1+!$3,with,without}" gradient norm voting."
-v - -slices 50% -luminance -repeat @# -l[$>] nm=@{0,n}
rhomax={sqrt(w^2+h^2)/2}
-g (0,{w-1}) (0;{@{-2,h}-1}) -r[-2,-1] @{-3,w},@{-3,h},1,1,3 --[-2] {w/2} --[-1] {h/2}
-complex2polar[-4--1] --[-1] [-3] -polar2complex[-2,-1] -rm[-1]
--<[-1] 0 -*[-1] {pi} -+[-3,-1] -abs[-1] -%[-2] {2*pi}
-*[-1] {$2/$rhomax} -*[-2] {0.5*$1/pi}
-y[-3--1] x {w} -mv[-4] @# -if {!$3} -f[-1] 1 -endif
-a y -pointcloud 1 -r $1,$2,1,1,0
-nm $nm -endl -done -v +
ifftpolar :
-e[^-1] "Compute inverse fourier transform of image$?, from centered magnitude/phase images."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-shift {round(w/2)},{round(h/2)},{round(d/2)},0,2 -polar2complex -ifft -rm[-1]
-endl -done -v +
isophotes : -skip ${1=64}
-e[^-1] "Render isophote maps from images$?, with $1 levels."
-v - -to_rgba -repeat @# -l[$>]
--luminance -repeat $1 --isoline3d[1] {$>*255/($1-1)} -done -rm[1] -+3d[^0] -col3d[-1] 1
[0],[0] -j3d[-1] [-2],0,0,0,1,0,0,0 -rm[-2] -*
-endl -done -v +
label_fg : -check "$1>=0" -skip ${2=0}
-e[^-1] "Label foreground connected components on image [1], with tolerance $1 and "@{-arg\ 1+!$2,high,low}" connectivity."
-v - -repeat @# -l[$>]
-if {d>1} --z -1,-1,-1,{w-1},{h-1},{d-1} -label[-1] $1,$2 -z[-1] 1,1,1,{w-1},{h-1},{d-1}
-else --z -1,-1,{w-1},{h-1} -label[-1] $1,$2 -z[-1] 1,1,{w-1},{h-1}
-endif
-!=[-2] 0 -* --histogram {1+iM} -=[-1] 0
->[-1] 0 -cumulate[-1] -map[-2] [-1] -rm[-1]
-endl -done -v +
max_patch : -check "isint(${1=16}) && $1>=1"
-e[^-1] "Return locations of maximal values in local patch neighborhood of size $1, in image$?."
-v - -repeat @# --dilate[$>] $1 -==[$>,-1] -done -v +
min_patch : -check "isint(${1=16}) && $1>=1"
-e[^-1] "Return locations of minimal values in local patch neighborhood of size $1, in image$?."
-v - -repeat @# --erode[$>] $1 -==[$>,-1] -done -v +
minimal_path : -check "$1>=0 && $2>=0 && $3>=0" -skip ${7=0}
-e[^-1] "Compute minimal path between points ($1,$2,$3) and ($4,$5,$6) for potential map$?, with "@{-arg\ 1+$7,low,high}" connectivity."
-v - -repeat @# -l[$>] nm=@{0,n}
-- {im} -+ {iM/100}
100%,100% -= 1,${4-6} -distance[-1] 1,[0],{if($7,4,3)} -k[-1]
x={round(if(@{-is_percent\ $1},$1*(w-1),$1))}
y={round(if(@{-is_percent\ $2},$2*(h-1),$2))}
z={round(if(@{-is_percent\ $3},$3*(d-1),$3))}
($x;$y;$z)
-do
p=@{0,($x,$y,$z)}
-if {$p&1} x={$x-1}
-elif {$p&2} x={$x+1}
-endif
-if {$p&4} y={$y-1}
-elif {$p&8} y={$y+1}
-endif
-if {$p&16} z={$z-1}
-elif {$p&32} z={$z+1}
-endif
($x;$y;$z)
-while $p
-rm[0,-1] -a x
-nm $nm -endl -done -v +
patches : -check "isint($1) && $1>0 && isint($2) && $2>0 && isint($3) && $3>0"
-e[^-1] "Extract $1x$2x$3 patches from image$?, at locations (${4--1})."
-v -
(${4--1}) -r[-1] 3,{w/3},1,1,-1 -permute[-1] yzcx N={w}
H={int(sqrt(w))} W={round(w/$H,1,1)} -r[-1] {$W*$H},1,1,3,0 -r[-1] $W,$H,1,3,-1
-r[-1] {w*$1},{h*$2},{d*$3}
$1,$2,$3,1,x-{int($1/2)} --f[-1] y-{int($2/2)} --f[-1] z-{int($3/2)} -a[-3--1] c -r[-1] [-2],0,2 -+[-2,-1]
-repeat {@#-1} -warp[$>] [-1],0,0,0 -done -rm[-1]
-repeat @# -l[$<] -s y,$H -s x,$W -k[0-{$N-1}] -endl -done
-v +
plot2value :
-e[^-1] "Retrieve values from 2d graph plot$?."
-v - -repeat @# -l[$>]
-s c ->= 50%
-repeat @# -l[$>] (1,{w}) -r[1] [0],3 -* -histogram {w},1,{w} -endl -done
-a c
-endl -done -v +
pointcloud : -check "${1=0}<3" -skip ${2=0},${3=0},${4=0}
-e[^-1] "Convert image$? to point clouds, in "@{-arg\ 2+($1>=0)*$1-($1<0),{-$1}-opacity,binary,cumulative,labeling}" mode,"\
"with ($2,$3,$4) as maximal dimensions."
-v - -repeat @# -l[$>] nm=@{0,n}
-if {"d>1 || s>1"} -error "Command '-pointcloud': Invalid input image "{w}x{h}x{d}x{s}". Should be NxMx1x1." -endif
-rows 0,{max(2,h-1)}
-sh[-1] 0,0,0,0 -round[-1] dx={round(if($2==0,iM+1,if($2<0,min(iM+1,-$2),$2)))}
-sh[-2] 1,1,0,0 -round[-1] dy={round(if($3==0,iM+1,if($3<0,min(iM+1,-$3),$3)))}
-sh[-3] 2,2,0,0 -round[-1] dz={round(if($4==0,iM+1,if($4<0,min(iM+1,-$4),$4)))}
-*[-1] $dy -+[-2] [-1] -f[-1] 0 -rm[-3--1]
-s x,-1000000
-repeat @# -l[$>]
nbp={w}
-if {h>3} --rows 3,100% -rows[-2] 0,2 -else 100%,1,1,1,1 -if {$1==2} -f[-1] 1+x -endif -endif
spectrum={h} -i[-2] (-128;1;1;{h}) -r[-2] {w} -a[-2,-1] y
-i[-3] ({'CImg3d'}) -transpose[-3--1] -i[-3] ($nbp;$nbp)
-i[-2] 1,$nbp,1,1,1 -i[-2] 1,$nbp,1,1,y -a[-3,-2] x
1,$nbp,1,1,{if($1<0,-$1,if($1==1,-1,1))}
-y[-4--2] -a y
-endl -done
-+3d
$dx,{$dy*$dz},1,$spectrum -j3d[-1] [-2],0,0,0,1,0,0,0 -rm[-2] -r[-1] $dx,$dy,$dz,100%,-1
-nm $nm -endl -done -v +
psnr : -skip ${1=255}
-e[^-1] "Compute the "@#x@#" matrix of PSNR values, from image$? with maximum value $1."
-v - -mse -log10 -- {log10($1*$1)} -* -10 -nm[-1] [PSNR] -v +
segment_watershed : -check "${1=2}>=0" -skip ${2=1}
-e[^-1] "Apply watershed segmentation on image$?, with edge threshold $1."
-v - -repeat @# -l[$>]
min=@{-1,m}
-+ {1+$min} --gradient_norm
-if {d>1} --f[-1] "if(i<$1 && i<j(1) && i<j(-1) && i<j(0,1) && i<j(0,-1) && i<j(0,0,1) && i<j(0,0,-1),1,0)"
-else --f[-1] "if(i<$1 && i<j(1) && i<j(-1) && i<j(0,1) && i<j(0,-1),1,0)"
-endif
-*[-3,-1] -*[-1] -1 -watershed[-2] [-1],$2 -rm[-1]
-- {1+$min}
-endl -done -v +
skeleton : -check ${1=0}>=0
-e[^-1] "Compute skeleton of binary image$?."
-v - ->= 50% -distance 0 -b $1 -sharpen 1e10 ->= 100%
-repeat @# --erode[$>] 2 --[$>,-1] -done -v +
ssd_patch : -check @{-is_image_arg\ $1} -skip ${2=0},${3=0}
-e[^-1] "Compute field of SSD between image$? and patch $1 using "@{-arg\ 1+!$2,fourier,spatial}" mode."
-v - -repeat @# -pass$1 0 -l[$>,-1]
-r 100%,100%,100%,@{-max_s} -s c
-repeat {@#/2} -l[$>,{-1-$<}]
--sqr[1] val=@{-1,+} -rm[-1]
--sqr[0] --f[1] 1
-if $2
-convolve_fft[-2] [-1] -rm[-1]
-mirror[1] xyz -convolve_fft[0] [1] -rm[1]
-else
-correlate[-2] [-1],$3 -rm[-1]
-correlate[0] [1],$3 -rm[1]
-endif
-*[0] -2 -+[0,1] -+ $val
-endl -done -+
-endl -done -v +
thinning :
-e[^-1] "Compute skeleton of binary image$?, using morphological thinning."
-v - ->= 50% -* 2 -- 1
(-1,-1,-1;0,1,0;1,1,1) (0,-1,-1;1,1,-1;0,1,0) --rotate[-2,-1] 90 --rotate[-2,-1] 90 --rotate[-2,-1] 90
-repeat {@#-8}
bavg=@{-9,+}
-repeat 99999
--correlate[-9] [-8] ->=[-1] 7 -*[-1] 2 --[-10,-1]
--correlate[-9] [-7] ->=[-1] 6 -*[-1] 2 --[-10,-1]
--correlate[-9] [-6] ->=[-1] 7 -*[-1] 2 --[-10,-1]
--correlate[-9] [-5] ->=[-1] 6 -*[-1] 2 --[-10,-1]
--correlate[-9] [-4] ->=[-1] 7 -*[-1] 2 --[-10,-1]
--correlate[-9] [-3] ->=[-1] 6 -*[-1] 2 --[-10,-1]
--correlate[-9] [-2] ->=[-1] 7 -*[-1] 2 --[-10,-1]
--correlate[-9] [-1] ->=[-1] 6 -*[-1] 2 --[-10,-1]
aavg=@{-9,+} -if {$aavg==$bavg} -break -endif bavg=$aavg
-done
-mv[-9] 0 -done -rm[-8--1] -+ 1 -/ 2 -v +
tones : -check $1>0
-e[^-1] "Get $1 tones masks from image$?."
-v - -norm -n 0,{$1-1} -round 1 -repeat @# -l[$<]
-repeat {$1-1} --==[0] {1+$>} -done -==[0] 0
-endl -done -v +
topographic_map : -check "isint(${1=16}) && $1>0" -skip ${2=2}
-e[^-1] "Render topographic maps from image$?, with $1 levels and smoothness $2."
-v - -repeat @# -l[$>]
--b $2 -isophotes[-1] $1 -compose_channels[-1] + -==[-1] 0 -blend shapeaverage0
-endl -done -v +
variance_patch : -check "isint(${1=16}) && $1>=1"
-e[^-1] "Compute variance of image patches in image$?, with patch size $1."
-v -
$1,$1,1,1,1 -normalize_sum[-1]
-repeat {@#-1} -l[$>,-1]
--sqr[0] -convolve[0,2] [1]
-sqr[0] -rv[0,2] --[0,2] -max[0] 0
-endl -done -rm[-1] -v +
ball : -check "${1=64}>0 && ${5=0.8}>=0 && $5<=8 && ${6=1}>=0 $6<=8 && ${7=1.5}>=0" -skip ${2=255},${3=$2},${4=$3}
-e[^-1] "Input $1x$1 ball with color (${2-4}), specular light $5, specular size $6 and shadow factor $7."
-v - -l[]
{2*$1},{2*$1} -= 1,65%,30% -distance 1 -* -1
--n 0,1 -^[1] $7 -*[1] 1.4 --*[1] $3 --*[1] $4 -*[1] $2 -a[^0] c
->=[0] {100-10*$6}% -b[0] {3*$6}% -n[0] 0,{$5*255} -rv -+ -c 0,255
100%,100% -circle[1] 50%,50%,34%,1,1 -*[0] [1] -*[-1] 255 -a c
-r $1,$1,1,4,2
-endl -v +
chessboard : -check "$1>0 && ${2=$1}>0" -skip ${3=0},${4=0},${5=0},${6=1},${7=0},${8=255}
-e[^-1] "Draw chessboard on image$?, with sizes ($1,$2), offsets ($3,$4), angle $5 deg., opacity $6 and colors (${7--1})."
-v - -i[0] (${7--1}) -r[0] {@{0,w}/2},1,1,2,-1 -permute[0] cyzx
-repeat {@#-1}
w={w} h={h} theta={$5*pi/180}
($3,{$3+$w-1};$3,{$3+$w-1}^$4,$4;{$4+$h-1},{$4+$h-1}) -r[-1] $w,$h,1,2,3
-r[-1] {$w*$h},2,1,1,-1
-i[-2] ({cos($theta)},{-sin($theta)};{sin($theta)},{cos($theta)}) -**[-2,-1]
-r[-1] $w,$h,1,2,-1
-%[-1] {$1+$2} ->=[-1] $1 -s[-1] c -xor[-2,-1] -map[-1] [0] -r[-1] 100%,100%,1,[-2]
-j[-2] [-1],0,0,0,0,$6 -rm[-1]
-mv[-1] 1 -done -rm[0] -v +
cie1931 :
-e[^-1] "Draw CIE-1931 chromaticity diagram on image$?."
-v -
(67.5;73.5;109.5;103.5;51.5;100.5;37;36)
(280,420,0;171,829,0;158,820,0;153,816,0;147,811,0;140,804,0;132,794,0;121,776,0;106,747,0;88,701,0;\
65,633,0;42,539,0;20,421,0;5,295,0;0,179,0;4,115,0;10,83,0;16,61,0;25,38,0;35,21,0;47,10,0;58,3,0;\
71,0,0;92,1,0;111,7,0;151,28,0;189,52,0;226,79,0;262,109,0;298,141,0;334,175,0;370,209,0;405,244,0;\
441,279,0;475,313,0;509,347,0;731,568,0)
xM=731 yM=829
2,{h-1},1,1,3,0 1,{h},1,1,'y' --+[-1] 1 -%[-1] {h} -+[-2,-1] 1 -a[-3--1] x
3,{h},1,1,160 1,{h},1,1,1
-y[-4--2] -a[-5--1] y -mv[-1] 0
xR=636 yR=504 xG=297 yG=234 xB=147 yB=774
512,512,1,3 -triangle_shade[-1] 0,0,{w-1},0,0,{h-1},""255,0,0,""0,255,0,""0,0,255 -rgb2srgb[-1]
--compose_channels[-1] max -+[-1] 1e-8 -/[-2,-1] -*[-1] 255
-i[-2] (67.5;73.5;109.5;103.5;51.5;100.5;3;1;$xR;$yR;-0.01;$xG;$yG;-0.01;$xB;$yB;-0.01;9;0;1;2;0;0;511;0;0;511;-128;512;512;3)
-y[-1] (1) -a[-3--1] y -mv[-1] 1
-repeat {@#-2}
-to_rgb[-1] -fc[-1] 255,255,255 -grid[-1] 10%,10%,0,0,0.3,0xCCCCCCCC,1,0
100%,100%,1,3
--*3d[0,1] {(w-8)/$xM},{(h-32)/$yM}
-j3d[-3] [-1],2,30,0,1,2
--!=[-3] 0 -distance[-1] 1 -*[-1] -1 -watershed[-4] [-1] -rm[-1] -/[-3] 1.5
-j3d[-3] [-1],2,30,0,1,2
-p3d[-1] 1 -p3d[-1] 2 -col3d[-1] 128 -j3d[-3] [-1],2,30,0,1,1 -rm[-1]
@{-2,w},@{-2,h} -j3d[-1] [-2],2,30,0,1,2 -rm[-2]
--erode[-1] 4 --[-1] [-2] -==[-1] 0 -*[-3,-1]
-a[-2,-1] c -blend[-2,-1] alpha
100%,100%,1,1,255 -axes[-1] 0,0.75,0.85,0,13,1 --erode[-1] 3 -negative[-1] -to_rgb[-2]
-j[-3] [-2],0,0,0,0,1,[-1],400 -rm[-2,-1]
-mv[-1] 2 -done -rm[0,1] -v +
circle : -skip ${4=1},${5=0}
-v - ({'"$5"'}) is_pattern={@{-1,0-1}'=='{'0x'}} -rm[-1] -v +
-if $is_pattern
-e[0--3] "Draw outlined circle at ($1,$2) with radius $3 on image$?, with opacity $4 and color (${6--1})."
-else
-e[0--3] "Draw filled circle at ($1,$2) with radius $3 on image$?, with opacity $4 and color (${5--1})."
-endif
-v - -ellipse $1,$2,$3,$3,0,${4--1} -v +
gaussian : -skip ${1=3},${2=$1},${3=0}
-e[^-1] "Draw centered gaussian on image$? with standard deviations ($1,$2) and angle $3 deg."
-v -
u={cos($3*pi/180)}
v={sin($3*pi/180)}
dmax={max(w,h)}
-if {isval($1)} l1=$1 -else l1={${1}10000*$dmax/100} -endif
-if {isval($2)} l2=$2 -else l2={${2}10000*$dmax/100} -endif
l1={1/(2*max(1/3,$l1)^2)}
l2={1/(2*max(1/3,$l2)^2)}
A={$l1*$u*$u+$l2*$v*$v}
B={($l1-$l2)*$u*$v}
C={$l1*$v*$v+$l2*$u*$u}
-repeat @# -l[$>] nm=@{0,n}
w={w} h={h} ds={d},{s} -rm
$w,$h,1,1,'X=x-{($w-1)/2};Y=y-{($h-1)/2};$A*X*X+2*$B*X*Y+$C*Y*Y'
-* -1 -exp -r $w,$h,$ds
-nm $nm -endl -done -v +
grid : -check "$1>=0 && $2>=0" -skip ${3=0},${4=0},${5=1},${6=0}
-v - ({'"$6"'}) is_pattern={@{-1,0-1}'=='{'0x'}} -rm[-1] -v +
-if $is_pattern
-e[0--3] "Draw xy-grid on image$?, with sizes ($1,$2), offsets ($3,$4), opacity $5, pattern $6 and color (${7--1})."
-v - pattern=$6 color=${7--1}
-else
-e[0--3] "Draw xy-grid on image$?, with sizes ($1,$2), offsets ($3,$4), opacity $5, and color (${6--1})."
-v - pattern=0xFFFFFFFF color=${6--1}
-endif
is_percentsx=@{-is_percent\ $1} is_percentsy=@{-is_percent\ $2}
is_percentox=@{-is_percent\ $3} is_percentoy=@{-is_percent\ $4}
-repeat @# -l[$>]
w={w} h={h} s={s}
size={if($is_percentsx,max(1,w*$1),$1)}
-if {$size>=1}
offset={if($is_percentox,$size*$3,$3)}
({'CImg3d'}) -+[-1] 0.5
1,{1+int($w/$size)},1,1,'y' -*[-1] $size -+[-1] {$offset%$size}
1,{h},1,1,{$h/2} -a[-2,-1] x -z[-1] 0,2 n={h} -i[-2] ($n;$n)
(1,0;1,{$n-1}) -r[-1] 2,$n,1,1,3 -round[-1]
(-128;1;$h;$s) 1,$h,1,$s -line[-1] 0,0,0,100%,1,$pattern,$color
-if {$n>1} 1,{4*($n-1)},1,1,-128,0,0,0 -endif
(-128;1;$h;1) 1,$h,1,1 -line[-1] 0,0,0,100%,1,$pattern,1
-if {$n>1} 1,{4*($n-1)},1,1,-128,0,0,0 -endif
-y[^0] -a[^0] y -j3d[0] [1],0,0,0,$5,0,0,0 -rm[1]
-endif
size={if($is_percentsy,max(1,h*$2),$2)}
-if {$size>=1}
offset={if($is_percentoy,$size*$4,$4)}
({'CImg3d'}) -+[-1] 0.5
1,{1+int($h/$size)},1,1,'y' -*[-1] $size -+[-1] {$offset%$size}
-i[-2] 1,{h},1,1,{$w/2} -a[-2,-1] x -z[-1] 0,2 n={h} -i[-2] ($n;$n)
(1,0;1,{$n-1}) -r[-1] 2,$n,1,1,3 -round[-1]
(-128;$w;1;$s) $w,1,1,$s -line[-1] 0,0,100%,0,1,$pattern,$color
-if {$n>1} 1,{4*($n-1)},1,1,-128,0,0,0 -endif
(-128;$w;1;1) $w,1,1,1 -line[-1] 0,0,100%,0,1,$pattern,1
-if {$n>1} 1,{4*($n-1)},1,1,-128,0,0,0 -endif
-y[^0] -a[^0] y -j3d[-2] [-1],0,0,0,$5,0,0,0 -rm[-1]
-endif
-endl -done -v +
marble : -skip ${1=0.2},${2=0.1},${3=45},${4=0},${5=0.4},${6=0.8},${7=0.6},${8=1.1},${9=0%},${10=100%}
-e[^-1] "Render marble like pattern on image$?, with image weight $1, pattern weight $2, angle $3 deg., amplitude $4, "\
"sharpness $5, anisotropy $6, alpha $7, sigma $8, and cut ($9,$10)."
-v - sx={$2*sin($3*pi/180)} sy={$2*cos($3*pi/180)} -f sin(x*$sx+y*$sy+i*$1)
-if {$4} -smooth $4,$5,$6,$7,$8 -endif
-c $9,$10 -n 0,255
-v +
maze : -check "isint(${1=15}) && $1>0 && isint(${2=$1}) && $2>0 && isint(${3=24}) && $3>0"
-e[^-1] "Input $1x$2 maze."
-v -
({round(?($1-1))},{round(?($2-1))})
$1,$2,1,1,15 --f[-1] 0 -a[-2,-1] c
-_generate_maze $1,$2
-_render_maze[-1] $3 -nm[-1] [maze]
-v +
_generate_maze :
-do
x=@{-2,-2} y=@{-2,-1}
-=[-1] 1,$x,$y,0,1
is_candidate=0
up=-1 -if {i($x,$y)&8" && "$y>0" && "!i($x,$y-1,0,1)} up=$x,{$y-1},8 is_candidate=1 -endif
down=-1 -if {i($x,$y)&4" && "$y<$2-1" && "!i($x,$y+1,0,1)} down=$x,{$y+1},4 is_candidate=1 -endif
left=-1 -if {i($x,$y)&2" && "$x>0" && "!i($x-1,$y,0,1)} left={$x-1},$y,2 is_candidate=1 -endif
right=-1 -if {i($x,$y)&1" && "$x<$1-1" && "!i($x+1,$y,0,1)} right={$x+1},$y,1 is_candidate=1 -endif
-if $is_candidate
($up,$down,$left,$right) -discard[-1] -1 -r[-1] 3,{h/3},1,1,-1 -shift[-1] 0,{?(4)},0,0,2 -rows[-1] 0,0 -mv[-1] -2
-endif
-if $is_candidate
-if {@{-2,-1}==8}   -=[-1] {i($x,$y)&7},$x,$y -=[-1] {i($x,$y-1)&11},$x,{$y-1}
-elif {@{-2,-1}==4} -=[-1] {i($x,$y)&11},$x,$y -=[-1] {i($x,$y+1)&7},$x,{$y+1}
-elif {@{-2,-1}==2} -=[-1] {i($x,$y)&13},$x,$y -=[-1] {i($x-1,$y)&14},{$x-1},$y
-else               -=[-1] {i($x,$y)&14},$x,$y -=[-1] {i($x+1,$y)&13},{$x+1},$y
-endif
-z[-2] 0,1 -a[-3,-2] y
-else
-if {@{-2,h}==1} -break -endif
-rows[-2] 0,{@{-2,h}-2}
-endif
-while 1
-rm[-2] -channels[-1] 0
_render_maze :
-i[0] $1,$1 -i[1] [0]x15
-line[8-15] 0,0,100%,0,1,1
-line[4-7,12-15] 0,100%,100%,100%,1,1
-line[2-3,6-7,10-11,14-15] 0,0,0,100%,1,1
-line[1-15:2] 100%,0,100%,100%,1,1
-a[0-15] x -r[-1] {w*$1},{h*$1} -*[-1] $1 -channels[-1] 0,1
$1,$1,1,1,x $1,$1,1,1,y -a[-2,-1] c -r[-1] [-2],[-2],1,2,0,2 -+[-2,-1]
-warp[-2] [-1],0,0,0 -rm[-1]
maze_mask : -check "isint(${1=24}) && $1>0"
-e[^-1] "Input masked maze from image$? with cell size $1."
-v - -norm ->= 50% -repeat @# -l[$>]
-do
--rand[0] 0,1 -*[-1] [0] ({xM},{yM}) -rm[-2]
--flood[0] @-1,0,0,0,1,2 ->=[-1] 2 --negative[-1] -*[-2] 15 -a[-2,-1] c
-flood[0] @-2,0,0,0,1,0
-_generate_maze {w},{h}
-while @{0,M}
-rm[0] -+ -_render_maze[-1] $1 -nm[-1] [maze]
-endl -done -v +
pack_sprites : -check "isint(${1=5}) && $1>=0 && ${2=25}>=0 && $2<=100 && isint(${3=3}) && $3>=0 && $3<=3 && isint(${4=1}) && isint(${5=7}) && $5>=0 && isint(${6=256}) && $6>=0"
-e[^-1] "Randomly pack image$? with $1 scales, minimum scale $2%, "@{-arg\ 1+$3,no,180\"\ \"deg.,90\"\ \"deg.,any}" rotation, spacing $4, precision $5 and $6 maximum iterations."
-v - N={@#-1} is_first_time=1
-repeat @# -r[$>] 100%,100%,1,{max(2,@{$>,s})} -done
-repeat $1
-rprogress {$>*100/$1}
nb_attempts=0
ratio={if($1>1,$2+(100-$2)*$</($1-1),100)}%
-repeat $N --l[{1+$>}]
w={w*$ratio} h={h*$ratio}
-if {$w<1||$h<1} -rm
-else -r $w,$h,1,100%,2 -sh[-1] 100%,100% -!=[-1] 0 area{1+$>}=@{-1,+} -rm[-1]
-endif
-endl -done
-l[0,{$N+1}--1] -repeat $6
ind={1+($>%$N)} area=${area$ind}
-if {$3==0} [$ind]
-elif {$3==1} --rotate[$ind] {round(?)*180}
-elif {$3==2} --rotate[$ind] {round(?(3))*90}
-else --rotate[$ind] {?*360} -sh[-1] 100%,100% -!=[-1] 0 area=@{-1,+} -rm[-1]
-endif
--channels[0] 100% -==[-1] 0
-if {$4>1} -erode[-1] {2*$4-1}
-elif {$4<1} -dilate[-1] {-2*$4+3}
-endif
--rectangle[-1] 0,0,100%,100%,1,0xFFFFFFFF,0
-if $is_first_time -noise[-1] 0.1,2 -endif
-distance[-1] 0 -noise[-1] 1,1
-max_patch[-1] {round(1.5*@{$ind,max(w,h)})}
-*[-1] [-2] -pointcloud3d[-1]
-if {$N>1} -l[-1]
-s3d -/[1] $N -round[1] -max[1] 1 n=@{1,0}
-r[2] 3,{@{2,h}/3},1,1,-1
-i[2] 1,@{2,h} -rand[2] 0,1 -a[2,3] x -sort[2] +,y -z[2] 1,3 -r[2] 3,$n,1,1 -y[2]
-r[3] 1,{2*$n},1,1,0 -r[4] 1,{3*$n},1,1,0 -r[5] 1,$n,1,1,0 -a y
-endl -endif
n=@{-1,7}
-if $n
-s3d[-1] -rm[-2,-1]
-if {$3==0}
[-6] -i[-2] (-128;{w};{h};{s})
-if {$n>1} 4,{$n-1},1,1,-128,0,0,0 -endif
--channels[-2] 100% -i[-2] (-128;{w};{h};{s})
-if {$n>1} [-3] -endif
-elif {$3==1}
--rotate[-6] {round(?(1))*180} -i[-2] (-128;{w};{h};{s})
-if {$n>1} --rotate[-1] 180 -i[-2] (-128;{w};{h};{s}) -endif
-if {$n>2} 4,{$n-2},1,1,-128,0,0,0 1,100% -rand[-1] 0,1 -round[-1] 1 -j[-2] [-1],1 -rm[-1] -endif
--channels[-4] 100% -i[-2] (-128;{w};{h};{s})
-if {$n>1} --channels[-4] 100% -i[-2] (-128;{w};{h};{s}) -endif
-if {$n>2} [-5] -endif
-else
--rotate[-6] {round(?(3))*90} -i[-2] (-128;{w};{h};{s})
-if {$n>1} --rotate[-1] 90 -i[-2] (-128;{w};{h};{s}) -endif
-if {$n>2} --rotate[-1] 90 -i[-2] (-128;{w};{h};{s}) -endif
-if {$n>3} --rotate[-1] 90 -i[-2] (-128;{w};{h};{s}) -endif
-if {$n>4} 4,{$n-4},1,1,-128,0,0,0 1,100% -rand[-1] 0,3 -round[-1] 1 -j[-2] [-1],1 -rm[-1] -endif
--channels[-8] 100% -i[-2] (-128;{w};{h};{s})
-if {$n>1} --channels[-8] 100% -i[-2] (-128;{w};{h};{s}) -endif
-if {$n>2} --channels[-8] 100% -i[-2] (-128;{w};{h};{s}) -endif
-if {$n>3} --channels[-8] 100% -i[-2] (-128;{w};{h};{s}) -endif
-if {$n>4} [-9] -endif
-endif
-y[{$N+3}--1] -a[{$N+3}--1] y
-endif
-rm[-3]
[0] -sh[-1] 100%,100% -f[-1] 1 --[-1] [-4]
-j3d[-2] [-3],0,0,0,1,2,0,0 -rm[-3,-1]
-sh[-1] 100%,100% -area_fg[-1] 0,1 -==[-1] $area
-*[-1] [-3] -rm[-3] -sh[-2] 0,@{-2,s-2} -*[-1] [-2] -rm[-1]
-if {iM} -j[0] [-2],0,0,0,0,1,[-1] -rm[-2,-1]
-else
-rm[-2,-1]
nb_attempts={$nb_attempts+1}
-if {$nb_attempts>$5} -break -else -continue -endif
-endif
-done -k[0] -endl
-done -k[0] -v +
piechart : -check $1>=0
-e[^-1] "Draw pie chart on image$?, with label height $1 and color ($2,$3,$4)."
-v - $=arg -repeat @# -l[$>]
-ellipse 50%,50%,{w/2-1},{h/2-1},0,1,1
-ellipse 50%,50%,{w/2-1},{h/2-1},0,1,0xFFFFFFFF
(${6--1:5}) -normalize_sum[-1]
theta=0
-if {w>1} -repeat {w}
xe={0.5*@{-2,w}*(1+cos($theta))}
ye={0.5*@{-2,h}*(1+sin($theta))}
-line[-2] 50%,50%,$xe,$ye
theta={$theta-2*pi*i($>)}
-done -endif
theta=0
-repeat {w} -if {i($>)}
ntheta={$theta-2*pi*i($>)}
xc={0.5*@{-2,w}*(1+0.5*cos(0.5*($ntheta+$theta)))}
yc={0.5*@{-2,h}*(1+0.5*sin(0.5*($ntheta+$theta)))}
xf={0.5*@{-2,w}*(1+0.8*cos(0.5*($ntheta+$theta)))}
yf={0.5*@{-2,h}*(1+0.8*sin(0.5*($ntheta+$theta)))}
-flood[-2] $xf,$yf,0,0,0,1,${arg{7+5*$>}},${arg{8+5*$>}},${arg{9+5*$>}}
-if {abs($ntheta-$theta)>0.1}
0 -t[-1] ${arg{5+5*$>}},0,0,$1,1,1
($2^$3^$4) -r[-1] [-2],[-2],1,3 -*[-1] [-2]
-j[-4] [-1],{$xc-w/2},{$yc-h/2},0,0,1,[-2]
-rm[-2,-1]
-endif
theta=$ntheta
-endif -done
-rm[-1]
-endl -done -v +
polka_dots : -check $1>=0 -skip ${2=20},${3=50},${4=50},${5=0},${6=10},${7=1},${8=1},${9=255}
-e[^-1] "Draw polka dots on image$?, with diameter $1, density $2, angle $3 deg., shift ($4,$5), aliasing $6 and shading $7."
-v - theta={$5*pi/180} ct={cos($theta)} st={sin($theta)} mid1={$1/2} mid2={$2/2}
-i[0] (${9--1}) -y[0] c
-repeat {@#-1}
WH={max(w,h)}
100%,100%,100%,1,"xn = 100*x/"$WH"-$3; yn = 100*y/"$WH"-$4; \
xr = xn*"$ct"-yn*"$st"; yr = xn*"$st"+yn*"$ct"; \
xc = xr%$2-"$mid2"; yc = yr%$2-"$mid2"; \
"$mid1"-sqrt(xc*xc+yc*yc)"
-*[-1] $6 -c[-1] 0,$7 -n[-1] 0,$8 (${9--1}) -y[-1] c -r[-1] [-2],[-2],[-2]
-j[-3] [-1],0,0,0,0,1,[-2] -rm[-2,-1]
-mv[-1] 1 -done -rm[0] -v +
rectangle : -skip ${5=1},${6=0}
-v - ({'"$5"'}) is_pattern={@{-1,0-1}'=='{'0x'}} -rm[-1] -v +
-if $is_pattern
-e[0--3] "Draw outlined rectangle from ($1,$2) to ($3,$4) on image$?, with opacity $5 and color (${7--1})."
-else
-e[0--3] "Draw filled rectangle from ($1,$2) to ($3,$4) on image$?, with opacity $5 and color (${6--1})."
-endif
-v - -polygon 4,$1,$2,$3,$2,$3,$4,$1,$4,${5--1} -v +
rorschach : -check "${1=5%}>=0 && isint(${2=1}) && $2>=0 && $2<=3"
-e[^-1] "Render rorschach-like inkblots on image$?, with smoothness $1 and "@{-arg\ 1+$2,no,x,y,xy}"-mirroring."
-v -
-if {$2==0}
-rand -1,1 -b $1 ->= 0
-elif {$2==1}
-repeat @# -l[$>]
w={w}
-columns 0,{w/2-1} -rand -1,1 -b $1 ->= 0
--mirror x -if {$w%2} -columns[-1] 1,100% -endif -a x
-endl -done
-elif {$2==2}
-repeat @# -l[$>]
h={h}
-rows 0,{h/2-1} -rand -1,1 -b $1 ->= 0
--mirror y -if {$h%2} -rows[-1] 1,100% -endif -a y
-endl -done
-elif {$2==3}
-repeat @# -l[$>]
w={w} h={h}
-z 0,0,{w/2-1},{h/2-1} -rand -1,1 -b $1 ->= 0
--mirror x -if {$w%2} -columns[-1] 1,100% -endif -a x
--mirror y -if {$h%2} -rows[-1] 1,100% -endif -a y
-endl -done
-endif
-v +
sierpinski : -check ${1=7}>=0 -skip ${2=50},${3=0},${4=0},${5=100},${6=100},${7=100}
-e[^-1] "Draw Sierpinski triangle of degree $1 on image$?."
-v - -_sierpinski ${2-7},$1  -v +
_sierpinski :
-if {$7<=0} -polygon 3,$1%,$2%,$3%,$4%,$5%,$6%,1,255 -return -endif
-_sierpinski $1,$2,{($1+$3)/2},{($2+$4)/2},{($1+$5)/2},{($2+$6)/2},{$7-1}
-_sierpinski {($1+$3)/2},{($2+$4)/2},$3,$4,{($3+$5)/2},{($4+$6)/2},{$7-1}
-_sierpinski {($1+$5)/2},{($2+$6)/2},$5,$6,{($3+$5)/2},{($4+$6)/2},{$7-1}
snowflake : -check ${1=4}>=0 -skip ${2=20},${3=70},${4=80},${5=70},${6=50},${7=10},${8=1},${9=255}
-v -
-polygon 3,$2%,$3%,$4%,$5%,$6%,$7%,${8--1}
-_snowflake $1,$2,$3,$6,$7,${8--1}
-_snowflake $1,$6,$7,$4,$5,${8--1}
-_snowflake $1,$4,$5,$2,$3,${8--1}
-v +
_snowflake :
x0={$2+($4-$2)/3} y0={$3+($5-$3)/3}
x1={$2+2*($4-$2)/3} y1={$3+2*($5-$3)/3}
c={cos(-pi/3)} s={sin(-pi/3)}
x2={$x0+($x1-$x0)*$c-($y1-$y0)*$s} y2={$y0+($x1-$x0)*$s+($y1-$y0)*$c}
-polygon 3,$x0%,$y0%,$x1%,$y1%,$x2%,$y2%,${6--1}
-if $1
-_snowflake {$1-1},$2,$3,$x0,$y0,${6--1}
-_snowflake {$1-1},$x0,$y0,$x2,$y2,${6--1}
-_snowflake {$1-1},$x2,$y2,$x1,$y1,${6--1}
-_snowflake {$1-1},$x1,$y1,$4,$5,${6--1}
-endif
spiralbw :
-e[^-1] "Draw (squared) black and white spiral on image$?."
-v - -channels 0
-f "r=min(x,y,w-1-x,h-1-y); 2*r*(w+h-2*r-1) + if(min(x,h-1-y)>=min(w-1-x,y),x+y,2*(w+h-2-2*r)-x-y)"
-v +
spline : -skip ${9=256},${10=1},${11=0}
-e[^-1] "Draw spline from ($1,$2) [$3,$4] to ($5,$6) [$7,$8] on image$?, with $9 vertices, opacity $10 and color (${11--1})."
-v - -repeat @# -l[$>]
x0={if(@{"-is_percent $1"},$1*(w-1),$1)}
y0={if(@{"-is_percent $2"},$2*(h-1),$2)}
u0={if(@{"-is_percent $3"},$3*(w-1),$3)}
v0={if(@{"-is_percent $4"},$4*(h-1),$4)}
x1={if(@{"-is_percent $5"},$5*(w-1),$5)}
y1={if(@{"-is_percent $6"},$6*(h-1),$6)}
u1={if(@{"-is_percent $7"},$7*(w-1),$7)}
v1={if(@{"-is_percent $8"},$8*(h-1),$8)}
-spline3d $x0,$y0,0,$u0,$v0,0,$x1,$y1,0,$u1,$v1,0,$9
-sh[-1] 8,{8+3*$9-1},0,0 -round[-1] -rm[-1]
-col3d[1] ${11--1} -j3d[0] [1],0,0,0,$10,1,0,0 -rm[1]
-endl -done -v +
text_outline : -skip ${2=2},${3=2},${4=13},${5=2},${6=1},${7=255}
-e[^-1] "Draw outlined text '$1' at position ($2,$3) on image$?, with font height $4, outline $5, opacity $6 and color ${7--1}."
-v - -if $5
0 -t[-1] "$1",0,0,$4,1,${7--1},1 -expand_xy[-1] {1+$5},0
-s[-1] c,{-narg(${7--1})} -dilate[-1] {2*$5+1}
-repeat {@#-2} -l[$>,-2,-1]
-if @{0,w}
-if {@{0,s}==@{1,s}} -j[0] [1],$2,$3,0,0,$6,[2]
-else --r[1] 100%,100%,1,@{0,s},0,1 -j[0] [3],$2,$3,0,0,$6,[2] -rm[3]
-endif
-else -rm[0] -i[0] [0] -endif
-endl -done
-rm[-2,-1]
-else -t "$1",${2-4},${6--1}
-endif -v +
triangle_shade :
-e[^-1] "Draw triangle ($1,$2)-($3,$4)-($5,$6) with interpolated colors on image$?."
-v -
-l[] ($1,$2,1;$3,$4,1;$5,$6,1) (${7--1}) -r[-1] {w/3},3,1,1,-1 -s[-1] x -solve[^0] [0] -rm[0] -a c -endl
-polygon[^-1] 3,${1-6},1,-65535
-repeat {@#-1} -l[$>,-1] -repeat @{0,s}
a={i(0,0,0,$>)} b={i(0,1,0,$>)} c={i(0,2,0,$>)}
-sh[0] $>,$> -f[-1] 'if(i==-65535,$a*x+$b*y+$c,i)' -rm[-1]
-done -endl -done
-rm[-1] -v +
truchet : -check "isint(${1=32}) && $1>0 && ${2=3}>=0" -skip ${3=1}
-e[^-1] "Render "@{-arg\ 1+!$3,curved,straight}" truchet patterns in image$?, with scale $1 and radius $2."
-v - -repeat @# -l[$>] nm=@{0,n}
w={w} h={h} s={s} -rm
$1,$1 -= 1,0,0 -= 1,100%,100% -distance 1,{1+$3} M={int(iM/2)}
-ir {$M-$2/2-($1%2)},{$M+$2/2} --mirror y -a x
{round($w/$1,1,1)},{round($h/$1,1,1)} -rand[-1] 0,1 ->=[-1] 50% -r[-1] {w*$1},{h*$1} -*[-1] $1
-channels[-1] 0,1 (0,{$1-1}) -r[-1] $1,$1,1,1,3 --transpose[-1] -a[-2,-1] c -r[-1] [-2],0,2 -+[-2,-1]
-warp[-2] [-1] -rm[-1] ->= 50% -r $w,$h,1,1,0 -r 100%,100%,1,$s
-nm $nm -endl -done -v +
turbulence : -check "${1=32}>0 && ${2=6}>0" -skip ${3=3},${4=0},${5=0}
-e[^-1] "Render fractal noise or turbulence on image$?, with radius $1, octaves $2, damping per octave $3, difference $4 and mode $5."
-v - -repeat @# -l[$>] nm=@{0,n}
-if {$4} [-1] -endif
-f[-1] 0 --noise[-1] 10,0 -b[-1] $1,0
-if {$5==0||$5==1} --[-1] @{-1,a} -abs[-1]
-elif {$5==3||$5==4} -^[-1] 2
-elif {$5==5} -^[-1] 3
-endif
-repeat {$2-1}
--noise[-2] 10,0 -b[-1] {$1/2^$>},0
-if {$5==0} --[-1] @{-1,a} -abs[-1]
-elif {$5==4} -^[-1] 2
-elif {$5==5} -^[-1] 3
-endif
-*[-2] $3 -+[-2--1]
-done
-n[-1] 0,255
-rm[-2]
-if {$4} -*[-1] $4 -mv[-2] 2 -- -n[-1] 0,255 -endif
-nm $nm -endl -done -v +
yinyang :
-e[^-1] "Draw yin-yang symbol on image$?."
-v - -f 0 -repeat @# -l[$>]
s={s} -channels 0
r={round(0.95*min(w,h)/4)}
--line 50%,0,50%,50%,1,2 -ellipse[-1] 50%,{h/2-$r},$r,$r,0,1,2
-line[-1] 50%,50%,50%,100%,1,1 -ellipse[-1] 50%,{h/2+$r},$r,$r,0,1,1
-flood[-1] {w/2-$r},50%,0,0,0,1,2
-flood[-1] {w/2+$r},50%,0,0,0,1,1
-ellipse[-2] 50%,50%,{2*$r},{2*$r},0,1,1
-*
-ellipse[-1] 50%,{h/2-$r},{$r/3},{$r/3},0,1,1
-ellipse[-1] 50%,{h/2+$r},{$r/3},{$r/3},0,1,2
-r 100%,100%,1,$s
-endl -done -v +
transpose :
-e[^-1] "Transpose image$?."
-v - -permute yxzc -v +
animate3d : -skip ${1=640},${2=480},${3=0},${4=1},${5=0},"${7=""}" -check ${6=1}>=0
-e[^-1] "Animate 3d object$?, in a $1x$2 window with angle velocities ($3,$4,$5)."
-v - is_multi={@#>1} -repeat @# --l[$>]
-n3d -*3d {$6*min($1,$2)/1.5} -c3d
ax=0 ay=0 az=0 frame=0
-do
--r3d 1,0,0,$ax -r3d[-1] 0,1,0,$ay -r3d[-1] 0,0,1,$az
ax={$ax+$3} ay={$ay+$4} az={$az+$5}
$1,$2,1,3,-1 -j3d[-1] [-2],50%,50%,0,1
-if {narg("$7")}
-to_rgba[-1] -replace_color[-1] 0,0,-1,-1,-1,255,64,64,64,0
-if $is_multi filename=@{-filename\ "$7",$>,$frame} -else filename=@{-filename\ "$7",$frame} -endif
-o[-1] $filename frame={$frame+1}
-else
-replace[-1] -1,64
-endif
-w[-1] {w},{h},0,0,-1,-1,@{0,n} -wait 20 -k[0]
-while {@!" && "!@{!,ESC}" && "!@{!,Q}} -rm -w 0
-endl -done -v +
apply_camera3d : -skip ${4=0},${5=0},${6=0},${7=0},${8=-1},${9=0}
-e[^-1] "Apply 3d camera matrix to 3d object$?, with camera position ($1,$2,$3), target position ($4,$5,$6) and up-vector ($7,$8,$9)."
-v -
({$4-$1}^{$5-$2}^{$6-$3})
($7^$8^$9)
-orientation[-2,-1]
-_cross3d @-2,@-1
-_cross3d @-1,@-3
-rm[-3] -y[-3--1] x -mv[-2,-1] -3
-a[-3--1] y -z[-1] 0,3
--3d[^-1] $1,$2,$3 -pose3d[^-1] @-1 -rm[-1] --3d 0,0,800
-v +
_cross3d :
({$2*$6-$3*$5}^{$3*$4-$1*$6}^{$1*$5-$2*$4}) -orientation[-1] -y[-1]
array3d : -check "isint($1) && $1>0 && isint(${2=1}) && $2>0 && isint(${3=1}) && $3>0" -skip ${4=100%},${5=100%},${6=100%}
-e[^-1] "Duplicate 3d object$? along X,Y,Z axes with factors ($1,$2,$3) and offsets ($4,$5,$6)."
-v - -repeat @# -l[$>]
--rows 8,{8+3*i[6]} -r[-1] 3,{h/3},1,1,-1 -s[-1] x,3
dx=@{-3,if(@{-is_percent\ $4},$4*(iM-im),$4)}
dy=@{-2,if(@{-is_percent\ $5},$5*(iM-im),$5)}
dz=@{-1,if(@{-is_percent\ $6},$6*(iM-im),$6)}
-rm[-3--1]
off=0 -repeat {int(log2($1))}
--+3d[-1] {2^$>*$dx} -+3d[-1] [-2]
-if {!($1&(2^$>))} -rm[-2] -else -+3d[-2] $off off={$off+2^$>*$dx} -endif
-done -+3d[-1] $off -+3d
off=0 -repeat {int(log2($2))}
--+3d[-1] 0,{2^$>*$dy} -+3d[-1] [-2]
-if {!($2&(2^$>))} -rm[-2] -else -+3d[-2] 0,$off off={$off+2^$>*$dy} -endif
-done -+3d[-1] 0,$off -+3d
off=0 -repeat {int(log2($3))}
--+3d[-1] 0,0,{2^$>*$dz} -+3d[-1] [-2]
-if {!($3&(2^$>))} -rm[-2] -else -+3d[-2] 0,0,$off off={$off+2^$>*$dz} -endif
-done -+3d[-1] 0,0,$off -+3d
-endl -done -v +
arrow3d : -check "${7=5%}>=0 && ${8=25%}>=0 && ${9=15%}>=0"
-e[^-1] "Input 3d arrow, from (${1-3}) to (${4-6}), with radius $7, head length $8 and head radius $9."
-v -
L={sqrt(($4-$1)^2+($5-$2)^2+($6-$3)^2)}
R={if(@{-is_percent\ $7},$7*$L,$7)}
l={if(@{-is_percent\ $8},$8*$L,$8)}
r={if(@{-is_percent\ $9},$9*$L,$9)}
L={$L-$l} -cylinder3d $R,$L -cone3d $r,$l -+3d[-1] 0,0,$L -+3d[-2,-1]
({$4-$1}^{$5-$2}^{$6-$3}) (0.01^-0.02^0.03) -orientation[-2,-1]
-_cross3d @-2,@-1 -_cross3d @-1,@-3 -rm[-3] -y[-3--1] x -mv[-2,-1] -3
-a[-3--1] y
-s3d[-2] -r[-5] 3,@{-5,h/3},1,1,-1 -**[-5,-1]
-y[-4] -a[-6--1] y -+3d[-1] ${1-3} -rv3d[-1]
-v +
axes3d : -check ${4=23}>0 -skip ${1=1},${2=$1},${3=$2},"${5=X},${6=Y},${7=Z}"
-e[^-1] "Input 3d axes with sizes ($1,$2,$3)."
-v - -l[]
m={max(abs($1),abs($2),abs($3))/40} m2={2*$m} m3={1.2*$m2}
-_axes3d "O",$4 --3d[-1] $m3,$m3,$m3
-if $1
-line3d 0,0,0,$1,0,0
-cone3d $m,{2*$m},16 -r3d[-1] 0,1,0,-90 -+3d[-1] {$1-$m2},0,0
-_axes3d "$5",$4 -+3d[-1] {$1+$m3},0,0
-endif
-if $2
-line3d 0,0,0,0,$2,0
-cone3d $m,{2*$m},16 -r3d[-1] 1,0,0,90 -+3d[-1] 0,{$2-$m2},0
-_axes3d "$6",$4 -+3d[-1] 0,{$2+$m3},0
-endif
-if $3
-line3d 0,0,0,0,0,$3
-cone3d $m,{2*$m},16 -+3d[-1] 0,0,{$3-$m2}
-_axes3d "$7",$4 -+3d[-1] 0,0,{$3+$m3}
-endif
-+3d -nm [3d\ axes]
-endl -v +
_axes3d :
0 -t[-1] "$1",2,0,$2,1,1 --dilate[-1] 3 -*[-2] 255 -r[-2] 100%,100%,1,3
-i[-3] (67.5;73.5;109.5;103.5;51.5;100.5;1;1;0;0;0;1;0;-128;{w};{h};3)
-i[-2] (-128;{w};{h};1) -y[-3,-1] -a[-4--1] y
box3d : -skip ${1=1},${2=$1},${3=$2}
-e[^-1] "Input 3d box, with size ($1,$2,$3)."
-v -
1,86,1,1,\
67.5,73.5,109.5,103.5,51.5,100.5,8,6,\
0,0,0,$1,0,0,$1,$2,0,0,$2,0,\
0,0,$3,$1,0,$3,$1,$2,$3,0,$2,$3,\
4,0,3,2,1,4,4,5,6,7,4,0,1,5,4,4,3,7,6,2,4,0,4,7,3,4,1,2,6,5,\
200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,\
1,1,1,1,1,1
-nm[-1] [3d\ box]
-v +
c3d :
-_center3d
center3d :
-_$0
_center3d :
-e[0--3] "Center 3d object$?."
-v - -check3d 0 -repeat @# -l[$>]
-if {i[6]}
-s3d -r[2] 3,@{2,h/3},1,1,-1 -s[2] x
--[2] @{2,(iM+im)/2} --[3] @{3,(iM+im)/2} --[4] @{4,(iM+im)/2}
-a[2-4] x -y[2] -a y
-endif
-endl -done -v +
circle3d : -skip ${1=0},${2=0},${3=0},${4=1}
-e[^-1] "Input 3d circle at position ($1,$2,$3) with radius $4."
-v -
r={$4/sqrt(3)}
1,24,1,1,\
67.5,73.5,109.5,103.5,51.5,100.5,2,1,\
{$1-$r},{$2-$r},{$3-$r},\
{$1+$r},{$2+$r},{$3+$r},\
5,0,1,0,0,0,200,200,200,1
-nm[-1] [3d\ circle]
-v +
circles3d : -check ${1=1}>=0 -skip ${2=1}
-e[^-1] "Convert 3d object$? to sets of 3d "@{-arg\ 1+$2,wireframe,filled}" circles with radius $1."
-v - -p3d 0 -repeat @# -l[$>]
nbv=@{-1,6} nbp=@{-1,7}
-if {$nbv&&$nbp}
--3d {$1/2},0,0 --+3d $1,0,0 -+3d nbp2=@{-1,7}
-s3d -=[1] $nbp,0,1
-r[3] 2,$nbp2,1,1,-1 -columns[3] 1,1 -s[3] y,2 -i[3] 1,$nbp,1,1,5
-i[6] 1,$nbp,1,1,{!$2} -a[3-6] x -columns[3] 0,5
-y[3]
-rows[4] 0,{3*$nbp-1} -rows[5] 0,{$nbp-1} -a y
-endif
-endl -done -v +
colorcube3d :
-e[^-1] "Input 3d RGB-color cube."
-v -
(67.5;73.5;109.5;103.5;51.5;100.5;8;6)
(0;0;0;\
255;0;0;\
255;255;0;\
0;255;0;\
0;0;255;\
255;0;255;\
255;255;255;\
0;255;255)
(12;0;3;2;1;0;0;0;63;63;63;63;0;\
12;1;2;6;5;0;0;0;63;63;63;63;0;\
12;0;4;7;3;0;0;63;0;63;63;0;63;\
12;4;5;6;7;0;0;63;0;63;63;0;63;\
12;0;1;5;4;0;0;63;0;63;63;0;63;\
12;3;7;6;2;0;0;0;63;63;63;63;0)
(0,255;0,255^0,0;255,255^0,0;0,0)
(255,255;255,255^0,0;255,255^0,255;0,255)
(0,0;0,0^0,0;255,255^0,255;0,255)
(0,255;0,255^0,0;255,255^255,255;255,255)
(0,255;0,255^0,0;0,0^0,0;255,255)
(0,255;0,255^255,255;255,255^0,0;255,255)
-r[-6--1] 64,64,1,3,3 -y[-6--1] -i[-7--2] (-128;64;64;3)
(1;1;1;1;1;1)
-a[-16--1] y -nm[-1] [3d\ colorcube]
-v +
cone3d : -check ${3=24}>0 -skip ${1=1},${2=1}
-e[^-1] "Input 3d cone, with radius $1, height $2 and $3 subdivisions."
-v -
(67.5;73.5;109.5;103.5;51.5;100.5)
({$3+2};{2*$3})
(0,0,0;0,0,$2)
(0;{2*pi}) -r[-1] 1,{$3+1},1,1,3 -rows[-1] 0,{$3-1} --sin[-1] -cos[-2] -*[-2,-1] $1 -a[-2,-1] x -z[-1] 0,2 -a[-2,-1] y
1,$3,1,1,'y' --shift[-1] 0,-1 -+[-2,-1] 2
2,$3,1,1,3,0 [-2] [-4] -a[-3--1] x
-i[-4] 2,$3,1,1,3,1 -a[-4--2] x
-a[-2,-1] y
3,{h},1,1,200
1,{h},1,1,1
-y[-4--2] -a[-6--1] y -nm[-1] [3d\ cone]
-v +
cubes3d : -check ${1=1}>=0
-e[^-1] "Convert 3d object$? to sets of 3d cubes with size $1."
-v - -p3d 0 -repeat @# -l[$>]
nbv=@{-1,6} nbp=@{-1,7}
-if {$nbv&&$nbp}
-s3d
-l[1] -= {8*i[0]} -= {6*i[1]},0,1 -endl
-l[2] -r 3,{h/3},1,1,-1
half={$1/2}
-- '$half,0,0' --+ '$1,0,0' -a x
-- '0,$half,0' --+ '0,$1,0' -a x
-- '0,0,$half' --+ '0,0,$1' -a x
-endl
-l[3] -r 2,{h/2},1,1,-1
-z 1,1 -* 8 -r 4,100% -i[0] 1,100%,1,1,4 -a x [-1]x5 -a x
-+ '"0,0,2,3,1, 0,4,5,7,6, 0,0,1,5,4, 0,2,6,7,3, 0,0,4,6,2, 0,1,3,7,5"'
-endl
-l[4] -r 3,{h/3},1,1,-1 -r 18,100%,1,1,0,2 -endl -r[5] 6,100%
-y -a y
-endif
-endl -done -v +
cup3d : -check ${1=128}>0
-e[^-1] "Input 3d cup, with resolution $1."
-v -
100,200
-ellipse[-1] 0%,0%,40%,40%,0,1,1
-ellipse[-1] 0,0,35%,35%,0,1,0
-polygon[-1] 4,0,45%,8%,45%,20%,90%,0,90%,1,1
-ellipse[-1] 0%,100%,30%,10%,0,1,1 -b[-1] 0.1%
-lathe3d[-1] $1,2 -nm[-1] [3d\ cup]
-v +
cylinder3d : -check ${3=24}>0 -skip ${1=1},${2=1}
-e[^-1] "Input 3d cylinder, with radius $1, height $2 and $3 subdivisions."
-v -
(67.5;73.5;109.5;103.5;51.5;100.5)
({2*$3+2};{3*$3})
(0,0,0;0,0,$2)
(0;{2*pi}) -r[-1] 1,{$3+1},1,1,3 -rows[-1] 0,{$3-1} --sin[-1] -cos[-2] -*[-2,-1] $1 -a[-2,-1] x
--z[-1] 0,2 1,$3,1,1,$2 -a[-3,-1] x
-a[-3--1] y
1,$3,1,1,'y' --shift[-1] 0,-1 -+[-2,-1] 2
2,$3,1,1,3,1 [-3] [-3] -a[-3--1] x
2,$3,1,1,3,0 [-3] [-5] -+[-2,-1] $3 -a[-3--1] x
--+[-4,-3] $3 -i[-7] 1,$3,1,1,4 -rv[-6,-5] -a[-7--5,-2,-1] x
3,{3*$3},1,1,200
1,{h},1,1,1
-y[-6--2] -a[-8--1] y -nm[-1] [3d\ cylinder]
-v +
delaunay3d :
-e[^-1] "Generate 3d delaunay triangulation from image$?."
-v - -repeat @# -l[$>]
-channels 0 -neq 0
whd={w},{h},{d} --r 1,{w*h*d},1,1,-1 -cumulate[-1] -*[-1] [-2] -r[-1] $whd,1,-1
--distance[0] 1 -*[2] -1 -watershed[1] [2] -rm[2]
-r[1] 100%,100%,100%,3
-if {d>1}
--_delaunay3d[1] 1,0,0,0,0,1 --_delaunay3d[1] -1,0,0,0,0,-1
--_delaunay3d[1] 0,1,0,0,0,1 --_delaunay3d[1] 0,-1,0,0,0,-1
-endif
--_delaunay3d[1] 1,0,0,0,1,0 -_delaunay3d[1] -1,0,0,0,-1,0
-a[^0] x -transpose[-1] --[-1] 1
-pointcloud3d[0]
-s3d[0] -rm[3-5] -i[-2] 1,100%,1,1,3 -a[-2,-1] x
3,100%,1,1,200 1,100%,1,1,1 -=[1] {h},0,1 -y -a y
-endl -done -v +
_delaunay3d :
-f[-1] "A=j($1,$2,$3,0,0,1); B=j($4,$5,$6,0,0,1);
if (i!=A && i!=B && A!=B, kth(1+c,i,A,B),0)"
-discard[-1] 0 -r[-1] {h/3},3,1,1,-1
distribution3d :
-e[^-1] "Get 3d color distribution of image$?."
-v - -to_rgb -permute "cxyz" -y
-repeat @# -l[$>]
nbp={round(h/3)}
-i[-2] (67.5;73.5;109.5;103.5;51.5;100.5;\
$nbp;$nbp)
1,$nbp,1,1,1 --f[-1] y -a[-2,-1] x -y[-1]
[-2]
1,$nbp,1,1,1
-a y -nm[-1] [3d\ distribution]
-endl -done -v +
empty3d :
-e[^-1] "Input empty 3d object."
-v - (67.5;73.5;109.5;103.5;51.5;100.5;0;0) -nm[-1] [3d\ empty] -v +
extrude3d : -check "${1=16}>0 && ${2=1024}>0 && ${3=0.5%}>=0"
-e[^-1] "Generate extruded 3d object from XY-profile$?, with depth $1, resolution $2 and smoothness $3."
-v - -norm -n 0,1 -autocrop 0 -repeat @# -l[$>] nm=@{0,n}
wr={round(max(1,if(w>h,min($2,w),min($2,h)*w/h)))}
hr={round(max(1,if(w>h,min($2,w)*h/w,min($2,h))))}
fact={$1/max(w/$wr,h/$hr)}
-b $3,0 -r $wr,$hr,1,1,2 -expand_xyz 1,0
-isosurface3d 50% -*3d 1,1,$fact -rv3d
-nm $nm -endl -done -v +
gaussians3d : -check "${1=32}>0" -skip ${2=0.3}
-e[^-1] "Convert 3d object$? into sets of gaussian-shaped 3d sprites, with size $1 and opacity $2."
-v - -p3d 2 -p3d 0 -repeat @# -l[$>] nm=@{0,n} -s3d
nbv={h} -rm[-1] (-128;$1;$1;1)
$1,$1 -gaussian[-1] 35%,35%,0 -c[-1] 30%,100% -n[-1] 0,$2 -y[-1] -a[-2,-1] y
-if {$nbv>1} 4,{$nbv-1},1,1,-128,0,0,0 -y[-2,-1] -a[-2,-1] y -endif
-a y
-nm $nm -endl -done -v +
gmic3d :
-e[^-1] "Input 3d G\47MIC logo."
-v -
-text3d G,60,20,2 -col3d[-1] 16,64,255
-text3d \',60,20,2 -+3d[-1] 40 -col3d[-1] 64,128,255
-text3d M,60,20,2 -+3d[-1] 50 -col3d[-1] 96,196,255
-text3d I,60,20,2 -+3d[-1] 90 -col3d[-1] 64,128,255
-text3d C,60,20,2 -+3d[-1] 100 -col3d[-1] 16,64,255
-sphere3d 8 -+3d[-1] 102,-3,15 -col3d[-1] 192,128,255
-+3d[-6--1] -c3d[-1]
-repeat 30
-box3d {min(3+@{<,-1}/2,10)} -col3d[-1] {30*$>},{20+80*$>},{10*$>},0.5
-r3d[-1] 1,1,1,{$>*12}
-+3d[-1] {80*cos(0.5+1.02*$>*12*pi/180)},{30*sin(0.8+$>*12*pi/180)},{2*$>-60}
-done
-+3d[-30--1] -+3d[-1] 0,5,30 -+3d[-2--1] -nm[-1] [3d\ gmic]
-v +
gyroid3d : -check ${1=32}>0 -skip ${2=5}
-e[^-1] "Input 3d gyroid, with resolution $1 and range $2."
-v -
-isosurface3d "'0.49*(\
cos( 2*x + y + z - pi) + cos( 2*x - y + z - pi)\
+ cos(- 2*x + y - z - pi) + cos(- 2*x - y - z - pi)\
+ cos( x + 2*y + z - pi) + cos( x + 2*y - z - pi)\
+ cos(- x - 2*y + z - pi) + cos(- x - 2*y - z - pi)\
+ cos( x + y + 2*z - pi) + cos(- x + y + 2*z - pi)\
+ cos( x - y - 2*z - pi) + cos(- x - y - 2*z - pi)\
+ cos(- 2*x + y + z) + cos( 2*x + y - z)\
+ cos(- 2*x - y + z) + cos( 2*x - y - z)\
+ cos(- x + 2*y + z) + cos( x - 2*y + z)\
+ cos(- x + 2*y - z) + cos( x - 2*y - z)\
+ cos( x - y + 2*z) + cos( x + y - 2*z)\
+ cos(- x - y + 2*z) + cos(- x + y - 2*z)\
) + 0.27*( \
cos(- 2*x + 2*y - pi) + cos( 2*x - 2*y - pi)\
+ cos( 2*x + 2*y - pi) + cos(- 2*x - 2*y - pi)\
+ cos(- 2*y + 2*z - pi) + cos( 2*y - 2*z - pi)\
+ cos( 2*y + 2*z - pi) + cos(- 2*y - 2*z - pi)\
+ cos(- 2*z + 2*x - pi) + cos( 2*z - 2*x - pi)\
+ cos( 2*z + 2*x - pi) + cos(- 2*z - 2*x - pi)\
) - 0.69'",0,{-$2},{-$2},{-$2},$2,$2,$2,$1,$1,$1
-c3d[-1] -n3d[-1] -nm[-1] [3d\ gyroid]
-v +
histogram3d :
-e[^-1] "Get 3d color histogram of image$?."
-v - -to_rgb -repeat @# -l[$>]
-r {w*h},3,1,1,-1 -pointcloud 1 -n 0,255 -map 3 -pointcloud3d -nm "[3d histogram]"
-endl -done -v +
image6cube3d :
-e[^-1] "Generate 3d mapped cubes from image$?."
-v - M={max(@{-max_wh})} -r $M,$M,1,3 -imageplane3d -n3d -c3d -repeat {int(@#/6)}
-+3d[-6] 0,0,-0.5
-r3d[-5] 1,0,0,180 -+3d[-5] 0,0,0.5
-r3d[-4] 0,1,0,-90 -+3d[-4] -0.5,0,0
-r3d[-3] 0,1,0,90 -+3d[-3] 0.5,0,0
-r3d[-2] 1,0,0,90 -+3d[-2] 0,-0.5,0
-r3d[-1] 1,0,0,-90 -+3d[-1] 0,0.5,0
-+3d[-6--1] -nm[-1] "[3d image cube]"
-mv[-1] 0 -done -v +
imageblocks3d : -check ${2=0}>=0 -skip ${1=10},${3=0}
-e[^-1] "Generate 3d blocks from image$?, with maximum elevation $1 and smoothness $2."
-v - -repeat @# -l[$>]
w={w} h={h}
-split_opacity -to_rgb[0] is_opacity={@#==2}
-l[] -box3d 1,1,0
-repeat {$w-1} --+3d[-1] 1,0,0 -done -+3d
-repeat {$h-1} --+3d[-1] 0,1,0 -done -+3d
-endl
-s3d[-1]
--norm[0] -b[-1] $2
-y[-1] -n[-1] 0,$1
-r[-5] 24,@{-5,round(w*h/24)},1,1,-1
-if {$1<0} -j[-5] [-1],2 -j[-5] [-1],5 -j[-5] [-1],8 -j[-5] [-1],11
-else -j[-5] [-1],14 -j[-5] [-1],17 -j[-5] [-1],20 -j[-5] [-1],23
-endif
-rm[-1] -y[-4]
-rm[-2] -r[0] @{0,w*h},1,1,100%,-1 -permute[0] cxyz -r[0] 600%,100%,1,1,0,2 -y[0] -mv[0] -1
-if $is_opacity -rm[-1] -mv[0] @# -/[-1] 255 -y[-1] -r[-1] 6,100%,1,1 -y[-1] -endif
-a y
-endl -done -v +
imagecube3d :
-e[^-1] "Generate 3d mapped cubes from image$?."
-v - -slices 50% -to_rgb -repeat @# -l[$>] nm=@{0,n}
-i[-2] (67.5;73.5;109.5;103.5;51.5;100.5;\
8;6;\
-0.5;-0.5;-0.5;\
0.5;-0.5;-0.5;\
0.5;0.5;-0.5;\
-0.5;0.5;-0.5;\
-0.5;-0.5;0.5;\
0.5;-0.5;0.5;\
0.5;0.5;0.5;\
-0.5;0.5;0.5;\
12;0;3;2;1;0;0;0;{h};{w};{h};{w};0;\
12;1;2;6;5;0;0;0;{h};{w};{h};{w};0;\
12;5;6;7;4;0;0;0;{h};{w};{h};{w};0;\
12;4;7;3;0;0;0;0;{h};{w};{h};{w};0;\
12;4;0;1;5;0;0;0;{h};{w};{h};{w};0;\
12;3;7;6;2;0;0;0;{h};{w};{h};{w};0;\
-128;{w};{h};{s})
-y[-1]
(-128;0;0;0;-128;0;0;0;-128;0;0;0;-128;0;0;0;-128;0;0;0;1;1;1;1;1;1)
-a y
-nm $nm -endl -done -v +
imageplane3d :
-e[^-1] "Generate 3d mapped planes from image$?."
-v - -slices 50% -to_color -repeat @# -l[$>] nm=@{0,n}
-i[-2] (67.5;73.5;109.5;103.5;51.5;100.5;\
4;1;\
0;0;0;\
{w};0;0;\
{w};{h};0;\
{0};{h};0;\
12;0;3;2;1;0;0;0;{h};{w};{h};{w};0;\
-128;{w};{h};{s})
-y[-1]
(1)
-a y
-nm $nm -endl -done -v +
imagepyramid3d :
-e[^-1] "Generate 3d mapped pyramids from image$?."
-v - -to_rgb -repeat @# -l[$>] nm=@{0,n}
w2={w/2}
-i[-2] (67.5;73.5;109.5;103.5;51.5;100.5;\
5;5;\
-0.5;-0.5;-0.5;\
0.5;-0.5;-0.5;\
0.5;0.5;-0.5;\
-0.5;0.5;-0.5;\
0;0;0.5;\
12;0;3;2;1;0;0;0;{h};{w};{h};{w};0;\
9;0;4;3;0;{h};$w2;0;{w};{h};\
9;1;4;0;0;{h};$w2;0;{w};{h};\
9;2;4;1;0;{h};$w2;0;{w};{h};\
9;3;4;2;0;{h};$w2;0;{w};{h};\
-128;{w};{h};{s})
-y[-1]
(-128;0;0;0;-128;0;0;0;-128;0;0;0;-128;0;0;0;1;1;1;1;1)
-a y
-nm $nm -endl -done -v +
imagerubik3d : -check "${1=3}>=1 && ${2=5}>=0 && $2<=100 && ${3=5}>=0 && $3<=100"
-e[^-1] "Generate 3d mapped rubik\47s cubes from image$? with $1 xy-tiles, xy-shift $2 and z-shift $3."
-v - -repeat @# -l[$>] nm=@{0,n}
({'CImg3d'}) -+[-1] 0.5
(8,5)
(0,0,0;\
100,0,0;\
100,100,0;\
0,100,0;\
$2,$2,{-$3};\
{100-$2},$2,{-$3};\
{100-$2},{100-$2},{-$3};\
$2,{100-$2},{-$3})
(4,4,7,6,5;\
4,0,4,5,1;\
4,3,2,6,7;\
4,0,3,7,4;\
4,1,5,6,2)
3,5,1,1,200
1,5,1,1,1
-y[-6--1] -a[-6--1] y
-repeat {$1-1} --+3d[-1] 100 -done -+3d[-$1--1]
-repeat {$1-1} --+3d[-1] 0,100 -done -+3d[-$1--1]
-t3d[-1] [-2] -rm[-2]
-/3d[-1] $1 --3d[-1] 50,50,50
--r3d[-1] 0,1,0,-90 --r3d[-1] 0,1,0,-90 --r3d[-1] 0,1,0,-90
--r3d[-1] 0,0,1,-90 --r3d[-1] 0,0,1,180
-+3d
-nm $nm -endl -done -v +
imagesphere3d : -check "${1=32}>=3 && ${2=16}>=3"
-e[^-1] "Generate 3d mapped sphere from image$?, with resolutions ($1,$2)."
-v - -to_rgb -repeat @# -l[$>] nm=@{0,n}
tw={w-1} th={h-1}
nbv={2+$1*($2-2)}
nbp={$1*($2-1)}
(67.5;73.5;109.5;103.5;51.5;100.5;\
$nbv;$nbp)
(0;0;1) (0;0;-1) (0,{2*pi};0,{2*pi}^0,0;{pi},{pi})
-r[-1] {$1+1},$2,1,2,3 -z[-1] 0,1,{w-2},{h-2} -s[-1] c
--sin[-1] --sin[-3] -*[-2,-1] --cos[-2] -sin[-3] -cos[-4] -*[-4,-3]
-a[-3--1] c -permute[-1] cxyz -y[-1] -a[-3--1] y
-repeat $1
tx0={$>*$tw/$1} tx1={($>+1)*$tw/$1} ty1={$th/($2-1)}
(9;0;{2+$>};{2+($>+1)%$1};{$tw/2};0;$tx0;$ty1;$tx1;$ty1)
-repeat {$2-3}
ty0=$ty1 ty1={($>+2)*$th/($2-1)} i0={2+$>*$1+@{>,-2}} i1={2+$>*$1+(@{>,-2}+1)%$1}
(12;$i0;{$i0+$1};{$i1+$1};$i1;$tx0;$ty0;$tx0;$ty1;$tx1;$ty1;$tx1;$ty0)
-done
(9;1;{2+$1*($2-3)+($>+1)%$1};{2+$1*($2-3)+$>};{$tw/2};$th;$tx1;$ty1;$tx0;$ty1)
-done
-a[-$nbp--1] y
-mv[-4] @# -i[-2] (-128;{w};{h};3) -y[-1] 1,{4*($nbp-1)},1,1,-128,0,0,0 1,$nbp,1,1,1 -a y
-nm $nm -endl -done -v +
label_points3d : -check ${1=13}>0 -skip ${2=0.8}
-e[^-1] "Label vertices of 3d object$?."
-v - -repeat @#
--p3d[$>] 0 -l[-1] -s3d -rm[-3--1]
nbp=@{-2,0} -=[-2] $nbp,0,1
(1,0;1,{$nbp-1}) -r[-1] 2,$nbp,1,1,3 -r[-1] 1,{2*h},1,1,-1
-repeat $nbp
0 -t[-1] $>,0,0,$1,1,255,255,255 -autocrop[-1] 0
-i[-2] (-128;{w};{h};3) -y[-1]
-done
-repeat $nbp
0 -t[-1] $>,0,0,$1,1,$2 -autocrop[-1] 0
-i[-2] (-128;{w};{h};1) -y[-1]
-done
-a y
-endl
-+3d[$>,-1]
-done -v +
lathe3d : -check "${1=128}>0 && ${2=0.5%}>=0 && ${3=361}>=0"
-e[^-1] "Generate lathed 3d object from XY-profile$?, with resolution $1, smoothness $2 and maximum angle $3 deg."
-v - tmax={($3-180)*pi/180} -norm -n 0,1 -autocrop 0 -repeat @# -l[$>]
wr={max(1,w2=2*w;if(w2>h,min($1,w2),min($1,h)*w2/h))}
hr={max(1,w2=2*w;if(w2>h,min($1,w2)*h/w2,min($1,h)))}
rmax={sqrt(($wr)^2+($hr)^2)/2}
$wr,1,$wr,1,"xc=x-w/2; zc=z-d/2; t=atan2(zc,xc); if(t>"$tmax","$rmax",sqrt(xc*xc+zc*zc))"
-*[-1] {2*(@{-2,w}-1)/(w-1)} -r[-1] $wr,$hr,$wr
(0;{@{-2,h}-1}) -r[-1] $wr,$hr,$wr,1,3 -a[-2--1] c
-warp[-2] [-1],0,1,0 -rm[-1]
-expand_xyz 10,0 -b $2 -isosurface3d 50% -rv3d
-endl -done -v +
line3d :
-e[^-1] "Input 3d line (${1-3})-(${4-6})."
-v - 1,21,1,1,67.5,73.5,109.5,103.5,51.5,100.5,2,1,${1-6},2,0,1,200,200,200,1 -nm[-1] [3d\ line] -v +
lissajous3d : -check ${1=1024}>1 -skip ${2=2},${3=0},${4=1},${5=0},${6=0},${7=0}
-e[^-1] "Input 3d lissajous curve, with resolution $1, (a,A)=($2,$3), (b,B)=($4,$5) and (c,C)=($6,$7)."
-v -
res={round($1)}
(67.5;73.5;109.5;103.5;51.5;100.5;$res;{$res-1})
(0,{2*pi}) -r[-1] $res,1,1,1,3 [-1]x2
-*[-3] $2 -+[-3] {$3*2*pi} -*[-2] $4 -+[-2] {$5*2*pi} -*[-1] $6 -+[-1] {$7*2*pi}
-a[-3--1] y -sin[-1] -transpose[-1] -r[-1] 1,{w*h},1,1,-1
1,{$res-1},1,1,2 (0;{$res-2}) -r[-1] 1,{$res-1},1,1,3 --+[-1] 1 -a[-3--1] x -round[-1] 1 -r[-1] 1,{w*h},1,1,-1
1,{3*($res-1)},1,1,200 1,{$res-1},1,1,1 -a[-5--1] y -nm[-1] [3d\ lissajou]
-v +
n3d :
-_normalize3d
normalize3d :
-_$0
_normalize3d :
-e[0--3] "Normalize size of 3d object$?."
-v - -check3d 0 -repeat @# -l[$>]
-if {i[6]}
-s3d -r[2] 3,@{2,h/3},1,1,-1 -s[2] x
factor={v=max(@{2,iM-im},@{3,iM-im},@{4,iM-im});if(v,v,1)}
-a[2-4] x -/[2] $factor -y[2] -a y
-endif
-endl -done -v +
parametric3d : -skip "${1=(2+cos(b))*sin(a)}","${2=(2+cos(b))*cos(a)}","${3=sin(b)}"
-skip ${4={-pi}},${5={pi}},${6={-pi}},${7={pi}}
-check "${8=512}>0 && ${9=$8}>0 && ${10=64}>0 && ${11=$10}>0 && ${12=$11}>0 && \
${13=2%}>=0 && ${14=10%}>=0"
-e[^-1] "Input 3d object from parametric surface ($1,$2,$3)."
-v -
($4,$5;$4,$5^$6,$6;$7,$7) -r[-1] $8,$9,1,2,3 -channels[-1] 0,2
-f[-1] "a=i(x,y,0,0);b=i(x,y,0,1);if(c==0,$1,if(c==1,$2,$3))"
-sh[-1] 0,0 xmin={im} xmax={iM} -n[-1] 16,{$10-17} -rm[-1]
-sh[-1] 1,1 ymin={im} ymax={iM} -n[-1] 16,{$11-17} -rm[-1]
-sh[-1] 2,2 zmin={im} zmax={iM} -n[-1] 16,{$12-17} -rm[-1]
-r[-1] {w*h},3,1,1,-1
-pointcloud[-1] 1 -r[-1] $10,$11,$12,1,0 -b[-1] $13,0
-isosurface3d[-1] $14
-c3d[-1] -n3d[-1] -*3d[-1] {$xmax-$xmin},{$ymax-$ymin},{$zmax-$zmin} -nm[-1] [3d\ parametric]
-v +
pca_patch3d : -check "isint(${1=7}) && $1>0 && isint(${2=1000}) && $2>0 && isint(${3=3000}) && $3>0" -skip ${4=1},${5=0},${6=0}
-e[^-1] "Get 3d patch-pca representation"@{-arg\ 1+(@#>1),s,""}" of image$?, from $2 $1x$1 input patchs, "\
"with $3 output patchs, input normalization "@{-arg\ 1+!$4,enabled,disabled}", output normalization "\
@{-arg\ 1+!$5,enabled,disabled}" and lambda_xy $6."
-v -
P1={int($1/2)}
P2={$1-$P1-1}
-n 0,255 -round 1
-repeat @# -l[$>] nm=@{0,n}
s={s}
1,$2 -rand[-1] 0,@{0,w-1} --rand[-1] 0,@{0,h-1} --f[-1] 0 -a[-3--1] x -round[-1] 1 --patches[0] $1,$1,1,@-1 -y[2--1] -a[2--1] x
-z[1] 0,1 -transpose[1] -*[1] $6 -a[1,2] y -s[^0] x
--+[^0] -/[-1] $2 --[1--2] [-1] -rm[-1]
-a[^0] x
-if $4 -l[-1] -s y -/ 'sqrt(1e-8+iv)' -a y -endl -endif
--transpose[-1] -**[-2,-1]
-eigen[-1] -rows[-2] 0,2 -columns[-1] 0,2 -transpose[-1]
-if $5 -sqrt[-2] -/[-2] @{-2,M} -r[-2] [-1] -/[-1] [-2] -endif
-rm[-2]
-repeat $3
x={round(?(@{0,w}))}
y={round(?(@{0,h}))}
({$6*$x};{$6*$y})
--z[0] {$x-$P1},{$y-$P1},{$x+$P2},{$y+$P2},1
-y[-1] -a[-2,-1] y
-done
--a[2--1] x -**[1,-1] -transpose[1]
-rows[2--1] 2,100%
-if {$s!=3}
-r[2--1] $1,$1,1,{min(3,$s)},-1
-r[2--1] $1,$1,1,3,{if($s!=1,0,1)}
-y[2--1]
-endif
-i[2--2] (-128;$1;$1;3) -a[2--1] y
-rm[0]
-i[0] ({'CImg3d'})
-i[1] ($3;$3)
-i[3] 2,$3,1,1,if(x==0,1,y)
1,$3,1,1,1
-y -a[-6--1] y
-nm $nm -endl -done -v +
plane3d : -check "${3=24}>0 && ${4=24}>0" -skip ${1=1},${2=$1}
-e[^-1] "Input 3d plane, with size (${1,2}) and subdivisions (${3,4})."
-v - {$3+1},{$4+1} -elevation3d[-1] 0 -*3d[-1] {$1/$3},{$2/$4} -col3d[-1] 200 -nm[-1] [3d\ plane] -v +
point3d :
-e[^-1] "Input 3d point ($1,$2,$3)."
-v - 1,17,1,1,67.5,73.5,109.5,103.5,51.5,100.5,1,1,${1-3},1,0,200,200,200,1 -nm[-1] [3d\ point] -v +
pointcloud3d :
-e[^-1] "Convert image$? to 3d point clouds."
-v - -repeat @# -l[$>] nm=@{0,n}
-s z -repeat @# -l[$>]
--norm -!=[-1] 0
-i[-2] (1,{w};1,{w}^1,1;{h},{h}) -r[-2] [-1],[-1],1,2,3 -*[-2,-1] -round[-1] -permute[-1] cxyz
-l[-1] -s -,0 -a y is_points=@# -endl
-if $is_points
--[-1] 1 -r[-1] 2,{h/2},1,1,-1 -permute[-1] cyzx --warp[-2] [-1],0,0 -rm[-3]
-permute[-2] cyzx -i[-2] 1,{h},1,1,$> -a[-3,-2] x
-i[-3] ({'CImg3d'}) -i[-3] ({h},{h})
-i[-2] 1,{h},1,1,1 -i[-2] 1,{h},1,1,y -a[-3,-2] x
-permute[-1] cyzx
-if {w==1} -r[-1] 3,{h},1,1
-elif {w>3} -i[-2] 4,{h},1,1,-128,1,1,{w} -a[-2,-1] x
-else -r[-1] 3,{h},1,1,0
-endif
1,{h},1,1,1
-y[-6--1] -a[-6--1] y
-else -rm -empty3d
-endif
-endl -done
-+3d
-nm $nm -endl -done -v +
pose3d :
-e[^-1] "Apply 3d pose matrix [ $1,$2,$3,$4; $5,$6,$7,$8; $9,$10,$11,$12 ] to 3d object$?."
-v - -repeat @# -l[$>] -if @{-is_3d}
-s3d -r[2] 3,@{2,h/3},1,1,-1 -i[3] 1,@{2,h},1,1,1 -a[2,3] x
-i[3] ($1,$5,$9;$2,$6,$10;$3,$7,$11;$4,$8,$12) -**[2,3]
-r[2] 1,@{2,3*h},1,1,-1 -a y
-else -error "Command '-pose3d': Image ["{@#-$>-1}"] does not represent a 3d object."
-endif -endl -done -v +
projections3d : -skip ${1=50%},${2=50%},${3=50%},${4=1}
-e[^-1] "Generate 3d xy,xz,yz projection planes from image$?."
-v - -n 0,255 -repeat @# -l[$>]
w={w} h={h} d={d}
x={if(@{-is_percent\ $1},$1*w,$1)}
y={if(@{-is_percent\ $2},$2*h,$2)}
z={if(@{-is_percent\ $3},$3*d,$3)}
--rows $2,$2 -r[-1] {w},{d},1,100%,-1
--columns[-2] $1,$1 -permute[-1] zyxc
-slices[-3] $3,$3 -r[-3--1] 100%,100%,1,3
-imageplane3d[-3--1]
-r3d[-1] 0,1,0,90 -r3d[-2] 1,0,0,-90
-+3d[-3] 0,0,$z -+3d[-2] 0,$y,0 -+3d[-1] $x,0,0
-+3d[-3--1] -o3d[-1] 0.8
-if $4 -box3d $w,$h,$d -p3d[-1] 1 -o3d[-1] 0.4 -+3d[-2,-1] -endif
-endl -done -v +
pyramid3d :
-e[^-1] "Input new 3d pyramid, with width $1 and height $2."
-v -
(67.5;73.5;109.5;103.5;51.5;100.5;\
5;5;\
{-$1/2};{-$1/2};{-$2/2};\
{$1/2};{-$1/2};{-$2/2};\
{$1/2};{$1/2};{-$2/2};\
{-$1/2};{$1/2};{-$2/2};\
0;0;{$2/2};\
4;0;3;2;1;\
3;0;4;3;\
3;1;4;0;\
3;2;4;1;\
3;3;4;2)
1,15,1,1,200 1,5,1,1,1 -a[-3--1] y -nm[-1] [3d\ pyramid]
-v +
quadrangle3d :
-e[^-1] "Input 3d quadrangle ($1,$2,$3)-($4,$5,$6)-($7,$8,$9)-($10,$11,$12)."
-v - 1,29,1,1,67.5,73.5,109.5,103.5,51.5,100.5,4,1,${1-12},4,0,1,2,3,200,200,200,1 -nm[-1] [3d\ quadrangle] -v +
rotation3d :
-e[^-1] "Input 3d rotation matrix around axis ($1,$2,$3) with angle $4 deg."
-v -
($1^$2^$3^0) -orientation[-1] -y[-1] x -*[-1] {sin($4*pi/360)} -=[-1] {cos($4*pi/360)},3
xx={i(0)*i(0)} xy={i(0)*i(1)} xz={i(0)*i(2)} xw={i(0)*i(3)}
yy={i(1)*i(1)} yz={i(1)*i(2)} yw={i(1)*i(3)}
zz={i(2)*i(2)} zw={i(2)*i(3)}
-rm[-1]
({1-2*($yy+$zz)},{2*($xy+$zw)},{2*($xz-$yw)};\
{2*($xy-$zw)},{1-2*($xx+$zz)},{2*($yz+$xw)};\
{2*($xz+$yw)},{2*($yz-$xw)},{1-2*($xx+$yy)})
-nm[-1] [3d\ rotation]
-v +
sierpinski3d : -check ${1=4}>=0 -skip ${2=1},${3=1}
-e[^-1] "Input 3d Sierpinski pyramid of degree $1, with width $2 and height $3."
-v - -l[] -_sierpinski3d {-$2/2},{-$2/2},{-$3/2},{$2/2},{-$2/2},{-$3/2},{$2/2},{$2/2},{-$3/2},{-$2/2},{$2/2},{-$3/2},0,0,{$3/2},$1 -+3d -endl
-nm[-1] [3d\ sierpinski] -v +
_sierpinski3d :
-if {$16<=0}
(67.5;73.5;109.5;103.5;51.5;100.5;\
5;5;\
$1;$2;$3;\
$4;$5;$6;\
$7;$8;$9;\
$10;$11;$12;\
$13;$14;$15;\
4;0;3;2;1;\
3;0;4;3;\
3;1;4;0;\
3;2;4;1;\
3;3;4;2)
1,15,1,1,200 1,5,1,1,1 -a[-3--1] y
-return -endif
-_sierpinski3d $1,$2,$3,\
{($1+$4)/2},{($2+$5)/2},{($3+$6)/2},\
{($1+$4+$7+$10)/4},{($2+$5+$8+$11)/4},{($3+$6+$9+$12)/4},\
{($1+$10)/2},{($2+$11)/2},{($3+$12)/2},\
{($1+$13)/2},{($2+$14)/2},{($3+$15)/2},\
{$16-1}
-_sierpinski3d {($1+$4)/2},{($2+$5)/2},{($3+$6)/2},\
$4,$5,$6,\
{($4+$7)/2},{($5+$8)/2},{($6+$9)/2},\
{($1+$4+$7+$10)/4},{($2+$5+$8+$11)/4},{($3+$6+$9+$12)/4},\
{($4+$13)/2},{($5+$14)/2},{($6+$15)/2},\
{$16-1}
-_sierpinski3d {($1+$4+$7+$10)/4},{($2+$5+$8+$11)/4},{($3+$6+$9+$12)/4},\
{($4+$7)/2},{($5+$8)/2},{($6+$9)/2},\
$7,$8,$9,\
{($7+$10)/2},{($8+$11)/2},{($9+$12)/2},\
{($7+$13)/2},{($8+$14)/2},{($9+$15)/2},\
{$16-1}
-_sierpinski3d {($1+$10)/2},{($2+$11)/2},{($3+$12)/2},\
{($1+$4+$7+$10)/4},{($2+$5+$8+$11)/4},{($3+$6+$9+$12)/4},\
{($7+$10)/2},{($8+$11)/2},{($9+$12)/2},\
$10,$11,$12,\
{($10+$13)/2},{($11+$14)/2},{($12+$15)/2},\
{$16-1}
-_sierpinski3d {($1+$13)/2},{($2+$14)/2},{($3+$15)/2},\
{($4+$13)/2},{($5+$14)/2},{($6+$15)/2},\
{($7+$13)/2},{($8+$14)/2},{($9+$15)/2},\
{($10+$13)/2},{($11+$14)/2},{($12+$15)/2},\
$13,$14,$15,\
{$16-1}
size3d :
-v - --rows[-1] 8,{8+3*i[6]} -r[-1] 3,{h/3},1,1,-1 -s[-1] x,3
-u @{-3,(iM-im)},@{-2,(iM-im)},@{-1,(iM-im)}
-rm[-3--1] -v +
skeleton3d : -check "isint(${1=2}) && $1>=0 && $1<=2 && isint(${2=3}) && $2>=0 && $2<=3" -skip ${3=1},${4=0.1},${5=1}
-e[^-1] "Build 3d skeletal structure object from image$?, with "@{-arg\ 1+$1,chebyshev,manhattan,euclidean}" metric, "\
@{-arg\ 1+$2,squares,diamonds,circles,auto}" bones, skeleton opacity $3 and frame opacity $4 ."
-v - -repeat @# -l[$>] -channels 0
--distance 0,$1
--f[-1] "(i>j(-1)&&i>j(1)) || (i>j(0,-1)&&i>j(0,1)) || (i>j(-1,-1)&&i>j(1,1)) || (i>j(-1,1)&&i>j(1,-1))"
-if $3 --slices[-1] -1,0 -isosurface3d[-1] 0.5 -o3d[-1] $3 -col3d[-1] 255,0,0 -endif
-*[0-2] -pointcloud3d[0]
-if $4 -l[0] -s3d 1
n=@{1,0}
-if $n
-r[2] 3,$n,1,1,-1 -r[3] 2,$n,1,1,-1 -r[4] 3,$n,1,1,-1
-if {$2==0" || "($2==3" && "$1==0)}
-=[1] {4*$n}
-i[3] [2]x3 --z[-2] 0,1 -z[-1] 0,2 --[2] [-1] -+[4] [-1]
-s[-1] x -*[-2] -1 -a[-3--1] x -+[3] [-1] --[5,-1] -a[2-5] x
-rm[3] 1,$n,1,1,4 --f[-1] 4*y --+[-1] 1 --+[-1] 1 --+[-1] 1 -rv[-3,-1] -a[-5--1] x -mv[-1] 3
-elif {$2==1" || "($2==3" && "$1==1)}
-=[1] {4*$n}
-i[3] [2]x3 --z[-2] 0,0 -z[-1] 0,2 --[2] [-1] -+[4] [-1]
-shift[-1] 1,0 --[3] [-1] -+[5,-1] -a[2-5] x
-rm[3] 1,$n,1,1,4 --f[-1] 4*y --+[-1] 1 --+[-1] 1 --+[-1] 1 -rv[-3,-1] -a[-5--1] x -mv[-1] 3
-elif {$2==2" || "($2==3" && "$1==2)}
-=[1] {2*$n}
--z[4] 0,0 -z[-1] 0,2 --+[2,-1] --[2,-2] -a[2,-1] x
-rm[3] 1,$n,1,1,5 --f[-1] 2*y --+[-1] 1 3,100% -a[-4--1] x -mv[-1] 3
-endif
-y -a y -o3d $4 -if $5 -p3d 1 -endif -col3d 200
-else -rm -empty3d -endif
-endl -else -rm[0] -endif
-+3d
-endl -done -v +
snapshot3d : -check "${2=1}>=0" -skip ${1=512},${3=""}
-if @{"-is_image_arg $1"}
-e[0--3] "Take $1x$1 snapshot$? of 3d object$?, with zoom factor $2 and background image $3."
-v - -pass$1 0 -to_color[-1]
-elif {isval($3)}
-e[0--3] "Take $1x$1 snapshot$? of 3d object$?, with zoom factor $2 and background color ${3--1}."
-v - (${3--1}) -y[-1] c -r[-1] $1,$1 -to_color[-1]
-else
-e[0--3] "Take $1x$1 snapshot$? of 3d object$?, with zoom factor $2 and default background."
-v - 1,2,1,3,32,64,32,116,64,96 -r[-1] $1,$1,1,3,3
-endif
-repeat {@#-1} [-1] -l[$>,-1]
-if {$2!=0} -c3d[0] -n3d[0] -*3d[0] {3*min(w,h)*$2/4} -endif
-if {s>3}
100%,100%,1,3,-1 -j3d[-1] [0],50%,50%,0,1
-to_rgba[-1] -replace_color[-1] 0,0,-1,-1,-1,255,0,0,0,0 -blend[-2,-1] alpha
-else
-j3d[1] [0],50%,50%,0,1
-endif
-nm[1] @{-2,n} -rm[0]
-endl -done -rm[-1] -v +
spherical3d : -check "${1=64}>=3 && ${2=$1}>=3" -skip "${3=abs(1+0.5*cos(3*phi)*sin(4*theta))}"
-e[^-1] "Input 3d spherical object, with subdivisions ($1,$2) and height function '$3'."
-v -
({'CImg3d'}) -y[-1]
n1={round($1)} n2={round($2)}
$n1,{$n2-1},1,3,"phi=2*pi*(x+0.5)/w;\
theta=-pi/2+pi*(y+0.5)/h;\
cp=cos(phi);\
sp=sin(phi);\
ct=cos(theta);\
($3)*if(c==0,ct*cp,if(c==1,ct*sp,sin(theta)))"
-r[-1] {w*h},3,1,1,-1 -permute[-1] yxzc
-i[-2] (0,0,{phi=0;theta=-pi/2;-$3};0,0,{phi=0;theta=pi/2;$3}) -a[-2,-1] y
nbv={h} -y[-1]
$n1,{$n2-2},1,4,"nx=(x+1)%w;ny=(y+1);2+if(c==0,x+y*"$n1",if(c==1,nx+y*"$n1",if(c==2,nx+ny*"$n1",x+ny*"$n1")))"
-r[-1] {w*h},4,1,1,-1 -permute[-1] yxzc -i[-2] 1,{h},1,1,4 -a[-2,-1] x
2,$n1,1,1,3,0 1,$n1,1,1,'y' --+[-1] 1 -%[-1] {h} 2,$n1,1,1,3,1 [-3,-2]
-+[-5,-4] 2 -rv[-5,-4] -+[-2,-1] {$nbv-$n1} -a[-3--1] x -a[-4--2] x
nbp={h+@{-2,h}+@{-3,h}}
-y[-3--1] -a[-3--1] y
-i[-3] ($nbv;$nbp)
1,{3*$nbp},1,1,200 1,$nbp,1,1,1 -a[-2,-1] y
-a[-5--1] y -nm[-1] "[3d spherical surface '$3']"
-v +
spline3d : -check ${13=128}>=2
-e[^-1] "Input new 3d spline from (${1-3}) [${4-6}] to (${7-9}) [${10-12}] with $13 vertices."
-v -
({'CImg3d'}) -+[-1] 0.5
($13;{$13-1})
1,$13,1,1,1 (0;1) -r[-1] 1,$13,1,1,3 --sqr[-1] --*[-2,-1] -a[-4--1] x
--*[-1] '$2,$5,{3*(($8)-($2))-2*($5)-($11)},{($5)+($11)+2*(($2)-($8))}' -l[-1] -s x -+ -endl
--*[-2] '$3,$6,{3*(($9)-($3))-2*($6)-($12)},{($6)+($12)+2*(($3)-($9))}' -l[-1] -s x -+ -endl
-*[-3] '$1,$4,{3*(($7)-($1))-2*($4)-($10)},{($4)+($10)+2*(($1)-($7))}' -l[-3] -s x -+ -endl
-a[-3--1] x
1,{$13-1},1,1,2 (0,1;{$13-2},{$13-1}) -r[-1] 2,[-2],1,1,3 -round[-1] -a[-2,-1] x
1,{3*($13-1)},1,1,200 1,{$13-1},1,1,1
-y[-3,-4,-6] -a[-6--1] y
-v +
sprite3d :
-e[^-1] "Convert image$? as 3d sprites."
-v - -repeat @# -l[$>] nm=@{0,n}
-split_opacity
-i[0] (67.5;73.5;109.5;103.5;51.5;100.5;1;1;0;0;0;1;0;-128;{w};{h};@{0,s}) -y[1]
-if {@#==2} (1) -a y
-else -/[-1] 255 -i[-2] (-128;{w};{h};{s}) -y[-1]
-endif
-a y
-nm $nm -endl -done -v +
sprites3d :
-e[^-1] "Convert image$? as 3d sprites clouds."
-v - -repeat {@#-1}
-if {!@{$>,(0,7)}} -continue -endif
[-1] -l[$>,-1]
-s3d[0] N=@{1,0} -=[1] $N,0,1
-rm[3-5] -i[3] (1,0;1,{$N-1}) -r[3] 2,$N,1,1,3 -round[3]
-if {s==4}
-s[-1] c,-3 -/[-1] 255
-i[-3] (-128;{w};{h};3)
-if {$N>1} -i[-2] 1,{4*($N-1)},1,1,-128,0,0,0 -endif
-i[-2] (-128;{w};{h};1)
-if {$N>1} 1,{4*($N-1)},1,1,-128,0,0,0 -endif
-else
-i[-2] (-128;{w};{h};{s}) -y[-3,-1]
-if {$N>1} 1,{4*($N-1)},1,1,-128,0,0,0 -endif
1,$N,1,1,1
-endif
-y -a y
-endl -done -rm[-1] -v +
star3d : -check "${1=5}>0 && ${2=0.38}>=0 && $2<=1"
-e[^-1] "Input 3d star, with $1 branches and thickness $2."
-v -
N={2*$1} ({'CImg3d'}) -+[-1] 0.5 ({$N+1};$N)
({-pi/2};{3*pi/2}) -r[-1] 1,{$N+1},1,1,3 -rows[-1] 0,{h-2} --sin[-1] -cos[-2] -a[-2,-1] x
(1,1;$2,$2) -*[-2,-1] -z[-1] 0,2 -r[-1] 3,{h+1},1,1,0
(3,$N,1,0;3,$N,$N,{$N-1}) -r[-1] 4,$N,1,1,3 -round[-1] -=[-1] 0,2,100%
3,$N,1,1,200 1,$N,1,1,1 -y[-6,-4--2] -a[-6--1] y -nm[-1] [3d\ star]
-v +
superformula3d : -check "${1=1024}>1 && ${2=8}>=1" -skip ${3=1},${4=5},${5=8}
-e[^-1] "Input 2d superformula curve, with resolution $1, m=$2 and (n1,n2,n3)=($3,$4,$5)."
-v -
res={round($1)}
(67.5;73.5;109.5;103.5;51.5;100.5;$res;{$res-1})
(0,{2*pi}) -r[-1] $res,1,1,1,3 [-1]
-*[-1] {$2/4} --sin[-1] -cos[-2] -abs[-2,-1]
-^[-2] $4 -^[-1] $5 -+[-2,-1] -^[-1] {-1/$3}
--sin[-2] -cos[-3] -*[-1] [-2] -*[-3,-2] -n[-2,-1] -1,1
-a[-2,-1] y -rows[-1] 0,2 -transpose[-1] -r[-1] 1,{w*h},1,1,-1
1,{$res-1},1,1,2 (0;{$res-2}) -r[-1] 1,{$res-1},1,1,3 --+[-1] 1 -a[-3--1] x -round[-1] 1 -r[-1] 1,{w*h},1,1,-1
1,{3*($res-1)},1,1,200 1,{$res-1},1,1,1 -a[-5--1] y -nm[-1] [3d\ superformula]
-v +
text_pointcloud3d : -skip ${1="text1"},${2="text2"},${3=1}
-e[^-1] "Input 3d pointcloud text object from strings '$1' and '$2', with smoothness $3."
-v -
0 -t[-1] "$1",0,0,53,1,1
0 -t[-1] "$2",0,0,53,1,1 -mirror[-1] y
-autocrop[-2,-1] 0
-expand_xy[-2,-1] 2,0 -dilate[-2,-1] 2
-permute[-1] zyxc -r[-2,-1] @{-max_whd} -and[-2,-1]
100%,100% -rand[-1] 0,{@{-2,d}-1} -round[-1] -r[-1] [-2] -f[-1] 'if(z==i,1,0)'
-distance[-1] 1 -+[-1] 1 --f[-1] 1 -rv[-2,-1] -/[-2,-1] -*[-1] [-2]
--dilate[-1] 0,0,{d} -==[-2,-1] -*[-1] [-2]
1,100%,100% -rand[-1] 0,{@{-2,w}-1} -round[-1] -r[-1] [-2] -f[-1] 'if(x==i,1,0)'
-distance[-1] 1 -+[-1] 1 --f[-1] 1 -rv[-2,-1] -/[-2,-1] -*[-1] [-3]
--dilate[-1] 0,0,{d} -==[-2,-1] -*[-3,-1]
-or[-2,-1]
-b[-1] $3 -isosurface3d[-1] 25%
-c3d[-1] -n3d[-1] -nm[-1] "[3d text pointcloud]" -v +
text3d : -skip ${2=53},${3=10},${4=1.5}
-e[^-1] "Input 3d text object '$1' with size $2, depth $3 and smoothness $4."
-v - 0 -t[-1] "$1",0,0,$2,1,1 -autocrop[-1] 0 -r[-1] 100%,100%,$3 -expand_xyz[-1] 10,0
-b[-1] $4 -isosurface3d[-1] 40% -rv3d[-1] -nm[-1] "[3d text '$1']" -v +
torus3d : -check "${3=24}>2 && ${4=12}>2" -skip ${1=1},${2=0.3}
-e[^-1] "Input 3d torus, with radii ($1,$2) and subdivisions ($3,$4)."
-v -
nbp={$3*$4}
1,8,1,1,67.5,73.5,109.5,103.5,51.5,100.5,$nbp,{$4*$3}
(0;{2*pi}) --y[-1] x
-r[-2] 1,{$3+1},1,1,3 -z[-2] 0,0,0,{$3-1}
-r[-1] {$4+1},1,1,1,3 -z[-1] 0,{$4-1}
--sin[-2,-1] -cos[-4,-3] -r[-4--1] $4,$3
-*[-3] $2 -+[-3] $1 -*[-1] $2 -*[-4] [-3] -*[-3,-2]
-y[-3--1] -a[-3--1] x
1,$3,1,1,'y' -*[-1] $4 --shift[-1] 0,-1 $4,1,1,1,'x' --shift[-1] -1 -r[-4--1] $4,$3
--+[-4,-1] -+[-2] [-4] -+[-5] [-3] -+[-4,-3] -y[-4--1] -i[-5] 1,{h},1,1,4 -a[-5--1] x
3,{h},1,1,200 1,{h},1,1,1 -y[-4--2] -a[-5--1] y
-nm[-1] [3d\ torus]
-v +
triangle3d :
-e[^-1] "Input 3d triangle ($1,$2,$3)-($4,$5,$6)-($7,$8,$9)."
-v - 1,25,1,1,67.5,73.5,109.5,103.5,51.5,100.5,3,1,${1-9},3,0,1,2,200,200,200,1 -nm[-1] [3d\ triangle] -v +
volume3d :
-e[^-1] "Transform image$? as 3d parallelepipedic objects."
-v - -repeat @# -l[$>]
w={w} h={h} d={d}
--slices 0 --slices[0] 100% -mirror[-1] y
--columns[0] 0 --columns[0] 100% -permute[-2,-1] zyxc -mirror[-2] x
--rows[0] 0 --rows[0] 100% -permute[-2,-1] xzyc -mirror[-2] y
-rm[0] -image6cube3d -*3d $w,$h,$d
-endl -done -v +
weird3d : -skip ${1=32}
-e[^-1] "Input 3d weird object, with resolution $1."
-v -
-isosurface3d "'\
T = 1.61803399;\
2 - (cos(x + T*y) + cos(x - T*y) + cos(y + T*z) + cos(y - T*z) + cos(z - T*x) + cos(z + T*x))\
'",0,-4.7,-4.7,-4.7,4.7,4.7,4.7,$1,$1,$1
-c3d[-1] -n3d[-1] -nm[-1] [3d\ weird]
-v +
ap :
-v - _gmic_s="$?" -v +
-_apply_parallel "$*"
apply_parallel :
-v - _gmic_s="$?" -v +
-_$0 "$*"
_apply_parallel :
-e[0--3] "Execute command '$*' on all image"$_gmic_s" in parallel, using "@*" threads."
-v -
-if {@#" && "narg("$*")}
-m "_ap : -repeat @# -l[$>] $* -if @# -k[0] -else 0 -endif -endl -done"
command=
N={min(@#,@*)} S=0 sep=""
-repeat $N
E={round(($>+1)*@#/$N)-1}
command=$command$sep-_ap[$S-$E]
S={$E+1} sep=,
-done
-parallel $command
-uncommand _ap
-endif
-v +
apc :
-v - _gmic_s="$?" -v +
-_apply_parallel_channels "$*"
apply_parallel_channels :
-v - _gmic_s="$?" -v +
-_$0 "$*"
_apply_parallel_channels :
-e[0--3] "Execute command '$*' on all channels of image"$_gmic_s" in parallel, using "@*" threads."
-v - N=@# -repeat $N s$>=@{$>,s} -done -s c
-ap "$1"
-repeat $N -a[$>-{$>+${s$>}-1}] c -done -v +
apo :
-v - _gmic_s="$?" -v +
-_apply_parallel_overlap "$1",${2--1}
apply_parallel_overlap :
-v - _gmic_s="$?" -v +
-_$0 "$1",${2--1}
_apply_parallel_overlap : -check "${2=0}>=0 && isint(${3=0}) && $3>=0"
-v - N={if($3,max(1,round($3)),@*)} N={2^int(log2(min(16,$N)))} -v +
-e[0--3] "Apply parallelized command '$1' on image"$_gmic_s", with overlap $2 and "$N" threads."
-v -
-m "_check1 : -if {@#!=1} -error[0--9] \"Command '-apply_parallel_overlap': Specified command '$1' changes the size of the image stack.\" -endif"
-repeat @# -l[$>]
-_apply_parallel_overlap$N "$1",$2
-endl -done
-uncommand _check1
-v +
_apply_parallel_overlap1 :
$1
_apply_parallel_overlap2 :
-if {w>=h}
ovx={round(if(@{"-is_percent $2"},w*$2,$2))} w2={int(w/2)}
--z[0] {$w2-$ovx},100% -z[0] 0,{$w2+$ovx-1}
-parallel "-l[0] $1 -_check1 -endl","-l[1] $1 -_check1 -endl"
-z[0] 0,@{0,w-1-$ovx} -z[1] $ovx,100% -a x
-else
ovy={round(if(@{"-is_percent $2"},h*$2,$2))} h2={int(h/2)}
--rows[0] {$h2-$ovy},100% -rows[0] 0,{$h2+$ovy-1}
-parallel "-l[0] $1 -_check1 -endl","-l[1] $1 -_check1 -endl"
-rows[0] 0,@{0,h-1-$ovy} -rows[1] $ovy,100% -a y
-endif
_apply_parallel_overlap4 :
-if {max(w,h)/min(w,h)>=3}
-_apply_parallel_overlap2 "-_apply_parallel_overlap2 \"$1\",$2",$2
-else
ovx={round(if(@{"-is_percent $2"},w*$2,$2))} w2={int(w/2)}
ovy={round(if(@{"-is_percent $2"},h*$2,$2))} h2={int(h/2)}
--z[0] {$w2-$ovx},0,100%,{$h2+$ovy-1} --z[0] 0,{$h2-$ovy},{$w2+$ovx-1},100%
--z[0] {$w2-$ovx},{$h2-$ovy},100%,100% -z[0] 0,0,{$w2+$ovx-1},{$h2+$ovy-1}
-parallel "-l[0] $1 -_check1 -endl","-l[1] $1 -_check1 -endl","-l[2] $1 -_check1 -endl","-l[3] $1 -_check1 -endl"
-z[0] 0,0,@{0,w-1-$ovx},@{0,h-1-$ovy} -z[1] $ovx,0,100%,@{1,h-1-$ovy}
-z[2] 0,$ovy,@{2,w-1-$ovx},100% -z[3] $ovx,$ovy,100%,100%
-a[0,1] x -a[1,2] x -a y
-endif
_apply_parallel_overlap8 :
-_apply_parallel_overlap2 "-_apply_parallel_overlap4 \"$1\",$2",$2
_apply_parallel_overlap16 :
-_apply_parallel_overlap2 "-_apply_parallel_overlap8 \"$1\",$2",$2
parallel :
-if {$1==0||$1==1||$1==2} -e[0--3] "Execute "{$#-1}" commands '${2--1}' in parallel on image$?."
-else -e[0--3] "Execute "$#" commands '$*' in parallel on image$?."
-endif
-v - -parallel $"*" -v +
rprogress : -skip ${2=""}
-v -
-if {!narg($_progress_bounds)} _progress_bounds=0,100 -endif
m={arg(-2,$_progress_bounds)} M={arg(-1,$_progress_bounds)}
-if {$#==2&&!narg($2)}
-v + -e[0--3] "Set relative progress indice to $1%." -v -
-progress {if($1<0,-1,min(100,max(0,$m+($M-$m)*$1%)))}
-elif {$#==3}
nm={min($2,$-1)} nM={max($2,$-1)}
-v + -e[0--3] "Call command '$1' with progress bounds ["$nm,$nM"]." -v -
-progress $m _progress_bounds=$_progress_bounds,{$m+$nm*($M-$m)/100},{$m+$nM*($M-$m)/100}
-_rprogress "$1"
-progress $M ($_progress_bounds) _progress_bounds=@{-1,0--3} -rm[-1]
-else -error[0--3] "Command '-rprogress': Invalid argument '$*'."
-endif
-v +
_rprogress : $*
array : -check "isint($1) && $1>0 && isint(${2=$1}) && $2>0" -skip ${3=0}
-e[^-1] "Create $1x$2 array from image$?, with expand type $3."
-v - r0={100/max($1,$2)} r1={100/min($1,$2)} r2=100
-r ${r$3}%,${r$3}%,1,100%,2 -r {$1*100}%,{$2*100}%,1,100%,0,2 -v +
array_fade : -skip ${2=$1},${3=60},${4=90},${5=1}
-e[^-1] "Create $1x$2 array of ($3%,$4%) faded tiles from image$?, with expand type $5."
-v - -repeat @# -l[$>] [-1] -shift[-2] 50%,50%,1,1,2 -fade_diamond $3,$4 -endl -done
-array $1,$2,$5
-v +
array_mirror : -skip ${2=2},${3=0}
-e[^-1] "Create a 2^$1x2^$1 mirrored-array from image$?, with expand type $2."
-v - -repeat $1
-if {$3==0}
-if {$2>=3} -r 33%,33%,100%,100%,2
-else -r 50%,50%,100%,100%,2
-endif
-endif
-repeat @# -l[$>]
-if {$2==0} --mirror x -a x
-elif {$2==1} --mirror y -a y
-else --mirror x -a x --mirror y -a y -if {$2==3} -r 150%,150%,1,100%,0,2,1,1 -endif
-endif
-endl -done
-done -v +
array_random : -skip ${2=$1},${3=$1},${4=$2}
-e[^-1] "Create $3x$4 array of tiles from $1x$2 array$?."
-v - -repeat @# -l[$>] nm=@{0,n}
-split_tiles $1,$2
-repeat $3 -repeat $4 [{?($1*$2-1)}] -done -done
-rm[0-{$1*$2-1}] -append_tiles $3,$4
-nm $nm -endl -done -v +
frame : -skip ${2=$1}>=0,${3=255},${4=$3},${5=$4},${6=255}
-v - _gmic_s="?" -v +
-_frame_xy ${1--1}
frame_blur : -skip ${1=10},${2=30},${3=0},${4=1},${5=3%}
-e[^-1] "Draw round frame on image$?, with sharpness $1, size $2, smoothness $3, shading $4 and blur $5."
-v - -to_rgba -repeat @# -l[$>] nm=@{0,n}
100%,100%,1,1,"-(abs(x/w-0.5)^$1 + abs(y/h-0.5)^$1)^(1/$1)" ->=[-1] $2%
-if $4 -distance[-1] 1 -n[-1] 0,1 -*[-1] -1 -+[-1] 1 -^[-1] {1/$4} -endif
-b[-1] $3 --b[-2] $5 -mv[-1] -3 -blend_fade[0,1] [-1] -rm[-1]
-nm $nm -endl -done -v +
frame_cube : -check "${1=1}>=0" -skip ${2=0},${3=0},${4=0},${5=0},${6=0},${7=0}
-e[^-1] "Insert 3d frame in image$?, with depth $1, centering point ($2,$3) and orientations (${4--1})."
-v - -repeat @# -l[$>] nm=@{0,n} -split_opacity
-if {@#==2} -frame_cube ${1--1} -a c
-else
m={max(w,h)} w={w} h={h} s={s}
-imageplane3d -c3d -/3d[-1] $w,$h,1
--_frame_cube[0] $4 -r3d[-1] 0,1,0,90 -+3d[-1] -0.5,0,-0.5
--_frame_cube[0] $5 -r3d[-1] 0,1,0,-90 -+3d[-1] 0.5,0,-0.5
--_frame_cube[0] $6 -r3d[-1] 1,0,0,90 -+3d[-1] 0,0.5,-0.5
--_frame_cube[0] $7 -r3d[-1] 1,0,0,-90 -+3d[-1] 0,-0.5,-0.5
-+3d 0,0,1 -+3d -*3d $w,$h,$m
f=1000
cx=$2*$w/2*($f+$m*$1)/$f
cy=$3*$h/2*($f+$m*$1)/$f
-s3d -r[2] 3,{@{2,h}/3},1,1,-1
-f[2] "if(i(2,y)<0.5,i,i+if(x==0,"$cx",if(x==1,"$cy",($1-1)*"$m")))"
-y[2] -a y
-*3d 2 {2*$w},{2*$h},1,$s -f3d {2*$f}
-j3d[-1] [-2],50%,50%,0,1,2,0,0 -rm[-2]
-r $w,$h,1,100%,2
-endif
-nm $nm -endl -done
-v +
_frame_cube :
-if {$1==1} -r3d[-1] 0,1,0,180 -rv3d[-1]
-elif {$1==2} -r3d[-1] 1,0,0,180 -rv3d[-1]
-elif {$1==3} -r3d[-1] 0,0,1,180
-endif
frame_fuzzy : -skip ${2=$1},${3=5},${4=1},${5=255},${6=$5},${7=$6},${8=255}
-e[^-1] "Draw $1x$2 fuzzy frame on image$?, with fuzzyness $3, smoothness $4 and RGBA color ($5,$6,$7,$8)."
-v - -to_rgba -repeat @# -l[$>]
100%,100%,1,1,1
padx={if(@{"-is_percent $1"},$1*(w-1)/2,$1)}
pady={if(@{"-is_percent $2"},$2*(h-1)/2,$2)}
-rectangle[-1] $padx,$pady,{w-1-$padx},{h-1-$pady}
-spread[-1] $3 -b[-1] $4 100%,100%,1,4 -fc[-1] ${5-8}
-j[0] [2],0,0,0,0,1,[1] -k[0]
-endl -done -v +
frame_painting :
-check "${1=10%}>=0 && ${2=0.4}>=0 && $2<=1 && ${3=6%}>=0 && ${7=2%}>=0 && ${8=400}>=0 && ${9=50}>=0 && ${10=10}>=0 && $10<=100 && ${11=1}>=0 && ${12=0.5%}>=0"
-skip ${4=225},${5=200},${6=120},${13=123456789}
-e[^-1] "Add painting frame to image$?, with size $1, contrast $2, profile smoothness $3, color (${4-6}), vignette size $7, "\
"vignette strength $8, defects contrast $9, defects density $10, defects size $11, defects smoothness $12 and serial number $13."
-v - -repeat @# -l[$>]
-if {!$1} -return -endif
$1,$1 s={max(w,h)} -rm[-1]
({'@{-dec2bin\ $13}'}) --[-1] {'0'} -r[-1] $s
-transpose[-1] -b[-1] $3 -n[-1] {1-$2},{1+$2}
--r[-1] {@{-2,w}+2*$s},100%,1,1
--mirror[-1] y
-mv[-3] @# -transpose[-1] -r[-1] 100%,{@{-4,h}+2*$s},1,1
--mirror[-1] x
[-3],[-3],1,1,1 -polygon[-1] 3,0,0,{$s-1},{$s-1},0,{$s-1},1,0 -polygon[-1] 3,100%,0,{w-$s},100%,100%,100%,1,0
[-2],[-2],1,1,1 -polygon[-1] 3,1,0,100%,{$s-2},100%,0 -polygon[-1] 3,1,100%,100%,{h-$s+1},100%,100%,1,0
-_frame_painting[-6--3] ${4-6},${9-12}
{@{-7,w}+2*$s},{@{-7,h}+2*$s},1,3
-j[-1] [-7],0,0,0,0,1,[-3],1 -rm[-7] -mirror[-3] y
-j[-1] [-6],0,{h-$s},0,0,1,[-3],1 -rm[-6,-3]
-j[-1] [-4],0,0,0,0,1,[-2],1 -rm[-4] -mirror[-2] x
-j[-1] [-3],{w-$s},0,0,0,1,[-2],1 -rm[-3,-2]
[-2],[-2],1,1,-255 -r[-1] [-2],[-2],1,1,0,0,0.5,0.5 -+[-1] 255 --b[-1] $7 -n[-1] 0,$8 -max[-2,-1] -c[-1] 0,255
-a[-2--1] c
-r[-2] [-1],[-1],1,100%,0,0,0.5,0.5 -blend alpha
-endl -done -v +
_frame_painting :
-repeat @# -l[$>]
--*[-1] $2 --*[-2] $3 -*[-3] $1 -a[-3--1] c
100%,100%
i=0 -do -rand[-1] 0,1 -remove_pixels[-1] {100-$5}% -b[-1] $6 ->=[-1] 50% i={$i+1} -while {"m=$5/200;(ia<m-0.2 || ia>m+0.2) && "$i"<10"}
-b[-1] $7 -g[-1] -+[-2,-1] -n[-1] -$4,$4
-+[-2,-1] -c[-1] 0,255
-endl -done
frame_pattern : -check $1>=3 -skip ${2=0},${3=}
-v - -to_colormode 0
-if @{"-is_image_arg $2"}
-v + -e[^-1] "Insert $1x$1 pattern frame on image$?, using frame image$2." -v -
-pass$2 0 -repeat {@#-1} -l[$>,-1]
wh=@{0,w},@{0,h}
--r[1] @{0,w/($1-2)},@{0,h/($1-2)},1,100%,2
-r[0] {@{0,w}+2*w},{@{0,h}+2*h},1,100%,0,0,0.5,0.5
[-1]x{$1+2} -a[{-$1-2}--1] x -j[0] [-1],0,0 -j[0] [-1],0,{@{0,h}-1-h} -rm[-1]
[-1]x{$1+1} -a[{-$1-2}--1] y -j[0] [-1],0,0 -j[0] [-1],{@{0,w}-1-w} -rm[-1]
-if $3 -r[0] $wh,1,100%,2 -endif
-endl -done -rm[-1]
-else
-v + -e[^-1] "Insert $1x$1 self-pattern frame on image$?." -v -
-repeat @# -l[$>]
wh={w},{h}
--r {w/($1-2)},{h/($1-2)},1,100%,2 -r[-2] {$1*w},{$1*h},1,100%,0,0,0.5,0.5
[-1]x{$1+2} -a[{-$1-2}--1] x -j[-3] [-1],0,0 -j[-3] [-1],0,{@{-3,h}-1-h} -rm[-1]
[-1]x{$1+1} -a[{-$1-2}--1] y -j[-2] [-1],0,0 -j[-2] [-1],{@{-2,w}-1-w} -rm[-1]
-if $3 -r $wh,1,100%,2 -endif
-endl -done
-endif
-v +
frame_round : -skip ${1=10},${2=10},${3=0},${4=0},${5=255},${6=$5},${7=$6},${8=255}
-e[^-1] "Draw round frame on image$?, with sharpness $1, size $2, smoothness $3, shading $4 and RGBA color ($5,$6,$7,$8)."
-v - -to_rgba -repeat @# -l[$>] nm=@{0,n}
100%,100%,1,1,"-(abs(x/w-0.5)^$1 + abs(y/h-0.5)^$1)^(1/$1)" ->=[-1] $2%
-if $4 -distance[-1] 1 -n[-1] 0,1 -*[-1] -1 -+[-1] 1 -^[-1] {1/$4} -endif
-b[-1] $3 -i[-3] 100%,100%,1,4 -fc[-3] $5,$6,$7,$8 -blend_fade[0,1] [-1] -rm[-1]
-nm $nm -endl -done -v +
frame_x : -skip ${2=255},${3=$2},${4=$3},${5=255}
-e[^-1] "Insert $1 outer frame in image$? along the x-axis, with color (${2--1})."
-_frame $1,0,0,${2--1}
frame_xy : -skip ${2=$1},${3=255},${4=$3},${5=$4},${6=255}
-v - _gmic_s="$?" -v +
-_$0 ${1--1}
_frame_xy :
-e[0--3] "Insert $1x$2 outer frame in image"$_gmic_s" along the xy-axes, with color (${3--1})."
-_frame $1,$2,0,${3--1}
frame_xyz : -skip ${2=$1},${3=$2},${4=255},${5=$4},${6=$5},${7=255}
-e[^-1] "Insert $1x$2x$3 outer frame in image$? along the xyz-axes, with color (${4--1})."
-_frame $1,$2,$3,${4--1}
frame_y : -skip ${2=255},${3=$2},${4=$3},${5=255}
-e[^-1] "Insert $1 outer frame in image$? along the y-axis, with color (${2--1})."
-_frame 0,$1,0,${2--1}
_frame :
-v - -repeat @# -l[$>]
nm=@{0,n}
w={round($1*if(@{-is_percent\ $1},w,1))}
h={round($2*if(@{-is_percent\ $2},h,1))}
d={round($3*if(@{-is_percent\ $3},d,1))}
{w+2*$w},{h+2*$h},{d+2*$d},100% -fc[1] ${4--1}
-j[1] [0],$w,$h,$d -rm[0] -nm $nm
-endl -done -v +
img2ascii : -skip "${1= !\042\#$%&\047()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ\133\\\135^_\140abcdefghijklmnopqrstuvwxyz\173|\174~}","${5=}" -check "${2=16}>0 && ${3=20%}>=0 && ${4=16}>0"
-e[^-1] "Render image$? as binary ascii art, with charset '$1', analysis scale $2, analysis smoothness $3, synthesis scale $4 and output ascii filename '$5'."
-v -
is_multi={@#>1}
-l[]
({'"$1"'}) -repeat {w}
C={`92`}@{-dec2oct\ @{0,$>}}
0 -t[-1] $C,0,0,$2,1,1
0 -t[-1] $C,0,0,$4,1,1
-done -rm[0]
-= -1 -= -1,0,100% -autocrop -= 0 -= 0,0,100%
-l[0--2:2] -r {@{-max_w}+1},100%,1,1,0,0,0.5 -b $3 -n 0,255 -a z -endl
-l[1--1] -r {@{-max_w}+1},100%,1,1,0,0,0.5 -a z -endl
-endl
w=@{-2,w} h=@{-2,h}
-repeat {@#-2} -l[$>,-2,-1]
-luminance[0] -n[0] 0,255
nw=@{0,round(w/$w,1,1)}
nh=@{0,round(h/$h,1,1)}
-if $> list_wh=$list_wh,$nw,$nh -else list_wh=$nw,$nh -endif
-s[0] y,-$h -s[0--3] x,-$w -r[0--3] $w,$h,1,1,0,0
-repeat {@#-2} -l[$>,-2,-1]
-rprogress {$>*100/(@#-2)}
-r[0] [1] --[0] [1] -sqr[0] -r[0] 1,1,100%,1,2 -y[0]
C=@{0,ym} -rm[0]
--slices[1] $C -mv[-1] 0
-if {narg("$5")} --f[0] $C -a[0,-1] c -endif
-endl -done
-append_tiles[0--2] $nw,$nh
-if {narg("$5")} -s[0] c -l[1]
-r $nw,$nh,1,1,1
({'"$1"'}) -map[0] [-1] -k[0]
-s y -i[1-@#] ({'\n'})
-a x
-if $is_multi filename=@{-filename\ "$5",$>} -else filename="$5" -endif
-o raw:$filename,char -rm
-endl -endif
-endl -done
-rm[-2,-1] -u $list_wh -v +
imagegrid : -skip ${2=$1}
-e[^-1] "Create $1x$2 image grid from image$?."
-v - -repeat @# -l[$>]
({w},{h}) ($1,$2) -/[-2,-1] -round[-1] 1 -r[-2] @-1,[-2],[-2],2 -rm[-1]
({w},{h}) ($1,$2) -*[-2,-1] -r[-2] @-1,[-2],[-2],2 -rm[-1]
$1,$2,1,[-1],1 -shift[-1] 1,1 -r[-1] [-2],0,2 -*
-endl -done -v +
imagegrid_hexagonal : -check "isint(${1=32}) && $1>0 && ${2=0.1}>=0 && $2<=1" -skip ${3=1}
-v - s0="" s1="no " -v +
-e[^-1] "Create hexagonal grid(s) from image$?, with resolution $1, outline $2 and "${s{!$3}}"anti-aliasing."
-v - -repeat @# -l[$>]
-l[]
({'CImg3d'},6,6)
(0;{2*pi}) --[-1] {pi/2} -r[-1] 1,7,1,1,3 --sin[-1] -cos[-2] -a[-2,-1] x -rows[-1] 0,5 -z[-1] 0,2
2,6,1,1,3,0 1,100%,1,1,y --+[-1] 1 -%[-1] 6 -rv[-2,-1] -a[-3--1] x
3,100%,1,1,1 1,100%,1,1,1 -y -a y
-*3d[-1] {1-$2}
--+3d {sqrt(3)} --+3d {sqrt(3)/2},1.5
-col3d[-3] 2 -col3d[-2] 3 -col3d[-1] 4 -+3d
-/3d 1.5
-endl
ny={1+round(0.5*$1,1,1)}
nx=@{0,1+round($1*w/h*3/(sqrt(3)*4),1,1)}
-array3d[-1] $nx,$ny,1,{4*sqrt(3)/3},2
-c3d[-1] -*3d[-1] @{0,h/$1}
-if $3 -r[0] 200%,200% -*3d[-1] 2 -endif
[0],[0] -j3d[-1] [-2],50%,50%,0,1,2,0,0 -rm[-2]
-blend shapeaverage0
-if $3 -r 50%,50%,1,100%,2 -endif
-endl -done -v +
linearize_tiles : -check "$1>0 && ${2=$1}>0"
-e[^-1] "Linearize $1x$2 tiles on image$?."
-v - -repeat @# -l[$>] nm=@{0,n}
s={s} -split_tiles $1,$2 -s c
-repeat @# -l[$>]
wh={w},{h}
--f x --f[-1] y --f[-1] 1 -y -a[^0] x -solve[-2] [-1] -rm[-1]
$wh,1,1,@{-1,0}"*x + "@{-1,1}"*y + "@{-1,2} -rm[-2]
-endl -done
-repeat {int(@#/$s)} -a[-$s--1] c -mv[-1] 0 -done -append_tiles $1,$2
-nm $nm -endl -done -v +
map_sprites : -check "isint($1) && $1>0 && isint(${2=0}) && $2>=0 && $2<=2"
-e[^-1] "Map set of $1 sprites to image selection$?."
-v - -norm[0--{$1+1}] -quantize[0--{$1+1}] $1,0,1
-slices[-$1--1] 0 -r[-$1--1] @{-max_wh[-$1--1]},1,100%,0,0,0.5,0.5
-if {$2==1}
N={4*$1}
-repeat {@#-$1} -*[$>] 4 --rand[$>] 0,3 -round[-1] -+[$>,-1] -done
-repeat $1 -l[{1+$<}] --mirror xy --rotate 90 -endl -done
-elif {$2==2}
N={2*$1}
-repeat {@#-$1} -*[$>] 2 --rand[$>] 0,1 -round[-1] -+[$>,-1] -done
-repeat $1 -l[{1+$<}] --mirror xy -endl -done
-else N=$1 -endif
-r[-$N--1] 100%,100%,1,@{-max_s[-$N--1]} w={w} h={h} -a[-$N--1] x
-r[^-1] ${w}00%,${h}00%,1,1 -*[^-1] $w
(0,{$w-1};0,{$w-1}^0,0;{$h-1},{$h-1}) -r[-1] $w,$h,1,2,3 -round[-1]
-repeat {@#-2} --r[-1] [$>],[$>],1,2,0,2 -r[$>] 100%,100%,1,2,0 -+[$>,-1] --warp[-2] [$>],0,0 -rv[$>,-1] -rm[-1] -done -rm[-2,-1] -v +
puzzle : -check "isint(${1=512}) && $1>0 && isint(${2=$1}) && $2>0 && isint(${3=5}) && $3>0 && isint(${4=$3}) && $4>0 && isint(${8=64}) && $8>0"
-skip ${5=0.5},${6=0.5},${7=0.5}
-e[^-1] "Draw $3x$4 puzzle pattern on image$?, with curvature $5, centering $6, connectors variability $7 and resolution $8."
-v - -l[]
-if {$4>=2} -_puzzle[] $3,{$4-1},${5-8} -+3d[-1] 0,1 -endif
-if {$3>=2} -_puzzle[] $4,{$3-1},${5-8} -r3d[-1] 0,0,1,90 -+3d[-1] 1,$4 -endif
-*3d {$1/$3},{$2/$4} -quadrangle3d 0,0,0,{$1-1},0,0,{$1-1},{$2-1},0,0,{$2-1},0 -p3d[-1] 1 -+3d -col3d 1
$1,$2 -j3d[-1] [-2],0,0,0,1,1,0,0 -rm[-2]
-endl -v +
_puzzle :
R={$6*$1}
-repeat $2
({'CImg3d'},$R,{$R-1})
-repeat $1
sign={if(?<=0.5,-1,1)}
center={$4*?(-0.25,0.25)}
knob={$5*?(-0.05,0.12)}
($>,0;\
{0.2+$center+$>},{-$sign*$3*0.1};\
{0.4+$center+$>},0;\
{0.35+$center+$>},{0.1*$sign};\
{0.45+$center+$>},{(0.15+$knob)*$sign};\
{0.55+$center+$>},{(0.15+$knob)*$sign};\
{0.65+$center+$>},{0.1*$sign};\
{0.6+$center+$>},0;\
{0.8+$center+$>},{-$sign*$3*0.1})
-done
($1,0) -a[-{$1+1}--1] y -r[-1] 2,$R,1,1,5 -z[-1] 0,2
(2,0,1;2,{$R-2},{$R-1}) -r[-1] 3,{$R-1},1,1,3 -round[-1]
3,{h},1,1,255 1,{h},1,1,255 -y[-5--1] y -a[-5--1] y -+3d[-1] 0,$>
-done -+3d
quadratize_tiles : -check "$1>0 && ${2=$1}>0"
-e[^-1] "Quadratize $1x$2 tiles on image$?."
-v - -repeat @# -l[$>] nm=@{0,n}
s={s} -split_tiles $1,$2 -s c
-repeat @# -l[$>]
wh={w},{h}
--f x^2 --f[-1] y^2 --f[-1] x*y --f[-1] x --f[-1] y --f[-1] 1 -y -a[^0] x
-solve[-2] [-1] -rm[-1]
$wh,1,1,@{-1,0}"*x^2 + "@{-1,1}"*y^2 + "@{-1,2}"*x*y +"@{-1,3}"*x + "@{-1,4}"*y + "@{-1,5} -rm[-2]
-endl -done
-repeat {int(@#/$s)} -a[-$s--1] c -mv[-1] 0 -done -append_tiles $1,$2
-nm $nm -endl -done -v +
rotate_tiles : -skip ${2=8},${3=$2}
-e[^-1] "Apply $2x$3 tiled-rotation effect on image$?, with angle $1 deg."
-v - -split_tiles $2,$3,1 -rotate $1 -append_tiles $2,$3 -v +
shift_tiles : -check "${2=$1}>=0" -skip ${3=20}
-e[^-1] "Apply $1x$2 tiled-shift effect on image$?, with amplitude $3."
-v - -repeat @# -l[$>]
$1,$2,1,2 -noise[-1] $3 -r[-1] [-2],[-2],1,2 -warp[-2] [-1],1,1,0 -rm[-1]
-endl -done -v +
taquin : -check "isint($1) && $1>0 & isint(${2=$1}) && $2>0" -skip ${3=0},${4=50},${5=5%},${6=0},${7=0},${8=$7},${9=$8},${10=255}
-e[^-1] "Create $1x$2 taquin puzzle from image $?, with relief $4, border thickness $5, border outline $6 and outline color (${7--1})."
-v - -repeat @# -l[$>] nm=@{0,n}
-split_tiles $1,$2 -r @{-min_wh},100%,100%,0
100%,100%,1,1,1
-if @{"-is_percent $5"} -rectangle[-1] {100*$5/2}%,{100*$5/2}%,{100-50*$5}%,{100-50*$5}%,1,0
-else -rectangle[-1] $5,$5,{w-1-$5},{h-1-$5},1,0 -endif
-*[-1] '1-2*(x/w<y/h)' -*[-1] $4
-repeat {@#-1} -l[$>,-1] -split_opacity[0] -+[0] [-1] -a[^-1] c -endl -done -rm[-1] -c 0,255
-frame $6,$6,${7-10}
-if {$3==3} -f[-1] 0 -endif
-repeat @# -mv[$>] {?(@#)} -done
-if {$3==1} -f[0] 0 -elif {$3==2} -f[-1] 0 -endif
-append_tiles $1,$2
-nm $nm -endl -done -v +
tunnel : -check "${1=9}>=0 && ${2=80%}>0" -skip ${3=0.5},${4=0.5},${5=0.1},${6=0}
-e[^-1] "Apply tunnel effect on image$?, with depth $1, factor $2, centering ($3,$4), opacity $5 and angle $6."
-v - -repeat @# -l[$>]
-repeat $1 --r[-1] $2,$2,1,100%,5
-if $6 100%,100%,1,1,1 -rotate[-2,-1] $6,1,0 -erode[-1] 3 -j[-3] [-2],{(@{-3,w}-w)*$3},{(@{-3,h}-h)*$4},0,0,$5,[-1] -rm[-2,-1]
-else -j[-2] [-1],{(@{-2,w}-w)*$3},{(@{-2,h}-h)*$4},0,0,$5 -rm[-1] -endif
-done
-endl -done -c 0,255 -v +
boxfitting : -check "isint(${1=3}) && $1>=1 && isint(${2=0}) && $2>=0 && ${3=0.1}>=0 && isint(${4=3}) && $4>=1"
-e[^-1] "Apply box fitting effect on image$?, with box sizes ($1,$2), density $3 and $4 attempts."
-v -
min_size=$1
max_size={if($2,$2,max(w,h))}
-repeat @# -l[$>]
nb_attempts=0 prec=5
100%,100%
-repeat 1e8
-if {$><1}
100%,100% -noise[-1] {max(1e-3,$3)},2
-else
--distance[-1] 1 --rand[-1] 0,1 -*[-2,-1] -max_patch[-1] {round($prec*$min_size)}
prec={max(1,$prec*0.9)}
-endif
-dilate[-1] $min_size -area_fg[-1] 0,1 -==[-1] {($min_size)^2}
--dilate[-2] 3 -==[-1] 0 -*[-2,-1] -area_fg[-1] 0,1 -==[-1] {($min_size)^2}
-if {!iM} nb_attempts={$nb_attempts+1} -if {$nb_attempts>$4} -rm[-1] -break -endif
-else nb_attempts=0 -endif
-+[-2,-1]
-repeat {int(($max_size-$min_size)/2)}
--dilate[-1] 3 -area_fg[-1] 0,1 -==[-1] {($min_size+2*$>+2)^2}
-if {!iM} -rm[-1] -break -endif
-or[-2,-1]
-done
-done
-blend shapeaverage0
-endl -done -v +
cartoon : -skip ${1=3},${2=150},${3=20},${4=0.25},${5=1.5},${6=8}
-e[^-1] "Apply cartoon effect on image$?, with smoothness $1, sharpening $2, threshold $3, thickness $4, color $5 and quantization $6."
-v - -repeat @# -l[$>] -split_opacity -l[0] -to_rgb
-b $1 -sharpen $2,1 -c 0,255 -n 0,255
--edges $3 -b[-1] $4 ->=[-1] 0.9
-rgb2lab[-2] -s[-2] c -*[-3,-2] $5 -a[-4--2] c -lab2rgb[-2] -quantize[-2] $6,1,0 -n[-2] 0,255 -*
-endl -a c -endl -done -v +
circlism : -check "${1=2}>0 && ${2=20}>0 && ${3=1}>=0 && ${4=0.4}>0 && ${5=3}>=0" -skip ${6=2}
-e[^-1] "Apply circlism effect on image$?, with radii ($1,$2), smoothness $3, radius linearity $4 and location linearity $5.\n"
-v - -repeat @# -l[$>]
--gradient_norm -b[-1] $3 -n[-1] 0,1 --^[-1] $5 -^[-2] $4 sumg0=@{-1,+} 100%,100%
it=0 failed=0 noedges=0 svg="-1,-1"
-do
--distance[-1] 1,3
-if $noedges xyzc=@{-1,C} -else --*[-3,-1] xyzc=@{-1,C} -rm[-1] -endif
n=@{-4,($xyzc)}
x={arg(1,$xyzc)}
y={arg(2,$xyzc)}
r={min(max($1,$2*(1-$n)),sqrt(@{-1,($xyzc)})-2)}
-rm[-1]
-if {$r>=$1}
-if {$6==2}
-ellipse[-1] $x,$y,$r,$r,0,1,1 -ellipse[-2] $x,$y,{$r+$1},{$r+$1},0,1,-1
-elif {$6==1}
x0={$x-$r/2} y0={$y-$r/2} x1={$x+$r/2} y1={$y+$r/2}
-rectangle[-1] $x0,$y0,$x1,$y1,1,1
x0={$x-($r+$1)/2} y0={$y-($r+$1)/2} x1={$x+($r+$1)/2} y1={$y+($r+$1)/2}
-rectangle[-2] $x0,$y0,$x1,$y1,1,-1
-else
x0={round($x-$r/2)} y0={round($y-$r/2)} x1={round($x+$r/2)} y1={round($y+$r/2)}
-polygon[-1] 4,$x0,$y,$x,$y0,$x1,$y,$x,$y1,1,1
x0={round($x-($r+$1)/2)} y0={round($y-($r+$1)/2)} x1={round($x+($r+$1)/2)} y1={round($y+($r+$1)/2)}
-polygon[-2] 4,$x0,$y,$x,$y0,$x1,$y,$x,$y1,1,-1
-endif
failed=0
-else
-=[-2] -1,$x,$y
failed={$failed+1}
-if {$failed==100} failed=0 -if $noedges n=-1 -else noedges=1 -endif -endif
-endif
it={$it+1}
-if {!($it%50)}
p={round(100*(($sumg0-@{-2,+})/@{-2,wh})^3)}
-rprogress $p -v + -e[] "\r  "$p% -v -
-endif
-while {$n>=0}
-rm[-3,-2] -rprogress -1
-blend shapeaverage0
-endl -done -v +
color_ellipses : -skip ${1=1400},${2=5},${3=0.1}
-e[^-1] "Add $1 random color ellipses to image$?, with maximum radius $2 and opacity $1."
-v - -repeat $1 -ellipse {?(0,100)}%,{?(0,100)}%,{?(0,$2)}%,{?(0,$2)}%,{?(0,360)},$3,{?(60,255)},{?(60,255)},{?(60,255)},255 -done -v +
cubism : -check "${1=50}>=0 && ${2=10}>=0 && $2<=50 && ${5=0}>=0" -skip ${3=75},${4=0.7}
-e[^-1] "Apply cubism effect on image$?, with density $1, thickness $2, maximum angle $3 deg., opacity $4 and smoothness $5."
-if {"!$1 || !$2 || !$3 || !$4"} -return -endif
-v - -repeat @# -l[$>]
w={w} h={h} s={s}
P={round($2*max(w,h)/200)}
N={round(1.5*$1*w*h/(4*$P)/100)}
({'CImg3d'}) -+[-1] 0.5 ({4*$N};$N)
1,$N -rand[-1] $P,{$w-1-$P} --rand[-1] $P,{$h-1-$P} -a[-2,-1] x -round[-1]
--+[-1] '-$P,-$P' --+[-2] '$P,-$P' --+[-3] '$P,$P' --+[-4] '-$P,$P'
-a[-4--1] x -i[-2] (12,0,1,2,3;12,{4*($N-1)},{4*($N-1)+1},{4*($N-1)+2},{4*($N-1)+3})
-r[-2] 5,$N,1,1,3 -round[-2] 1 -a[-2,-1] x
1,$N -rand[-1] {225-$3},{225+$3} -*[-1] {pi/180}
--sin[-1] -cos[-2] --*[-1] -1 [-3] -a[-4--3] x -a[-2,-1] x -z[-4,-2,-1] 0,2 --*[-2,-1] -1 -a[-4--1] x -*[-1] {sqrt(2)*$P}
-r[-3] 400%,100%,1,1,0,2 -+[-3,-1]
(-128;$w;$h;$s) --b[0] $5
-if {$N>1} 4,{$N-1},1,1,-128,0,0,0 -endif
1,$N,1,1,1
-y[1--1] -a[1--1] y -rv3d[-1]
-if {$4>=1} -j3d[0] [1],0,0,0,1,2,0,0 -rm[1]
-else --j3d[0] [1],0,0,0,1,2,0,0 -rm[1] -blend alpha,$4
-endif
-endl -done -v +
draw_whirl : -skip ${1=100}
-e[^-1] "Apply whirl drawing effect on image$? with amplitude $1."
-v - -repeat @# -l[$>]
100%,100% -noise[-1] 70,2 -*[-1] 255 -r[-1] [-2] -and[-1,-2] -smooth[-1] $1,0,1,2,2
-sqrt[-1] -n[-1] 0,255 -equalize[-1]
-endl -done -v +
drawing : -skip ${1=200}
-e[^-1] "Apply drawing effect on image$? with amplitude $1."
-v - -repeat @# -l[$>] -split_opacity -l[0] -to_rgb
-smooth $1,0.2,1,3,3 -b 2 -sharpen 1000 [0]
-r[0] 20,20,1,3,2 -equalize[0] -index[1] [0],1,1
-nm[1] @{0,n},1 -rm[0]
-endl -a c -endl -done -v +
drop_shadow : -check "${3=5}>=0 && ${4=0}>=0 && $4<=1" -skip ${1=20},${2=$1},${5=1}
-e[^-1] "Drop shadow behind image$?, with offsets ($1,$2), smoothness $3 and curvature $4."
-v - -to_a -repeat @# -l[$>]
nm=@{0,n}
dx={if(@{-is_percent\ $1},w*$1,$1)}
dy={if(@{-is_percent\ $2},h*$2,$2)}
sigma={if(@{-is_percent\ $3},max(w,h)*$3,$3)}
w={w} h={h} s={s} --channels 100% coords=@{-autocrop_coords[-1]\ 0} -rm[-1] -z $coords
-r {w+abs($dx)},{h+abs($dy)},1,100%,0,0,{if($dx>0,0,1)},{if($dy>0,0,1)} -r[-1] {w+4*$sigma},{h+4*$sigma},1,100%,0,0,0.5,0.5
--channels[-1] 100%
-if {!$4} -shift[-1] $dx,$dy
-else
(0;{pi}) -r[-1] [-2],3 -sin[-1] -*[-1] -$4 -+[-1] 1 -*[-1] $dx
(0,{pi}) -r[-1] [-2],3 -sin[-1] -*[-1] -$4 -+[-1] 1 -*[-1] $dy
-a[-2,-1] c -warp[-2] [-1],1,0,0 -rm[-1]
-endif
-b[-1] $sigma,0
-r[-1] 100%,100%,1,2,0,0,0,0,0,1 -mv[-1] 0 -blend alpha
--channels[-1] 100% ->=[-1] 1 -* -autocrop 0
-if {!$5} $w,$h,1,$s -j[-1] [-2],{arg(1,$coords)},{arg(2,$coords)} -rm[-2] -endif
-nm $nm
-endl -done -v +
ellipsionism : -check "${1=10}>0 && ${2=3}>0 && ${5=8}>0 && ${6=0.6}>0" -skip ${3=1%},${4=0.7}
-e[^-1] "Apply ellipsionism filter to image$?, with radii ($1,$2), smoothness $3, opacity $4 and outline $5."
-v - -to_rgba -repeat @# -l[$>]
--luminance -g[-1] xy -a[-2,-1] c -b[-1] $3 -orientation[-1]
-sh[-1] 0,0 -sh[-2] 1,1 -atan2[-1] [-2] -*[-1] {180/pi} -+[-1] 90 -rm[-2,-1] -channels[-1] 1,1
[-2],[-2],1,[-2]
-repeat {$6*w*h/max($1,$2)}
xy={?(w)},{?(h)}
-ellipse[-1] $xy,$1,$2,@{-2,($xy)},$4,\
@{-3,($xy,0,0)},@{-3,($xy,0,1)},@{-3,($xy,0,2)},@{-3,($xy,0,3)}
-ellipse[-1] $xy,$1,$2,@{-2,($xy)},$4,0x1,\
{@{-3,($xy,0,0)}/$5},{@{-3,($xy,0,1)}/$5},{@{-3,($xy,0,2)}/$5},{@{-3,($xy,0,3)}/$5}
-done -rm[-2]
-n[-1] [-2] -blend alpha
-endl -done -v +
fire_edges : -check "${1=0.7}>=0 && ${2=0.25}>=0 && $2<=1 && ${3=0.5}>=0 && ${4=25}>=0 && ${5=1}>0 && ${6=20}>=0 && ${7=0}>=0"
-e[^-1] "Generate fire effect from edges of image$?, with edges $1, attenuation $2, smoothness $3, threshold $4, "\
"$5 frames, starting frame $6 and frame skip $7."
-v - -repeat @# -l[$>] nm=@{0,n}
-norm --gradient_norm -n[-1] 0,1 -roundify[-1] $1 -f[0] 0
(0,0,0;0,0,0;1,1,1;0,1,0) -*[-1] {(1-$2^4)/4}
-repeat {$5*(1+$7)+$6}
@{0,w},@{0,h} -rand[-1] 0,255 -*[-1] [1]
-b[-1] $3
-if $4 ->=[-1] $4% -else -equalize[-1] -endif
-n[-1] 0,255
-j[0] [-1],0,0,0,0,1,[1],1 -rm[-1]
-correlate[0] [2]
-if {$>>=$6" && "($>-$6)%($7+1)==0} [0] -endif
-done -rm[0-2]
-nm $nm -endl -done
(0,255,255,255,255^0,0,255,255,255^0,0,0,128,255) -r[-1] 256,1,1,3,3
-map[^-1] [-1] -rm[-1] -v +
fractalize : -check "${1=0.8}>=0 && $1<=1"
-e[^-1] "Randomly fractalize image$?, with detail level $1."
-v -
xc=0.4433
yc=0.2645
delta=0.1
c0r=0.317
c0i=0.03
-repeat @# -l[$>] nm=@{0,n}
-luminance -equalize 256 -b 0.25% -n 0,255
100%,100%
dx={$delta*w/max(w,h)}
dy={$delta*h/max(w,h)}
x0={$xc-$dx/2}
y0={$yc-$dy/2}
x1={$xc+$dx/2}
y1={$yc+$dy/2}
-mandelbrot[-1] $x0,$y0,$x1,$y1,256,1,$c0r,$c0i
--==[-1] 0 -inpaint[-2] [-1] -rm[-1]
-n[-1] 0,256
16,1,1,3 -rand[-1] 0,255 -r[-1] 256,1,1,3,3 -map[-2] [-1] -rm[-1]
-s[-1] c
-i[2,3] [0]
s={0.1*(1-$1)}
-parallel "-register_nonrigid[1] [0],"$s",5","-register_nonrigid[3] [2],"$s",5","-register_nonrigid[5] [4],"$s",5"
-rm[0,2,4] -a c -nm $nm
-endl -done -v +
glow : -skip ${1=1%}
-e[^-1] "Add soft glow on image$?, with amplitude $1."
-v - -repeat @# -l[$>] -split_opacity --b[0] $1 -n[-1] [0] -blend_edges[0,-1] 1 -a c -endl -done -v +
halftone : -check "${1=5}>=2 && ${2=8}>=2 && ${3=8}>=2 && ${5=0}>=0" -skip ${4=5}
-v - s0="square" s1="diamond" s2="circle" s3="inv-square" s4="inv-diamond" s5="inv-circle" -v +
-e[^-1] "Apply halftone dithering to image$?, with $1 levels, dark size $3, bright size $4, "${s$4}" shape and smoothness $5."
-v - -repeat @# -l[$>] -s c -repeat @# -l[$>]
(0,255) -a y -quantize $1,0 -rows 0,{h-2}
-repeat $1
s={round(($2*$<+$3*$>)/($1-1))}
$s,$s -=[-1] 1,50%,50% -distance[-1] 1,{$4%3} --shift[-1] 50%,50%,0,0,2 -min[-2,-1]
-if {$4>=3} -<[-1] {100*$</($1-1.1)}% -*[-1] {-255} -+[-1] {255-$>}
-else -<[-1] {100*$>/($1-1.1)}% -*[-1] 255 --[-1] $>
-endif
-r[-1] [-2],0,2 -b[-1] $5 --==[-2] $> -*[-2,-1] -+[-2,-1]
-done -endl -done -a c
-endl -done -v +
hardsketchbw : -skip ${1=300},${2=50},${3=0.1},${4=20},${5=0}
-e[^-1] "Apply hard B&W sketch effect on image$?, with amplitude $1, density $2, opacity $3 and edge threshold $4."
-if {!$2} -channels 0 -f 255 -return -endif
-v - -luminance -n 0,1
-if $5
-repeat @# -l[$>] nm=@{0,n}
-g xy -rv -*[-2] -1 -a c
-if $4 --norm ->=[-1] $4% -* -endif
100%,100%,1,1,255 -quiver[-1] [-2],{max(1,10-$2/6)},$1,0,$3 -rm[-2]
-nm $nm -endl -done
-else
-repeat @# -l[$>] nm=@{0,n}
w={w} h={h} -g xy -rv -*[-2] -1 -a c -* $1
--norm ->=[-1] $4% 100%,100% -noise[-1] $2,2 -*[-2,-1]
-pointcloud3d[-1] -s3d[-1] -rm[-6--5,-3--1] -r[-1] 3,{h/3},1,1,-1 -s[-1] x -rm[-1] -a[-2,-1] c
-warp[-2] [-1],0,0 ---[-1] [-2] -+[-3,-2] -s[-2,-1] c
-i[-3] 1,{h} 1,{h} -a[-6--1] x
-i[-2] ({'CImg3d'}) -i[-2] ({2*h},{h})
1,{h},1,1,2 1,{h},1,1,2*y --+[-1] 1 -a[-3--1] x
3,{h} 1,{h},1,1,$3 -y[-6--1] -a[-6--1] y
$w,$h,1,1,255 -j3d[-1] [-2],0,0,0,1,1,0,0 -rm[-2]
-nm $nm -endl -done
-endif -v +
hearts : -skip ${1=10}
-e[^-1] "Apply heart filter on image$?, with density $1."
-v - -repeat @# -l[$>]
100%,100%,1 -noise[-1] $1,2 -r[-1] [-2] -n[-1] 0,1 -*[-1,-2] -_heart9x7
-mirror[-1] y -dilate[-2] [-1] -rm[-1]
-endl -done -v +
_heart9x7 :
(0,1,1,0,0,0,1,1,0;1,1,1,1,0,1,1,1,1;1,1,1,1,1,1,1,1,1;0,1,1,1,1,1,1,1,0;0,0,1,1,1,1,1,0,0;0,0,0,1,1,1,0,0,0;0,0,0,0,1,0,0,0,0)
houghsketchbw : -check "${1=8}>=0 && ${2=5}>=0 && ${3=80}>=0 && $3<=100 && ${4=0.1}>=0 && $4<=1 && ${5=100%}>0"
-e[^-1] "Apply hough B&W sketch effect on image$?, with density $1, radius $2, threshold $3, opacity $4 and votesize $5."
-v - -luminance -repeat @# -l[$>] nm=@{0,n}
res={round(if(@{-is_percent\ $5},$5*max(w,h),$5))} w={w} h={h} rhomax={sqrt(w^2+h^2)/2}
-hough $res,$res -n 0,255
-normalize_local[-1] $1,$2 ->=[-1] $3% -pointcloud3d[-1]
-s3d[-1] -rm[-6--5,-3--1] -r[-1] 3,{h/3},1,1,-1 -columns[-1] 0,1
-s[-1] x,2
-*[-2] {2*pi/$res}
-*[-1] {$rhomax/$res}
--cos[-2] -*[-1] [-2] -+[-1] {$w/2}
--sin[-3] -*[-1] [-3] -+[-1] {$h/2}
-rm[-3]
-i[-3] [-3]
-cos[-4] -sin[-3] -*[-4,-3] 10000
--+[-2] [-3]
---[-2] [-5]
--[-4] [-5]
-+[-3] [-6]
-rm[-6,-5]
-i[-3] 1,{h} 1,{h} -a[-6--1] x
-i[-2] ({'CImg3d'}) -i[-2] ({2*h},{h})
1,{h},1,1,2 1,{h},1,1,2*y --+[-1] 1 -a[-3--1] x
3,{h},1,1,0 1,{h},1,1,$4
-y[-6--1] -a[-6--1] y
$w,$h,1,1,255 -j3d[-1] [-2],0,0,0,1,1,0,0 -rm[-2]
-nm $nm -endl -done -v +
lightrays : -check "${1=50}>=0 && $1<=100 && ${4=1} && ${5=1}>=0" -skip ${2=50%},${3=50%}
-e[^-1] "Generate ray lights from image$?, with density $1, center point ($2,$3), ray length $4 and attenuation $5."
-v - -repeat @# -l[$>]
-gradient_norm -* -1 -< $1% -euclidean2polar $2,$3
-repeat {log2(w)} --shift[-1] {2^$>} -+[-2,-1] -done
-function1d 0.5,0,1,{$4*w},1,{1+($4+1-$5)*w},0 -r[-1] @{-2,w},1,1,1,0
(1,{w}) -r[-1] @{-2,w},1,1,1,3 -/[-2,-1]
-r[-1] [-2] -*[-2,-1] -polar2euclidean $2,$3 -n 0,255
-endl -done -v +
light_relief : -skip ${1=0.3},${2=0.5},${3=0.2},${4=0},${5=0.2},${6=0.5},${7=0.5},${8=1},${9=1},${10=0}
-e[^-1] "Apply relief light to image$?."
-v - -repeat @# -l[$>]
({-$6},{1-$6};{-$6},{1-$6}^{-$7},{-$7};{1-$7},{1-$7}^$8,$8;$8,$8) -r[-1] [-2],[-2],1,3,3
-if $10 --channels[-2] 3 -to_rgb[-3] -else --to_rgb[-2] -norm[-1] -endif
-b[-1] $5% -g[-1] xy 100%,100%,1,1,$9  -a[-3--1] c
-orientation[-2,-1] -*[-2,-1] -s[-1] c -+[-3--1]
100%,100% -=[-1] 1,{$6*100}%,{$7*100}% -distance[-1] 1 -sqr[-1] -*[-1] -1
-/[-1] {($3*max(w,h))^2} -exp[-1] -*[-1] $2 -+[-1] $1
-*[-2,-1] --[-1] $4 -*[-1] @{-2,M}
-split_opacity[0] -+[0,-1] -a c -c 0,255
-endl -done -v +
mosaic : -skip ${1=0.8},${2=1}
-e[^-1] "Apply mosaic effect on image$?, with density $1."
-v - -repeat @# -l[$>]
label0={1+im} -+ $label0
100%,100% -noise[-1] {$1*2},2 -*[-2] [-1] -distance[-1] 1 -*[-1] -1 -watershed[-2] [-1],{if($2,0,1)} -rm[-1]
-if $2 --l[-1] -> 0 -s c -and -endl --[-2] $label0 -*[-2,-1] -else --[-1] $label0 -endif
-endl -done -v +
old_photo :
-e[^-1] "Apply old photo effect on image$?."
-v - -noise 20 -bilateral 30,60 -b 2 -sharpen 100 -frame_fuzzy 8%,8%,6,3 -to_rgb -shadow_patch 0.75 -n 0,255 -sepia -v +
pencilbw : -skip ${1=0.3},${2=60}
-e[^-1] "Apply B&W pencil effect on image$?, with size $1 and amplitude $2."
-v - -repeat @# -l[$>] -split_opacity -l[0] -norm -b $1 -sharpen 4000 -smooth $2,0,1 -equalize -sqrt -n 0,255 -endl -a c -endl -done -v +
polaroid : -check "${1=10}>=0 && ${2=20}>=0"
-e[^-1] "Create polaroid effect in image$?, with borders sizes $1 and $2."
-v - -- 255 -r {100+$1}%,{100+$1}%,1,100%,0,0,0.5,0.5 -r 100%,{100+$2}%,1,100%,0,0,0 -+ 255 -v +
polygonize : -check "${1=300}>=0 && ${2=2%}>=0 && ${3=0.1%}>=0 && ${4=10%}>0 && ${5=$4}>0"
-e[^-1] "Polygonize image$? with warp amplitude $1, smoothness $2, minimal area $3 and resolutions ($4,$5)."
-v -  -repeat @# -l[$>]
--b $2 -gradient_norm[-1] -g[-1] -a[-2,-1] c -channels[-1] 0,2 -*[-1] {1/0.1+max(abs(im),abs(iM))}
resx={max(1,round(if(@{-is_percent\ $4},w*$4,w/$4)-1))}
resy={max(1,round(if(@{-is_percent\ $5},h*$5,h/$5)-1))}
-plane3d 1,1,$resx,$resy -*3d[-1] @{0,w-1},@{0,h-1},1
-s3d[-1] -rm[-2] -i[-2] (0;{h-1}) -r[-2] 3,{h},1,1,3 -round[-2] -y[-2]
[-4] -a[-7--2] y -r[-1] 3,{h/3},1,1,-1 -z[-1] 0,1 -permute[-1] yzcx
-repeat $1 --warp[1] [-1],0,0 -+[-2,-1] -done
-permute[-1] cxyz -z[-1] 0,2 -y[-1] -j[2] [-1],0,8 -rm[-3,-1]
[0],[0] -j3d[-1] [1],0,0,0,1,2 -rm[1]
-if {$3>0}
min_area=@{0,if(@{-is_percent\ $3},$3*w*h,$3)}
--area[-1] 0,1 ->=[-1] $min_area -+[-2] 1 -*[-2] [-1] -distance[-1] 1 -*[-1] -1 -watershed[-2] [-1] -rm[-1]
-endif
-blend shapeaverage
-endl -done -v +
poster_edges : -check "${1=40}>=0 && $1<=100 && ${2=5}>=0 && $2<=100 && ${3=0.5}>=0 && ${4=10}>=0 && ${5=12}>=0 && $5<=15 && ${6=0}>=0"
-e[^-1] "Apply poster edge on image$?, with edge threshold $1, edge shade $2, edge thickness $3, edge antialiasing $4, $5 level of posterization and posterization antialiasing $6."
-v - -repeat @# -l[$>] -split_opacity -l[0]
--g xy,1 -a[-2,-1] c -norm[-1] -b[-1] $3 -n[-1] 0,255
-apply_curve[-1] 1,0,1,{max(0,(100-($1%)^0.1*100)*255%)},0.99,{min(255,(101-($1%)^0.1*100+$2)*255%)},0.01,255,0 -c[-1] 0,1
-if $4 -smooth[-1] {min(50,$4)},0,1,{$4/40},{$4/40},0.8,90 -endif
-if $5 -autoindex[0] {round((4-sqrt($5+1))*32+2)} -endif
-if $6 -smooth[0] {min(50,$6)},0,1,{$6/40},{$6/40},0.8,90 -endif
-*
-endl -a c -endl -done -v +
poster_hope : -check "${1=3}>=0"
-e[^-1] "Apply Hope stencil poster effect on image$?, with smoothness $1."
-v - -repeat @# -l[$>] -to_rgb
-apply_parallel_channels "-smooth 200,0,1,$1,1"
-quantize 7,0 -f 'if(i!=5,i,i+1-2*(y%2))'
(0,32,47;0,32,47;209,1,23;209,1,23;90,141,145;-1,-1,-1;253,221,138) -permute[-1] yzcx
-map[0] [1] -rm[1]
-endl -done -v +
rodilius : -check "${1=10}>=0 && $1<=200 && ${2=10}>=0 && $2<=100 && ${3=400}>=0 && ${4=7}>0" -skip ${5=0},${6=1}
-e[^-1] "Apply rodilius filter on image$? with amplitude $1, thickness $2, sharpness $3, $4 orientations, offset $5 and "\
@{-arg\ 1+!$6,brighter,darker}" color mode."
-v - -repeat @# -l[$>] -split_opacity -rv
-if {!$6} -negative[-1] -endif
--f[-1] 0 -nm[-1] @{-2,n}
-repeat {round($4)}
angle={$5+$>*180/round($4)}
--blur_linear[-2] $1%,{$1*$2/100}%,$angle,1 -b[-1] 0.7 -sharpen[-1] $3 -max[-2,-1]
-done -rm[-2]
-if {!$6} -negative[-1] -endif
-rv -a c -endl -done -v +
stained_glass : -check "${1=40%}>=0 && ${2=0.2}>=0" -skip ${3=0}
-e[^-1] "Apply stained glass effect on image$?, with edges $1, shading $2 and thin-separators "@{-arg\ 1+!$3,enabled,disabled}"."
-v - -repeat @# -l[$>]
im={im-1} -- $im
--gradient_norm ->=[-1] $1 -*[-2] [-1]
-distance[-1] 1 -sharpen[-1] 1e10 -!=[-1] 0
-if $3 -skeleton[-1] 0 -endif
-distance[-1] 1 -watershed[-2] [-1] -+[-2] $im
-n[-1] 0,1  -^[-1] $2 -*
-endl -done -v +
star : -check "${1=512}>=1 && ${2=$1}>=1 && ${3=5}>0 && ${4=0.5}>=0 && $4<=1"
-e[^-1] "Input $1x$2 star binary mask, with $3 branches and thickness $4."
-v - -l[]
-star3d $3,$4 -col3d 1 -c3d -n3d -*3d $1,$2
$1,$2 -j3d[-1] [-2],50%,50%,0,1,2 -rm[-2]
-nm "[Heart binary mask]"
-endl -v +
stars : -check "${1=10%}>=0 && ${2=1}>=0 && ${3=32}>0 && ${4=5}>=1 && ${5=0.38}>=0 && $5<=1 && ${6=0.5}>=0" -skip ${7=200},${8=$7},${9=$8},${10=1}
-e[^-1] "Add $1 random stars to image$?, with depth $2, size $3, $4 branches, thickness $5, smoothness $6, color ($7,$8,$9) and opacity $10."
-if {!$1} -return -endif
-v -
-star3d $4,$5 -col3d[-1] 255 -*3d[-1] $3
-l[-1] -repeat 4 {round(2*$3)},{round(2*$3)} -j3d[-1] [0],50%,50%,0,1,2,0,0 -r3d[0] 0,0,1,90 -done -rm[0] -endl
-autocrop[-4--1] 0 -r2dy[-4--1] $3 -b[-4--1] $6,0 -r[-4--1] 100%,100%,1,4
-repeat 4 -sh[{-1-$>}] 0,2 -fc[-1] $7,$8,$9 -rm[-1] -done
-repeat {@#-1} [-4--1] -l[$>,-4--1]
N={round(if(@{-is_percent\ $1},w*h*$1,$1)/4,1,1)}
-repeat 4
2,$N -rand[-1] -1,1 1,$N -rand[-1] 0,1 -a[-2,-1] x
-i[-2] ({'CImg3d'}) -+[-2] 0.5 -i[-2] ($N;$N)
(1,0;1,{$N-1}) -r[-1] 2,$N,1,1,3 -round[-1] 4,$N,1,1,1 -y[-5,-3--1] -a[-5--1] y
-rv[-2,-1] -sprites3d[-2,-1] -*3d[-1] {0.75*@{0,w}},{0.75*@{0,h}},{1000*$2}
-j3d[0] [-1],50%,50%,0,$10,0,0,0 -rm[-1]
-done
-endl -done
-rm[-4--1] -v +
sketchbw :
-check "${1=2}>0 && ${3=180}>=0 && ${4=30}>=0 && ${5=1}>=0 && ${7=0}>=0 && ${8=0.6}>0 && ${9=0.1}>=0 && ${10=0.6}>=0 && ${11=0.25}>=0 && ${12=1}>=0"
-skip ${2=45},${6=0.03},${13=0},${14=1}
-e[^-1] "Apply B&W sketch effect on image$?."
-v - -diffusiontensors $9,$10,$11,$12
w=1 h=1 -i[0] 1 -m3d 0
-repeat {@#-1}
-/[-1] {max(iM,im)} -s[-1] c
100%,100%,1,1,255 -nm[-1] @{-4,n}
-if {$w!=w||$h!=h}
-rm[0] {$8*w*h/($1*sqrt($4))}
--rand[-1] 0,{@{-2,h}-1} -rand[-2] 0,{@{-3,w}-1} -a[-2,-1] y -mv[-1] 0
w={w} h={h}
-endif
-if $14
-repeat $1
alpha={($2+$>*$3/$1)*pi/180}
--*[-4] {cos($alpha)} --*[-4] {sin($alpha)} -+[-2,-1]
--*[-4] {cos($alpha)} --*[-4] {sin($alpha)} -+[-2,-1]
-a[-2,-1] c -channels[-1] 0,2
-if $13 -orientation[-1] -endif
-repeat @{0,w}
xy=@{0,($>,0)},@{0,($>,1)}
-if {@{-5,($xy)}+@{-3,($xy)}<$5} opac=$6 -else opac={$7*$6} -endif
-if $opac
--streamline3d[-1] $xy,0,$4,0.8,0,0,1 -col3d[-1] 0 -j3d[-3] [-1],0,0,0,$opac,1,0,0 -rm[-1]
--streamline3d[-1] $xy,0,$4,0.8,0,1,1 -col3d[-1] 0 -j3d[-3] [-1],0,0,0,$opac,1,0,0 -rm[-1]
-endif
-done
-rm[-1]
-done
-else
-repeat $1
alpha={($2+$>*$3/$1)*pi/180}
--*[-4] {cos($alpha)} --*[-4] {sin($alpha)} -+[-2,-1]
--*[-4] {cos($alpha)} --*[-4] {sin($alpha)} -+[-2,-1]
-a[-2,-1] c
-if $13 -orientation[-1] -endif
-repeat @{0,w}
x=@{0,($>,0)} y=@{0,($>,1)}
-if {@{-5,($x,$y)}+@{-3,($x,$y)}<$5} opac=$6 -else opac={$7*$6} -endif
-if $opac
-line[-2] {$x-$4*@{-1,($x,$y,0,0)}},{$y-$4*@{-1,($x,$y,0,1)}},\
{$x+$4*@{-1,($x,$y,0,0)}},{$y+$4*@{-1,($x,$y,0,1)}},\
{3*$opac},0
-endif
-done
-rm[-1]
-done
-endif
-rm[-4--2]
-mv[-1] 1 -done -rm[0] -v +
sponge : -skip ${1=13}
-e[^-1] "Apply sponge filter on image$?, with brush size $1."
-v - -repeat @# -l[$>]
100%,100%,1,1 -noise[-1] 20,2 -r[-1] [-2] -n[-1] 0,1 -*[-1,-2]
-_circle $1 -dilate[-2] [-1] -rm[-1]
-endl -done -v +
_circle :
-if {$1%2==0} -i 2,2 -else -i 1 -endif
-+[-1] 1 -r[-1] $1,$1,1,1,0,0,0.5,0.5 -distance[-1] 1 -n[-1] 0,1 -sqrt[-1] -c[-1] 0.85,0.86 -*[-1] -1 -n[-1] 0,1
stencil : -check "${1=3}>=0 && ${2=1}>=0 && ${3=8}>=0"
-e[^-1] "Apply stencil filter on image$?, with radius $1, smoothness $2 and $3 iterations."
-v - -n 0,1 -repeat $3 -b $1 -unsharp {$1+$2},1000 -c 0,255 -done -v +
stencilbw : -skip ${1=15},${2=10}
-e[^-1] "Apply B&W stencil effect on image$?, with edges $1 and smoothness $2."
-v - -repeat @# -l[$>] -split_opacity -luminance[0] -n[0] 0,255
--edges[0] $1 -quantize[0] 3,0,1 -b[0] $2
-sharpen[0] 1000000 -n[0] 0,1 -*[0,-1] -n[0] 0,255
-a c -endl -done -v +
tetris : -skip ${1=10}
-e[^-1] "Apply tetris effect on image$?, with scale $1."
-v - -repeat @# -l[$>]
wh={w},{h},1,{s} -r $1%,$1%,$1%,100%,2 -n 0,255 -quantize 10,1,0 -r $wh -b 2 -sharpen 300,1
-endl -done -v +
warhol : -skip ${1=3},${2=$1},${3=2},${4=20}
-e[^-1] "Create $1x$2 Andy Warhol-like artwork from image$?."
-v - r0={100/max($1,$2)}
-repeat @# -l[$>]
-norm -b $3 -r $r0%,$r0%,1,100%,2 -quantize 6 -n 0,5 -round 1
-repeat $1 -repeat $2
(0,1,2,3,4,5) -n[-1] 32,224 6,1,1,2,128 -noise[-1] $4,0 -c[-1] 0,255 -a[-2,-1] c -ycbcr2rgb[-1] --map[0] [-1] -rm[-2]
-done -done -append_tiles[^0] $1,$2 -nm[1] @{0,n} -rm[0]
-endl -done -v +
weave : -check "${1=6}>=0 && ${2=65}>=0 && $2<=100 && ${3=40}>=0 && $3<=100 && ${4=0.5}>=0"
-check "${5=0}>=0 && ${6=0}>=0 && ${7=0}>=0 && $7<=3 && ${8=0}>=-1 && $8<=1 && ${9=0}>=-1 && $9<=1"
-e[^-1] "Apply weave effect to image$?, with $1 strips, thickness $2, shadow $3, shading $4, "\
"fibers amplitude $5 and fibers smoothness $6, angle "{$7*22.5}" deg. and curvatures ($8,$9)."
-v - -repeat @# -l[$>] -split_opacity -l[0]
w={round(max(w,h)/$1,1,1)} h=$w s={(100-$3)*255%} p={max(0.01,$4)}
1,$h -=[-1] 1,0,50% -distance[-1] 1 -^[-1] $p -c[-1] 50%,100% -r[-1] {max(1,round($2*$w%))},100%
$w,1 -=[-1] 1,50% -distance[-1] 1 -^[-1] $p -c[-1] 50%,100% -*[-1] -1 -r[-1] 100%,{max(1,round($2*$h%))}
--*[-1] -1 --*[-3] -1 -n[-4,-2] 0,$s -n[-3,-1] $s,255
{w},1 1,[-3] -rand[-2,-1] 0,1 -b[-2,-1] $6% -n[-2,-1] -$5,$5 -r[-1] [-4] -+[-5] [-1] -+[-4,-1] -+[-5] [-1] -+[-2,-1]
--f[-3] 255 -a[-4,-1] c --f[-1] 255 -a[-2,-1] c
amp_x={$8*($w-w)/2} amp_y={$9*($w-w)/2}
-r[-4--1] $w,$h,1,100%,0,0,0.5,0.5
-f[-4] 'i(x+$amp_x*sin(y/h*pi),y,0,c,1,2)' -f[-1] 'i(x-$amp_x*sin(y/h*pi),y,0,c,1,2)'
-f[-3] 'i(x,y+$amp_y*sin(x/w*pi),0,c,1,2)' -f[-2] 'i(x,y-$amp_y*sin(x/w*pi),0,c,1,2)'
-blend[-4,-3] alpha -blend[-2,-1] alpha -c[-2,-1] 0,255
-/[-2,-1] 255 [-1] [-3] -a[-4,-2] x -a[-2,-1] x -a[-2,-1] y -rotate_tileable[-1] {$7*22.5} -r[-1] [-2],[-2],1,1,0,2 -*[-2,-1]
-endl -a c -endl -done -v +
whirls : -skip ${1=3},${2=6},${3=0.5},${4=1.8}
-e[^-1] "Add random whirl texture to image$?, with texture $1, smoothness $2, darkness $3 and lightness $4."
-v - -repeat @# -l[$>]
100%,100% -noise[-1] 0.3,2 -repeat $1 -b[-1] $2 -gradient_norm[-1] -^[-1] 0.2 -done
-n[-1] $3,$4 -r[-1] [-2] -* -c 0,255
-endl -done -v +
euclidean2polar : -skip ${1=50%},${2=50%} -check "${3=1}>0 && isint(${4=1}) && $4>=0 && $4<=2"
-e[^-1] "Apply euclidean to polar transform on image$?, with center point ($1,$2), power $3 and "@{-arg\ 1+$4,dirichlet,neumann,periodic}" boundary conditions."
-v - -repeat @# -l[$>]
cx={if(@{-is_percent\ $1},$1*(w-1),$1)}
cy={if(@{-is_percent\ $2},$2*(h-1),$2)}
R={sqrt(max($cx^2,(w-1-$cx)^2)+max($cy^2,(h-1-$cy)^2))}
-f 'r=x*$R/(w-1);a=y*2*pi/(h-1);i($cx+r*cos(a),$cy+r*sin(a),z,c,1,$4)'
-endl -done -v +
deform : -skip ${1=10}
-e[^-1] "Apply random smooth deformation on image$?, with amplitude $1."
-v - -repeat @# -l[$>]
2%,2%,1,2 -noise[-1] $1 -r[-1] [-2],[-2],1,2,5 -warp[-2] [-1],1,1,1 -rm[-1]
-endl -done -v +
fisheye : -skip ${1=50},${2=50},${3=50},${4=1.2}
-e[^-1] "Apply Fish-eye effect on image$?, centered at ($1%,$2%) with radius $3% and amplitude $4."
-if {$4==0} -return -endif
-v - -repeat @# -l[$>]
100%,100%,1,1 -=[-1] 1,$1%,$2% -distance[-1] 1 -c[-1] 0,$3% -*[-1] -1 -n[-1] 0,1 -^[-1] {1/$4}
-i[-2] ({-$1/100},{1-$1/100};{-$1/100},{1-$1/100}^{-$2/100},{-$2/100};{1-$2/100},{1-$2/100}) -r[-2] [-1],[-1],1,2,3
-n[-1] 0,{max(w,h)} -*[-2,-1]
-warp[-2] [-1],1,1,1 -rm[-1]
-endl -done -v +
flower : -skip ${1=30},${2=6},${3=0},${4=0},${5=50%},${6=50%},${7=2}
-e[^-1] "Apply flower deformation on image$?, with amplitude $1, frequency $2, offset $3, angle $4 deg. and center point ($1,$2)."
-v - -if @{-is_percent\ $3}
-transform_polar "r + (R*$3) + R*$1/100*cos(a*$2+$4*pi/180)","a",$5,$6,$7
-else
-transform_polar "r + $3 + R*$1/100*cos(a*$2+$4*pi/180)","a",$5,$6,$7
-endif -v +
kaleidoscope : -skip ${1=50%},${2=50%},${3=100},${4=30},${5=1}
-e[^-1] "Create kaleidoscope effect from image$?, with center point ($1,$2), radius $3, angle $4 deg."
-v - -euclidean2polar $1,$2,1,$5 -repeat @# -l[$>]
--columns 0,$3% -rows[-1] 0,$4% -r[-1] [-2],0,2 -nm[1] @{0,n} -rm[0]
-endl -done -polar2euclidean $1,$2,1,$5 -v +
map_sphere : -check "${1=512}>0 && ${2=512}>0 && ${5=0}>=0 && ${6=0.5}>=0" -skip ${3=100},${4=0.5}
-e[^-1] "Map image$? on spheres in $1x$2 images, with radius $3, dilation $4 and fading $5."
-v - r2={($3*min($1,$2)/200)^2}
-repeat @# -l[$>]
-i[-2] 100%,1,1,100%,0 -nm[0] @{1,n} -a y
({-$1/2},{$1/2}) ({-$2/2};{$2/2}) -r[-2,-1] $1,$2,1,1,3 -atan2[-1] [-2] -rm[-2]
$1,$2 -=[-1] 1,50%,50% -distance[-1] 1,3 -/[-1] $r2 -sqrt[-1] -c[-1] 0,1
-asin[-1]
-+[-2] {pi} -*[-2] {(@{-3,w}-1)/(2*pi)}
-*[-1] {2/pi} -^[-1] $4 -*[-1] {@{-3,h}-1} -*[-1] -1 -+[-1] {@{-3,h}-1}
-if $5 -->=[-1] 1 -distance[-1] 1 -c[-1] 0,$5% -n[-1] 0,1 -^[-1] $6 -c[-2] 1,100% --[-2,-1] -endif
-r[-1,-2] 100%,100%,@{-3,d}
--f[-1] z -a[-3--1] c
-warp[-2] [-1],0,1,1 -rm[-1]
-endl -done -v +
polar2euclidean : -skip ${1=50%},${2=50%} -check "${3=1}>0 && isint(${4=1}) && $4>=0 && $4<=2"
-e[^-1] "Apply polar to euclidean transform on image$?, with center point ($1,$2), power $3 and "@{-arg\ 1+$4,dirichlet,neumann,periodic}" boundary conditions."
-v - -repeat @# -l[$>]
cx={if(@{-is_percent\ $1},$1*(w-1),$1)}
cy={if(@{-is_percent\ $2},$2*(h-1),$2)}
R={sqrt(max($cx^2,(w-1-$cx)^2)+max($cy^2,(h-1-$cy)^2))}
-f 'X=sqrt((x-$cx)^2+(y-$cy)^2);tmp=atan2((y-$cy),(x-$cx));Y=if(tmp<0,tmp+2*pi,tmp);i(X*(w-1)/$R,Y*(h-1)/(2*pi),z,c,1,$4)'
-endl -done -v +
raindrops : -check "${2=0.1}>=0 && ${3=1}>=0 && isint(${4=0}) && $4>=0" -skip ${1=80}
-e[^-1] "Apply raindrops deformation on image$?, with amplitude $1, density $2, wavelength $3 and $4 merging steps."
-v - -repeat @# -l[$>]
100%,100% -noise[-1] $2,2 -distance[-1] 1 -f[-1] 'cos(i)/(1+i/(1e-8+$3))'
-if $4
-i[-2] (0,1,0;1,0,1;0,1,0) -/[-2] 2 [-1]
-repeat $4 --convolve[-1] [-3],1 --[-1] [-3] -rm[-3] -done -rm[-3,-2]
-endif
-g[-1] -a[-2,-1] c -*[-1] {$1/(1e-5+max(abs(im),abs(iM)))}
-warp[-2] [-1],1 -rm[-1]
-endl -done -v +
ripple : -skip ${1=10},${2=20},${3=2},${4=0},${5=0}
-e[^-1] "Apply ripple deformation on image$?, with amplitude $1, bandwidth $2, shape $3, angle $4 deg. and offset $5."
-v -
theta={$4*pi/180} C={cos($theta)} S={-sin($theta)}
-repeat @# -l[$>]
100%,100%,1,1,"x" --[-1] {w/2} 100%,100%,1,1,'y'
--[-1] {h/2-$5} -*[-2] $S -*[-1] $C -+[-2,-1]
-_ripple$3[-1] $1,$2
--*[-1] {-$S} -*[-2] $C -a[-2,-1] c
-warp[-2] [-1],1 -rm[-1]
-endl -done -v +
_ripple0 : -f {$1/2}*"(1-2*(i%"{2*$2}"<$2))"
_ripple1 : -f "I=(i%$2)/$2;$1*(2*if(I<0.5,I,1-I)-0.5)"
_ripple2 : -f {-$1/2}*"cos(i*"{2*pi/$2}")"
_ripple3 : -f {-$1/2}*"abs(cos(i*"{2*pi/$2}"))"
_ripple4 : -skip $* -n 0,{h-1} 1,{h} -rand[-1] {-$1/2},{$1/2} m={im} M={iM} -b[-1] {$2/10} -n[-1] $m,$M -map[-2] [-1] -rm[-1]
rotoidoscope : -skip ${1=50%},${2=50%},${5=1} -check "${3=10}>0 && ${4=1}>=0"
-e[^-1] "Create rotational kaleidoscope effect from image$?, with center point ($1,$2), $3 tiles and smoothness $4."
-v - -repeat @# -l[$>]
-repeat $3 --rotate[0] {360/$3},1,$5,$1,$2 -blend_edges $4 -done
-endl -done -v +
symmetrize : -skip ${1=50%},${2=50%},${3=90},${4=1},${5=0},${6=0}
-e[^-1] "Symmetrize image$?, regarding axis ($1,$2,$3 deg.)."
-v -
theta={$3*pi/180} u={cos($theta)} v={sin($theta)}
-if $6 symmetry_cond=A<0 -else symmetry_cond=A>0 -endif
-repeat @# -l[$>]
x0={if(@{-is_percent\ $1},w*$1,$1)}
y0={if(@{-is_percent\ $2},h*$2,$2)}
-if $5 -f 'A=($y0-y)*$u-($x0-x)*$v;X=x+2*($x0-x);Y=y+2*($y0-y);if($symmetry_cond,i(X,Y,z,c,1,$4),i)'
-else -f 'A=($y0-y)*$u-($x0-x)*$v;X=x-2*$v*A;Y=y+2*$u*A;if($symmetry_cond,i(X,Y,z,c,1,$4),i)'
-endif
-endl -done
-v +
transform_polar : -skip "${1=R-r}","${2=a}",${3=50%},${4=50%},${5=1}
-e[^-1] "Apply custom polar transform with 'new_r = $1', 'new_a = $2', center point ($3%,$4%)."
-v - -repeat @# -l[$>]
cx={if(@{-is_percent\ $3},$3*(w-1),$3)}
cy={if(@{-is_percent\ $4},$4*(h-1),$4)}
R={sqrt(max($cx^2,(w-1-$cx)^2)+max($cy^2,(h-1-$cy)^2))}
-f "R ="$R";
r = sqrt((x-"$cx")^2 + (y-"$cy")^2);
a = atan2(y-"$cy",x-"$cx");
nr = $1;
na = $2;
i("$cx" + nr*cos(na), "$cy" + nr*sin(na), z, c,1,$5)"
-endl -done -v +
twirl : -skip ${1=1},${2=50%},${3=50%},${4=1}
-e[^-1] "Apply twirl deformation on image$?, with amplitude $1 and center point at ($2%,$3%)."
-v - -euclidean2polar $2,$3,1,$4 -repeat @#
[$>],[$>],1,1,$1*x -channels[-1] -1,0 -warp[$>] [-1],1,1,2 -rm[-1]
-done -polar2euclidean $2,$3,1,1 -v +
warp_perspective : -skip ${1=1.5},${2=0},${3=1},${4=50},${5=50},${6=2}
-e[^-1] "Apply perspective warp on image$?, with angles ($1 deg.,$2 deg.), zoom $3 and offsets ($4,$5)."
-v - -repeat @# -l[$>]
(0,100) --[-1] $4 -/[-1] 100 (0;100) --[-1] $5 -/[-1] 100 -r[-2,-1] [-3],[-3],[-3],1,3
--*[-2] $2 --*[-2] $1 -+[-2,-1] -+[-1] $3 -/[-3] [-1] -/[-2,-1]
-*[-2] 100 -+[-2] $4 -/[-2] 100 -*[-2] @{-3,w}
-*[-1] 100 -+[-1] $5 -/[-1] 100 -*[-1] @{-3,h}
-a[-2,-1] c -warp[-2] [-1],0,1,$6 -rm[-1]
-endl -done -v +
water : -skip ${1=30},${2=1.5}
-e[^-1] "Apply water deformation on image$?, with amplitude $1 and smoothness $2."
-v - -repeat @# -l[$>]
25%,25%,25%,1 -noise[-1] $1 -g[-1] xyz -+[-1,-2,-3] -b[-1] $2 -*[-1] 2 -r[-1] [-2],[-2],1,2,3 -warp[-2] [-1],1 -rm[-1]
-endl -done -v +
wave : -skip ${1=4},${2=0.4},${3=50},${4=50}
-e[^-1] "Apply wave deformation on image$?, with amplitude $1, frequency $2 and center point at ($3%,$4%)."
-v - -repeat @# -l[$>]
100%,100% -=[-1] 1,$3%,$4% -distance[-1] 1
-*[-1] $2 --sin[-1] -cos[-2] -a[-2,-1] c -*[-1] $1
-warp[-2] [-1],1 -rm[-1]
-endl -done -v +
wind : -check "isint(${1=20}) && $1>=0 && ${3=0.7}>=0 && $3<=1" -skip "${2=0},${4=20}"
-e[^-1] "Apply wind effect on image$?, with amplitude $1, angle "{round($2/45)*45}" deg., attenuation $3 and threshold $4."
-v -
-if {!$1} -return -endif
dxdy=@{-_wind{round($2/45)%8}}
fact={(1-$3)^(1/$1)}
-repeat @# -l[$>]
--gradient_norm ->=[-1] $4%
-r[-1] 100%,100%,1,[-2] -*[-1] [-2]
-repeat $1
-shift[-1] $dxdy,0,0,0 -max[-2] [-1] -*[-1] $fact
-remove_pixels[-1] {100/$1}%
-done -rm[-1]
-endl -done -v +
_wind0 : -u 1,0
_wind1 : -u 1,1
_wind2 : -u 0,1
_wind3 : -u -1,1
_wind4 : -u -1,0
_wind5 : -u -1,-1
_wind6 : -u 0,-1
_wind7 : -u 1,-1
zoom : -skip ${1=2},${2=0.5},${3=0.5},${4=0.5},${5=0}
-e[^-1] "Apply zoom effect on image$?, with factor $1 and center ($2,$3)."
-v - -repeat @# -l[$>]
-if {d==1}
({(w-1)*$2*(1-1/$1)},{(w-1)*($2+(1-$2)/$1)})
({(@{-2,h}-1)*$3*(1-1/$1)};{(@{-2,h}-1)*($3+(1-$3)/$1)})
-r[-2--1] [-3],[-3],1,1,3 -a[-2--1] c -warp[-2] [-1],0,1,$5
-else
({(w-1)*$2*(1-1/$1)},{(w-1)*($2+(1-$2)/$1)})
({(@{-2,h}-1)*$3*(1-1/$1)};{(@{-2,h}-1)*($3+(1-$3)/$1)})
({(@{-3,d}-1)*$4*(1-1/$1)}/{(@{-3,d}-1)*($4+(1-$4)/$1)})
-r[-3--1] [-4],[-4],[-4],1,3 -a[-3--1] c -warp[-2] [-1],0,1,$5
-endif
-rm[-1]
-endl -done -v +
cracks : -skip ${1=0.2},${2=40},${3=0}
-e[^-1] "Add random cracks to image$?, with density $1."
-v - -repeat @# -l[$>]
({im},{iM}) [-2],[-2],1,1 -noise[-1] $1,2 -distance[-1] 1 -sharpen[-1] 10000
-if $3 -g[-1] xy -+[-2,-1] -n[-1] -1,1 -else -n[-1] 0,1 -endif
-*[-1] $2 -+[-3,-1] -c[-2] @-1 -rm[-1]
-endl -done -v +
light_patch : -skip ${1=10},${2=0.9},${3=1.7}
-e[^-1] "Apply light patches to image$?, with density $1, darkness $2 and lightness $3."
-v - -repeat @# -l[$>]
-n 0,255 $1,$1 -noise[-1] 40 -r[-1] [-2],5 -c[-1] 0,255
-n[-1] $2,$3 -* -c 0,255
-endl -done -v +
noise_hurl : -skip ${1=10}
-e[^-1] "Add hurl noise to image$?, with amplitude $1%."
-v - -repeat @# -l[$>]
--f 0 -noise[-1] 10 -n[-1] @{-2,m},@{-2,M} 100%,100%,1,1,-2
-noise[-1] $1,2 ->=[-1] 0 -r[-1] [-2]
-*[-2] [-1] -*[-1] -1 -+[-1] 1 -*[-3,-1] -+
-endl -done -v +
pixelize : -skip ${1=20},${2=$1},${3=$1}
-e[^-1] "Pixelize image$? with scales ($1%,$2%,$3%)."
-v - -repeat @# -l[$>] whd={w},{h},{d} -r $1%,$2%,$3%,100%,2 -r $whd -endl -done -v +
scanlines : -skip ${1=60},${2=2},${3=0},${4=0},${5=0}
-e[^-1] "Apply scanlines effect on image$?, with amplitude $1, bandwidth $2, shape $3, angle $4 deg. and offset $5."
-v -
theta={$4*pi/180} C={cos($theta)} S={-sin($theta)}
-repeat @# -l[$>]
100%,100%,1,1,"x" --[-1] {w/2} 100%,100%,1,1,'y'
--[-1] {h/2-$5} -*[-2] $S -*[-1] $C -+[-2,-1]
-_ripple$3[-1] $1,$2
-n[-1] {-$1},$1
-+ -cut 0,255
-endl -done -v +
shade_stripes : -skip ${1=5},${2=1},${3=0.8},${4=2}
-e[^-1] "Add "@{-arg\ 1+!$2,vertical,horizontal}" shaded stripes to image$?, with frequency $1, darkness $3 and lightness $4."
-v - -n 0,255 -repeat @# -l[$>]
{max(1,w*($2!=0))},{max(1,h*($2==0))} -noise[-1] $1,2 -distance[-1] 1 -r[-1] [-2] -n[-1] $3,$4 -* -c 0,255
-endl -done -v +
shadow_patch : -skip ${1=0.7}
-e[^-1] "Apply shadow patches to image$?, with opacity $1."
-v - -repeat @# -l[$>]
100%,100%,1,1 -shift[-1] -2,-2 -shift[-1] 1,1
-plasma[-1] 3,0.3,8 -abs[-1] -b[-1] 1 -c[-1] 3%,15% -r[-1] [-2]
-n[-1] $1,1 -*
-endl -done -v +
spread : -skip ${1=3},${2=$1},${3=0}
-e[^-1] "Spread pixel of image$? randomly, with amplitudes ($1,$2,$3)."
-v - -repeat @# -l[$>]
100%,100%,100%,3
-sh[-1] 0,0 -rand[-1] {-$1},$1 -rm[-1]
-sh[-1] 1,1 -rand[-1] {-$2},$2 -rm[-1]
-sh[-1] 2,2 -rand[-1] {-$3},$3 -rm[-1]
-warp[-2] [-1],1 -rm[-1]
-endl -done -v +
stripes_y : -skip ${1=10}
-e[^-1] "Add vertical stripes to image$?, with frequency $1."
-v - -repeat @# -l[$>]
100% -noise[-1] $1,2 -*[-1] 255 -r[-1] [-2]
-*[-1] 0.15 -+ -c 0,255
-endl -done -v +
texturize_canvas : -check "${1=20}>=0 && ${2=3}>=0 && ${3=0.6}>=0 && ${4=80}"
-e[^-1] "Add canvas texture to image$?, with amplitude $1, fibrousness $2 and emboss level $3."
-repeat @# -l[$>]
{w},{h} -rand[-1] 0,255 --blur_x[-1] $2 -blur_y[-2] $2 -+[-2,-1] -g[-1] -a[-2,-1] c
--compose_channels[-1] + -orientation[-2] -compose_channels[-2] + -n[-2] $3,1 -n[-1] 0,255
-sharpen[-1] 80 -*[-2,-1] -n[-1] -$1,$1 -+ -c 0,255
-endl -done -v +
texturize_paper :
-e[^-1] "Add paper texture to image$?."
-v - -repeat @# -l[$>]
[-1] 30%,30% -noise[-1] 1,2 -r[-1] [-2],[-2],[-2],1,0 -ifft[-1]
-rm[-1] -shift[-1] 50%,50%,50%,0,2 -sharpen[-1] 1 -n[-1] 1,1.2 -r[-1] [-2]
-*[-2,-1] -c[-1] [-2],[-2] -rm[-2]
-endl -done -v +
vignette : -check "${1=100}>=0 && ${2=70}>=0 && $2<=100 && ${3=90}>=0 && $3<=100"
-e[^-1] "Add vignette effect to image$?, with strength $1 and size $2."
-v - -repeat @# -l[$>]
mM={im},{iM} d={max(w,h)}
$d,$d -=[-1] 1,50%,50% -distance[-1] 1 -r[-1] [-2],2
-c[-1] $2%,$3% -n[-1] 0,$1 -- -c $mM
-endl -done -v +
watermark_visible : -skip "${1=\251\ G\47MIC}" -check "${2=0.3}>0 && $2<1 && ${3=53}>0 && ${6=0.5}>=0" -skip ${4=25},${5=1}
-e[^-1] @{-arg\ 1+!$5,Add,Remove}" visible watermark '$1' on image$?, with opacity $2, size $3, angle $4 deg."
-v - -repeat @# -l[$>]
0 -t[-1] "$1",0,0,$3,1,255 -rotate[-1] $4,0,0 -b[-1] $6 -n[-1] 0,255
-r[-1] [-2],0,2 -+[-1] [-2] -c[-1] 0,255
-if $5 -*[-1] $2 -*[-2] {1-$2} -+
-else -*[-1] $2 -- -/ {1-$2}
-endif
-c 0,255
-endl -done -v +
blend : -skip ${1=alpha},${2=1},${3=1},${4=0}
-v -
-if {arg(1,{'$1'})=={'['}}
n={narg($*)} mode=@{-arg\ 1+($n>=2),alpha,$2}
-v + -e[^-1] "Blend image$? with "@{-arg\ 1+$4,base,top}" layer $1, using '"$mode"' mode and opacity $3." -v -
-repeat @# -pass$1 -l[$>,-1] -if $4 -rv -endif -blend $mode,$3 -endl -done -v + -return
-endif
-v + -e[^-1] "Blend all image$? together, using '$1' mode and opacity $2." -v -
-repeat {@#-1} -l[0,1]
-r[1] [0],[0],[0],100%,0,0,0.5,0.5
s={s0=if(@{0,s}<3,1,3);s1=if(s<3,1,3);max(s0,s1)}
-to_colormode[0] {$s+1-(@{0,s}%2)}
-to_colormode[1] {$s+1-(s%2)}
-if {@{0,s}==2||@{0,s}==4}
-if {s==2||s==4}
-sh[0,1] 0,{s-2} -_blend_$1[2,3] -rm[2,3]
-if {$1'=='alpha}
-sh[0,1] 0,{@{0,s}-2} -sh[0,1] 100%,100% -*[2,4] -*[3,4] -rm[2,3]
--channels[1] 100% -sh[1] 100%,100% -f[3] 255 -rm[3]
-j[0] [1],0,0,0,0,{max(0,min(1,$2))},[2],255 -rm[1,2]
-sh[0] 0,{s-2} -sh[0] 100%,100% -+[2] 1e-10 -/[1,2] -rm[1] -c 0,255
-else
-sh[1] 0,{s-2} -sh[1] 100%,100% -j[0] [2],0,0,0,0,{max(0,min(1,$2))},[3],255 -rm[^0]
-endif
-else
-sh[0] 0,{@{0,s}-2} -rv[1,2] -_blend_$1[1,2] -j[1] [2],0,0,0,0,{max(0,min(1,$2))} -rm[^0]
-endif
-else
-if {s==2||s==4}
-sh[1] 0,{s-2} -_blend_$1[0,2] -rm[2]
-sh[1] 100%,100% -j[0] [1],0,0,0,0,{max(0,min(1,$2))},[2],255 -rm[^0]
-else
-_blend_$1 -j[0] [1],0,0,0,0,{max(0,min(1,$2))} -rm[1]
-endif
-endif
-endl -done -v +
_blend_alpha :
_blend_and :
-and[1] [0]
_blend_add :
-+[1] [0] -c[1] 0,255
_blend_average :
-+[1] [0] -/[1] 2
_blend_blue :
-sh[0] 0,1 -j[1] [2] -rm[2]
_blend_burn :
---[0] 255 -+[1] 0.1 -/[2] [1] -rm[1] -+[1] 1 -*[1] 255 -c[1] 0,255
_blend_darken :
-min[1] [0]
_blend_difference :
--[1] [0] -abs[1]
_blend_divide :
-+[1] 0.1 -^[1] -1 -*[1] [0] -*[1] 255 -c[1] 0,255
_blend_dodge :
--[1] 255.1 -^[1] -1 -*[1] [0] -*[1] -255 -c[1] 0,255
_blend_edges :
--blend_edges 0.5 -rm[1]
_blend_exclusion :
--*[0,1] -/[2] -127.5 -+[1,2] -+[1] [0]
_blend_freeze :
-*[1] -255 --[1] 0.1 ---[0] 255 -sqr[2] -/[2] [1] -rm[1] -+[1] 1 -*[1] 255 -c[1] 0,255
_blend_grainextract :
--[1] [0] -*[1] -1 -+[1] 128 -c[1] 0,255
_blend_grainmerge :
-+[1] [0] --[1] 128 -c[1] 0,255
_blend_green :
-sh[0] 0,0 -sh[0] 2,2 -j[1] [2] -j[1] [3],0,0,0,2 -rm[2,3]
_blend_hardlight :
--*[0,1] -/[2] 127.5 --+[0,1] -*[3] 2 --[3] 255 --[3] [2] ->[1] 128
-j[2] [3],0,0,0,0,1,[1] -rm[1,3] -c[1] 0,255
_blend_hardmix :
-+[1] [0] ->=[1] 255 -*[1] 255
_blend_hue :
-to_color -sh 0,2 -rgb2hsv[2,3] -sh[2] 1,2 -j[1] [4],0,0,0,1 -rm[4] -hsv2rgb[2,3] -rm[2,3]
_blend_interpolation :
--*[0] {pi/255} -*[1] {pi/255} -cos[1,2] -+[1,2] --[1] 2 -*[1] -63.75 -c[1] 0,255
_blend_lighten :
-max[1] [0]
_blend_lightness :
-to_color -sh 0,2 -rgb2lab[2,3] -sh[2] 1,2 -j[1] [4],0,0,0,1 -rm[4] -lab2rgb[2,3] -rm[2,3]
_blend_luminance :
-to_color -sh 0,2 -rgb2ycbcr[2,3] -sh[2] 1,2 -j[1] [4],0,0,0,1 -rm[4] -ycbcr2rgb[2,3] -rm[2,3]
_blend_linearburn :
-+[1] [0] --[1] 255 -c[-1] 0,255
_blend_linearlight :
-*[1] 2 -+[1] [0] --[1] 255 -c[1] 0,255
_blend_multiply :
-*[1] [0] -/[1] 255
_blend_negation :
-+[1] [0] --[1] 255 -abs[1] -*[1] -1 -+[1] 255
_blend_or :
-or[1] [0]
_blend_overlay :
--*[0,1] -/[2] 127.5 -+[1] [0] -*[1] 2 --[1] 255 --[1] [2] --<[0] 128 -j[1] [2],0,0,0,0,1,[3] -rm[2,3] -c[1] 0,255
_blend_pinlight :
-*[1] 2 --blend darken --[1] 256 --blend[0,1] lighten ->=[1] 0
-j[2] [3],0,0,0,0,1,[1] -rm[1,3]
_blend_reflect :
--[1] 255.1 -*[1] -1 --sqr[0] -/[2] [1] -rm[1] -c[1] 0,255
_blend_red :
-sh[0] 1,100% -j[1] [2],0,0,0,1 -rm[2]
_blend_saturation :
-to_color -sh 0,2 -rgb2hsv[2,3] -shift[2,3] 0,0,0,-1,2 -sh[2] 1,2 -j[1] [4],0,0,0,1 -rm[4] -shift[2,3] 0,0,0,1,2 -hsv2rgb[2,3] -rm[2,3]
_blend_screen :
---[0] 255 --[1] 255 -*[1,2] -/[1] 255 -*[1] -1 -+[1] 255
_blend_shapeaverage :
-norm[1] -label[1] N={iM+1}
-repeat @{0,s} --channels[0] $> m={im} M={iM} -n[-1] 0,{1-1/256} -+[-1] [1] -histogram[-1] {$N*256},0,{$N-1/256}
-i[-2] 256,1,1,1,'x*($M-$m)/255+$m' -r[-2] [-1],0,2 -*[-2] [-1] -r[-2,-1] $N,1,1,1,2 -+[-1] 1e-8 -/[-2,-1] -done
-a[2--1] c -map[1] [2] -rm[2]
_blend_shapeaverage0 :
-norm[1] --!=[1] 0 -label[1] N=@{1,iM+1}
-repeat @{0,s} --channels[0] $> m={im} M={iM} -n[-1] 0,{1-1/256} -+[-1] [1] -histogram[-1] {$N*256},0,{$N-1/256}
-i[-2] 256,1,1,1,'x*($M-$m)/255+$m' -r[-2] [-1],0,2 -*[-2] [-1] -r[-2,-1] $N,1,1,1,2 -+[-1] 1e-8 -/[-2,-1] -done
-a[3--1] c -map[1] [3] -rm[3] -*[1,2]
_blend_softburn :
---[0] 255.1 -^[2] -1 -*[2] [1] -*[2] -127.5 ---[0] 255 --+[1] 0.1 -/[3,4] -*[3] 127.5 -+[3] 255 -+[1] [0] ->[1] 255
-j[2] [3],0,0,0,0,1,[1] -rm[1,3] -c[1] 0,255
_blend_softdodge :
---[1] 255.1 -^[2] -1 -*[2] [0] -*[2] -127.5 ---[1] 255 --+[0] 0.1 -/[3,4] -*[3] 127.5 -+[3] 255 -+[1] [0] ->[1] 255
-j[2] [3],0,0,0,0,1,[1] -rm[1,3] -c[1] 0,255
_blend_softlight :
--/[0] 255 -/[1] 255 --sqr[-1] -*[2] [1] -*[1] [3] -*[1] -2 -*[2] 2 -+[1-3] -*[1] 255 -c[1] 0,255
_blend_stamp :
-*[1] 2 -+[1] [0] --[1] 255 -c[1] 0,255
_blend_subtract :
--[1] [0] -*[1] -1 -c[1] 0,255
_blend_value :
-to_color -sh 0,2 -rgb2hsv[2,3] -sh[2] 0,1 -j[1] [4] -rm[4] -hsv2rgb[2,3] -rm[2,3]
_blend_vividlight :
-*[1] 2 --blend burn --[1] 256 --blend[0,1] dodge ->=[1] 0
-j[2] [3],0,0,0,0,1,[1] -rm[1,3]
_blend_xor :
-xor[1] [0]
blend_edges : -check {$1>=0}
-e[^-1] "Blend image$? using 'edges' mode, with smoothness $1."
-if {@#>1} -v - -to_rgb -r[^0] [0],0,0,0.5,0.5 -repeat @# -l[$>]
--gradient_norm -+[-1] 1 -b[-1] $1 -n[-1] 1,10 -sqr[-1] -s[-2] c -*[-4--2] [-1] -a[-4--1] c
-endl -done -r[^0] [0],0,0,0.5,0.5 -+ -s[-1] c -/[-4--2] [-1] -rm[-1] -a[-3--1] c -v + -endif
blend_fade :
-e[^-1] "Blend image$? together using fading pattern $1."
-v - -r @{-max_whds},0
-pass$1 0 -r[-1] [0],[0],[0],100%,1 -max[-1] 0 -min[-1] {@#-2}
-repeat {@#-1} ---[-1] $> -abs[-1] --[-1] 1 -*[-1] -1 -max[-1] 0 -*[$>,-1] -done -rm[-1]
-+ -v +
_fade :
-r[-2] [-3],5 -r[-1] [-2],3 -c[-1] $1%,$2% -n[-1] 0,1 -j[-3] [-2],0,0,0,0,1,[-1] -rm[-2,-1]
blend_median :
-e[^-1] "Blend image$? using 'median' mode."
-v - -to_colormode 0 -r @{-max_whd},100%,0,0,0.5,0.5,0.5 whd={w},{h},{d} -r 100%,{h*d},1,100%,-1
-if {@#==2} -+ -/ 2
-elif {@#%2}
-repeat {@#/2} -repeat {@#-1-$>} -l[$>,{$>+1}] --max -min[0,1] -endl -done -done
-k[{int(@#/2)}]
-elif {!(@#%2)}
-repeat {@#/2+1} -repeat {@#-1-$>} -l[$>,{$>+1}] --max -min[0,1] -endl -done -done
-k[{int(@#/2-1)},{@#/2}]
-+ -/ 2
-endif
-r $whd,100%,-1 -v +
blend_seamless : -check "${2=0}>=0 && ${3=100%}>=0" -skip ${1=0}
-v - s0="non-mixed" s1="mixed"
-v + -e[^-1] "Blend image$? using seamless mode (Poisson-based), in "${s{$1!=0}}" mode with inner fading $2 and outer fading $3." -v -
-to_a[^0] -r @{0,w+32},@{0,h+32},1,100%,0,0,0.5,0.5
-if {$3'!='100%}
-repeat {@#-1} -l[0,1]
--blend_seamless $1,$2,100% -channels[-2] 100% -!=[-2] 0 -distance[-2] 1
iM=@{-2,M} ic={if(@{-is_percent\ $3},2*$3*$iM,1+$3)}
-if {$ic<=$iM} -c[-2] 0,{max(1,$ic)} -n[-2] 0,1
-else -n[-2] 0,{max(0,2-$ic/$iM)}
-endif
-*[-2] -1 -+[-2] 1
-j[0] [2],0,0,0,0,1,[1] -rm[1,2]
-endl -done
-else
-repeat {@#-1} -l[0,1]
--r[0] 1,1,1,100%,2 avg=@-1 -rm[-1]
-split_opacity[-1] -!=[-1] 0 -*[-2] [-1] -erode[-1] 3
-g[0,1] xy,1
-*[-3,-2] [-1]
-if $1
--a[0,1] c --a[2,3] c -norm[-2,-1]
-<[-2,-1] -*[-2,-1]
-endif
-if {$2}
-distance[-1] 0
iM={iM} ic={if(@{-is_percent\ $2},2*$2*$iM,1+$2)}
-if {$ic<=$iM} -c[-1] 0,{max(1,$ic)} -n[-1] 0,1
-else -n[-1] 0,{max(0,2-$ic/$iM)}
-endif
-endif
-j[-5] [-3],0,0,0,0,1,[-1]
-j[-4] [-2],0,0,0,0,1,[-1]
-rm[-3--1]
-g[0] x,-1 -g[1] y,-1 -+
-fft[0]
100%,100%,1,1,'-(4-2*cos(2*x*pi/w)-2*cos(2*y*pi/h))'
-=[-1] 1 -/[-3,-2] [-1] -rm[-1]
-=[-2] 0 -=[-1] 0
-ifft[-2,-1] -rm[-1]
--fc[-1] $avg
-+[-2,-1]
-c 0,255
-endl -done
-endif
-z 16,16,{w-17},{h-17} -v +
fade_diamond : -skip ${1=70},${2=90}
-e[^-1] "Create ($1%,$2%) diamond-shaped fading from image$?."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
(0,1,0;1,1,1;0,1,0) -_fade $1,$2
-endl -done -v +
fade_linear : -skip ${1=45},${2=30},${3=70}
-e[^-1] "Create ($2%,$3%) linear fading from image$?, with angle $1 deg."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
64,64,1,1,"x*cos($1*pi/180) + y*sin($1*pi/180)" -_fade $2,$3
-endl -done -v +
fade_radial : -skip ${1=30},${2=70}
-e[^-1] "Create ($1%,$2%) radial fading from image$?."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
100%,100% -=[-1] 1,50%,50% -distance[-1] 1 -_fade $1,$2
-endl -done -v +
fade_x : -skip ${1=30},${2=70}
-e[^-1] "Create ($1%,$2%) horizontal fading from image$?."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}] (0,1) -_fade $1,$2 -endl -done -v +
fade_y : -skip ${1=30},${2=70}
-e[^-1] "Create ($1%,$2%) vertical fading from image$?."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}] (0;1) -_fade $1,$2 -endl -done -v +
fade_z : -skip ${1=30},${2=70}
-e[^-1] "Create ($1%,$2%) transversal fading from image$?."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}] (0/1) -_fade $1,$2 -endl -done -v +
sub_alpha : -check "${2=1}>=1 && "@{"-is_image_arg $1"}
-e[^-1] "Compute minimal alpha-channel difference between image$? and base image $1, with opacity gain $2."
-v - -remove_opacity -repeat @# -pass$1 0 -l[$>,-1]
-to_colormode 0 -r @{-max_whd},100%,0,0,0.5,0.5
-->[0,1] -*[2] 255
--[0,2] [1] -replace[2] 0,1
-i[2] [0] -/[2,3]
-compose_channels[2] max
-*[2] $2 -c[2] 0,1
--replace[2] 0,1 -/[0,3] -+[0,1] -*[1] 255 -a c
-endl -done -v +
animate : -skip ${1=30},${2=0},${3=""},${4=10},${5=1},"${6=}"
-if {isval($1)}
-if $2 -e[0--4] "Animate image$?, with a delay of $1 ms, and ping-pong mode."
-else -e[0--4] "Animate image$?, with a delay of $1 ms."
-endif
-if {!@#} -return -endif
-v -
speed=$1
pause=-1
direction=1
frame=0
-do
-w[$frame] @{-fitscreen[]\ @{$frame,w},@{$frame,h}},1,0,-1,-1,@{$frame,b}.@{$frame,x}
frame={$frame+$direction}
-if $2
-if {$frame==-1} frame=0 direction=1
-elif {$frame==@#} frame={@#-1} direction=-1
-endif
-else frame={$frame%@#}
-endif
-wait $speed
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,D}} -w[] {@{!,w}*1.5},{@{!,h}*1.5} -wait -1 -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,C}} -w[] {@{!,w}/1.5},{@{!,h}/1.5} -wait -1 -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,R}} -w[] @{0,w},@{0,h} -wait -1 -endif
-if @{!,o} speed={min(500,max(10,$speed-10*@{!,o}))} -wait -1 -endif
-if @{!,SPACE}
-if {$pause>=0} direction=$pause pause=-1
-else pause=$direction direction=0 -endif
-wait -1
-endif
-while {@!" && "!@{!,Q}" && "!@{!,ESC}} -w 0 -v +
-else
-e[0--3] "Compute animated version of filter '$1', from parameters $2 to $3 with $4 frames."
-if {!($5||narg("$6"))} -return -endif
-v - ($2) ($3) -y[-2,-1] x -a[-2,-1] y -r[-1] 100%,$4,1,1,3 -mv[-1] 0 -rprogress 0
-repeat {@#-1}
-v + -e[] " > Animate image ["$>"]" -v -
-repeat $4 --l[0,1]
-$1[-1] @{0,{$>*@{0,w}}-{($>+1)*@{0,w}-1}} -rm[0]
-if {narg("$6")} -o @{-filename\ "$6",@{>,-2},$>} -endif
-if {!$5} -rm -endif
-rprogress {100*($>+1)/$4}
-v + -e[] "\r > Animate image ["@{>,-2}"] : Frame "{$>+1}"/$4    " -v -
-endl -done
-rm[1] -done -rm[0] -v +
-endif
apply_camera : -skip "${1=},${4=}" -check "${2=0}>=0 && ${3=0}>=0"
-e[^-1] "Apply command '$1' on camera stream \#$2, with $3 frames skip and output filename '$4'." -v -
-l[] i=0 -do
-camera $2,1,$3 $1 -w[-1] -1,-1,"(Camera \#$2, "{w}x{h}")"
-if {narg("$4")} -o[-1] @{-filename\ "$4",$i} i={$i+1} -endif
-if @{!,S} -o[-1] gmic_camera.png -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,D}} -w[] {@{!,w}*1.5},{@{!,h}*1.5} -wait -1 -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,C}} -w[] {@{!,w}/1.5},{@{!,h}/1.5} -wait -1 -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,R}} -w[] @{0,w},@{0,h} -wait -1 -endif
-rm[-1]
-while {@!" && "!@{!,ESC}" && "!@{!,Q}} -camera $2,0 -endl -v +
apply_files : -skip "${3=gmic_}","${4=}",${5=0}
-v -
({'"$2"'}) -autocrop[-1] 32 -replace[-1] 32,{','} files=@{-u\ @{-1,t}}
-if {w>128} -z[-1] 0,127 s_files=@{-1,t}... -else s_files=$files -endif
-rm[-1]
-m "_apply_files : $""=_file _nb_files=$""#" -_apply_files $files -uncommand _apply_files
-m "_apply_files : $1"
-v + -e[^-1] "Apply command '$1' on files '"$s_files"' and save result with prefix '$3'.\n" -v -
-repeat $_nb_files -l[]
file=${_file{$>+1}}
_file=@{-basename\ $file}
-if {narg("$4")} 0 -nm[-1] $_file output_file="$3"@{-1,b}."$4" -rm[-1] -else output_file="$3"$_file -endif
-v + -e[] "\r - Image "{1+$>}/$_nb_files" ["$_file"] -> ["$output_file"]                    " -v -
$file -_apply_files
-o $output_file
-if $5 -w[-1] @{-fitscreen\ {w},{h},{d}},1,0,-1,-1,$_file -endif
-rm
-onfail -v + -e[] "\n - Error occured on file '"$file"'.\n" -v -
-endl -done -uncommand _apply_files -v +
apply_video : -skip "${1=},${2=},${3=}" -check "isint(${4=0}) && $4>=0 && isint(${5=-1}) && ($5>=0 || $5==-1) && ${6=1}>=1"
-e[^-1] "Apply command '$1' on video stream '$2', with output filename '$3', first frame $4, last frame $5 and frame step $6."
-v - -l[]
frame=$4 i=0 basename=@{"-basename \"$2\""}
-do
-i "$2",$frame
-if @#
$1 -w -1,-1,"(Video '"$basename"', "{w}x{h}")"
frame={$frame+$6}
-if {$5>=0" && "$frame>$5} frame=$4 -endif
-if {narg("$3")" && "$i>=0} -o[-1] @{-filename\ "$3",$i} i={$i+1} -endif
-if @{!,S} -o[-1] gmic_video.png -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,D}} -w[] {@{!,w}*1.5},{@{!,h}*1.5} -wait -1 -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,C}} -w[] {@{!,w}/1.5},{@{!,h}/1.5} -wait -1 -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,R}} -w[] @{0,w},@{0,h} -wait -1 -endif
-else frame=$4 i=-1
-endif
-rm
-while {@!" && "!@{!,ESC}" && "!@{!,Q}} -i "$2",0,0,0
-endl -v +
average_video : -check "isint(${2=0}) && $2>=0 && isint(${3=-1}) && ($3>=0 || $3==-1) && ${4=1}>=1" -skip "${5=}"
-e[^-1] "Average frames of video file '$1', with first frame $2, last frame $3, frame step $4 and output filename '$5'.\n"
-v - -l[]
frame=$2 i=0 stopflag=0 N=0
-do
-l[] -i "$1",$frame
-if @#
-v + -e[] "\r  > Frame \#"$frame -v -
frame={$frame+$4} N={$N+1}
-else stopflag=1
-endif
-onfail stopflag=1
-endl
-if {@#>1} -+ -endif
-if {narg("$5")} --/[-1] $N -c[-1] 0,255 -o[-1] @{-filename\ "$5",$i} -rm[-1] i={$i+1} -endif
-if @!
--n 0,255 -w[-1] -1,-1,0,"Frame \#"$frame
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,D}} -w[] {@{!,w}*1.5},{@{!,h}*1.5} -wait -1 -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,C}} -w[] {@{!,w}/1.5},{@{!,h}/1.5} -wait -1 -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,R}} -w[] @{0,w},@{0,h} -wait -1 -endif
-rm[-1]
-endif
-while {!$stopflag" && "($frame<$3" || "$3==-1)}
-/ $N -c 0,255
-endl -v +
files2video : -check "isint(${3=25}) && $3>0" -skip "${2=output.avi}",${4=mp4v}
-v -
({'"$1"'}) -autocrop[-1] 32 -replace[-1] 32,{','} files=@{-u\ @{-1,t}}
-if {w>128} -z[-1] 0,127 s_files=@{-1,t}... -else s_files=$files -endif
-rm[-1]
-m "_files2video : $""=_file _nb_files=$""#" -_files2video $files -uncommand _files2video
-v + -e[^-1] "Convert image files '"$s_files"' into frames of output video '$2', with $3 fps and $4 codec.\n" -v -
-repeat $_nb_files -l[]
file=${_file{$>+1}}
_file=@{-basename\ $file}
-v + -e[] "\r - Image "{1+$>}/$_nb_files" ["$_file"] -> [$2]                    " -v -
-i $file -o "$2",$3,$4,1
-rm
-onfail -v + -e[] "\n - Error occured on input file '"$file"'.\n" -v -
-endl -done
-o $output_file,0,0,0 -v +
morph : -skip ${2=0.1},${3=5}
-e[^-1] "Create morphing sequence between image$?, with $1 intra-frames, smoothness $2 and precision $3.\n"
-v - -r[^0] [0],3 -i[0] (@#) --[0] 1 -repeat @0
-v + -e[] "\r > Morph image "$>" to image "{$>+1}".    " -v -
--equalize[-2,-1] -n[-2,-1] 0,255
--displacement[-1] [-2],$2,$3 --warp[-5] [-1],1,1,1,$1 -a[-$1--1] z -rm[-2]
--displacement[-3] [-2],$2,$3 --warp[-5] [-1],1,1,1,$1 -a[-$1--1] z -rm[-7--4,-2]
(1/0) -r[-1] [-2],3 -*[-3] [-1] -*[-2,-1] -mirror[-1] z -+[-2,-1] -s[-1] z
-mv[-$1--1] 1 -mv[1] @#
-done -mv[-1] 1 -rm[0] -v +
register_nonrigid : -check @{-is_image_arg\ $1}" && ${2=0.2}>=0 && ${3=5}>0 && ${4=0}>=0"
-e[^-1] "Register source image$? with destination image $1, using non-rigid warp with smoothness $1, precision $2 and $3 scale(s)."
-v - -pass$1 0 -equalize[-1] -n[-1] 0,255
-repeat {@#-1}
--equalize[$>] -n[-1] 0,255 --displacement[-2] [-1],$2,$3,$4 -rm[-2]
-warp[$>] [-1],1,1,1 -rm[-1]
-done -rm[-1] -v +
register_rigid : -check @{-is_image_arg\ $1}" && ${2=1}>=0 && isint(${3=0}) && $3>=0 && $3<=2"
-e[^-1] "Register source image$? with destination image $1, using rigid warp with smoothness $2."
-v - -pass$1 0 -equalize[-1] -b[-1] $2 -n[-1] 0,255
-repeat {@#-1}
--equalize[$>] -b[-1] $2 -n[-1] 0,255
--phase_correlation[-1] [-2] -rm[-2]
-shift[$>] @-1,0,$3 -rm[-1]
-done -rm[-1] -v +
transition_plasma : -check "isint(${1=10}) && $1>=2 && isint(${2=5}) && $2>=0 && ${3=0.5%}>=0"
-e[^-1] "Create plasma transition sequence between image$?, with $1 frames, scale $2, smoothness $3.\n"
-v -
-if {@#<2} -return -endif
-slices 0 -r @{-max_whds},3
off=0 -repeat {@#-1} -l[{$>+$off},{$>+$off+1}]
-v + -e[] "\r > Generate transition from image "$>" to image "{$>+1}".    " -v -
100%,100% -plasma[-1] 1,0,$2 -n[-1] 0,1
-repeat {$1-2} --<=[2] {($>+1)/$1} -b[-1] $3 [0] -j[-1] [1],0,0,0,0,1,[-2] -rm[-2] -rprogress {$>*100/($1-2)} -done
-rm[2] -mv[2--1] 1 off={$off+$1-2}
-endl -done -v +
transition3d : -check "isint(${1=10}) && $1>=2 && isint(${2=3}) && $2>0 && isint(${3=$2}) && $3>0" -skip ${4=1},${5=1},${6=0},${7=1}
-e[^-1] "Create 3d transition sequence between image$?, with $1 frames, $2x$3 tiles and rotation axis ($4,$5,$6).\n"
-v -
-if {@#<2} -return -endif
-slices 0 -to_rgb -r @{-max_whds},3
off=0 -repeat {@#-1} -l[{$>+$off},{$>+$off+1}]
-v + -e[] "\r > Generate transition from image "$>" to image "{$>+1}".    " -v -
$2,$3,1,1,'$4'
$2,$3,1,1,'$5'
$2,$3,1,1,'$6'
-a[-3--1] z
-permute[-1] zxyc -r[-1] 3,{$2*$3},1,1,-1
-repeat {h} rot$>=@{-1,0-2} -shift[-1] 0,-1,0,0 -done
-rm[-1]
--split_tiles[-2,-1] $2,$3 -mv[0,1] @#
N={$2*$3} i=0 y=0
-repeat $3
x=0
-repeat $2
lw=@{$i,w} lh=@{$i,h}
-imageplane3d[$i] -imageplane3d[$N] -r3d[$N] ${rot$i},-180 -c3d[$i,$N] -+3d[$i,$N]
x$i=$x y$i=$y x={$x+$lw} i={$i+1}
-done
y={$y+$lh}
-done
-repeat {$1-2}
-repeat $N -r3d[$>] ${rot$>},{180/($1-1)} --+3d[$>] ${x$>},${y$>},0 -done
-+3d[-$N--1] -c3d[-1]
-if $7
-i[-3] {2*@{-2,w}},{2*@{-2,h}},1,3,-1
-*3d[-1] 2 -j3d[-3] [-1],50%,50%,0,1,2,0,0 -rm[-1]
-to_rgba[-2] -replace_color[-2] 0,0,-1,-1,-1,255,0,0,0,0
-r[-2] [-1],[-1],1,100%,2
-else
-i[-3] @{-2,w},@{-2,h},1,3,-1 -j3d[-3] [-1],50%,50%,0,1,2,0,0 -rm[-1]
-to_rgba[-2] -replace_color[-2] 0,0,-1,-1,-1,255,0,0,0,0
-endif
-done
-rm[0-{$N-1}]
-nm[1--2] @{0,n}
off={$off+$1-2}
-endl -done
-v +
video2files : -check "isint(${3=0}) && $3>=0 && isint(${4=-1}) && ($4>=0 || $4==-1) && isint(${5=1}) && $5>=1" -skip ${2="frame.png"}
-e[^-1] "Split input video file '$1' into image frames '$2', with first frame $3, last frame $4, and frame step $5.\n"
-v -
frame=$3 stopflag=0
-do -l[]
-i "$1",$frame
-if @#
-o @{"-filename \"$2\","$frame} -rm
-v + -e[] "\r  > Frame \#"$frame -v -
frame={$frame+$5}
-else stopflag=1
-endif
-onfail stopflag=1
-endl -while {!$stopflag" && "($frame<=$4" || "$4==-1)}
-v +
_wrbytepnk :
-output_pink3d ${1}.pnk
_xpink :
filename=@{-file_rand}
prefix=pink.
-if {!@{-is_windows}}
-x "which "${prefix}${1}" >/dev/null 2>&1"
-if {@{}!=0} prefix="" -x "which "$1" >/dev/null 2>&1"
-if {@{}!=0} -error "Executable (pink.)"$1" not found in PATH, status = "@{}"!! Returning!!\n" -return -endif
-endif
-output_pink3d ${filename}.pnk -x ${prefix}${1}" "${filename}".pnk $2 "${filename}"_o.pnk >/dev/null 2>&1"
-else
-output_pink3d ${filename}.pnk -x $1" "${filename}".pnk $2 "${filename}"_o.pnk"
-endif
status=@{}
-file_rm ${filename}.pnk
-if {$status!=0\ &&\ {$1'!='seuilauto}} -error "Exec status is "${status}"." -return
-elif ${filename}_o.pnk -i ${filename}_o.pnk -file_rm ${filename}_o.pnk -k[-1]
-else -error "Exec error!!" -endif
_xpinks :
s=@{-1,s} -if {$s>1} -s[-1] c -endif
-repeat @# -l[@{>,-1}]  -_xpink $1,"$2" -k[-1] -endl -done
-if {$s>1} -a[-$s--1] c -endif
_xframe :
-line 0%,0%,100%,0% -line 0%,100%,100%,100% -line 0%,0%,0%,100% -line 100%,0%,100%,100%
output_pink3d :
-e[^-1] "Output image$? as file '$1' (in 3d pink extension of P5-coded PPM format)."
-v - -if {@#==1} filename0="$1"
-else -repeat @# filename$>=@{-filename\ "\"$1\"",$>} -done
-endif
-repeat @# -l[$>]
-if {d==1} -o[-1] ppm:${filename$>}
-else
({'P5\n{w}\ {h}\ {d}\n255\n'})
--channels[-2] 0 -y[-1] x -a[-2,-1] x
-o[-1] raw:${filename$>},char
-rm[-1]
-endif
-endl -done -v +
pink : -v -
-if {$#>1} ({"'${2--1}'"}) -replace[-1] {','},{"' '"} p=@{-1,t} -rm[-1] -else p=" " -endif
-v + -e[^-1] "Call pink package with cmd: \"$1$? "$p"$?\"." -v -
-repeat @# -l[@{>,-1}] -_xpinks $1,$p -endl -done -v +
pink_grayskel : -skip ${1=4},${2=0}
-check "${1=4}==4 || $1==8 || $1==6 || $1==26"
-repeat @# -l[@{>,-1}] -_xpinks "grayskel","null $1 $2" -endl -done
pink_heightmaxima : -check "${1=4}==4 || $1==8 || $1==6 || $1==26" -skip ${2=1}
-e[^-1] "Filter by heightmaxima exec with connectivity $1 height $2."
-v - -repeat @# -l[@{>,-1}]
s=@{-1,s} -if {$s>1} -s[-1] c -endif
-repeat @# -l[@{>,-1}] -_xpink "heightmaxima","$1 $2" -k[-1] -endl -done
-if {$s>1} -a[-$s--1] c -endif
-endl -done -v +
pink_heightminima : -check "${1=4}==4 || $1==8 || $1==6 || $1==26" -skip ${2=1}
-e[^-1] "Apply filter by heightminima exec with connectivity $1 height $2."
-v - -repeat @# -l[@{>,-1}]
s=@{-1,s} -if {$s>1} -s[-1] c -endif
-repeat @# -l[@{>,-1}] -_xpink "heightminima","$1 $2" -k[-1] -endl -done
-if {$s>1} -a[-$s--1] c -endif
-endl -done -v +
pink_htkern : -skip ${1=4},${2=""}
-repeat @# -l[@{>,-1}] -_xpinks htkern$2,"null $1" -endl -done
pink_lvkern : -skip ${1=4},${2=""}
-check "${1=4}==4 || $1==8 || $1==6 || $1==26"
-repeat @# -l[@{>,-1}] -_xpinks lvkern${2},"null $1" -endl -done
pink_reg_minima : -check "${1=4}==4 || $1==8 || $1==6 || $1==26"
-e[^-1] "Compute regional minima exec with connectivity $1."
-v - -repeat @# -l[@{>,-1}]
s=@{-1,s} -if {$s>1} -s[-1] c -endif
-repeat @# -l[@{>,-1}]  -_xpink "minima","$1" -k[-1] -endl -done
-if {$s>1} -a[-$s--1] c -endif
-endl -done -v +
pink_skelcurv : -skip ${1=0},${2=4},${3=""}
-e[^-1] "Curvilinear binary skeleton guided by a priority function or image from image$?, prio=$1, connectivity=$2, inhibit=$3."
-repeat @# -l[@{>,-1}] -_xpinks "skelcurv","$1 $2 $3" -endl -done
pink_skelend : -skip ${1=4},${2=0}
-repeat @# -l[@{>,-1}] -_xpinks "skelend","$1 $2" -endl -done
pink_skeleton : -skip ${1=0},${2=4},${3=""}
-repeat @# -l[@{>,-1}] -_xpinks "skeleton","$1 $2 $3" -endl -done
pink_skelpar : -skip ${1=4},${2=-1},${3=""}
-repeat @# -l[@{>,-1}] -_xframe -_xpinks "skelpar","$1 $2 $3" -endl -done
pink_wshed : -check "${1=4}==4 || $1==8 || $1==6 || $1==26" -skip ${2=0},${3=0}
-e[^-1] "Compute wshedtopo exec with connectivity $1 inversion $2 height $3."
-v - -repeat @# -l[@{>,-1}]
s=@{-1,s} -if {$s>1} -s[-1] c -endif
-if {d==1}
-check "${1=4}==4 || $1==8"
-repeat @# -l[@{>,-1}]
-if {$2!=0} -negative -endif
-f max(min(i,255),0)
-if {$3>=0} -pink heightminima,$1,$3 -endif
-pink wshedtopo,$1
-if {$2!=0} -negative -endif
-endl -done
-else
-check "$1==6 || $1==26"
-repeat @# -l[@{>,-1}]
-if {$2!=0} -negative -endif
-f max(min(i,255),0)
-if {$3>=0}
-pink heightminima,$1,$3
-endif
-pink wshedtopo,$1
-if {$2!=0} -negative -endif
-endl -done
-endif
-if {$s>1} -a[-$s--1] c -endif
-endl -done -v +
alert : -skip "${1=[G"{`39`}"MIC Alert]},${2=This is an alert box.},${3=OK}"
-if {@#==1}
-e[0--3] "Display alert box, with image$?, title '$1', message '$2' and buttons '${3--1}'."
-else
-e[0--3] "Display alert box, with title '$1', message '$2' and buttons '${3--1}'."
-endif
-v -
-if {@#==1} logo= -else logo=[] -endif
--l$logo
-if {@#==1} -to_rgb
-else
64,64 -polygon 3,50%,10%,10%,90%,90%,90%,1,1 -b 3 ->= 50%
--erode[-1] 5 --[-1] [-2] -==[-1] 0
-polygon[-1] 4,47%,43%,53%,43%,53%,66%,47%,66%,1,0 -circle[-1] 50%,76%,2,1,0
--*[0] 255 [-1] 100%,100% -a[-3--1] c --[-1] '3*(y-h/2)'
-*[-1] [-2] -rm[-2] -*[0] 255 -rv -a c
-drop_shadow 3,3,1 -i[0] 100%,100%,1,3,200 -blend alpha
-endif
-channels -1,2
$=arg
-repeat {$#-2} label=${arg{$>+3}} 0 -t[-1] $label,0,0,16,1,-200 -done
-r[^0] {min(128,max(64,@{-max_w[^0]}+12))},{min(48,max(24,@{-max_h[^0]}+12))},1,1,0,0,0.5,0.5
-+[^0] 200 -to_rgb[^0]
-mv[0] @#
[0],[0],1,1,'(y-h/2)' -*[-1] -2 -c[-1] -30,30 -+[0--3] [-1] -rm[-1] -c[^-1] 0,255
-repeat {@#-1} -l[$<]
--rectangle 0,0,100%,100%,1,0xFFFFFFFF,0
-rectangle[-1] 1,1,{w-2},{h-2},1,0xFFFFFFFF,0
-line[-1] 2,{h-3},{w-3},{h-3},1,150 -line[-1] {w-3},{h-3},{w-3},2,1,150
-line[-1] 1,1,{w-3},1,1,255 -line[-1] 1,1,1,{h-3},1,255
-rectangle[-1] 4,4,{w-5},{h-5},1,0xAAAAAAAA,0
--shift[-2] 1,1,0,0,2
-rectangle[-1] 0,0,100%,100%,1,0xFFFFFFFF,0
-rectangle[-1] 1,1,{w-2},{h-2},1,0xFFFFFFFF,150
-rectangle[-1] 4,4,{w-5},{h-5},1,0xAAAAAAAA,0
-rectangle[-3] 0,0,100%,100%,1,0xFFFFFFFF,0
-line[-3] 1,{h-2},{w-2},{h-2},1,150 -line[-3] {w-2},{h-2},{w-2},1,1,150
-line[-3] 0,0,{w-2},0,1,255 -line[-3] 0,0,0,{h-2},1,255
-i[0] 100%,100% -=[0] 1,0,0
-a c -endl -done
--l
-channels 0,3 -sh 1,100% --[50%--1] 200 -rm[50%--1] -frame 8,8,0
-if {@#<6} -a[^-1] x -else -append_tiles[^-1] , -endif
0 -t[-1] "$2",0,0,16,1,0,-200,-200,-200 -r[-1] {w+16},{h+8},1,4,0
-a[-2,-1] x,0.5 -rv -a y,0.5
-sh 1,100% -+[-1] 200 -rm[-1]
-rectangle 0,0,100%,100%,1,0xFFFFFFFF,0
-line 0,0,{w-2},0,1,0,255,255,255 -line 0,0,0,{h-2},1,0,255,255,255
-endl
-rm[-2]
--channels[-1] 0
(0,{w-1}) (0;@{-2,h-1}) -r[-2,-1] [-3],3 -a[-2,-1] c -round[-1] -rv[-2,-1] -*[-2,-1]
-discard[-1] 0 -r[-1] {h/2},2,1,1,-1
-channels[-2] 1,3 -rv[-2,-1]
100%,100% -repeat @{-3,w} x0=@{-3,($>,0)} y0=@{-3,($>,1)} -rectangle[-1] $x0,$y0,{$x0+@{0,w}-1},{$y0+@{0,h}-1},1,{1+$>} -done
-a[-2,-1] c
-repeat 9 -if {!@{!$>}} disp=$> -break -endif -done
-if {!narg($disp)} -error[0--4] "Command '-alert': Cannot open display window for alert box." -endif
selected={if($#==3,0,-1)} clicked=-1
-do
--channels[-1] 0,2
-if {$clicked>=0}
x0=@{-3,($clicked,0)} y0=@{-3,($clicked,1)}
-sh[$clicked] 7,9
-j[-2] [-1],$x0,$y0 -rm[-1]
-elif {$selected>=0}
x0=@{-3,($selected,0)} y0=@{-3,($selected,1)}
-sh[$selected] 4,6
-j[-2] [-1],$x0,$y0 -rm[-1]
-endif
-w$disp[-1] 100%,100%,0,"$1" -rm[-1] -wait
xm=@{!$disp,x} ym=@{!$disp,y} bm={@{!$disp,b}&1} val={i($xm,$ym,0,3)}
-if {$bm" && "$val} clicked={$val-1}
-elif {$bm" && "!$val" && "$clicked>=0} selected=$clicked clicked=-1
-elif {!$bm" && "$clicked>=0" && "$clicked==$val-1} -break
-endif
-if @{!$disp,ARROWRIGHT} selected={($selected+1)%@{-2,w}} -wait -1
-elif @{!$disp,ARROWLEFT} selected={($selected-1)%@{-2,w}+($selected==-1)} -wait -1
-elif {$selected>=0" && "@{!$disp,ENTER}} clicked=$selected -break
-endif
-while {@{!$disp}" && "!@{!$disp,ESC}}
-w$disp 0 -rm -u $clicked
-endl
-v +
arg :
-v - $=arg -u ${arg{1+($1)}} -v +
at : -skip ${1=0},${2=0},${3=0}
-v - --z[-1] ${1-3},${1-3} -u @-1 -rm[-1] -v +
autocrop_coords : -skip ${1=auto}
-v -
is_auto={$1'=='auto}
w={w} h={h} d={d}
value={i(w-1,h-1,d-1)} --=[-1] {1+$value},100%,100%,100% -_autocrop$is_auto[-1] ${1--1} -=[-1] $value,100%,100%,100%
x0={$w-w} y0={$h-h} z0={$d-d} -rm[-1]
--_autocrop$is_auto[-1] ${1--1}
x1={$x0+w-1} y1={$y0+h-1} z1={$z0+d-1} -rm[-1]
-u $x0,$y0,$z0,$x1,$y1,$z1
-v +
_autocrop0 : -autocrop $*
_autocrop1 : -skip $* -autocrop
average_color :
-v -
res=""
-repeat {s-1} -sh[-1] {1+$>},{1+$>} res=$res,{ia} -rm[-1] -done
-sh[-1] 0,0 -u {ia}$res -rm[-1]
-v +
basename : -skip ${2=unused}
-v -
-l[] ({"'$1'"}) -replace 92,47 -s +,47
-if {i==47} -a y $2=@{-1,t} -u ""
-elif {@#==1} -u @{-1,t} $2=""
-else -a[^-1] y -u @{-1,t} $2=@{-2,t}
-endif
-rm -endl
-v +
bin :
-v - dec=@{-bin2dec\ ${^0}} -v +
-e[^-1] "Convert binary integer"@{-arg\ 1+($#>1),"",s}" '${^0}' to octal '"@{-dec2oct\ $dec}"',
decimal '"$dec"', hexadecimal '"@{-dec2hex\ $dec}"' and string '"@{-dec2str\ $dec}"'."
bin2dec :
-v - res=@{-_$0\ $1} -repeat {$#-1} res=$res,@{-_$0\ @{-arg\ $>+2,${^0}}} -done -u $res -v +
_bin2dec :
({'@{-struncase\ $1}'})
is_negative=0
-if {@{-1,0}==45} -z[-1] 1,100% is_negative=1 -endif
-f[-1] "if(i>=48 && i<=49,(i-48)*2^(w-1-x),nan)"
-u {if($is_negative,-1,1)*@{-1,+}}
-rm[-1]
compress_gmic :
-e[] "" -v -
head_std={'"#@gmic"'}
-s -,10 N=@#
-repeat @# -l[$<]
-if {!($>%100)} -v + -e[] "\r  Process : "{round($>/$N*100)}% -v - -endif
-if {i=={'#'}}
head=@{-1,0-{min(5,h-1)}}
-if {{$head'!='$head_std}" || "(i[6]!={'" "'}" && "i[6]!={':'})} -rm[-1] -continue
-endif
-else
-l[-1] -s +,32,35 -if {@#>2} -k[0] -endif -a y -endl
-autocrop[-1] 32 -if {!w} -rm[-1] -continue -endif
-endif
-endl -done
-i[1--2] (10) -a y
-v + -e[] "\r Process : 100%"
compress_gmic_gimp :
-e[] "" -v -
head_std={'"#@gimp"'}
-s -,10 N=@#
-repeat @# -l[$<]
-if {!($>%100)} -v + -e[] "\r  Process : "{round($>/$N*100)}% -v - -endif
-if {i=={'#'}}
head=@{-1,0-{min(5,h-1)}}
-if {$head'!='$head_std} -rm[-1] -continue
-endif
-else
-l[-1] -s +,32,35 -if {@#>2} -k[0] -endif -a y -endl
-autocrop[-1] 32 -if {!w} -rm[-1] -continue -endif
-endif
-endl -done
-i[1--2] (10) -a y
-v + -e[] "\r Process : 100%"
dec :
-e[^-1] "Convert decimal integer"@{-arg\ 1+($#>1),"",s}" '${^0}' to binary '"@{-dec2bin\ ${^0}}"',
octal '"@{-dec2oct\ ${^0}}"', hexadecimal '"@{-dec2hex\ ${^0}}"' and string '"@{-dec2str\ ${^0}}"'."
dec2str :
-v - -u {`${^0}`} -v +
dec2bin :
-v - res=@{-_$0\ $1} -repeat {$#-1} res=$res,@{-_$0\ @{-arg\ $>+2,${^0}}} -done -u $res -v +
_dec2bin : -check isint($1)
res="" r={abs($1)}
-do res={$r%2}$res r={int($r/2)} -while $r
-u @{-arg\ 1+($1>=0),-,""}$res
dec2hex :
-v - res=@{-_$0\ $1} -repeat {$#-1} res=$res,@{-_$0\ @{-arg\ $>+2,${^0}}} -done -u $res -v +
_dec2hex : -check isint($1)
res="" r={abs($1)}
-do res=@{-_dec2hex_{$r%16}}$res r={int($r/16)} -while $r
-u @{-arg\ 1+($1>=0),-,""}$res
_dec2hex_0 : -u 0
_dec2hex_1 : -u 1
_dec2hex_2 : -u 2
_dec2hex_3 : -u 3
_dec2hex_4 : -u 4
_dec2hex_5 : -u 5
_dec2hex_6 : -u 6
_dec2hex_7 : -u 7
_dec2hex_8 : -u 8
_dec2hex_9 : -u 9
_dec2hex_10 : -u a
_dec2hex_11 : -u b
_dec2hex_12 : -u c
_dec2hex_13 : -u d
_dec2hex_14 : -u e
_dec2hex_15 : -u f
dec2oct :
-v - res=@{-_$0\ $1} -repeat {$#-1} res=$res,@{-_$0\ @{-arg\ $>+2,${^0}}} -done -u $res -v +
_dec2oct : -check isint($1)
res="" r={abs($1)}
-do res={$r%8}$res r={int($r/8)} -while $r
-u @{-arg\ 1+($1>=0),-,""}$res
fact : -check isint($1)
-v - res=1 -repeat $1 res={$res*($>+1)} -done -u $res -v +
file_mv :
-e[^-1] "Move file '$1' to location '$2'."
-v - -if @{-is_windows} -x "move "$1" "$2 -else -x "mv "$1" "$2 -endif -v +
file_rand :
-v -
-do filename=@{-path_tmp}@{-file_slash}gmic@%{round(?(0,9))}{round(?(0,9))}{round(?(0,9))}{round(?(0,9))}{round(?(0,9))}{round(?(0,9))}
-while $filename
-u $filename
-v +
file_rm :
-e[^-1] "Remove file '$1'."
-v -
-if @{-is_windows}
1 -nm[-1] "$1" dir=@{-1,f} base=@{-1,b} ext=@{-1,x} -rm[-1] com=""
-if {narg($dir)} com="cd \""$dir"\\\" && " -endif
-if {narg($ext)} com=${com}"del \""$base.$ext"\"" -else com=${com}"del \""$base"\"" -endif
-x $com
-else
-x "rm -f \"$1\""
-endif
-v +
file_slash :
-v - -if @{-is_windows} -u "\\" -else -u "/" -endif -v +
filename : -skip "${1=default}"
-v -
-if {$#==1} -u "$1"
-else
(${2--1}) -nm[-1] "$1" -u @{-1,f}@{-1,b}
-repeat {w}
-u @{}_{int(i/100000)%10}{int(i/10000)%10}{int(i/1000)%10}{int(i/100)%10}{int(i/10)%10}{i%10}
-shift[-1] -1
-done
-if {narg({'@{-1,x}'})} -u @{}.@{-1,x} -endif
-rm[-1]
-endif
-v +
fitratio_wh :
-v - -if {$3*$2>$1} -u {int($3*$2)},$2 -else -u $1,{int($1/$3)} -endif -v +
fitscreen : -check "$1>0 && $2>0 && ${3=1}>0 && ${4=128}>0 && ${5=85%}>0"
-v -
mp=@{-is_percent\ $4}
mw={if($mp,int(@{!,u}*$4),$4)}
mh={if($mp,int(@{!,v}*$4),$4)}
Mp=@{-is_percent\ $5}
Mw={if($Mp,int(@{!,u}*$5),$5)}
Mh={if($Mp,int(@{!,v}*$5),$5)}
w={if($3>1,$1+$3,$1)}
h={if($3>1,$2+$3,$2)}
-if {$w<$mw} h={max(1,int($h*$mw/$w))} w=$mw -endif
-if {$h<$mh} w={max(1,int($w*$mh/$h))} h=$mh -endif
-if {$w>$Mw} h={max(1,int($h*$Mw/$w))} w=$Mw -endif
-if {$h>$Mh} w={max(1,int($w*$Mh/$h))} h=$Mh -endif
w={max($w,$mw)}
h={max($h,$mh)}
-u $w,$h
-v +
gcd : -check "isint($1) && isint($2) && $1*$2!=0"
-v - -_gcd {max(abs($1),abs($2))},{min(abs($1),abs($2))} -v +
_gcd :
r={$1%$2} -if $r -u @{-_gcd\ $2,$r} -else -u $2 -endif
hex :
-v - dec=@{-hex2dec\ ${^0}} -v +
-e[^-1] "Convert hexadecimal integer"@{-arg\ 1+($#>1),s,""}" '${^0}' to binary '"@{-dec2bin\ $dec}"',
octal '"@{-dec2oct\ $dec}"', decimal '"$dec"' and string '"@{-dec2str\ $dec}"'."
hex2dec :
-v - res=@{-_$0\ $1} -repeat {$#-1} res=$res,@{-_$0\ @{-arg\ $>+2,${^0}}} -done -u $res -v +
_hex2dec :
({'@{-struncase\ $1}'})
is_negative=0
-if {@{-1,0}==45} -z[-1] 1,100% is_negative=1 -endif
-f[-1] "if(i>=48 && i<=57,i-48,if(i>=97 && i<=102,i-87,nan))*16^(w-1-x)"
-u {if($is_negative,-1,1)*@{-1,+}}
-rm[-1]
hex2str : -skip ${1=""}
-v -
-if {!narg("$1")} -return -endif
({'$*'})
-if {w<2} -rm[-1] -u "" -return -endif
-r[-1] 2,{w/2},1,1,-1 -f[-1] 'if(i>=97,i-87,i-48)' -f[-1] 'if(x==0,i*16+i(x+1),0)' -columns[-1] 0
-u @{-1,t} -rm[-1]
-v +
img2str :
-v -
-u "("
-repeat {s} c=$>
-repeat {d} z=$>
-repeat {h} y=$>
--z[-1] 0,$y,$z,$c,100%,$y,$z,$c
-u @{}@-1
-rm[-1]
-if {$y!=h-1} -u @{}; -endif
-e @{}
-done
-if {$z!=d-1} -u @{}/ -endif
-done
-if {$c!=s-1} -u @{}^ -endif
-done
-u @{}")"
-v +
img2text : -skip "${1= }"
-v - --l -s y -s -,0 -y x -if {@#>1} -i[1--2] ({'"$1"'}) -endif -a x -u @{0,t} -rm -endl -v +
img82hex :
-e[^-1] "Convert 8bits-valued vector$? into hexadecimal representations (ascii-encoded)."
-v - -mod 256 -y
-repeat @#
--f[$>] 'v=int(i)&15;v+if(v<10,48,87)'
-f[$>] 'v=int(i)>>4;v+if(v<10,48,87)'
-a[$>,-1] x
-done -v +
hex2img8 :
-e[^-1] "Convert hexadecimal representation$? (ascii-encoded) into 8bits-valued vectors."
-v - -repeat @#
-s[-1] x,2 -f[-2,-1] 'if(i>=97,i-87,i-48)' -*[-2] 16 -+[-2,-1]
-mv[-1] 0 -done -v +
is_3d :
-v - -u 1 -l -check3d 1 -onfail -u 0 -endl -v +
is_percent :
-v - -u {arg(-1,{'"$1"'})==37} -v +
is_image_arg :
-v - asc={'"$1"'} -u {arg(1,$asc)=={'['}&&arg(-1,$asc)=={']'}&&min($asc)>=45&&max($asc)<=122} -v +
is_windows :
-v - -u {narg($OS)==1" && "narg($WINDIR)==1} -v +
mad :
-v - ---[-1] @{-med[-1]} -abs[-1] -med[-1] -u {1.4826*@{}} -rm[-1] -v +
max_w :
-v - -u {arg(1,@{-_max_whds\ 4})} -v +
max_h :
-v - -u {arg(2,@{-_max_whds\ 4})} -v +
max_d :
-v - -u {arg(3,@{-_max_whds\ 4})} -v +
max_s :
-v - -u {arg(4,@{-_max_whds\ 4})} -v +
max_wh :
-v - -_max_whds 2 -v +
max_whd :
-v - -_max_whds 3 -v +
max_whds :
-v - -_max_whds 4 -v +
_max_whds :
w=0 h=0 d=0 s=0
-repeat @#
w={max($w,w)}
h={max($h,h)}
d={max($d,d)}
s={max($s,s)}
-mv[-1] 0 -done
-if {$1>=4} -u $w,$h,$d,$s
-elif {$1==3} -u $w,$h,$d
-elif {$1==2} -u $w,$h
-else -u $w
-endif
med :
-v - --sort[-1] -u @{-1,{w*h*d*s/2}} -rm[-1] -v +
color_med :
-v - -u "" s="" -repeat {s} --channels[-1] $> -u @{}$s@{-med[-1]} s=, -rm[-1] -done -v +
min_w :
-v - -u {arg(1,@{-_min_whds\ 4})} -v +
min_h :
-v - -u {arg(2,@{-_min_whds\ 4})} -v +
min_d :
-v - -u {arg(3,@{-_min_whds\ 4})} -v +
min_s :
-v - -_min_s @{-_min_whds\ 4} -v +
_min_s :
-u $4
min_wh :
-v - -_min_whds 2 -v +
min_whd :
-v - -_min_whds 3 -v +
min_whds :
-v - -_min_whds 4 -v +
_min_whds :
w={w} h={h} d={d} s={s}
-repeat @#
w={min($w,w)}
h={min($h,h)}
d={min($d,d)}
s={min($s,s)}
-mv[-1] 0 -done
-if {$1>=4} -u $w,$h,$d,$s
-elif {$1==3} -u $w,$h,$d
-elif {$1==2} -u $w,$h
-else -u $w
-endif
normalize_filename :
-v - ({'"$1"'}) -f[-1] 'if(i>=65&&i<=90,i+32,if(i==32,95,i))' -u @{-1,t} -rm[-1] -v +
oct :
-v - dec=@{-oct2dec\ ${^0}} -v +
-e[^-1] "Convert octal integer"@{-arg\ 1+($#>1),"",s}" '${^0}' to binary '"@{-dec2bin\ $dec}"', decimal '"$dec"',
hexadecimal '"@{-dec2hex\ $dec}"' and string '"@{-dec2str\ $dec}"'."
oct2dec :
-v - res=@{-_$0\ $1} -repeat {$#-1} res=$res,@{-_$0\ @{-arg\ $>+2,${^0}}} -done -u $res -v +
_oct2dec :
({'@{-struncase\ $1}'})
is_negative=0
-if {@{-1,0}==45} -z[-1] 1,100% is_negative=1 -endif
-f[-1] "if(i>=48 && i<=55,(i-48)*8^(w-1-x),nan)"
-u {if($is_negative,-1,1)*@{-1,+}}
-rm[-1]
padint : -skip ${2=4}
-v - -u "" -repeat $2 -u @{}{int($1/10^$<)%10} -done -v +
path_gimp :
-v -
-if {narg({'${GIMP2_DIRECTORY}'})} -u ${GIMP2_DIRECTORY} -v + -return -endif
-if {narg({'${USERPROFILE}'})} -u ${USERPROFILE}
-elif {narg({'${HOME}'})} -u ${HOME}
-else -u ""
-endif
-if @{}/.gimp-2.8/pluginrc -u @{}/.gimp-2.8
-elif @{}/.gimp-2.6/pluginrc -u @{}/.gimp-2.6
-else -u @{-path_tmp}
-endif -v +
path_tmp :
-v - -u ""
-if {narg({'${TMP}'})} -u ${TMP}
-elif {narg({'${TEMP}'})} -u ${TEMP}
-elif {narg({'${TMPDIR}'})} -u ${TMPDIR}
-elif {narg({'${HOME}'})} -u "/tmp"
-else -u ""
-endif
-v +
path_user :
-v - -u ""
-if {narg({'${APPDATA}'})} -u ${APPDATA}
-elif {narg({'${HOME}'})} -u ${HOME}
-else -u ""
-endif
-v +
quote :
-v - -u "$*" -v +
region_feature : -skip "${3=0}"
-v -
s=@{-2,s} --channels[-1] 0 -==[-1] $1 -^[-1] -1 --[-1] 1 -r[-1] [-3] -+[-1] [-3]
-l[-1]
-s[-1] -,inf -a y
-if @# -r[-1] 1,{h/$s},1,$s,-1 -u $2 -rm[-1]
-else -u $3
-endif
-endl
-v +
reset :
-e[^-1] "Reset global parameters of the interpreter environment."
-v -1 -db3d -m3d -md3d -f3d -l3d -sl3d -ss3d -v +
RGB :
-v - -u {round(?(255))},{round(?(255))},{round(?(255))} -v +
RGBA :
-v - -u {round(?(255))},{round(?(255))},{round(?(255))},{round(?(255))} -v +
str : -skip $1
-v - dec={'$*'} -v +
-e[^-1] "Convert string '$*' to binary '"@{-dec2bin\ $dec}"', octal '"@{-dec2oct\ $dec}"', decimal '"$dec"' and
hexadecimal '"@{-dec2hex\ $dec}"'."
str2hex :
-v - ({'"$*"'}) -rows[-1] 0,1 -f[-1] 'if(y==0,int(i/16),i(x,y-1)%16)' -f[-1] 'if(i<=9,48+i,87+i)' -transpose[-1] -u @{-1,t} -rm[-1] -v +
stresc :
-v - ($*) -c[-1] 32,255 -y[-1] [-1]
-f[-2] 'if(i==32||i==34||i==36||i==44||i==64||i==92||i==123||i==125,92,-1)' -a[-2,-1] x
-discard[-1] -1 -u @{-1,t} -rm[-1] -v +
strcat :
-v - $=s res="$1" -repeat {$#-1} res=$res${s{$>+2}} -done
-u $res -v +
strcmp :
-v - (0,{'"$1"'}) ({w},{'"$2"'}) -=[-2] {w} --[-2,-1] -abs[-1] -u {!@{-1,+}} -rm[-1] -v +
strlen :
-v - ({'"$1"'}) -u {w} -rm[-1] -v +
strreplace :
-v -
ls=@{-strlen\ "$2"}
lr={@{-strlen\ "$3"}-1}
-l[] ({'"$1"'}) -s +,{'"$2"'} -s y,-$ls
-repeat @# -if {@{$>,t}'=='"$2"} -rows[$>] 0,$lr -f[$>] {'"$3"'} -endif -done
-a y -u @{-1,t} -rm -endl
-v +
struncase :
-v - ({'"$*"'}) -+[-1] 'if(i>=65&&i<=90,32,0)' -u @{-1,t} -rm[-1] -v +
strver :
-v - ({'@.'}) -r[-1] 7 -f[-1] 'if(x%2,{'.'},i)' -u @{-1,t} -rm[-1] -v +
tic :
-e[^-1] "Initialize timer."
-v - -if {!narg($_ticpos)} _ticpos=0 -endif _tic$_ticpos=@| _ticpos={$_ticpos+1} -v +
toc :
-v - _ticpos={$_ticpos-1} -v +
-e[^-1] "Elapsed time : "{_@|-${_tic$_ticpos}}" s".
std_noise :
-v -
-if @# --laplacian[-1] -u {@{-mad[-1]}/sqrt(if(d==1,20,42))} -rm[-1]
-else -u 0
-endif
-v +
demo : -check "isint(${1=2}) && $1>=0 && $1<=2"
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ G\47MIC demo menu ------------------\n
----\n
---- Mouse button to select a demo.\n
---- Keys 'CTRL+D' to double window size.\n
---- Keys 'CTRL+C' to reset window size.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-----------------------------------------"
-v - -l[]
parallel_mode={1-if($1!=2,$1,@*>2)}
380,600,1,3 --plasma[-1] 1,1,5 -n[-1] 0,230 -water[-1] 100
(0.1;0.03^0;0.1^0.2;0.1) -r[-1] [-2],3 -*[-2,-1] -c[-1] 0,255
100%,100%,1,3
0 -t[-1] "1- 2048 game\n"\
"2- Blobs editor\n"\
"3- Bouncing balls\n"\
"4- Fire effect\n"\
"5- Fireworks\n"\
"6- Fish-eye effect\n"\
"7- Fourier filtering\n"\
"8- Histogram demo\n"\
"9- Hough transform\n"\
"10- Jawbreaker\n"\
"11- The game of life\n"\
"12- Light effect\n"\
"13- Mandelbrot explorer\n"\
"14- 3d metaballs\n"\
"15- Minesweeper\n"\
"16- Minimal path\n"\
"17- Pacman\n"\
"18- Paint\n"\
"19- Plasma effect\n"\
"20- RGB quantization\n"\
"21- 3d reflection\n"\
"22- 3d rubber object\n"\
"23- Shade bobs\n"\
"24- Spline editor\n"\
"25- Tetris\n"\
"26- Tic-tac-toe\n"\
"27- Image waves\n"\
"28- Fractal whirls\n"\
"29- Color curves\n",0,0,18,1,255,255,255
commands=-x_2048,-x_blobs,-x_bouncing,-x_fire,-x_fireworks,-x_fisheye,-x_fourier,-x_histogram,-x_hough,\
-x_jawbreaker,-x_life,-x_light,-x_mandelbrot,-x_metaballs3d,-x_minesweeper,-x_minimal_path,\
-x_pacman,-x_paint,-x_plasma,-x_quantize_rgb,-x_reflection3d,-x_rubber3d,-x_shadebobs,\
-x_spline,-x_tetris,-x_tictactoe,-x_waves,-x_whirl,-_demo_color_curves
y0=59
-j[-2] [-1],20,$y0,0,0 -rm[-1]
-rectangle[-1] 0,16,100%,44,1,120,120,32
0 -t[-1] "G\47MIC "@{-strver}" demos",2,2,28,1,1,1,1 -b[-1] 0.5 -n[-1] 0,1
(32;255^255;255^0;0) -r[-1] [-2],[-2],1,3,3 -*[-2,-1] -round[-1] 1,-1 --!=[-1] 0 -channels[-1] 1
-j[-3] [-2],20,16,0,0,1,[-1] -rm[-2,-1] --channels[-1] 1 -dilate[-1] 5
(80;255;80^0;255;0^0;0;0) (10;255;10^0;100;0^0;0;0)
-r[-2,-1] [-3],18,1,3,3 -polygon[-2,-1] 3,1,1,1,16,10,8,1,255,255,255 --mirror[-2,-1] x
-max[-4,-2] -max[-2,-1]
-ball[] 64,200,100,64 -n[-1] 0,230 -s[-1] c,-3 -rgb2hsv[-2] -*[-1] 0.5 -a[-2,-1] c
-repeat 6
-sh[-1] 0,0 -f[-1] {$>*360/6} -rm[-1] --s[-1] c,-3 -hsv2rgb[-2] -a[-2,-1] c
({'CImg3d'}) (5,5) 3,5 (1,0;1,4) -r[-1] 2,5,1,1,3 -round[-1] 4,5 -y[-5--1] -a[-5--1] y
-rv[-2,-1] -sprites3d[-2,-1] -rv[-2,-1]
-done -rm[-1] -+3d[-6--1]
cfx={0} cfy={0} cfz={0} nfx={g} nfy={g} nfz={g} alpha=0 time0={@|-4} selected=-1 -f3d 400
-w[0] -1,-1,0,0,50%,50%,"[G"{`39`}"MIC] Demo menu"
-do
t={1.5*@|}
1,30,1,1,'(1-$alpha)*cos($cfx*y+$t)+$alpha*cos($nfx*y+$t)'
1,30,1,1,'(1-$alpha)*sin($cfy*y+$t)+$alpha*sin($nfy*y+$t)'
1,30,1,1,'(1-$alpha)*sin($cfz*y+$t)+$alpha*sin($nfz*y+$t)'
-a[-3--1] x -s[-1] y,5 -a[-5--1] x -y[-1]
-j[6] [-1],0,8 -rm[-1] -*3d[6] @{0,w/2-30},@{0,h/2-30},300 -+3d[6] 0,0,200
-*[0] 0.85 -+[0] [1] -j3d[0] [6],50%,50%,0,1,0,0,0 -j[0] [2],0,0,0,0,1,[3],255
y={@{!,y}*@{0,h}/@{!,h}}
-if {$y>=0} y={max(0,min(28,int(($y-$y0)/18)))} -j[0] [{if($selected>=0,5,4)}],0,{$y0+18*$y},0,0,0.2 -endif
-w[0] -wait 20
-if {@{!,CTRLLEFT}&&@{!,D}} -w[0] 200%,200% -elif {@{!,CTRLLEFT}&&@{!,C}} -w[0] 100%,100% -endif
-if {(@{!,b}&1)&&$selected<0} selected=$y
-elif {!@{!,b}}
-if {$selected>=0&&$y==$selected}
-m "com : -v 0 "@{-arg\ {1+$y},$commands} -parallel $parallel_mode,"-l[] -com -v -1 -rm -endl" -uncommand com
-endif
selected=-1
-endif
-if {@|-$time0>5} alpha={$alpha+0.03} -endif
-if {$alpha>1} alpha={$alpha-1} cfx=$nfx cfy=$nfy cfz=$nfz nfx={g} nfy={g} nfz={g} time0={@|-?*3} -endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm -w 0 -endl -v 0 -e[] ""
_demo_color_curves :
-e[] "\n
------ Color curves ----------------------------------------------------------------------------\n
---- Left mouse button on a curve creates a new control point (or moves an existing one).\n
---- Right mouse button on a control point deletes it.\n
---- Left mouse button on the main image window shows the initial image until button is released.\n
---- Right mouse button on the main image window adds a keypoint to all curves from picked color.\n
---- Key 'R' on a curve resets it.\n
---- Keys 'CTRL+D' increase window size.\n
---- Keys 'CTRL+C' decrease window size.\n
---- Keys 'CTRL+R' reset window size.\n
---- Keys 'ESC', 'Q' or 'ENTER' close the current window.\n
------------------------------------------------------------------------------------------------"
-v - -testimage2d 512 -x_color_curves rgb -v +
x_2048 :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ 2048 -----------------------------------------------\n
----\n
---- Join the numbers and get to the 2048 title!\n
----\n
---- Use your arrow keys to move the tiles. When two tiles\n
---- with the same number touch, they merge into one!\n
---- This command is a port of the '2048' game originally\n
---- designed by Gabriele Cirulli, and available at:\n
---- http://gabrielecirulli.github.io/2048/\n
----\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
--------------------------------------------------------------"
-v - -l[]
score=0 -f3d 50 -m3d 0
-m "_x_2048_setrandom : --==[0] 0 -f[-1] 'if(i,4*y+x,-1)' -discard[-1] -1
off={i[round(?(h-1))]} -rm[-1] x={$off&3} y={$off>>2} n={if(?<0.75,1,2)}
-=[0] $n,$x,$y [{2+$n}] -c3d[-1]
-repeat 6 -j3d[1] [-1],{78+$x*121},{190+$y*121},{10*$<},{(1+$>)/6} -w[1] -wait 20 -done
-rm[-1]"
-m "_x_2048_object3d : --f[0] 'if(i,i*16+4*y+x,-1)' -discard[-1] -1
N={h} -repeat {h} v=@{-{1+$>},$>} --+3d[{2+($v>>4)}] {$v&3},{($v>>2)&3} -done
-+3d[-$N--1] -rm[-2]"
-i[0] 4,4
b0=204,192,179 b1=238,228,218 b2=237,224,200 b3=242,177,121
b4=245,149,99 b5=246,124,95 b6=246,94,59 b7=237,207,114
c0=119,110,101 c1=249,246,242 s0=" "
520,630,1,3 -fc[-1] 250,248,239
-t[-1] "2048",20,10,86,1,$c0
-t[-1] "Join the numbers and get to the 2048 title!",20,90,20,1,$c0
-rectangle[-1] 422,20,501,75,1,187,173,160 -t[-1] "SCORE",439,25,15,1,238,228,218
-repeat 12
107,107,1,3 -fc[-1] ${b{min($>,7)}} --fc[-1] ${c{$>>2}}
s1={2^$>} 0 -t[-1] ${s{$>>0}},0,0,52,1,1
-r[-1] [-2],[-2],1,1,0,0,0.5,0.5 -dilate_circ[-1] 3 -b[-1] 0.5
-j[-3] [-2],0,0,0,0,1,[-1],1 -rm[-2,-1]
-done
-frame_round[2--1] 10,5,1,0.5,187,173,160 -frame[2--1] 7,7,187,173,160 -to_rgb[2--1]
-r[2] 400%,400%,1,3,0,2 -j[1] [2],18,130
-sprite3d[3--1]
-w[1] 100%,100%,0,"[G"{`39`}"MIC] 2048" insert_new=1
-repeat 2 -_x_2048_setrandom -done
-do
-if $insert_new
-_x_2048_object3d -*3d[-1] 121 -j[1] [2],18,130 -j3d[1] [-1],78,190 -rm[-1]
80,25,1,3 -fc[-1] $c1 0 -t[-1] $score,0,0,25,1,1,1,1 -r[-1] [-2],0,0,0.5,0.8
-rectangle[1] 422,45,501,69,1,187,173,160 -j[1] [-2],422,45,0,0,1,[-1] -rm[-2,-1]
-w[1] insert_new=0
-endif
--+[0] 1 -f[-1] 'j(-1)==i||j(1)==i||j(0,-1)==i||j(1,0)==i||i==1'
-if @{0,iM==11}
-alert "Game Over","\nCongratulations! You got the 2048 title!\n\n   Your score: "$score,"OK"
-break
-elif {!iM}
-alert "Game Over","\nBad luck! You lost the game!\n\n   Your score: "$score,"OK"
-break
-endif
-rm[-1]
-wait
is_shift=0 -uncommand shift2048,ishift2048,vshift2048
-if @{!,ARROWLEFT}
-m "shift2048:" -m "ishift2048:" -m "vshift2048:"
is_shift=1
-elif @{!,ARROWRIGHT}
-m "shift2048: -rotate 180" -m "ishift2048: -rotate 180"
-m "vshift2048: -s3d -l[2] -r 3,{h/3},1,1,-1 -s x --[0,1] 3 -*[0,1] -1 -a x -y -endl -a y"
is_shift=1
-elif @{!,ARROWUP}
-m "shift2048: -rotate -90" -m "ishift2048: -rotate 90"
-m "vshift2048: -s3d -l[2] -r 3,{h/3},1,1,-1 -s x -rv[0,1] --[0] 3 -*[0] -1  -a x -y -endl -a y"
is_shift=1
-elif @{!,ARROWDOWN}
-m "shift2048: -rotate 90" -m "ishift2048: -rotate -90"
-m "vshift2048: -s3d -l[2] -r 3,{h/3},1,1,-1 -s x -rv[0,1] --[1] 3 -*[1] -1  -a x -y -endl -a y"
is_shift=1
-endif
-if $is_shift
-wait -1
-shift2048[0]
-repeat 2
-_x_2048_object3d
--s[0] y -discard[-4--1] 0 -y[-4--1] x -r[-4--1] 4,1,1,1,0,0 -a[-4--1] y
--==[0,-1] insert_new={$insert_new||!im} -rm[-1]
--f[0,-1] 'if(i,x,-1)' -discard[-2,-1] -1 -rv[-2,-1] --[-2,-1] -rv[0,-2] -rm[-2]
-if {(im||iM)&&!@{!,k}}
-/[-1] 5 -z[-1] 0,2 -y[-1]
-repeat 5
-j[-2] [-1],0,8,0,0,-1
-j[1] [2],18,130 --vshift2048[-2] -*3d[-1] 121 -j3d[1] [-1],78,190 -rm[-1]
-w[1] -wait 20
-done
-endif
-rm[-2,-1]
-if {!$>} dscore=0
[0] --f[0] 'if(i,i*16+4*y+x,-1)' -discard[-1] -1
-repeat {h}
x={i[$>]&3} y={(i[$>]>>2)&3} n={i[$>]>>4}
-if {$x>0&&@{0,i($x-1,$y)}==$n}
-=[0] 0,$x,$y -=[0] {$n+1},{$x-1},$y -=[-2] 0,$x,$y insert_new=1 dscore={$dscore+2^($n+1)}
-else -=[-1] -1,0,$>
-endif
-done
score={$score+$dscore}
-if {iM<0} -rm[-2,-1]
-else
-discard[-1] -1
-rv[0,-2] -_x_2048_object3d -rv[0,-3] -vshift2048[-1] -*3d[-1] 121
-j[1] [2],18,130 -j3d[1] [-1],78,190 -rm[-3,-1]
N={h} -repeat {h} v=@{-{1+$>},$>} --+3d[{2+($v>>4)}] {$v&3},{($v>>2)&3} -done
-+3d[-$N--1] -rm[-2]
0 -t[-1] +$dscore,0,0,33,1,1 100%,100%,1,3 -fc[-1] $c0
-repeat 6
--vshift2048[-3] -*3d[-1] 121 --j3d[1] [-1],78,190
-j[-1] [-3],430,{80-$>},0,0,{min(1,$</6)},[-4]
-w[-1] -rm[-2,-1] --3d[-3] {1/6},0,0 -wait 20
-done
-rm[-3--1]
-endif
-endif
-done
-ishift2048[0]
-if $insert_new -_x_2048_setrandom -endif
-endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm -w 0 -endl -uncommand _x_2048_setrandom,_x_2048_object3d -v +
x_blobs :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Blobs editor --------------------------\n
----\n
---- Mouse to insert/move/delete blobs.\n
---- Keys 'CTRL+D' to double window size.\n
---- Keys 'CTRL+C' to reset window size.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-----------------------------------------------------"
-v -
-l[] (0;0^0;128^0;255) -r[-1] 350,350,1,3,3 -flower[-1] 30,8,0,0,50%,50%,1 -water[-1] 20
-w {w},{h},0,0,"[G"{`39`}"MIC] Blobs editor"
moving=-1
-do
x={@{!,x}*@{0,w}/@{!,w}}
y={@{!,y}*@{0,h}/@{!,h}}
b=@{!,b} nearest=-1
-if {@#>1}
@{0,w},@{0,h},1,2
-repeat @{1,h}
r={@{1,2}*(1+@{1,3}*cos(@{1,4}+@{1,5}*@|*1000))}
-ellipse[-1] @{1,0,1},$r,$r,0,1,@{1,6-7}
d={sqrt(($x-@{1,0})^2+($y-@{1,1})^2)}
-if {$d<$r} nearest=$> -endif
-shift[1] 0,-1,0,0,2 -done
-b[-1] 15
--norm[-1] -->=[-1] 50 -<=[-2] 40 -*[-3,-1]
--*[0,-1] -rm[-2] -rv[-2,-1] -*[-1] 1.6 -c[-1] 0,255 -+[-2,-1]
-w[-1]
-if {@{!,CTRLLEFT}&&@{!,D}} -w[] {2*w},{2*h} -elif {@{!,CTRLLEFT}&&@{!,C}} -w[] {w},{h} -endif
-rm[-1]
-else
--text_outline[0] "G\47MIC Blobs Editor",65,40,23,3,1,200,128,255
-t[-1] "* Left mouse button : Create and move blobs.\n\n\
* Right mouse button : Remove blob.\n\n\
* Middle mouse button : Remove all blobs.\n\n\
* Key 'ESC' or 'Q' : Quit.\n\n\
* Colors and sizes of appearing blobs are\n   chosen randomly",\
60,120,13,1,255
-w[-1]
-if {@{!,CTRLLEFT}&&@{!,D}} -w[] {2*w},{2*h} -elif {@{!,CTRLLEFT}&&@{!,C}} -w[] {w},{h} -endif
-rm[-1]
-endif
-wait 20
-if {$x<0||$y<0} -continue -endif
-if {$b&1}
-if {$nearest>=0" || "$moving>=0}
-if {$moving<0} moving=$nearest -endif
-=[1] $x,0,$moving -=[1] $y,1,$moving
-else
($x,$y,{?(20,50)},{?(-0.3,0.3)},{?(0,pi/2)},{?(0,0.009)},{?(64,255)},{?(64,255)}) -a[^0] y
moving={h-1}
-endif
-elif {$b&2}
-if {$nearest>=0} -l[1] -s y -rm[$nearest] -a y -endl nearest=-1 -endif
-elif {$b&4}
-k[0]
-else
moving=-1
-endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm -w 0 -endl -v +
x_bouncing :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Bouncing balls ------------------------------\n
----\n
---- Keys 'CTRL+D' to double window size.\n
---- Keys 'CTRL+C' to reset window size.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-----------------------------------------------------"
-v - -l[]
500,320,1,3 -plasma 1,1,9 -n 0,220
N=12
-repeat $N
-ball[] {round(?(32,80))},@{-RGB}
t$>={?(200)} x$>=@{0,?(10,w-10)} h$>={?(150,300)} vx$>={if(?<0.5,1,-1)*?(1,8)}
-done
-mv[0] @# -w[-1] -1,-1,0,"[G"{`39`}"MIC] Bouncing balls"
(0;0.7;1) -r[-1] @{-2,w},70,1,1,3
-do
[$N]
-repeat $N
bw=@{$>,w} bh=@{$>,h}
y={${h$>}*abs(cos(${t$>}*pi/60))-$bh/2}
dt=1
-if {$y<0} d={-$y} y=0 bh={$bh-$d} bw={$bw+$d} dt={max(0.2,1-($d/$bh)^2)} -else dt=1 -endif
-if {${x$>}+$bw/2>w}
d={${x$>}+$bw/2-w} bw={$bw-$d} bh={$bh+0.5*$d}
-if {${x$>}+$bw/4>w} vx$>={-${vx$>}} -endif
-endif
-if {${x$>}-$bw/2<0}
d={$bw/2-${x$>}} bw={$bw-$d} bh={$bh+0.5*$d}
-if {${x$>}-$bw/4<0} vx$>={-${vx$>}} -endif
-endif
--r[$>] $bw,$bh,1,4,3 -s[-1] c,-3
-j[-3] [-2],{max(0,min(@{$N,w-$bw},${x$>}-$bw/2))},{@{$N,h}-@{-1,h}-$y-70},0,0,1,[-1],255 -rm[-2,-1]
t$>={${t$>}+$dt}
x$>={${x$>}+$dt*${vx$>}}
-done
--rows[-1] {h-2*70},{h-1-70} -mirror[-1] y -*[-1] [{$N+1}]
-j[-2] [-1],0,@{-2,h-71},0,0,0.5 -rm[-1]
-w[-1]
-if {@{!,CTRLLEFT}&&@{!,D}} -w[] {2*w},{2*h} -elif {@{!,CTRLLEFT}&&@{!,C}} -w[] {w},{h} -endif
-rm[-1] -wait 20
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-w 0 -rm -endl -v +
x_color_curves : -skip ${1=rgb}
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[^-1] "Apply color curves of image$?, in the '$1' colorspace."
-if {$1'=='last} -v -
-if {!narg($_xcc_colorbase)} -v + -return -endif
-__x_color_curves[] $_xcc_colorbase
-else
-e[] "\n
------------------------------------------------------------------------------------------------\n
---- Left mouse button on a curve creates a new control point (or moves an existing one).\n
---- Right mouse button on a control point deletes it.\n
---- Left mouse button on the main image window shows the initial image until button is released.\n
---- Right mouse button on the main image window adds a keypoint to all curves from picked color.\n
---- Key 'R' on a curve resets it.\n
---- Keys 'CTRL+D' increase window size.\n
---- Keys 'CTRL+C' decrease window size.\n
---- Keys 'CTRL+R' reset window size.\n
---- Keys 'ESC', 'Q' or 'ENTER' close the current window.\n
------------------------------------------------------------------------------------------------"
-v -
-__x_color_curves[] $1 _xcc_colorbase=$1
-endif
-repeat @# -l[$>]
-if {$1'!='last}
--r[0] @{-fitscreen[]\ @{0,w},@{0,h},1,128,70%},1,100%,3
--l[-1] -xcc_goto -s c -histogram 256,0,255 -xcc_info -endl
__C0= __C1= __C2= __C3= __C4=
-if {narg($__xcc_C0)} __C0=$__xcc_C0 -endif
-if {narg($__xcc_C1)} __C1=$__xcc_C1 -endif
-if {narg($__xcc_C2)} __C2=$__xcc_C2 -endif
-if {narg($__xcc_C3)} __C3=$__xcc_C3 -endif
-if {narg($__xcc_C4)} __C4=$__xcc_C4 -endif
x=@{1,(@{!,u}-560-w)/2} y=@{1,(@{!,v}-h)/2}
-if {@#==5}
-parallel "-w[] 256,256,0,0,"$x","$y",\"Curve: "$_title0"\" -x_select_function1d[-3] __C0,"$_color0"",\
"-w[] 256,256,0,0,"{$x+280}","$y",\"Curve: "$_title1"\" -x_select_function1d[-2] __C1,"$_color1"",\
"-w[] 256,256,0,0,"$x","{$y+300}",\"Curve: "$_title2"\" -x_select_function1d[-1] __C2,"$_color2"",\
"-w[-1] 100%,100%,0,0,"{$x+560}","$y" -_x_color_curves[-4]"
-elif {@#==6}
-parallel "-w[] 256,256,0,0,"$x","$y",\"Curve: "$_title0"\" -x_select_function1d[-4] __C0,"$_color0"",\
"-w[] 256,256,0,0,"{$x+280}","$y",\"Curve: "$_title1"\" -x_select_function1d[-3] __C1,"$_color1"",\
"-w[] 256,256,0,0,"$x","{$y+300}",\"Curve: "$_title2"\" -x_select_function1d[-2] __C2,"$_color2"",\
"-w[] 256,256,0,0,"{$x+280}","{$y+300}",\"Curve: "$_title3"\" -x_select_function1d[-1] __C3,"$_color3"",\
"-w[-1] 100%,100%,0,0,"{$x+560}","$y" -_x_color_curves[-5]"
-elif {@#==7}
-parallel "-w[] 256,256,0,0,"$x","$y",\"Curve: "$_title0"\" -x_select_function1d[-5] __C0,"$_color0"",\
"-w[] 256,256,0,0,"{$x+280}","$y",\"Curve: "$_title1"\" -x_select_function1d[-4] __C1,"$_color1"",\
"-w[] 256,256,0,0,"$x","{$y+300}",\"Curve: "$_title2"\" -x_select_function1d[-3] __C2,"$_color2"",\
"-w[] 256,256,0,0,"{$x+280}","{$y+300}",\"Curve: "$_title3"\" -x_select_function1d[-2] __C3,"$_color3"",\
"-w[] 256,256,0,0,"{$x+280}","{$y+600}",\"Curve: "$_title4"\" -x_select_function1d[-1] __C4,"$_color4"",\
"-w[-1] 100%,100%,0,0,"{$x+560}","$y" -_x_color_curves[-6]"
-endif
-k[0]
-endif
-xcc_goto
-repeat {s} -function1d[] 1,${__xcc_C$>} -*[-1] {255%} -r[-1] 256,1,1,1,5 -c[-1] 0,255 -sh[0] $>,$> -map[-1] [-2] -rm[-2,-1] -done
-xcc_backto
-endl -done
-uncommand xcc_goto,xcc_backto,xcc_info -v +
_x_color_curves :
title=@{0,b} -if {narg({'@{0,x}'})} title=$title.@{0,x} -endif ({'$title'}) -discard[-1] {'~'} title=@{-1,t} -rm[-1]
--drgba[-1] -w[-1] 100%,100%,0,"[G"{`39`}"MIC] Image: "$title -rm[-1]
-xcc_goto[-1] [-1]
oC0= oC1= oC2= oC3= oC4= viewmode=0
-do
-wait 100 need_refresh=0
oviewmode=$viewmode is_ctrl={@{!,CTRLLEFT}" || "@{!,CTRLRIGHT}} x=@{!,x} y=@{!,y}
-if @{!,r} need_refresh=1
-elif {$is_ctrl" && "@{!,-D}} -w[] {@{!,w}*125%},{@{!,h}*125%} need_refresh=1
-elif {$is_ctrl" && "@{!,-C}} -w[] {@{!,w}*80%},{@{!,h}*80%} need_refresh=1
-elif {$is_ctrl" && "@{!,-R}} -w[] {w},{h} need_refresh=1
-elif {@{!,b}&1} viewmode={x=@{!,x};if(x<w/3,1,if(x<2*w/3,2,3))}
-elif {@{!,b}&2" && "$x>=0" && "$y>=0}
xc={$x*w/@{!,w}} yc={$y*h/@{!,h}} --z[0] $xc,$yc,$xc,$yc
-repeat {s} (${__C$>},{i[$>]/255%},{i[$>]/255%}) -r[-1] 2,{w/2},1,1,-1 -sort[-1] +,y __C$>=@-1 -rm[-1] -done
-rm[-1] -wait -1
-else viewmode=0
-endif
need_refresh={$need_refresh||$oviewmode!=$viewmode}
-repeat {s} -if {${oC$>}'!='${__C$>}}
-function1d[] 1,${__C$>} -*[-1] {255%} -r[-1] 256,1,1,1,5 -c[-1] 0,255
--channels[0] $> -map[-1] [-2] -j[1] [-1],0,0,0,$> -rm[-2,-1]
need_refresh=1 oC$>=${__C$>}
-endif -done
-if $need_refresh
-if {$viewmode==0}
--xcc_backto[1]
-elif {$viewmode%2}
w2=@{0,int(w/2)} b={$viewmode==1} --z[{!$b}] 0,{$w2-1} --z[$b] $w2,100%
-xcc_backto[-2] -xcc_backto[-1] -a[-2,-1] x -line[-1] 50%,0,50%,100%,1,0
-else
--xcc_backto[0]
-endif
-if {s>3} -drgba[-1] -endif -w[-1] -rm[-1] refresh=0
-endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}" && "!@{!,SPACE}" && "!@{!,ENTER}}
-w 0
-repeat 4 -if {narg(${__C$>})} __xcc_C$>=${__C$>} __C$>=-1 -endif -done
__x_color_curves :
-if {$1'=='rgb}
_color0="255,180,180" _color1="180,255,180" _color2="180,180,255" _color3="220,220,220" _title0=Red _title1=Green _title2=Blue _title3=Alpha
-m "xcc_goto:" -m "xcc_backto:"
-m "xcc_info: (0,255;0,0;0,0) (0,0;0,255;0,0) (0,0;0,0;0,255) -r[-3--1] 256,3,1,1,3 "\
"-a[0,-3] y -a[1,-2] y -a[2,-1] y"
-elif {$1'=='cmy}
_color0="180,255,255" _color1="255,180,255" _color2="255,255,100" _color3="220,220,220" _title0=Cyan _title1=Magenta _title2=Yellow _title3=Alpha
-m "xcc_goto: -s c,-3 -rgb2cmy[0] -a c" -m "xcc_backto: -s c,-3 -cmy2rgb[0] -a c"
-m "xcc_info: (255,0;255,255;255,255) (255,255;255,0;255,255) (255,255;255,255;255,0) -r[-3--1] 256,3,1,1,3 "\
"-a[0,-3] y -a[1,-2] y -a[2,-1] y"
-elif {$1'=='cmyk}
_color0="180,255,255" _color1="255,180,255" _color2="255,255,100" _color3="180,180,180" _color4="220,220,220" _title0=Cyan _title1=Magenta _title2=Yellow _title3=Key _title4=Alpha
-m "xcc_goto: -s c,-3 -rgb2cmyk[0] -a c" -m "xcc_backto: -s c,-4 -cmyk2rgb[0] -a c"
-m "xcc_info: (255,0;255,255;255,255) (255,255;255,0;255,255) (255,255;255,255;255,0) (255,0) -r[-4--1] 256,3,1,1,3 "\
"-a[0,-4] y -a[1,-3] y -a[2,-2] y -a[3,-1] y"
-elif {$1'=='hsi}
_color0="255,220,220" _color1="220,220,220" _color2="180,180,180" _color3="220,220,220" _title0=Hue _title1=Saturation _title2=Intensity _title3=Alpha
-m "xcc_goto: -s c,-3 -rgb2hsi8[0] -a c" -m "xcc_backto: -s c,-3 -hsi82rgb[0] -a c"
-m "xcc_info: 256,1,1,3,if(!c,x,128) 256,1,1,3,if(!c,0,if(c==1,x,128)) 256,1,1,3,if(!c,0,if(c==1,0,x)) -hsi82rgb[-3--1] -permute[-3--1] xcyz "\
"-a[0,-3] y -a[1,-2] y -a[2,-1] y"
-elif {$1'=='hsl}
_color0="255,220,220" _color1="220,220,220" _color2="180,180,180" _color3="220,220,220" _title0=Hue _title1=Saturation _title2=Lightness _title3=Alpha
-m "xcc_goto: -s c,-3 -rgb2hsl8[0] -a c" -m "xcc_backto: -s c,-3 -hsl82rgb[0] -a c"
-m "xcc_info: 256,1,1,3,if(!c,x,128) 256,1,1,3,if(!c,0,if(c==1,x,128)) 256,1,1,3,if(!c,0,if(c==1,0,x)) -hsl82rgb[-3--1] -permute[-3--1] xcyz "\
"-a[0,-3] y -a[1,-2] y -a[2,-1] y"
-elif {$1'=='hsv}
_color0="255,220,220" _color1="220,220,220" _color2="180,180,180" _color3="220,220,220" _title0=Hue _title1=Saturation _title2=Value _title3=Alpha
-m "xcc_goto: -s c,-3 -rgb2hsv8[0] -a c" -m "xcc_backto: -s c,-3 -hsv82rgb[0] -a c"
-m "xcc_info: 256,1,1,3,if(!c,x,255) 256,1,1,3,if(!c,0,if(c==1,x,128)) 256,1,1,3,if(!c,0,if(c==1,0,x)) -hsv82rgb[-3--1] -permute[-3--1] xcyz "\
"-a[0,-3] y -a[1,-2] y -a[2,-1] y"
-elif {$1'=='lab}
_color0="180,180,180" _color1="220,180,220" _color2="220,220,180" _color3="220,220,220" _title0=Lightness _title1=Chroma-A _title2=Chroma-B _title3=Alpha
-m "xcc_goto: -s c,-3 -srgb2rgb[0] -apply_parallel_overlap[0] -rgb2lab8,0,4 -a c" -m "xcc_backto: -s c,-3 -apply_parallel_overlap[0] -lab82rgb,0,4 -rgb2srgb[0] -a c"
-m "xcc_info: 256,1,1,3,if(!c,x,128) 256,1,1,3,if(!c,240,if(c==1,x,128)) 256,1,1,3,if(!c,240,if(c==1,128,x)) -lab82rgb[-3--1] -permute[-3--1] xcyz "\
"-a[0,-3] y -a[1,-2] y -a[2,-1] y"
-elif {$1'=='lch}
_color0="180,180,180" _color1="220,180,220" _color2="255,220,220" _color3="220,220,220" _title0=Lightness _title1=Chroma _title2=Hue _title3=Alpha
-m "xcc_goto: -s c,-3 -srgb2rgb[0] -apply_parallel_overlap -rgb2lch8[0],0,4 -a c" -m "xcc_backto: -s c,-3 -apply_parallel_overlap -lch82rgb[0],0,4 -rgb2srgb[0] -a c"
-m "xcc_info: 256,1,1,3,if(!c,x,0) 256,1,1,3,if(!c,255,if(c==1,x,128)) 256,1,1,3,if(!c,220,if(c==1,128,x)) -lch82rgb[-3--1] -permute[-3--1] xcyz "\
"-a[0,-3] y -a[1,-2] y -a[2,-1] y"
-elif {$1'=='ycbcr}
_color0="180,180,180" _color1="220,220,255" _color2="255,220,220" _color3="220,220,220" _title0=Luma _title1=Blue\ chroma _title2=Red\ chroma _title3=Alpha
-m "xcc_goto: -s c,-3 -rgb2ycbcr[0] -a c" -m "xcc_backto: -s c,-3 -ycbcr2rgb[0] -a c"
-m "xcc_info: 256,1,1,3,if(!c,x,128) 256,1,1,3,if(!c,128,if(c==1,x,128)) 256,1,1,3,if(!c,128,if(c==1,128,x)) -ycbcr2rgb[-3--1] -permute[-3--1] xcyz "\
"-a[0,-3] y -a[1,-2] y -a[2,-1] y"
-else -error[0--3] "Command 'x_color_curves': Unknown specified color space '$1'."
-endif
x_colorize : -skip ${1=0},${3=0},${4=0},${5=0} -check "${2=1024}==0 || $2>=128"
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-v - s0="image" s1="lineart" s2="multichannel" s3="merged" -v +
-e[^-1] "Colorize selected B&W "${s{!$1}}"$? interactively, with maximum resolution $2 and "${s{2+!$3}}" output."
-e[] "\n
--------------------------------------------------------------------------------------\n
---- Left mouse button creates a new colored control point (or moves an existing one).\n
---- Right mouse button over a control point deletes it.\n
---- Right mouse button anywhere else picks a color from the image.\n
---- Mouse wheel, or keys 'CTRL+arrows UP/DOWN' zoom view in/out.\n
---- 'CTRL+mouse wheel', 'SHIFT+mouse wheel' or arrow keys move image in zoomed view.\n
---- Key 'SPACE' updates the extrapolated color field.\n
---- Key 'TAB' toggles between markers view modes.\n
---- Key 'BACKSPACE' deletes the last control point added.\n
---- Key 'PAGE UP' increases image contrast.\n
---- Key 'PAGE DOWN' decreases image contrast.\n
---- Key 'R' toggles color replace mode.\n
---- Keys 'CTRL+D' increase window size.\n
---- Keys 'CTRL+C' decrease window size.\n
---- Keys 'CTRL+R' reset window size.\n
---- Keys 'ESC', 'Q' or 'ENTER' exit the interactive window.\n
--------------------------------------------------------------------------------------"
-v -
is_palette1=@{"-is_image_arg[] $4"}
-if $is_palette1 -pass$4 1 ({'@{-1,b}'}) -discard[-1] {'~'} palette_title1=@{-1,t} -rm[-1] -endif
is_palette2=@{"-is_image_arg[] $5"}
-if $is_palette2 -pass$5 1 ({'@{-1,b}'}) -discard[-1] {'~'} palette_title2=@{-1,t} -rm[-1] -endif
__color=255,255,255
-if {$is_palette1" && "$is_palette2}
-repeat {@#-2} -l[$>,-2,-1]
-parallel "-_x_colorize[0] ${1--1}","-w[] 400,320,0,Palette -x_select_color[] __color,255,255,255",\
"-w[] 400,400,0,\""$palette_title1"\" -x_select_palette[1] __color",\
"-w[] 400,400,0,\""$palette_title2"\" -x_select_palette[2] __color"
-endl -done
-rm[-2,-1]
-elif $is_palette1
-repeat {@#-1} -l[$>,-1]
-parallel "-_x_colorize[0] ${1--1}","-w[] 400,320,0,Palette -x_select_color[] __color,255,255,255",\
"-w[] 400,400,0,\""$palette_title1"\" -x_select_palette[1] __color"
-endl -done
-rm[-1]
-else
-repeat @# -l[$>]
-parallel "-_x_colorize[0] ${1--1}","-w[] 400,320,0,Palette -x_select_color[] __color,255,255,255"
-endl -done
-endif
-v +
_x_colorize :
name=@{-1,n} title=@{-1,b} -if {narg(@{-1,x})} title=$title.@{-1,x} -endif
w={w} h={h}
-if $1
-if {s==4} -sh[-1] 3,3 -if {abs(im-iM)>64} --*[-1] -1 -rm[-2] -+[-1] 255 -else -rm[-1] -sh[-1] 0,0 -endif
-else -sh[-1] 0,0
-endif
-n 0,255
-else
-if {s==1} -sh[-1] 0,0
-else --luminance[-1]
-endif
-endif
-nm[-1] img
fdim=@{-fitscreen[]\ $w,$h} ww={arg(1,$fdim)} wh={arg(2,$fdim)} x0=0 y0=0 x1={w-1} y1={h-1}
selection=-1 view_markers=2 contrast=9 xpan=-1 ypan=-1 replace_color= current_replace_color=
-if {narg($_gimp_control_points)>=6}  ($_gimp_control_points) -r[-1] {w/6},6,1,1,-1
-else 0
-endif
-nm[-1] points
-if {$2>0} -if {$w>$h} --r2dx[img] {min($2,$w)},2 -else --r2dy[img] {min($2,$h)},2 -endif -else [img] -endif
-__x_colorize[-1] $1
pw=@{potential,w} ph=@{potential,h}
-do
-if {narg($replace_color)" && "@{!,x}<0" && "@{!,y}<0} -wait 200 -else -wait -endif
x=@{!,x} y=@{!,y} b=@{!,b} o=@{!,-o}
is_ctrl={@{!,CTRLLEFT}" || "@{!,CTRLRIGHT}}
is_shift={@{!,SHIFTLEFT}" || "@{!,SHIFTRIGHT}}
is_mouseout={$x<0" || "$y<0}
x={$x0+$x*($x1-$x0+1)/$ww} y={$y0+$y*($y1-$y0+1)/$wh}
oww=$ww owh=$wh ox0=$x0 oy0=$y0 ox1=$x1 oy1=$y1
-if @{!,r}
nww=@{!,d} nwh=@{!,e} m={min($nww,$nwh)}
cx={($x0+$x1)/2} cy={($y0+$y1)/2} dx={$nww*($x1-$x0+1)/$ww} dy={$nwh*($y1-$y0+1)/$wh}
x0={$cx-$dx/2} x1={$cx+$dx/2}
y0={$cy-$dy/2} y1={$cy+$dy/2}
ww=$nww wh=$nwh
-elif {$is_ctrl" && "@{!,-D}}
nww={min(@{!,u},$ww*1.25)} nwh={min(@{!,v},$wh*1.25)} m={min($nww,$nwh)}
-if {$m==$nww} ww=$m wh={$h*$m/$w} -else ww={$w*$m/$h} wh=$m -endif
-elif {$is_ctrl" && "@{!,-C}}
nww={$ww/1.25} nwh={$wh/1.25}
-if {min($nww,$nwh)>=64} ww=$nww wh=$nwh -endif
-elif {$is_ctrl" && "@{!,R}}
fdim=@{-fitscreen[]\ $w,$h} ww={arg(1,$fdim)} wh={arg(2,$fdim)}
x0=0 y0=0 x1={$w-1} y1={$h-1}
-elif {($is_shift" && "$o<0)" || "@{!,ARROWLEFT}}
dx={($x1-$x0)/6} x0={$x0-$dx} x1={$x1-$dx}
-elif {($is_shift" && "$o>0)" || "@{!,ARROWRIGHT}}
dx={($x1-$x0)/6} x0={$x0+$dx} x1={$x1+$dx}
-elif {($is_ctrl" && "$o>0)" || "(@{!,ARROWUP}" && "!$is_ctrl)}
dy={($y1-$y0)/6} y0={$y0-$dy} y1={$y1-$dy}
-elif {($is_ctrl" && "$o<0)" || "(@{!,ARROWDOWN}" && "!$is_ctrl)}
dy={($y1-$y0)/6} y0={$y0+$dy} y1={$y1+$dy}
-elif {$o>0" || "($is_ctrl" && "@{!,ARROWUP})}
-if {$x1-$x0>16" && "$y1-$y0>16}
cx={if($x>=0" && "!@{!,ARROWUP},$x,($x0+$x1)/2)}
cy={if($y>=0" && "!@{!,ARROWUP},$y,($y0+$y1)/2)}
x0={$cx+($x0-$cx)*0.75} y0={$cy+($y0-$cy)*0.75}
x1={$cx+($x1-$cx)*0.75} y1={$cy+($y1-$cy)*0.75}
-endif
-elif {$o<0" || "($is_ctrl" && "@{!,ARROWDOWN})}
zfactor={max(($x1-$x0+1)/$w,($y1-$y0+1)/$h)}
-if {$zfactor<1.3}
cx={if($x>=0" && "!@{!,ARROWDOWN},$x,($x0+$x1)/2)}
cy={if($y>=0" && "!@{!,ARROWDOWN},$y,($y0+$y1)/2)}
x0={$cx+($x0-$cx)/0.75} y0={$cy+($y0-$cy)/0.75}
x1={$cx+($x1-$cx)/0.75} y1={$cy+($y1-$cy)/0.75}
dx={$zfactor^2*($w-$x0-$x1)/2} dy={$zfactor^2*($h-$y0-$y1)/2}
x0={$x0+$dx} x1={$x1+$dx} y0={$y0+$dy} y1={$y1+$dy}
-else
dx={($w-$x0-$x1)/2} dy={($h-$y0-$y1)/2}
x0={$x0+$dx} x1={$x1+$dx} y0={$y0+$dy} y1={$y1+$dy}
-endif
-elif {$b&4" && "!$is_mouseout}
-if {$panx<0" && "$pany<0} panx=$x pany=$y
-else dx={round($panx-$x)} dy={round($pany-$y)} x0={$x0+$dx} y0={$y0+$dy} x1={$x1+$dx} y1={$y1+$dy}
-endif
-else panx=-1 pany=-1
-endif
-if {$ww!=$oww" || "$wh!=$owh" || "$ox0!=$x0" || "$oy0!=$y0" || "$ox1!=$x1" || "$oy1!=$y1} -rm[baseview] -endif
N=@{points,w}
-if {narg($baseview)" && "$b&3" && "$x>=0" && "$y>=0" && "$x<$w" && "$y<$h}
-if {$selection==-1" && "$N}
($x;$y) -r[-1] $N,2 --[-1] [points] -*[-1] {max($ww,$wh)/max($x1-$x0,$y1-$y0)} -sqr[-1] -s[-1] y -+[-2,-1]
dmin={im} selection={if($dmin>25,-1,xm)} -rm[-1]
-endif
-if {narg($replace_color)}
replace_color= -wait -1
-elif {$selection>=0}
-if {$b&1" && "$view_markers}
--columns[points] $selection ox={i[0]} oy={i[1]} -=[-1] $x -=[-1] $y,0,1 -j[points] [-1],$selection -rm[-1]
-rm[view]
-elif {$b&2" && "$view_markers}
-if {$N>1} --z[points] {$selection+1},100% -j[points] [-1],$selection -rm[-1] -r[points] {$N-1},100%,1,1,0
-else -rm[points] -i[points] 0 -endif
-wait -1 -rm[view]
-endif
-elif {$b&1}
($x;$y;0) ($__color) -y[-1] y -+[-1] 1 -a[-2,-1] y -a[points,-1] x selection=$N -if {!$view_markers} view_markers=2 -endif -rm[view]
-elif {$b&2}
__color=@{-at[colors]\ {$x*$pw/$w},{$y*$ph/$h}}
-endif
-else selection=-1
-if {@{!,-SPACE}" && "narg($colors)} replace_color= -rm[colors]
-elif @{!,-TAB} view_markers={($view_markers-1)%3} -rm[view] -wait -1
-elif {!$is_ctrl" && "@{!,-R}}
-if {narg($replace_color)} replace_color= -else replace_color=$__color -endif
-rm[baseview] -wait -1
-elif @{!,PAGEDOWN} contrast={max(0,$contrast-1)} -rm[view] -wait -1
-elif @{!,PAGEUP} contrast={min(9,$contrast+1)} -rm[view] -wait -1
-elif {@{!,BACKSPACE}" && "$N} -if {$N>1} -z[points] 0,{$N-2} -else i=$points -rm[points] -i[$i] 0 -nm[$i] points -endif -rm[view] -wait -1
-endif
-endif
w2={round(($x1-$x0)/2)} h2={round(($y1-$y0)/2)}
-if {$x0<-$w2} x1={$x1-$x0-$w2} x0=-$w2 -endif
-if {$y0<-$h2} y1={$y1-$y0-$h2} y0=-$h2 -endif
-if {$x1>=$w+$w2} x0={$w-1+$w2-$x1+$x0} x1={$w-1+$w2} -endif
-if {$y1>=$h+$h2} y0={$h-1+$h2-$y1+$y0} y1={$h-1+$h2} -endif
-if {!narg($colors)}
N=@{points,w}
-if {narg($view)} -text_outline[view] "Processing...",5,5,20,2 -w[view] -endif
-if $N
[points]
-sh[-1] 0,0,0,0 -*[-1] {$pw/$w} -rm[-1]
-sh[-1] 1,1,0,0 -*[-1] {$ph/$h} -rm[-1]
-pointcloud[-1] -1,$pw,$ph
--compose_channels[-1] max -!=[-1] 0 -distance[-1] 1 -*[-1] 0.02 -+[-1] 1 -pow[-1] -1 -+[-1] [potential]
-if {!$1} -dilate[-2] 3 -endif
-watershed[-2] [-1],1 -rm[-1] --[-1] 1
-else [potential],[potential],1,3,255
-endif
-nm[-1] colors
-if {narg($baseview)} -rm[baseview] -endif
-endif
-if {!narg($replace_color)" && "narg($points_replaced)}
-rm[points,colors,view] -nm[colors_replaced] colors -nm[points_replaced] points current_replace_color=
-elif {narg($replace_color)" && "{$__color'!='$current_replace_color}}
-if {narg($colors_replaced)} -rm[colors_replaced,points_replaced] -endif
current_replace_color=$__color
-if @{points,w}
--replace_color[colors] 0,0,$replace_color,$current_replace_color
--rows[points] 3,5 -permute[-1] xzcy --[-1] 1
-replace_color[-1] 0,0,$replace_color,$current_replace_color
-+[-1] 1 -permute[-1] xcyz --j[points] [-1],0,3 -rm[-2]
-else 0 0
-endif
-nm[-2] colors_replaced
-nm[-1] points_replaced
-if {narg($baseview)} -rm[baseview] -endif
-endif
-if {!narg($baseview)}
nx0={$x0*$pw/$w} ny0={$y0*$ph/$h}
nx1={$x1*$pw/$w} ny1={$y1*$ph/$h}
--z[img] $x0,$y0,$x1,$y1
-r[-1] $ww,$wh,1,100%,{if($ww<w" && "$wh<h,2,1)}
-if {narg($replace_color)" && "@{points,w}} icolors=$colors_replaced -else icolors=$colors -endif
--z[$icolors] $nx0,$ny0,$nx1,$ny1
-r[-1] $ww,$wh,1,100%,{if($ww<w" && "$wh<h,2,3)}
-if $1 -*[-2] -1 -+[-2] 255 -channels[-2] -3,0 -blend[-1] [-2],alpha -rm[-2]
-else -rgb2ycbcr[-1] -j[-1] [-2],0,0,0,0 -rm[-2] -ycbcr2rgb[-1]
-endif
-nm[-1] baseview
-if {narg($view)} -rm[view] -endif
-endif
-if {!narg($view)}
[baseview] -r[-1] 100%,100%,1,3
-if {$contrast<9} -/[-1] {10-$contrast} -+[-1] {128*(1-1/(10-$contrast))} -endif
-if $view_markers
-if {$view_markers==2} rad1=5 rad2=3 -else rad1=3 rad2=2 -endif
-if {narg($replace_color)" && "@{points,w}} ipoints=$points_replaced -else ipoints=$points -endif
-repeat @{$ipoints,w}
--columns[$ipoints] $> x={(i[0]-$x0)*$ww/(1+$x1-$x0)} y={(i[1]-$y0)*$wh/(1+$y1-$y0)} col={i[3]-1},{i[4]-1},{i[5]-1} -rm[-1]
-circle[-1] $x,$y,$rad1,1,0 -circle[-1] $x,$y,$rad2,1,$col
-done
-endif
-if {narg($replace_color)}
-text_outline[-1] "Replace      by",5,5,20,2
-rectangle[-1] 80,8,111,25,1,0 -rectangle[-1] 82,10,109,23,1,$replace_color
-rectangle[-1] 150,8,181,25,1,0 -rectangle[-1] 152,10,179,23,1,$current_replace_color
-endif
-nm[-1] view
-w[view] $ww,$wh,0,$title
-endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}" && "!@{!,ENTER}}
-if {narg($view)} -text_outline[view] "Processing fullres...",5,5,20,2 -w[view] -endif
-k[0,img,points]
N=@{points,w} status=
-if $N
status=@points
[img] -__x_colorize[-1] $1
-pointcloud[points] -1,$w,$h
--compose_channels[points] max -!=[-1] 0 -distance[-1] 1 -*[-1] 0.02 -+[-1] 1 -pow[-1] -1 -+[potential,-1]
-if {!$1} zfact={@{img,max(w,h)}/@{potential,max(w,h)}} -dilate[points] {int(3*$zfact)} -endif
-watershed[points] [potential],1 --[points] 1 -nm[points] colors
-else [img],[img],1,3,255 -nm[-1] colors
-endif
-if $3
-k[0,colors] -a c
-else
-k[0,img,colors]
-if $1 --*[img] -1 -+[-1] 255 -channels[-1] -3,0 -blend[colors,-1] alpha -rm[0,img]
-else -rgb2ycbcr[colors] -j[colors] [img],0,0,0,0 -rm[0,img] -ycbcr2rgb[colors]
-endif
-endif
-a c -nm $name
__color=-1
-u $status
-w 0
__x_colorize :
-if $1
-b[-1] 0.05% -n[-1] 0,1 --b[-1] 0.5% -pow[-2] 10 -n[-2] 0,1 -n[-1] 0.3,1 -min[-2,-1]
-else
-gradient_norm[-1] -n[-1] 0,255 -normalize_local[-1] 3,3 -*[-1] -1 -n[-1] 0,255
-b[-1] 0.05% -n[-1] 0,1 -sqr[-1] --b[-1] 0.5% -n[-2,-1] 0,1 -min[-2,-1]
-endif
-nm[-1] potential
x_fire : -skip "${1=G\47MIC}"
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Fire effect ----------------------\n
----\n
---- Keys 'CTRL+D' to double window size.\n
---- Keys 'CTRL+C' to reset window size.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-----------------------------------------"
-v -
-i[0] 100,32 -w[0] 450,200,0,"[G"{`39`}"MIC] Fire effect"
-i[1] (0,255,255,255,255^0,0,255,255,255^0,0,0,128,255) -r[1] 256,1,1,3,3
-i[2] (0,0,0;0,0,0;1,1,1;0,1,0) -*[2] 0.21
-text3d "$1",33,3,1
-mv[-1] 3 -c3d[3] -n3d[3] -*3d[3] 320 -col3d[3] 255,205,130 -db3d 0 -f3d 300
100,100 -rand[-1] 0,255 -ellipse[-1] 50%,50%,5,5,0,1,300 -b[-1] 10
-sharpen[-1] 1000 -shrink_xy[-1] 1 -n[-1] 0,255 -to_rgb[-1] -light3d [-1] -rm[-1]
angle=0
-do
-correlate[0] [2]
@{0,w},1 -rand[-1] 128,256 -j[0] [-1],0,{@{0,h}-1} -rm[-1]
--r[0] 400,200,1,1,3 -map[-1] [1]
--r3d[3] 0,1,0,$angle -j3d[-2] [-1],50%,50%,0,1,5,0,0
-*3d[-1] 0.25,0.16,1 -j3d[0] [-1],50%,50%,0,1,3,0,0
-rm[-1]
angle={$angle+3}
-w[-1]
-if {@{!,CTRLLEFT}&&@{!,D}} -w[] {2*w},{2*h} -elif {@{!,CTRLLEFT}&&@{!,C}} -w[] {w},{h} -endif
-rm[-1] -wait 40
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm[0-3] -w 0
-v +
x_fireworks :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Fireworks -----------------------\n
----\n
---- Keys 'CTRL+D' to double window size.\n
---- Keys 'CTRL+C' to reset window size.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-----------------------------------------"
-v - -l[]
time=0
(0;64^0;32^128;0) -r 256,128,1,3,3
[-1]
-w[-1] {1.5*w},{1.5*h},0,"[G"{`39`}"MIC] Fireworks"
-do
time={$time-1}
-if {@#==2\ ||\ $time<0}
-i[0] ({?(w)},\
{h},\
{?(-3,3)},\
{?(2)-5},\
{30+?(20)},\
1.5,\
255,255,255)
time={?(40)}
-endif
-*[-1] 0.99
-j[-1] [-2],0,0,0,0,0.2
i=0
-repeat {@#-2}
to_be_removed=0
radius={if(@{$i,4}>0,@{$i,5}/3,@{$i,5}*(1+2*(@{$i,4}+2)/120))}
-ellipse[-1] @{$i,0},@{$i,1},@{$i,5},{max(0.5,$radius)},{atan2(@{$i,3},@{$i,2})*180/pi},0.6,@{$i,6-8}
(@{$i,2},@{$i,3},0,0.09,-1,0,0,0,0) -+[$i,-1]
-if {@{$i,0}<0\ ||\ @{$i,0}>=w\ ||\ @{$i,1}>=h\ ||\ $radius<0} to_be_removed=1 -endif
-if {@{$i,4}<0\ &&\ @{$i,4}>=-1}
color={min(255,80+?(200))},{min(255,80+?(200))},{min(255,80+?(200))}
radius={?(10)}
N={5+?(10)}
-repeat $N
angle={$>*2*pi/$N}
-i[-3] (@{$i,0,1},{2*cos($angle)+@{$i,2}/1.5},{2*sin($angle)+@{$i,3}/1.5},-2,$radius,$color)
-done
to_be_removed=1
-endif
-if $to_be_removed -rm[$i] -else i={$i+1} -endif
-done
-w[-1] -wait 20
-if {@{!,CTRLLEFT}&&@{!,D}} -w[] {3*w},{3*h} -elif {@{!,CTRLLEFT}&&@{!,C}} -w[] {1.5*w},{1.5*h} -endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm -w 0 -endl -v +
x_fisheye :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Fish-eye effect ------------------\n
----\n
---- Mouse pointer moves fish-eye center.\n
---- Mouse buttons set fish-eye size.\n
---- Keys 'CTRL+D' to double window size.\n
---- Keys 'CTRL+C' to reset window size.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-----------------------------------------"
-v -
-if {@#>0} -a x -n 0,255 -r2dy 220 -else
120,90,1,3 -rand[-1] 0,255 -plasma[-1] 0.3,3 -n 0,255
-t "  G\47MIC\nFISH-EYE\n EFFECT",15,13,23,1,255 -scale2x -b 5 -sharpen 1000
-f i+150-4*abs(y-h/2) -c[-1] 0,255 -frame_fuzzy[-1] 15,10,15,1.5,0 -to_rgb[-1]
-endif
-torus3d 20,6 -col3d[-1] {?(30,255)},{?(30,255)},{?(30,255)} --r3d[-1] 1,0,0,90
-col3d[-1] {?(30,255)},{?(30,255)},{?(30,255)} -+3d[-1] 15 -+3d[-2,-1] -db3d 0 -c3d[-1]
R=30
-w[-2] {1.5*@{-2,w}},{1.5*@{-2,h}},0,"[G"{`39`}"MIC] Fish-eye effect"
-do
-wait 40
-if {@{!,b}==1} R={min(80,$R+8)} -endif
-if {@{!,b}==2} R={max(3,$R-8)} -endif
--j3d[-2] [-1],{50+30*cos(@|*2.5)}%,{50+30*sin(@|*1.6)}%,{50+330*sin(@|*2.6)},0.7,3,0,0 -r3d[-2] 1,0.2,0.6,3
-if {@{!,x}>=0}
-fisheye[-1] {@{!,x}*100/@{!,w}},{@{!,y}*100/@{!,h}},$R
-endif
-w[-1]
-if {@{!,CTRLLEFT}&&@{!,D}} -w[] {3*w},{3*h} -elif {@{!,CTRLLEFT}&&@{!,C}} -w[] {1.5*w},{1.5*h} -endif
-rm[-1]
-if {@!==0" || "@{!,ESC}" || "@{!,Q}} -rm[-2,-1] -w 0 -v + -return -endif
-while 1
x_fourier :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Fourier-filtering ----------------------------------------\n
----\n
---- Mouse buttons on the right image to set min/max frequencies.\n
---- Keys 'CTRL+D' to increase window size.\n
---- Keys 'CTRL+C' to decrease window size.\n
---- Keys 'CTRL+R' to reset window size.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-----------------------------------------------------------------"
-v -
-if {!@#} -testimage2d 256 -endif
-repeat @# -l[$>]
need_update=1
freqmin=0
freqmax=100
-if {w>3*@{!,u}/5} -r2dx[-1] {3*@{!,u}/10} -endif
-if {h>3*@{!,v}/5} -r2dy[-1] {3*@{!,v}/5} -endif
--fft[-1] -nm[-2] real -nm[-1] imag
--sqr[real,imag] -+[-2,-1] -sqrt[-1] -+[-1] 1 -log[-1]
-n[-1] 0,255 -shift[-1] 50%,50%,0,0,2 -to_colormode[-1] @{-2,s}
-nm[-1] logmag
--r2dy[-1] 128 -frame[-1] 1,1,0 -nm[-1] thumb
-w[0,-2] -1,-1,0,"[G"{`39`}"MIC] Fourier filtering"
-l
-if {!narg($first_time)}
-parallel 0,"-alert[thumb] \"[G"{`39`}"MIC Fourier filtering]\",\
\"The G\47MIC Fourier filtering demo illustrates the effect\n\
of bandpass frequency filtering on an image. Use your mouse\n\
buttons to select low and high bounds for the frequencies\n\
displayed on the Fourier representation of the image\n\
(right image).\",\
\"OK\""
first_time=0
-endif
-do
-if $need_update
-i[mask] [logmag],[logmag]
r={sqrt(w^2+h^2)*$freqmax/200} -ellipse[mask] 50%,50%,$r,$r,0,1,1
r={max(0,sqrt(w^2+h^2)*$freqmin/200-1)} -if $r -ellipse[mask] 50%,50%,$r,$r,0,1,0 -endif
--*[logmag] [mask] -+[-1] [mask] -/[-1] 2 -n[-1] 0,255
-shift[mask] -50%,-50%,0,0,2
--*[real,imag] [mask]
-rm[mask]
-ifft[-2,-1] -rm[-1] -n[-1] 0,255
-rv[-2,-1]
-if @! -r[-2,-1] {@{!,w}/2},@{!,h} -endif
-t[-1] "Freq. Min/Max = "{int($freqmin)}"% / "{int($freqmax)}"%",5,5,13,1,255
-w[-2,-1] -rm[-2,-1]
need_update=0
-endif
-wait
-if {@{!,b}" && "@{!,x}>=@{!,w}/2}
r={200*sqrt((@{!,x}-3*@{!,w}/4)^2+(@{!,y}-@{!,h}/2)^2)/\
sqrt((@{!,w}/2)^2+@{!,h}^2)}
-if {@{!,b}&1} freqmax=$r
-else freqmin={max(0,$r-3)}
-endif
-if {$freqmin>=$freqmax} freqmin=$freqmax -endif
need_update=1
-endif
-if @{!,r} need_update=1 -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,D}} -w[] {@{!,w}*1.5},{@{!,h}*1.5} need_update=1 -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,C}} -w[] {@{!,w}/1.5},{@{!,h}/1.5} need_update=1 -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,R}} -w[] {2*@{0,w}},@{0,h} need_update=1 -endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-w 0
-endl
-rm[^0]
-endl -done -rm -v +
x_histogram :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Histogram demo -------------------------------\n
----\n
---- Mouse to set parameters.\n
---- Right button or key 'SPACE' to reset.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-----------------------------------------------------"
-v -
-if {!@#} -testimage2d 300,300 -else -k[0] -to_rgb -r2dy 300,2 -if {w>800} -r 800,100%,1,3,2 -endif -n 0,255 -endif
--frame[-1] 1,1,0
300,{h},1,3,220
-t[-1] "Gamma :",5,0,16,1,0
-t[-1] "Contrast :",5,50,16,1,0
-t[-1] "Brightness :",5,100,16,1,0
-t[-1] "Smoothness :",5,150,16,1,0
-t[-1] "Sharpness :",5,200,16,1,0
-t[-1] "Clusters :",5,250,16,1,0
-a[-2,-1] x
{w},200,1,3,255
-grid[-1] 10%,10%,0,0,0.3,0xCCCCCCCC,0
-rectangle[-1] 0,0,100%,100%,1,0xFFFFFFFF,0
-axes[-1] 0,255,1,0,13,1,0
-frame[-2,-1] 5,5,220
-a[-2,-1] y
clusters=64 sharpness=0 smoothness=0 contrast=1 brightness=0 gamma=1
-do
[0]
ia={ia}
-if $gamma -/[-1] 255 -^[-1] {1/$gamma} -*[-1] 255 -endif
--[-1] $ia -*[-1] $contrast -+[-1] $brightness -+[-1] $ia
-b[-1] $smoothness
-sharpen[-1] $sharpness
-c[-1] 0,255
--j[-2] [-1],6,6
sx={@{0,w}+12}
-_x_histogram[-1] {$gamma*100/4} -j[-2] [-1],$sx,25 -rm[-1]
-_x_histogram[-1] {$contrast*100/4} -j[-2] [-1],$sx,75 -rm[-1]
-_x_histogram[-1] {($brightness+128)*100/256} -j[-2] [-1],$sx,125 -rm[-1]
-_x_histogram[-1] {$smoothness*100/10} -j[-2] [-1],$sx,175 -rm[-1]
-_x_histogram[-1] {$sharpness*100/2000} -j[-2] [-1],$sx,225 -rm[-1]
-_x_histogram[-1] {$clusters*100/256} -j[-2] [-1],$sx,275 -rm[-1]
--s[-2] c -histogram[-3--1] $clusters,0,255 -/[-3--1] {3*@{0,wh}/$clusters} -rm[-5]
--z[-4] 5,317,{@{-4,w}-5},{@{-4,h}-6}
-graph[-1] [-4],3,0,1,0,0.2,255,0,0
-graph[-1] [-3],3,0,1,0,0.2,0,255,0
-graph[-1] [-2],3,0,1,0,0.2,0,0,255
-rm[-4--2]
-j[-2] [-1],5,317 -rm[-1]
-w[-1] {w},{h},0,"[G"{`39`}"MIC] Histogram demo" -rm[-1]
-wait
-if {@{!,b}&1\ &&\ @{!,x}>=@{0,w}-10}
-if {@{!,y}>=25\ &&\ @{!,y}<=42}
gamma={max(0,min(4,(@{!,x}-$sx)*4/280))}
-elif {@{!,y}>=75\ &&\ @{!,y}<=92}
contrast={max(0,min(4,(@{!,x}-$sx)*4/280))}
-elif {@{!,y}>=125\ &&\ @{!,y}<=142}
brightness={max(-128,min(128,(@{!,x}-$sx)*256/280-128))}
-elif {@{!,y}>=175\ &&\ @{!,y}<=192}
smoothness={max(0,min(10,(@{!,x}-$sx)*10/280))}
-elif {@{!,y}>=225\ &&\ @{!,y}<=242}
sharpness={max(0,min(2000,(@{!,x}-$sx)*2000/280))}
-elif {@{!,y}>=275\ &&\ @{!,y}<=292}
clusters={max(2,min(256,(@{!,x}-$sx)*256/280))}
-endif
-endif
-if {@{!,b}&2\ ||\ @{!,SPACE}} clusters=64 sharpness=0 smoothness=0 contrast=1 brightness=0 gamma=1 -endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-w 0 -rm -v +
_x_histogram :
val={max(0,min(100,$1))}
280,2,1,3,255 -line[-1] 0,0,$val%,0,1,0,255,0 -line[-1] 0,1,$val%,1,1,240,255,62 -r[-1] 100%,16,1,3,3
0 -t[-1] {round($val)}%,0,0,14,1,1 --*[-1] -255 -+[-1] 255 -r[-1] 100%,100%,1,3
-j[-3] [-1],{(280-w)/2},{(16-h)/2},0,0,1,[-2] -rm[-2,-1]
-r[-1] {w+2},{h+2},1,3,0,0,0.5,0.5
x_hough :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Hough-transform -----------------------------------------\n
----\n
---- Mouse buttons on the vote image to draw corresponding line.\n
---- Mouse buttons on the image to vote for all lines crossing.\n
---- the clicked point.\n
---- Key 'SPACE' to reset the hough window.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-----------------------------------------------------------------"
-v -
-if {!@#} -testimage2d 400 -endif
-n 0,255
-repeat @# -l[$>]
-r[-1] @{-fitscreen\ {w},{h}},1,100%,3
-if {!narg($first_time)}
-parallel 0,"--l[0] -r2dy 128 -frame 1,1,0 \
-alert \"[G"{`39`}"MIC Hough Transform]\",\
\"The G\47MIC Hough transform demo illustrates the application\n\
of the Hough transform to detect lines in an image. Use your\n\
mouse buttons to explore the transform image and see how\n\
lines in images are represented by points in the transform.\",\
\"OK\" \
-rm -endl"
first_time=0
-endif
rhomax={sqrt(w^2+h^2)/2}
--b[-1] 1.5 -hough[-1] 512,400 -b[-1] 0.5 -+[-1] 1 -log[-1] -n[-1] 0,255
-w[-2] -1,-1,0,"[G"{`39`}"MIC] Image" -w1[-1] -1,-1,0,"[G"{`39`}"MIC] Hough transform"
-do
-wait
-if @{!,b}
x0={@{!,x}-@{!,w}/2}
y0={@{!,y}-@{!,h}/2}
rho0={sqrt(($x0)^2+($y0)^2)}
theta0={atan2($y0,$x0)}
(0,{2*pi}) ($theta0,{$theta0-2*pi})
-r[-2,-1] @{-3,w},1,1,1,3
-cos[-1] -*[-1] $rho0 --<[-1] 0 -abs[-2]
-*[-1] {pi} -+[-3,-1] -%[-2] {2*pi}
-*[-2] {0.5*@{-3,w}/pi} -*[-1] {@{-3,h}/$rhomax}
-a[-2,-1] y
-repeat {w} -point[-2] @{-1,($>,0)},@{-1,($>,1)},0,0.3,255 -done
-rm[-1] -w1[-1]
-elif {@{!1,x}>=0" && "@{!1,b}}
theta={@{!1,x}*2*pi/@{!1,w}}
rho={@{!1,y}*$rhomax/@{!1,h}}
x={@{-2,w}/2+$rho*cos($theta)}
y={@{-2,h}/2+$rho*sin($theta)}
x0={$x+1000*sin($theta)}
y0={$y-1000*cos($theta)}
x1={$x-1000*sin($theta)}
y1={$y+1000*cos($theta)}
[-2]
-line[-1] $x0,$y0,$x1,$y1,1,0x0F0F0F0F,255
-line[-1] {$x0+1},$y0,$x1,$y1,1,0x0F0F0F0F,255
-line[-1] $x0,{$y0+1},$x1,$y1,1,0x0F0F0F0F,255
-line[-1] $x0,$y0,$x1,$y1,1,0xF0F0F0F0,0
-line[-1] {$x0+1},$y0,$x1,$y1,1,0xF0F0F0F0,0
-line[-1] $x0,{$y0+1},$x1,$y1,1,0xF0F0F0F0,0
-w[-1] -rm[-1]
-elif {@{!,SPACE}" || "@{!1,SPACE}}
-rm[-1] --b[-1] 1.5 -hough[-1] 512,400 -b[-1] 0.5 -+[-1] 1 -log[-1] -n[-1] 0,255
-w1[-1] -1,-1,0,"Hough Transform"
-elif @{!,r} -w[-2]
-elif @{!1,r} -w1[-1]
-endif
-while {@!" && "@{!1}" && "!@{!,ESC}" && "!@{!,Q}" && "!@{!1,ESC}" && "!@{!1,Q}}
-w 0 -w1 0
-rm[-1] -endl
-if {!@!" || "!@{!1}} -break -endif
-done -rm -v +
x_jawbreaker : -check "${1=12}>0 && $1<20 && ${2=13}>0 && $2<20 && ${3=5}>0 && $3<=8"
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Jawbreaker --------------------------------------------\n
----\n
---- The goal of the game is to remove the maximum number of\n
---- balls on the board, simply by clicking on them. But a\n
---- colored ball can disappear only if it is grouped with at\n
---- least one ball of the same color. The score is higher if\n
---- you destroy larger sets of connected colored balls.\n
----\n
---- Left mouse button to select/destroy balls on board.\n
---- Key 'BACKSPACE' or 'SPACE' to undo the last move.\n
---- Key 'S' to save snapshot of the current view.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
--------------------------------------------------------------"
-v -
-i[board] $1,$2 -rand[board] 1,$3 -round[board] 1
-i[undo] [-1]
-i[balls] 32,32,1,4 -_x_jawbreaker_ball[-1] -autocrop[-1] 0 -expand_xy[-1] 1,0 -*[-1] 1.5 -c[-1] 0,255 -r[-1] {@{board,w}*w},{@{board,h}*h},1,1,0,2 -/[-1] 255
-i[back] {w},{h},1,3 -l[-1]
-rand 0,255 -blur_xy 6,20 -equalize 100,0,255 -blur_xy 2,4
-sh 0,0 -sh[-2] 1,1 -sh[-3] 2,2 -/[-3] 4 -/[-2] 8 -/[-1] 2 -rm[-3--1]
-endl
-i[visu] [back]
score=0
undoscore=0
render_board=1
shapescorey=0
shapescore=0
-do
-if $render_board
--abs[board] --[-1] 1 -*[-1] {360/$3} -->=[board] 0 -*[-1] 0.9 --!=[board] 0
-r[-3--1] [balls] [balls] -*[-2,-1] -a[-3--1] c -hsv2rgb[-1]
--compose_channels[-1] + ->[-1] 0 -dilate[-1] 3
-j[visu] [back] -j[visu] [-2],0,0,0,0,1,[-1] -rm[-2,-1]
-if {!$shapescorey} -w[visu] @{back,w},@{back,h},0,"[G"{`39`}"MIC] Jawbreaker (score : "$score")" -endif
render_board=0
-endif
-if $shapescorey
--t[visu] "+"$shapescore,@{!,x},{@{!,y}-64+$shapescorey},32,{($shapescorey-1)/31},255
shapescorey={max(0,$shapescorey-1)}
-w[-1] @{back,w},@{back,h},0,"[G"{`39`}"MIC] Jawbreaker (score : "$score")" -rm[-1] -wait 25
-else -wait -endif
--f[board] "if(i,j(-1)==i || j(1)==i || j(0,1)==i || j(0,-1)==i,0)"
-if {!@{-1,+}} -rm[-1] -break -endif -rm[-1]
-if @{!,r} render_board=1
-elif @{!,S} -o[visu] gmic_jawbreaker.png
-elif {@{!,BACKSPACE}" || "@{!,SPACE}}
-abs[undo] -j[board] [undo]
score=$undoscore
render_board=1
-elif {@{!,x}">=0 && "@{!,b}}
-wait -1
x={"int("@{!,x}"*"@{board,w}"/"@{!,w}")"}
y={"int("@{!,y}"*"@{board,h}"/"@{!,h}")"}
-if {@{board,($x,$y)}>0}
-abs[board] -flood[board] $x,$y,0,0,0,1,-@{board,($x,$y)}
-->=[board] 0 --[-1] 1
shapescore={(@{-1,+}+1)^2} shapescorey={if($shapescore,32,0)} -rm[-1]
-elif @{board,($x,$y)}
--flood[board] $x,$y,0,0,0,1,-1 -==[-1] -1
-if {@{-1,+}>1}
-j[undo] [board]
undoscore=$score
-flood[board] $x,$y,0,0,0,1,0
-repeat @{board,w}
--columns[board] $> -mirror[-1] y
h=@{board,h} -l[-1] -s -,0 -a y -if @# -r 1,$h,1,1,0 -mirror y -else -i 1,$h -endif -endl
-j[board] [-1],$> -rm[-1]
-done
-rows[board] -1,100% -f[board] "if(y==0,if(i(x,h-1),x,w),i)" -sort[board] +,x -rows[board] 1,100%
score={$score+int((@{-1,+}-1)^2)}
-endif
-rm[-1]
-else -abs[board]
-endif
render_board=1
-endif
-while {@!" && "!@{!,Q}" && "!@{!,ESC}}
-if {@!" && "!@{!,ESC}}
-w[] @{visu,w},@{visu,h},0,"[G"{`39`}"MIC] Jawbreaker (final score : "$score")"
-i[gameover] 260,85 -t[-1] "Game Over!",3,0,53,1,1 -t[-1] "Score : "$score,23,53,32,1,1
--dilate[-1] 5 -nm[-1] "mgameover" -*[-2] 255 -r[-2] 100%,100%,1,3
-repeat 25
--r[gameover,mgameover] {400-12*($>+1)}%,{400-12*($>+1)}%
--j[visu] [-2],{(@{visu,w}-w)/2},{(@{visu,h}-h)/2},0,0,{$>/25},[-1]
-w[-1] -rm[-3--1] -wait 25
-done
-do
-wait -if @{!,r} -w[] @{!,w},@{!,h} -wait -1 -endif
-while {@!" && "!@{!,Q}" && "!@{!,ESC}" && "!@{!,b}}
-rm[gameover,mgameover]
-endif
-rm[board,undo,balls,back,visu]
-w 0 -v +
_x_jawbreaker_ball :
mwh={min(w,h)}
-sh 3,3 -f[-1] 0 -rm[-1]
-ellipse {0.5*$mwh},{0.5*$mwh},{0.5*$mwh-4},{0.5*$mwh-4},0,1,240,240,240,1
-sh 0,2 -*[-1] '($mwh+y-x)/(2*w)' -rm[-1]
-ellipse {$mwh*0.7},{$mwh*0.3},{min(30,$mwh*$mwh/512)},{min(30,$mwh*$mwh/512)},0,{min($mwh/64,1)},255,255,255,1
-sh 0,2 -b[-1] {0.02*$mwh} -rm[-1]
-sh 3,3 -*[-2] [-1] -dilate[-1] 3 -rm[-1]
-sh 0,2 -+[-1] 'if(i&&(!j(-1)||!j(1)||!j(0,-1)||!j(0,1)),240/6,0)' -rm[-1]
x_life :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ The game of life --------------------------------------\n
----\n
---- The goal is to create the biggest possible biological\n
---- system. You start with a stock of cells which you can\n
---- spread over the board. For each new cells created\n
---- simultaneously and spontaneously by your system, you\n
---- gain more new cells to scatter.\n
----\n
---- Left mouse button to scatter cells in stock.\n
---- Right mouse button to reset game.\n
---- Key 'S' to save snapshot of the current view.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
--------------------------------------------------------------"
-v -
-i[0] 90,90,1,1,0
-i[1] [0] -f[1] 0
-i[2] 400,400,1,3
-i[3] 1
iteration=0
score=0
bestscore=0
stock=500
-w[0] 400,400,0,"[G"{`39`}"MIC] The game of life"
-cursor[0] 0
-do
(1,1,1;1,0,1;1,1,1) --correlate[0] [-1],0 -rm[-2]
--ir[-1] 2,2 -and[-1] [0] -ir[-2] 3,3 -or[-2,-1]
-rv[0,-1]
-if {@{!,x}>0" && "@{!,b}==1" && "$stock>0}
nb={?*7}
-repeat $nb
x={@{!,x}/@{!,w}*@{0,w}+?(-4,4)}
y={@{!,y}/@{!,h}*@{0,h}+?(-3,3)}
-=[0] 1,$x,$y
-=[1] $iteration,$x,$y
-point[2] {$x*@{2,w}/@{0,w}},{$y*@{2,h}/@{0,h}},0,0.8,255
-done
stock={round(max(0,$stock-$nb))}
-endif
--[-1] [0] -*[-1] -1
stock={$stock-2*(min(0,int(@{-1,+}/16*$score/150)))}
-+[1] [0]
-min[-1] 0 -+[-1] 1 -*[1,-1]
-if {@{!,b}==2}
-f[0-2] 0 iteration=0 score=0 bestscore=0 stock=500 -rm[3] -i[3] 1
-endif
-if {@{3,w}==1}
-rm[3] -i[3] {?(3,12)},1,1,3,?(100,255)
-r[3] {?(100,300)}%,1,1,3,4
-point[3] 0,0,0,1,0
-r[3] {?(100,600)}%,1,1,3,5 -c[3] 0,255
-endif
--r[1] @{2,w},@{2,h} -and[-1] 7 -b[-1] {1+$score*0.05}
-n[-1] 0,@{3,w} -map[-1] [3] -*[-1] 0.1 -+[2,-1] -/[2] 1.1
[2] -if {@{!,x}>0}
opac={0.7*min(1,$stock/500)} r={min(500,$stock)*cos($iteration)/100}
-ellipse[-1] @{!,x},@{!,y},{15+$r},{15+$r},0,$opac,0,196,0
-ellipse[-1] @{!,x},@{!,y},{10+$r},{10+$r},0,$opac,32,64,16
-ellipse[-1] @{!,x},@{!,y},{5+$r},{5+$r},0,$opac,255,230,0
-endif
-t[-1] "Living cells : "$score"\n"\
"Stock : "$stock"\n"\
"Score : "$bestscore,5,3,22,0.7,255
-w[-1] @{!,w},@{!,h}
-if @{!,S} -o[-1] gmic_life.png -endif
-rm[-1]
-if {!($iteration%10)} score=@{0,+} bestscore={max($score,$bestscore)} -endif
-wait 60
iteration={$iteration+1}
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm[0-3] -w 0 -v +
x_light :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Light effect ----------------------\n
----\n
---- Move light position with mouse.\n
---- Mouse buttons fade light in/out.\n
---- Keys 'CTRL+D' to double window size.\n
---- Keys 'CTRL+C' to reset window size.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-----------------------------------------"
-v -
0 -t[-1] "    G\47MIC\nLight effect",0,0,53,1,255 -expand_xy[-1] 15,0 -b[-1] 3
[-1] -n[-2] 0,1 -r[-2] 100%,100%,1,3
-sh[-2] 0,0 -*[-1] 120 -rm[-1]
-sh[-2] 1,1 -*[-1] 70 -rm[-1]
-sh[-2] 0,50%,0,2 -*[-1] 120 -rm[-1]
25%,25%,1,1 -rand[-1] -20,20 -smooth[-1] 10,0,1,1,4 -r[-1] [-2],3 -b[-1] 3 -n[-1] -60,60
-+[-2,-1] -g[-1] xy -a[-2,-1] c -n[-1] -150,150
-w[] {1.5*@{-2,w}},{1.5*@{-2,h}},0,"[G"{`39`}"MIC] Light effect"
-cursor[0] 0
light=70
512,512 -gaussian[-1] $light -n[-1] 0,255
t=0
-do
-if {@{!,x}>=0}
X={round((w-@{!,x})/2)}
Y={round((h-@{!,y})/2)}
-else
X={round((w-@{-2,w}*(1+cos(2*$t)))/2)}
Y={round((h-@{-2,h}*(1+sin(2.5*$t)))/2)}
t={$t+0.02}
-endif
-if {@{!,b}&1} light={min(200,$light+10)} -gaussian[-1] $light -n[-1] 0,255 -endif
-if {@{!,b}&2} light={max(10,$light-10)} -gaussian[-1] $light -n[-1] 0,255 -endif
--z[-1] $X,$Y,{$X+@{-2,w}-1},{$Y+@{-2,h}-1}
-warp[-1] [-3],1,0,1
-r[-1] 100%,100%,1,3 -+[-1] [-4] -c[-1] 0,255
-w[-1]
-if {@{!,CTRLLEFT}&&@{!,D}} -w[] {3*w},{3*h}
-elif {@{!,CTRLLEFT}&&@{!,C}} -w[] {1.5*w},{1.5*h} -endif
-rm[-1] -if {@{!,x}>=0" && "!@{!,b}} -wait -else -wait 20 -endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-w[] 0 -rm[-3--1] -v +
x_mandelbrot : -skip ${1=0},${2=0.317},${3=0.03}
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Mandelbrot/Julia explorer -----------------\n
----\n
---- Select zooming region with mouse.\n
---- Click once to reset zoom factor.\n
---- Keys 'ESC' or 'Q' to exit.\n
---- Key 'C' to print current fractal coordinates.\n
----\n
--------------------------------------------------"
-v -
-rm -w 512,512,0 -_x_mandelbrot_coords $1 -_x_mandelbrot_palette
-do
siz={min(@{!,w},@{!,h})}
$siz,$siz -mandelbrot[-1] @0,256,$1,{if($1,$2,0)},{if($1,$3,0)} -map[-1] [1]
-if $1 -w[-1] $siz,$siz,0,"[G"{`39`}"MIC] Julia set c=("@{0,0}","@{0,1}")-("@{0,2}","@{0,3}"), c0=($2,$3)"
-else -w[-1] $siz,$siz,0,"[G"{`39`}"MIC] Mandelbrot set c=("@{0,0}","@{0,1}")-("@{0,2}","@{0,3}")" -endif
w={w} h={h} -round[-1] -select[-1] 2
-if {@{-1,0}>0}
M={max(@{-1,3}-@{-1,0},@{-1,4}-@{-1,1})}
-if {$M<5} -_x_mandelbrot_coords $1 -rm[1] -_x_mandelbrot_palette -mv[-1] 1
-else ({@{0,0}+@{-1,0}*(@{0,2}-@{0,0})/$w};\
{@{0,1}+@{-1,1}*(@{0,3}-@{0,1})/$h};\
{@{0,0}+(@{-1,0}+$M)*(@{0,2}-@{0,0})/$w};\
{@{0,1}+(@{-1,1}+$M)*(@{0,3}-@{0,1})/$h})
-endif
-rm[0] -mv[-1] 0
-endif
-rm[-1]
-if {@{!,C}}
-if $1 -v + -e[0--4] "Julia set, at c = ("@{0,0-1}")-("@{0,2-3}"), with c0 = ($2,$3)." -v -
-else -v + -e[0--4] "Mandelbrot set, at c = ("@{0,0-1}")-("@{0,2-3}")." -v -
-endif
-endif
-if {!@!" || "@{!,ESC}" || "@{!,Q}} -rm -w 0 -v + -return -endif
-wait -1
-while 1
_x_mandelbrot_coords :
-if $1 (-2;-2;2;2) -else (-2.1;-1.5;1.2;1.5) -endif
_x_mandelbrot_palette :
6,1,1,3 -rand[-1] 20,255 -r[-1] 32,1,1,3,3 -r[-1] 1024,1,1,3,0,2 -=[-1] 0,0,0,0,0 -=[-1] 0,0,0,0,1 -=[-1] 0,0,0,0,2
x_metaballs3d :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ 3d metaballs ---------------------------------------\n
----\n
---- Mouse button or 'SPACE' key to toggle rendering mode.\n
---- Keys 'CTRL+D' to double window size.\n
---- Keys 'CTRL+C' to reset window size.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-----------------------------------------------------------"
-v - -l[]
100,100 -noise[-1] 100,1 -plasma[-1] 1,0,10 -r[-1] 512,320,1,3 -n[-1] 0,1 -b[-1] 4,0 -n[-1] 0,255
-mix_channels[-1] (0.7,0,0;0,0.9,0;0,0,1.2) -c[-1] 0,255 -l3d
0
24,24,24,1,'X=x-w/2;Y=y-h/2;Z=z-d/2;exp(-(X*X+Y*Y+Z*Z)/100)'
72,72,72 M=8 mode=5
s0=Dots s1=Wireframe s2=Flat s3=Flat-shaded s4=Gouraud-shaded s5=Phong-shaded
-repeat $M fx$>={g*1.5} fy$>={g*1.5} fz$>={g*1.5} -done
-w[0] -1,-1,0,"[G"{`39`}"MIC] 3d metaballs"
-do
-repeat $M
x$>={w/2+0.5*(w-@{2,w}-4)*cos(${fx$>}*@|)}
y$>={h/2+0.5*(h-@{2,h}-4)*sin(${fy$>}*@|)}
z$>={d/2+0.5*(d-@{2,d}-4)*sin(${fz$>}*@|)}
-done
-f[3] 0 -repeat $M -j[3] [2],{${x$>}-@{2,w/2}},{${y$>}-@{2,h/2}},{${z$>}-@{2,d/2}},0,-1 -done
--r[3] 24,24,24,1,2 -isosurface3d[-1] 0.4 --3d[-1] 12,12,12 -*3d[-1] 13 -rv3d[-1]
-r3d[-1] 1,2,1,{100*@|}
N={i[7]} (255,255,150;200,96,164;50,150,230) -r[-1] 3,$N,1,1,3 -y[-1] -j[-2] [-1],0,{@{-2,h}-4*$N}
-if {!$mode} -circles3d[-2] 4 -endif
-if {!@{1,w}}
0 -t[-1] ${s$mode},5,5,23,0.5,255,255,255 -b[-1] 0.7 -n[-1] 0,255
--dilate[-1] 3 --j[0] [-2],5,3,0,0,1,[-1],255 -mv[-1] 1 -rm[2,-2,-1]
-endif
--j3d[1] [-2],50%,50%,0,1,{if(!$mode,3,$mode)},0,0,300,0,0,-500,0.1,1.5
-w[-1]
-if {@{!,CTRLLEFT}&&@{!,D}} -w[] {2*w},{2*h} -elif {@{!,CTRLLEFT}&&@{!,C}} -w[] {w},{h} -endif
-rm[-3--1] -wait 20
-if {@{!,b}||@{!,SPACE}} mode={($mode+if(@{!,b}&2,-1,1))%6} -wait -1 -rm[1] -i[1] 0 -endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm -w 0 -endl -v +
x_minesweeper : -check "${1=20}>=8 && $1<=30 && ${2=$1}>=8 && $2<=30"
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Minesweeper -------------------------------------------\n
----\n
---- The goal is to clear the minefield without detonating a\n
---- mine.\n
----\n
---- Left mouse button to try clearing one square.\n
---- Right mouse button to flag or unflag a square.\n
---- Middle mouse button to reset mine field.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
--------------------------------------------------------------\n"
-v -
$1,$2 -noise[-1] 30,2 nb_mines=@{-1,+} (1,1,1;1,0,1;1,1,1) --convolve[-2] [-1],0 -rm[-2] -+[-1] 1 -==[-2] 0 -*[-2,-1] -nm[-1] field
-do x={round(?(w-1))} y={round(?(h-1))} -while {i($x,$y)!=1}
--f[field] 11 -=[-1] 12,$x,$y -nm[-1] board
24,24,1,3,200 -fc[-1] 255,180,130
-ellipse[-1] 12,12,4,4 -line[-1] 6,12,18,12 -line[-1] 12,6,12,18 -line[-1] 13,10,14,10,1,255 -line[-1] 13,11,14,11,1,255
-z[-1] 1,1,{w-2},{h-2} -frame[-1] 1,1,0
--fc[-1] 230,250,255
--t[-1] "1",10,5,13,1,0,196,0 --t[-2] "2",9,5,13,1,0,128,0 --t[-3] "3",9,5,13,1,0,0,255
--t[-4] "4",9,5,13,1,255,0,0 --t[-5] "5",9,5,13,1,200,0,0 --t[-6] "6",9,5,13,1,150,0,0
--t[-7] "7",9,5,13,1,128,0,0 --t[-8] "8",9,5,13,1,64,0,0
--f[-1] 'if(x<=1||y<=1||x>=w-2||y>=h-2,if(x<y,128,255),160+2*(y+x))'
--polygon[-1] 4,13,15,11,15,6,18,17,18,1,0 -line[-1] 12,15,12,6,1,255,0,0 -polygon[-1] 3,12,6,6,9,12,12,1,220,0,0
-rv[-2,-1]
[-1] 100%,100%,1,3 -line[-1] 6,14,10,18,1,0,200,0 -line[-1] 10,18,16,6,1,0,200,0 -dilate[-1] 2
--channels[-1] 1 -n[-1] 0,0.7 -dilate[-1] 3 -j[-3] [-2],0,0,0,0,1,[-1] -rm[-2,-1]
-a[-13--1] x -nm[-1] sprites
(0,23;0,23^0,0;23,23) -r[-1] 24,24,1,2,3 -r[-1] {@{board,w}*24},{@{board,h}*24},1,2,0,2 -nm[-1] offsets
[-1],[-1],1,3,255 -frame[-1] 1,1,0 -frame[-1] 23,23,255
0 -t[-1] "Number of mines : "$nb_mines,0,0,18,1,100,200,255 -negative[-1] -j[-2] [-1],{(@{-2,w}-w)/2},{@{-2,h}-h-2} -rm[-1]
-nm[-1] canvas
failed=0 succeeded=0 nb_flags=0 started=0
-do
--*[board] 24 -r[-1] [offsets],[offsets] -channels[-1] 0,1 -+[-1] [offsets] --warp[sprites] [-1],0,0 -rm[-2]
-j[canvas] [-1],24,24 -rm[-1]
-wait -1
-if $failed
0 -t[-1] "Game\nOver!",3,3,38,1,255 -r[-1] 100%,100%,1,4 -sh[-1] 3,3 -dilate[-1] 5 -/[-1] 2 -rm[-1]
-drop_shadow[-1] 5,5,1 -blend[canvas,-1] alpha
0 -t[-1] "Boom! You failed!",0,0,18,1,100,255,255 -r[-1] @{canvas,w},100%,1,3,0,0,0.5,0.5 -negative[-1] -j[canvas] [-1],0,3 -rm[-1]
-do -w[canvas] {w},{h} -wait -while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-elif $succeeded
0 -t[-1] "Success!",3,3,38,1,255 -r[-1] 100%,100%,1,4 -sh[-1] 3,3 -dilate[-1] 5 -/[-1] 2 -rm[-1]
-drop_shadow[-1] 5,5,1 -blend[canvas,-1] alpha
0 -t[-1] "Congratulations! ("{round(@|-$tic)}" s)",0,0,18,1,255,100,255 -r[-1] @{canvas,w},100%,1,3,0,0,0.5,0.5
-negative[-1] -j[canvas] [-1],0,3 -rm[-1]
-do -w[canvas] {w},{h} -wait -while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-else
--==[board] 10 nb_flags=@{-1,+} -rm[-1]
-do
-if {!$started} tic=@| -endif
0 -t[-1] "Elapsed time : "{round(@|-$tic)}" s / Flags : "$nb_flags,0,0,18,1,255,200,0 -r[-1] @{canvas,w},100%,1,3,0,0,0.5,0.5
-negative[-1] -j[canvas] [-1],0,3 -rm[-1]
-wait 50
x={int((@{!,x}-24)/24)} y={int((@{!,y}-24)/24)} b=@{!,b}
-w[canvas] {w},{h},0,"[G"{`39`}"MIC] Minesweeper"
-while {@!" && "!@{!,ESC}" && "!@{!,Q}" && "!$b}
-endif
-if {$x>=0\ &&\ $y>=0\ &&\ $x<@{board,w}\ &&\ $y<@{board,h}}
-if {$b&1}
started=1 val=@{field,($x,$y)}
-if {$val==0} --==[field] 0 -j[board] [field],0,0,0,0,1,[-1] -rm[-1] failed=1
-elif {$val==1} --flood[field] $x,$y,0,0,1,1,-1 -==[-1] -1 -dilate[-1] 3 -j[board] [field],0,0,0,0,1,[-1] -rm[-1]
-else -=[board] $val,$x,$y
-endif
-elif {n=@{board,($x,$y)};$b&2" && "n>=10" && "n<=11}
-=[board] {if(@{board,($x,$y)}==11,10,11)},$x,$y
-elif {$b&4} -f[board] 10
-endif
-endif
-if {$nb_mines==$nb_flags\ &&\ @{board,M}!=11} succeeded=1 -endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-w 0 -v +
x_minimal_path :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Minimal path ------------------------------------------\n
----\n
---- Click on two points to compute and display the minimal\n
---- path between those points. The ending point is then\n
---- chosen as the next starting point for another path.\n
---- Key 'S' to save snapshot of the current view.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
--------------------------------------------------------------"
-v -
-if {!@#} -testimage2d 400 -endif
-n 0,200 -round 1
-repeat @# -l[$>]
-w[0] -1,-1,0,"[G"{`39`}"MIC] Select starting point P0"
-if {!narg($first_time)}
-parallel 0,"--l[0] -r2dy 128 -frame 1,1,0 \
-alert \"[G"{`39`}"MIC Minimal path]\",\
\"The G\47MIC minimal path demo illustrates how minimal paths\n\
can be computed in images to detect and track edge points.\n\
Use your mouse to select desired starting and ending points,\n\
and see what is the minimal path computed between these points.\",\
\"OK\" \
-rm -endl"
first_time=0
-endif
--gradient_norm -b[-1] 1 -f[-1] exp(-i/10)
-to_rgb[0] --select[0] 0 P0=@-1
-ellipse[0] @{-1,0,1},3,3,0,1,255,0,255
-ellipse[0] @{-1,0,1},3,3,0,1,0xFFFFFFFF,255,255,255
-rm[-1]
-if {min($P0)>=0}
p=1
-do
-w[0] -1,-1,0,"[G"{`39`}"MIC] Select ending point P"$p
--select[0] 0
-if {@{!,S}}
-rm[-1]
--text_outline[0] "Saving snapshot...",5,5,13,1,1,255,255,255 -w[-1] -rm[-1]
-o[0] gmic_minimal_path.png
-wait -1
-else
P1=@-1
-ellipse[0] @{-1,0,1},3,3,0,1,255,0,255
-ellipse[0] @{-1,0,1},3,3,0,1,0xFFFFFFFF,255,255,255
-rm[-1]
-if {min($P1)>=0}
--text_outline[0] "Processing...",5,5,13,1,1,255,255,255 -w[-1] -rm[-1]
--minimal_path[1] $P0,$P1,1
-pointcloud[-1] 0 -*[-1] 255 -r[-1] 100%,100%,1,[0],0,0,0,0,0,0.5 -r[-1] [0],0 -or[0,-1]
P0=$P1 p={$p+1}
-endif
-endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-endif
-rm[1] -w 0
-endl -done -v +
x_pacman :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Pacman -----------------------------------------------\n
----\n
---- This is a G\47MIC implementation of the pacman game.\n
----\n
---- Move the pacman to eat all pacdots on the different levels.\n
---- Eating a pacgum makes pacman invincible for 10 seconds,\n
---- which mean pacman can eat ghosts during this time.\n
---- Eating a ghost earns 100 pts.\n
---- Eating a cherry earns 10 pts.\n
---- Eating a strawberry earns 100 pts.\n
---- Eating an orange earns 1000 pts.\n
---- Eating a banana earns 5000 pts.\n
----\n
---- Arrow keys to control pacman.\n
---- Keys 'CTRL+D' to double window size.\n
---- Keys 'CTRL+C' to reset window size.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
--------------------------------------------------------------"
-v - -l[]
-m "_pacman_ghost_base_gfx : 31,19 -circle[-1] 15,15,15,1,1 31,12,1,1,'y<4+8*abs(cos(x*0.3+0.25*pi*$""1))' -a[-2,-1] y"
-repeat 4
-_pacman_ghost_standard_gfx 255,0,0,$> -nm[-1] ghost0_$>
-_pacman_ghost_standard_gfx 0,255,222,$> -nm[-1] ghost1_$>
-_pacman_ghost_standard_gfx 255,184,222,$> -nm[-1] ghost2_$>
-_pacman_ghost_standard_gfx 255,184,71,$> -nm[-1] ghost3_$>
-_pacman_ghost_afraid_gfx $> -nm[-1] ghosta_$>
-_pacman_ghost_base_gfx $> -r[-1] 16,16,1,1,2 -nm[-1] ghostm_$>
-_pacman_ghost_standard_gfx 0,0,0,$> -nm[-1] ghostd_$>
-_pacman_pacman_gfx $> -nm[-2] pacman_$> -nm[-1] pacmanm_$>
-done
--channels[ghostd_0] 0 -!=[-1] 0 -nm[-1] ghostdm
-_pacman_cherry_gfx -nm[-1] fruit0 -_pacman_strawberry_gfx -nm[-1] fruit1
-_pacman_orange_gfx -nm[-1] fruit2 -_pacman_banana_gfx -nm[-1] fruit3
20,2,1,3,200 -nm[-1] gate
score0="10" score1="100" score2="1000" score3="5000" score4="Argh!"
-repeat 5
0 -t[-1] ${score$>},0,0,13,1,255,255,255 -autocrop[-1] 0 -expand_xy[-1] 1,0 --dilate[-1] 3
-nm[-1] scorem$> -nm[-2] score$>
-done
time4=255,255,255 time3=255,255,32 time2=255,128,32 time1=255,32,32
-repeat 11 0 -t[-1] $<" s",0,0,23,1,${time{min(4,round(($<+1)/2))}} -nm[-1] time$< -done
0 -t[-1] "Get Ready!",0,0,32,1,255 -autocrop[-1] 0 -expand_xy[-1] 4,0 --dilate[-1] 8 -r[-2] 100%,100%,1,3
-nm[-2] get_ready -nm[-1] get_readym
0 -t[-1] "Game\nOver!",0,0,53,1,255 -autocrop[-1] 0 -expand_xy[-1] 4,0 --dilate[-1] 8 -r[-2] 100%,100%,1,3
-nm[-2] game_over -nm[-1] game_overm
score=0 level=-1 lives=3 is_quit=0
-do
-if {$level<0}
_rlevel=33 _glevel=33 _blevel=255
-_pacman_map_level{((-$level-1)%6)+1} mw={w} mh={h} mw2={int(w/2)} mh2={int(h/2)}
-if {$level<-6} -replace[-1] 3,2 -endif
-nm[-1] map0 -i[map] [-1]
--shift[map] -1,0 --shift[map] 0,-1 --shift[map] 1,0 --shift[map] 0,1 -a[-4--1] z -!=[-1] 1 -nm[-1] can_go
--==[map] 1 100%,100% -=[-1] 1,$mw2,$mh2 -distance[-1] 1,[-2],3 -rm[-2]
-f[-1] 'if(i==2,0,if(i==8,1,if(i==1,2,if(i==4,3,i))))' -nm[-1] path
--==[map] 2 pacdots=@{-1,+} -rm[-1]
level={-$level}
-endif
-f[map] 'if(i>=4,0,i)' --==[map] 1 -expand_xy[-1] 1,0 -r[-1] 1600%,1600% -erode[-1] 9 -b[-1] 2
-g[-1] xy -abs[-2,-1] -+[-2,-1] ->=[-1] 80% -b[-1] 2 -n[-1] 0,1 -shrink_xy[-1] 16
--*[-1] $_glevel --*[-2] $_blevel -*[-3] $_rlevel -a[-3--1] c
16,16,1,1,'x' ---[map] 1 -max[-1] 0 -*[-1] 16 -r[-1] 1600%,1600%
16,16,1,1,'y' -r[-3,-1] [-2],0,2 -+[-2,-1] -a[-2,-1] c
16,16,1,3 -_pacman_pacdots_gfx -_pacman_pacgum_gfx -a[-3--1] y
-warp[-1] [-2],0,0 -rm[-2] -or[-2,-1] -r[-1] 100%,{h+24},1,3,0,0,0,1
-t[-1] "Lives :",10,0,23,1,255 -t[-1] "Score :",{w-140},0,23,1,255
-if $lives --r[pacman_2] 12,12,1,4,2 -r[-1] {100*$lives}%,100%,1,4,0,2 -j[-2] [-1],90,7 -rm[-1] -endif
-nm[-1] visu
-w[visu] -1,-1,0,"[G"{`39`}"MIC] Pacman" -cursor[0] 0
0 -t[-1] "Level "$level,0,0,53,1,1 -autocrop[-1] 0 -expand_xy[-1] 4,0 (0,255^0,255^0,0) --map[-2] [-1] -rm[-2] -dilate[-2] 8
-nm[-1] level_N -nm[-2] levelm_N
-repeat 4 xg$>={16*$mw2} yg$>={16*$mh2+4*$>} dg$>=3 mg$>=0 -done
xp={16*10} yp={16*21} dp=-1 pacgum_timer=-1 fruit_timer=@| dying_pacman=0 is_get_ready=1
xscore=0 yscore=0 nscore=0 oscore=0
-do
t={int(6*@|)%4} left={if($pacgum_timer>=0,10-@|+$pacgum_timer,-1)}
[visu]
-repeat 4
mg=${mg$>} xg=${xg$>} yg={${yg$>}+24}
-if {$mg==0} -j[-1] [ghost$>_$t],$xg,$yg,0,0,1,[ghostm_$t]
-elif {$mg==1} t2={if($left>7,$t,if($left>3,int(12*@|)%4,int(24*@|)%4))} -j[-1] [ghosta_$t2],$xg,$yg,0,0,1,[ghostm_$t]
-elif {$mg==2} -j[-1] [ghostd_$t],$xg,$yg,0,0,0.8,[ghostdm]
-else -j[-1] [ghost$>_$t],$xg,$yg,0,0,{$mg-2},[ghostm_$t] -j[-1] [ghostd_$t],$xg,$yg,0,0,1,[ghostdm]
-endif
-done
-if $dying_pacman
-_pacman_pacman_gfx {$dying_pacman/2} -rotate[-2,-1] {90*(abs($dp)-1)} -j[-3] [-2],$xp,{24+$yp},0,0,1,[-1],255 -rm[-2,-1]
dying_pacman={$dying_pacman+1}
-if {$dying_pacman>64}
-if {$lives!=1} -rm[-1] -break -endif
-j[-1] [game_over],{(w-@{game_over,w})/2},{12+(h-@{game_over,h})/2},0,0,{min(1,($dying_pacman-64)/50)},[game_overm],255
-rectangle[-1] 90,7,101,18,1,0
-endif
-else
--rotate[pacman_$t,pacmanm_$t] {90*(abs($dp)-1)} -j[-3] [-2],$xp,{24+$yp},0,0,1,[-1],255 -rm[-2,-1]
-if {$left>=0" && "($left>=5" || "$t<=2)} -j[-1] [time{round($left)}],{(w-@{time0,w})/2-10},1 -endif
-endif
-t[-1] $score,{w-65},1,22,1,255
-if {$is_get_ready}
-j[-1] [level_N],{(w-@{level_N,w})/2},{12+(h-1.5*@{level_N,h})/2},0,0,1,[levelm_N]
-if {int(@|*4)%2} -j[-1] [get_ready],{(w-@{get_ready,w})/2},{24+(h+@{get_ready,h})/2},0,0,1,[get_readym],255 -endif
-endif
-if {$oscore>0} -j[-1] [score$nscore],$xscore,$yscore,0,0,$oscore,[scorem$nscore],255 oscore={$oscore-0.04} yscore={$yscore-1} -endif
-j[-1] [gate],158,223,0,0,0.6
-w[-1]
-if {@{!,CTRLLEFT}&&@{!,D}} -w[] {2*w},{2*h} -elif {@{!,CTRLLEFT}&&@{!,C}} -w[] {w},{h} -endif
-rm[-1]
-repeat 4
xg=${xg$>} yg=${yg$>} dg=${dg$>} mg=${mg$>}
-if {max(abs($xg-$xp),abs($yg-$yp))<=8}
-if {$mg==0" && "!$dying_pacman} dying_pacman=1
xscore=$xp yscore={$yp+12} oscore=1 nscore=4
-elif {$mg==1} mg=2 mg$>=$mg score={$score+100}
xscore=$xp yscore={$yp+12} oscore=1 nscore=1
-endif
-endif
-if {$mg>=2" && "($xg>>4)==$mw2" && "($yg>>4)==$mh2}
mg={$mg+0.01}
-if {$mg>=3} mg=0 xg={$xg&-2} yg={$yg&-2} -endif
mg$>=$mg
-endif
-if {!($xg&15)" && "!($yg&15)}
({?},{?},{?},{?};0,1,2,3)
-if {$mg<2}
-=[-1] {?(0.6,1)},{if($mg==0,dX0=$xp-$xg;dY0=$yp-$yg;if(abs(dX0)>abs(dY0),if(dX0>0,0,2),if(dY0>0,1,3)),\
dX1=$xp-$xg;dY1=$yp-$yg;if(abs(dX1)<abs(dY1),if(dX1>0,2,0),if(dY1>0,3,1)))}
-=[-1] 0,{($dg+2)%4}
-if $is_get_ready -=[-1] 0.8,@{path,({$xg>>4},{$yg>>4})} -endif
-else -=[-1] 1,@{path,({$xg>>4},{$yg>>4})}
-endif
-sort[-1] -,x -repeat 4 d={i($>,1)} -if @{can_go,({$xg>>4},{$yg>>4},$d)} dg=$d -break -endif -done -rm[-1]
dg$>=$d
-endif
u={D=${dg$>};(D==0)-(D==2)}
v={D=${dg$>};(D==1)-(D==3)}
xg$>={($xg+$u*(1+($mg==0)))%(16*$mw)}
yg$>={($yg+$v*(1+($mg==0)))%(16*$mh)}
-done
-wait 22
-if {!$dying_pacman}
d={if(@{!,ARROWRIGHT},1,if(@{!,ARROWDOWN},2,if(@{!,ARROWLEFT},3,if(@{!,ARROWUP},4,$dp))))}
-if {!($xp&15)" && "!($yp&15)}
i=@{map,({$xp>>4},{$yp>>4})}
-if {$i==2} score={$score+10} pacdots={$pacdots-1}
-elif {$i==3} pacgum_timer=@| -repeat 4 -if {!${mg$>}} mg$>=1 dg$>={(${dg$>}+2)%4} -endif -done
-elif {$i>=4} score={$score+${score{$i-4}}} xscore=$xp yscore={$yp+12} oscore=1 nscore={$i-4}
-endif
-=[map] 0,{$xp>>4},{$yp>>4}
16,16,1,3 -j[visu] [-1],$xp,{24+$yp} -rm[-1]
d={if(@{can_go,({$xp>>4},{$yp>>4},{abs($d)-1})},$d,$dp)}
d={if(@{can_go,({$xp>>4},{$yp>>4},{abs($d)-1})},$d,-abs($dp))}
dp=$d
-else dp={if(abs($d-$dp)==2,$d,$dp)}
-endif
is_get_ready={if($dp>0,0,$is_get_ready)}
u={($dp==1)-($dp==3)}
v={($dp==2)-($dp==4)}
xp={($xp+2*$u)%(16*$mw)}
yp={($yp+2*$v)%(16*$mh)}
-if {$pacgum_timer>=0" && "@|>$pacgum_timer+10}
-repeat 4 xg$>={${xg$>}&-2} yg$>={${yg$>}&-2} mg$>={if(${mg$>}==1,0,${mg$>})} -done
pacgum_timer=-1
-endif
-if {!$is_get_ready" && "(@|-$fruit_timer)>=10}
x={round(?(0,@{map0,w}))}
y={round(?(0,@{map0,h}))}
-if {!@{map,($x,$y)}" && "@{map0,($x,$y)}==2}
n={min(3,int(abs(g*1.7)))} -=[map] {4+$n},$x,$y -j[visu] [fruit$n],{16*$x},{16*$y+24} fruit_timer=@|
-endif
-endif
-endif
-if {!@!" || "@{!,Q}" || "@{!,ESC}} is_quit=1 -endif
-while {!$is_quit" && "$pacdots}
-if $is_quit -break
-elif $pacdots
lives={$lives-1}
-else
level={-$level-1} -wait[0] -1
-rm[map0,map,can_go,path]
-endif
-rm[visu,level_N,levelm_N]
-while $lives
-rm -w 0 -endl -v +
_pacman_ghost_standard_gfx :
-_pacman_ghost_base_gfx $4 (0,$1^0,$2^0,$3) -map[-2] [-1] -rm[-1]
-ellipse[-1] 10,11,3,4,0,1,255 -ellipse[-1] 20,11,3,4,0,1,255
-r[-1] 16,16,1,3,2 -point[-1] 5,{7-($4>=2)},0,1,1 -point[-1] 10,{7-($4>=2)},0,1,1
_pacman_ghost_afraid_gfx :
-_pacman_ghost_base_gfx $1
-if {$1<2} col=255,255,255 (0,0^0,0^0,208) -else col=255,0,0 (0,248^0,248^0,248) -endif
-map[-2] [-1] -rm[-1] -r[-1] 16,16,1,3,2
-line[-1] 4,4,6,6,1,$col,255 -line[-1] 4,6,6,4,1,$col,255
-line[-1] 9,4,11,6,1,$col,255 -line[-1] 9,6,11,4,1,$col,255
-f[-1] 'if(y>=9&&y<=10&&x>=2&&x<=13&&((int((x+1)/2)+y)%2),arg(c+1,$col),i)'
_pacman_pacman_gfx :
32,32,1,1,'X=x-15;Y=y-15;A=atan2(Y,X);R=sqrt(X^2+Y^2);R<15.5&&abs(A)>0.8*0.33*$1'
(0,255^0,255^0,0^0,255) -map[-2] [-1] -rm[-1] -r[-1] 16,16,1,4,2 -s[-1] c,-3
_pacman_pacdots_gfx :
(255^184^151) -r[-1] 4,4,1,3 -r[-1] 16,16,1,3,0,0,0.5,0.5
_pacman_pacgum_gfx :
16,16,1,3 -circle[-1] 7,7,7,1,255,128,64
_pacman_cherry_gfx :
(12,12,1,1,0,0,-10,-2,1,-8,-4,1,-6,-2,1,0,1,-7,0,1,-3,0,1,-3,-4,2,-3,0,1,-3,-6,2,0,1,-4,-5,2,0,-4,2,-2,\
0,2,3,-2,2,0,-6,2,0,-2,2,3,2,0,-6,2,-2,-3,2,0,2,3,-4,2,-6,-2,2,3,-3,2,-7,-4,2,-2,0)
-uncompress_rle[-1] (0,0,255,255^0,173,0,255^0,0,0,255) -map[-2] [-1] -rm[-1] -r2dy[-1] 14 -r[-1] 16,16,1,3,0,0,0.5,0.5
_pacman_strawberry_gfx :
(11,12,1,1,0,0,-5,0,3,-7,-3,1,3,-3,1,-3,-2,2,-5,1,-2,2,0,-4,2,-3,1,-2,2,3,-2,2,3,-5,2,3,-6,2,3,\
2,3,-13,2,3,-2,2,0,2,3,-2,2,3,-4,2,-2,-9,2,-3,-2,2,3,-2,2,3,-6,-5,2,-8,0,2,-5,0)
-uncompress_rle[-1] (0,0,255,255^0,173,0,255^0,0,0,255) -map[-2] [-1] -rm[-1] -r2dy[-1] 14 -r[-1] 16,16,1,3,0,0,0.5,0.5
_pacman_orange_gfx :
(12,13,1,1,0,0,-5,0,1,0,-2,1,-8,-6,1,-6,0,1,3,-3,1,-4,-3,2,1,-4,2,-3,-10,2,0,-60,2,0,-10,2,-2,-10,2,-4,-6,2,-3,0)
-uncompress_rle[-1] (0,0,255,255^0,173,173,255^0,0,0,255) -map[-2] [-1] -rm[-1] -r2dy[-1] 14 -r[-1] 16,16,1,3,0,0,0.5,0.5
_pacman_banana_gfx :
(9,12,1,1,0,0,-7,0,1,-7,-2,1,-7,-3,1,-5,0,1,0,-2,1,-5,0,1,0,-2,1,-4,0,1,0,-3,1,-4,0,1,0,-3,\
1,-3,0,1,0,1,2,1,-3,0,1,0,1,2,-2,1,-2,0,1,0,1,2,-2,1,-2,-6,1,-3,-4,1,-5,0)
-uncompress_rle[-1] (0,255,255^0,173,255^0,0,255) -map[-2] [-1] -rm[-1] -r2dy[-1] 14 -r[-1] 16,16,1,3,0,0,0.5,0.5
_pacman_map_level1 :
(11,28,1,1,0,0,-12,1,-5,2,1,-4,2,1,3,-3,1,2,1,2,-4,1,2,-3,1,2,1,2,-4,1,-10,2,-3,1,2,1,2,-3,1,2,1,-2,0,1,2,1,2,-3,1,2,-4,1,\
2,1,2,-3,1,2,1,-3,0,2,1,-5,2,-4,1,2,-3,1,0,-3,1,-2,0,1,2,-3,1,0,-3,1,-2,0,1,2,-9,0,1,2,-3,1,0,-2,1,-3,0,1,2,1,-3,0,1,-4,\
0,1,2,1,0,1,0,1,-2,-3,1,2,1,0,1,0,-3,1,-3,0,2,-2,0,1,-4,-3,1,2,-5,1,0,1,-2,0,1,-5,2,-2,0,1,-2,0,1,2,-3,1,2,-6,1,2,-3,1,2,\
-4,1,-9,2,0,1,2,-3,1,2,-3,1,2,-2,1,2,-3,1,2,1,-3,2,-2,1,3,-3,1,2,1,2,-4,1,2,-3,1,2,1,2,-4,1,-10,2,-11,1)
-uncompress_rle[-1] --mirror[-1] x -z[-1] 1,100% -a[-2,-1] x
_rlevel=33 _glevel=33 _blevel=255
_pacman_map_level2 :
(11,28,1,1,0,0,-12,1,-10,2,1,3,1,2,-3,1,2,-4,1,2,1,2,-3,1,2,1,-2,2,1,2,1,-5,2,1,2,-2,1,2,-3,1,2,1,2,1,2,-2,1,2,-3,1,2,1,2,1,\
2,-2,1,-5,2,1,-3,2,-4,1,2,-5,1,0,1,-2,0,1,2,-5,1,0,1,-2,0,1,2,-5,1,0,1,-2,0,1,-3,2,1,-4,-3,1,0,1,2,1,0,-2,1,-5,0,1,2,1,0,1,\
-2,-5,1,2,-2,0,1,-2,-5,1,2,1,0,-3,1,-4,0,1,2,1,-4,-3,1,-3,2,-3,1,0,1,-2,0,1,2,1,-3,2,-2,0,1,-2,0,1,2,-3,1,2,1,0,-4,1,2,-3,1,\
2,1,0,-2,1,-7,2,1,-2,0,1,2,-3,1,2,1,2,-4,1,2,1,-3,2,1,-4,2,1,3,1,2,-5,1,2,-2,1,2,1,2,-5,1,2,-2,1,-9,2,-12,1)
-uncompress_rle[-1] --mirror[-1] x -z[-1] 1,100% -a[-2,-1] x
_rlevel=200 _glevel=33 _blevel=33
_pacman_map_level3 :
(11,28,1,1,0,0,-11,1,-6,0,1,-4,2,-5,1,0,1,2,-8,1,0,1,2,-4,1,3,-8,2,-2,1,2,-5,1,2,1,2,-2,1,2,-5,1,2,1,2,-2,1,2,1,-5,2,1,2,-2,1,2,\
1,2,-3,1,0,1,2,-2,1,-5,2,1,0,1,-2,2,-5,1,2,1,0,-4,1,-5,2,1,-4,0,1,2,-3,1,2,1,0,-2,1,0,1,2,-3,1,2,1,0,1,-2,0,1,-3,2,1,2,-2,0,1,\
-2,-3,1,2,1,2,1,0,-3,1,-2,0,1,2,1,2,1,-6,0,1,2,1,2,-2,1,0,-2,1,-2,0,1,2,1,2,-2,1,0,-2,1,-2,0,1,-6,2,-5,1,2,-4,1,2,-2,1,-3,-3,2,\
1,-3,2,0,-3,1,2,1,2,1,2,-4,1,3,-2,2,1,-5,2,-2,1,2,-3,1,2,-3,1,2,-2,1,2,-3,1,2,-3,1,2,-2,1,-10,2,-11,1)
-uncompress_rle[-1] --mirror[-1] x -z[-1] 1,100% -a[-2,-1] x
_rlevel=33 _glevel=200 _blevel=255
_pacman_map_level4 :
(11,28,1,1,0,0,-9,1,-2,0,1,-7,2,1,-2,0,1,2,-2,1,2,-2,1,2,1,-2,0,1,2,-2,1,2,-2,1,2,1,-2,0,1,-3,2,3,-3,2,-4,1,2,-2,1,2,-2,1,-4,2,1,2,\
-2,1,2,-2,1,2,-2,1,2,1,-7,2,-2,1,2,1,2,-2,1,2,-2,1,-4,2,1,2,-2,1,2,-2,1,2,-2,1,2,1,-7,2,-2,1,2,-3,1,-10,0,1,-5,-2,1,0,-3,1,-5,0,1,\
-10,0,1,-2,-3,1,-5,-6,1,-8,0,1,2,-9,0,1,2,-2,1,2,-2,1,2,-2,1,2,1,2,-2,1,2,-2,1,2,-2,1,2,1,-10,2,1,2,-2,1,2,-2,1,2,-3,0,1,2,-2,1,2,\
-2,1,2,0,-3,1,-3,2,3,-4,2,1,0,1,2,-2,1,2,-2,1,2,-2,1,0,1,2,-2,1,2,-2,1,2,1,-2,0,1,-7,2,1,-2,-9,1,-2,0)
-uncompress_rle[-1] --mirror[-1] x -z[-1] 1,100% -a[-2,-1] x
_rlevel=200 _glevel=200 _blevel=33
_pacman_map_level5 :
(11,28,1,1,0,0,-12,1,-7,2,1,-2,2,1,3,-5,1,2,1,2,-2,1,2,-5,1,2,1,2,-2,1,2,1,-7,2,-2,1,-3,2,1,2,-3,1,2,-4,1,2,1,2,1,0,1,2,-4,1,2,1,2,\
-3,1,2,1,-4,0,1,-6,2,1,2,1,0,-3,1,0,-4,1,2,1,0,-3,1,0,-4,1,2,1,-8,0,1,2,-3,1,0,1,0,-2,1,0,1,2,-3,1,0,1,0,1,-2,0,1,2,-4,0,1,0,1,-2,\
0,1,2,1,0,-3,1,0,-4,1,2,1,-8,0,1,2,-3,1,0,-3,1,0,-2,1,-5,2,1,-3,2,-4,1,2,1,2,1,2,-6,1,2,1,2,1,2,-4,1,3,-2,2,1,-5,2,0,1,2,-3,1,2,-3,\
1,2,-2,1,-5,2,1,-3,2,-2,1,2,-3,1,2,1,2,-4,1,2,-3,1,2,1,2,-4,1,-5,2,1,-4,2,-11,1)
-uncompress_rle[-1] --mirror[-1] x -z[-1] 1,100% -a[-2,-1] x
_rlevel=200 _glevel=255 _blevel=33
_pacman_map_level6 :
(11,28,1,1,0,0,-12,1,-10,2,1,2,-2,1,2,-7,1,3,-9,2,-5,1,2,-6,1,-10,2,1,2,-4,1,0,-5,1,2,1,-8,0,1,2,1,0,-3,1,0,-3,1,0,2,1,0,1,-6,2,1,2,\
-2,0,1,2,-2,1,0,-3,1,2,1,-2,0,2,1,-4,0,1,2,1,0,1,2,-2,-2,1,0,1,2,1,0,1,2,1,0,1,-2,0,1,2,1,0,1,2,1,0,1,-2,0,1,2,1,0,1,2,-2,-4,1,2,\
1,-2,0,2,1,-4,0,1,2,-2,0,1,2,-2,1,0,-2,1,0,2,1,0,1,-6,2,1,2,1,0,-3,1,0,-4,1,2,1,-8,0,1,2,-4,1,0,-3,1,0,1,-10,2,-5,1,2,-6,1,3,-9,\
2,1,2,-2,1,2,-7,1,-10,2,-11,1)
-uncompress_rle[-1] --mirror[-1] x -z[-1] 1,100% -a[-2,-1] x
_rlevel=255 _glevel=130 _blevel=233
x_paint :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Interactive painter -----------------------\n
----\n
---- Use mouse to select color and brush.\n
---- Left button draws a colored stroke.\n
---- Right button fills a colored region.\n
---- Arrow keys or SPACE and BACKSPACE to swap\n
---- between available images.\n
---- Key 'S' to save snapshot of the current view.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
--------------------------------------------------"
-v - -to_rgb
-if {!@#} -i[0] 512,512,1,3,255 -nm[0] "[New image]" -else -k[0] -endif
1
-parallel "-_x_paint[]","-w[] 400,320,0,Palette -x_select_color[] __color,0,0,0" -k[0]
-v +
_x_paint :
-pass[-2,-1] 1 ({'@{-2,n}'}) -discard[-1] {'~'} -nm[-3] @{-1,t} -rm[-1]
color=0,0,0
saturation=1
brushsize=3
brushopacity=0
brushangle=90
brushthickness=1
image=0
refresh_image=1
refresh_brush=1
ox1=-1
oy1=-1
-do
-if $refresh_brush
-rm[-1] (32,64;64,32) -r[-1] 16,16,1,3,1 -r[-1] {8*48},{4*48},1,3,0,2
-repeat 4 -repeat 8
-ellipse[-1] {48*$>+24},{48*@{>,-2}+24},{2*$>+1},{(2*$>+1)*$brushthickness},$brushangle,{1-@{>,-2}/4},255
-done -done
-rectangle[-1] {$brushsize*48},{$brushopacity*48},\
{$brushsize*48+47},{$brushopacity*48+47},\
1,0xFFFFFFFF,255,128,128
{w},16,1,3 -line[-1] 0,50%,100%,50%,1,0x55555555,128,64,128
bx={$brushangle*w/180}
-rectangle[-1] {$bx-16},20%,{$bx+16},80%,1,128
-line[-1] {$bx-16},20%,{$bx+16},20%,1,255 -line[-1] {$bx+16},20%,{$bx+16},80%,1,255
-line[-1] {$bx-16},80%,{$bx+16},80%,1,64 -line[-1] {$bx-16},20%,{$bx-16},80%,1,64
-a[-2,-1] y
16,{h-16},1,3 -line[-1] 50%,0,50%,100%,1,0x55555555,128,64,128
by={$brushthickness*(h-16)}
-rectangle[-1] 20%,{$by-16},80%,{$by+16},1,128
-line[-1] 20%,{$by-16},80%,{$by-16},1,255 -line[-1] 80%,{$by-16},80%,{$by+16},1,255
-line[-1] 20%,{$by-16},20%,{$by+16},1,64 -line[-1] 20%,{$by+16},80%,{$by+16},1,64
-a[-2,-1] x
-w3[-1] {w},{h},0,"Brush"
refresh_brush=0
-endif
-if $refresh_image
-w1[$image] @{$image,w},@{$image,h},0,"Image "#$image" : "@{$image,b}.@{$image,x}
refresh_image=0
-endif
x1=@{!1,x} y1=@{!1,y}
x2=@{!2,x} y2=@{!2,y}
x3=@{!3,x} y3=@{!3,y}
-if {$x1>=0}
-if {@{!1,b}&1}
ox1={if($ox1<0,$x1,$ox1)}
oy1={if($oy1<0,$y1,$oy1)}
delta={max(abs($x1-$ox1),abs($y1-$oy1))}
r1={2*$brushsize+1}
r2={$r1*$brushthickness}
dx={2*($x1-$ox1)/max(1,$delta)}
dy={2*($y1-$oy1)/max(1,$delta)}
o={1-($brushopacity/4)^0.04}
-repeat {max(1,($delta+1)/2)}
-ellipse[$image] {$ox1+$>*$dx},{$oy1+$>*$dy},$r1,$r2,$brushangle,$o,$__color
-done
ox1=$x1 oy1=$y1
refresh_image=1
-else
ox1=-1 oy1=-1
-if {@{!1,b}&2}
-flood[$image] $x1,$y1,0,10,0,1,$__color
refresh_image=1
-endif
-endif
-endif
-if {@{!1,ARROWRIGHT}" || "@{!2,ARROWRIGHT}" || "@{!3,ARROWRIGHT}" || "\
@{!1,ARROWUP}" || "@{!2,ARROWUP}" || "@{!3,ARROWUP}" || "\
@{!1,SPACE}" || "@{!2,SPACE}" || "@{!3,SPACE}}
image={($image+1)%(@#-2)} refresh_image=1
-elif {@{!1,ARROWLEFT}" || "@{!2,ARROWLEFT}" || "@{!3,ARROWLEFT}" || "\
@{!1,ARROWDOWN}" || "@{!2,ARROWDOWN}" || "@{!3,ARROWDOWN}" || "\
@{!1,BACKSPACE}" || "@{!2,BACKSPACE}" || "@{!3,BACKSPACE}}
image={($image-1)%(@#-2)} refresh_image=1
-endif
-if @{!1,S} -o[$image] gmic_paint.png -endif
-if {@{!3,b}" && "$x3>=0}
-if {$x3<384" && "$y3>=192} brushangle={$x3*180/(w-16)}
-elif {$x3>=384" && "$y3<192} brushthickness={$y3/(h-16)}
-elif {$x3<384" && "$y3<192} brushsize={int($x3*8/(w-16))} brushopacity={int($y3*4/(h-16))}
-endif
refresh_brush=1
-endif
-wait
-while {@{!1}" && "!@{!1,Q}" && "!@{!1,ESC}}
__color=-1 -w1[] 0 -w2[] 0 -w3[] 0 -rm[-2,-1]
x_plasma :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Plasma effect --------------------\n
----\n
---- Keys 'CTRL+D' to double window size.\n
---- Keys 'CTRL+C' to reset window size.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-----------------------------------------"
-v - -l[]
N=8
-repeat $N
256,150,1,3 -rand[-1] 0,255 -plasma[-1] 1,0,7 -n[-1] 0,255
amp={?(-40,40)} freq={round(?(2,6))} dir$>={if(?<0.5,-1,1)*round(?(1,2))}
100%,100%,1,1,'$amp*cos(y*2*pi*$freq/h)'
-done
{w+2},100%,1,1,'x' 100%,100%,1,1,'Y=(y-60+5*cos(x/30)+10*sin(x/15));if(Y<0||Y>=32,-1,Y)' -a[-2,-1] c
0 -t[-1] "** Welcome to G\47MIC, a powerful image processing framework **",0,0,33,1,255
-b[-1] 0.6 -n[-1] 0,255
M={w}
-w[] {1.5*@{0,w}},{1.5*@{0,h}},0,"[G"{`39`}"MIC] Plasma effect"
t=0 tt={-1.5*@{0,w}}
-do
tic=@|
a={int($t)}   a2={2*$a} a21={$a2+1}
b={($a+1)%$N} b2={2*$b} b21={$b2+1}
--warp[$a2] [$a21],1,0,2
--warp[$b2] [$b21],1,0,2
-j[-2] [-1],0,0,0,0,{$t-$a} -rm[-1]
-shift[$a21] 0,${dir$a},0,0,2
-shift[$b21] 0,${dir$b},0,0,2
-if {int($t+0.005)>int($t)} dir$a={if(?<0.5,-1,1)*round(?(1,3))} -endif
t={($t+max(0.005,(@|-$tic))%$N)}
--z[-2] $tt,{$tt+w-1+2}
-warp[-1] [-4],0,0,0
-r[-1] 100%,100%,1,3
--*[-1] -1 -+[-1] 255
-j[-3] [-1],0,0,0,0,1,[-2],255 -rm[-1]
-j[-2] [-1],-2,-2,0,0,1,[-1],255 -rm[-1]
tt={$tt+max(2,(@|-$tic)*250)}
-if {$tt>=$M} tt={-1.5*@{0,w}} -endif
-w[-1]
-if {@{!,CTRLLEFT}&&@{!,D}} -w[] {3*w},{3*h} -elif {@{!,CTRLLEFT}&&@{!,C}} -w[] {1.5*w},{1.5*h} -endif
-rm[-1] -wait 20
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm[{-2*$N-2}--1] -w[] 0 -endl -v +
x_quantize_rgb : -check "isint(${1=16}) && $1>1"
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ RGB Quantization --------------------------------------\n
----\n
---- This demo shows how RGB colors can be quantified using\n
---- the k-means algorithm.\n
----\n
---- Left mouse button on 3d view rotates the color cube.\n
---- Right mouse button on 3d view toggles colors/clusters mode.\n
---- Left mouse button on image toggles dithering mode,\n
---- Left mouse button on colormap adds a random color.\n
---- Right mouse button on colormap removes a color.\n
---- Key 'R' init colormap with random values.\n
---- Key 'U' init colormap with uniform sampling.\n
---- Key 'M' init colormap with median-cut algorithm.\n
---- Key 'SPACE' does a single iteration of k-means and pauses.\n
---- Key 'ENTER' runs k-means algorithm.\n
---- Keys 'CTRL+D' to double window size.\n
---- Keys 'CTRL+C' to reset window size.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
--------------------------------------------------------------"
-v -
-if {!@#} -testimage2d 300 -endif
-k[0] -to_rgb -if {h>300} -r2dy 300 -round 1 -endif -nm[-1] img
--r {w*h},1,1,3,-1 -r[-1] {min(w,8192)},1,1,3 -nm[-1] colors
$1,1,1,3 -rand[-1] 0,255 -round[-1] 1 -nm[-1] centroids
-_x_quantize_rgb_3d (1,0,0,0;0,1,0,0;0,0,1,0) -nm[-1] pose3d
-_x_quantize_rgb_text "Colors",clustering0
-_x_quantize_rgb_text "Clusters",clustering1
-_x_quantize_rgb_text "Dithering: off",dithering0
-_x_quantize_rgb_text "Dithering: on",dithering1
-if {@{img,h}<300} --r2dy[img] 300,1 -else [img] -endif
{w+315},365,1,3,255 -rm[-2]
-rectangle[-1] 4,4,305,305,1,0xFFFFFFFF,0
-rectangle[-1] 309,4,{w-5},305,1,0xFFFFFFFF,0
-rectangle[-1] 4,309,{w-5},360,1,0xFFFFFFFF,0
[-1],[-1]
-rectangle[-1] 310,5,{w-6},305,1,1
-rectangle[-1] 5,310,{w-6},360,1,2
300,300,1,1,'(y<<11)+(x<<2)+3' -j[-2] [-1],5,5 -rm[-1]
-a[-2,-1] c -nm[-1] visu
dithering=0 clustering=0 pause=1 s0=off s1=on
-repeat 1e10
-if {!narg($visu_3d)}
---[centroids] 2 --+[centroids] 2 -a[-2,-1] x -permute[-1] cxyz -y[-1] --[-1] 128
-j[obj3d] [-1],0,8 -rm[-1]
[obj3d]
-if $clustering
-if {@{colors,M}<256} --index[colors] [centroids] -*[-1] 256 -+[colors,-1] -endif
--channels[colors] 0 ->>[-1] 8 -map[-1] 2 -permute[-1] cxyz -y[-1] -j[-2] [-1],0,{@{-2,h}-$_N-h} -rm[-1]
-endif
-pose3d[-1] @pose3d 300,300,1,3 -j3d[-1] [-2],50%,50%,100,1,2,0,0,300 -rm[-2]
-j[-1] [clustering$clustering],2,0,0,0,1,[mclustering$clustering],255
-nm[-1] visu_3d -j[visu] [visu_3d],5,5
-endif
-if {!narg($visu_img)}
--index[img] [centroids],{0.7*$dithering},1 -if {h<300} -r2dy[-1] 300,1 -endif
-j[-1] [dithering$dithering],2,0,0,0,1,[mdithering$dithering],255
-nm[-1] visu_img -j[visu] [visu_img],310,5
-endif
-if {!narg($visu_centroids)}
--luminance[centroids] -a[-1] [centroids],y -sort[-1] +,x -rows[-1] 1 -r[-1] {@{visu,w}-10},50,1,3
0 -t[-1] "Colors: "@{centroids,w},2,0,16,1,255,255,255 --dilate[-1] 3 -j[-3] [-2],2,2,0,0,1,[-1],255
-rm[-2,-1] -nm[-1] visu_centroids -j[visu] [visu_centroids],5,310
-endif
-l[visu]
-w -1,-1,0,"[G"{`39`}"MIC] RGB quantization"
-if {@{!,CTRLLEFT}&&@{!,D}} -w[] {2*w},{2*h} -elif {@{!,CTRLLEFT}&&@{!,C}} -w[] {w},{h} -endif
-endl
x={int(@{!,x}*@{visu,w}/@{!,w})}
y={int(@{!,y}*@{visu,h}/@{!,h})}
b=@{!,b}
i=@{visu,($x,$y,0,3)}
-if {$b&1" && "$i==1}
dithering={!$dithering} -rm[visu_img] -wait -1
-elif {$b&1" && "$i==2}
(@{-RGB}) -y[-1] c -a[centroids,-1] x  -_x_quantize_rgb_3d -rm[visu_3d,visu_img,visu_centroids] -and[colors] 255 pause=1 -wait 100
-elif {$b&2" && "$i==2" && "@{centroids,w}>2}
-r[centroids] {@{centroids,w}-1} -_x_quantize_rgb_3d -rm[visu_3d,visu_img,visu_centroids] -and[colors] 255 pause=1 -wait 100
-elif {$b&2" && "$i>=3}
clustering={!$clustering} -rm[visu_3d] -wait -1
-elif @{!,M}
--and[colors] 255 -colormap[-1] @{centroids,w},0,0 -rm[centroids] -nm[-1] centroids
-_x_quantize_rgb_3d -rm[visu_3d,visu_img,visu_centroids] -and[colors] 255 pause=1 -wait -1
-elif @{!,R}
-rand[centroids] 0,255 -round[centroids] 1
-_x_quantize_rgb_3d -rm[visu_3d,visu_img,visu_centroids] -and[colors] 255 pause=1 -wait -1
-elif @{!,U}
-uniform_distribution @{centroids,w},3 -*[-1] 255 -rm[centroids] -nm[-1] centroids
-_x_quantize_rgb_3d -rm[visu_3d,visu_img,visu_centroids] -and[colors] 255 pause=1 -wait -1
-elif @{!,ENTER}
pause=0
-elif {$b&1" && "$i>=3}
coords={@{visu,($x,$y,0,3)}-3} u1={(($coords>>2)&511)-150} v1={($coords>>11)-150}
-if {!narg($u0)} u0=$u1 v0=$v1 -endif
-if {$u0!=$u1" && "$v0!=$v1}
n0={sqrt(($u0)^2+($v0)^2)}
nu0={if($n0>135,$u0*135/$n0,$u0)} nv0={if($n0>135,$v0*135/$n0,$v0)} nw0={sqrt(max(0,18225-($nu0)^2-($nv0)^2))}
n1={sqrt(($u1)^2+($v1)^2)}
nu1={if($n1>135,$u1*135/$n1,$u1)} nv1={if($n1>135,$v1*135/$n1,$v1)} nw1={sqrt(max(0,18225-($nu1)^2-($nv1)^2))}
u={$nv0*$nw1-$nw0*$nv1} v={$nw0*$nu1-$nu0*$nw1} w={$nv0*$nu1-$nu0*$nv1} n={sqrt(($u)^2+($v)^2+($w)^2)}
-rotation3d[] $u,$v,$w,{asin($n/18225)*180/pi} -mv[pose3d] @# -**[-2,-1] -nm[-1] pose3d
u0=$u1 v0=$v1 -rm[visu_3d]
-endif
-elif {!($b&1)} u0=
-endif
-if {!$pause" || "@{!,SPACE}}
pause=@{!,SPACE}
-and[colors] 255 --index[colors] [centroids] -*[-1] 256 -+[colors,-1]
-repeat @{colors,s}
-sh[colors] $>,$> --histogram[-1] {@{centroids,w}*256},0,{@{centroids,w}*256-1} -rm[-2]
-i[-2] 256,1,1,1,'x' -r[-2] {w},1,1,1,0,2 -*[-2] [-1] -r[-2,-1] @{centroids,w},1,1,1,2 -max[-1] 0.01 -/[-2,-1]
-done -a[-@{colors,s}--1] c
-rm[centroids] -nm[-1] centroids
-->>[colors] 8 -channels[-1] 0 -histogram[-1] @{centroids,w},0,{@{centroids,w}-1}
cmax=@{-1,xM}
-repeat {w} -if {!i($>)} -point[centroids] $>,0,0,1,@{-at[centroids]\ $cmax} -point[centroids] $>,0,0,-0.001,@{-RGB} -endif -done
-rm[-1] -c[centroids] 0,255
-if $visu_3d -rm[visu_3d] -endif
-if $visu_img -rm[visu_img] -endif
-if $visu_centroids -rm[visu_centroids] -endif
-wait 20
-else -if $visu_img -wait -endif
-endif
-if {!@!" || "@{!,Q}" || "@{!,ESC}} -break -endif
-done
-rm -w 0 -v +
_x_quantize_rgb_3d :
-if $obj3d -rm[obj3d] -endif
--distribution3d[centroids] -circles3d[-1] 5 -col3d[-1] 255
-colorcube3d -p3d[-1] 1
--and[colors] 255 -distribution3d[-1] -o3d[-1] 0.8 -+3d[-3--1]
--3d[-1] 128,128,128 -nm[-1] obj3d _N={i[7]}
_x_quantize_rgb_text :
0 -t[-1] "$1",0,0,16,1,255 -r[-1] {w+2},15,1,1,0,0,0.5,0.5 --dilate[-1] 3 -to_rgb[-2]
-nm[-2] $2 -nm[-1] m$2
x_reflection3d :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ 3d reflection --------------------\n
----\n
---- Keys 'CTRL+D' to double window size.\n
---- Keys 'CTRL+C' to reset window size.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-----------------------------------------"
-v -
128,256,1,3 -rand[-1] 0,255 -plasma[-1] 1,100 -blur_xy[-1] 30,2
-sh[-1] 0,0 -n[-1] 0,90 -rm[-1] -sh[-1] 1,1 -n[-1] 0,60 -rm[-1] -sh[-1] 2,2 -n[-1] 0,180 -rm[-1]
--mirror[-1] x [-2,-1] -a[-4--1] x
--luminance[-1] -mirror[-1] x -b[-1] 2 -n[-1] 0,255
-torus3d 30,10 -col3d[-1] 255,200,0
-spherical3d 47,34,"80+20*abs(cos(2*theta))" -s3d[-1] -rm[-2] -i[-2] 3,{h},1,1,150,220,255,200,255,255 -y[-2] -a[-6--1] y
-spherical3d 47,34,"100*abs(1+0.6*cos(3*phi)*sin(4*theta))"
-r3d[-2,-1] 0,1,0,90 -db3d 0
xb=0 xl=0 anim=0
-w[] 256,256,0,"[G"{`39`}"MIC] 3d reflection"
-do
tic=@|
--rows[-1] 8,{8+3*i[6]-1} --j[-3] [-1],0,8,0,0,{if($anim<250,0,0.5-0.5*cos(($anim-250)/100))} -rm[-2]
--z[-6] $xb,0,{$xb+255},255 -j3d[-1] [-2],75%,50%,0,1,3,0,0
--z[-6] $xl,0,{$xl+255},255
xf={min(30,$anim-70)+20*cos(1.8*@|)}
yf={50+20*sin(2.7*@|)}
-j3d[-1] [-6],{20+$xf}%,$yf%,0,1,4,0,0
-l3d [-1] -rm[-1] --j3d[-1] [-2],75%,50%,0,1,5,0,0 -j[-2] [-1],0,0,0,0,0.6 -rm[-3,-1]
-j3d[-1] [-4],$xf%,$yf%,0,1,4,0,0
-w[-1]
-if {@{!,CTRLLEFT}&&@{!,D}} -w[] {2*w},{2*h} -elif {@{!,CTRLLEFT}&&@{!,C}} -w[] {w},{h} -endif
-rm[-1]
xb={($xb+6)&255}
xl={($xl-6)&255}
anim={$anim+1}
-r3d[-2,-1] {sin(0.5*@|)},{cos(@|)},1,{(@|-$tic)*33}
-r3d[-3] -1,0.3,0.8,{(@|-$tic)*100}
-wait 20
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm[-5--1] -w[] 0 -v +
x_rubber3d :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ 3d rubber object -----------------\n
----\n
---- Keys 'CTRL+D' to double window size.\n
---- Keys 'CTRL+C' to reset window size.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-----------------------------------------"
-v - -rm
-sphere3d 150,0 -torus3d 70,15 -cylinder3d 20,40
-col3d[-3] 200,200,200,0.3 -col3d[-2] 128,200,76 -col3d[-1] 200,128,76
-c3d[-3--1] -r3d[-1] 1,0,0,70 -+3d[-3--1] -+3d[-1] 10,-8,20
256,256,64,3
{w},{h},1,3,'if(c==0,x,if(c==1,y,y*@{1,d}/h))'
{w},{h},1,3
-w[] {w},{h},0,"[G"{`39`}"MIC] 3d rubber object"
frame=0
-do
{w},{h},1,3 -fc[-1] 16,32,32 -j3d[-1] [0],50%,50%,0,1,3,0,0 -j[1] [-1],0,0,$frame -rm[-1]
-r3d[0] 0.1,1,0.6,{3*cos(@|*1.25)} -r3d[0] 1,0.2,0.6,-1
--warp[1] [2],0,0 -*[3] 0.8 -*[-1] 0.2 -+[3,-1]
-w[-1]
-if {@{!,CTRLLEFT}&&@{!,D}} -w[] {2*w},{2*h} -elif {@{!,CTRLLEFT}&&@{!,C}} -w[] {w},{h} -endif
-wait 20
-sh[2] 2,2 --[-1] 1 -and[-1] {@{1,d}-1} -rm[-1]
frame={($frame-1)%@{1,d}}
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm -w 0 -v +
x_segment : -check "${1=1024}==0 || $1>=128"
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[^-1] "Extract foreground from background in image$? interactively, with maximum resolution $1."
-e[] "\n
----------------------------------------------------------------------------------------------------\n
---- Left mouse button or key 'F' create a new foreground control point (or move an existing one).\n
---- Right mouse button or key 'B' create a new background control point (or move an existing one).\n
---- Mouse wheel, or keys 'CTRL+arrows UP/DOWN' zoom view in/out.\n
---- 'CTRL+mouse wheel', 'SHIFT+mouse wheel' or arrow keys move image in zoomed view.\n
---- Key 'SPACE' updates the extraction mask.\n
---- Key 'TAB' toggles background view modes.\n
---- Key 'M' toggles marker view modes.\n
---- Key 'BACKSPACE' deletes the last control point added.\n
---- Key 'PAGE UP' increases background opacity.\n
---- Key 'PAGE DOWN' decreases background opacity.\n
---- Keys 'CTRL+D' increase window size.\n
---- Keys 'CTRL+C' decrease window size.\n
---- Keys 'CTRL+R' reset window size.\n
---- Keys 'ESC', 'Q' or 'ENTER' exit the interactive window.\n
----------------------------------------------------------------------------------------------------"
-v - -repeat @# -l[$>]
name=@{0,n} title=@{0,b} -if {narg(@{0,x})} title=$title.@{0,x} -endif
w={w} h={h} fdim=@{-fitscreen[]\ $w,$h} ww={arg(1,$fdim)} wh={arg(2,$fdim)} x0=0 y0=0 x1={w-1} y1={h-1}
selection=-1 marker_mode=2 xpan=-1 ypan=-1 bg_mode=0 opacity=64
-to_rgb -nm img
-if {narg($_gimp_control_points)>=4}  ($_gimp_control_points) -r[-1] {w/4},4,1,1,-1
-else 0
-endif
-nm[-1] points
-if {$1>0} -if {$w>$h} --r2dx[img] {min($1,$w)},2 -else --r2dy[img] {min($1,$h)},2 -endif -else [img] -endif
-_x_segment[-1]
pw=@{potential,w} ph=@{potential,h}
-do
-wait
x=@{!,x} y=@{!,y} b=@{!,b} o=@{!,-o}
is_ctrl={@{!,CTRLLEFT}" || "@{!,CTRLRIGHT}}
is_shift={@{!,SHIFTLEFT}" || "@{!,SHIFTRIGHT}}
is_mouseout={$x<0" || "$y<0}
x={$x0+$x*($x1-$x0+1)/$ww} y={$y0+$y*($y1-$y0+1)/$wh}
oww=$ww owh=$wh ox0=$x0 oy0=$y0 ox1=$x1 oy1=$y1
-if @{!,r}
nww=@{!,d} nwh=@{!,e} m={min($nww,$nwh)}
cx={($x0+$x1)/2} cy={($y0+$y1)/2} dx={$nww*($x1-$x0+1)/$ww} dy={$nwh*($y1-$y0+1)/$wh}
x0={$cx-$dx/2} x1={$cx+$dx/2}
y0={$cy-$dy/2} y1={$cy+$dy/2}
ww=$nww wh=$nwh
-elif {$is_ctrl" && "@{!,-D}}
nww={min(@{!,u},$ww*1.25)} nwh={min(@{!,v},$wh*1.25)} m={min($nww,$nwh)}
-if {$m==$nww} ww=$m wh={$h*$m/$w} -else ww={$w*$m/$h} wh=$m -endif
-elif {$is_ctrl" && "@{!,-C}}
nww={$ww/1.25} nwh={$wh/1.25}
-if {min($nww,$nwh)>=64} ww=$nww wh=$nwh -endif
-elif {$is_ctrl" && "@{!,-R}}
fdim=@{-fitscreen[]\ $w,$h} ww={arg(1,$fdim)} wh={arg(2,$fdim)}
x0=0 y0=0 x1={$w-1} y1={$h-1}
-elif {($is_shift" && "$o<0)" || "@{!,ARROWLEFT}}
dx={($x1-$x0)/6} x0={$x0-$dx} x1={$x1-$dx}
-elif {($is_shift" && "$o>0)" || "@{!,ARROWRIGHT}}
dx={($x1-$x0)/6} x0={$x0+$dx} x1={$x1+$dx}
-elif {($is_ctrl" && "$o>0)" || "(@{!,ARROWUP}" && "!$is_ctrl)}
dy={($y1-$y0)/6} y0={$y0-$dy} y1={$y1-$dy}
-elif {($is_ctrl" && "$o<0)" || "(@{!,ARROWDOWN}" && "!$is_ctrl)}
dy={($y1-$y0)/6} y0={$y0+$dy} y1={$y1+$dy}
-elif {$o>0" || "($is_ctrl" && "@{!,ARROWUP})}
-if {$x1-$x0>16" && "$y1-$y0>16}
cx={if($x>=0" && "!@{!,ARROWUP},$x,($x0+$x1)/2)}
cy={if($y>=0" && "!@{!,ARROWUP},$y,($y0+$y1)/2)}
x0={$cx+($x0-$cx)*0.75} y0={$cy+($y0-$cy)*0.75}
x1={$cx+($x1-$cx)*0.75} y1={$cy+($y1-$cy)*0.75}
-endif
-elif {$o<0" || "($is_ctrl" && "@{!,ARROWDOWN})}
zfactor={max(($x1-$x0+1)/$w,($y1-$y0+1)/$h)}
-if {$zfactor<1.3}
cx={if($x>=0" && "!@{!,ARROWDOWN},$x,($x0+$x1)/2)}
cy={if($y>=0" && "!@{!,ARROWDOWN},$y,($y0+$y1)/2)}
x0={$cx+($x0-$cx)/0.75} y0={$cy+($y0-$cy)/0.75}
x1={$cx+($x1-$cx)/0.75} y1={$cy+($y1-$cy)/0.75}
dx={$zfactor^2*($w-$x0-$x1)/2} dy={$zfactor^2*($h-$y0-$y1)/2}
x0={$x0+$dx} x1={$x1+$dx} y0={$y0+$dy} y1={$y1+$dy}
-else
dx={($w-$x0-$x1)/2} dy={($h-$y0-$y1)/2}
x0={$x0+$dx} x1={$x1+$dx} y0={$y0+$dy} y1={$y1+$dy}
-endif
-elif {$b&4" && "!$is_mouseout}
-if {$panx<0" && "$pany<0} panx=$x pany=$y
-else dx={round($panx-$x)} dy={round($pany-$y)} x0={$x0+$dx} y0={$y0+$dy} x1={$x1+$dx} y1={$y1+$dy}
-endif
-else panx=-1 pany=-1
-endif
-if {$ww!=$oww" || "$wh!=$owh" || "$ox0!=$x0" || "$oy0!=$y0" || "$ox1!=$x1" || "$oy1!=$y1} -rm[baseview] -endif
N=@{points,w}
is_left_button={$b&1" || "@{!,F}} is_right_button={$b&2" || "@{!,B}} is_button={$is_left_button" || "$is_right_button}
-if {narg($baseview)" && "$is_button" && "$x>=0" && "$y>=0" && "$x<$w" && "$y<$h}
-if {$selection==-1" && "$N}
($x;$y) -r[-1] $N,2 --[-1] [points] -*[-1] {max($ww,$wh)/max($x1-$x0,$y1-$y0)} -sqr[-1] -s[-1] y -+[-2,-1]
dmin={im} selection={if($dmin>25,-1,xm)} -rm[-1]
-endif
-if {$selection>=0}
-if $marker_mode
--columns[points] $selection ox={i[0]} oy={i[1]}
-=[-1] $x -=[-1] $y,0,1 -=[-1] {1+$is_left_button},0,3
-j[points] [-1],$selection -rm[-1] -rm[view]
-endif
-else
($x;$y;0;{1+$is_left_button}) -a[points,-1] x selection=$N -if {!$marker_mode} marker_mode=2 -endif -rm[view]
-endif
-else selection=-1
-if {@{!,SPACE}" && "narg($labels)} -rm[labels]
-elif @{!,TAB} bg_mode={($bg_mode+1)%6} -rm[baseview] -wait -1
-elif @{!,M} marker_mode={($marker_mode-1)%3} -rm[view] -wait -1
-elif @{!,PAGEDOWN} opacity={max(0,$opacity-32)} -rm[baseview] -wait -1
-elif @{!,PAGEUP} opacity={min(255,$opacity+32)} -rm[baseview] -wait -1
-elif {@{!,BACKSPACE}" && "$N} -if {$N>1} -z[points] 0,{$N-2} -else i=$points -rm[points] -i[$i] 0 -nm[$i] points -endif -rm[view] -wait -1
-endif
-endif
w2={round(($x1-$x0)/2)} h2={round(($y1-$y0)/2)}
-if {$x0<-$w2} x1={$x1-$x0-$w2} x0=-$w2 -endif
-if {$y0<-$h2} y1={$y1-$y0-$h2} y0=-$h2 -endif
-if {$x1>=$w+$w2} x0={$w-1+$w2-$x1+$x0} x1={$w-1+$w2} -endif
-if {$y1>=$h+$h2} y0={$h-1+$h2-$y1+$y0} y1={$h-1+$h2} -endif
-if {!narg($labels)}
N=@{points,w}
-if {narg($view)} -text_outline[view] "Processing...",5,5,20,2 -w[view] -endif
-if $N
[points]
-sh[-1] 0,0,0,0 -*[-1] {$pw/$w} -rm[-1]
-sh[-1] 1,1,0,0 -*[-1] {$ph/$h} -rm[-1]
-pointcloud[-1] -1,$pw,$ph -dilate[-1] 3
-watershed[-1] [potential] --[-1] 1
-else [potential],[potential],1,1,1
-endif
-nm[-1] labels
-if {narg($baseview)} -rm[baseview] -endif
-endif
-if {!narg($baseview)}
nx0={$x0*$pw/$w} ny0={$y0*$ph/$h}
nx1={$x1*$pw/$w} ny1={$y1*$ph/$h}
--z[img] $x0,$y0,$x1,$y1
-r[-1] $ww,$wh,1,100%,{if($ww<w" && "$wh<h,2,1)}
--z[labels] $nx0,$ny0,$nx1,$ny1
-r[-1] $ww,$wh,1,100%,{if($ww<w" && "$wh<h,2,3)}
-if {$bg_mode>=3} -*[-1] -1 -+[-1] 1 -endif
-*[-1] {255-$opacity} -+[-1] $opacity -a[-2,-1] c
-if {$bg_mode%3>=1} -i[-2] 100%,100%,1,3,{(($bg_mode-1)%3)*255} -blend[-2,-1] alpha
-else -drgba[-1]
-endif
-nm[-1] baseview
-if {narg($view)} -rm[view] -endif
-endif
-if {!narg($view)}
[baseview] -r[-1] 100%,100%,1,3
-if $marker_mode
-if {$marker_mode==2} rad1=5 rad2=3 opa=1 -else rad1=3 rad2=2 opa=0.8 -endif
col0=255,0,0 col1=0,255,0
-repeat @{points,w}
--columns[points] $> x={(i[0]-$x0)*$ww/(1+$x1-$x0)} y={(i[1]-$y0)*$wh/(1+$y1-$y0)} l={i[3]-1} -rm[-1]
-circle[-1] $x,$y,$rad1,1,0 -circle[-1] $x,$y,$rad2,$opa,${col$l}
-done
-endif
-nm[-1] view
-w[view] $ww,$wh,0,$title
-endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}" && "!@{!,ENTER}}
-if {narg($view)} -text_outline[view] "Processing fullres...",5,5,20,2 -w[view] -endif
-k[img,points]
N=@{points,w} status=
-if $N
status=@points
[img] -_x_segment[-1] -pointcloud[points] -1,$w,$h
zfact={@{img,max(w,h)}/@{potential,max(w,h)}} -dilate[points] {int(3*$zfact)}
-watershed[points] [potential],1 --[points] 1 -k[img,points]
-*[-1] 255
-else -k[img] [img],[img],1,1,255
-endif
-a c -nm $name
-endl -done
-u $status
-w 0 -v +
_x_segment :
-b[-1] 0.2% -gradient_norm[-1] -f[-1] '1/(1+i^2)'
-nm[-1] potential
x_select_color : -skip ${1=xsc_variable}
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-v - -rm
n={narg($$1)} -if {!$n} $1=0,0,0 -endif
rgba_mode={$n>=4} R={arg(1,$$1)} G={arg(2,$$1)} B={arg(3,$$1)} A={if($rgba_mode,arg(4,$$1),255)}
-v + -e[^-1] "Open "@{-arg\ 1+$rgba_mode,RGB,RGBA}" color selector widget, with variable '$1' and starting color "($$1)"." -v -
-if {!@!} -w[] {400+24*$rgba_mode},400,0,"Select a color" -endif
update_view=1 is_sv=0 is_h=0 is_a=0 colordb=0 is_thread_variable={arg(1,{'$1'})=={'_'}" && "arg(2,{'$1'})=={'_'}}
-m "add_preset : -if {!narg($_xsc_preset$""1)} _xsc_preset$""1=$""2,$""3,$""4 -endif"
-add_preset 0,0,0,0,0 -add_preset 1,255,255,255 -add_preset 2,255,0,0 -add_preset 3,0,255,0 -add_preset 4,0,0,255 -add_preset 5,255,255,0
-add_preset 6,255,0,255 -add_preset 7,0,255,255 -add_preset 8,50,50,50 -add_preset 9,100,100,100 -add_preset 10,150,150,150 -add_preset 11,200,200,200
-uncommand add_preset
-if {!narg($_xsc_preset)} _xsc_preset=11 -endif
($R^$G^$B) -c[-1] 0,255 -rgb2hsv[-1] H={i[0]} S={i[1]} V={i[2]} -rm[-1]
-do
w=@{!,d} h=@{!,e} x=@{!,x} y=@{!,y} b=@{!,b}
-if {!@#}
$w,$h,1,3,200
-if $rgba_mode x1={w-89} y1={h-57} x2={w-80} -else x1={w-49} y1={h-57} x2={w-40} -endif
x0=8 y0=8 x3={$x2+31} x4={w-40} x5={$x4+31} x6={max($x0+232+32*$rgba_mode,w-152)} y6={$y1+7}
-rectangle {$x0-1},{$y0-1},{$x1+1},{$y1+1},1,0xFFFFFFFF,232 -line {$x0-1},{$y0-1},{$x1+1},{$y0-1},1,128 -line {$x0-1},{$y0-1},{$x0-1},{$y1+1},1,128
(1;0) (0,1) -r[-2,-1] {$x1-$x0+1},{$y1-$y0+1},1,1,3 -i[-3] 100%,100%,1,1,$H -a[-3--1] c -hsv2rgb[-1] -j[-2] [-1],$x0,$y0 -rm[-1]
-rectangle {$x2-1},{$y0-1},{$x3+1},{$y1+1},1,0xFFFFFFFF,232 -line {$x2-1},{$y0-1},{$x3+1},{$y0-1},1,128 -line {$x2-1},{$y0-1},{$x2-1},{$y1+1},1,128
(359;0^1;1^1;1) -r[-1] {$x3-$x2+1},{$y1-$y0+1},1,3,3 -hsv2rgb[-1] -j[-2] [-1],$x2,$y0 -rm[-1]
-if $rgba_mode
-rectangle {$x4-1},{$y0-1},{$x5+1},{$y1+1},1,0xFFFFFFFF,232 -line {$x4-1},{$y0-1},{$x5+1},{$y0-1},1,128 -line {$x4-1},{$y0-1},{$x4-1},{$y1+1},1,128
(1;0) -r[-1] {$x5-$x4+1},{$y1-$y0+1},1,4,3 -*[-1] 255 -drgba[-1] -j[-2] [-1],$x4,$y0 -rm[-1]
-endif
-t[-1] "Current",$x0,{$y1+12},14,1,0
-if {narg($_xsc_old)}
-t[-1] "Old",$x0,{$y1+34},14,1,0
($_xsc_old) -y[-1] c -r[-1] 48,16 -drgba[-1] -r[-1] {w+2},{h+2},1,3,0,0,0.5,0.5 -j[-2] [-1],{$x0+55},{$y1+32} -rm[-1]
-endif
-repeat 12
(${_xsc_preset$>}) --[-1] 255 -r[-1] 4,1,1,1,0 -+[-1] 255
-y[-1] c -r[-1] 18,18 -drgba[-1] -frame[-1] 1,1,{255*($>==$_xsc_preset)}
-j[-2] [-1],{$x6+($>%6)*25},{$y6+($>>=6)*25} -rm[-1]
-done
update_view=1
-endif
-if $update_view
[-1]
cx={$x0+$V*($x1-$x0)} cy={$y0+(1-$S)*($y1-$y0)}
-if {$cx>$x0} -line[-1] {$cx-1},$y0,{$cx-1},$y1,1,200 -endif
-if {$cx<$x1} -line[-1] {$cx+1},$y0,{$cx+1},$y1,1,200 -endif
-if {$cy>$y0} -line[-1] $x0,{$cy-1},$x1,{$cy-1},1,200 -endif
-if {$cy<$y1} -line[-1] $x0,{$cy+1},$x1,{$cy+1},1,200 -endif
-line[-1] $x0,$cy,$x1,$cy,1,0 -line[-1] $cx,$y0,$cx,$y1,1,0
cy={$y0+(359-$H)*($y1-$y0)/359}
-if {$cy>$y0} -line[-1] $x2,{$cy-1},$x3,{$cy-1},1,200 -endif
-if {$cy<$y1} -line[-1] $x2,{$cy+1},$x3,{$cy+1},1,200 -endif
-line[-1] $x2,$cy,$x3,$cy,1,0
-if $rgba_mode
cy={$y0+(255-$A)*($y1-$y0)/255}
-if {$cy>$y0} -line[-1] $x4,{$cy-1},$x5,{$cy-1},1,200 -endif
-if {$cy<$y1} -line[-1] $x4,{$cy+1},$x5,{$cy+1},1,200 -endif
-line[-1] $x4,$cy,$x5,$cy,1,0
-endif
($H^$S^$V^$A) -sh[-1] 0,2 -hsv2rgb[-1] -rm[-1] -round[-1] R={i[0]} G={i[1]} B={i[2]}
-r[-1] 48,16 -drgba[-1] -r[-1] {w+2},{h+2},1,3,0,0,0.5,0.5 -j[-2] [-1],{$x0+55},{$y1+10} -rm[-1]
-t[-1] "HSV ("{round($H)}","{round($S*255)}","{round($V*255)}")",{$x0+115},{$y1+24},14,1,0
-if $rgba_mode -t[-1] "RGBA ("$R","$G","$B","{round($A)}")",{$x0+115},{$y1+8},14,1,0
-else -t[-1] "RGB ("$R","$G","$B")",{$x0+115},{$y1+8},14,1,0
-endif
({'@{-dec2hex\ {$R*65536+$G*256+$B}}'}) --[-1] {'0'} -r[-1] 6,1,1,1,0,0,1,0 -+[-1] {'0'}
-f[-1] if(i>={'a'}&&i<={'z'},i+{'A'}-{'a'},i)
-t[-2] "HTML \#"@{-1,t},{$x0+115},{$y1+40},14,1,0 -rm[-1]
-w[-1] 100%,100%,0 -rm[-1]
-if $rgba_mode $1=$R,$G,$B,$A -else $1=$R,$G,$B -endif
update_view=0
-endif
-if $is_thread_variable -wait 50 -else -wait -endif
ww=@{!,w} wh=@{!,h}
is_ctrl={@{!,CTRLLEFT}||@{!,CTRLRIGHT}}
-if @{!,r} ww=@{!,d} wh=@{!,e}
-elif {$is_ctrl" && "@{!,-D}} ww={1.25*$ww} wh={1.25*$wh}
-elif {$is_ctrl" && "@{!,-C}} ww={0.8*$ww} wh={0.8*$wh}
-elif {$is_ctrl" && "@{!,R}} ww={400+24*$rgba_mode} wh=400
-endif
ww={max(200,$ww)} wh={max(200,$wh)}
-if {$ww!=@{!,w}" || "$wh!=@{!,h}} -w[] $ww,$wh -rm -endif
-if {$b&1" && "$x>=0" && "$y>=0}
-if {!$is_h" && "!$is_a" && "($is_sv" || "($x>=$x0" && "$x<=$x1" && "$y>=$y0" && "$y<=$y1))}
S={max(0,min(1,1-($y-$y0)/($y1-$y0)))} V={max(0,min(1,($x-$x0)/($x1-$x0)))}
update_view=1 colordb=0 is_sv=1 -k[0]
-elif {!$is_sv" && "!$is_a" && "($is_h" || "($x>=$x2" && "$x<=$x3" && "$y>=$y0" && "$y<=$y1))}
H={max(0,min(359,359-($y-$y0)*359/($y1-$y0)))}
colordb=0 is_h=1 -rm
-elif {!$is_sv" && "!$is_h" && "($is_a" || "($x>=$x4" && "$x<=$x5" && "$y>=$y0" && "$y<=$y1))}
A={round(max(0,min(255,255-($y-$y0)*255/($y1-$y0))))}
colordb=0 is_a=1 update_view=1 -k[0]
-elif {!$is_sv" && "!$is_h" && "!$is_a" && "{narg($_xsc_old)}" && "$x>=$x0+55" && "$x<=$x0+102" && "$y>=$y1+32" && "$y<=$y1+47}
($_xsc_old) -y[-1] c -sh[-1] 0,2 -rgb2hsv[-1] -rm[-1] H={i[0]} S={i[1]} V={i[2]} A={i[3]}
colordb=0 -rm
-elif {!$is_sv" && "!$is_h" && "!$is_a" && "$x>=$x6" && "$x<=$x5" && "$y>=$y6" && "$y<=$y6+50" && "($x-$x6)%25<=20" && "($y-$y6)%25<=20}
p={int(($x-$x6)/25)+6*int(($y-$y6)/25)} (${_xsc_preset$p}) --[-1] 255 -r[-1] 4,1,1,1,0 -+[-1] 255 -y[-1] c -sh[-1] 0,2 -rgb2hsv[-1] -rm[-1]
H={i[0]} S={i[1]} V={i[2]} A={i[3]}
colordb=0 -rm
-elif {!$is_sv" && "!$is_h" && "!$is_a" && "$x>=$x0+55" && "$x<=$x0+102" && "$y>=$y1+10" && "$y<=$y1+27}
_xsc_old=$R,$G,$B,$A colordb={($colordb+1)%2}
-if {!$colordb} _xsc_preset$_xsc_preset=$R,$G,$B,$A _xsc_preset={($_xsc_preset-1)%12} -endif
-rm -wait -1
-else colordb=0
-endif
-elif {!$b} is_sv=0 is_h=0 is_a=0
-endif
-if @{!,ARROWUP} colordb=0 S={min(1,$S+1/256)} update_view=1 -k[0] -wait -1
-elif @{!,ARROWDOWN} colordb=0 S={max(0,$S-1/256)} update_view=1 -k[0] -wait -1
-elif @{!,ARROWRIGHT} colordb=0 V={min(1,$V+1/256)} update_view=1 -k[0] -wait -1
-elif @{!,ARROWLEFT} colordb=0 V={max(0,$V-1/256)} update_view=1 -k[0] -wait -1
-elif @{!,PAGEUP} colordb=0 H={min(359,$H+1)} -rm -wait -1
-elif @{!,PAGEDOWN} colordb=0 H={max(0,$H-1)} -rm -wait -1
-endif
-if {$$1'=='-1} -break -endif
-if {(($rgba_mode" && "{$$1'!='$R,$G,$B,$A})" || "(!$rgba_mode" && "{$$1'!='$R,$G,$B}))" && "$x<0" && "$y<0" && "!$is_sv" && "!$is_h" && "!$is_a}
($$1) -y[-1] c --[-1] 255 -r[-1] 1,1,1,4,0 -+[-1] 255 -sh[-1] 0,2 -rgb2hsv[-1] -rm[-1]
H={i[0]} S={i[1]} V={i[2]} A={i[3]} -rm
-endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm -w 0
-if $rgba_mode -u $R,$G,$B,$A -else -u $R,$G,$B -endif
_xsc_old=@{}
-v +
x_select_function1d : -skip ${1=xsf_variable},${2=220},${3=$2},${4=$2}
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[^-1] "Open 1d function widget, with variable name '$1'."
-v -
-if @# -k[0] -endif
is_additional_data=@#
-if {!@!} -w[] 400,400,0,"Create a 1d function" -endif
reset_w=@{!,w} reset_h=@{!,h}
-if {!narg($$1)} $1=0,0,100,100 -endif
-i[points] ($$1) -y[-1] x -r[-1] 2,{w/2},1,1,-1
is_thread_variable={arg(1,{'$1'})=={'_'}" && "arg(2,{'$1'})=={'_'}} selected=-1 X=-1 Y=-1
-do
-if {!narg($baseview)}
{@{!,d}-48},{@{!,e}-48},1,3,255
-if $is_additional_data
100%,100% --rows[0] 0 -graph[-2] [-1],3,0,0,0,1,1 -rm[-1] -c[-1] 0,1
--fc[-2] ${2-4} -j[-3] [-1],0,0,0,0,1,[-2] -rm[-2,-1]
-endif
-grid[-1] {(w-1)/8},{(h-1)/8},0,0,0.2,0xCCCCCCCC,0
-line[-1] 0,100%,100%,0,0.2,0
-frame[-1] 24,24,200
-rectangle[-1] 23,23,{w-24},{h-24},1,0xFFFFFFFF,232 -line[-1] 23,23,23,{h-24},1,128 -line[-1] 23,23,{w-24},23,1,128
-if {$is_additional_data" && "@{0,h}>1}
-if {@{0,h}>2} --rows[0] 1,3 -else --rows[0] 1 -r[-1] 100%,3 -endif
-r[-1] @{-2,w-48},3,1,1,3 -permute[-1] xzcy -r[-1] 100%,8 -frame[-1] 1,1,0
-j[-2] [-1],23,@{-2,h-19} -rotate[-1] -90 -j[-2] [-1],@{-2,w-19},23 -rm[-1]
-endif
-nm[-1] baseview
-l -rm[view] -onfail -endl
-endif
-if {!narg($view)}
--z[baseview] 24,24,@{baseview,w-25},@{baseview,h-25} -r[-1] 200%,200%
-function1d[] 1,@points
-l[-1] -c 0,100 -transpose
-i[0] ({'CImg3d'},{h},{h-1})
-i[-2] 1,100%,1,1,y 1,100% -a[-3--1] x
1,{h-1},1,1,2 --f[-1] y --+[-1] 1 -a[-3--1] x
4,100%,1,1,1 -y -a y -col3d 0
-endl
-*3d[-1] @{-2,(w-1)/100},@{-2,(1-h)/100}
-j3d[-2] [-1],0,100%,0,1,1,0,0 -rm[-1]
-repeat @{points,h}
x=@{points,(0,$>)} y={100-@{points,(1,$>)}}
-circle[-1] $x%,$y%,6,1,0xFFFFFFFF,0
-done
-if {$selected>=0}
x=@{points,(0,$selected)} y={100-@{points,(1,$selected)}}
-circle[-1] $x%,$y%,3,1,0
-endif
-r[-1] 50%,50%,1,3,2
--j[baseview] [-1],24,24 -rm[-2]
-if {$X>=0" && "$Y>=0} -t[-1] "X: "{min(255,round(255*$X/100))}" Y: "{min(round(255*$Y/100))},24,6,12,1 -endif
-nm[-1] view
-w[view]
-endif
-if $is_thread_variable -wait 50 -else -wait -endif
x=@{!,x} y=@{!,y} b=@{!,b} is_ctrl={@{!,CTRLLEFT}" || "@{!,CTRLRIGHT}}
X={($x-24)*100/(@{!,w}-49)} Y={100-($y-24)*100/(@{!,h}-49)}
oww=@{!,w} owh=@{!,h} ww=$oww wh=$owh
-if @{!,r} ww=@{!,d} wh=@{!,e}
-elif {$is_ctrl" && "@{!,-D}} ww=@{view,w*125%} wh=@{view,h*125%}
-elif {$is_ctrl" && "@{!,-C}} ww=@{view,w*75%} wh=@{view,h*75%}
-elif {$is_ctrl" && "@{!,R}} ww=$reset_w wh=$reset_h
-elif {!$is_ctrl" && "@{!,R}} -rm[points] -i[points] (0,0;100,100) $1=@points -rm[view]
-elif {$b&3}
is_inside={$X>=0" && "$Y>=0" && "$X<=100" && "$Y<=100}
-if {$selected<0} --f[points] 'sqrt((i-$X)^2+(j(1)-$Y)^2)*@{!,w}%' -z[-1] 0,0 selected={if(im>8,-1,ym)} -rm[-1] -endif
-if {$x>=0" && "$b&1" && "$selected>=0}
-if @{points,$selected>0" && "$selected<h-1}
-=[points] @{points,max(min($X,i(0,$selected+1)-0.5),i(0,$selected-1)+0.5)},0,$selected
-endif
-=[points] {min(100,max(0,$Y))},1,$selected $1=@points -rm[view]
-elif {$b&1" && "$is_inside}
($X,$Y) -a[points,-1] y -sort[points] +,y
--f[points] 'sqrt((i-$X)^2+(j(1)-$Y)^2)*@{!,w}%' -z[-1] 0,0 selected={if(im>8,-1,ym)} $1=@points -rm[view,-1]
-elif {$b&2" && "$selected>0" && "$selected<@{points,h-1}" && "$is_inside}
-l[points] -s y -rm[$selected] -a y -endl -wait -1 selected=-1 $1=@points -rm[view]
-endif
-elif {!($b&1)} selected=-1
-endif
ww={min(90%*@{!,u},max(200,$ww))}
wh={min(90%*@{!,v},max(200,$wh))}
-if {$oww!=$ww" || "$owh!=$wh} -w[] $ww,$wh -rm[baseview,view] -endif
-if {$$1'=='-1} -break -endif
-if {$$1'!='@points} -rm[points] -i[points] ($$1) -y[-1] x -r[-1] 2,{w/2},1,1,-1 -l -rm[view] -onfail -endl -endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-w[] 0 -u @points
-if $is_additional_data -rm[^0] -else -rm -endif
-v +
x_select_palette : -skip ${1=xsp_variable},${2=0}
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-if {!@#} -error[0--3] "Command '-x_select_palette': Missing specified palette image." -endif
-v - -k[0] --r {w*h*d},1,1,{s},-1 -to_color[-1] rgba_mode={s==4} -to_rgba[-1] -nm[-1] palette -v +
-e[^-1] "Open "@{-arg\ 1+$rgba_mode,RGB,RGBA}" color selector widget for palette$?, with variable name '$1'."
-v -
-if {w>1024} -v + -error[0--3] "Command 'x_select_color': Too much colors ("{w}") in selected palette." -endif
-if {!@!} -w[] 400,400,0,0,-1,-1,"Palette: "@{0,b} -endif
selected=-1 oselected=-1
-do
ww=@{!,w} wh=@{!,h}
R=@{palette,round(i($selected,0,0,0))} G=@{palette,round(i($selected,0,0,1))}
B=@{palette,round(i($selected,0,0,2))} A=@{palette,round(i($selected,0,0,3))}
-if {$selected>=0" && "$oselected!=$selected}
-if $rgba_mode $1=$R,$G,$B,$A -else $1=$R,$G,$B -endif
-endif
-if {$$1'=='-1} -break -endif
-if {!narg($baseview)} -l[palette]
{w},1,1,1,x -+[-1] 1
-s[-1] x -append_tiles[^0] $2
M={w} N={h} 100%,100%,1,1,1
--r[-1] {$ww-17},100%,1,1,4
-r[-2] 100%,{$wh-57},1,1,4
-r[-2,-1] [-1],[-2] -or[-2,-1]
-line[-1] 100%,0,100%,100%,1,1
-line[-1] 0,100%,100%,100%,1,1
--[-1] 1 -*[-1] -1
-r[-2] [-1],[-1],1,1,1 --[-2] 1
--map[-2] [0],0 -drgba[-1]
-rv[-2,-1] -*[-2,-1]
--!=[-2] -1 -dilate[-1] 3
-mv[-3] @# -+[-1] 1 -a[-3--1] c
-nm[-1] baseview
-endl
-if {narg($view)} -rm[view] -endif
-endif
-if {!narg($view)}
$ww,$wh,1,3,200
-if {$selected<0} -sh[baseview] 0,2
-else
--channels[baseview] 0,2 --channels[baseview] 4,4
-!=[-1] {$selected+1} -rectangle[-1] 0,0,100%,100%,1,0xFFFFFFFF,1
--dilate[-1] 5 --[-2,-1] -*[-1] -1 --dilate[-1] 5 -*[-2] 255
-r[-2] 100%,100%,1,3 -j[-3] [-2],0,0,0,0,1,[-1] -rm[-2,-1]
-if $rgba_mode -t[-2] "RGBA ("$R","$G","$B","$A")",8,{$wh-45},14,1,0
-else -t[-2] "RGB ("$R","$G","$B")",8,{$wh-45},14,1,0
-endif
($R^$G^$B) -rgb2hsv[-1] H={round(i[0])} S={round(i[1]*255)} V={round(i[2]*255)} -rm[-1]
-t[-2] "HSV ("$H","$S","$V")",8,{$wh-31},14,1,0
({'@{-dec2hex\ {$R*65536+$G*256+$B}}'}) --[-1] {'0'} -r[-1] 6,1,1,1,0,0,1,0 -+[-1] {'0'}
-f[-1] if(i>={'a'}&&i<={'z'},i+{'A'}-{'a'},i)
-t[-3] "HTML \#"@{-1,t},8,{$wh-17},14,1,0 -rm[-1]
-endif
-sh[baseview] 3,3 -j[-3] [-2],8,8,0,0,1,[-1] -rm[-2,-1]
-nm[-1] view -w[view]
-endif
-if {arg(1,{'$1'})=={'_'}" && "arg(2,{'$1'})=={'_'}} -wait 50 -else -wait -endif
is_ctrl={@{!,CTRLLEFT}||@{!,CTRLRIGHT}}
-if @{!,r} ww=@{!,d} wh=@{!,e}
-elif {$is_ctrl" && "@{!,-D}} ww={1.25*$ww} wh={1.25*$wh}
-elif {$is_ctrl" && "@{!,-C}} ww={0.8*$ww} wh={0.8*$wh}
-elif {$is_ctrl" && "@{!,R}} ww=400 wh=400
-endif
ww={max(200,$ww)} wh={max(200,$wh)}
-if {($ww!=@{!,w}" || "$wh!=@{!,h})" && "narg($baseview)} -w[] $ww,$wh -rm[baseview] -endif
oselected=$selected
-if {narg($baseview)}
x=@{!,x} y=@{!,y} b=@{!,b}
-if {$b&1" && "$x>=0" && "$y>=0}
-if @{baseview,i($x-8,$y-8,0,4)} selected=@{baseview,i($x-8,$y-8,0,4)-1} -else selected=-1 -endif
-rm[view] -wait -1
-elif {@{!,ARROWUP}" && "$selected>=$M} selected={$selected-$M} -rm[view] -wait -1
-elif {@{!,ARROWDOWN}" && "$selected<@{0,w-$M}} selected={$selected+$M} -rm[view] -wait -1
-elif {@{!,ARROWRIGHT}" && "$selected<@{0,w-1}} selected={$selected+1} -rm[view] -wait -1
-elif {@{!,ARROWLEFT}" && "$selected>0} selected={$selected-1} -rm[view] -wait -1
-endif
-endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-w 0 -k[0]
-if {$selected>=0} -if $rgba_mode -u $R,$G,$B,$A -else -u $R,$G,$B -endif -else -u -1 -endif
-v +
x_shadebobs :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Shade bobs -------------------------------\n
----\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-------------------------------------------------"
-v - -rm t=100 -w 512,512,0,"[G"{`39`}"MIC] Shade bobs"
-do
t={$t+0.015}
-if {$t>4*pi" || "@{!,b}}
rx={?(-1,1)} ry={?(-1,1)} rz={?(-1,1)} rt={?(-1,1)} rcx={?(-0.6*0.6)} t=0
N={20+round(?(80))} R={(2+round(?(40)))*min(@{!,w},@{!,h})/300}
-if $obj3d -rm[colormap,img,obj3d] -endif
{4+round(?(12))},1,1,3 -noise[0] 255,2 -r[0] 256,1,1,3,3 -*[0] 255 -shift[0] 1 -nm[-1] colormap
(67.5;73.5;109.5;103.5;51.5;100.5;{2*$N};$N) 3,{2*$N},1,1,0
1,$N,1,1,5 2,$N,1,1,'y+x*$N' -a[-2--1] x -z[-1] 0,5
4,$N,1,1,1 -y[-3--1] -a[-4--1] y -nm[-1] obj3d
@{!,w},@{!,h} -nm[-1] img
-wait -1
-endif
r={$ry+$rx*cos(6*$rz*$t)+(1-$rx)*sin(6*$rt*$t)}
(0;{30*$ry*($N-1)}) ($t;{2*pi*($N-1)/$N+$t}) -r[-2,-1] 1,$N,1,1,3
-+[-2] {360*sin($rz*$t)} -*[-2] {pi/180}
--sin[-2,-1] -cos[-4,-3] -*[-4,-2] $r -*[-3,-1] $rcx -+[-4,-3] -+[-2,-1]
-*[-2] {@{!,w}/2} -*[-1] {@{!,h}/2} -a[-2,-1] x
--+[-1] $R --[-2] $R -a[-2,-1] y -z[-1] 0,2 -y[-1] -j[obj3d] [-1],0,8 -rm[-1]
-j3d[img] [obj3d],50%,50%,0,-1,2,0,0
-and[img] 255 --map[img] [colormap] -w[-1] -rm[-1] -wait 20
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm -w 0 -v +
x_spline :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Spline curve editor --------------------------\n
----\n
---- Mouse to insert/move/delete points.\n
---- Key 'R' to reset the curve.\n
---- Key 'SPACE' to shows/hide spline curve.\n
---- Key 'P' to shows/hide control points.\n
---- Key 'ENTER' to shows/hide control polygon.\n
---- Key 'T' to shows/hide point tangents.\n
---- Key 'I' to shows/hide point indices.\n
---- Key 'C' to shows/hide point coordinates.\n
---- Keys '+' and '-' to increase/decrease roundness.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
-----------------------------------------------------"
-v -
-if @# -a x -n 0,255 -to_rgb -else (0;0^0;128^0;0) -r[-1] 512,512,1,3,3 -nm[-1] "[G"{`39`}"MIC] Spline Editor" -endif
-w[0] @{0,w},@{0,h},0,0,-1,-1,@{-1,n} -r[0] @{!,w},@{!,h},1,3,1
-i[1] 1
roundness=0.5
visuflags=23
nearest=-1
active=-1
-do
-if {@{1,#}==1}
-rm[1] roundness=0.5 nearest=-1 active=-1
-i[1] ({0.2*w},{0.2*h};\
{0.2*w},{0.8*h};\
{0.8*w},{0.8*h};\
{0.8*w},{0.2*h})
-endif
[1] ({@{!,w}/@{0,w}},{@{!,h}/@{0,h}}) -*[-2,-1]
--shift[2] 0,-1,0,0,2 --shift[2] 0,1,0,0,2 --[-2,-1] -*[-1] $roundness
--s[-1] x -sqr[-2,-1] -+[-2,-1] -sqrt[-1] -r[-1] 2 --/[-2,-1] -rm[-2]
--r[0] @{!,w},@{!,h},1,3
-if {$visuflags&4} -polygon[-1] @{2,h},@2,0.3,128,200,255 -endif
-repeat @{1,h}
-line[-1] @{2,0-3},0.3,255,255,0
-if {$visuflags&1} -spline[-1] @{2,0-1},@{3,0-1},@{2,2-3},@{3,2-3},32,1,255 -endif
-if {$visuflags&8} -line[-1] {@{2,0}-@{4,0}*20},{@{2,1}-@{4,1}*20},{@{2,0}+@{4,0}*20},{@{2,1}+@{4,1}*20},1,0,255,0 -endif
-if {$visuflags&16} -t[-1] $>,{@{2,0}-3},{@{2,1}-18},13,1,255,255,0 -endif
-if {$visuflags&32} -t[-1] "("{round(@{1,0})}","{round(@{1,1})}")",{@{2,0}-16},{@{2,1}+10},13,1,100,200,255 -endif
-shift[1-4] 0,-1,0,0,2
-done
-if {$visuflags"&2"} -repeat @{1,h}
-ellipse[-1] @{2,0-1},4,4,0,1,0,0,0 -ellipse[-1] @{2,0-1},2,2,0,1,255,100,155 -shift[2] 0,1,0,0,2
-done -endif
-w[-1] -rm[3,4,-1] -wait
-if @{!,SPACE} visuflags={$visuflags+if($visuflags&1,-1,1)} -wait -1 -endif
-if @{!,P} visuflags={$visuflags+if($visuflags&2,-2,2)} -wait -1 -endif
-if @{!,ENTER} visuflags={$visuflags+if($visuflags&4,-4,4)} -wait -1 -endif
-if @{!,T} visuflags={$visuflags+if($visuflags&8,-8,8)} -wait -1 -endif
-if @{!,I} visuflags={$visuflags+if($visuflags&16,-16,16)} -wait -1 -endif
-if {@{!,C}" && "!@{!,CTRLLEFT}" && "!@{!,CTRLRIGHT}} visuflags={$visuflags+if($visuflags&32,-32,32)} -wait -1 -endif
-if {@{!,PADADD}" && "$roundness<1} roundness={$roundness*1.1} -wait -1 -endif
-if {@{!,PADSUB}" && "$roundness>0.1} roundness={$roundness*0.9} -wait -1 -endif
-if {@{!,R}" && "!@{!,CTRLLEFT}" && "!@{!,CTRLRIGHT}} -rm[-1] -i[1] 1 -wait -1 -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,D}} -w[] {@{!,w}*1.5},{@{!,h}*1.5} -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,C}} -w[] {@{!,w}/1.5},{@{!,h}/1.5} -endif
-if {(@{!,CTRLLEFT}" || "@{!,CTRLRIGHT})" && "@{!,R}} -w[] @{0,w},@{0,h} -endif
-if @{!,r} -w[] -endif
-if {@{!,b}==0} active=-1
-elif {@{!,x}>=0" && "@{!,b}" && "$active==-1}
[2] (@{!,x},@{!,y}) --[-2,-1] -sqr[-1] -s[-1] x -+[-2,-1]
(@{-1,c}) nearest=@{-1,1} -rm[-1]
-if {@{-1,m}<64} active=$nearest -endif
-rm[-1]
-endif
-rm[2]
-if {@{!,b}&1" && "@{!,x}>=0" && "$active!=-1}
-=[1] {@{!,x}*@{0,w}/@{!,w}},0,$active
-=[1] {@{!,y}*@{0,h}/@{!,h}},1,$active
-elif {@{!,b}&2" && "@{!,x}>=0" && "@{1,h}>3}
-l[1] -s y -rm[$nearest] -a y -endl -wait -1
-elif {@{!,b}&1" && "@{!,x}>=0}
xy=({@{!,x}*@{0,w}/@{!,w}},{@{!,y}*@{0,h}/@{!,h}})
--shift[1] 0,-1,0,0,2 -+[-1] [1] -/[-1] 2
$xy --[-2,-1] -sqr[-1] -s[-1] x -+[-2,-1]
(@{-1,c}) ns=@{-1,1} -rm[-2,-1]
-l[1] -s y -i[{$ns+1}] $xy -a y -endl
active={$ns+1}
-endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
--shift[1] 0,-1,0,0,2 --shift[1] 0,1,0,0,2 --[-2,-1] -*[-1] $roundness
[0],[0],1,1,2 -rm[0]
-repeat @{1,h} -spline[-1] @{0,0-1},@{1,0-1},@{0,2-3},@{1,2-3},128,1,1 -shift[0] 0,-1,0,0,2 -shift[1] 0,-1,0,0,2 -done
-flood[-1] 0,0,0,0,0,1,0
-rm[0,1] -w 0 -v +
x_tetris :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Tetris --------------------------------------------\n
----\n
---- This is a G\47MIC implementation of the Tetris game.\n
----\n
---- Arrow keys to move/rotate the triominos.\n
---- Key 'SPACE' to make the current triomino falling.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
----------------------------------------------------------"
-v - -rm
-i[m0] 4,1,1,1,1,1,1,1
-i[m4] 3,2,1,1,1,0,0,1,1,1
-i[m8] 3,2,1,1,0,0,1,1,1,1
-i[m12] 2,2,1,1,1,1,1,1
-i[m16] 3,2,1,1,0,1,1,1,1,0
-i[m20] 3,2,1,1,0,1,0,1,1,1
-i[m24] 3,2,1,1,1,1,0,0,1,1
-if {?<0.25}
-i[m28] 2,1,1,1,1,1
-i[m32] 2,2,1,1,1,1,0,1
-i[m36] 3,1,1,1,1,1,1
-i[m40] 1,1,1,1,1
-i[m44] 3,2,1,1,1,1,1,1,0,1
-i[m48] 3,3,1,1,1,1,1,1,0,1,1,1,1
-endif
-repeat @# i={4*$>} -l[m$i] -repeat 3 --rotate[0] {90*($>+1)} -nm[-1] m{$i+$>+1} -done -endl -done
N=@#
-i[colors] 3,$N,1,1,'?(16,224)' -r[-1] 3,400% -i[mask] (0,-1,0;1,0,-1;0,1,0) -*[-1] 120
-repeat $N
--r[m$>] 500%,500%,1,3 --correlate[-1] [mask],0 -r[-1] 200%,200%,1,1,3 -r[-2] [-1] -*[-2,-1] -c[-1] 30%,100%
--r[m$>] [-1],[-1],1,3 --replace_color[-1] 0,0,1,1,1,@{colors,{3*$>}-{3*$>+2}} -rv[-3,-1] -+[-3,-1] -c[-2] 0,255
-channels[-1] 0 -*[-1] 255 -a[-2,-1] c -nm[-1] s$>
-done
-rm[colors,mask]
fact={@{s0,w}/@{m0,w}}
W=12 H=20
-i[board] $W,$H -i[curr_board] [board]
-i[render] {$fact*$W},{$fact*$H},1,3 -i[curr_render] [render] --channels[-1] 0 -nm[-1] curr_render_mask
--rows[render] 0,50% -plasma[-1] 1,2 -noise[-1] 20 -blur_y[-1] 40%,1 --mirror[-1] y -a[-2,-1] y -r[-1] [render]
-n[-1] 0,64 -blur_x[-1] 1 100%,100% -noise[-1] 0.5,2 -b[-1] 1 -*[-1] 300 -+[-2,-1] -c[-1] 0,255 -nm[-1] background
time=@| score=0 fall_mode=0 gameover=0 n=-1 nn={round(?(0,$N-1))}
-do
-wait {if($fall_mode,-1,-20)}
-if $gameover
--j[background] [curr_render],0,0,0,0,0.7,[curr_render_mask],255
-text_outline[-1] "Game\nOver!",30,30%,32,2,1,255 -w[-1] -rm[-1]
-continue
-endif
-if {$n<0}
-l[board] -s y i=-1 -repeat @# -if @{$<,m} i=$<,$i -endif -done
0 -rm[$i] -a y score={$score+2^(narg($i)-1)-1} -r $W,$H,1,1,0,0,0,1 -nm board -endl
-if {narg($i)>1} -l[render] -s y,$H 0 -rm[$i] -a y -r {$fact*$W},{$fact*$H},1,3,0,0,0,1 -nm render -endl -endif
n=$nn nn={round(?(0,$N-1))} x={$W/2} y=0 do_render=1 fall_mode=0
-endif
-if $do_render
-rm[curr_board,curr_render,curr_render_mask]
-i[curr_board] [board] -j[curr_board] [m$n],{$x-int(@{m$n,w}/2)},$y,0,0,1,[m$n]
-i[curr_render] [render] -sh[s$n] 3,3 -j[curr_render] [s$n],{$fact*($x-int(@{m$n,w}/2))},{$fact*$y},0,0,1,[-1],255 -rm[-1]
--*[curr_board] 255 -r[-1] [curr_render],[curr_render] -nm[-1] curr_render_mask
0 -t[-1] "Score : "$score"    Next :",4,0,32,1,164 -r[-1] 40%,40%,1,3,2 --!=[-1] 0 -*[-1] 255
-j[curr_render] [-2],0,0,0,0,1,[-1],255 -j[curr_render_mask] [-1],0,0,0,0,1,[-1],255 -rm[-2,-1]
--*[m$nn] 196 -r[-1] 300%,300%,1,3 -j[curr_render,curr_render_mask] [-1],{@{curr_render,w}-w-4},3,0,0,1,[-1],196 -rm[-1]
do_render=0
-endif
--shift[background] 0,{-13*@|*1.04^$score},0,0,2
-j[-1] [curr_render],0,0,0,0,1,[curr_render_mask],255
-w[-1] {2*w},{2*h},0,"[G"{`39`}"MIC] Tetris" -rm[-1] -cursor[0] 0
-if @{!,SPACE} fall_mode=1 -endif
-if {@{!,ARROWUP}" || "@{!,ARROWLEFT}" || "@{!,ARROWRIGHT}}
an={if(@{!,ARROWUP},n=$n+1;if(n%4,n,n-4),$n)}
nx={w2=int(@{m$an,w}/2);max(w2,min($x-@{!,ARROWLEFT}+@{!,ARROWRIGHT},$W-(@{m$an,w}%2)-w2))}
--j[board] [m$an],{$nx-int(@{m$an,w}/2)},$y,0,0,-1,[m$an]
-if {@{-1,M}==1} x=$nx n=$an -endif
-rm[-1]
do_render=1
-endif
-if {@{!,ARROWDOWN}" || "@|-$time>0.9^int($score/2)" || "$fall_mode}
y={$y+1}
--j[board] [m$n],{$x-int(@{m$n,w}/2)},$y,0,0,-1,[m$n]
-if {@{-1,M}>1" || "$y+@{m$n,h}>$H}
-if {$y<=1} gameover=1 -endif
-j[board] [curr_board] -j[render] [curr_render] n=-1
-endif
-rm[-1]
time=@| do_render=1
-endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm -w 0 -v +
x_tictactoe :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Tic-Tac-Toe game -----------------\n
----\n
---- Use mouse to select positions of the\n
---- symbols. Close window to exit game.\n
----\n
-----------------------------------------"
-v -
message=0
counter=0
player=0
state=0
tmp3=0
tmp2=0
tmp1=0
-_x_tictactoe2
-w[-1] -1,-1,0," "
-do
-if $player message="Tic-Tac-Toe (O to play)"
-else message="Tic-Tac-Toe (X to play)"
-endif
-do
-w[] {w},{h},0,"[G"{`39`}"MIC] "$message -wait
-if {!@!" || "@{!,ESC}" || "@{!,Q}} -w[] 0 -rm -v + -return -endif
-if {@{!,b}&1" && "@{!,x}>20" && "@{!,y}>20" && "@{!,x}<400" && "@{!,y}<400}
tmp3={int((@{!,x}-15)/130)}
tmp2={int((@{!,y}-15)/130)}
tmp1={4^($tmp2*3+$tmp3)}
-if {int($state/$tmp1)%4} tmp1=-1 -endif
-else tmp1=-1 -endif
-while {$tmp1<0}
-_x_tictactoe{$player%2}
-j[-3] [-2],{"130*"$tmp3" + 15+?(-5,5)"},\
{"130*"$tmp2" + 15+?(-5,5)"},0,0,1,[-1]
-rm[-2--1]
-w[-1]
state={$state+(1+$player)*$tmp1}
(21,1344,86016,4161,16644,66576,65793,4368;\
0,0,0,0,1,2,0,0;\
0,1,2,0,0,0,0,0;\
3,3,3,4,4,4,5,6)
-repeat {w}
tmp1=@{-1,$>}
-if {($state&$tmp1)==$tmp1||($state&(2*$tmp1))==2*$tmp1}
-_x_tictactoe@{-1,($>,3)}
-j[-4] [-2],{130*@{-3,($>,1)}+?(-5,5)},\
{130*@{-3,($>,2)}+?(-5,5)},0,0,1,[-1] -rm[-2--1]
-if {($state&$tmp1)==$tmp1} -w[-2] -1,-1,0,"Tic-Tac-Toe (X won!)"
-else -w[-2] -1,-1,0,"Tic-Tac-Toe (O won!)"
-endif
-do -wait -w[] @{!,w},@{!,h} -while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm -w[] 0 -v + -return
-endif
-done
-rm[-1]
player={($player+1)%2}
counter={$counter+1}
-while {$counter<9}
-w[] -1,-1,0,0,"Tic-Tac-Toe (Tied game!)"
-do -wait -w[] @{!,w},@{!,h} -while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-w[] 0 -rm -v +
_x_tictactoe :
-spread[-1] 4 -b[-1] 6 -sharpen[-1] 0.8 -n[-1] 0,1
__x_tictactoe :
--f[-1] 1-i --n[-2] $2,255 --n[-3] $3,255 -n[-4] $1,255 -a[-4,-2,-1] c
_x_tictactoe0 :
128,128,1,1,1 -line[-1] 15%,15%,85%,85%,1,0 -line[-1] 15%,85%,85%,15%,1,0 -erode[-1] 12 -_x_tictactoe -deform[-1] 4 -__x_tictactoe 40,40,160
_x_tictactoe1 :
128,128,1,1,1 -ellipse[-1] 50%,50%,22%,22%,0,1,0 -ellipse[-1] 50%,50%,15%,15%,0,1,1 -_x_tictactoe -deform[-1] 4 -__x_tictactoe 160,40,160
_x_tictactoe2 :
391,391,1,1,"!(x%130) || !(y%130)" -r[-1] 421,421,1,1,0,0,0.5,0.5 -dilate[-1] 3 -_x_tictactoe -f[-1] 1-i
100%,100% -noise[-1] 10 -b[-1] 8,0 -sharpen[-1] 1.5 -n[-1] 220,255 -*[-2,-1] -to_rgb[-1]
_x_tictactoe3 :
421,130,1,1,1 -line[-1] 10%,60%,90%,60%,1,0 -erode[-1] 6 -_x_tictactoe -rotate[-1] {?(-6,6)},1,1,50%,50% -__x_tictactoe 180,10,10
_x_tictactoe4 :
-_x_tictactoe3 -transpose[-2--1]
_x_tictactoe5 :
421,421,1,1,1 -line[-1] 10%,10%,90%,90%,1,0 -erode[-1] 6 -_x_tictactoe -__x_tictactoe 180,10,10
_x_tictactoe6 :
421,421,1,1,1 -line[-1] 10%,90%,90%,10%,1,0 -erode[-1] 6 -_x_tictactoe -__x_tictactoe 180,10,10
x_waves :
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Image waves --------------------------\n
----\n
---- Left mouse button to drop balls.\n
---- Right mouse button to rotate view.\n
---- Keys 'CTRL+D' to double window size.\n
---- Keys 'CTRL+C' to reset window size.\n
---- Keys 'CTRL+F' to switch fullscreen mode.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
---------------------------------------------"
-v -
-if {!@#} -l[]
200,200 x={-1.06-?*0.1} y={-0.26-?*0.1}
-mandelbrot $x,$y,{$x+0.1},{$y+0.1},256
16,1,1,3,? -r[-1] 256,1,1,3,3 -shift[-1] 1
-map[0] [-1] -rm[-1] -r2dx 100
--mirror y --mirror x -+ -n 0,255
-endl -else -k[0] -r[0] 100,100,1,3,2 -endif
-i[0] (20;80;0^20;80;0^20;80;0) -r[0] 400,300,1,3,3 -water[0] 100,2
-w[0] @{0,w},@{0,h},0,"[G"{`39`}"MIC] Image waves"
w={w} -elevation3d[-1] 0 -rv3d[-1]
-sh[-1] 8,{7+3*i[6]},0,0 -r[-1] 3,{h/3},1,1,-1
(0,1,0;1,0,1;0,1,0) -/[-1] 2
-ball[] 20,200,255,128,1,0.7,3.5
0 $w,$w [-1]
-l3d {$w/2},-200,-1000 -sl3d 0.4 -ss3d 0.8 -f3d 500 time0=@|
-do
--convolve[-1] [3],1 --[-1] [-3] -rm[-3] -b[-1] 0.8 --[-1] {ia}
-r[-1] 1,{$w*$w},1,1,-1 -j[2] [-1],2,0 -r[-1] $w,$w,1,1,-1
[1]
-if @{5,h} --l[5] -rows 0,2
nb={w}
-i[0] ({'CImg3d'}) -i[1] ($nb,$nb) -transpose[2]
(1,0;1,{$nb-1}) -r[-1] 2,$nb,1,1,3 -round[-1]
1,{4*$nb},1,1,1 -y -a y
-endl [4] -sprites3d[-2,-1] -+3d[-2,-1] -endif
--3d[-1] {$w/2},{$w/2} -*3d[-1] @{0,0.9*max(w,h)/$w}
-r3d[-1] 0,0,1,{if(@{!,b}&2,-@{!,x}*360/@{!,w},@|*30)} -r3d[-1] 1,0,0,-120
--j3d[0] [-1],50%,65%,30,1,3,0,0 -w[-1]
-if {@{!,CTRLLEFT}&&@{!,D}} -w[] {2*w},{2*h} -elif {@{!,CTRLLEFT}&&@{!,C}} -w[] {w},{h}
-elif {@{!,CTRLLEFT}&&@{!,F}}
-if {!narg($is_fs)} is_fs=@{!,w},@{!,h} fw={min(@{!,u}*h/w,@{!,v}*w/h)} -w[] $fw,{$fw*h/w},0,1
-else -w[] $is_fs,0,0 is_fs=""
-endif
-endif
-rm[-2,-1] -wait 20
-if {@{!,b}&1||(@|-$time0)>1} ({?*$w};{?*$w};70;0) -a[5,-1] x time0={@|-?} -endif
-if @{5,h} -l[5,-1]
-sh[0] 2,2,0,0 -sh[0] 3,3,0,0 --[-2] [-1] -+[-1] 0.2 -rm[-2,-1]
-s[0] x -repeat {@#-1} coords=@{$<,0-1} -if {@{$<,2}<i($coords)} -=[-1] {80+@{-1,($coords)}},$coords -rm[$<] -endif -done
-if {@#==1} -i[0] 0 -else -a[0--2] x -endif
-endl
-endif
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm -w 0 -v +
x_whirl : -check ${1=0.2}>=0
-if {!@{!,u}} -error[0--3] "Command '-$0': No display available." -return -endif
-e[] "\n
------ Fractal whirls ----------------------------\n
----\n
---- Keys 'CTRL+D' to double window size.\n
---- Keys 'CTRL+C' to reset window size.\n
---- Keys 'ESC' or 'Q' to exit.\n
----\n
--------------------------------------------------"
-v -
5,5,1,3 256,256,1,3 [-1] -w[-1] 384,384,0,"[G"{`39`}"MIC] Fractal whirls"
tangle=0 tzoom=0 xc={(w-@{-3,w})/2} yc={(h-@{-3,h})/2}
-do
-rand[-3] 0,255 -j[-2] [-3],$xc,$yc,0,0
-rotate[-2] {8*sin($tangle)},0,0,{w/2+?(-2,2)},{h/2},{1.03+0.02*sin($tzoom)}
tangle={$tangle+0.001} tzoom={$tzoom+0.02}
-j[-1] [-2],0,0,0,0,$1 -w[-1]
-if {@{!,CTRLLEFT}&&@{!,D}} -w[] {3*w},{3*h} -elif {@{!,CTRLLEFT}&&@{!,C}} -w[] {1.5*w},{1.5*h} -endif
-wait 20
-while {@!" && "!@{!,ESC}" && "!@{!,Q}}
-rm[-3,-2] -w[] 0 -v +
__help_end :
gimp_filter_sources :
({'gmic'})
({'http://gmic.eu/update@..gmic'},1)
gimp_parallel_overlap :
-apply_parallel_overlap "$1",$3,{if($2,2^($2-1),0)}
gimp_preview :
-frame 1,1,0,0,0,255 -montage B
gimp_layer_name :
-u @{"-_gimp_merge_layers[0] name,[unnamed]"}
gimp_layer_mode :
-u @{"-_gimp_merge_layers[0] mode,alpha"}
gimp_layer_opacity :
-u @{"-_gimp_merge_layers[0] opacity,100"}
gimp_layer_pos :
-u @{"-_gimp_merge_layers[0] pos,0,0"}
gimp_merge_layers :
mode0=@{"-_gimp_merge_layers[-1] mode,alpha"}
opacity0=@{"-_gimp_merge_layers[-1] opacity,100"}
pos0=@{"-_gimp_merge_layers[-1] pos,0,0"}
-if {$opacity0<100" || "{$pos0'!='0,0}} 100%,100%,1,4 -endif
wh0={w},{h}
wh=@{-max_wh} -r[-1] $wh,1,100%,0
-repeat {@#-1} -l[-2,-1] -rv
mode=@{"-_gimp_merge_layers[1] mode,alpha"}
opacity=@{"-_gimp_merge_layers[1] opacity,100"}
pos=@{"-_gimp_merge_layers[1] pos,0,0"}
-to_a[1] -r[1] $wh,1,100%,0
-shift[1] @{-u\ $pos},0,0
-to_colormode[0,1] 0
-blend $mode,{max(0,min(1,$opacity/100))}
-endl -done
-r $wh0,1,100%,0
_gimp_merge_layers :
res=""
({'@{0,n}'})
-l[-1]
({'"$1("'}) l={w} str=@-1 -rm[-1]
-s +,$str
-if {@#>1}
-repeat @#
-if {$>!=@#-1" && "{@{$>,0-@{$>,min($l,h)-1}}'=='$str}}
-l[{$>+1}] -s +,{')'} -if {@#>1} res=@{0,t} -endif -a y -endl
-endif
-if {narg({'$res'})} -break -endif
-done
-endif
-rm
-endl
-if {narg({'$res'})} -u $res -else -u "${2--1}" -endif
_before :
0 -t[-1] "Before",1,-1,13,1,1 -r[-1] {w+4},{h+4},1,1,0,0,0.5,0.5
_after :
0 -t[-1] "After",1,-1,13,1,1 -r[-1] {w+4},{h+4},1,1,0,0,0.5,0.5
gimp_split_preview :
-m "gsp : w={w} h={h} s={s} $1 -if {!@#} $w,$h,1,4 -drgba -to_colormode $s -endif -k[0] -if {s>4} -channels 0,3 -endif"
-repeat @# -l[$>]
-if {$2==0} -gsp[-1] -mv[-1] 0 -continue -endif
-if {!($2%2)}
-s[-1] x,2
-if {$2==2} -gsp[-1] -to_colormode[-2,-1] 0 -_before -_after
-elif {$2==4} -gsp[-2] -to_colormode[-2,-1] 0 -_after -_before
-else -rm[-1] --gsp[-1] -to_colormode[-2,-1] 0 -_before -_after
-endif
-line[-3] 0,0,0,@{-3,h},1,0,0,0,255 -a[-4,-3] x
-else
-s[-1] y,2
-if {$2==1} -gsp[-1] -to_colormode[-2,-1] {max(@{-2,s},s)} -_before -_after
-elif {$2==3} -gsp[-2] -to_colormode[-2,-1] {max(@{-2,s},s)} -_after -_before
-else -rm[-1] --gsp[-1] -to_colormode[-2,-1] 0 -_before -_after
-endif
-line[-3] 0,0,@{-3,w},0,1,0,0,0,255 -a[-4,-3] y
-endif
--dilate[-2,-1] 5 -*[-4,-3] 255 -to_colormode[-4,-3] @{-5,s}
-j[-5] [-4],1,1,0,0,0.8,[-2] -j[-5] [-3],{@{-5,w}-w-1},{@{-5,h}-h-1},0,0,0.8,[-1]
-rm[-4--1]
-endl -done
-uncommand gsp
gimp_print_preview : -skip "${1=},${3=}" -check "${2=32}>=0 && ${4=20}>=0 && ${5=20}>=0"
-if {!@#" || "w<128" || "h<128} -rm 420,300,1,4,0 -endif
-k[0] -drgba
(1;1^1;0.5^0;0.5) (1.5,0,1.5;0,0,0;1.5,0,1.5) -r[-2,-1] [-3],3 -* -c 0,255
-l[]
0 -t[-1] "$1",0,0,$2,1,255 -r[-1] 100%,140%,1,1,0
-i[0] 100%,100%,1,3 -fc[0] 255,200,128 -a c
-onfail -rm
-endl
-l[]
({'"$3"'}) --f[-1] '>if(i>32||j(-1)<$5,j(-1)+1,0)' -==[-1] 0 -*[-1] 256 -max[-2,-1] -s -,256
-s y,-{round(1.3*$5)}
-repeat @# -l[$>] 0 -t[-1] @{0,t},0,0,$4,1,255 -rm[0] -endl -done
-a y -i[0] 100%,100%,1,3,255 -a c
-onfail -rm
-endl
-a[^0] y,0.5
-if {@#>1}
-if {w>@{0,w}} -r2dx[-1] @{0,w-8} -endif
-if {h>@{0,h}} -r2dy[-1] @{0,h-8} -endif
-r[1] [0],[0],1,4,0,0,0.5,0.5 -blend alpha
-endif
gimp_no_preview : -skip "$*"
-gimp_print_preview "",0,"No preview\n  available",32
gimp_warning_preview :
-gimp_print_preview "Preview warning:",32,"$*",22,30
gimp_error_preview :
-gimp_print_preview "Preview error:",32,"$*",15,40
gimp_autocrop_layers :
-repeat @# -l[$>]
nm=@{-gimp_layer_name}
mode=@{-gimp_layer_mode}
opacity=@{-gimp_layer_opacity}
coords=@{-autocrop_coords\ auto}
-z $coords
-nm mode($mode),opacity($opacity),pos({arg(1,$coords)},{arg(2,$coords)}),name($nm)
-endl -done
#@gimp <i>About</i>
#@gimp_en About G'MIC : _none_, gimp_logo_en
#@gimp_en : Note = note{"
#@gimp_en : <span foreground ="purple">( <b>G</b>REYC's <b>M</b>agic for <b>I</b>mage <b>C</b>omputing )</span>\n\nis proposed to you by"}
#@gimp_en : Note = link("David Tschumperl\303\251","http://tschumperle.users.greyc.fr/")
#@gimp_en : Note = link{"( IMAGE Team / GREYC Laboratory - CNRS UMR 6072 )","http://www.greyc.fr/node/36"}
#@gimp_en : Note = note{"
#@gimp_en : This plug-in is based on our open-source libraries <b>G'MIC</b> and <b>CImg</b> (C++ Template Image Processing Library),
#@gimp_en : available at:"}
#@gimp_en : Note = link("http://gmic.eu/")
#@gimp_en : Note = note{"and"}
#@gimp_en : Note = link("http://cimg.sourceforge.net/")
#@gimp_en : Note = note{"\n
#@gimp_en : If you appreciate <b>G'MIC</b>, you are welcome to send us a nice postcard from your place, at:\n\n
#@gimp_en : <small><tt>David Tschumperl&#233;,\n Laboratoire GREYC (CNRS UMR 6072), Equipe Image,\n
#@gimp_en :  6 Bd du Mar&#233;chal Juin,\n 14050 Caen Cedex / France.</tt></small>\n\n
#@gimp_en : Postcards senders automatically enter the <i>Friends Hall of Fame</i> :) !
#@gimp_en : "}
gimp_logo_version3 : -skip "${1=Plug-in for GIMP}"
-rm s="G\47MIC"
-repeat {narg({'$s'})}
0 -t[-1] {`{arg(1+$>,{'$s'})}`},0,0,53,1,1 -frame[-1] 3,0,0
-r[-1] 500%,500%,1,1,3 -b[-1] 3% ->=[-1] 50%
-distance[-1] 1 -<=[-1] 10
[-1]x3 -whirls[-4--2] ,
r$>={?(0.4,1)} g$>={?(0.2,1)} b$>={?(0.6,1)}
-*[-4] ${r$>} -*[-3] ${g$>} -*[-2] ${b$>}
-a[-4--2] c -n[-2] 0,255 -*[-1] 255 -a[-2,-1] c
-done
-a[-5--1] x
-r[-1] 100%,120%,1,4,0,0,0.5,1
-ball 64,{255*$r3},{255*$g3},{255*$b3} -j[-2] [-1],450,5 -rm[-1]
-sh[-1] 100%,100% -dilate[-1] 7 -rm[-1] -autocrop[-1]
-drop_shadow[-1] 10,10,1%,0.5
0 -t[-1] "$1",0,0,53,1,255 -frame[-1] 4,4,0 [-1]x3 -dilate[-1] 7 -a[-4--1] c
-a[-2,-1] y,0.5
-r2dy[-1] 50%
-i[-2] 120%,120%,1,3,255 -plasma[-2] 1,1 -s[-2] c
-n[-4] 150,255 -n[-3] 180,255 -n[-2] 200,255 -a[-4--2] c
-blend alpha
-frame 0,1,0,0,0 -frame 0,5,255,255,255
gimp_logo_version2 : -skip "${1=Plug-in for GIMP}"
-if @# -k[0] -endif
-to_rgb 0 -t[-1] "G\47MIC",0,0,53,1,1 -label[-1]
6,1,1,3 -rand[-1] 150,255 -point[-1] 0 -map[-2] [-1] -rm[-1]
-expand_xy[-1] 10,0 -b[-1] 2 -r[-1] 200%,200%,1,3,6 -sqr[-1] -c[-1] 0,60% -n[-1] 0,255
-warp_perspective[-1] 0.5,0,1,50,50,0 -shift[-1] 0,-10
100%,100% -noise[-1] 0.8,2 -*[-1] 180 --blur_linear[-1] 20,0,45,0 -*[-1] 20 -max[-3--1]
-sh[-1] 2,2 (0;128) -r[-1] [-2],3 -+[-2,-1] -min[-1] 255 -rm[-1]
-text_outline[-1] "$1",32%,75%,13,3,1,255 -frame[-1] 1,1,128 -mv[-1] 0
-if {@#>1} -*[^0] 0.45 -repeat {@#-1} -j[-1] [0],{(w-@{0,w})/2},{(h-@{0,h})/2} -mv[-1] 1 -done -rm[0] -endif
gimp_logo_version1 : -skip "${1=Plug-in for GIMP}"
-if @# ratio={w/h} -else ratio=1 -endif
-rm 118,44,1,1 -t "G\47MIC",3,-6,53,1,255 -r 100%,100%,10,1 -r 100%,100%,20,1,0,0,0.5,0.5,0.5 -b 1.5
-isosurface3d 50%
-col3d {?(150,255)},{?(150,255)},{?(150,255)}
-sphere3d 8 -col3d[-1] {?(150,255)},{?(150,255)},{?(150,255)} -+3d[-1] 72,-6 -+3d -c3d[-1] -rv3d
-db3d 0 -sl3d 0.2 -ss3d 1.3 -r3d[-1] 1,0,0,30 -f3d 120 -*3d[-1] 1.5
230,120,1,3 -j3d[-1] [-2],50%,30%,0,1,4 -rm[-2] -t "$1",36%,75%,13,1,255
-to_rgba -replace_color 0,0,0,0,0,255,0,0,0,0 -drop_shadow 6,6,2
-i[-2] @{-fitratio_wh\ 230,120,$ratio},1,3
-rand[-2] 0,255 -sh[-2] 0,0 -/[-1] 2 -rm[-1]
-blur_radial[-2] 20 -sharpen[-2] 300
-r[-1] [-2],[-2],1,4,0,0,0.5,0.5 -blend alpha
gimp_logo : -skip "${1=Plug-in for GIMP\n    [ "@{-strver}" ]}"
-gimp_logo_version{round(?(0.5,3.49))} "$1"
gimp_logo_en :
-if {narg($_gmic_is_beta)}
-gimp_logo_version{round(?(0.5,3.49))} "Plug-in for GIMP\n "[" "@{-strver}" beta "]
-else
-gimp_logo_version{round(?(0.5,3.49))} "Plug-in for GIMP\n    "[" "@{-strver}" "]
-endif
#@gimp_fr A propos de G'MIC : _none_, gimp_logo_fr
#@gimp_fr : Note = note{"
#@gimp_fr : <span foreground ="purple">( <b>G</b>REYC's <b>M</b>agic for <b>I</b>mage <b>C</b>omputing )</span>\n\nvous est propos&#233; par"}
#@gimp_fr : Note = link("David Tschumperl\303\251","http://tschumperle.users.greyc.fr/")
#@gimp_fr : Note = link{"( Equipe IMAGE / Laboratoire GREYC - CNRS UMR 6072 )","http://www.greyc.fr/node/36"}
#@gimp_fr : Note = note{"
#@gimp_fr : Ce greffon est bas&#233; sur nos biblioth&#232;ques libres <b>G'MIC</b> et <b>CImg</b> (C++ Template Image Processing Library),
#@gimp_fr : disponibles aux adresses :"}
#@gimp_fr : Note = link("http://gmic.eu/")
#@gimp_fr : Note = note{"et"}
#@gimp_fr : Note = link("http://cimg.sourceforge.net/")
#@gimp_fr : Note = note{"\n
#@gimp_fr : Si vous appr&#233;ciez <b>G'MIC</b>, vous pouvez nous le faire savoir en nous envoyant une jolie carte
#@gimp_fr : postale de votre ville ou r&#233;gion, &#224; l'adresse :\n\n
#@gimp_fr : <small><tt>David Tschumperl&#233;,\n Laboratoire GREYC (CNRS UMR 6072), Equipe Image,\n
#@gimp_fr :  6 Bd du Mar&#233;chal Juin,\n 14050 Caen Cedex / France.</tt></small>\n\n
#@gimp_fr : Envoyer une carte postale vous fera rentrer <i>de facto</i> dans le <i>Friends Hall of Fame</i> :) !
#@gimp_fr : "}
gimp_logo_fr :
-if {narg($_gmic_is_beta)}
-gimp_logo_version{round(?(0.5,3.49))} "Greffon pour GIMP\n  "[" "@{-strver}" beta "]
-else
-gimp_logo_version{round(?(0.5,3.49))} "Greffon pour GIMP\n    "[" "@{-strver}" "]
-endif
#@gimp Contributors : _none_, _none_
#@gimp : Note = note{"
#@gimp : We would like to thank all these people who contributed to <b>G'MIC</b> in one way or another.
#@gimp : A big hug to : \n\n
#@gimp : <b> -</b> <i>Sylvie Alexandre</i> <small>(packaging, testing &amp; filters)</small>
#@gimp : <b> -</b> <i>Partha Bagchi</i> <small>(packaging)</small>
#@gimp : <b> -</b> <i>S&#233;bastien Bougleux</i> <small>(debugging)</small>
#@gimp : <b> -</b> <i>J&#233;rome Boulanger</i> <small>(testing &amp; code)</small>
#@gimp : <b> -</b> <i>Claude Bulin</i> <small>(packaging)</small>
#@gimp : <b> -</b> <i>Aur&#233;lien Ceyden</i> <small>(packaging)</small>
#@gimp : <b> -</b> <i>Fran&#231;ois Collard</i> <small>(testing)</small>
#@gimp : <b> -</b> <i>Patrick David</i> <small>(testing &amp; filters)</small>
#@gimp : <b> -</b> <i>Maxime Daisy</i> <small>(code &amp; testing)</small>
#@gimp : <b> -</b> <i>Fr&#233;d&#233;ric Devernay</i> <small>(code)</small>
#@gimp : <b> -</b> <i>Iain Fergusson</i> <small>(filters)</small>
#@gimp : <b> -</b> <i>Roberto Ferramosca</i> <small>(packaging)</small>
#@gimp : <b> -</b> <i>J&#233;rome Ferrari</i> <small>(testing, code &amp; tutorials)</small>
#@gimp : <b> -</b> <i>Chris Fiedler</i> <small>(gfx)</small>
#@gimp : <b> -</b> <i>S&#233;bastien Fourey</i> <small>(ZArt code &amp; G'MIC online)</small>
#@gimp : <b> -</b> <i>Gentlemanbeggar</i> <small>(filters)</small>
#@gimp : <b> -</b> <i>Claes Holmerson</i> <small>(tutorials)</small>
#@gimp : <b> -</b> <i>Arto Huotari</i> <small>(filters)</small>
#@gimp : <b> -</b> <i>Dan Leinir Turthra Jensen</i> <small>(debugging)</small>
#@gimp : <b> -</b> <i>Tom Keil</i> <small>(testing, filters &amp; tutorials)</small>
#@gimp : <b> -</b> <i>Andy Kelday</i> <small>(testing &amp; filters)</small>
#@gimp : <b> -</b> <i>Angelo Lama</i> <small>(testing &amp; EKD integration)</small>
#@gimp : <b> -</b> <i>John Lakkas</i> <small>(filters)</small>
#@gimp : <b> -</b> <i>St&#233;phane de la Linuxerie</i> <small>(design)</small>
#@gimp : <b> -</b> <i>Mark</i> <small>(translation)</small>
#@gimp : <b> -</b> <i>Mahvin</i> <small>(testing &amp; design)</small>
#@gimp : <b> -</b> <i>MareroQ</i> <small>(translation)</small>
#@gimp : <b> -</b> <i>Ramon Miranda</i> <small>(translation)</small>
#@gimp : <b> -</b> <i>Mauro Quercia</i> <small>(translation)</small>
#@gimp : <b> -</b> <i>PhotoComiX</i> <small>(testing, translation &amp; filters)</small>
#@gimp : <b> -</b> <i>Garry Osgood</i> <small>(documentation &amp; filters)</small>
#@gimp : <b> -</b> <i>James Prichard</i> <small>(testing &amp; filters)</small>
#@gimp : <b> -</b> <i>Guilherme Razgriz</i> <small>(translation)</small>
#@gimp : <b> -</b> <i>Karsten Rodenacker</i> <small>(packaging &amp; code)</small>
#@gimp : <b> -</b> <i>Dani Sard&#224;</i> <small>(translation)</small>
#@gimp : <b> -</b> <i>Yuri Shemanin</i> <small>(debugging)</small>
#@gimp : <b> -</b> <i>Silvio Grosso</i> <small>(debugging)</small>
#@gimp : <b> -</b> <i>Stepanekos</i> <small>(translation)</small>
#@gimp : <b> -</b> <i>Thorsten "otto" Stettin</i> <small>(packaging)</small>
#@gimp : <b> -</b> <i>Lukas Tvrdy</i> <small>(Krita integration)</small>
#@gimp : <b> -</b> <i>Bernd Zeimetz</i> <small>(packaging)</small>
#@gimp : <b> -</b> <i>Matthias Zepper</i> <small>(testing)</small>
#@gimp : <b> -</b>"}
#@gimp Filter design : _none_, _none_
#@gimp : Note = note{"
#@gimp : <b>G'MIC</b> is an <b>open</b> image processing framework. Thus, including
#@gimp : <b>user-defined filters</b> into this plug-in is possible.\n\n
#@gimp : To do so, you need to create a <span foreground ="purple" style="italic">.gmic</span>
#@gimp : file in your <i>$HOME/</i> folder (or <i>%APPDATA%/gmic</i> on Windows, without the first dot).
#@gimp : It will be read each time the plug-in is launched, or when the <i>Refresh</i>
#@gimp : button (under the central pane) is pressed. It must be a regular ASCII file, containing the declarations and
#@gimp : implementations of the filters (written in the <b>G'MIC</b> language) that will be added
#@gimp : to the list of available ones."}
#@gimp : Note = note{"
#@gimp : Existing filters are already defined this way.
#@gimp : Writing a filter from scratch in <b>G'MIC</b> requires some skills, but
#@gimp : can be generally done in very few lines.\n\n
#@gimp : <span foreground ="purple" underline="single">Example of a valid <i>.gmic</i> entry :</span>"}
#@gimp : note = note{"<tt>#@gimp My effect : my_effect, my_effect</tt>"}
#@gimp : note = note{"<tt>#@gimp : Sigma = float(2,0,10)</tt>"}
#@gimp : Note = note{"<tt>my_effect :\n     --blur $1 -n 0,255 -xor</tt>"}
#@gimp : Note = note{"
#@gimp : Look at the reference documentation and the tutorial whose links are given below, to learn more.
#@gimp : By the way, you are encouraged to share your nice custom filters with us on our forums,
#@gimp : for inclusion into next releases of <b>G'MIC</b>.
#@gimp : "}
#@gimp : Sep = separator()
#@gimp : Note = link(0,"[1] G'MIC reference documentation","http://gmic.eu/reference.shtml")
#@gimp : Note = link(0,"[2] G'MIC scripting tutorial","http://gmic.eu/tutorial/index.shtml")
#@gimp : Note = link(0,"[3] G'MIC filter template","http://gmic.eu/template.gmic")
#@gimp Filter sources : _none_, gimp_display_filter_sources
#@gimp : Note = note{"Here is displayed the filter sources currently enabled in your plug-in.
#@gimp : For most users, there should be only one URL listed there, that links to the official <b>G'MIC</b> server."}
gimp_display_filter_sources :
-l[]
-if @{-is_windows} path=@{-path_user}/ -else path=@{-path_user}/. -endif
-gimp_filter_sources
msg= i=1 -replace 1,32
-repeat @#
-if {@{$>,0-3}'=='{'http'}} msg=$msg"\n["$i"] "@{$>,t} i={$i+1}
-else
-if $path@{$>,t} msg=$msg"\n["$i"] "@{$>,t}" (local user file)" i={$i+1} -endif
-endif
-done
-rm -endl
-gimp_print_preview "Enabled external sources:",32,$msg,15,140
#@gimp Friends hall of fame : _none_, gimp_friends
#@gimp : Note = note{"\n<span foreground="purple" underline="single">Donators :</span>"}
#@gimp : Note = note{" <b>-</b> We've already received <b>32</b> donations from <b>G'MIC</b> mega-enthusiasts so far.
#@gimp :               You could be the <b>33rd</b> donator :)"}
#@gimp : Note = note{"<b><small>Note:</small></b> Donations are mainly used to help us making <b>G'MIC</b> more visible
#@gimp :              (cover expenses for open-source events, for instance). Also, it will motivate
#@gimp :              us to design more new image filters and effects. Feel free to donate
#@gimp :              if you appreciate <b>G'MIC</b>, by clicking on:"}
#@gimp : Link = link{"Make a donation via Paypal","http://sourceforge.net/donate/index.php?group_id=234931"}
#@gimp : Link = link{"Make a donation via Flattr","http://flattr.com/thing/41097/GMIC-GREYCs-Magic-for-Image-Computing"}
#@gimp : Link = link{"Make a donation via Bitcoin","bitcoin:1N5BsWvLRGHq42KLdCEtXuGvu9pat93kHD?label=G'MIC%20Donation"}
#@gimp : Note = note("<small><b>Bitcoin address:</b> 1N5BsWvLRGHq42KLdCEtXuGvu9pat93kHD</small>")
#@gimp : Sep = separator()
#@gimp : Note = note{" <b>-</b> A big hug goes to these donators (recently received first) :"}
#@gimp : Link = link(0,"[1] Thomas Tapping","http://tomtappingphotoblog.blogspot.fr/")
#@gimp : Link = link(0,"[2] Phillip R Ziesemer","")
#@gimp : Link = link(0,"[3] Jean Francois","")
#@gimp : Link = link(0,"[4] Franz Ziereis","")
#@gimp : Link = link(0,"[5] Alessandro Renzi","")
#@gimp : Link = link(0,"[6] Tsuda Koshi","")
#@gimp : Link = link(0,"[7] Boxrec Ltd","http://www.boxrec.com")
#@gimp : Link = link(0,"[8] Wolfgang Schweizer","http://www.wolfgangschweizer.com/")
#@gimp : Link = link(0,"[9] Ramon Miranda","http://www.ramonmiranda.com/")
#@gimp : Link = link(0,"[10] Volker Bradley","")
#@gimp : Link = link(0,"[11] Marco Zara","http://plus.google.com/+MarcoZara")
#@gimp : Link = link(0,"[12] Marco Tedaldi","http://plus.google.com/+MarcoTedaldi")
#@gimp : Link = link(0,"[13] Rodney Lee","http://cybertographer.com")
#@gimp : Link = link(0,"[14] Konstantinos Blatzonis","")
#@gimp : Link = link(0,"[15] Simon Chanson","")
#@gimp : Link = link(0,"[16] Herbert Malle","")
#@gimp : Link = link(0,"[17] Matthias Zepper","http://www.matthias-zepper.de/")
#@gimp : Link = link(0,"[18] Christian Mariucci","")
#@gimp : Link = link(0,"[19] M. R.","")
#@gimp : Link = link(0,"[20] Mark Link","")
#@gimp : Link = link(0,"[21] Rolf Steinort","http://blog.meetthegimp.org/")
#@gimp : Link = link(0,"[22] Pat David","http://blog.patdavid.net/")
#@gimp : Link = link(0,"[23] Daniel Tauro","https://plus.google.com/112357088505488756823/posts")
#@gimp : Link = link(0,"[24] Ben Langhinrichs","http://geniisoft.com/")
#@gimp : Link = link(0,"[25] Paolo Pedaletti","http://www.openlabs.it/")
#@gimp : Link = link(0,"[26] Ricardo Corin","http://blog.photomontager.com")
#@gimp : Link = link(0,"[27] James Prichard","https://plus.google.com/115953666279509959258")
#@gimp : Link = link(0,"[28] Matt Jones","https://plus.google.com/116658221461047313647")
#@gimp : Link = link(0,"[29] Eddy Vervest","http://www.flickr.com/people/twekkel/")
#@gimp : Link = link(0,"[30] Steven Shupe","http://www.flickr.com/photos/ssshupe/")
#@gimp : Link = link(0,"[31] Flavio Casadei Della Chiesa","http://www.flaviocdc.net/wiki/")
#@gimp : Link = link(0,"[32] Lyle Kroll","http://www.artwanted.com/artist.cfm?artid=10918")
#@gimp : Sep = separator()
#@gimp : Note = note{"\n<span foreground="purple" underline="single">Postcard senders :</span>"}
#@gimp : Note = note{" <b>-</b> We've received <b>25</b> postcards from <b>G'MIC</b> enthusiasts so far.
#@gimp :               You could be the <b>26th</b> sender :)"}
#@gimp : Note = note{" <b>-</b> A big hug goes to these postcard senders (recently received first) :"}
#@gimp : Link = link(0,"[1] ZondeR - France","http://cimg.sourceforge.net/img/postcard51.jpg")
#@gimp : Link = link(0,"[2] Bill C. - USA","http://cimg.sourceforge.net/img/postcard50.jpg")
#@gimp : Link = link(0,"[3] Michael T. - France","http://cimg.sourceforge.net/img/postcard49.jpg")
#@gimp : Link = link(0,"[4] Patrick Wauters - Lisboa","http://cimg.sourceforge.net/img/postcard48.jpg")
#@gimp : Link = link(0,"[5] Akky [Gimpchat] - Australia","http://cimg.sourceforge.net/img/postcard47.jpg")
#@gimp : Link = link(0,"[6] Michel Thomas - Germany","http://cimg.sourceforge.net/img/postcard45.jpg")
#@gimp : Link = link(0,"[7] Pierre-Yves - Ile de Batz/France","http://cimg.sourceforge.net/img/postcard44.jpg")
#@gimp : Link = link(0,"[8] Family Hamacher - Trier/Germany","http://cimg.sourceforge.net/img/postcard43.jpg")
#@gimp : Link = link(0,"[9] Benoit Gauzere and Francois Lozes - Hokusai/Japan","http://cimg.sourceforge.net/img/postcard41.jpg")
#@gimp : Link = link(0,"[10] Dr. Rainer Teubner - Seligenstadt/Germany","http://cimg.sourceforge.net/img/postcard40.jpg")
#@gimp : Link = link(0,"[11] Mauro Mitrino - Mantova/Italy","http://cimg.sourceforge.net/img/postcard39.jpg")
#@gimp : Link = link(0,"[12] Werner Meier - Mettlach/Germany","http://cimg.sourceforge.net/img/postcard37.jpg")
#@gimp : Link = link(0,"[13] Arto Huotari - Helsinki/Finland","http://cimg.sourceforge.net/img/postcard36.jpg")
#@gimp : Link = link(0,"[14] Benoit Gauzere - California/USA","http://cimg.sourceforge.net/img/postcard33.jpg")
#@gimp : Link = link(0,"[15] Arkadi Gelfond - Foster City - California/USA","http://cimg.sourceforge.net/img/postcard30.jpg")
#@gimp : Link = link(0,"[16] Corinne Masimann - Neuchatel/Switzerland","http://cimg.sourceforge.net/img/postcard29.jpg")
#@gimp : Link = link(0,"[17] Mahvin - Portland/USA","http://cimg.sourceforge.net/img/postcard27.jpg")
#@gimp : Link = link(0,"[18] Vincent Roullier - Caen/France","http://cimg.sourceforge.net/img/postcard26.jpg")
#@gimp : Link = link(0,"[19] M???? - Munich/Germany","http://cimg.sourceforge.net/img/postcard24.jpg")
#@gimp : Link = link(0,"[20] F. Albior - Jaca/Spain","http://cimg.sourceforge.net/img/postcard23.jpg")
#@gimp : Link = link(0,"[21] PhotoComIX - Frascati/Italy","http://cimg.sourceforge.net/img/postcard22.jpg")
#@gimp : Link = link(0,"[22] Guy Poizat - Cabestany/France","http://cimg.sourceforge.net/img/postcard21.jpg")
#@gimp : Link = link(0,"[23] Institut for Biomathematik und Biometrie - Neuherberg/Germany","http://cimg.sourceforge.net/img/postcard20.jpg")
#@gimp : Link = link(0,"[24] Jaime - Barcelona/Spain","http://cimg.sourceforge.net/img/postcard14.jpg")
#@gimp : Link = link(0,"[25] Jean-Michel Webbe - Guadeloupe/France","http://cimg.sourceforge.net/img/postcard15.jpg")
#@gimp : Sep = separator()
#@gimp : Note = note{"\nMay the force be with you!"}
gimp_friends :
-if @# ratio={w/h} -else ratio=1 -endif
-rm -_heart80x73 -scale3x -r 150%,150%,1,1,0,0,0.5,0.5
--*[-1] 70 --*[-2] 110 --*[-3] 255 -*[-4] 255 -a c
-blur_radial 4 -sharpen 300
-i[-2] @{-fitratio_wh\ {w},{h},$ratio},1,3
-rand[-2] 0,255 -sh[-2] 1,2 -/[-1] 2 -rm[-1]
-blur_radial[-2] 20 -sharpen[-2] 50
-r[-1] [-2],[-2],1,4,0,0,0.5,0.5 -blend alpha
113,67,1,1,0 -t[-1] "Greetings to\n  all G\47MIC\n  friends!",2,-2,23,1,1
--dilate[-1] 3 -*[-2] 255 -to_rgb[-2] -j[-3] [-2],{(@{-3,w}-@{-2,w})/2},{(@{-3,h}-@{-2,h})/2.2},0,0,1,[-1]
-rm[-2,-1]
_heart80x73 :
40,73,1,1,0 -ellipse 22,22,20,20,0,1,1 -polygon 3,7,37,42,72,42,27,1,1 --mirror x -a x
#@gimp_ca G'MIC per al GIMP : _none_, gimp_logo_ca
#@gimp_ca : Note = note{"
#@gimp_ca : <span foreground ="purple">( <b>G</b>REYC's <b>M</b>agic for <b>I</b>mage <b>C</b>omputing )</span>\n\n &#233;s una gentilesa de"}
#@gimp_ca : Note = link("David Tschumperl\303\251","http://tschumperle.users.greyc.fr/")
#@gimp_ca : Note = link{"( IMAGE Team / GREYC Laboratory - CNRS UMR 6072 )","http://www.greyc.fr/node/36"}
#@gimp_ca : Note = note{"
#@gimp_ca : Aquest connector est&#224; basat en les biblioteques de codi obert <b>G'MIC</b> i <b>CImg</b> (C++ Template Image Processing Library),
#@gimp_ca : disponibles a :"}
#@gimp_ca : Note = link("http://gmic.eu/")
#@gimp_ca : Note = note{"i"}
#@gimp_ca : Note = link("http://cimg.sourceforge.net/")
#@gimp_ca : Note = note{"\n
#@gimp_ca : Si t'agrada el <b>G'MIC</b>, pots enviar-nos una postal del lloc on vius, a :\n\n
#@gimp_ca : <small><tt>David Tschumperl&#233;,\n Laboratoire GREYC (CNRS UMR 6072), Equipe Image,\n
#@gimp_ca :  6 Bd du Mar&#233;chal Juin,\n 14050 Caen Cedex / France.</tt></small>\n\n
#@gimp_ca : Tot aquell que envi&#239; una postal apareixer&#224; al <i>Friends Hall of Fame</i> :) !
#@gimp_ca : "}
gimp_logo_ca :
-if {narg($_gmic_is_beta)}
-gimp_logo_version{round(?(0.5,3.49))} "  per al GIMP\n  "[" "@{-strver}" beta "]
-else
-gimp_logo_version{round(?(0.5,3.49))} "  per al GIMP\n    "[" "@{-strver}" "]
-endif
#@gimp Gmicky - Roddy : gimp_gmicky, gimp_gmicky_preview
#@gimp : Mascot image = choice("Gmicky","Gmicky & Wilber","Roddy")
#@gimp : Sep = separator()
#@gimp : Note = note{"<b><i>Gmicky</i></b> is the name of the <b>G'MIC</b> mascot. He is a small and cute tiger who knows how to do magic.
#@gimp : <b><i>Gmicky</i></b> is a tiger, i.e. fast, agile and elegant, just as the <b>G'MIC</b> code is :).
#@gimp : As many magicians, <b><i>Gmicky</i></b> knows lot of <b>gimmicks</b>, and he is a direct and friendly competitor of
#@gimp : the ImageMagick's wizard, or the GraphicMagick's frog."}
#@gimp : Note = note{"<b><i>Roddy</i></b> is another mascot designed specifically for the <i>Artistic / Rodilius</i> filter of <b>G'MIC</b>."}
#@gimp : Note = note{"<b><i>Gmicky</i></b> and <b><i>Roddy</i></b> have been both created and drawn by "}
#@gimp : Link = link("Mahvelous Mahvin","http://www.mahvin.com/")
gimp_gmicky :
-rm
-if {$1==0} -gmicky -nm name(Gmicky)
-elif {$1==1} -gmicky_wilber -nm "name(Gmicky & Wilber)"
-else -roddy -nm name(Roddy)
-endif
gimp_gmicky_preview :
w={w} h={h} -rm
-if {$1==0}
filename=@{-path_tmp}/gmicky_small.cimgz
url=http://gmic.eu/img/gmicky_small.cimgz
-elif {$1==1}
filename=@{-path_tmp}/gmicky_wilber_small.cimgz
url=http://gmic.eu/img/gmicky_wilber_small.cimgz
-else
filename=@{-path_tmp}/roddy_small.cimgz
url=http://gmic.eu/img/roddy_small.cimgz
-endif
-if $filename $filename -else -i $url -o $filename -endif
-r2dy $h
#@gimp Links : _none_, _none_
#@gimp : Note = note{"
#@gimp : Here is a list of links that might help you in finding additional information about the <b>G'MIC</b> open-source project.
#@gimp : "}
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Documentation:</b></small>")
#@gimp : Note = link{0,"Official G'MIC wiki.","https://sourceforge.net/p/gmic/wiki/Home/"}
#@gimp : Note = link{0,"Screenshots of some of the plug-in filters.","http://gmic.eu/gimp.shtml"}
#@gimp : Note = link{0,"List of available plug-in filters.","http://gmic.eu/gimp_filters.txt"}
#@gimp : Note = link{0,"Tutorial for learning the G'MIC language.","http://gmic.eu/tutorial/index.shtml"}
#@gimp : Note = link{0,"Reference documentation of the G'MIC language (html).","http://gmic.eu/reference.shtml"}
#@gimp : Note = link{0,"Reference documentation of the G'MIC language (pdf).","http://gmic.eu/gmic_reference.pdf"}
#@gimp : Note = link{0,"Tutorial videos","http://www.youtube.com/channel/UC05Y8hpbFOSQ4ivh01R_1AQ"}
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>News / Communities:</b></small>")
#@gimp : Note = link{0,"G'MIC news on Google+.","https://plus.google.com/117441237982283011318/posts"}
#@gimp : Note = link{0,"G'MIC community on Google+.","https://plus.google.com/u/0/b/117441237982283011318/communities/100367598461382347439"}
#@gimp : Note = link{0,"G'MIC community on GimpChat.","http://www.gimpchat.com/viewforum.php?f=28"}
#@gimp : Note = link{0,"G'MIC community on Flickr.","http://www.flickr.com/groups/gmic/discuss/"}
#@gimp Release notes : _none_, _none_
#@gimp : Note = note{"
#@gimp : - <b>01/13/2009</b> : version <i>1.3</i> (initial plug-in release).\n
#@gimp : - <b>09/03/2010</b> : version <i>1.4</i>.\n
#@gimp : - <b>07/07/2011</b> : version <i>1.5.0.0</i>.\n
#@gimp : - <b>03/01/2012</b> : version <i>1.5.1.0</i>.\n
#@gimp : - <b>10/15/2012</b> : version <i>1.5.2.0</i>.\n
#@gimp : - <b>01/07/2013</b> : version <i>1.5.3.0</i>.\n
#@gimp : - <b>01/28/2013</b> : version <i>1.5.4.0</i>.\n
#@gimp : - <b>03/08/2013</b> : version <i>1.5.5.0</i>.\n
#@gimp : - <b>06/03/2013</b> : version <i>1.5.6.0</i>.\n
#@gimp : - <b>09/09/2013</b> : version <i>1.5.7.0</i>.\n
#@gimp : - <b>12/07/2013</b> : version <i>1.5.8.0</i>.\n
#@gimp : - <b>05/14/2014</b> : version <i>1.5.9.0</i>.\n
#@gimp : - <b>08/20/2014</b> : version <i>1.6.0.0</i>.\n
#@gimp : - <span foreground ="purple"><b>03/16/2015</b> : version <i>1.6.1.0</i> (Current stable).</span>\n
#@gimp : "}
#@gimp : Sep = separator()
#@gimp : Link = link("View latest changelog","https://www.flickr.com/groups/gmic/discuss/72157649713920459/")
#@gimp User satisfaction survey : gimp_survey, gimp_survey_preview
#@gimp : Note = note{"<small>Please help us by taking a few seconds to share your feelings about the G'MIC project. Thank you for giving us the opportunity to serve you better!</small>"}
#@gimp : Note = note{"<small><b>Note:</b> This is an anonymous survey, we won't collect any data other than the answers you enter here.</small>"}
#@gimp : Sep = separator(), note = note{"<small><b>Who am I?</b></small>"}
#@gimp : Your answer: = _choice{"Choose...","A photographer","A painter","An illustrator","A graphic designer","A lover of image filters","An image processing expert","An open-source enthusiast","A scientist","Someone else"}
#@gimp : I do graphics/image processing for a living = _bool(0)
#@gimp : Sep = separator(), note = note{"<small><b>How did I hear about G'MIC?</b></small>"}
#@gimp : You answer: = _choice{"Choose...","A friend showed me","From a search engine","From a discussion forum","From a blog entry","From an online magazine","From a physical magazine"}
#@gimp : Sep = separator(), note = note{"<small><b>How often am I using G'MIC?</b></small>"}
#@gimp : Your answer: = _choice{"Choose...","Several times a day","Almost everyday","Few times a week","Rarely","Never","I've just discovered G'MIC today"}
#@gimp : Sep = separator(), note = note{"<small><b>My preferred G'MIC interface:</b></small>"}
#@gimp : Your answer: = _choice{"Choose...","the CLI tool 'gmic'","the plug-in for GIMP","the plug-in for Krita","the web interface G'MICol","ZArt","I don't know about other interfaces"}
#@gimp : Sep = separator(), note = note{"<small><b>I follow the news about the G'MIC project on:</b>\n(Selecting several items is allowed)</small>"}
#@gimp : The G'MIC website = _bool()
#@gimp : The google+ page = _bool()
#@gimp : The GIMPchat forum = _bool()
#@gimp : The flickr G'MIC user group = _bool()
#@gimp : The mailing list = _bool()
#@gimp : I don't follow G'MIC news = _bool()
#@gimp : Sep = separator(), note = note{"<small><b>How do I rate the frequency of G'MIC releases:</b></small>"}
#@gimp : Answer: = _choice{"Choose...","Too fast","Just fine","Too slow"}
#@gimp : A rolling release would be nice for G'MIC = _bool()
#@gimp : Sep = separator(), note = note{"<small><b>How I judge the number of available filters:</b></small>"}
#@gimp : Answer: = _choice{"Choose...","Too many filters. A pertinent subset should be kept","Fine. The more is the best","Just fine","Not enough useful filters","Not enough. I want more!"}
#@gimp : I use the "faves" feature of the plug-in = bool()
#@gimp : Sep = separator(), note = note{"<small><b>How do I judge the amount and quality of available documentation:</b></small>"}
#@gimp : Answer: = _choice{"Choose...","Documentation in too many different places. Hard to find information","Enough but too much technical documentation","Enough but not technical enough documentation","Just fine","I miss technical documentation","I miss non-technical documentation"}
#@gimp : It's hard to get support and/or feedback from the developers = _bool()
#@gimp : Sep = separator(), note = note{"<small><b>My favorite G'MIC filter or feature:</b></small>"}
#@gimp : Answer: = _text("")
#@gimp : Sep = separator(), note = note{"<small><b>What is missing in G'MIC?</b></small>"}
#@gimp : Answer: = _text(1,"")
#@gimp : Sep = separator(), note = note{"<small><b>Last words for the developers?</b></small>"}
#@gimp : Answer: = _text("")
#@gimp : Sep = separator(), Submit answers = button(0.5)
#@gimp : Sep = separator(), note = note{"<small><b>Note:</b> You can now access the results of this survey, by clicking the <i>OK</i> button of the plug-in dialog.</small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>03/11/2015</i>.</small>")
gimp_survey : -skip $"*"
-rm -i http://gmic.eu/gmic_survey.png
gimp_survey_preview :
-if $-1
lockname=@{-path_tmp}/.gmic_survey.lock
-if $lockname -gimp_print_preview "Your answers have been sent.",20,"Thank you!",16
-else
-str2hex $"*"
-l
-m "http://gmic.eu/gmic_survey.cgi?"@{}
-gmic_survey_check
1 -o[-1] raw:$lockname,char -rm[-1]
-gimp_print_preview "Your answers have been sent.",20,"Thank you!",16
-onfail
-gimp_print_preview "Sending error:",32,"Sorry, but something went wrong! Your answers have not been sent. Maybe a problem with the Internet connection?",15,40
-endl
-endif
-endif
survey :
-e[^-1] "Generate image of the survey results."
-v - -l[]
-i raw:http://gmic.eu/gmic_survey.raw,uchar -s -,10
-repeat {@#-1} -l[{$<-1},$<] -if {ia==@{-2,a}" && "im==@{-2,m}" && "iM==@{-2,M}} -rm[-1] -endif -endl -done
-m "__survey : -_survey $""1"
N=0 -repeat @# -l[$<]
({'@{-hex2str\ @{-1,t}}'})
-v + -e[] "Answer "{1+$>}": "@{-1,t} -v -
-replace[-1] {'" "'},{'~'} -z[-1] 0,32
-if {@{-1,100%}=={'0'}" || "@{-1,100%}=={'1'}}
-__survey @{-1,t} N={$N+1}
-endif
-rm
-endl -done
-uncommand ___survey
_back={?(240,255)},{?(240,255)},{?(240,255)}
-_survey_choice[] 0,"1. Who am I?","N.C.","A photographer","A painter","An illustrator","A graphic designer","A lover of image filters","An image processing expert","An open-source enthusiast","A scientist","Someone else",420
-_survey_bool[] 1,"I do graphics/image processing for a living."
-r[-2,-1] @{-max_w[-2,-1]},100%,1,3,0,1 -a[-2,-1] y
-_survey_choice[] 2,"2. How did I hear about G'MIC?","N.C.","A friend showed me","From a search engine","From a discussion forum","From a blog entry","From an online magazine","From a physical magazine",420
-_survey_choice[] 3,"3. How often am I using G'MIC?","N.C.","Several times a day","Almost everyday","Few times a week","Rarely","Never","I've just discovered G'MIC today",420
-_survey_choice[] 4,"4. My preferred G'MIC interface:","N.C.","the CLI tool 'gmic'","the plug-in for GIMP","the plug-in for Krita","the web interface G'MICol","ZArt","I don't know about other interfaces",420
0 -t[-1] "5. I follow the news about the G'MIC project on:",0,0,32,1,127,0,0,255 -frame[-1] 8,16,0,0,0,0
-i[-2] 100%,100%,1,3 -fc[-2] $_back -blend[-2,-1] alpha
-_survey_bool[] 5,"The G'MIC website.",256
-_survey_bool[] 6,"The Google+ page.",256
-_survey_bool[] 7,"The GimpChat forum.",256
-_survey_bool[] 8,"The Flickr user group.",256
-_survey_bool[] 9,"The mailing list.",256
-_survey_bool[] 10,"I don't follow G'MIC news.",256
-r[-7--1] @{-max_w[-7--1]},100%,1,3,0,1 -a[-7--1] y
-_survey_choice[] 11,"6. How do I rate the frequency\n    of G'MIC releases?","N.C.","Too fast","Just fine","Too slow",500
-_survey_bool[] 12,"A rolling release would be nice for G'MIC."
-r[-2,-1] @{-max_w[-2,-1]},100%,1,3,0,1 -a[-2,-1] y
-_survey_choice[] 13,"7. How do I judge the number of\n   available filters?","N.C.","Too many filters.\n   A pertinent subset should be kept","Fine. The more is the best","Just fine","Not enough useful filters","Not enough. I want more!",500
-_survey_bool[] 14,"I use the \"Faves\" feature of the plug-in"
-r[-2,-1] @{-max_w[-2,-1]},100%,1,3,0,1 -a[-2,-1] y
-_survey_choice[] 15,"8. How do I judge the amount and\n   quality of available documentation?","N.C.","Documentation in too many different places.","Enough but too much technical documentation","Enough but not technical enough documentation","Just fine","I miss technical documentation","I miss non-technical documentation",500
-_survey_bool[] 16,"It's hard to get support and/or feedback from the developers"
-r[-2,-1] @{-max_w[-2,-1]},100%,1,3,0,1 -a[-2,-1] y
-r[0-3] @{-max_w[0-3]},100%,1,3,0,1
-r[4-7] @{-max_w[4-7]},100%,1,3,0,1
-frame 1,1,0 -drop_shadow 5,5,4
-a[4-7] y -a[0-3] y -a x,1
-i[-2] 100%,100%,1,3,255 -blend[-2,-1] alpha
-i http://gmic.eu/img/logo4.jpg -r2dy[-1] 160 -j[-2] [-1],60,8 -rm[-1]
-t[-1] "Results of the survey",200,170,32,1,0
-t[-1] "("$N" participants)",540,200,16,1,0,128,0
-r2dx 1280 -round
out=@{-path_tmp}/gmic_survey.png -o $out
GMIC_LOGIN=@{-gmic_ftp\ 0}
GMIC_PASSWD=@{-gmic_ftp\ 1}
-x "lftp ftp://"$GMIC_LOGIN":"$GMIC_PASSWD"@ftp.gmic.eu -e \"put -O /www/gmic/ \\\""$out"\\\"; quit\" >/dev/null"
-endl -v +
_survey :
$=arg
-repeat $#
-if {narg(${_answers$>})} _answers$>=${_answers$>},${arg{1+$>}}
-else _answers$>=${arg{1+$>}}
-endif
-done
_survey_bool : -skip ${3=0}
(${_answers$1}) -histogram[-1] 2,0,1 -normalize_sum[-1] val0={round(i[0]*100)} val1={100-$val0} -rm[-1]
0 -t[-1] "$2",0,0,20,1,0,0,0,255
RGB1={?(60,90)},{?(60,90)},{?(60,90)} ($RGB1) -*[-1] 2 -c[-1] 0,255 RGB2=@-1 -rm[-1]
128,1,1,3 -fc[-1] $RGB1 -line[-1] 0,0,$val1%,0,1,$RGB2
0 -t[-1] $val1%,0,0,16,1,1
-r[-2] 100%,{h+8},1,3 -r[-1] [-2],[-2],1,1,0,0,0.5,0.5
--fc[-2] 255,255,255 -j[-3] [-1],0,0,0,0,1,[-2] -rm[-2,-1]
-frame[-1] 1,1,0,0,0,255 -drop_shadow[-1] 3,3,2
-if $3 -r[0] {max($3,w)},100%,1,4,0,1 -endif
-frame 8,2,0,0,0,0 -a x,0.5
-i[-2] 100%,100%,1,3 -fc[-2] $_back -blend alpha
_survey_choice :
$=arg
(${_answers$1}) -histogram[-1] {$#-3},0,{$#-4} -normalize_sum[-1]
--l[-1]
i=1 -repeat {w} -if {i[$>]}
RGB$>={?(150)},{?(150)},{?(150)}
val={round(i[$>]*100)}
0 -t[-1] $i." "${arg{3+$>}}"   ",0,0,20,1,${RGB$>},255
0 -t[-1] [$val%],0,0,20,1,${RGB$>},255
-r[-2,-1] 100%,@{-max_h[-2,-1]},1,4,0,0,0,0.5
-mv[-2,-1] -3
i={$i+1}
-endif -done
-rm[-1]
-r[0--1:2] @{-max_w[0--1:2]},100%,1,4,0,1
-r[1--1:2] @{-max_w[1--1:2]},100%,1,4,0,1
-append_tiles 2
-if $-1 -r {max($-1,w)},100%,1,4,0 -endif
-endl
-l[-2]
parg1=50,255,255,254
parg2=50,255,255,0
i=1 -repeat {w} -if {i[$>]}
val={round(i[$>]*100)}
parg1=$parg1,$i,{i[$>]},${RGB$>}
-if {$val>10} parg2=$parg2,"\n\n"$val%,{i[$>]},0,0,0
-else parg2=$parg2," ",{i[$>]},0,0,0 -endif
i={$i+1}
-endif -done
512,512,1,3,255 -piechart[-1] $parg1
512,512,1,3 -piechart[-1] $parg2
-max[-2,-1]
-to_rgba[-1] -replace_color[-1] 0,0,255,255,255,255,255,255,255,0
-drop_shadow[-1] 10,10,2
-r2dy[-1] 180
-rm[0]
-endl
-to_rgba[-1] -i[-2] 0 -t[-2] "$2",0,0,32,1,128,0,0,255
-r[-2] 100%,@{-2,h+16},1,4,0
-a[-2,-1] y
-frame 16,8,0,0,0,0
-rv -a x,0.5
-i[0] 100%,100%,1,3 -fc[0] $_back -blend alpha
#@gimp _
#@gimp <b>Arrays &amp; tiles</b>
#@gimp Array [faded] : gimp_array_fade, gimp_array_fade_preview(1)
#@gimp : X-tiles = int(2,1,10)
#@gimp : Y-tiles = int(2,1,10)
#@gimp : X-offset (%) = float(0,0,100)
#@gimp : Y-offset (%) = float(0,0,100)
#@gimp : Fade start (%) = float(80,1,100)
#@gimp : Fade end (%) = float(90,1,100)
#@gimp : Mirror = choice("None","x-axis","y-axis","xy-axes")
#@gimp : Size = _choice("Shrink", "Expand", "Repeat [Memory consuming!]")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_array_fade :
-if {$7&1} -mirror x -endif -if {$7>1} -mirror y -endif
-array_fade $1,$2,$5,$6,$8
-shift -$3%,-$4%,0,0,2
gimp_array_fade_preview :
-gimp_array_fade $1,$2,$3,$4,$5,$6,$7,0
#@gimp Array [mirrored] : gimp_array_mirror, gimp_array_mirror_preview(1)
#@gimp : Iterations = int(1,1,10)
#@gimp : X-offset (%) = float(0,0,100)
#@gimp : Y-offset (%) = float(0,0,100)
#@gimp : Array mode = choice(2,"x-axis","y-axis","xy-axes","2xy-axes")
#@gimp : Initialization = choice("Original","Mirror X","Mirror Y","Rotate 90 deg.","Rotate 180 deg.","Rotate 270 deg.")
#@gimp : Expand size = _bool(false)
#@gimp : Crop (%) = int(0,0,100)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_array_mirror : -skip ${7=0}
-if {$5==1} -mirror x
-elif {$5==2} -mirror y
-elif {$5==3} -rotate 90
-elif {$5==4} -rotate 180
-elif {$5==5} -rotate 270
-endif
-if $7
-if {$4==0} -columns 0,{100-$7}%
-elif {$4==1} -rows 0,{100-$7}%
-elif {$4==2} -z 0,0,{100-$7}%,{100-$7}%
-elif {$4==3} -z {$7/2}%,{$7/2}%,{100-$7/2}%,{100-$7/2}%
-endif
-endif
-shift -$2%,-$3%,0,0,2
-array_mirror $1,$4,$6
gimp_array_mirror_preview :
-gimp_array_mirror $1,$2,$3,$4,$5,0,$7
#@gimp Array [random] : array_random, array_random(1)
#@gimp : Source x-tiles = int(5,1,20)
#@gimp : Source y-tiles = int(5,1,20)
#@gimp : Destination x-tiles = int(7,1,20)
#@gimp : Destination y-tiles = int(7,1,20)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp Array [random colors] : gimp_array_color, gimp_array_color(1)
#@gimp : X-tiles = int(5,1,20)
#@gimp : Y-tiles = int(5,1,20)
#@gimp : Opacity = float(0.5,0,1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_array_color :
-repeat @# -l[-1]
$1,$2,1,3 -rand[-1] 0,255 -to_colormode[-1] @{-2,s} -r[-1] [-2] -*[-1] $3 -*[-2] {1-$3} -+[-2,-1]
-endl -mv[-1] 0 -done
#@gimp Array [regular] : gimp_array, gimp_array_preview(1)
#@gimp : X-tiles = int(2,1,10)
#@gimp : Y-tiles = int(2,1,10)
#@gimp : X-offset (%) = float(0,0,100)
#@gimp : Y-offset (%) = float(0,0,100)
#@gimp : Mirror = choice("None","x-axis","y-axis","xy-axes")
#@gimp : Size = _choice("Shrink", "Expand", "Repeat [Memory consuming!]")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_array :
-shift -$3%,-$4%,0,0,2
-if {$5&1} -mirror x -endif -if {$5>1} -mirror y -endif
-array $1,$2,$6
gimp_array_preview :
-gimp_array $1,$2,$3,$4,$5,0
#@gimp Ascii art : gimp_asciiart, gimp_asciiart_preview(0)
#@gimp : Charset = choice(5,"Custom","Binary digits","Digits","Lowercase letters","Uppercase letters","Ascii","Card suits","Math symbols")
#@gimp : Custom dictionnary = text{" .oO0"}
#@gimp : Analysis scale = int(16,8,103)
#@gimp : Analysis smoothness = float(15,0,100)
#@gimp : Synthesis scale = int(16,8,103)
#@gimp : Result type = choice(2,"White on black","Black on white","Colored on black","Colored on transparent")
#@gimp : Sep = separator()
#@gimp : Gamma = float(0,-3,3)
#@gimp : Smoothness = float(0.2,0,5)
#@gimp : Colors = choice("Full colors","2 colors","3 colors","4 colors","8 colors","12 colors","16 colors",
#@gimp :                 "Grayscale","2 grays","3 grays","4 grays","8 grays","12 grays","16 grays")
#@gimp : Sep = separator()
#@gimp : Output ascii file = _bool(0)
#@gimp : Output folder = _folder()
#@gimp : Output filename = _text("gmic_asciiart.txt")
#@gimp : Sep = separator(), link = link("Click here for a detailed description of this filter.","http://www.gimpchat.com/viewtopic.php?f=28&t=10047")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>03/27/2014</i>.</small>")
gimp_asciiart :
-repeat @# -l[$>] -to_rgb
-apply_gamma {10^$7} -b $8% -n 0,255
-if {$1==0} dict="$2"
-elif {$1==1} dict=" 01"
-elif {$1==2} dict=" 0123456789"
-elif {$1==3} dict=" abcdefghijklmnopqrstuvwxyz"
-elif {$1==4} dict=" ABCDEFGHIJKLMNOPQRSTUVWXYZ"
-elif {$1==5} dict=" !\042\#$%&\047()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ\133\\\135^_\140abcdefghijklmnopqrstuvwxyz\173|\174~"
-elif {$1==6} dict=" \16\17\20\21"
-elif {$1==7} dict=" \200\201\202\203\204\205\206\207\210\211\212\213\214\215\216\217\220\221\222\223\224\225\226\227\230\231"
-endif
-if {$6==1} -negative -endif
-if $-3 --img2ascii $dict,$3,$4%,$5,"$-2"/"$-1"
-else --img2ascii $dict,$3,$4%,$5
-endif
wh=@{}
-if {$6==0} -k[-1] -n 0,255
-elif {$6==1} -k[-1] -negative -n 0,255
-elif {$6==2||$6==3}
-r[0] $wh,1,100%,1
-if {$9>=7} -luminance[0] -endif
-if {$9%7} -quantize[0] {arg($9%7,2,3,4,8,12,16)-1},1,0 -endif
-r[0] [1],[1],1,100% -*[0] [1]
-if {$6==2} -rm[1]
-else -*[1] 255 -a c
-endif
-endif
-endl -done
gimp_asciiart_preview :
-repeat @# -l[$>]
w={w} h={h}
-gimp_asciiart $1,"$2",${3--4},0,foo,foo
-r $w,$h,1,100%,0,0,0.5,0.5
-endl -done
#@gimp Chessboard : gimp_chessboard, gimp_chessboard_preview(0)
#@gimp : First size = int(64,1,512)
#@gimp : Second size = int(64,1,512)
#@gimp : First offset = int(0,0,512)
#@gimp : Second offset = int(0,0,512)
#@gimp : Angle = float(0,0,180)
#@gimp : Opacity = float(0.5,0,1)
#@gimp : First color = color(0,0,0,255)
#@gimp : Second color = color(255,255,255,255)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_chessboard :
-to_rgba -chessboard ${1-14}
gimp_chessboard_preview :
-gimp_split_preview "-gimp_chessboard $*",$-1
#@gimp Dices : gimp_dices, gimp_dices(0)
#@gimp : Resolution = float(2,1,10)
#@gimp : Size = int(24,8,64)
#@gimp : Color model = choice(1,"Black dices","White dices","Dices with colored numbers","Dices with colored sides")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>06/27/2013</i>.</small>")
gimp_dices :
-repeat 6 {2*$2},{2*$2} -_dice$> -done
-if {$3%2} -negative[-6--1] -endif
-frame_round[-6--1] 10,10,0,0,128,128,128,0
-r2dy[-6--1] $2 -a[-6--1] x
-repeat {@#-1} -l[$>,-1]
--luminance[0] -rv[1,2] -r[0,1] {100*$1/$2}%,{100*$1/$2}%,1,100%,2 -quantize[1] 6,0
-*[-2] $2 -channels[-2] 0,1 -r[-2] {$2*100}%,{$2*100}%
$2,$2,1,2,'if(c,y,x)' -r[-1] [-3],[-3],1,2,0,2 -+[-3,-1] --warp[-1] [-2],0,0 -rm[-3]
-if {$3<2} -rm[0] -mv[-1] 0
-else -r[0] [2],[2],1,100% -rv[0,-1] -blend[0,-1] multiply
-endif
-endl -done -rm[-1]
_dice0 : -ellipse[-1] 50%,50%,5.2%,5.2%,0,1,255
_dice1 : -ellipse[-1] 25%,25%,5.2%,5.2%,0,1,255 -ellipse[-1] 75%,75%,5.2%,5.2%,0,1,255
_dice2 : -_dice1 -_dice0
_dice3 : -_dice1 -ellipse[-1] 25%,75%,5.2%,5.2%,0,1,255 -ellipse[-1] 75%,25%,5.2%,5.2%,0,1,255
_dice4 : -_dice3 -_dice0
_dice5 : -_dice3 -ellipse[-1] 25%,50%,5.2%,5.2%,0,1,255 -ellipse[-1] 75%,50%,5.2%,5.2%,0,1,255
#@gimp Extract objects : gimp_extract_objects, gimp_extract_objects_preview(1)
#@gimp : X-background (%) = float(0,0,100)
#@gimp : Y-background (%) = float(0,0,100)
#@gimp : Select background point = button(0.5)
#@gimp : Sep = separator()
#@gimp : Color tolerance = int(20,0,256)
#@gimp : Opacity threshold (%) = int(50,0,100)
#@gimp : Minimal area = float(0.3,0,5)
#@gimp : Connectivity = choice("Low","High")
#@gimp : Output as = _choice(0,"Crop","Segmentation")
#@gimp : Sep = separator()
#@gimp : Preview guides = bool(1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>02/23/2015</i>.</small>")
#@gimp : Note = link("Filter explained here","http://gimpchat.com/viewtopic.php?f=28&t=7905")
gimp_extract_objects :
-if $6 min_area=$6% -else min_area=6 -endif
-repeat @# -l[$<] -to_rgba
nm=@{-gimp_layer_name}
w={w} h={h}
x={$1%*(w-1)}
y={$2%*(h-1)}
color=@{-at\ $x,$y}
-if {$8==0}
--replace_color $4,0,$color,0,0,0,0 -autocrop_components[-1] $5%,$min_area,$7,2
-repeat {w}
--z[0] @{1,i($>,0)},@{1,i($>,1)},@{1,i($>,3)},@{1,i($>,4)}
-nm[-1] pos(@{1,i($>,0)},@{1,i($>,1)}),name($nm" "[$>])
-done -rm[0,1]
-elif {$8==1}
-replace_color $4,0,$color,0,0,0,0
--autocrop_components[0] $5%,$min_area,$7,2
-autocrop_components[0] $5%,$min_area,$7,1
-repeat {w} -nm[$>] pos({i($>,0)},{i($>,1)}),name($nm" "[$>]) -done -rm[-1]
-endif
$w,$h,1,4 -fc[-1] $color -nm[-1] name($nm" [background]")
-endl -done
gimp_extract_objects_preview :
-if {$3" && "@#}
nm=@{0,n} -nm[0] "[G'MIC] Select background point" --select[0] 0
x0={i[0]*100/@{-2,w}} y0={i[1]*100/@{-2,h}} -rm[-1]
-nm[0] $nm
-else
x0=$1 y0=$2
-endif
-if $6 min_area=$6% -else min_area=5 -endif
-repeat @# -l[$>] -to_rgba
x={$x0%*(w-1)}
y={$y0%*(h-1)}
color=@{-at\ $x,$y}
--replace_color $4,0,$color,0,0,0,0
-autocrop_components[-1] $5%,$min_area,$7,2
-repeat {w}
xycoords=@{1,i($>,0)},@{1,i($>,1)},@{1,i($>,3)},@{1,i($>,4)}
-rectangle[0] $xycoords,0.3,0,0,255,255
-rectangle[0] $xycoords,1,0xFFFFFFFF,0,0,0,255
-done
-drgba[0]
-text_outline[0] {w}" objects",2,2,13,2,0.3,255,255,255,255
-k[0]
-if $9
-line 0,$y0%,100%,$y0%,0.5,0xF0F0F0F0,255 -line 0,$y0%,100%,$y0%,0.5,0x0F0F0F0F,0
-line $x0%,0,$x0%,100%,0.5,0xF0F0F0F0,255 -line $x0%,0,$x0%,100%,0.5,0x0F0F0F0F,0
-endif
-circle $x,$y,3,1,0,255,0 -circle $x,$y,3,1,0xFFFFFFFF,0
-endl -done
-u "{"$x0"}{"$y0"}{0}{$4}{$5}{$6}{$7}{$8}{$9}"
#@gimp Grid [cartesian] : gimp_imagegrid, gimp_imagegrid(0)
#@gimp : X-size = int(10,2,100)
#@gimp : Y-size = int(10,2,100)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_imagegrid :
-imagegrid $1,$2
#@gimp Grid [hexagonal] : imagegrid_hexagonal, imagegrid_hexagonal(1)
#@gimp : Resolution = int(32,1,128)
#@gimp : Outline = float(0.1,0,0.5)
#@gimp : Anti-aliasing = bool(1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/12/2015</i>.</small>")
#@gimp Hearts : samj_en_Coeurs_Hearts_002, samj_en_Coeurs_Hearts_002(1)
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Hearts</small></span>")
#@gimp : Resolution = int(16,4,128)
#@gimp : Filling % = float(100,20,100)
#@gimp : Tilt = int(0,0,360)
#@gimp : Blur = float(0,0,2)
#@gimp : Hearts = bool(1)
#@gimp : Interpolation = int(0,0,3)
#@gimp : Background color = color(255,255,255,255)
#@gimp : Grey = bool(0)
#@gimp : Colors boost = bool(0)
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Blend</small></span>")
#@gimp : Type foreground = choice(0,"Type A","Type B")
#@gimp : Mode = choice{1,"Add","Alpha","And","Average","Blue","Burn","Darken","Difference",
#@gimp : "Divide","Dodge","Edges","Exclusion","Freeze","Grain extract","Grain merge","Green","Hard light",
#@gimp : "Hard mix","Hue","Interpolation","Lighten","Lightness","Linear burn","Linear light","Luminance",
#@gimp : "Multiply","Negation","Or","Overlay","Pin light","Red","Reflect","Saturation",
#@gimp : "Shape Average","Shape Average0","Soft burn","Soft dodge","Soft light","Screen","Stamp","Subtract","Value",
#@gimp : "Vivid light","Xor"}
#@gimp : Opacity = float(1,0,1)
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/13</i>.</small>")
samj_en_Coeurs_Hearts_002 :
-samj_Coeurs_Hearts_002 $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15
#@gimp Make seamless : gimp_make_seamless, gimp_make_seamless_preview(1)
#@gimp : Equalize light = float(0,0,100)
#@gimp : Sep = separator(),
#@gimp : Preview original = bool(0)
#@gimp : Tiled preview = choice(3,"None","2x1","1x2","2x2","3x3","4x4")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note{"<small><b>Note:</b> This filter helps in converting your input pattern as a <b>seamless</b> (a.k.a periodic) texture.</small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>02/24/2015</i>.</small>")
gimp_make_seamless :
-repeat @# -l[$>]
-if $1 --b {20.5-$1/50}% --[0] [1] -fc[-1] @{-average_color[-1]} -+ -endif
-endl -done
-periodize_poisson -c 0,255
gimp_make_seamless_preview :
u={arg($3,2,1,2,3,4)} v={arg($3,1,2,2,3,4)}
-gimp_split_preview "-if {!$2} -gimp_make_seamless $* -endif -if $3 -array "$u","$v" -endif",$-1
#@gimp Ministeck : gimp_ministeck, gimp_ministeck_preview(1)
#@gimp : Number of colors = int(8,2,24)
#@gimp : Resolution (px) = int(64,16,256)
#@gimp : Piece size (px) = int(8,1,64)
#@gimp : Piece complexity = int(2,1,10)
#@gimp : Relief amplitude = float(100,0,256)
#@gimp : Relief size = float(0.3,0,1)
#@gimp : Add 1px outline = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/14/2015</i>.</small>")
gimp_ministeck :
-repeat @# -l[$>]
-if {w>h} -r2dx {min($2,w)} -else -r2dy {min($2,h)} -endif
-split_opacity -l[0]
--colormap[-1] $1 -index[-2] [-1]
[0],[0],1,1 -rand[2] 0,1 -dilate[2] $4 -+[0,2]
-r[0] $3""00%,$3""00%
--g[0] xy,1 -!=[-2,-1] 0 --f[0] 'i(x+1,y+1)-i(x,y)' -!=[-3--1] 0 -or[-3--1]
-z[0,-1] 0,0,{w-2},{h-2}
-if $7 [-1] -endif
--shift[-1] 1,1 -*[-2] -1 -+[-2,-1] -b[-1] {$6*$3/5} -n[-1] -$5,$5
-map[0] [1] -rm[1] -+[0,-1]
-if $7 -==[1] 0 -* -endif
-endl -r[-1] [0],[0],1,100% -a c
-endl -done
-c 0,255
gimp_ministeck_preview :
-repeat @# -l[$>]
w={w} h={h}
-gimp_ministeck $*
-r $w,$h,1,100%,0,0,0.5,0.5
-endl -done
#@gimp Montage : gimp_montage, gimp_montage_preview(1)
#@gimp : Montage type = choice("Auto","Custom layout","Horizontal","Vertical","Horizontal array","Vertical array")
#@gimp : Custom layout = text{"V(H(0,1),H(2,V(3,4)))"}
#@gimp : Merging mode = choice(1,"Aligned","Scaled")
#@gimp : Centering / scale = float(0.5,0,1)
#@gimp : Padding (px) = int(0,0,128)
#@gimp : Sep = separator()
#@gimp : Frame (px) = int(0,0,128)
#@gimp : Frame color = color(0,0,0,255)
#@gimp : Sep = separator()
#@gimp : Angle = float(0,0,360)
#@gimp : Angle variations = float(0,0,180)
#@gimp : Sep = separator()
#@gimp : Cycle layers = int(0,-255,255)
#@gimp : Revert layer order = bool()
#@gimp : Output as = _choice("Single layer","Multiple layers")
#@gimp : Sep = separator()
#@gimp : Note = note{"<small><b>Instructions:</b>\n
#@gimp : - Don't forget to set the <i>Input layers...</i> option on the left if you have multiple input layers for your montage.\n
#@gimp : - The <i>Custom layout</i> parameter is only active when <i>Montage type</i> is set to <i>Custom layout</i>.
#@gimp : This is basically a string containing expressions such as:\n
#@gimp : \n     . <i>H(a,b)</i> or <i>V(a,b)</i> stand respectively for an horizontal and vertical merge of two blocks <i>a</i> and <i>b</i>.
#@gimp : \n     . <i>R(a)</i>, stands for a 90-deg. rotated version of a block <i>a</i>. Use <i>RR(a)</i> and <i>RRR(a)</i> for resp. 180-deg and 270-deg. rotations.
#@gimp : \n     . <i>M(a)</i>, stands for a X-mirrored version of a block <i>a</i>. Use <i>MRR(a)</i> for a Y-mirrored version of <i>a</i>.\n\n
#@gimp : - A block <i>a</i> can be a layer indice or a nested montage expression itself.\n
#@gimp : - Layer indices start from <i>0 (top layer)</i> and are treated periodically.
#@gimp : </small>"}
#@gimp : Link = link("Click here for a tutorial","http://blog.patdavid.net/2014/05/gmic-montage.html")
#@gimp : Link = link("+ video tutorial","http://www.youtube.com/watch?v=iM42vx22gwg")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/22/2014</i>.</small>")
gimp_montage : -skip "${2=A}"
-if {!@#} -return -endif
code0=X code1="$2" code2=H code3=V code4=A code5=B
-if {$3==1&&$4<0.5} -r {max(10,$4*200)}%,{max(10,$4*200)}%,1,100%,2 -endif
-to_rgba -if $14 -rv -endif -if {$13%@#} -mv[{$13%@#}--1] 0 -endif
-if {$11||$12} -repeat @# -rotate[$>] {$11+?(-$12,$12)},1,0 -done -endif
-montage ${code$1},{if($3==0,$4,2+max(0,$4-0.5))},$15,\
"-if {$""7%2} -mirror x -endif -if {$""8%2} -mirror y -endif "\
"-rotate {90*$""6} "\
"-if {$5||$6} "\
"-r {max(1,$""4-2*($5+$6))},{max(1,$""5-2*($5+$6))},1,100%,2 "\
"-frame $6,$6,${7-10} "\
"-r {w+2*$5},{h+2*$5},1,100%,0,0,0.5,0.5 "\
"-else -r $""4,$""5,1,100%,2 -endif "
-if $15 -gimp_autocrop_layers -endif
-nm pos(0,0),name(Montage)
gimp_montage_preview : -skip "${2=A}"
-if {!@#} -return -endif
w={w} h={h}
-if {$3==1&&$4<0.5} -r {max(10,$4*200)}%,{max(10,$4*200)}%,1,100%,2 -endif
-drgba
code0=X code1="$2" code2=H code3=V code4=A code5=B
-to_rgba -if $14 -rv -endif -if {$13%@#} -mv[{$13%@#}--1] 0 -endif
-if {$11||$12} -repeat @# -rotate[$>] {$11+?(-$12,$12)},1,0 -done -endif
-montage ${code$1},{if($3==0,$4,2+max(0,$4-0.5))},0,\
"-if {$""7%2} -mirror x -endif -if {$""8%2} -mirror y -endif "\
"-rotate {90*$""6} "\
"-if {$5||$6} "\
"  -r {max(1,$""4-2*($5+$6))},{max(1,$""5-2*($5+$6))},1,100%,2 fs={min(53,max(w,h)/3)} "\
"  -frame $6,$6,${7-10} "\
"  -r {w+2*$5},{h+2*$5},1,100%,0,0,0.5,0.5 "\
"  0 -t[-1] \#$""1,0,0,$fs,1,255 -expand_xy[-1] 3,0 [-1]x3 -a[-4--2] c -dilate[-1] {3+2*$fs/20} -a[-2] [-1],c -j[0] [1],{5+$5+$6},{$5+$6},0,0,1,[2],255 -k[0] "\
"-else "\
"  -r $""4,$""5,1,100%,2 fs={min(53,max(w,h)/3)} "\
"  0 -t[-1] \#$""1,0,0,$fs,1,255 -expand_xy[-1] 3,0 [-1]x3 -a[-4--2] c -dilate[-1] {3+2*$fs/20} -a[-2] [-1],c -j[0] [1],5,0,0,0,1,[2],255 -k[0] "\
"-endif "
nw={w} nh={h}
-resize_ratio2d $w,{$h-16},2,2
-drgba
-i[0] 100%,15,1,3,240 -t[0] "Estimated size : "{round(100*$nw/$w)}%" x "{round(100*$nh/$h)}%,2,0,16 -r[0] 100%,16,1,3,0
-a y
#@gimp Puzzle : gimp_puzzle, gimp_puzzle_preview(1)
#@gimp : Note = note("<small><b>Pattern parameters:</b></small>")
#@gimp : X-tiles = int(5,2,32)
#@gimp : Y-tiles = int(5,2,32)
#@gimp : Curvature = float(0.5,0,1.5)
#@gimp : Connectors centering = float(0,0,1)
#@gimp : Connectors variability = float(0,0,2)
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Blending parameters:</b></small>")
#@gimp : Relief smoothness = float(0.3,0,3)
#@gimp : Relief contrast = float(100,0,255)
#@gimp : Outline smoothness = float(0.2,0,3)
#@gimp : Outline contrast = float(255,0,255)
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Recomposition parameters:</b></small>")
#@gimp : Scale = float(100,0,150)
#@gimp : Scale variations = float(0,0,100)
#@gimp : Angle = float(0,-180,180)
#@gimp : Angle variations = float(0,0,180)
#@gimp : Shuffle pieces = bool(0)
#@gimp : Additional outline = bool(0)
#@gimp : Output each piece on a different layer = _bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/06/2014</i>.</small>")
gimp_puzzle :
-repeat @# -l[$<]
w={w} h={h} -to_rgb
-puzzle $w,$h,$1,$2,$3,$4,$5
--b[-1] $6%,0 -g[-1] xy -+[-2,-1] -n[-1] -$7,$7 -+[0,-1]
--b[-1] $8%,0 -n[-1] 0,1 -*[-1] -1 -+[-1] 1 -n[-1] {(255-$9)/255},1 -*[0,-1] -c 0,255
-if {$10!=100||$11||$12||$13||$14||$15||$16}
---[-1] 1 -label_fg[-1] 0
--area_fg[-1] 0,0 -<[-1] 50% -or[-3] [-1] -==[-1] 0 -*[-2,-1]
-distance[-2] 0 -*[-2] -1 -watershed[-1] [-2] -rm[-2] -label[-1] 0,0
-repeat {iM+1}
--==[1] $>
coords=@{-autocrop_coords[-1]\ 0}
--z[0] $coords -z[-2] $coords -rv[-2,-1] -*[-2] [-1] -*[-1] 255 -a[-2,-1] c
x$>={arg(1,$coords)+round(w/2)} y$>={arg(2,$coords)+round(h/2)}
-done
-rm[0,1]
-if $14 -sort_list +,? -endif
-if $16
-repeat @# -l[$<]
-r2dy {max(0.1,$10+$11*?(-1,1))}% -rotate {$12+$13*?(-1,1)}
-if $15 -expand_xy 1,0 -endif
cx={round(w/2)} cy={round(h/2)}
-sh 100%,100% -if $15 -dilate[-1] 3 -endif
-i[0] $w,$h,1,4
-j[0] [-2],{${x$<}-$cx},{${y$<}-$cy},0,0,1,[-1],255 -rm[-2,-1]
-endl -done
-else
-i[0] $w,$h,1,{s}
-repeat {@#-1}
-r2dy[-1] {max(0.1,$10+$11*?(-1,1))}% -rotate[-1] {$12+$13*?(-1,1)}
-if $15 -expand_xy[-1] 1,0 -endif
cx={round(w/2)} cy={round(h/2)}
-sh[-1] 100%,100% -if $15 -dilate[-1] 3 -endif
-j[0] [-2],{${x$<}-$cx},{${y$<}-$cy},0,0,1,[-1],255 -rm[-2,-1]
-done
-endif
-else -rm[-1]
-endif
-endl -done
gimp_puzzle_preview :
-gimp_puzzle ${1-15},0
#@gimp Taquin : gimp_taquin, gimp_taquin(1)
#@gimp : X-tiles = int(7,1,20)
#@gimp : Y-tiles = int(7,1,20)
#@gimp : Remove tile = choice("None","First","Last","Random")
#@gimp : Sep = separator()
#@gimp : Relief = float(50,0,255)
#@gimp : Border thickness (%) = float(5,0,100)
#@gimp : Border outline = int(0,0,16)
#@gimp : Ouline color = color(0,0,0,255)
#@gimp : Sep = separator()
#@gimp : Random seed = int(0,0,65535)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/13/2014</i>.</small>")
gimp_taquin :
-to_a -repeat @# -l[$>] -srand $11 -taquin $1,$2,$3,$4,$5%,$6,${7-10} -endl -done
#@gimp Tileable rotation : gimp_rotate_tileable, gimp_rotate_tileable_preview(1)
#@gimp : Angle = float(45,0,360)
#@gimp : Maximum size factor = int(8,0,20)
#@gimp : Array mode = choice(0,"None","x-axis","y-axis","xy-axes","2xy-axes")
#@gimp : Sep = separator(), note = note("<small><b>Note:</b> This filter implements the tileable rotation technique described by <b>Peter Yu</b>, at:</small>")
#@gimp : Link = link("[Peter Yu] Create rotated tileable patterns","http://www.peteryu.ca/tutorials/gimp/rotate_tileable_patterns")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>05/26/2011</i>.</small>")
gimp_rotate_tileable :
-if $3 -array_mirror 1,{$3-1},1 -endif
-rotate_tileable $1,{if($3==0,$2,$2/2)}
gimp_rotate_tileable_preview :
-l -gimp_rotate_tileable $*
-onfail -gimp_warning_preview "Invalid image size" -endl
#@gimp Tiled isolation : gimp_isolate_tiles, gimp_isolate_tiles(0)
#@gimp : X-size = float(10,0,100)
#@gimp : Y-size = float(10,0,100)
#@gimp : X-border = float(5,0,100)
#@gimp : Y-border = float(5,0,100)
#@gimp : Keep tiles square = bool(1)
#@gimp : Keep borders square = bool(1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>04/13/2011</i>.</small>")
gimp_isolate_tiles :
-repeat @# -l[$>] -to_rgba
-if $5 sx={round(min(w,h)*max($1,$2)/100)} sy=$sx -else sx={round(w*$1/100)} sy={round(h*$2/100)} -endif
-if $6 bx={max($3,$4)} by=$bx -else bx=$3 by=$4 -endif
-s x,-$sx
-repeat @# -l[$>] -s y,-$sy -r 100%,{100+$by}%,1,100%,0,0,0.5,0.5 -a y -endl -done
-r {100+$bx}%,100%,1,100%,0,0,0.5,0.5 -a x
-endl -done
#@gimp Tiled normalization : gimp_normalize_tiles, gimp_normalize_tiles(1)
#@gimp : X-tiles = int(25,1,80)
#@gimp : Y-tiles = int(25,1,80)
#@gimp : Minimal value = float(0,0,255)
#@gimp : Maximal value = float(255,0,255)
#@gimp : Sep = separator(), Channel(s) = choice(7,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
_gimp_normalize_tiles :
-repeat @# -l[-1] -split_tiles $1,$2 -n $3,$4 -append_tiles $1,$2 -endl -mv[-1] 0 -done
gimp_normalize_tiles :
-ac "-_gimp_normalize_tiles ${1-4}",$-1
#@gimp Tiled parameterization : gimp_parameterize_tiles, gimp_parameterize_tiles(1)
#@gimp : X-tiles = int(10,1,30)
#@gimp : Y-tiles = int(10,1,30)
#@gimp : Fitting function = choice("Linear","Quadratic")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_parameterize_tiles :
-if $3
-quadratize_tiles $1,$2
-else
-linearize_tiles $1,$2
-endif
-c 0,255
#@gimp Tiled random shifts : gimp_shift_tiles, gimp_shift_tiles(1)
#@gimp : X-tiles = int(10,1,30)
#@gimp : Y-tiles = int(10,1,30)
#@gimp : Amplitude = float(10,0,100)
#@gimp : Opacity = float(1,0,1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_shift_tiles :
-to_rgba -shift_tiles $1,$2,$3
-if {$4<1} -repeat @# -s[-1] c -*[-1] $4 -a[-4--1] c -mv[-1] 0 -done -endif
#@gimp Tiled rotation : gimp_rotate_tiles, gimp_rotate_tiles(1)
#@gimp : X-tiles = int(5,1,80)
#@gimp : Y-tiles = int(5,1,80)
#@gimp : Angle = float(15,0,360)
#@gimp : X-shadow = float(3,-20,20)
#@gimp : Y-shadow = float(3,-20,20)
#@gimp : Smoothness = float(1.8,0,5)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_rotate_tiles :
-to_rgba -rotate_tiles $3,$1,$2 -drop_shadow $4%,$5%,$6%
#@gimp _
#@gimp <b>Artistic</b>
#@gimp Aurora : gcd_aurora, gcd_aurora(1)
#@gimp : Note = note("<i>Simple aurora effect filter</i>"), sep = separator()
#@gimp : Vertical amount = float(6,0,50)
#@gimp : Horizontal amount = float(1,0,50)
#@gimp : Blend mode = choice(0,"None","Average")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2013/02/09</i>.</small>")
gcd_aurora : -skip ${1=6},${2=1},${3=0}
-repeat @# -l[$>]
-to_rgb[0]
--deriche[0] $1%,2,y -deriche[-1] $2%,0,x
-c[-1] 0,255 -n[-1] 0,255
-if $3 -blend[0,1] average -else -keep[-1] -endif
-endl -done
#@gimp Black crayon graffiti : gimp_crayongraffiti2, gimp_crayongraffiti2_preview(0)
#@gimp : Amplitude = float(300,0,4000)
#@gimp : Density = float(50,0,100)
#@gimp : Smoothness = float(1,0,10)
#@gimp : Opacity = float(0.4,0,1)
#@gimp : Edge = float(12,0,50)
#@gimp : Fast approximation = bool(1)
#@gimp : Color smoothness =float(2,1,30)
#@gimp : Mixer style = choice(2,"Lightness","Value","Color Doping")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>12/07/2011</i>.</small>")
gimp_crayongraffiti2 :
-repeat @# -l[$>] -split_opacity -l[0]
--blur $3 -hardsketchbw[-1] $1,$2,$4,$5,$6 -to_rgb
-negative[-1] -blur_xy[-2] $7,$7 -reverse
-if {$8==0} -compose_lightness
-elif {$8==1} -compose_value
-elif {$8==2} -gimp_compose_colordoping 1,1 -endif
-endl -a c -endl -done
gimp_crayongraffiti2_preview :
-gimp_split_preview "-gimp_crayongraffiti2 ${1--2}",$-1
#@gimp Blockism : gimp_blockism, gimp_blockism_preview(1)
#@gimp : Note =note("Renders rectangles on to the image.")
#@gimp : Note =note("Parameters")
#@gimp : Relative size = float(3,0,20)
#@gimp : Ratio = float(1.6,1,10)
#@gimp : Size variance = float(0.5,0,10)
#@gimp : Relative block count = int(50,0,500)
#@gimp : Opacity = float(0.5,0,1)
#@gimp : Flip tolerance = int(64,0,255)
#@gimp : Reverse flip = bool(0)
#@gimp : Quick = bool(1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Note = link("Filter Explained here","http://www.flickr.com/photos/naggobot/8063058705/")
#@gimp : Sep = separator(), note = note("<small> Author: Arto Huotari Latest update : <i>2012/10/07</i>.</small>")
gimp_blockism:
XSize={int($1/100*@{-1,w})}
-if {$XSize==0} XSize=1 -endif
Ratio=$2
Variance={int($3*$XSize)}
Randomness=-1,1
Repeats={int($4/100*max(@{-1,w},@{-1,h}))}
Opacity=$5
FlipTol=$6
ReverseFlip=$7
LAB=1-$8
YSize={int($Ratio*$XSize)}
MaxXSize={int($XSize+$Variance)}
MaxYSize={int($MaxXSize*$Ratio)}
-to_rgb[0]
-if {$LAB}
-rgb2lab[0]
-split[0] c
-endif
-repeat @#
#Take copy of the last image in the stack for grey value checking
[-1]
-repeat $Repeats
X={int(?(-1,w))}
Y={int(?(-1,h))}
-if {$ReverseFlip==0}
-if {@{-1,($X,$Y,0,0)}>$FlipTol}
BW={int(abs($XSize+($MaxXSize-$XSize)*(?($Randomness))))}
BH={int(abs($YSize+($MaxYSize-$YSize)*(?($Randomness))))}
-endif
-if {@{-1,($X,$Y,0,0)}<=$FlipTol}
BH={int(abs($XSize+($MaxXSize-$XSize)*(?($Randomness))))}
BW={int(abs($YSize+($MaxYSize-$YSize)*(?($Randomness))))}
-endif
-endif
-if {$ReverseFlip==1}
-if {@{-1,($X,$Y,0,0)}<$FlipTol}
BW={int(abs($XSize+($MaxXSize-$XSize)*(?($Randomness))))}
BH={int(abs($YSize+($MaxYSize-$YSize)*(?($Randomness))))}
-endif
-if {@{-1,($X,$Y,0,0)}>=$FlipTol}
BH={int(abs($XSize+($MaxXSize-$XSize)*(?($Randomness))))}
BW={int(abs($YSize+($MaxYSize-$YSize)*(?($Randomness))))}
-endif
-endif
x0={int($X-$BW/2)}
y0={int($Y-$BH/2)}
x1={int($x0+$BW)}
y1={int($y0+$BH)}
-rectangle[-2] $x0,$y0,$x1,$y1,$Opacity,@{-1,($X,$Y,0,0)},@{-1,($X,$Y,0,1)},@{-1,($X,$Y,0,2)},@{-1,($X,$Y,0,3)
-done
-remove[-1]
-mv[-1] 0
-done
-if {$LAB}
-append[-3,-2,-1] c
-lab2rgb[-1]
-endif
gimp_blockism_preview :
-gimp_split_preview "-gimp_blockism $1,$2,$3,{$4*10},$5,$6,$7,$8",$-1
#@gimp Bokeh : bokeh, gimp_bokeh_preview(0)
#@gimp : Note = note("<b><small>Global parameters:</small></b>")
#@gimp : Amplitude = float(250,0,600)
#@gimp : Smoothness = float(2,0,20)
#@gimp : Density = float(0.5,0,5)
#@gimp : Sep = separator(), note = note("<b><small>Bokeh shape:</small></b>")
#@gimp : Size = int(24,1,64)
#@gimp : Outline size = float(10,0,100)
#@gimp : Outline amplitude = float(2,0,10)
#@gimp : Smoothness = float(0.7,0,5)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>04/24/2013</i>.</small>")
gimp_bokeh_preview :
-gimp_split_preview "-bokeh $*",$-1
#@gimp Cartoon : cartoon, gimp_cartoon_preview(0)
#@gimp : Smoothness = float(3,0,10)
#@gimp : Sharpening = float(200,0,400)
#@gimp : Edge threshold = float(20,1,30)
#@gimp : Edge thickness = float(0.25,0,1)
#@gimp : Color strength = float(1.5,0,3)
#@gimp : Color quantization = int(8,2,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_cartoon_preview :
-gimp_split_preview "-cartoon $*",$-1
#@gimp Chalk it up : samj_en_chalkitup, samj_en_chalkitup_preview
#@gimp : Note = note("Inspired by the tutorial proposed by Lylejk")
#@gimp : Note = link("http://justpaste.it/chalk_it_up","http://justpaste.it/chalk_it_up")
#@gimp : Sep = separator(), note = note("<small>Painting parameters</small>")
#@gimp : Abstraction = int(5,0,10)
#@gimp : Details scale = float(2.5,0,10)
#@gimp : Color = float(1.5,0,5)
#@gimp : Smoothness = float(50,0,200)
#@gimp : Sharpen shades = bool(1)
#@gimp : Sep = separator(), note = note("<small>Morpho parameters</small>")
#@gimp : Action = choice(5,"Erosion","Dilation","Opening","Closing","Original - Erosion","Dilation - Original","Original - Opening","Closing - Original")
#@gimp : Size = int(5,0,32)
#@gimp : Invert colors = bool(0)
#@gimp : Shape = int(0,0,1)
#@gimp : Channel(s) = choice(2,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), note = note("<small>Param\303\250tres filtre Spread / Spread parameters</small>")
#@gimp : X-variations = float(0.8,-5,5)
#@gimp : Y-variations = float(1.9,-5,5)
#@gimp : Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Auteurs / Authors : <i>Lylejk/samj/Ronounours</i>.      Update : <i>2015/03/03</i>.</small>")
samj_en_chalkitup :
-samj_chalkitup $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13
samj_en_chalkitup_preview :
-gimp_split_preview "-samj_en_chalkitup ${1--2}",$-1
#@gimp Circle abstraction : gimp_circle_abstraction, gimp_circle_abstraction_preview(1)
#@gimp : Number of colors = int(8,2,16)
#@gimp : Density = int(5,1,100)
#@gimp : Opacity = float(0.8,0,1)
#@gimp : Smoothness = float(0,0,4)
#@gimp : Filled circles = bool(1)
#@gimp : Fill transparent holes = bool(1)
#@gimp : Normalize colors = bool(1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>06/16/2014</i>.</small>")
gimp_circle_abstraction :
-repeat @# -l[$>]
-b $4%
--colormap $1 -index[0] [1],0,0
[0],[0],1,4,0
-repeat $1
-rprogress {$>*100/$1}
--==[0] $>
-skeleton3d[-1] 2,2,0,1,0
-if @{-1,7}
-s3d[-1] -l[-6--1]
-r[2] 3,@{2,h/3},1,1,-1
1,@{2,h/2*$2%},1,1,1 -r[-1] 1,@{2,h/2},1,1,4 -r[-1] 3,200% -*[2,-1] -y
-endl
-a[-6--1] y -col3d[-1] @{-at[1]\ $>}
[0],[0],1,4,0
-j3d[-1] [-2],0,0,0,1,{1+$5},0,0
-sh[-1] 3,3 -col3d[-3] 255 -j3d[-1] [-3],0,0,0,$3,{1+$5},0,0 -rm[-1]
-rm[-2]
-blend[2,-1] alpha
-endif
-done
-k[2]
-if $6 --channels 3 -<[-1] 1 -inpaint[0] [1],0,1 -rm[-1] -channels[-1] 0,2 -endif
-if $7 -n 0,255 -endif
-rprogress 100
-endl -done
gimp_circle_abstraction_preview :
-gimp_split_preview "-gimp_circle_abstraction $*",$-1
#@gimp Colored pencils : gimp_cpencil, gimp_cpencil_preview(0)
#@gimp : Size = float(1.3,0,5)
#@gimp : Amplitude = float(50,0,200)
#@gimp : Quantize colors = int (20,2,255)
#@gimp : Color smoothness = float(2,0,30)
#@gimp : Mixer mode = choice(2,"Color Doping","Darken","Hard Light","Grain Merge","Lightness","Multiply","Soft Light","Value")
#@gimp : Color intensity =float (1,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>12/29/2010</i>.</small>")
gimp_cpencil :
-repeat @# -l[$>] -split_opacity -l[0]
--pencilbw $1,$2 -blur_xy[-1] 0.4,0.4
-quantize[-2] $3 -normalize 0,255 -to_rgb
-blur_xy[-2] $4,$4
-if {$5==0} -gimp_compose_colordoping $6,0
-elif {$5==1} -gimp_compose_darken $6,1
-elif {$5==2} -gimp_compose_hardlight $6,0
-elif {$5==3} -gimp_compose_grainmerge $6,0
-elif {$5==4} -gimp_compose_lightness $6,1
-elif {$5==5} -gimp_compose_multiply $6,0
-elif {$5==6} -gimp_compose_softlight $6,0
-elif {$5==7} -gimp_compose_value $6,1 -endif
-endl -a c -endl -done
gimp_cpencil_preview :
-gimp_split_preview "-gimp_cpencil ${1--2}",$-1
#@gimp Color abstraction paint : gimp_ColorAbstractionPaint, gimp_ColorAbstractionPaint_Preview(0)
#@gimp : Abstraction = int(5,1,10)
#@gimp : Ellipse ratio = float(10,1,100)
#@gimp : Sep = separator(),note = note("Opacities, try 0 to see individual effect layers")
#@gimp : Ellipsionism opacity = float(1,0,1)
#@gimp : Sep = separator()
#@gimp : Use as hue = bool(0)
#@gimp : Painting opacity = float(1,-1,1)
#@gimp : Sep = separator()
#@gimp : Use as saturation = bool(0)
#@gimp : Color abstraction opacity = float(1,-1,1)
#@gimp : Negative color abstraction = bool(0)
#@gimp : Cubism on color abstraction = bool(0)
#@gimp : Kuwahara on painting = bool(0)
#@gimp : Soften = float(0,0,100)
#@gimp : Soften all channels = bool(0)
#@gimp : Donotmergelayers = bool(0)
#@gimp : Sep = separator()
#@gimp : Sep = separator(), Preview type = choice(0,"Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Note = link("Sample art here","http://www.flickr.com/photos/naggobot/6640743133/")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Arto Huotari</i>.      Latest update : <i>2014/02/23</i>.</small>")
gimp_ColorAbstractionPaint :
-to_rgb
pAbstraction=$1
EllipseRatio=$2
ValueOpacity=$3
UseHue=$4
MultiplyOpacity=$5
UseSaturation=$6
GrainMergeOpacity=$7
NCA=$8
CubeIt=$9
KuwaIt=$10
Soften=$11
SoftenAll=$12
DoNotCompose=$13
ReverseOrder0=1
ReverseOrder1=1
ReverseOrder2=1
eSmoothness=1
eOpacity=0.8
eOutline=1
eDensity={1.5*$eSmoothness/10}
pDetailsScale={$pAbstraction/2}
pColor=1.5
pSmoothness={10*$pAbstraction}
eSmoothness={10+($pAbstraction-1)*(1-10)/(10-1)}
ePrimaryRadius={($pAbstraction/5)*($pAbstraction/5)*sqrt(@{0,h})}
eSecondaryRadius={$EllipseRatio/100*$ePrimaryRadius}
cAbstraction={2+($pAbstraction-1)*(10-2)/(10-1)}
CubeSize={4+($pAbstraction-1)*(10-4)/(10-1)}
--gimp_ellipsionism[0] $ePrimaryRadius,$eSecondaryRadius,$eSmoothness,$eOpacity,1,$eDensity,0
-if {$SoftenAll==1" && "$Soften>0} -blur[-1] $Soften,0 -endif
--gimp_painting[0] $pAbstraction,$pDetailsScale,$pColor,$pSmoothness,1,0
-if {$KuwaIt==1} -gimp_kuwahara[-1] 2,$pAbstraction,0,0 -endif
-if {$Soften>0} -blur[-1] $Soften,0 -endif
--gimp_color_abstraction[0] $cAbstraction,45,0.35,0
-if {$NCA==1} -negative[-1] -endif
-if {$CubeIt==1} -cubism[-1] 600,$CubeSize,40,0.7,0 -endif
-if {$Soften>0} -blur[-1] $Soften,0 -endif
-if {$DoNotCompose==0}
#Compose Original and Ellipsionism with value
-blend[0,1] value,$ValueOpacity,$ReverseOrder0
#Compose Original+Ellipsionism with painting
-if {$MultiplyOpacity<0}
ReverseOrder1=0
MultiplyOpacity={-1*$MultiplyOpacity}
-endif
-if {$UseHue==0}
-blend[0,1] multiply,$MultiplyOpacity,$ReverseOrder1
-elif {$UseHue==1}
-blend[0,1] hue,$MultiplyOpacity,$ReverseOrder1
-endif
#Compose Original+Ellipsionism+Painting with Color abstraction
-if {$GrainMergeOpacity<0}
ReverseOrder2=0
GrainMergeOpacity={-1*$GrainMergeOpacity}
-endif
-if {$UseSaturation==0}
-blend[0,1] grainmerge,$GrainMergeOpacity,$ReverseOrder2
-elif {$UseSaturation==1}
-blend[0,1] saturation,$GrainMergeOpacity,$ReverseOrder2
-endif
-keep[0]
-endif
-if {$DoNotCompose==1} -remove[0] -endif
gimp_ColorAbstractionPaint_Preview :
-gimp_split_preview "-gimp_ColorAbstractionPaint ${1--2}",$-1
#@gimp Cubism : gimp_cubism, gimp_cubism_preview(1)
#@gimp : Iterations = int(2,0,10)
#@gimp : Density = float(50,0,200)
#@gimp : Thickness = float(10,0,50)
#@gimp : Angle = float(90,0,360)
#@gimp : Opacity = float(0.7,0.01,1)
#@gimp : Smoothness = float(0,0,5)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>06/05/2013</i>.</small>")
gimp_cubism :
-repeat $1 -cubism ${2--1} -done
gimp_cubism_preview :
-gimp_split_preview "-gimp_cubism $*",$-1
#@gimp Cutout : gimp_cutout, gimp_cutout_preview(1)
#@gimp : Number of levels = int(4,2,32)
#@gimp : Edge simplicity = float(0.5,0,3)
#@gimp : Edge fidelity = int(4,0,10)
#@gimp : Normalize = bool(1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>David Tschumperl&#233;</i> and <i>Garagecoder</i>.      Latest update: <i>06/03/2014</i>.</small>")
gimp_cutout :
-repeat @# -l[$>] -split_opacity -l[0]
-median {10-$3}
-quantize $1
--area[-1] 0,1 med=@{-med} -rm[-1]
-inpaint_holes {$med*$2%},0,1
-if $4 -n 0,255 -endif
-endl -a c -endl -done
gimp_cutout_preview :
-gimp_split_preview "-gimp_cutout $*",$-1
#@gimp Dream smoothing : gimp_dreamsmooth, gimp_dreamsmooth_preview(0)
#@gimp : Note = note("Updated for 1.5.4.0")
#@gimp : Note = note("A relatively slow filter that uses anisotropic filtering to smooth an image. More iterations produces softer image as does lower opacity values. Practical modes for merging are Alpha and Average. Note that results are resolution dependent.")
#@gimp : Sep = separator(), note = note("General settings")
#@gimp : Iterations = int(3,1,10)
#@gimp : Equalize at each step = bool(1)
#@gimp : Sep = separator(), note = note("Merging of iterations")
#@gimp : Merging option = choice(1,"add","alpha","and","average","blue","burn","darken",
#@gimp : "difference","divide","dodge","exclusion","freeze",
#@gimp : "grainextract","grainmerge","green","hardlight","hardmix",
#@gimp : "hue","interpolation","lighten","lightness","linearburn",
#@gimp : "linearlight","luminance","multiply","negation","or",
#@gimp : "overlay","pinlight","red","reflect","saturation","screen",
#@gimp : "shapeaverage","softburn","softdodge","softlight","stamp",
#@gimp : "subtract","value","vividlight","xor","edges")
#@gimp : Opacity = float(0.8,0,1)
#@gimp : Reverse order = bool(0)
#@gimp : Note = note("Settings for layer mode edges")
#@gimp : Smoothness = float(0.8,0,5)
#@gimp : Sep = separator()
#@gimp : Note = note("Parallel processing settings. Increase spatial overlap if vertical bands appear.")
#@gimp : Parallel processing = choice(1,"Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads")
#@gimp : Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small> Author: Arto Huotari Latest update : <i>2014/02/20</i>.</small>")
#@gimp : Note = link("Sample processing here","http://www.flickr.com/photos/naggobot/7644006608/")
gimp_dreamsmooth :
-m "MergeChoise : $""=_mode" -MergeChoise "add","alpha","and","average","blue","burn","darken","difference","divide","dodge","exclusion","freeze","grainextract","grainmerge","green","hardlight","hardmix","hue","interpolation","lighten","lightness","linearburn","linearlight","luminance","multiply","negation","or","overlay","pinlight","red","reflect","saturation","screen","shapeaverage","softburn","softdodge","softlight","stamp","subtract","value","vividlight","xor","edges","error"
-to_rgb
Iterations=$1
Eqa=$2
MergingOption=$3
Opacity=$4
ReverseOrder=$5
Smoothness=$6
Threads=$7
Overlap=$8
-repeat @# -l[$>]
-repeat $Iterations
#Calculate width and height
IWidth={round(@{0,w}/(@{<,-1}+1))}
IHeight={round(@{0,h}/(@{<,-1}+1))}
#Resize previously processed image. Not done on first repeat loop since there is no such image yet.
-if {@{>,-1}!=0}
-r[-1] $IWidth,$IHeight,1,3,5,1
-endif
#Resize and make a copy
--r[0] $IWidth,$IHeight,1,3,5,1
#Smoothing
-gimp_anisotropic_smoothing[-1] {430/$Iterations*(@{<,-1}+1)},0.4,0.5,0.6,2,0.8,30,2,0,0,1,0,$Threads,$Overlap,0
-gimp_anisotropic_smoothing[-1] {600/$Iterations*(@{<,-1}+1)},0.4,1,0.6,4,0.8,15,5,0,1,1,0,$Threads,$Overlap,0
#Combine images if not first round
-if {@{>,-1}!=0}
-if {$3'!='42}
-blend[-1,-2] ${_mode{$MergingOption+1}},$Opacity,$ReverseOrder
-endif
-if {$3'=='42}
-blend_edges[-1,-2] $Opacity,$Smoothness,$ReverseOrder
-endif
-if {$Eqa}
-equalize[-1] 256
-endif
-endif
-done
-keep[-1]
-endl -done
gimp_dreamsmooth_preview :
-gimp_split_preview "-gimp_dreamsmooth ${1--2}",$-1
#@gimp Ellipsionism : gimp_ellipsionism, gimp_ellipsionism_preview(0)
#@gimp : Primary radius = float(20,1,100)
#@gimp : Secondary radius = float(10,1,100)
#@gimp : Smoothness = float(0.5,0,10)
#@gimp : Opacity = float(0.7,0,1)
#@gimp : Outline = float(8,1,3)
#@gimp : Density = float(0.5,0.1,2)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_ellipsionism :
-ellipsionism ${^0}
gimp_ellipsionism_preview :
-gimp_split_preview "-gimp_ellipsionism $*",$-1
#@gimp Felt pen : gimp_feltpen, gimp_feltpen_preview(0)
#@gimp : Amplitude = float(300,0,4000)
#@gimp : Density = float(50,0,100)
#@gimp : Smoothness = float(1,0,10)
#@gimp : Opacity = float(0.1,0,1)
#@gimp : Edge = float(20,0,100)
#@gimp : Thickness = int(5,2,32)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/25/2012</i>.</small>")
gimp_feltpen :
-repeat @# -l[$>] --gimp_hardsketchbw ${1-5},0,0 -blend hardlight -erode_oct $6 -endl -done
gimp_feltpen_preview :
-gimp_split_preview "-gimp_feltpen $*",$-1
#@gimp Finger paint : gtutor_fpaint, gtutor_fpaint_preview(0)
#@gimp : Note = note("<b>Paint Detail</b>")
#@gimp : Finger size = float(0.5,0,1)
#@gimp : Keep detail = float(0.5,0,1)
#@gimp : Bristle size = float(0.0,0,1)
#@gimp : Edge detect includes chroma = bool(0)
#@gimp : Sep = separator()
#@gimp : Note = note("<b>Render Detail</b>")
#@gimp : Light direction = float(45.0,0,360.0)
#@gimp : Shadow = float(0.5,0,1)
#@gimp : Highlight = float(0.5,0,1)
#@gimp : Specular = float(0.5,0,1)
#@gimp : Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Garry R. Osgood</i>. Latest update: <i>2015/02/26</i>.</small>")
#@gimp : Note = link("Finger paint instructions and tutorial.","http://gmic.eu/tutorial/fingerpainting.shtml")
gtutor_fpaint :
-repeat @#
-local[$>]
hasalpha={s>3}
-if {$hasalpha}
-split_opacity[-1]
-reverse[-2,-1]
-endif
lh={h}
--blur[-1] {$1/1.25}%
-if $4
--luminance[-1]
-rgb2hsl[-2]
-split[-2] c
-rm[-4,-2]
-quantize[-2,-1] {round(5+15*(1-$1))},1,1
-gradient_norm[-2,-1]
-normalize[-2,-1] 0,255
-add[-2,-1]
-else
-quantize[-1] {round(5+15*(1-$1))},1,1
-gradient_norm[-1]
-normalize[-1] 0,255
-endif
-threshold[-1] {80-60*$2}%
-dilate_circ[-1] 8
-thinning[-1]
-dilate_circ[-1] 3
--diffusiontensors[-1] 0.1,0.85,0.3,{4+8*$1}
-if {$2<1}
[-1]
-resize2dy[-3,-1] {$lh*(0.25+0.75*$2)},5
-repeat 2
-smooth[-3] [-1],{400*(1-$2)}
-done
-rm[-1]
-resize[-2] [-3],[-3],[-2],[-2],5,0
-endif
-eigen[-1]
-split[-2] c
-fill_color[-3] {1-0.15*$3}
-fill_color[-2] {0.15*$3}
-append[-3,-2] c
-eigen2tensor[-2,-1]
98%,98%,1,1 -noise[-1] {20-10*$3},2
-resize[-1] [-2],[-2],[-1],[-1],0,0,0.5,0.5,0.5,0.5
-to_rgb[-1]
-mul[-1] [-4]
--ac[-4] "-mul 0.6","hsl_s"
-ac[-1]  "-mul 0.85","hsl_l"
-repeat 2
-smooth[-2,-1] [-3],{100*(6-5*$2)}
-done
--luminance[-2]
-normalize[-1] 0,0.7
--normalize[-5] 0,1
-add[-2,-1]
-normalize[-1] 0,1
-blend[-3,-2] add
-gradient[-1]
-append[-2,-1] c
100%,100%,1,2
-if $6
-fill_color[-1] {cos(2*((180+$5)%360)*pi/360)},{sin(2*((180+$5)%360)*pi/360)}
--mul[-2,-1]
-compose_channels[-1] add
-cut[-1] {ia},{iM}
-normalize[-1] 0,1
-to_rgb[-1]
-mul[-1] [-7]
-negative[-1]
-normalize[-1] 0,255
-blend[-4,-1] multiply,$6
-endif
-if $7
-fill_color[-1] {cos(2*$5*pi/360)},{sin(2*$5*pi/360)}
--mul[-2,-1]
-compose_channels[-1] add
-cut[-1] {ia},{iM}
-normalize[-1] 0,1
-to_rgb[-1]
-mul[-1] [-7]
-normalize[-1] 0,255
-blend[-4,-1] screen,$7
-endif
-if $8
-fill_color[-1] {cos(2*$5*pi/360)},{sin(2*$5*pi/360)}
--mul[-2,-1]
-compose_channels[-1] add
-cut[-1] {ia},{iM}
-to_rgb[-1]
-normalize[-1] 0,255
-blend[-4,-1] screen,$8
-endif
-rm[-1,-2,-4,-5,-6]
-ac[-1] "-apply_curve 1,0,32,127,180,255,255","hsl_s"
-apply_gamma[-1] 1.4
-if {$hasalpha}
-reverse[-2,-1]
-append[-2,-1] c
-endif
-endlocal
-done
gtutor_fpaint_preview :
-gimp_split_preview "-gtutor_fpaint ${^0}",$-1
#@gimp Fractalize : fractalize, fractalize(1)
#@gimp : Detail level = float(0.8,0,1)
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Note:</b> This filter uses lot of random values to generate its result, so running it twice will give you different results !</small>")
#@gimp : Sep = separator(), link = link("Click here for a detailed description of this filter.","http://www.gimpchat.com/viewtopic.php?f=28&t=10036")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>04/25/2014</i>.</small>")
#@gimp Granular texture : samj_en_Texture_Granuleuse, samj_en_Texture_Granuleuse_preview(0)
#@gimp : Note = note("<small>Granular Texture</small>")
#@gimp : Sep = separator()
#@gimp : Smoothness gradient RGB = float(0,0.5,2)
#@gimp : Max threshold gradient RGB = float(20,10,50)
#@gimp : Sep = separator()
#@gimp : Noise = float(80.0,40,200)
#@gimp : Sep = separator()
#@gimp : Colors = float(0,-20,20)
#@gimp : Automatic color balance = bool(0)
#@gimp : Sep = separator()
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/07</i>.</small>")
samj_en_Texture_Granuleuse :
-samj_Texture_Granuleuse $1,$2,$3,$4,$5
samj_en_Texture_Granuleuse_preview :
-gimp_split_preview "-samj_en_Texture_Granuleuse $*",$-1
#@gimp Graphic boost : gimp_graphic_boost4, gimp_graphic_boost4(0)
#@gimp : Sep = separator ()
#@gimp : Note = note("Unsharp Mask controls")
#@gimp : Radius = float(1.25,0,20)
#@gimp : Darken = float(2,0,10)
#@gimp : Sep = separator()
#@gimp : Skip others steps = bool(false)
#@gimp : Note = note("Check for visual control, UNcheck to reactivate the other controls")
#@gimp : Sep = separator()
#@gimp : Sep = separator()
#@gimp : Note = note("BW_Pencil Controls")
#@gimp : Pencil size = float(0.15,0,4)
#@gimp : Pencil amplitude = float(14,0,200)
#@gimp : Sep = separator()
#@gimp : Skip others steps = bool(false)
#@gimp : Sep = separator ()
#@gimp : Sep = separator ()
#@gimp : Activate "pencil smoother" = bool(true)
#@gimp : Note = note(" If unchecked the 3 sliders below are disabled ")
#@gimp : Pencil smoother sharpness = float(0.5,0,2)
#@gimp : Pencil smoother edge protection = float(0.45,0,1)
#@gimp : Pencil smoother smoothness = float (2,0,10)
#@gimp : Sep = separator()
#@gimp : Skip others steps = bool(false)
#@gimp : Sep = separator ()
#@gimp : Sep = separator ()
#@gimp : Note = note("Merging Options")
#@gimp : Swap layers = bool (True)
#@gimp : Note = note (""Swap" change the effect of Merging and Intesity")
#@gimp : Merging option = choice( "Hard Light","Grain Merge","Multiply","Color Burn","Overlay" ,"Value","Darken" ,"Lightness", "Luminance","*Colors Doping*","Comix Colors" ,"Graphic Colours","Graphix Colors","Vivid Edges*","Dark Edges","Dark Screen","Vivid Screen","Interpolate")
#@gimp : Opacity = float(1,0,1)
#@gimp : Intensity = float(1,0,1)
#@gimp : Sep = separator ()
#@gimp : Add painter's touch = bool(true)
#@gimp : Note = note("If unchecked the 3 sliders below are disabled")
#@gimp : Sep = separator ()
#@gimp : Painter's touch sharpness = float(0.5,0,2)
#@gimp : Painter's edge protection flow = float(0.45,0,1)
#@gimp : Painter's smoothness =float(1,0,10)
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>. Latest update : <i>11/13/2011 </i>.</small>")
#@gimp : Note = link("Filter explained here","http://www.gimpchat.com/viewtopic.php?f=9&t=775")
gimp_graphic_boost4 :
-repeat @# -l[$>] -split_opacity -l[0]
-gimp_unsharp 1,$1,30,3,0,$2,0.40,1,0,0,0
-if {$3==1} -break -endif
--gimp_pencilbw $4,$5,0,0,0
-if {$6==1} -keep[-1] -break -endif
-if {$7==1} -gimp_anisotropic_smoothing[1] 60,$8,$9,$10,1.1,0.8,30,2,0,1,1,0 -endif
-if {$11==1} -keep[-1] -break -endif
-if {$12==1}  -reverse -endif
-if {$13==0} -gimp_compose_hardlight $14,0
-elif {$13==1} -gimp_compose_grainmerge $14,0
-elif {$13==2} -gimp_compose_multiply $14,0
-elif {$13==3} -gimp_compose_colorburn $14,0
-elif {$13==4} -gimp_compose_overlay $14,0
-elif {$13==5} -gimp_compose_value $14,1
-elif {$13==6} -gimp_compose_darken $14,0
-elif {$13==7} -gimp_compose_lightness $14,1
-elif {$13==8} -gimp_compose_luminance $14,1
-elif {$13==9} -gimp_compose_colordoping $14,0
-elif {$13==10} -gimp_compose_comix_color $14,0,$15
-elif {$13==11} -gimp_compose_graphicolor $14,0,$15
-elif {$13==12} -gimp_compose_graphixcolor $14,0
-elif {$13==13} -gimp_compose_vividedges $14,0.50,0,$15
-elif {$13==14} -gimp_compose_darkedges $14,0.50,0,$15
-elif {$13==15} -gimp_compose_vividscreen $14,0,$15
-elif {$13==16} -gimp_compose_darkscreen $14,0,$15
-elif {$13==17} -gimp_compose_interpolation $14,0 -endif
-if {$16==1} -gimp_anisotropic_smoothing 60,$17,$18,$19,1.1,0.8,30,2,0,1,1,0 -endif
-endl -a c -endl -done
#@gimp Graphic novel : gimp_graphic_novelfxl, gimp_graphic_novelfxl(0)
#@gimp : Sep = separator ()
#@gimp : Note = note("Apply Local Normalization")
#@gimp : Skip this step = bool(false)
#@gimp : Sep = separator ()
#@gimp : Note = note(" Local Normalization Controls")
#@gimp : Ln amplititude = float(2,0,60)
#@gimp : Ln size = float(6,0,64)
#@gimp : Ln neightborhood-smoothness = float(5,0,40)
#@gimp : Ln average-smoothness = float(20,0,40)
#@gimp : Sep = separator()
#@gimp : Skip all other steps = bool(false)
#@gimp : Sep = separator()
#@gimp : Sep = separator()
#@gimp : Note = note(" Pencil Options")
#@gimp : Pencil size = float(0.62,0,4)
#@gimp : Pencil amplitude = float(14,0,200)
#@gimp : Sep = separator()
#@gimp : Skip all other steps = bool(false)
#@gimp : Sep = separator()
#@gimp : Sep = separator()
#@gimp : Activate "pencil smoother" = bool(true)
#@gimp : Note = note(" If unchecked the 3 sliders below are disabled ")
#@gimp : Sep = separator()
#@gimp : Pencil smoother sharpness = float(0.5,0,2)
#@gimp : Pencil smoother edge protection = float(0.78,0,1)
#@gimp : Pencil smoother smoothness = float(1.92,0,10)
#@gimp : Sep = separator()
#@gimp : Skip all other steps = bool(false)
#@gimp : Sep = separator ()
#@gimp : Sep = separator()
#@gimp : Note = note ("Boost Merging Options")
#@gimp : Swap layers = bool (false)
#@gimp : Mixer = choice("Overlay","Multiply","Soft light","Color Burn","Darken","Stamp","Hard Light","Value","Grain Merge","Freeze","Lightness", "Luminance","*Colors Doping","*Comix Colors*" ,"Graphic Colours","*Graphix Colors","*Vivid Edges*","*Dark Edges*","*Dark Screen*","*Vivid Screen*","Interpolate")
#@gimp : Opacity = float(1,0,1)
#@gimp : Intensity = float(1,0,1)
#@gimp : Sep = separator ()
#@gimp : Add painter's touch = bool(true)
#@gimp : Sep = separator ()
#@gimp : Painter's touch sharpness = float(0.5,0,2)
#@gimp : Painter's edge protection flow = float(0.8,0,1)
#@gimp : Painter's smoothness =float(1.28,0,10)
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>. Latest update : <i>11/13/2011</i>.</small>")
#@gimp : Note = link("Filter explained here","http://www.gimpchat.com/viewtopic.php?f=9&t=1582")
gimp_graphic_novelfxl :
-repeat @# -l[$>] -split_opacity -l[0]
-if {$1==0} -gimp_normalize_local $2,$3,$4,$5,1,3,0 -endif
-if {$6==0} --gimp_pencilbw $7,$8,0,0,0 -endif
-if {$9==1} -keep[-1] -break -endif
-if {$10==1} -gimp_anisotropic_smoothing[-1] 60,$11,$12,$13,1.1,0.8,30,2,0,1,1,0 -endif
-if {$14==1} -keep[-1] -break -endif
-if {$15==1} -reverse -endif
-if {$16==0} -gimp_compose_overlay $17,0
-elif {$16==1} -gimp_compose_multiply $17,0
-elif {$16==2} -gimp_compose_softlight $17,0
-elif {$16==3} -gimp_compose_colorburn $17,0
-elif {$16==4} -gimp_compose_darken $17,0
-elif {$16==5} -gimp_compose_stamp $17,0
-elif {$16==6} -gimp_compose_hardlight $17,0
-elif {$16==7} -gimp_compose_value $17,1
-elif {$16==8} -gimp_compose_grainmerge $17,0
-elif {$16==9} -gimp_compose_freeze $17,0
-elif {$16==10} -gimp_compose_lightness $17,1
-elif {$16==11} -gimp_compose_luminance $17,1
-elif {$16==12} -gimp_compose_colordoping $17,0
-elif {$16==13} -gimp_compose_comix_color $17,0,$18
-elif {$16==14} -gimp_compose_graphicolor $17,0,$18
-elif {$16==15} -gimp_compose_graphixcolor $17,0
-elif {$16==16} -gimp_compose_vividedges $17,0.50,0,$18
-elif {$16==17} -gimp_compose_darkedges $17,0.50,0,$18
-elif {$16==18} -gimp_compose_vividscreen $17,0,$18
-elif {$16==19} -gimp_compose_darkscreen $17,0,$18
-elif {$16==20} -gimp_compose_interpolation $17,0 -endif
-if {$19==1} -gimp_anisotropic_smoothing 60,$20,$21,$22,1.1,0.8,30,2,0,1,1,0 -endif
-endl -a c -endl -done
#@gimp Hope poster : gimp_poster_hope, gimp_poster_hope_preview(0)
#@gimp : Gamma = float(0,-3,3)
#@gimp : Smoothness = float(3,0,20)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/07/2013</i>.</small>")
gimp_poster_hope :
-repeat @# -l[$>] -split_opacity -l[0]
-apply_gamma {10^$1} -poster_hope $2
-endl -a c -endl -done
gimp_poster_hope_preview :
-gimp_split_preview "-gimp_poster_hope $*",$-1
#@gimp Kuwahara : gimp_kuwahara, gimp_kuwahara_preview(0)
#@gimp : Iterations = int(2,1,20)
#@gimp : Radius = int(5,1,30)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>05/31/2011</i>.</small>")
gimp_kuwahara :
-ac "-repeat $1 -kuwahara $2 -done",$3,$4
gimp_kuwahara_preview :
-gimp_split_preview "-gimp_kuwahara $*",$-1
#@gimp Lylejk's painting : gimp_lylejk_painting, gimp_lylejk_painting_preview(0)
#@gimp : Iterations = int(10,1,20)
#@gimp : Abstraction = int(2,1,20)
#@gimp : Radius = int(4,1,30)
#@gimp : Canvas = float(10,0,100)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Lyle Kroll</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>02/23/2015</i>.</small>")
#@gimp : Note = link("Filter Explained here","http://www.gimpchat.com/viewtopic.php?f=10&t=2624")
gimp_lylejk_painting :
-repeat @# -l[$>]
nm=@{0,n}
--l -repeat $1 -b 0.75 -unsharp 0.75,10.49 -c 0,255 -mv[-1] 0 -done -endl
-smooth[-1] 300,0.26,1,0,7
[-1] -rv[-3--1]
-blend[-2,-1] lighten,0.5
-blend[-2,-1] grainmerge,1
-gimp_kuwahara[-1] $2,$3,0,0
-texturize_canvas[-1] $4,4
-nm $nm
-endl -done
gimp_lylejk_painting_preview :
-gimp_split_preview "-gimp_lylejk_painting $*",$-1
#@gimp Make squiggly : gimp_Squiggly, gimp_Squiggly_Preview(0)
#@gimp : Note = note("Squigles an image")
#@gimp : Note = note("Squigle parameters")
#@gimp : Spread noise amount = float(2,0,20)
#@gimp : Segmentation edge threshold = float(12,0,15)
#@gimp : Segmentation smoothness = float(0.8,0,5)
#@gimp : Gradiennormsmoothness = float(0,0,10)
#@gimp : Gradiennormlinearity = float(0.5,0,1.5)
#@gimp : Invert luminance = bool(1)
#@gimp : Sep = separator()
#@gimp : Sep = separator()
#@gimp : Note = note("<b>Optional color enhancement</b>")
#@gimp : Note = note("Note that the effect of sliders depends on the merge setting.")
#@gimp : Activate color enhancement = bool(0)
#@gimp : Toggle to view base image = bool(0), note = note("Check this to view base image")
#@gimp : Increasechroma1 = float(3,1,4)
#@gimp : Tone threshold = float(0.2,0,1)
#@gimp : Tone gamma = float(0.4,0,1)
#@gimp : Note = note("Select merging mode to original")
#@gimp : Merging option = choice("Alpha","And","Average","Burn","Darken","Difference","Divide","Dodge","Exclusion","Freeze","Grain extract","Grain merge",
#@gimp : "Hard light","Hue","Interpolation","Lighten","Lightness","Luminance","Multiply","Negation","Or","Overlay","Reflect","Saturation",
#@gimp : "Soft light","Screen","Stamp","Value","Xor")
#@gimp : Opacity = float(1,0,1)
#@gimp : Reverse order = bool(1)
#@gimp : Sep = separator()
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Arto Huotari</i>.      Latest update : <i>2013/09/28</i>.</small>")
#@gimp : Note = link("Filter Explained here","http://www.flickr.com/photos/naggobot/6667673847/")
gimp_Squiggly :
SpreadNoiseAmount=$1
SEgThrshld=$2
SegSmooth=$3
GNSmooth=$4
GNLin=$5
InvertLuminance=$6
EnhanceColors=$7
ToggleOrg=$8
Chroma=$9
ToneTr=$10
ToneGm=$11
OrgMergeCh=$12
OrgOpacity=$13
OrgReverseorder=$14
-if {$ToggleOrg==1}
OrgMergeCh=30
OrgReverseorder=1
-endif
-to_rgb
--gimp_spread[0] $SpreadNoiseAmount,$SpreadNoiseAmount,0,0
-gimp_segment_watershed[1] $SEgThrshld,$SegSmooth,0,0
--gimp_gradient_norm[1] $GNSmooth,$GNLin,0,100,0,0
--blend[2,1] multiply
-if {$InvertLuminance==1}
#Convert to LAB
-rgb2lab[-1]
#Split channels
-split[-1] c
-negative[-3]
-append[-3--1] c
-lab2rgb[-1]
-endif
-if {$EnhanceColors==1}
#Increase chroma
-gimp_mix_ycbcr[3] 1,0,0,$Chroma,0,0,$Chroma,0,0,0,2,0
#Tonemap original
-gimp_map_tones[0] $ToneTr,$ToneGm,0.1,30,0,0
#-gimp_apply_curve[0] 0,30,128,-1,128,-1,128,-1,128,-1,128,255,1,3,0,0,0
#Compose Squigglies to original
-gimp_blend[0,3] $OrgMergeCh,$OrgOpacity,$OrgReverseorder
-keep[0]
-endif
-keep[-1]
gimp_Squiggly_Preview :
-gimp_split_preview "-gimp_Squiggly ${1--2}",$-1
#@gimp Morphology painting : gimp_MorphoPaint, gimp_MorphoPaint_preview(0)
#@gimp : Sep = separator()
#@gimp : Note = note("Creates a painting using Morphology-, Segmentation- and Painting- filters. CPU intensive filter that may take long.")
#@gimp : Sep = separator()
#@gimp : Note = note("Morphology settings")
#@gimp : Sep = separator()
#@gimp : Method = choice(1,"Erosion","Dilation","Opening","Closing")
#@gimp : Morphostrenght = int(18,2,60)
#@gimp : Shape = choice(2,"Square","Octagonal","Circular")
#@gimp : Sep = separator()
#@gimp : Note = note("Lightness for Morpholayer")
#@gimp : Black point = int(25,0,50)
#@gimp : Expand shadows = int(100,50,255)
#@gimp : Compress highlights = int(230,200,255)
#@gimp : Sep = separator()
#@gimp : Note = note("Smoothing strength")
#@gimp : Spread amount = int(8,0,20)
#@gimp : Blurr strength = int(3,0,10)
#@gimp : Sep = separator()
#@gimp : Note = note("Segmentation settings")
#@gimp : Edge threshold = float(4,0,15)
#@gimp : Smoothness = float(0.5,0,5)
#@gimp : Sep = separator()
#@gimp : Note = note("Painting Settings")
#@gimp : Abstraction = int(2,1,10)
#@gimp : Details scale = float(0.5,0,5)
#@gimp : Smoothness = float(200,0,1000)
#@gimp : Sep = separator()
#@gimp : Merge layers? = bool(1)
#@gimp : Note = note("When unchecked the filter will output layers separately for manual composing. Set G'Mic output to new layers.")
#@gimp : Sep = separator()
#@gimp : Enable paintstroke = bool(1)
#@gimp : Stroke strength = float(1,0,1)
#@gimp : Enable segmentation = bool(1)
#@gimp : Segments strength = float(1,0,1)
#@gimp : Enable morphology = bool(1)
#@gimp : Morphology strength = float(1,0,1)
#@gimp : Normalize = bool(1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Arto Huotari</i>.      Latest update : <i>2013/09/28</i>.</small>")
#@gimp : Note = link("Filter Explained here","http://www.flickr.com/photos/naggobot/6108637935/")
gimp_MorphoPaint :
-to_rgb[0]
--gimp_morpho[0] $1,$2,0,2,0,$3,0
--gimp_apply_curve[1] $4,50,$5,200,$6,-1,128,-1,128,-1,128,255,1,3,0,0,0
-gimp_spread[1] $7,$7,0,0
-gimp_gaussian_blur[2] $8,0,0,1,0,0,0
-gimp_segment_watershed[1] $9,$10,0,0
--gimp_painting[0] $11,$12,1.5,$13,1,0
-remove[0]
-reverse[0,2]
-reverse[1,2]
-if $14
-if {$19==0} MorphoStrength={0} -elif {$19==1} MorphoStrength={$20} -endif
-mul[2] {$MorphoStrength/3}
-if {$15==0} StrokeStrength={0} -elif {$15==1} StrokeStrength={$16} -endif
-mul[0] {$StrokeStrength/3}
-if {$17==0} SegmentStrength={0} -elif {$17==1} SegmentStrength={$18} -endif
-mul[1] {$SegmentStrength/3}
-add[1] [2]
-add[1] [0]
-if $21 -normalize[1] 0,255 -endif
-remove[0,2]
-endif
gimp_MorphoPaint_preview :
-gimp_split_preview "-gimp_MorphoPaint ${1--2}",$-1
#@gimp Painting : gimp_painting, gimp_painting_preview(0)
#@gimp : Abstraction = int(5,1,10)
#@gimp : Details scale = float(2.5,0,5)
#@gimp : Color = float(1.5,0,4)
#@gimp : Smoothness = float(50,0,1000)
#@gimp : Sharpen shades = bool(1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Lyle Kroll</i>, <i>Angelo Lama</i> and <i>David Tschumperl&#233;</i>.\nLatest update: <i>02/28/2011</i>.</small>")
gimp_painting : -skip ${4=0},${5=0}
-repeat @# -l[$>]
-to_colormode {max(3,s)} -split_opacity -rv
-repeat $1 -gimp_normalize_local[-1] 10,6,5,20,1,7 -done
-gimp_anisotropic_smoothing[-1] {100*$2},0.2,1,$2,{2*$2},0.8,90,2,0,1,1,2,1,16
-gimp_mix_lab[-1] 1,0,0,$3,0,0.5,$3,0,0.5,0,2,0
-if $5 -gimp_segment_watershed[-1] 10,1,0 -endif
-smooth[-1] $4,0,1,1,1
-rv -a c
-endl -done
gimp_painting_preview :
-gimp_split_preview "-gimp_painting $*",$-1
#@gimp Pen drawing : gimp_pen_drawing, gimp_pen_drawing_preview(0)
#@gimp : Amplitude = float(10,0,30)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_pen_drawing :
-drawing $1
gimp_pen_drawing_preview :
-gimp_split_preview "-gimp_pen_drawing $*",$-1
#@gimp Photoillustration : gimp_tk_photoillustration,  gimp_tk_photoillustration_preview(0)
#@gimp : Note = note("adding an illustrative effect to any photograph")
#@gimp : Sep = separator()
#@gimp : Local contrast style = choice("tone mapping","tone mapping soft","tone mapping fast","local  normalisation","unsharp mask","global mapping","dynamic range increase","none")
#@gimp : Local contrast effect = float(0.25,0.00,2.5)
#@gimp : Smoothing style = choice("anisotropic","bilateral","color channel  smoothing","segmentation","morphological closing","selective gaussian","wavelet","Kuwahara","none")
#@gimp : Contour precision = float(0.30,0.00,1.00)
#@gimp : Area smoothness = float(0.50,0.00,10.00)
#@gimp : Sharpening radius = float(0.50,0.00,10.00)
#@gimp : Sharpening strength = float(1.00,0.00,5.00)
#@gimp : Special effects = choice("none","soft glow","dusty","Orton glow","extra  smooth","bloom","paintstroke")
#@gimp : Effect strength = float(5.00,0.00,20.00)
#@gimp : Overall lightness = float(0,-50,50)
#@gimp : Overall contrast = float(1,0.5,1.5)
#@gimp : Shadows lightness = float(0,-100,100)
#@gimp : Highlights lightness = float(0,-100,100)
#@gimp : Mid tone contrast = float(1,0.5,4)
#@gimp : Color green-magenta = float(0,-20,20)
#@gimp : Color blue-yellow = float(0,-20,20)
#@gimp : Color boost = float(1.2,0,4)
#@gimp : Detail reconstruction detection = float (98.5,50,100)
#@gimp : Detail reconstruction smoothness = float(5,0,10)
#@gimp : Detail reconstruction strength = float(0.5,0,1)
#@gimp : Detail reconstruction style = choice("micro/macro details  adjusted","fine","strong","high pass","artistic round","artistic hard","artistic  modern","comic Style","gritty","none")
#@gimp : Keep detail layer seperate = bool(0)
#@gimp : Remove artifacts from micro/macro detail = bool(0)
#@gimp : Skin tone protection = bool(0)
#@gimp : Sharpen edges only = bool(0)
#@gimp : Computation mode = choice(1,"high quality","normal","high speed")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward  horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>        Latest update: <i>28/08/2012</i>.</small>")
#@gimp : Note = link("Filter explained  here","http://www.tkfilter.bplaced.net/TKFilter%20tutorials%20Photoillustration.html")
gimp_tk_photoillustration :
-repeat @# -l[$>]
-if {$26==1} scdo=50 scup=200 -endif
-if {$26==2} scdo=25 scup=400 -endif
-if {$26!=0} -r $scdo%,$scdo% -else -endif
-if {$21==0} [^] --negative[1]  [0] --negative[0]
-gimp_gaussian_blur[2] {{{100-$18}/5}+0.5},0,0,1,0,0,0  -gimp_compose_dodge[1,2] 1
-if {$23==1} -gimp_gaussian_blur[1] {{{100-$18}/10}+0.5},0,0,1,0,0,0 -endif
-gimp_gaussian_blur[3] {{{{{100-$18}/5}+1}*10}+10},0,0,1,0,0,0
-gimp_compose_dodge[2,3] 1
-if {$23==1} -gimp_gaussian_blur[2] {{{{100-$18}/10}+0.5}*3},0,0,1,0,0,0 -endif
-reverse[1,2] -gimp_compose_multiply[1,2] {1-{$19/10}}
-tk_gimp_channel_processing[1] {{1-$20}+0.1},1,0,0,0,0,100,256,0,0,0,2,7,0
-elif {$21==1} --gimp_laplacian $19,{99.99-$18},$18,1,1,0
-elif {$21==2} --gimp_gradient_norm $19,0.5,{99.99-$18},$18,1,0
-elif {$21==3} --gimp_highpass {-{$18-100.3}},{{10-$19}*0.7},0,1,0
-elif {$21==4} --gimp_pencilbw {100-$18},{$19*20},0,0,0
-elif {$21==5}
--gimp_hardsketchbw {300+{{$18-50}*15}},{$19*10},$19,1,{50-{$18/2}},0,0,0
-elif {$21==6} --gimp_thin_edges $19,{{$18/5}-10},0,0
-elif {$21==7} --gimp_edges {$19/3.5},{95-$18},0,0
--gimp_mix_hsv[0] 1,0,0,1,-1,0,1,0,0,0,2,0
-tk_gimp_channel_processing[2] 1,1,0,{$19/10},4,{{$18-50}*2},100,256,0,0,0,2,7,0
-reverse[1,2] -gimp_compose_multiply[1,2] {0.5+{$20/2}}
-elif {$21==8} --channels 2
-if {$19<=5}   -gimp_unsharp[1]  1,{2-{{$19*0.3}+0.5}},20,{5-$19},0.00,1.00,0.5,1,0,7,0
-else -gimp_gaussian_blur[1] {$19-5},0,0,1,0,0,0  -endif
-endif
-if {$1!=3}
-tk_gimp_channel_processing[0] 1,1,$12,0,0,0,100,256,0,0,1,{abs($12/10)},7,0
-tk_gimp_channel_processing[0] 1,1,$13,0,0,0,100,256,0,0,3,{abs($12/10)},7,0      -endif
-if {$24==0}
-if {$1==0} -gimp_map_tones[0] {$2/2.5},{1-{$2/2.5}},$2,{2+{$2*80}},3,0
-elif {$1==1} -gimp_map_tones[0] {$2/10},0.5,{10-{$2*2}},300,3,0
-elif {$1==2} -gimp_map_tones_fast[0] {$2*2},{$2/2.5},3,0
-elif {$1==3}
-gimp_normalize_local[0] {$2*2},{1+{$2*25.2}},{$2*16},{$2*16},0,3,0
-elif {$1==4} -gimp_unsharp[0] 0,{{w+h}/100},0,$2,0,1,1,1,0,7,0
-elif {$1==5} --negative[0]
-if {$21!=9} -reverse[1,2] -endif
-gimp_gaussian_blur[1] {{{w+h}/5}-{$2*{{w+h}/12.5}}},0,0,1,0,0,0
-to_gray[1] -reverse[0,1] -gimp_compose_softlight[0,1] {$2/2.5}
-elif {$1==6} -gimp_tk_dri[0] {$2/2.5},{$2/5},{$2/2.5},{$2*2},{$2/2.5},1,1,0
-endif
-else
--to_rgba[0] --channels[0] 0 -if {$21!=9} -move[1] 4 -endif
-negative[2]
-tk_gimp_channel_processing[2] 1,1,2,0,0,0,100,256,0,0,0,2,7,0
-gimp_gaussian_blur[2] {{w+h}/500},0,0,1,0,0,0
-to_gray[2]
-if {$1==0} -gimp_map_tones[1] {$2/2.5},{1-{$2/2.5}},$2,{2+{$2*80}},3,0
-elif {$1==1} -gimp_map_tones[1] {$2/10},0.5,{10-{$2*2}},300,3,0
-elif {$1==2} -gimp_map_tones_fast[1] {$2*2},{$2/2.5},3,0
-elif {$1==3}   -gimp_normalize_local[1]  {$2*2},{1+{$2*25.2}},{$2*16},{$2*16},0,3,0
-elif {$1==4} -gimp_unsharp[1] 0,100,0,$2,0,1,1,1,0,7,0
-elif {$1==5} -negative[1] -gimp_gaussian_blur[1]  {{{w+h}/5}-{$2*{{w+h}/12.5}}},0,0,1,0,0,0
-to_gray[1] -to_rgba[1]
-elif {$1==6} -gimp_tk_dri[1] {$2/2.5},{$2/5},{$2/2.5},{$2*2},{$2/2.5},1,1,0    -to_rgba[1]
-endif
-split[1] c
-if {$21!=9} -reverse[4,5] -compose_multiply[4,5] -append[-5,-4,-3,-2] c
-else -reverse[3,4] -compose_multiply[3,4] -append[-4,-3,-2,-1] c -endif
-if {$1!=3} -compose_rgba[0,1] -else -reverse[0,1]
-gimp_compose_softlight[0,1] {$2/2.5} -endif
-endif
-tk_gimp_channel_processing[0] 1,$11,$10,0,0,0,100,256,0,0,0,2,7,0
-tk_gimp_channel_processing[0] 1,$14,0,0,0,0,100,256,0,0,2,{abs($14*2.5)},7,0
-if {$1==3}
-tk_gimp_channel_processing[0] 1,1,$12,0,0,0,100,256,0,0,1,{abs($12/10)},7,0
-tk_gimp_channel_processing[0] 1,1,$13,0,0,0,100,256,0,0,3,{abs($12/10)},7,0
-endif
-if {$3==0} -gimp_anisotropic_smoothing[0]  {$5*100},{$4*2},$4,$5,$5,0.80,30.00,2.0,0,1,1,0,1,0
-elif {$3==1} -gimp_bilateral[0] {100-{$4*100}},{$5*25},1,0,0
-elif {$3==2} -gimp_gaussian_blur[0] {$5*10},0,0,1,8,0,0
-elif {$3==3} -gimp_segment_watershed[0] {$4*5},{$5/2},0,0
-elif {$3==4} -gimp_morpho[0] 3,{$5*2+2},0,2,0,1,0
-elif {$3==5} -gimp_selective_smoothing[0] {$5*4},{$4*2},10,10,0,0
-elif {$3==6} -gimp_haar_smoothing[0] {10-{$4*10}},{round($5*5,1)},0,0,0
-elif {$3==7} -to_rgb[0] -gimp_kuwahara[0] {6-{$4*5}},{1+{$5*2.9}},0,0
-endif
-gimp_mix_lab[0] 1,0,0,$17,$15,0,$17,$16,0,0,2,0
-if {$25==0}
-gimp_unsharp[0] 1,$6,20,$7,0.00,1.00,0.5,1,0,7,0
-else
--to_rgba[0] --gimp_edges[0] $6,{30-{$7*5}},1,0 -if {$21!=9} -move[1] 4 -endif
-gimp_unsharp[1] 1,$6,20,$7,0.00,1.00,0.5,1,0,7,0
-gimp_gaussian_blur[2] {{w+h}/500},0,0,1,0,0,0
-to_gray[2]
-split[1] c
-if {$21!=9} -reverse[4,5] -compose_multiply[4,5] -append[-5,-4,-3,-2] c
-else -reverse[3,4] -compose_multiply[3,4] -append[-4,-3,-2,-1] c -endif
-compose_rgba[0,1]
-endif
-if {$22==0}
-if {$21==3}  -reverse -gimp_compose_overlay $20
-elif {$21==8} -reverse -gimp_compose_hardlight $20
-elif {$21!=9} -reverse -gimp_compose_multiply $20
-endif -endif
-if {$8==1}
-gimp_glow[0] $9,0,0
-elif {$8==2} --gimp_highpass[0] {$9*3},2,1,0,0
-if {{$22==1}&&{$21!=9}} -reverse[1,2] -endif
-reverse[0,1] -gimp_compose_overlay[0,1] {$9/40}
-elif {$8==3} [0] [0]
-if {{$22==1}&&{$21!=9}} -reverse[1,3] -endif
-gimp_compose_screen[1,2] 1  -gimp_gaussian_blur[1] {$9*3},0,0,1,0,0,0
-reverse[0,1] -gimp_compose_softlight[0,1] {$9/20}
-elif {$8==4}
-gimp_anisotropic_smoothing[0] 0,1.5,0.3,{$9/4},1.10,0.80,30.00,2.0,0,1,1,0,1,0
-elif {$8==5}
--gimp_mix_hsv[0] 1,0,0,1,-1,0,1,0,0,0,2,0
-if {{$22==1}&&{$21!=9}} -reverse[1,2] -endif
-tk_gimp_channel_processing[1] 1,1,0,0,4,0,{100-{$9*2.5}},256,0,1,0,2,0,0
-gimp_gaussian_blur[1] $9,0,0,1,0,0,0
-tk_gimp_channel_processing[1] 1,1,0,0,4,0,{50-{$9*2}},256,0,1,0,2,0,0
-tk_gimp_replace_color[1] 1,0,0,0,0,255,0,0,0,0
-gimp_gaussian_blur[1] {$9*2},0,0,1,0,0,0
-reverse[0,1] -gimp_compose_softlight[0,1] {0.25+{$9/150}}
-elif {$8==6}
-gimp_anisotropic_smoothing[0]  60,0.16,{{$9/50}+0.6},{{$9/9}+0.6},2.35,0.8,30,2,0,1,1,0,1
-endif
-if {$26!=0} -r $scup%,$scup% -endif
-endl -done
gimp_tk_photoillustration_preview :
-gimp_split_preview "-gimp_tk_photoillustration ${1--2}",$-1
#@gimp Polygonize [delaunay] : gimp_delaunay,gimp_delaunay_preview(0)
#@gimp : Density = float(5,0,100)
#@gimp : Edges = float(75,0,100)
#@gimp : Smoothness = float(1,0,8)
#@gimp : Background = choice(3,"Black","White","Flat random colors","Flat image colors","Original image")
#@gimp : Outline color = color(0,0,0,128)
#@gimp : Border constraints = bool(1)
#@gimp : Anti-aliasing = bool(1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/19/2015</i>.</small>")
gimp_delaunay :
-repeat @# -l[$>] -split_opacity -l[0] -to_rgb
--b $3
-gradient_norm[-1] ->=[-1] {(100-$2)/5}
-if $9 -rectangle[-1] 0,0,100%,100%,1,0xFFFFFFFF,1 -endif
-remove_pixels[-1] {100-max(0.1,$1/4)}%
-delaunay3d[-1]
-l[-1] -s3d -rm[4] -i[4] 1,100%,1,1,y -r[4] 3,100% -y -a y -endl
-if $10 -r[0] 200%,200% -*3d[1] 2 -endif
-if {$4==0} -f[0] 0
-elif {$4==1} -f[0] 255
-elif {$4==2} -f[0] 0 -l[1] -s3d -rand[-2] 0,255 -a y -endl -j3d[0] [1],0,0,0,1,2,1,0,0
-elif {$4==3} [0],[0],1,1,-1 -j3d[-1] [-2],0,0,0,1,2,1,0,0 -blend[0,-1] shapeaverage
-endif
-col3d[1] $5,$6,$7 -j3d[0] [1],0,0,0,{$8/255},1,1,0,0 -rm[1]
-if $10 -r 50%,50%,1,100%,2 -endif
-endl -a c -endl -done
gimp_delaunay_preview :
-gimp_split_preview "-gimp_delaunay $*",$-1
#@gimp Polygonize [energy] : gimp_polygonize, gimp_polygonize_preview(0)
#@gimp : Amplitude = int(300,0,2000)
#@gimp : Smoothness = float(10,0,100)
#@gimp : Minimal area = float(10,0,100)
#@gimp : X-resolution = float(10,1,256)
#@gimp : Y-resolution = float(10,1,256)
#@gimp : Outline color = color(0,0,0,255)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), link = link("Click here for a detailed description of this filter.","http://www.gimpchat.com/viewtopic.php?f=28&t=9174")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/02/2013</i>.</small>")
gimp_polygonize :
-polygonize $1,$2,{$3^2},$4,$5
-if $9 -repeat @# -l[$>]
--norm -g[-1] xy,1 -!=[-2,-1] 0 -or[-2,-1] -r[-1] 100%,100%,1,4
-replace_color[-1] 0,0,1,1,1,1,$6,$7,$8,$9
-blend alpha
-endl -done -endif
gimp_polygonize_preview :
-gimp_split_preview "-gimp_polygonize $*",$-1
#@gimp Posterized dithering : gimp_pdithered, gimp_pdithered_preview(0)
#@gimp : Gamma = float(1,0.01,5)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Quantize colors = int(20,2,255)
#@gimp : Smooth colors =float(1,0,30)
#@gimp : Mixer mode = choice( "Color Doping", "Darken","Soft Light","Grain Merge", "Multiply","Value")
#@gimp : Color intensity =float (1,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>12/29/2010</i>.</small>")
gimp_pdithered :
--apply_gamma[-1] $1 -- 128 -* $2 -+ 128 -+ $3 -blur[-1] $4 -c[-1] 0,255 -ditheredbw[-1]
-quantize[-2] $5 -to_rgb -blur_xy[-2] $6,$6
-if {$7==0} -gimp_compose_colordoping $8,0
-elif {$7==1} -gimp_compose_darken $8,0
-elif {$7==2} -gimp_compose_softlight $8,0
-elif {$7==3} -gimp_compose_grainmerge $8,0
-elif {$7==4} -gimp_compose_multiply $8,1
-elif {$7==5} -gimp_compose_value $8,1 -endif
gimp_pdithered_preview :
-gimp_split_preview "-gimp_pdithered ${1--2}",$-1
#@gimp Poster edges : gimp_poster_edges, gimp_poster_edges_preview(0)
#@gimp : Image smoothness = float(20,0,100)
#@gimp : Edge threshold = float(60,0,100)
#@gimp : Edge shade = float(5,0,30)
#@gimp : Edge thickness = float(0,0,5)
#@gimp : Edge antialiasing = float(10,0,100)
#@gimp : Posterization level = int(0,0,15)
#@gimp : Posterization antialiasing = float(0,0,100)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), link = link("Click here for a detailed description of this filter.","http://www.davidrevoy.com/article147/gmic-new-filter-poster-edges")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>David Tschumperl&#233;</i> and <i>David Revoy</i>.      Latest update: <i>11/30/2012</i>.</small>")
gimp_poster_edges :
-if $1 -bilateral 10,$1 -endif
-poster_edges ${2-7}
gimp_poster_edges_preview :
-gimp_split_preview "-gimp_poster_edges $*",$-1
#@gimp Rodilius : gimp_rodilius, gimp_rodilius_preview(1)
#@gimp : Amplitude = float(10,0,30)
#@gimp : Thickness = float(10,0,100)
#@gimp : Sharpness = float(300,0,1000)
#@gimp : Orientations = int(5,2,36)
#@gimp : Offset = float(30,0,180)
#@gimp : Smoothness = int(0,0,5)
#@gimp : Color mode = choice(1,"Darker","Lighter")
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Link = link("Click here for a video tutorial","http://www.youtube.com/watch?v=RC07VUpzwGc")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Rod/GimpChat</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>03/05/2013</i>.</small>")
gimp_rodilius :
-ac "-rodilius ${1-5,7} -repeat $6 -smooth 10,0,1,1,1,0.8,45 -sharpen 30 -done -c 0,255",$8,$9
gimp_rodilius_preview :
-gimp_split_preview "-gimp_rodilius $*",$-1
#@gimp Shapeism : gimp_shapeism, gimp_shapeism_preview(0)
#@gimp : Shape = choice(2,"Squares","Triangles","Circles","Diamond","Hexagon","Octagon","Stars","Custom")
#@gimp : Branches = int(7,3,16)
#@gimp : Thickness = float(0.38,0,1)
#@gimp : Angle = float(0,0,360)
#@gimp : Note = note("<small><b>Note:</b> Parameters <i>Branches</i>, <i>Thickness</i> and <i>Angle</i> are used only for <i>Custom</i> shapes.</small>")
#@gimp : Antialiasing = bool(1)
#@gimp : Sep = separator()
#@gimp : Scales = int(5,1,16)
#@gimp : Maximal size = int(32,1,256)
#@gimp : Minimal size = int(8,1,256)
#@gimp : Allow angle = choice(3,"0 deg.","180 deg.","90 deg.","Any")
#@gimp : Spacing = int(1,-5,5)
#@gimp : Precision = int(5,1,10)
#@gimp : Edges = float(0.5,0,2)
#@gimp : Smoothness = float(1,0,10)
#@gimp : Background = color(0,0,0,255)
#@gimp : Sep = separator(), link = link("Click here for a detailed description of this filter.","http://gimpchat.com/viewtopic.php?f=28&t=7500&sid=5b483979826903b8f8fc8fdaf1767dae")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>06/11/2013</i>.</small>")
gimp_shapeism :
-repeat @# -l[$>]
-to_rgb
--gradient_norm -b[-1] $13% -^[-1] $12 -quantize[-1] $6,0,0
100%,100%,1,2
-repeat $6
--channels[2] 100% -->[1] $> -!=[-2] 0 -or[-2,-1] -a[2,-1] c
size={if($6<=1,$7,$7+($8-$7)*$>/($6-1))}
-if {$size<1} -break -endif
-if $5 {2*$size},{2*$size} -_gimp_shapeism$1[-1] ${2-4} -r2dy[-1] $size
-else $size,$size -_gimp_shapeism$1[-1] ${2-4}
-endif
--!=[-1] 0 -expand_xy[-2,-1] 1,0 -n[-2,-1] 0,1
-if {$10<1} -dilate[-1] 3 -endif
[-1] -a[-3--1] c
-rprogress "-pack_sprites[-2,-1] 1,100,$9,$10,$11",{$>*100/$6},{($>+1)*100/$6}
-channels[-1] 0,1
-done
-rprogress 97
-rm[1]
-channels[-1] 0 --!=[-1] 0 -blend[0,-1] shapeaverage0 -*[1] 255 -a c
-i[0] 100%,100%,1,4 -fc[0] $14,$15,$16,$17
-blend alpha
-rprogress 100
-endl -done
gimp_shapeism_preview :
-gimp_print_preview ""
50%,50% -_gimp_shapeism$1[-1] ${2-4} -frame[-1] 1,1,0 ->=[-1] 50% -n[-1] 0,255 -r[-1] 100%,100%,1,4
-r[-1] [0],0,0,0.5,0.5 -or
_gimp_shapeism0 :
-f 255 -skip $*
_gimp_shapeism1 :
-polygon 3,50%,0,0,100%,100%,100%,1,1 -skip $*
_gimp_shapeism2 :
-_dt_circle {w} -rm[-2] -skip $*
_gimp_shapeism3 :
-_dt_diamond {w} -rm[-2] -skip $*
_gimp_shapeism4 :
-star3d 3,1 -*3d[-1] @{0,min(w,h)/2} -j3d[0] [-1],50%,50%,0,1,2,0 -k[0] -skip $*
_gimp_shapeism5 :
-star3d 4,1 -*3d[-1] @{0,min(w,h)/2} -j3d[0] [-1],50%,50%,0,1,2,0 -k[0] -skip $*
_gimp_shapeism6 :
-star3d 5 -*3d[-1] @{0,min(w,h)/2} -j3d[0] [-1],50%,50%,0,1,2,0 -k[0] -skip $*
_gimp_shapeism7 :
-star3d $1,$2 -*3d[-1] @{0,min(w,h)/2} -r3d[-1] 0,0,1,$3 -j3d[0] [-1],50%,50%,0,1,2,0 -k[0]
#@gimp Warhol : warhol, warhol(1)
#@gimp : X-tiles = int(3,1,10)
#@gimp : Y-tiles = int(3,1,10)
#@gimp : Smoothness = float(2,0,10)
#@gimp : Color = float(40,0,60)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp Watercolor : gimp_watercolor, gimp_watercolor_preview(1)
#@gimp : Sep = separator(), note = note("General settings:")
#@gimp : Color intensity = float(1.8,0,4)
#@gimp : Light colors = float(0.1,0,1)
#@gimp : Dark colors = float(1,0,10)
#@gimp : Sep = separator(), note = note("Line art settings:")
#@gimp : Line art details = float (80,50,100)
#@gimp : Line art smoothness = float(0,0,10)
#@gimp : Line art strength = float(0.5,0,1)
#@gimp : Line art style = choice("pencil","ink","comic style")
#@gimp : Line art fade = float(0,0,100)
#@gimp : Sep = separator(), note = note("Color brushes settings:")
#@gimp : Brush style = choice("modern","classic","abstract","line","smooth")
#@gimp : Cyan brush size = float(2,0,50)
#@gimp : Cyan stroke strength = float(0,-5,5)
#@gimp : Cyan edge distance = float(2,0,10)
#@gimp : Cyan abstraction = float(4,0,10)
#@gimp : Magenta brush size = float(2,0,50)
#@gimp : Magenta stroke strength = float(0,-5,5)
#@gimp : Magenta edge distance = float(3,0,10)
#@gimp : Magenta abstraction = float(3,0,10)
#@gimp : Yellow brush size = float(2,0,50)
#@gimp : Yellow stroke strength = float(0,-5,5)
#@gimp : Yellow edge distance = float(4,0,10)
#@gimp : Yellow abstraction = float(2,0,10)
#@gimp : Sep = separator(), note = note("Paper and ambience settings:")
#@gimp : Paper color black = bool(0)
#@gimp : Add paper texture = bool(0)
#@gimp : Invert colors = bool(0)
#@gimp : Ambient light = float(0,-50,50)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Authors : <i>Tom Keil and Arto Huotari </i>       Latest update: <i>02/19/2011</i>.</small>")
#@gimp : Note = link("Tutorial download","http://www.slideshare.net/ArtoHuotari/gmig-water-color-filter-tutorial")
#@gimp : Note = link("Video demonstration here","http://vimeo.com/19713850")
gimp_watercolor :
-repeat @# -l[$>] -split_opacity -l[0]
-if {$7==0} --gimp_gradient_norm $5,0.5,{99.99-$4},$4,1,0
-elif {$7==1} --gimp_edges {$5/3.5},{95-$4},0,0
-elif {$7==2} --gimp_edges {$5/3.5},{95-$4},0,0
--gimp_mix_hsv[0] 1,0,0,1,-1,0,1,0,0,0,2,0
-tk_gimp_channel_processing[2] 1,1,0,{$5/10},4,{{$4-50}*2},100,256,0,0,0,2,7,0
-reverse[1,2] -gimp_compose_multiply[1,2] {0.5+{$6/2}}
-endif -gimp_frame_round[1] 5,$8,15,0,255,255,255,255,0,0.1,3
-gimp_anisotropic_smoothing[0]
60,0.16,{{20/50}+0.6},{{20/9}+0.6},2.35,0.8,30,2,0,1,1,0,1
[0] --negative[0] -move[1] 4
-gimp_gaussian_blur[2] {{w+h}/100},0,0,1,0,0,0
-gimp_compose_dodge[1,2] 1
-gimp_mix_lab[0] 1,0,0,$1,0,0,$1,0,0,0,2,0
-reverse[0,1]
-gimp_compose_colorburn[0,1] $2
--luminance[0] -reverse[1,2]
-tk_gimp_channel_processing[1] 1,1,0,0,4,{$3*5},100,256,0,0,0,2,0,0
-gimp_gaussian_blur[1] $3,0,0,1,0,0,0
-tk_gimp_channel_processing[1] 1,1,0,0,4,0,99,256,0,1,0,2,0,0
-tk_gimp_replace_color[1] 1,0,255,255,255,255,0,0,0,0
-gimp_spread[1] {$3*2},{$3*2},0,0
-gimp_gaussian_blur[1] {{w+h}/1000},0,0,1,0,0,0
-reverse[0,1] -gimp_compose_multiply[0,1] 1
-split[0] c
-if {$9==0} --negative[0] --negative[1] --negative[2]
-elif {$9==1} --fill_color[0] 255,255,255 --fill_color[0] 255,255,255
--fill_color[0] 255,255,255
-elif {$9==2} --fill_color[0] 255,255,255 --fill_color[0] 255,255,255
--fill_color[0] 255,255,255
-elif {$9==3} --gimp_edges[0] {$10/5},{$13*5},1,0
--gimp_edges[1] {$14/5},{$17*5},1,0 --gimp_edges[2] {$18/5},{$21*5},1,0
-elif {$9==4} --negative[0] --negative[1] --negative[2] -endif
-tk_gimp_channel_processing[0] 1,{{$11/5}+1},{$11/50},0,0,0,100,256,0,0,0,2,0,0
-if {$9!=2}
-gimp_gaussian_blur[0] $10,0,0,1,0,0,0
-else -cubism[0] 300,{$13*5},{$13*36},1,{$10/50} -endif
-if {$9==0}
-tk_gimp_channel_processing[-3] 1,{{$11/5}+1},{$11/50},0,0,0,100,256,0,0,0,2,0,0
-cubism[-3] 300,{$13*5},{$13*36},1,{$10/50} -endif
-if {$9==4}
-tk_gimp_channel_processing[-3] 1,{{$11/5}+1},{$11/50},0,0,0,100,256,0,0,0,2,0,0
-gimp_painting[-3] $13,1.5,2 -endif
-gimp_frame_fuzzy[-3] {$12*5},{$12*5},{$13*20},{$10/2},0,0,0,255
-tk_gimp_channel_processing[1] 1,{{$15/5}+1},{$15/50},0,0,0,100,256,0,0,0,2,0,0
-if {$9!=2}
-gimp_gaussian_blur[1] $14,0,0,1,0,0,0
-else -cubism[1] 300,{$17*5},{$17*36},1,{$14/50} -endif
-if {$9==0}
-tk_gimp_channel_processing[-2] 1,{{$15/5}+1},{$15/50},0,0,0,100,256,0,0,0,2,0,0
-cubism[-2] 300,{$17*5},{$17*36},1,{$14/50} -endif
-if {$9==4}
-tk_gimp_channel_processing[-2] 1,{{$15/5}+1},{$15/50},0,0,0,100,256,0,0,0,2,0,0
-gimp_painting[-2] $17,1.5,2 -endif
-gimp_frame_fuzzy[-2] {$16*5},{$16*5},{$17*20},{$14/2},0,0,0,255
-tk_gimp_channel_processing[2] 1,{{$19/5}+1},{$19/50},0,0,0,100,256,0,0,0,2,0,0
-if {$9!=2}
-gimp_gaussian_blur[2] $18,0,0,1,0,0,0
-else -cubism[2] 300,{$21*5},{$21*36},1,{$18/50} -endif
-if {$9==0}
-tk_gimp_channel_processing[-1] 1,{{$19/5}+1},{$19/50},0,0,0,100,256,0,0,0,2,0,0
-cubism[-1] 300,{$21*5},{$21*36},1,{$18/50} -endif
-if {$9==4}
-tk_gimp_channel_processing[-1] 1,{{$19/5}+1},{$19/50},0,0,0,100,256,0,0,0,2,0,0
-gimp_painting[-1] $21,1.5,2  -endif
-gimp_frame_fuzzy[-1] {$20*5},{$20*5},{$21*20},{$18/2},0,0,0,255
-to_gray[-1] -to_gray[-2] -to_gray[-3] -to_rgba[0] -to_rgba[1] -to_rgba[2]
-split[0] c -reverse[3,-3] -compose_multiply[3,-3] -append[0,1,2,3] c
-split[1] c -reverse[4,-2] -compose_multiply[4,-2] -append[1,2,3,4] c
-split[2] c -reverse[5,-1] -compose_multiply[5,-1] -append[2,3,4,5] c
-if {$22==0} --fill_color[0] 255,255,255 -else --fill_color[0] 0 -endif
-reverse[0,-1]  -compose_rgba[0,-1]
-if {$22==0} --fill_color[1] 255,255,255 -else --fill_color[1] 0 -endif
-reverse[1,-1] -compose_rgba[1,-1]
-if {$22==0} --fill_color[2] 255,255,255 -else --fill_color[2] 0 -endif
-reverse[2,-1] -compose_rgba[2,-1]
-to_gray[0] -to_gray[1] -to_gray[2] -append[0,1,2] c
-if {$23==1} -gimp_paper 0,0 -endif
-if {$24==1} -negative[0] -endif
-gimp_mix_lab 1,$25,0,1,0,0,1,0,0,0,2,0
-reverse[0,1] -gimp_compose_multiply[0,1] $6
-endl -a c -endl -done
gimp_watercolor_preview :
-gimp_split_preview "-gimp_watercolor ${1--2}",$-1
#@gimp Whirl drawing : draw_whirl, gimp_draw_whirl_preview(0)
#@gimp : Amplitude = float(20,0,100)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_draw_whirl_preview :
-gimp_split_preview "-draw_whirl $*",$-1
#@gimp _
#@gimp <b>Black &amp; white</b>
#@gimp B&amp;W stencil : gimp_stencilbw, gimp_stencilbw_preview(0)
#@gimp : Threshold = float(10,0,30)
#@gimp : Smoothness = float(10,0,30)
#@gimp : Hue = float(0,0,360)
#@gimp : Saturation = float(0,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_stencilbw :
-stencilbw $1,$2
-if {$3||$4} -repeat @# -l[$>] -split_opacity
-/[0] 255 -i[0] 100%,100%,1,1,$4 -i[0] 100%,100%,1,1,$3 -a[0-2] c -hsv2rgb[0]
-a c -endl -done -endif
gimp_stencilbw_preview :
-gimp_split_preview "-gimp_stencilbw $*",$-1
#@gimp Black &amp; white : gimp_blackandwhite, gimp_blackandwhite_preview(1)
#@gimp : Red level = float(0.299,0,1)
#@gimp : Red smoothness = float(0,0,10)
#@gimp : Green level = float(0.587,0,1)
#@gimp : Green smoothness = float(0,0,10)
#@gimp : Blue level = float(0.114,0,1)
#@gimp : Blue smoothness = float(0,0,10)
#@gimp : Sep = separator()
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Hue = float(0,0,360)
#@gimp : Saturation = float(0,0,1)
#@gimp : Sep = separator()
#@gimp : Grain (shadows) = float(0,0,200)
#@gimp : Grain (midtones) = float(0,0,200)
#@gimp : Grain (highlights) = float(0,0,200)
#@gimp : Grain tone fading = float(2,0,10)
#@gimp : Grain scale = float(0,0,3)
#@gimp : Grain type = choice("Gaussian","Uniform","Salt and pepper","Poisson")
#@gimp : Sep = separator()
#@gimp : Local contrast = float(0,0,60)
#@gimp : Radius = int(16,1,512)
#@gimp : Contrast smoothness = float(4,0,10)
#@gimp : Sep = separator()
#@gimp : Pseudo-gray dithering = int(0,0,5)
#@gimp : Use maximum tones = bool(false)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>02/20/2013</i>.</small>")
gimp_blackandwhite :
-repeat @#
-l[-1] -split_opacity -rv -to_rgb[-1] -s[-1] c
-*[-3] $1 -b[-3] $2%
-*[-2] $3 -b[-2] $4%
-*[-1] $5 -b[-1] $6%
-+[-3--1] -/[-1] {$1+$3+$5} -c[-1] 0,255
-apply_gamma[-1] {10^$7}
--[-1] 128 -*[-1] $8 -+[-1] 128 -+[-1] $9 -c[-1] 0,255
-if {$12||$13||$14}
100%,100% [-1]x2
-noise[-3] 100,$17 -b[-3] $16% -n[-3] -$12,$12
-noise[-2] 100,$17 -b[-2] $16% -n[-2] -$13,$13
-noise[-1] 100,$17 -b[-1] $16% -n[-1] -$14,$14
--tones[-4] 3 -b[-3--1] $15%
-*[-6,-3] -*[-4,-2] -*[-2,-1]
-+[-4--1] -c[-1] 0,255
-endif
-if {$10||$11}
-/[-1] 255
-i[-2] 100%,100%,1,1,$11
-i[-3] 100%,100%,1,1,$10
-a[-3--1] c -hsv2rgb[-1]
-endif
-rv -a c -endl -mv[-1] 0 -done
-if $18 -normalize_local $18,$19,$20,2%,1,0,255 -endif
-if $22 -n 0,255 -endif
-if $21 -to_pseudogray $21,1 -endif
gimp_blackandwhite_preview :
-gimp_split_preview "-gimp_blackandwhite $*",$-1
#@gimp Charcoal : gimp_charcoal, gimp_charcoal_preview(0)
#@gimp : Granularity = int(65,0,800)
#@gimp : Lowlights crossover point = int(70,0,255)
#@gimp : Highlights crossover point = int(170,0,255)
#@gimp : Boost contrast = bool(0)
#@gimp : Resize image for optimum effect = bool(1)
#@gimp : Add chalk highlights = bool(0)
#@gimp : Minimal highlights = int(50,0,255)
#@gimp : Maximal highlights = int(70,0,255)
#@gimp : Background color = color(255,255,255)
#@gimp : Foreground color = color(0,0,0)
#@gimp : Invert background/foreground = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>03/17/2011</i>.</small>")
#@gimp : Note = note("<small>Inspired from the Charcoal script by <i>micomicon</i> :</small>")
#@gimp : Link = link("http://registry.gimp.org/node/25078")
gimp_charcoal :
-repeat @# -l[$>] -split_opacity -l[0]
-compose_channels max
w={w} h={h}
-if $5 -r[-1] 150%,150%,1,1,6 -endif
-if $4 -equalize[-1] -n[-1] 0,255 -endif
-sharpen {$1*3} -cut 0,255
-if $6 --ir $7,$8 -endif
-ir[0] $2,$3
-if {!$15} -==[0] 0 -endif
-or
--*[0] $10 --*[0] $11 -*[0] $9
-a[-3--1] c -replace_color 0,0,0,0,0,$12,$13,$14
-r $w,$h,1,100%,2
-endl -a c -endl -done
gimp_charcoal_preview :
-gimp_split_preview "-gimp_charcoal $*",$-1
#@gimp Colorize [comics] : gimp_colorize_comics, gimp_colorize_comics_preview(1)
#@gimp : Note = note("<b>Layers ordering:</b>")
#@gimp : Input layers = choice{0,"Color spots + lineart","Lineart + color spots","Color spots + extrapolated colors + lineart","Lineart + color spots + extrapolated colors"}
#@gimp : Output layers = _choice{1,"Single (merged)","Extrapolated colors + lineart","Lineart + extrapolated colors","Color spots + extrapolated colors + lineart","Lineart + color spots + extrapolated colors"}
#@gimp : Extrapolate colors as = choice("One layer","Two layers","Three layers","Four layers","Five layers","Six layers","Seven layers","Eight layers","Nine layers","Ten layers","One layer per single color","One layer per single region")
#@gimp : Sep = separator()
#@gimp : Smoothness = float(0.05,0,1)
#@gimp : Sep = separator(), note = note{"<small><b>Note:</b> You probably need to select <i>All</i> for the <i>Input layers</i> option on the left.\n
#@gimp : <i>color spots</i> = your layer with color indications.\n
#@gimp : <i>lineart</i> = your layer with line-art (b&amp;w or transparent).\n
#@gimp : <i>extrapolated colors</i> = the G'MIC generated layer with flat colors.\n\n
#@gimp : <b>Warnings:</b>
#@gimp : \n  - Do not rely too much on the preview, it is probably not accurate !
#@gimp : \n  - Activate option <i>Extrapolate color as one layer per single color/region</i> only if you have <i>a lot</i> of available memory !
#@gimp : </small>"}
#@gimp : Sep = separator(), link = link("Click here for a detailed description of this filter.","http://www.gimpchat.com/viewtopic.php?f=28&t=7567")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>David Tschumperl&#233;</i>, <i>Timoth&#233;e Giet</i> and <i>David Revoy</i>.      Latest update: <i>06/19/2013</i>.</small>")
gimp_colorize_comics :
-if {@#<2} -return -endif
-if {$1<2} selection=0,1 -else selection=0,1,2 -endif
-l[$selection]
-if {$1==0}
-elif {$1==1} -rv
-elif {$1==2} -rm[1]
-elif {$1==3} -rm[2] -rv
-endif
--to_rgba[0] -split_opacity[-1] -+[-2] 1 -!=[-1] 0 -*[-2,-1]
--norm[1] -n[-1] 0,1 --histogram[-1] 2,0,1
-if {i(0)>i(1)} -*[-2] -1 -+[-2] 1 -endif -rm[-1]
-b[-1] $4% -watershed[-2] [-1] -rm[-1]
--[-1] 1
-if {$2==0} -rm[0] -rv -blend[0,1] multiply ind=-1
-elif {$2==1} -rm[0] -rv ind=0
-elif {$2==2} -rm[0] ind=1
-elif {$2==3} -rv[1,2] ind=1
-elif {$2==4} -rv[0,1] ind=2
-endif
-if {$3&&$ind>=0} -l[$ind]
--mix_channels (65536,256,1)
-if {$3==10} -do
iM=@{1,M}
-if {$iM>=0}
--==[1] $iM area=@{-1,+} -replace[1] $iM,-1
--r[-1] 100%,100%,1,3 -*[-1] [0]
-rv[-2,-1] -*[-1] 255 -a[-2,-1] c -nm[-1] $area
-endif
-while {$iM>=0} -else
-label[-1]
-if {$3<10} -%[-1] {$3+1} -endif
-repeat {iM+1} --==[1] $< area=@{-1,+} --r[-1] 100%,100%,1,[0] -*[-1] [0] -rv[-2,-1] -*[-1] 255 -a[-2,-1] c -nm[-1] $area -done
-endif
-rm[0,1]
-sort_list +,n
-endl -endif
-endl
gimp_colorize_comics_preview :
-gimp_colorize_comics $1,0,$3,$4
#@gimp Colorize [interactive] : gimp_colorize_interactive, gimp_colorize_interactive_preview
#@gimp : Input type = _choice("B&W photograph","Lineart")
#@gimp : Output type = _choice{"Colorized image (1 layer)","Colors only (1 layer)","Image + Colors (2 layers)","Image + Colors (multi-layers)"}
#@gimp : View resolution = _choice{1,"Small (faster)","Medium","High (slower)","Very high (even slower)"}
#@gimp : 1st additional palette (.gpl file) = _file("")
#@gimp : 2nd additional palette (.gpl file) = _file("")
#@gimp : Sep = separator()
#@gimp : Note = note{"<small><b>Description:</b>\n
#@gimp : This filter allows to quickly colorize a B&amp;W image or lineart.
#@gimp : Click on the <i>Apply</i> or <i>OK</i> buttons below to open the G'MIC interactive window and start adding color control points.
#@gimp : When you're done, exit the interactive window: your colored result will be transfered back to GIMP.\n\n
#@gimp : If you are not satisfied with the result, <i>Undo it (CTRL+Z)</i>, and click on <i>Apply</i> once again to modify your control points defined previously.
#@gimp : To clear all control points, click on the <i>Reset</i> button below.
#@gimp : </small>"}
#@gimp : Clear control points = button(0.5)
#@gimp : Last image size = const(0,0)
#@gimp : Control points = const(-1)
#@gimp : Sep = separator()
#@gimp : Note = note{"<small><b>Interactions:</b>\n
#@gimp : Use the following actions in the interactive window to manage your colorization :\n\n
#@gimp : - <b>Left mouse button</b> creates a new color control point (or move an existing one).\n
#@gimp : - <b>Right mouse button</b> over a control point deletes it.\n
#@gimp : - <b>Right mouse button</b> anywhere else picks a color from the image.\n
#@gimp : - <b>Mouse wheel</b>, or keys <b>CTRL+arrows up/down</b> zoom view in/out.\n
#@gimp : - <b>CTRL+mouse wheel</b>, <b>SHIFT+wheel</b> or arrow keys move image in zoomed view.\n
#@gimp : - Key <b>SPACE</b> updates the extrapolated color field.\n
#@gimp : - Key <b>TAB</b> toggles markers view modes.\n
#@gimp : - Key <b>BACKSPACE</b> deletes the last control point added.\n
#@gimp : - Key <b>PAGE UP</b> increases image contrast.\n
#@gimp : - Key <b>PAGE DOWN</b> decreases image contrast.\n
#@gimp : - Key <b>R</b> enters/exits color replace mode.\n
#@gimp : - Keys <b>CTRL+D</b> increase window size.\n
#@gimp : - Keys <b>CTRL+C</b> decrease window size.\n
#@gimp : - Keys <b>CTRL+R</b> resets window size.\n
#@gimp : - Keys <b>ESC</b>, <b>Q</b> or <b>ENTER</b> exit the interactive window.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>You can find more information on how to use this filter here :</small>")
#@gimp : Link = link("David Revoy's G'MIC Colorization Page","http://www.davidrevoy.com/article240/gmic-line-art-colorization")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/09/2014</i>.</small>")
gimp_colorize_interactive :
N=@#
resolution={arg(1+$3,512,1024,2048,0)}
-nm "[G"{`39`}"MIC] Colorize"
-if {$8==-1" || "$7!=w" || "$8!=h} _gimp_control_points= -else _gimp_control_points=${9--1} -endif
-l[] 0 -nm[-1] "$4" ext=@{-1,x} -rm -if {$ext'=='gpl} -input_gpl "$4" -endif -onfail -rm -endl
-l[] 0 -nm[-1] "$5" ext=@{-1,x} -rm -if {$ext'=='gpl} -input_gpl "$5" -endif -onfail -rm -endl
-if {@#==$N+2}
-repeat {@#-2} status=@{-x_colorize[$>]\ $1,$resolution,$2,[-2],[-1]} -done
-rm[-2,-1]
-elif {@#==$N+1}
-repeat {@#-1} status=@{-x_colorize[$>]\ $1,$resolution,$2,[-1]} -done
-rm[-1]
-else
-repeat @# status=@{-x_colorize[$>]\ $1,$resolution,$2} -done
-endif
-if {$2==1} -repeat @# -l[$<]
-channels {s-3},{s-1}
-endl -done
-elif {$2>=2} -repeat @# -l[$<]
--channels {s-3},{s-1} -channels[-2] 0,@{0,s-4}
-endl -done
-if {$2>=3} -split_colors[1] 0,256,8 -endif
-endif
-u \{$1\}\{$2\}\{$3\}\{"$4"\}\{"$5"\}\{0\}\{{w},{h}\}\{$status\}
gimp_colorize_interactive_preview :
-if $6
-gimp_print_preview "No preview\n  available",,"(Control points cleared)"
-u \{$1\}\{$2\}\{$3\}\{"$4"\}\{"$5"\}\{0\}\{{w},{h}\}\{-1\}
-else -gimp_no_preview ,
-endif
#@gimp Colorize [photographs] : gimp_recolorize, gimp_recolorize_preview(1)
#@gimp : Smoothness = int(2,0,6)
#@gimp : Anisotropy = float(0.2,0,1)
#@gimp : Output mode = choice("Merge brightness/colors","Split brightness/colors")
#@gimp : Sep = separator()
#@gimp : Note = note{"<small><b>Note:</b> This filter needs two layers to work properly. The bottom layer must be a B&amp;W image, while the
#@gimp : top layer contains color patches that will be extrapolated in a smart way (edge-directed) to fill the entire image. At the end,
#@gimp : you get a completely recolored image.</small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/16/2013</i>.</small>")
gimp_recolorize :
-repeat {int(@#/2)}
-if $3 s=$>,{$>+1} -else s={2*$>},{2*$>+1} -endif
-l[$s] -rv[0,1]
-channels[0] 0 -to_rgb[-2]
-to_rgba[-1] -split_opacity[-1] -!=[-1] 0
-srgb2rgb[-3,-2] -rgb2lab8[-3,-2] -channels[-3] 0 -channels[-2] 1,2
-+[-2] 1 -*[-2] [-1] --gradient_norm[-3] -*[-1] -1 -watershed[-3] [-1] -rm[-1] --[-2] 1
--diffusiontensors[-3] $2,1,0.5,0.5 -==[-2] 0 -*[-1] [-2] -rm[-2]
-smooth[-2] [-1],{$1*80},0.8,60 -rm[-1]
-a[-2,-1] c -lab82rgb[-1] -rgb2srgb[-1]
-if $3 -rgb2hsv[-1] -s[-1] c -i[2] 100%,100%,1,1,1 -i[3] 100%,100%,1,2,0 -a[0-2] c -a[^0] c -hsv2rgb -rv -endif
-endl
-done
gimp_recolorize_preview :
-gimp_recolorize $* -a x
#@gimp Colorize [with colormap] : gimp_bwrecolorize, gimp_bwrecolorize_preview
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Normalize = bool(0)
#@gimp : Sep = separator()
#@gimp : Gradient preset = choice("User-defined","Black to white","White to black","Sepia","Solarize")
#@gimp : Interpolation type = choice(1,"Nearest","Linear","Cubic","Lanczos")
#@gimp : Preserve initial brightness = bool(0)
#@gimp : Sep = separator(), note = note("<small><u>User-defined gradient :</u></small>")
#@gimp : Number of tones = int(5,2,8)
#@gimp : 1st tone = color(0,0,0,255)
#@gimp : 2nd tone = color(43,25,55,255)
#@gimp : 3rd tone = color(158,137,189,255)
#@gimp : 4th tone = color(224,191,228,255)
#@gimp : 5th tone = color(255,255,255,255)
#@gimp : 6th tone = color(255,255,255,255)
#@gimp : 7th tone = color(255,255,255,255)
#@gimp : 8th tone = color(255,255,255,255)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_bwrecolorize :
-remove_opacity
-if $4 -n 0,255 -endif
-if {$5==0}
(${9--2}) -r[-1] 4,$8,1,1,-1 -permute[-1] yzcx
-elif {$5==1}
(0,255^0,255^0,255^255,255)
-elif {$5==2}
(255,0^255,0^255,0^255,255)
-elif {$5==3}
(0,44,115,143,196,244^0,20,84,119,184,235^0,5,44,73,144,200^255,255,255,255,255,255)
-else
(0,359^1,1^1,1^255,255) -r[-1] 256,1,1,4,3 -sh[-1] 0,2 -hsv2rgb[-1] -rm[-1]
-endif
-if {$6==0} -r[-1] 256,1,1,4,1
-elif {$6==1} -r[-1] 256,1,1,4,3
-elif {$6==2} -r[-1] 256,1,1,4,5 -c[-1] 0,255
-else -r[-1] 256,1,1,4,6
-endif
-if {$7==1} -sh[-1] 0,2 -rgb2hsv[-1] -sh[-1] 2,2 -f[-1] x/w -hsv2rgb[-2] -rm[-2,-1] -endif
-l[^-1] -luminance -apply_gamma {10^$1} -- 128 -* $2 -+ {$3+128} -c 0,255 -endl -map[^-1] [-1] -rm[-1]
gimp_bwrecolorize_preview :
-gimp_split_preview "-gimp_bwrecolorize ${^0}",$-1
#@gimp Dithering : gimp_ditheredbw, gimp_ditheredbw_preview(0)
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Hue = float(0,0,360)
#@gimp : Saturation = float(0,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_ditheredbw :
-repeat @# -l[$>] -split_opacity -l[0]
-luminance -n 0,255 -apply_gamma {10^$1} -- 128 -* $2 -+ 128 -+ $3 -b $4 -c 0,255 -ditheredbw
-if {$5||$6} -/ 255 -i[0] 100%,100%,1,2 -fc[0] $5,$6 -a c -hsv2rgb -endif
-endl -a c -endl -done
gimp_ditheredbw_preview :
-gimp_split_preview "-gimp_ditheredbw $*",$-1
#@gimp Engrave : gimp_engrave, gimp_engrave_preview(0)
#@gimp : Note = note("<small><b>Black &amp; White foreground:</b></small>")
#@gimp : Radius = float(0.5,0,2)
#@gimp : Density = float(50,0,200)
#@gimp : Edges = float(0,0,10)
#@gimp : Coherence = float(8,0,40)
#@gimp : Threshold (%) = float(40,0,100)
#@gimp : Minimal area = int(0,-256,256)
#@gimp : Flat regions removal = float(0,0,10)
#@gimp : Sep = separator(), note = note("<small><b>Color background:</b></small>")
#@gimp : Add color background = bool()
#@gimp : Quantization = float(10,0,40)
#@gimp : Shading = int(1,0,5)
#@gimp : Brightness (%) = float(0,-255,255)
#@gimp : Contrast (%) = float(0,0,100)
#@gimp : Vibrance (%) = float(0,0,100)
#@gimp : Sep = separator()
#@gimp : Anti-aliasing = choice(1,"Disabled","x1.5","x2","x3")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Lyle Kroll</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>03/13/2015</i>.</small>")
gimp_engrave :
f={arg(1+$14,1,1.5,2,3)}
r={$f*(0.2+$1)}
-repeat @# -l[$<]
nm=@{-gimp_layer_name} pos=@{-gimp_layer_pos}
-if $8 [0] -endif
-l[0] -split_opacity -l[0]
wh={w},{h}
-norm
-if $14 -r {100*$f}%,{100*$f}%,1,1,3 -endif
-if {$7>0} [0] -endif
-l[0]
amount={(0.5+$2)^2}
-repeat 5 -b $r -unsharp $r,{1+$2} -c 0,255 -done
-smooth 100,0.1,1,{$f*$3},{$f*$4}
->= {100-$5}%
-endl
-if {$7>0}
-gradient_norm[1] -b[1] $3 -lt[1] $7 -max[0,1]
-endif
-if {$6<0} -area_fg 0,0 -gt {$f*$6*$6}
-elif {$6>0} -== 0 -area_fg 0,0 -gt {$f*$6*$6} -== 0
-endif
-* 255
-if $14 -r $wh,1,1,2 -endif
-endl -a c -endl
-if {@#>1}
-l[1] -split_opacity -l[0]
f={arg(1+$14,1,1.5,2,3)}
-if $14 -r {100*$f}%,{100*$f}%,1,100%,3 -endif
-b {$f*$9} -segment_watershed 5
-if $14 -r $wh,1,100%,2 -endif
-repeat $10 -guided 10,{$10*80} -done
-apply_channels "-apply_curve 1,0,0,64,{64-128*$12%},128,128,192,{192+128*$12%},255,255",lab_l,1
-apply_channels "-apply_curve 1,0,0,64,{64-128*$13%},128,128,192,{192+128*$13%},255,255",lab_ab,1
-+ {255*$11%} -c 0,255
-endl -a c -endl
-nm[0] mode(darken),name($nm),pos($pos)
-nm[1] name($nm" [colors]"),pos($pos)
-endif
-endl -done
gimp_engrave_preview :
-repeat @# -l[$<]
-gimp_split_preview "-nm foo -gimp_engrave $* -gimp_merge_layers",$-1
-endl -done
#@gimp Hard sketch : gimp_hardsketchbw, gimp_hardsketchbw_preview(0)
#@gimp : Amplitude = float(300,0,4000)
#@gimp : Density = float(50,0,100)
#@gimp : Smoothness = float(1,0,10)
#@gimp : Opacity = float(0.1,0,1)
#@gimp : Edge = float(20,0,100)
#@gimp : Fast approximation = bool(0)
#@gimp : Color model = choice("Black on white","White on black","Black on transparent white","White on transparent black","Color on white")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_hardsketchbw :
-b $3
-if {$7==4} -repeat @# -l[$>] --hardsketchbw $1,$2,$4,$5,$6 -blend hardlight -endl -done -return -endif
-hardsketchbw $1,$2,$4,$5,$6
-if {$7&1} -negative -endif
-if {$7==2} -r 100%,100%,1,4 -repeat @# -sh[$>] 3,3 -*[-1] -2 -+[-1] {2*255} -c[-1] 0,255 -rm[-1] -done
-elif {$7==3} -r 100%,100%,1,4 -repeat @# -sh[$>] 3,3 -*[-1] 2 -c[-1] 0,255 -rm[-1] -done
-endif
gimp_hardsketchbw_preview :
-gimp_split_preview "-gimp_hardsketchbw $*",$-1
#@gimp Hard sketch xy : XY_hardsketchbw_samj_en, XY_hardsketchbw_samj_en(0)
#@gimp : Sep = separator(), note = note("<small>Parameters - Hard Sketch BW</small>")
#@gimp : Xy = float(0.2,0,1)
#@gimp : Amplitude = float(300,0,4000)
#@gimp : Density = float(50,0,100)
#@gimp : Smoothness = float(1,0,10)
#@gimp : Opacity = float(0.1,0,1)
#@gimp : Edge = float(20,0,100)
#@gimp : Fast approximation = bool(0)
#@gimp : Color model = choice("Black on white","White on black","Black on transparent white","White on transparent black","Color on white")
#@gimp : Sep = separator(), note = note("<small>Layers</small>")
#@gimp : Nb. = choice(0,"1 : XY","2 : XY + Hard Sketch BW Normal")
#@gimp : Sep = separator(), note = note("<small>Sharpen</small>")
#@gimp : Octave sharpening = bool(0)
#@gimp : Sep = separator(), note = note("<small>XY_hardsketch Color</small>")
#@gimp : Color = color(180,40,160,255)
#@gimp : Fill = bool(0)
#@gimp : Sep = separator(), note = note("samj      Update : <i>2015/03/10</i>.</small>")
XY_hardsketchbw_samj_en :
-XY_hardsketchbw_samj $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15
#@gimp Hough sketch : gimp_houghsketchbw, gimp_houghsketchbw_preview(0)
#@gimp : Smoothness = float(1.25,0,10)
#@gimp : Density = float(10,0,70)
#@gimp : Radius = int(5,0,30)
#@gimp : Threshold = float(80,0,100)
#@gimp : Opacity = float(0.1,0,1)
#@gimp : Color model = choice("Black on white","White on black","Black on transparent white","White on transparent black","Color on white")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>05/18/2011</i>.</small>")
gimp_houghsketchbw :
-b $1 -n 0,255
-if {$6==4} -repeat @# -l[$>] --houghsketchbw ${2-5} -blend hardlight -endl -done -return -endif
-houghsketchbw ${2-5}
-if {$6&1} -negative -endif
-if {$6==2} -r 100%,100%,1,4 -repeat @# -sh[$>] 3,3 -*[-1] -2 -+[-1] {2*255} -c[-1] 0,255 -rm[-1] -done
-elif {$6==3} -r 100%,100%,1,4 -repeat @# -sh[$>] 3,3 -*[-1] 2 -c[-1] 0,255 -rm[-1] -done
-endif
gimp_houghsketchbw_preview :
-gimp_split_preview "-gimp_houghsketchbw $*",$-1
#@gimp Ink wash : gimp_ink_wash, gimp_ink_wash(0)
#@gimp : Note = note("Ink wash controls")
#@gimp : Size = float(0.14,0,4)
#@gimp : Amplitude = float(23,0,200)
#@gimp : Sep = separator()
#@gimp : Note = note("Check if you wish visual control on this step")
#@gimp : Skip all other steps = bool(false)
#@gimp : Note = note ("UNcheck to reactivate the other controls")
#@gimp : Sep = separator()
#@gimp : Smoother sharpness = float(0.5,0,2)
#@gimp : Smoother edge protection = float(0.54,0,1)
#@gimp : Smoother softness = float(2.25,0,10)
#@gimp : Sep = separator()
#@gimp : Stretch contrast = choice("None","Automatic","Automatic & Contrast Mask","Manual Controls")
#@gimp : Note = note ("To activate the sliders below chose 'Manual Controls'")
#@gimp : Sep = separator()
#@gimp : Ln amplititude = float(2,0,60)
#@gimp : Ln size = float(6,0,64)
#@gimp : Ln neightborhood-smoothness = float(5,0,40)
#@gimp : Ln average-smoothness = float(20,0,40)
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update: <i>04/05/2011</i>.</small>")
#@gimp : Note = link(0,"Forum thread about the filter discussion","http://gimpchat.com/viewtopic.php?f=10&t=914")
gimp_ink_wash :
-repeat @# -l[$>] -split_opacity -l[0]
-gimp_pencilbw[-1] $1,$2,0,0,0
-if {$3==1} -continue
-elif {$3==0} -gimp_anisotropic_smoothing[-1] 60,$4,$5,$6,1.1,0.8,30,2,0,1,1,0,1,16
-endif
-if {$7==1} -normalize_local[-1] 2,6,5,24,1,0,255
-elif {$7==2}  -normalize_local[-1] 2,6,5,24,1,0,255 -gimp_contrast_swm 2,0,0.512
-elif {$7==3} -gimp_normalize_local[-1] $8,$9,$10,$11,1,3,0
-endif
-endl -a c -endl -done
#@gimp Multi-layer etch : gimp_gcd_layeretch, gimp_gcd_layeretch(2)
#@gimp : Note = note("<u>Etch with selectable number of layers</u>")
#@gimp : Note = note("<b>Warning: With high number of layers this can be VERY slow!</b>")
#@gimp : Sep = separator()
#@gimp : Total layers = int(11,2,16)
#@gimp : White layers = int(4,1,15)
#@gimp : Etch tones = int(12,2,32)
#@gimp : Tone blur = float(0.12,0,1)
#@gimp : Noise level = int(100,5,200)
#@gimp : Dark length = float(8.5,0,20)
#@gimp : Bright length = float(5,0,20)
#@gimp : Start angle = int(0,0,180)
#@gimp : Random angle = int(0,0,45)
#@gimp : Max curve = int(3,0,20)
#@gimp : Gamma = float(1,0.01,2)
#@gimp : Spread angles = bool(1)
#@gimp : Fast resize = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2012/12/21</i>.</small>")
gimp_gcd_layeretch : -skip ${1=16},${2=7},${3=14},${4=0.12},${5=100},${6=5},${7=4.65},${8=0},${9=0},${10=3},${11=1},${12=1},${13=0}
-repeat @# -l[$>]
w={w} h={h} sc=800 ml=$1 wl={min($2,$ml-1)}
nwl={$ml-$wl} nwl={$nwl+($nwl%2==0)}
-if {!$13} nw=$w nh=$h
-elif {w>h} nw={min($sc,w)} nh={$nw/w*h}
-else nh={min($sc,h)} nw={$nh/h*w} -endif
-to_rgb[0] [0] -r[1] $nw,$nh
-norm[1] -n[1] 0,255 --tones[1] $ml
-repeat {$ml-1} -+[{-$<-1}] [{-$<-2}] -done
-b[-$ml--1] $4%
-repeat $ml
pc={($>+1)/$ml} msk={2+$>} {w},{h},1,1,0
-if $12 ang={$>/$nwl} -else ang=$pc -endif
-if {$<>=$wl}
-noise[-1] {(1-$pc)*$5},2
-blur_linear[-1] {$6+$pc*($7-$6)}%,0,{$ang*360+?(-$9,$9)+$8}
-quantize[-1] $3,0 -deform[-1] {?*$10+1}
-endif
-r[-1] $nw,$nh -n[-1] 0,255
-mul[$msk,-1] -progress {$pc*100}
-done
-add[-$ml--1] -c[-1] 0,255
-n[-1] 0,255 -negative[-1] -apply_gamma[-1] $11
-if $13 -r[-1] $w,$h,1,3,5 -c[-1] 0,255 -endif
-keep[-1]
-endl -done
#@gimp Pencil : gimp_pencilbw, gimp_pencilbw_preview(0)
#@gimp : Size = float(0.3,0,5)
#@gimp : Amplitude = float(60,0,200)
#@gimp : Hue = float(0,0,360)
#@gimp : Saturation = float(0,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>03/05/2013</i>.</small>")
gimp_pencilbw :
-pencilbw $1,$2
-if {$3||$4} -repeat @# -l[$>] -split_opacity
-/[0] 255 -i[0] 100%,100%,1,1,$4 -i[0] 100%,100%,1,1,$3 -a[0-2] c -hsv2rgb[0]
-a c -endl -done -endif
gimp_pencilbw_preview :
-gimp_split_preview "-gimp_pencilbw $*",$-1
#@gimp Pencil portrait : gimp_pencil_portraitbw, gimp_pencil_portraitbw_preview(0)
#@gimp : Stroke length = float(30,0,500)
#@gimp : Stroke angle = float(120,0,180)
#@gimp : Contour threshold = float(1,0,3)
#@gimp : Opacity = float(0.5,0,1)
#@gimp : Color = color(144,79,21)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Ramon Miranda</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>12/11/2012</i>.</small>")
gimp_pencil_portraitbw :
-repeat @# -l[$>] -split_opacity -l[0]
--b 2%
--blend divide -rm[-2] -luminance[-1]
-gimp_ink_wash[-2] 0,167,0,0.5,0.54,2.25,0,2,6,5,20
--gimp_hardsketchbw[-1] 80,32,1.89,0.21,31.46,0,0
--gimp_sketchbw[-2] 1,$2,180,$1,$3,0.03,0,0.6,0.1,0.6,0.25,1,0,1,0
-blend[0,1] darken
-blend[0,1] multiply,0.5
-blend[0,1] lighten,$4
-normalize_local ,
-to_rgb --fc ${5-7} -blend softlight
-endl -a c -endl -done
gimp_pencil_portraitbw_preview :
-gimp_split_preview "-gimp_pencil_portraitbw $*",$-1
#@gimp Sketch : gimp_sketchbw, gimp_sketchbw_preview(0)
#@gimp : Number of orientations = int(2,1,16)
#@gimp : Starting angle = float(45,0,180)
#@gimp : Angle range = float(180,0,180)
#@gimp : Stroke length = float(30,0,1000)
#@gimp : Contour threshold = float(1,0,3)
#@gimp : Opacity = float(0.03,0,0.3)
#@gimp : Background intensity = float(0,0,2)
#@gimp : Density = float(0.6,0,5)
#@gimp : Sharpness = float(0.1,0,1.5)
#@gimp : Anisotropy = float(0.6,0,1)
#@gimp : Smoothness = float(0.25,0,10)
#@gimp : Coherence = float(1,0,10)
#@gimp : Boost stroke = bool(0)
#@gimp : Curved stroke = bool(1)
#@gimp : Color model = choice("Black on white","White on black","Black on transparent white","White on transparent black","Color on white")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_sketchbw :
-if {$15==4} -repeat @# -l[$>] --sketchbw ${1-14} -blend hardlight -endl -done -return -endif
-sketchbw ${1-14}
-if {$15&1} -negative -endif
-if {$15==2} -r 100%,100%,1,4 -repeat @# -sh[$>] 3,3 -*[-1] -2 -+[-1] {2*255} -c[-1] 0,255 -rm[-1] -done
-elif {$15==3} -r 100%,100%,1,4 -repeat @# -sh[$>] 3,3 -*[-1] 2 -c[-1] 0,255 -rm[-1] -done
-endif
gimp_sketchbw_preview :
-gimp_split_preview "-gimp_sketchbw $*",$-1
#@gimp Stamp : gimp_stamp, gimp_stamp_preview(0)
#@gimp : Auto-threshold = bool(1)
#@gimp : Threshold = int(50,0,100)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Sharpening = float(0,0,30)
#@gimp : Grain = float(0,0,100)
#@gimp : Negative = bool()
#@gimp : Anti-aliasing = bool(1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Antaron</i>, <i>Mahvin</i> and <i>David Tschumperl&#233;</i>.             Latest update: <i>03/16/2015</i>.</small>")
gimp_stamp :
-repeat @# -l[$>] -split_opacity
wh={w},{h}
-norm
-if $7 -r 150%,150%,1,1,3 -endif
-noise $5
-if $1 -otsu 256 -else ->= $2% -endif
-b {if($7,1.5,1)*$3},0 -sharpen $4 -n 0,255
-apply_curve 1,0,0,101,33,170,229,255,255
-if $7 -r $wh,1,1,2 -endif
-if $6 -negative -endif
-a c -endl -done
gimp_stamp_preview :
-gimp_split_preview "-gimp_stamp $*",$-1
#@gimp Threshold etch : gimp_gcd_etch, gimp_gcd_etch_preview(1)
#@gimp : Note = note("<u>Replace tones with noise generated lines</u>")
#@gimp : Note = note("\n<i>Input Image Settings</i>"), sep = separator()
#@gimp : Threshold low = int(125,10,255)
#@gimp : Threshold mid = int(153,10,255)
#@gimp : Threshold high = int(171,10,255)
#@gimp : Threshold max = int(185,10,255)
#@gimp : Blur amount = float(0.1,0,2)
#@gimp : Note = note("\n<i>Output Etch Settings</i>"), sep = separator()
#@gimp : Horizontal amount = int(50,0,100)
#@gimp : Cross-hatch amount = int(80,0,100)
#@gimp : Vertical 1 amount = int(50,0,100)
#@gimp : Vertical 2 amount = int(10,0,100)
#@gimp : Sep = separator()
#@gimp : Horizontal length = int(15,0,50)
#@gimp : Vertical 1 length = int(12,0,50)
#@gimp : Vertical 2 length = int(20,0,50)
#@gimp : Flip cross-hatch = bool(0)
#@gimp : Sep = separator()
#@gimp : Curve amount = int(1,0,20)
#@gimp : Gamma = float(0.3,0.01,1)
#@gimp : Fast resize = bool(1)
#@gimp : Color image = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2013/02/09</i>.</small>")
gimp_gcd_etch :
-skip ${1=125},${2=153},${3=171},${4=185},${5=0.1} -skip ${6=50},${7=80},${8=50},${9=10}
-skip ${10=15},${11=12},${12=20},${13=0} -skip ${14=1},${15=0.3},${16=1},${17=0}
-repeat @# -l[$>]
w={w} h={h} sc=800 ml=4
-if {w>h} nw={min($sc,w)} nh={$nw/w*h} -else nh={min($sc,h)} nw={$nh/h*w} -endif
-to_rgb[0] [0] -if $16 -r[1] $nw,$nh -endif
-b[1] $5% -norm[1] -negative[1] -n[1] 0,255
--c[1] 0,{255-$4} --c[1] {255-$3},128 --c[1] {255-$2},192 --c[1] {255-$1},255 -n[-3--1] 0,255
{w},{h},1,1,0 -noise[-1] $6,2 -deriche[-1] $10,0,x,0
{w},{h},1,1,0 -noise[-1] $7,2 {w},{h},1,3,0 -fc[-1] 0,-1,0 -smooth[-2] [-1],30,30,0 -rm[-1]
-if $13 -mirror[-1] x -endif
{w},{h},1,1,0 -noise[-1] $8,2 -deriche[-1] $11,0,y,0
{w},{h},1,1,0 -noise[-1] $9,2 -deriche[-1] $12,0,y,0
-quantize[-$ml--1] 2,0 -deform[-$ml--1] $14
-repeat $ml -mul[{2+$>},-1] -done
-add[-$ml--1] -n[-1] 0,255 -rm[1]
-negative[-1] -apply_gamma[-1] $15
-if $16 -r[-1] $w,$h,1,3,5 -c[-1] 0,255 -endif
-if $17 -blend[0,1] shapeaverage -else -keep[-1] -endif
-endl -done
gimp_gcd_etch_preview :
-gimp_split_preview "-gimp_gcd_etch ${1--2}",$-1
#@gimp _
#@gimp <b>Colors</b>
#@gimp Abstraction : gimp_color_abstraction, gimp_color_abstraction_preview(0)
#@gimp : Smoothness = float(1,0,10)
#@gimp : Levels = int(10,2,255)
#@gimp : Contrast = float(0.2,0.01,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/19/2011</i>.</small>")
gimp_color_abstraction :
-repeat @# -l[$>] -split_opacity -l[0] -to_rgb
-b $1 -s c -quantize $2,1,0 -area 0 -^ $3 -n 0,255
-endl -a c -endl -done
gimp_color_abstraction_preview :
-gimp_split_preview "-gimp_color_abstraction $*",$-1
#@gimp Boost-fade : gimp_boost_fade, gimp_boost_fade_preview
#@gimp : Amplitude = float(5,0,10)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/12/2011</i>.</small>")
gimp_boost_fade :
-i[0] 640,480,1,3 -rand[0] 0,1 -b[0] {10-$1} -n[0] 0,255 -transfer_colors[^0] [0] -rm[0]
gimp_boost_fade_preview :
-gimp_split_preview "-gimp_boost_fade $*",$-1
#@gimp Boost chromaticity : gimp_boost_chroma, gimp_boost_chroma_preview(1)
#@gimp : Amplitude = float(0.5,0,1)
#@gimp : Color space = choice("YCbCr","Lab")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/19/2014</i>.</small>")
gimp_boost_chroma :
-repeat @# -l[$>] -split_opacity -l[0]
--to_rgb
-if $2
-srgb2rgb -rgb2lab[-1]
-sh[-1] 1,2 -equalize[-1] -rm[-1]
-lab2rgb[-1] -rgb2srgb
-else
-rgb2ycbcr[-1]
-sh[-1] 1,2 -equalize[-1] -rm[-1]
-ycbcr2rgb[-1]
-endif
-blend alpha,$1
-endl -a c -endl -done
gimp_boost_chroma_preview :
-gimp_split_preview "-gimp_boost_chroma $*",$-1
#@gimp Channel processing : gimp_channel_processing, gimp_channel_processing_preview(1)
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Value action = choice("None","Cut","Cut & Normalize","Normalize","Threshold")
#@gimp : Low value = float(0,0,100)
#@gimp : High value = float(100,0,100)
#@gimp : Quantization = int(256,1,256)
#@gimp : Equalization = bool(0)
#@gimp : Negation = bool(0)
#@gimp : Sep = separator()
#@gimp : Tones range = choice("All tones","Shadows","Mid-tones","Highlights")
#@gimp : Tones smoothness = float(2,0,10)
#@gimp : Sep = separator()
#@gimp : Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
_gimp_channel_processing :
-apply_gamma[-1] {10^$1}
-if {$2!=1} --[-1] 128 -*[-1] $2 -+[-1] 128 -endif
-+[-1] $3
-b[-1] $4% -c[-1] 0,255
-if {$5==1} -c[-1] $6%,$7%
-elif {$5==2} -c[-1] $6%,$7% -n[-1] 0,255
-elif {$5==3} -n[-1] $6%,$7%
-elif {$5==4} -ir[-1] $6%,$7% -*[-1] 255
-endif
-if {$8!=256} -quantize[-1] $8,1,0 -endif
-if $9 -equalize[-1] -endif
-if $10 -negative[-1] -endif
gimp_channel_processing :
-repeat @# -l[-1] -split_opacity -rv -to_rgb[-1]
-gimp_start_mix $11,$12
-ac[-1] "-_gimp_channel_processing $1,$2,$3,$4,$5,$6,$7,$8,$9,$10",$13,1
-gimp_end_mix $11
-if {@#!=3} -rv -a c -endif -endl -mv[-1] 0 -done
gimp_channel_processing_preview :
-gimp_split_preview "-gimp_channel_processing $*",$-1
#@gimp CMYK tone : iain_cmyk_tone_p, iain_cmyk_tone_p
#@gimp : Note = note{"<b>Adjust cyans</b> for pixels that have:"}
#@gimp : A lot of cyan = int(0,-255,255)
#@gimp : Some cyan = int(0,-255,255)
#@gimp : Little cyan = int(0,-255,255)
#@gimp : Note = note{"<b>Adjust cyans</b> for pixels that have:"}
#@gimp : A lot of magenta = int(0,-255,255)
#@gimp : Some magenta = int(0,-255,255)
#@gimp : Little magenta = int(0,-255,255)
#@gimp : Note = note{"<b>Adjust cyans</b> for pixels that have:"}
#@gimp : A lot of yellow = int(0,-255,255)
#@gimp : Some yellow = int(0,-255,255)
#@gimp : Little yellow = int(0,-255,255)
#@gimp : Note = note{"<b>Adjust cyans</b> for pixels that have:"}
#@gimp : A lot of key = int(0,-255,255)
#@gimp : Some key = int(0,-255,255)
#@gimp : Little key = int(0,-255,255)
#@gimp : Sep = separator()
#@gimp : Note = note{"<b>Adjust Magentas</b> for pixels that have:"}
#@gimp : A lot of cyan = int(0,-255,255)
#@gimp : Some cyan = int(0,-255,255)
#@gimp : Little cyan = int(0,-255,255)
#@gimp : Note = note{"<b>Adjust Magentas</b> for pixels that have:"}
#@gimp : A lot of magenta = int(0,-255,255)
#@gimp : Some magenta = int(0,-255,255)
#@gimp : Little magenta = int(0,-255,255)
#@gimp : Note = note{"<b>Adjust Magentas</b> for pixels that have:"}
#@gimp : A lot of yellow = int(0,-255,255)
#@gimp : Some yellow = int(0,-255,255)
#@gimp : Little yellow = int(0,-255,255)
#@gimp : Note = note{"<b>Adjust Magentas</b> for pixels that have:"}
#@gimp : A lot of key = int(0,-255,255)
#@gimp : Some key = int(0,-255,255)
#@gimp : Little key = int(0,-255,255)
#@gimp : Sep = separator()
#@gimp : Note = note{"<b>Adjust Yellows</b> for pixels that have:"}
#@gimp : A lot of cyan = int(0,-255,255)
#@gimp : Some cyan = int(0,-255,255)
#@gimp : Little cyan = int(0,-255,255)
#@gimp : Note = note{"<b>Adjust Yellows</b> for pixels that have:"}
#@gimp : A lot of magenta = int(0,-255,255)
#@gimp : Some magenta = int(0,-255,255)
#@gimp : Little magenta = int(0,-255,255)
#@gimp : Note = note{"<b>Adjust Yellows</b> for pixels that have:"}
#@gimp : A lot of yellow = int(0,-255,255)
#@gimp : Some yellow = int(0,-255,255)
#@gimp : Little yellow = int(0,-255,255)
#@gimp : Note = note{"<b>Adjust Yellows</b> for pixels that have:"}
#@gimp : A lot of key = int(0,-255,255)
#@gimp : Some key = int(0,-255,255)
#@gimp : Little key = int(0,-255,255)
#@gimp : Sep = separator()
#@gimp : Note = note{"<b>Adjust Key</b> for pixels that have:"}
#@gimp : A lot of cyan = int(0,-255,255)
#@gimp : Some cyan = int(0,-255,255)
#@gimp : Little cyan = int(0,-255,255)
#@gimp : Note = note{"<b>Adjust Key</b> for pixels that have:"}
#@gimp : A lot of magenta = int(0,-255,255)
#@gimp : Some magenta = int(0,-255,255)
#@gimp : Little magenta = int(0,-255,255)
#@gimp : Note = note{"<b>Adjust Key</b> for pixels that have:"}
#@gimp : A lot of yellow = int(0,-255,255)
#@gimp : Some yellow = int(0,-255,255)
#@gimp : Little yellow = int(0,-255,255)
#@gimp : Note = note{"<b>Adjust Key</b> for pixels that have:"}
#@gimp : A lot of key = int(0,-255,255)
#@gimp : Some key = int(0,-255,255)
#@gimp : Little key = int(0,-255,255)
#@gimp : Sep = separator()
#@gimp : Note = note{"Strength of effect for Saturation level:"}
#@gimp : None = int(255,0,255)
#@gimp : Little = int(255,0,255)
#@gimp : Some = int(255,0,255)
#@gimp : Much = int(255,0,255)
#@gimp : Most = int(255,0,255)
#@gimp : Sep = separator()
#@gimp : Output = choice(0,"Perserve Luminance","Clip CMYK","Clip RGB","Scale CMYK","Scale RGB")
#@gimp : Sep = separator()
#@gimp : Parallel processing = choice(0,"Auto","Off")
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author : <i>Iain Fergusson</i>. Update: 4 March 2014 - Added parallel processing option</small>")
iain_cmyk_tone_p:
-apply_parallel_overlap "-iain_cmyk_tone ${1--2}",0,${-1}
iain_cmyk_tone:
-repeat @# -l[$>] -split_opacity -l[0]
-rgb2cmyk
--split c
--apply_curve[1] 0,0,$1,128,$2,255,$3
--apply_curve[2] 0,0,$4,128,$5,255,$6
--apply_curve[3] 0,0,$7,128,$8,255,$9
--apply_curve[4] 0,0,$10,128,$11,255,$12
-add[-1,-2,-3,-4]
--apply_curve[1] 0,0,$13,128,$14,255,$15
--apply_curve[2] 0,0,$16,128,$17,255,$18
--apply_curve[3] 0,0,$19,128,$20,255,$21
--apply_curve[4] 0,0,$22,128,$23,255,$24
-add[-1,-2,-3,-4]
--apply_curve[1] 0,0,$25,128,$26,255,$27
--apply_curve[2] 0,0,$28,128,$29,255,$30
--apply_curve[3] 0,0,$31,128,$32,255,$33
--apply_curve[4] 0,0,$34,128,$35,255,$36
-add[-1,-2,-3,-4]
--apply_curve[1] 0,0,$37,128,$38,255,$39
--apply_curve[2] 0,0,$40,128,$41,255,$42
--apply_curve[3] 0,0,$43,128,$44,255,$45
--apply_curve[4] 0,0,$46,128,$47,255,$48
-add[-1,-2,-3,-4]
-add[1,5]
-add[2,5]
-add[3,5]
-add[4,5]
-a[-1,-2,-3,-4] c
--sub[0,1]
--cmyk2rgb[0] -rgb2hsv[-1] -split[-1] c -remove[-1,-3] -mul[-1] 255
-apply_curve[-1] 0,0,$49,64,$50,128,$51,192,$52,255,$53
-compose_multiply[-1,-2]
--sub[0,-1]
-if {$54==0}
-cmyk2rgb
-luminance[0]
--luminance[-1]
-compose_grainextract[-1,-2]
-compose_grainmerge[0,-1]
-keep[0]
-endif
-if {$54==1}
-keep[-1]
-c 0,255
-cmyk2rgb
-endif
-if {$54==2}
-keep[-1]
-cmyk2rgb
-c 0,255
-endif
-if {$54==3}
-keep[-1]
-n 0,255
-cmyk2rgb
-endif
-if {$54==4}
-keep[-1]
-cmyk2rgb
-n 0,255
-endif
-endl -a c -endl -done
#@gimp Colormap : gimp_colormap,gimp_colormap_preview
#@gimp : Colormap = choice[1,"Adaptive","Custom","Standard (256)","HSV (256)","Lines (256)","Hot (256)","Cool (256)","Jet (256)","Flag (256)","Cube (256)"]
#@gimp : Dithering = float(1,0,1)
#@gimp : Sep = separator(), note = note("<small><i>For adaptive and custom colormaps only :</i></small>")
#@gimp : Number of tones = int(32,2,256)
#@gimp : Sep = separator(), note = note("<small><i>For custom colormaps only :</i></small>")
#@gimp : Number of colors = int(8,2,8)
#@gimp : 1st color = color(0,0,0)
#@gimp : 2nd color = color(255,255,255)
#@gimp : 3rd color = color(255,0,0)
#@gimp : 4th color = color(0,255,0)
#@gimp : 5th color = color(0,0,255)
#@gimp : 6th color = color(255,255,0)
#@gimp : 7th color = color(255,0,255)
#@gimp : 8th color = color(0,255,255)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/27/2011</i>.</small>")
gimp_colormap :
-repeat @# -l[$>] -split_opacity -to_rgb[0]
-if {$1>=2}
-index[0] {$1-2},$2,1
-elif {$1==1}
(${5-28}) -z[-1] 0,{3*$4-1}
-r[-1] 3,{w/3},1,1,-1 -permute[-1] yzcx -r[-1] $3,1,1,3,3
-index[0] [-1],$2,1 -rm[-1]
-else
-autoindex[0] $3,$2,{if($3<=32,1,0)}
-endif
-a c
-endl -done
gimp_colormap_preview :
-gimp_split_preview "-gimp_colormap $*",$-1
#@gimp Color balance : gimp_balance_gamma, gimp_balance_gamma_preview
#@gimp : Neutral color = color(128,128,128)
#@gimp : Stretch colors = bool(1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>07/01/2011</i>.</small>")
gimp_balance_gamma :
-balance_gamma ${1-3}
-if $4 -repeat @# -l[$>] -split_opacity -l[0] -s c -n 0,255 -a c -endl -a c -endl -done -endif
gimp_balance_gamma_preview :
-gimp_split_preview "-gimp_balance_gamma $*",$-1
#@gimp Color grading : jl_colorgrading, jl_colorgrading_preview
#@gimp : Note = note("A filter for basic photo editing and color grading.")
#@gimp : Note = note("<small><b>Note:</b> Saturation channel gamma affects more the less saturated areas. Saturation channel gamma may introduce artifacts depending on the image. S-curve contrast, affects shadows and highlights equally. Clarity, Local Contrast and Tone Mapping offer somewhat similar effect, use with care when more than one is active. When using noise reduction or sharpening tools, zoom in for more accurate view.</small>")
#@gimp : Sep = separator()
#@gimp : Cool / warm = int(0,-50,50)
#@gimp : Saturation = float(1,0,2)
#@gimp : Saturation channel gamma = float(1,0.1,3)
#@gimp : Sep = separator()
#@gimp : S-curve contrast = int(0,-30,30)
#@gimp : Shadows = int(0,-50,50)
#@gimp : Highlights = int(0,-50,50)
#@gimp : Blacks = int(0,0,50)
#@gimp : Brightness = int(0,-50,50)
#@gimp : Contrast = int(0,-50,50)
#@gimp : Gamma = float(1,0.1,3)
#@gimp : Sep = separator()
#@gimp : Clarity = float(0,0.0,2.0)
#@gimp : Local contrast enhance = float(0,0,3)
#@gimp : Tone map = bool(0)
#@gimp : Tone map strength = float(0.75,0.55,1)
#@gimp : Sep = separator()
#@gimp : Color grading = bool(0)
#@gimp : Highlights color intensity = int(70,0,130)
#@gimp : Highlights hue = int(0,0,360)
#@gimp : Highlights brightness = int(0,-100,100)
#@gimp : Midtones color intensity = int(0,0,130)
#@gimp : Midtones hue = int(0,0,360)
#@gimp : Midtones brightness = int(0,-100,100)
#@gimp : Shadows color intensity = int(70,0,130)
#@gimp : Shadows hue shift = int(180,0,360)
#@gimp : Shadows brightness = int(0,-100,100)
#@gimp : Sep = separator()
#@gimp : Output saturation = float(1,0,2)
#@gimp : Output sharpening = float(0,0,10)
#@gimp : Output chroma nr = float(0,0,20)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>John Lakkas</i>.      Latest update: <i>09/07/2014</i>.</small>")
jl_colorgrading :
_ystr=""
-if {$1>0}
_mymin={$1}
_mymax={255-$1}
-apply_channels_old "-apply_curve 0,0,$_mymin,255,255",6,0
-apply_channels_old "-apply_curve 0,0,0,255,$_mymax",5,0
-endif
-if {$1<0}
_mymin={-$1}
_mymax={255+$1}
-apply_channels_old "-apply_curve 0,0,$_mymin,255,255",5,0
-apply_channels_old "-apply_curve 0,0,0,255,$_mymax",6,0
-endif
-if {$2!=1.0}
-gimp_equalize_s $2,0
-endif
-if {$3!=1.0}
-apply_channels_old "-apply_gamma $3",12,0
-endif
-if {$4!=0}
_p1={64-$4}
_p2={192+$4}
_ystr=$_ystr" -apply_curve 1,0,0,64,$_p1,192,$_p2,255,255"
-endif
-if {$5!=0}
_p3={64-$5}
_ystr=$_ystr" -apply_curve 1,0,0,64,$_p3,128,128,192,192,255,255"
-endif
-if {$6!=0}
_p4={192+$6}
_ystr=$_ystr" -apply_curve 1,0,0,64,64,128,128,192,$_p4,255,255"
-endif
-if {$7>0}
_ystr=$_ystr" -apply_curve 1,$7,0,64,64,255,255"
-endif
-if {$8>0}
_p5=0
_ystr=$_ystr" -apply_curve 0,0,$8,255,255"
-endif
-if {$8<0}
_p5={255+$8}
_ystr=$_ystr" -apply_curve 0,0,0,255,$_p5"
-endif
-if {$9>0}
_p6=$9
_p7={255-$9}
_ystr=$_ystr" -apply_curve 0,0,0,$_p6,0,$_p7,255,255,255"
-endif
-if {$9<0}
_p6={-$9}
_p7={255+$9}
_ystr=$_ystr" -apply_curve 0,0,$_p6,255,$_p7"
-endif
-if {$10!=1.0}
_ystr=$_ystr" -apply_gamma $10"
-endif
-if {$_ystr'!='""}
-apply_channels_old $_ystr,13,0
-endif
-if {$11>0}
-to_rgb --rgb2hsl -split[-1] c -rm[-2] -rm[-2] -*[-1] 255 -apply_curve[-1] 1,0,0,63,0,127,255,192,0,255,0 --unsharp[0] 150,$11,0 -cut[-1] 0,255 -cut[-2] 0,255 -reverse[-1,-2] -append[-1,-2] c -blend alpha
-endif
-if {$12>0}
-unsharp 20,$12,0
-cut[-1] 0,255
-endif
-if {$13}
-map_tones 0.5,$14,0.1,30
-endif
-if {$15}
-if {$17+$23>360}
_shh={($17+$23-360)/360}
-else
_shh={($17+$23)/360}
-endif
_shs={$22/100}
_shlev={$24}
_midh={$20/360}
_mids={$19/100}
_midlev={$21}
_highh={$17/360}
_highs={$16/100}
_highlev={$18}
_satlev={$25}
-color_grade $_shh,$_shs,$_shlev,$_midh,$_mids,$_midlev,$_highh,$_highs,$_highlev,$_satlev
-endif
-if {$25!=1.0}
-gimp_equalize_s $25,0
-endif
-if {$26>0}
-unsharp 0.5,$26
-cut 0,255
-endif
-if {$27>0}
-apply_channels_old "-denoise_haar $27",5,0
-apply_channels_old "-denoise_haar $27",6,0
-endif
color_grade :
_shadownrgb=@{-jl_hsv_to_rgb" "$1,1.0,{$2*0.40}}
_midtonesrgb=@{-jl_hsv_to_rgb" "$4,1.0,{$5*0.40}}
_highlightsrgb=@{-jl_hsv_to_rgb" "$7,1.0,{$8*0.40}}
_crsh=@{-arg" 1,"$_shadownrgb}
_mgsh=@{-arg" 2,"$_shadownrgb}
_ybsh=@{-arg" 3,"$_shadownrgb}
_shlev=$3
_crmid=@{-arg" 1,"$_midtonesrgb}
_mgmid=@{-arg" 2,"$_midtonesrgb}
_ybmid=@{-arg" 3,"$_midtonesrgb}
_midlev=$6
_crhigh=@{-arg" 1,"$_highlightsrgb}
_mghigh=@{-arg" 2,"$_highlightsrgb}
_ybhigh=@{-arg" 3,"$_highlightsrgb}
_highlev=$9
_satlev=$10
_lowinred=0
_hiinred=255
_lowingreen=0
_hiingreen=255
_lowinblue=0
_hiinblue=255
_gammared=0.
_gammagreen=0.
_gammablue=0.
_lowoutred=0
_hioutred=255
_lowoutgreen=0
_hioutgreen=255
_lowoutblue=0
_hioutblue=255
-if {$_crmid>0.}
_gammared={$_gammared+0.4*$_crmid/100.}
_gammagreen={$_gammagreen-0.3*$_crmid/100.}
_gammablue={$_gammablue-0.3*$_crmid/100.}
-endif
-if {$_crmid<0.}
_gammared={$_gammared+0.3*$_crmid/100.}
_gammagreen={$_gammagreen-0.4*$_crmid/100.}
_gammablue={$_gammablue-0.4*$_crmid/100.}
-endif
-if {$_mgmid>0.}
_gammared={$_gammared-0.3*$_mgmid/100.}
_gammagreen={$_gammagreen+0.4*$_mgmid/100.}
_gammablue={$_gammablue-0.3*$_mgmid/100.}
-endif
-if {$_mgmid<0.}
_gammared={$_gammared-0.4*$_mgmid/100.}
_gammagreen={$_gammagreen+0.3*$_mgmid/100.}
_gammablue={$_gammablue-0.4*$_mgmid/100.}
-endif
-if {$_ybmid>0.}
_gammared={$_gammared-0.3*$_ybmid/100.}
_gammagreen={$_gammagreen-0.3*$_ybmid/100.}
_gammablue={$_gammablue+0.4*$_ybmid/100.}
-endif
-if {$_ybmid<0.}
_gammared={$_gammared-0.4*$_ybmid/100.}
_gammagreen={$_gammagreen-0.4*$_ybmid/100.}
_gammablue={$_gammablue+0.3*$_ybmid/100.}
-endif
_gammared={$_gammared+1.}
_gammagreen={$_gammagreen+1.}
_gammablue={$_gammablue+1.}
-if {$_midlev>0.}
_gammared={$_gammared+0.4*$_midlev/100.}
_gammagreen={$_gammagreen+0.4*$_midlev/100.}
_gammablue={$_gammablue+0.4*$_midlev/100.}
-endif
-if {$_midlev<0.}
_gammared={$_gammared+0.3*$_midlev/100.}
_gammagreen={$_gammagreen+0.3*$_midlev/100.}
_gammablue={$_gammablue+0.3*$_midlev/100.}
-endif
_crsh={$_crsh*0.3}
_mgsh={$_mgsh*0.3}
_ybsh={$_ybsh*0.3}
-if {$_crsh>0}
_lowingreen={$_lowingreen+$_crsh}
_lowinblue={$_lowinblue+$_crsh}
_lowoutred={$_lowoutred+$_crsh}
-else
_lowinred={$_lowinred-$_crsh}
_lowoutgreen={$_lowoutgreen-$_crsh}
_lowoutblue={$_lowoutblue-$_crsh}
-endif
-if {$_mgsh>0}
_lowinred={$_lowinred+$_mgsh}
_lowinblue={$_lowinblue+$_mgsh}
_lowoutgreen={$_lowoutgreen+$_mgsh}
-else
_lowingreen={$_lowingreen-$_mgsh}
_lowoutred={$_lowoutred-$_mgsh}
_lowoutblue={$_lowoutblue-$_mgsh}
-endif
-if {$_ybsh>0}
_lowinred={$_lowinred+$_ybsh}
_lowingreen={$_lowingreen+$_ybsh}
_lowoutblue={$_lowoutblue+$_ybsh}
-else
_lowinblue={$_lowinblue-$_ybsh}
_lowoutred={$_lowoutred-$_ybsh}
_lowoutgreen={$_lowoutgreen-$_ybsh}
-endif
-if {$_shlev>0}
_lowoutred={$_lowoutred+$_shlev}
_lowoutgreen={$_lowoutgreen+$_shlev}
_lowoutblue={$_lowoutblue+$_shlev}
-endif
-if {$_shlev<0}
_lowinred={$_lowinred-$_shlev}
_lowingreen={$_lowingreen-$_shlev}
_lowinblue={$_lowinblue-$_shlev}
-endif
_crhigh={$_crhigh*0.3}
_mghigh={$_mghigh*0.3}
_ybhigh={$_ybhigh*0.3}
-if {$_crhigh>0}
_hiinred={$_hiinred-$_crhigh}
_hioutgreen={$_hioutgreen-$_crhigh}
_hioutblue={$_hioutgreen-$_crhigh}
-else
_hiingreen={$_hiingreen+$_crhigh}
_hiinblue={$_hiinblue+$_crhigh}
_hioutred={$_hioutred+$_crhigh}
-endif
-if {$_mghigh>0}
_hiingreen={$_hiingreen-$_mghigh}
_hioutred={$_hioutred-$_mghigh}
_hioutblue={$_hioutblue-$_mghigh}
-else
_hiinred={$_hiinred+$_mghigh}
_hiinblue={$_hiinblue+$_mghigh}
_hioutgreen={$_hioutgreen+$_mghigh}
-endif
-if {$_ybhigh>0}
_hiinblue={$_hiinblue-$_ybhigh}
_hioutred={$_hioutred-$_ybhigh}
_hioutgreen={$_hioutgreen-$_ybhigh}
-else
_hiinred={$_hiinred+$_ybhigh}
_hiingreen={$_hiingreen+$_ybhigh}
_hioutblue={$_hioutblue+$_ybhigh}
-endif
-if {$_highlev>0}
_hiinred={$_hiinred-$_highlev}
_hiingreen={$_hiingreen-$_highlev}
_hiinblue={$_hiinblue-$_highlev}
-endif
-if {$_highlev<0}
_hioutred={$_hioutred+$_highlev}
_hioutgreen={$_hioutgreen+$_highlev}
_hioutblue={$_hioutblue+$_highlev}
-endif
-levels $_lowinred,$_hiinred,$_gammared,$_lowoutred,$_hioutred,19
-levels $_lowingreen,$_hiingreen,$_gammagreen,$_lowoutgreen,$_hioutgreen,20
-levels $_lowinblue,$_hiinblue,$_gammablue,$_lowoutblue,$_hioutblue,21
jl_colorgrading_preview :
-gimp_split_preview "-jl_colorgrading $*",$-1
#@gimp Color temperature : gimp_tk_colortemp, gimp_tk_colortemp_preview(1)
#@gimp : Color temperature = float(0,-20,20)
#@gimp : Automatic color balance = bool(0)
#@gimp : Sep = separator()
#@gimp : Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>.      Latest update: <i>05/04/2012</i>.</small>")
gimp_tk_colortemp :
-repeat @# -l[$>] -if {$2==1} --luminance[-1] -to_rgb[-2]
-s[-2] c  avb={127.5-@{-2,a}} avg={127.5-@{-3,a}} avr={127.5-@{-4,a}}
-+[-4] $avr -+[-3] $avg -+[-2] $avb -a[-4,-3,-2] c -rv -compose_luminance -endif
-gimp_mix_lab 1,0,0,1,{if({$1>=0},{$1/4},{$1*0.75})},0,1,$1,0,0,2,0 -endl -done
gimp_tk_colortemp_preview :
-gimp_split_preview "-gimp_tk_colortemp ${1--2}",$-1
#@gimp Couleurs metalliques : Couleurs_Metalliques_samj_en, Couleurs_Metalliques_samj_en_preview
#@gimp : Sep = separator(), note = note("<small>Rendering</small>")
#@gimp : Transparence / transparency = choice(0,"Preserve","Remove")
#@gimp : Rendering = choice("Saturation","Lightness","RGB","Red","Green","Blue","Alpha")
#@gimp : Sep = separator(), note = note("<small>Noise parameters</small>")
#@gimp : Amplitude = float(22,0,200)
#@gimp : Noise type = choice("Gaussian","Uniform","Salt and pepper","Poisson")
#@gimp : Value range = choice("Cut","Normalize")
#@gimp : Sep = separator(), note = note("<small>Local normalization parameters</small>")
#@gimp : Effect x 2 = bool(0)
#@gimp : Amplitude = float(0,0,60)
#@gimp : Radius = int(6,1,64)
#@gimp : Neighborhood smoothness = float(5,0,40)
#@gimp : Average smoothness = float(20,0,40)
#@gimp : Constrain values = bool(1)
#@gimp : Channel(s) = choice(0,"All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Alpha","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Sep = separator(), note = note("<small>Boost-Fade parameters : If Amplitude Sup. 0</small>")
#@gimp : Amplitude = float(0,0,10)
#@gimp : Sep = separator(), note = note("<small>PhotoComix Options</small>")
#@gimp : Use pc options = bool(0)
#@gimp : Pencilbw size = float(0.3,0,5)
#@gimp : Pencilbw amplitude = float(60,0,200)
#@gimp : Blend opacity = float(1,0,1)
#@gimp : Blend revert layers = bool(1)
#@gimp : Sep = separator()
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("samj      Update : <i>2015/03/03</i>.</small>")
Couleurs_Metalliques_samj_en :
-Couleurs_Metalliques $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18
Couleurs_Metalliques_samj_en_preview :
-gimp_split_preview "-Couleurs_Metalliques_samj_en ${1--2}",$-1
#@gimp Curves : gimp_apply_curve, gimp_apply_curve_preview
#@gimp : Starting y = int(0,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(1) = int(-1,-1,255)
#@gimp : Y-coord(1) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(2) = int(-1,-1,255)
#@gimp : Y-coord(2) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(3) = int(-1,-1,255)
#@gimp : Y-coord(3) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(4) = int(-1,-1,255)
#@gimp : Y-coord(4) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(5) = int(-1,-1,255)
#@gimp : Y-coord(5) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : Ending y = int(255,0,255)
#@gimp : Sep = separator()
#@gimp : Curve smoothness = float(1,0,1)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Display histogram = float(0,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_apply_curve :
-ac "-_gimp_apply_curve ${1-13}",$14,$15
_gimp_apply_curve :
-apply_curve $13,0,$1,\
@{"-if {$2>=0} -u $2,$3, -else -u \"\" -endif"}\
@{"-if {$4>=0} -u $4,$5, -else -u \"\" -endif"}\
@{"-if {$6>=0} -u $6,$7, -else -u \"\" -endif"}\
@{"-if {$8>=0} -u $8,$9, -else -u \"\" -endif"}\
@{"-if {$10>=0} -u $10,$11, -else -u \"\" -endif"}\
255,$12
gimp_apply_curve_preview :
-function1d $13,0,$1,\
@{"-if {$2>=0} -u $2,$3, -else -u \"\" -endif"}\
@{"-if {$4>=0} -u $4,$5, -else -u \"\" -endif"}\
@{"-if {$6>=0} -u $6,$7, -else -u \"\" -endif"}\
@{"-if {$8>=0} -u $8,$9, -else -u \"\" -endif"}\
@{"-if {$10>=0} -u $10,$11, -else -u \"\" -endif"}\
255,$12
-mv[-1] 0
-repeat {@#-1}
--gimp_split_preview[-1] "-gimp_apply_curve $*",$-1
100%,100% -axes[-1] 0,255,255,0,13,1,255 --dilate[-1] 3 -r[-2] [-3] -j[-3] [-2],0,0,0,0,1,[-1],255 -rm[-2,-1]
-grid[-1] 10%,10%,0,0,0.3,0xCCCCCCCC,255
-line[-1] 0,100%,100%,0,0.3,0xCCCCCCCC,255
-if $-2
[-1],[-1] -to_gray[-3] -histogram[-3] 256,0,255 -graph[-1] [-3],3,0,0,0,1,1 -!=[-1] 0 -*[-1] 255 -rm[-3]
--xor[-2,-1] -j[-3] [-1],0,0,0,0,$16,[-2],255 -rm[-2,-1]
-else -rm[-2] -endif
100%,100% -graph[-1] [0],1,0,255,0,1,255 --dilate[-1] 3 -r[-2] [-3] -j[-3] [-2],0,0,0,0,1,[-1],255 -rm[-2,-1]
-_gimp_apply_curve_preview 0,$1,0 -_gimp_apply_curve_preview $2,$3,1
-_gimp_apply_curve_preview $4,$5,2 -_gimp_apply_curve_preview $6,$7,3
-_gimp_apply_curve_preview $8,$9,4 -_gimp_apply_curve_preview $10,$11,5
-_gimp_apply_curve_preview 255,$12,6
-mv[-1] 1 -done -rm[0]
_gimp_apply_curve_preview :
-if {$1>=0}
x={$1*100/255}% y={100-$2*100/255}%
-ellipse[-1] $x,$y,3,3,0,1,0xFFFFFFFF,0,0,0 -ellipse[-1] $x,$y,2,2,0,1,0,255,0
-t[-1] $3,$x,{$y*h-20},13,1,255
-endif
#@gimp Curves [interactive] : gimp_curves_interactive, gimp_curves_interactive_preview
#@gimp : Colorspace = choice{"RGB","CMY","CMYK","HSI","HSL","HSV","Lab","Lch","YCbCr"}
#@gimp : Output preset as a clut layer = _choice("Disable","Low-res CLUT","High-res CLUT")
#@gimp : Apply transformation from = _choice("New curves [interactive]","Curves defined previously")
#@gimp : Colorspace = const(0)
#@gimp : Keypoints = const(0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100)
#@gimp : Sep = separator()
#@gimp : Note = note{"<small><b>Description:</b>\n
#@gimp : This filter allows to apply color curves on your images, in many different colorspaces.
#@gimp : Click on the <i>Apply</i> or <i>OK</i> buttons below to open the G'MIC interactive windows and start building your color curves.
#@gimp : When you're done, exit the main image window: your modified result will be transfered back to GIMP.\n\n
#@gimp : Once you've set curves, you can save them by pressing the <b>Add to faves</b> button below the filter tree.
#@gimp : To clear control points for your curves, click on the <i>Reset</i> button at the bottom.
#@gimp : </small>"}
#@gimp : Sep = separator()
#@gimp : Note = note{"<small><b>Interactions:</b>\n
#@gimp : Use the following actions in the interactive windows to manage your colorization :\n\n
#@gimp : - <b>Left mouse button</b> on a curve creates a new color control point (or move an existing one).\n
#@gimp : - <b>Right mouse button</b> on a control point deletes it.\n
#@gimp : - <b>Left mouse button</b> on the main image window shows the initial image until button is released.\n
#@gimp : - <b>Right mouse button</b> on the main image window adds a keypoint to all curves from picked color.\n
#@gimp : - Key <b>R</b> on a curve resets it.\n
#@gimp : - Keys <b>CTRL+D</b> increase window size.\n
#@gimp : - Keys <b>CTRL+C</b> decrease window size.\n
#@gimp : - Keys <b>CTRL+R</b> resets window size.\n
#@gimp : - Keys <b>ESC</b>, <b>Q</b> or <b>ENTER</b> close the current window.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>09/28/2014</i>.</small>")
gimp_curves_interactive :
-nm "Color curves"
-repeat 4 __xcc_C$>=0,0,100,100 -done
-if {$4==$1} -l[] (${5--1}) -s -,-1 -repeat @# __xcc_C$>=@{$>} -done -rm -endl -endif
-if $3 _xcc_colorbase=@{-arg\ {$4+1},rgb,cmy,cmyk,hsi,hsl,hsv,lab,lch,ycbcr} -x_color_curves last
-else
-x_color_curves @{-arg\ {$1+1},rgb,cmy,cmyk,hsi,hsl,hsv,lab,lch,ycbcr}
-u "{$1}{$2}{$3}{$1}{"$__xcc_C0,-1,$__xcc_C1,-1,$__xcc_C2,-1,$__xcc_C3,-1,$__xcc_C4"}"
-endif
-if $2
(0,255) (0;255) (0/255) -r[-3--1] 2,2,2 -a[-3--1] c
-if {$2==2} -r[-1] 256,256,256,3,3 -r[-1] 4096,4096,1,3,-1
-else -r[-1] 64,64,64,3,3 -r[-1] 512,512,1,3,-1
-endif
-x_color_curves[-1] last
-endif
gimp_curves_interactive_preview :
-gimp_curves_interactive $1,0,1,${4--1}
#@gimp <i>Curves [Lab]</i>
#@gimp A-color : gimp_apply_Labcurve, gimp_apply_acurve_preview
#@gimp : Starting y = int(0,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(1) = int(-1,-1,255)
#@gimp : Y-coord(1) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(2) = int(-1,-1,255)
#@gimp : Y-coord(2) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(3) = int(-1,-1,255)
#@gimp : Y-coord(3) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(4) = int(-1,-1,255)
#@gimp : Y-coord(4) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(5) = int(-1,-1,255)
#@gimp : Y-coord(5) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : Ending y = int(255,0,255)
#@gimp : Sep = separator()
#@gimp : Curve smoothness = float(1,0,1)
#@gimp : Display histogram = float(0,0,100)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp B-color : gimp_apply_Labcurve, gimp_apply_bcurve_preview
#@gimp : Starting y = int(0,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(1) = int(-1,-1,255)
#@gimp : Y-coord(1) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(2) = int(-1,-1,255)
#@gimp : Y-coord(2) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(3) = int(-1,-1,255)
#@gimp : Y-coord(3) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(4) = int(-1,-1,255)
#@gimp : Y-coord(4) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(5) = int(-1,-1,255)
#@gimp : Y-coord(5) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : Ending y = int(255,0,255)
#@gimp : Sep = separator()
#@gimp : Curve smoothness = float(1,0,1)
#@gimp : Display histogram = float(0,0,100)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_apply_Labcurve : -skip $1
-gimp_apply_Labcurve_configfile
-repeat {@#-1} -l[$>,-1]
-to_colormode[0] {max(3,s)} -sh[0] 0,2 -rgb2lab[-1] -rm[-1]
-sh[0] 0,0 -*[-1] 2.55 -_gimp_apply_Labcurve[-1] @{-2,0-12} -/[-1] 2.55 -rm[-1]
-sh[0] 1,1 -+[-1] 86 -*[-1] 1.38587 -_gimp_apply_Labcurve[-1] @{-2,13-25} -/[-1] 1.38587 --[-1] 86 -rm[-1]
-sh[0] 2,2 -+[-1] 108 -*[-1] 1.25616 -_gimp_apply_Labcurve[-1] @{-2,26-38} -/[-1] 1.25616 --[-1] 108 -rm[-1]
-sh[0] 0,2 -lab2rgb[-1] -rm[-1]
-endl -done
-rm[-1]
_gimp_apply_Labcurve :
-apply_curve $13,0,$1,\
@{"-if {$2>=0} -u $2,$3, -else -u \"\" -endif"}\
@{"-if {$4>=0} -u $4,$5, -else -u \"\" -endif"}\
@{"-if {$6>=0} -u $6,$7, -else -u \"\" -endif"}\
@{"-if {$8>=0} -u $8,$9, -else -u \"\" -endif"}\
@{"-if {$10>=0} -u $10,$11, -else -u \"\" -endif"}\
255,$12
-c 0,255
gimp_apply_Lcurve_preview :
-gimp_apply_Labcurve_configfile
-sh[-1] 0,0,0,0 -f[-1] ${1--3} -rm[-1]
-gimp_apply_Labcurve_preview[^-1] @-1,0,${-2,-1} -rm[-1]
gimp_apply_acurve_preview :
-gimp_apply_Labcurve_configfile
-sh[-1] 1,1,0,0 -f[-1] ${1--3} -rm[-1]
-gimp_apply_Labcurve_preview[^-1] @-1,1,${-2,-1} -rm[-1]
gimp_apply_bcurve_preview :
-gimp_apply_Labcurve_configfile
-sh[-1] 2,2,0,0 -f[-1] ${1--3} -rm[-1]
-gimp_apply_Labcurve_preview[^-1] @-1,2,${-2,-1} -rm[-1]
gimp_apply_Labcurve_configfile :
filename=@{-path_tmp}/.gmic_Labcurve.dlm
-if $filename $filename -else (0,-1,128,-1,128,-1,128,-1,128,-1,128,255,1) -r[-1] 100%,3 -endif
gimp_apply_Labcurve_preview :
(${1--3}) -r[-1] 13,3,1,1,-1 -o[-1] @{-path_tmp}/.gmic_Labcurve.dlm -rm[-1]
-function1d $13,0,$1,\
@{"-if {$2>=0} -u $2,$3, -else -u \"\" -endif"}\
@{"-if {$4>=0} -u $4,$5, -else -u \"\" -endif"}\
@{"-if {$6>=0} -u $6,$7, -else -u \"\" -endif"}\
@{"-if {$8>=0} -u $8,$9, -else -u \"\" -endif"}\
@{"-if {$10>=0} -u $10,$11, -else -u \"\" -endif"}\
255,$12
-function1d $26,0,$14,\
@{"-if {$15>=0} -u $15,$16, -else -u \"\" -endif"}\
@{"-if {$17>=0} -u $17,$18, -else -u \"\" -endif"}\
@{"-if {$19>=0} -u $19,$20, -else -u \"\" -endif"}\
@{"-if {$21>=0} -u $21,$22, -else -u \"\" -endif"}\
@{"-if {$23>=0} -u $23,$24, -else -u \"\" -endif"}\
255,$25
-function1d $39,0,$27,\
@{"-if {$28>=0} -u $28,$29, -else -u \"\" -endif"}\
@{"-if {$30>=0} -u $30,$31, -else -u \"\" -endif"}\
@{"-if {$32>=0} -u $32,$33, -else -u \"\" -endif"}\
@{"-if {$34>=0} -u $34,$35, -else -u \"\" -endif"}\
@{"-if {$36>=0} -u $36,$37, -else -u \"\" -endif"}\
255,$38
-a[-3--1] y -mv[-1] 0
-repeat {@#-1}
--gimp_split_preview[-1] "-gimp_apply_Labcurve 0",$-1
-axes[-1] 0,255,255,0,13,1,255
100%,100% -axes[-1] 0,255,255,0,13,1,255 --dilate[-1] 3 -r[-2] [-3] -j[-3] [-2],0,0,0,0,1,[-1],255 -rm[-2,-1]
-grid[-1] 10%,10%,0,0,0.3,0xCCCCCCCC,255
-line[-1] 0,100%,100%,0,0.3,0xCCCCCCCC,255
-if $-2
[-1],[-1],1,1,-{$-2*255/100} -to_gray[-3] -histogram[-3] 256,0,255 -graph[-1] [-3],3,0,0,0,1,0
-rm[-3] -+[-1] {$-2*255/100} -+[-2,-1] -c[-1] 0,255
-else -rm[-2] -endif
-line[-1] 0,100%,100%,0,0.3,0xCCCCCCCC,255
-sh[0] 0,0,0,0
-graph[-2] [-1],1,0,255,0,1,255,255,255 --[-1] 1
-graph[-2] [-1],1,0,255,0,0.5,200,200,200 -rm[-1]
-sh[0] 1,1,0,0
-graph[-2] [-1],1,0,255,0,1,255,128,128 --[-1] 1
-graph[-2] [-1],1,0,255,0,0.5,200,0,0 -rm[-1]
-sh[0] 2,2,0,0
-graph[-2] [-1],1,0,255,0,1,128,128,255 --[-1] 1
-graph[-2] [-1],1,0,255,0,0.5,0,0,200 -rm[-1]
-if {$40==0}
-_gimp_apply_curve_preview 0,$1,0 -_gimp_apply_curve_preview $2,$3,1
-_gimp_apply_curve_preview $4,$5,2 -_gimp_apply_curve_preview $6,$7,3
-_gimp_apply_curve_preview $8,$9,4 -_gimp_apply_curve_preview $10,$11,5
-_gimp_apply_curve_preview 255,$12,6
-elif {$40==1}
-_gimp_apply_curve_preview 0,$14,0 -_gimp_apply_curve_preview $15,$16,1
-_gimp_apply_curve_preview $17,$18,2 -_gimp_apply_curve_preview $19,$20,3
-_gimp_apply_curve_preview $21,$22,4 -_gimp_apply_curve_preview $23,$24,5
-_gimp_apply_curve_preview 255,$25,6
-else
-_gimp_apply_curve_preview 0,$27,0 -_gimp_apply_curve_preview $28,$29,1
-_gimp_apply_curve_preview $30,$31,2 -_gimp_apply_curve_preview $32,$33,3
-_gimp_apply_curve_preview $34,$35,4 -_gimp_apply_curve_preview $36,$37,5
-_gimp_apply_curve_preview 255,$38,6
-endif
-mv[-1] 1 -done -rm[0]
#@gimp Lightness : gimp_apply_Labcurve, gimp_apply_Lcurve_preview
#@gimp : Starting y = int(0,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(1) = int(-1,-1,255)
#@gimp : Y-coord(1) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(2) = int(-1,-1,255)
#@gimp : Y-coord(2) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(3) = int(-1,-1,255)
#@gimp : Y-coord(3) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(4) = int(-1,-1,255)
#@gimp : Y-coord(4) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(5) = int(-1,-1,255)
#@gimp : Y-coord(5) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : Ending y = int(255,0,255)
#@gimp : Sep = separator()
#@gimp : Curve smoothness = float(1,0,1)
#@gimp : Display histogram = float(0,0,100)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp _
#@gimp <i>Curves [RGB]</i>
#@gimp Blue : gimp_apply_RGBcurve, gimp_apply_Bcurve_preview
#@gimp : Starting y = int(0,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(1) = int(-1,-1,255)
#@gimp : Y-coord(1) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(2) = int(-1,-1,255)
#@gimp : Y-coord(2) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(3) = int(-1,-1,255)
#@gimp : Y-coord(3) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(4) = int(-1,-1,255)
#@gimp : Y-coord(4) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(5) = int(-1,-1,255)
#@gimp : Y-coord(5) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : Ending y = int(255,0,255)
#@gimp : Sep = separator()
#@gimp : Curve smoothness = float(1,0,1)
#@gimp : Display histogram = float(0,0,100)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_apply_RGBcurve : -skip $1
-gimp_apply_RGBcurve_configfile
-repeat {@#-1} -l[$>,-1]
-to_colormode[0] {max(3,s)}
-sh[0] 0,0 -_gimp_apply_RGBcurve[-1] @{-2,0-12} -rm[-1]
-sh[0] 1,1 -_gimp_apply_RGBcurve[-1] @{-2,13-25} -rm[-1]
-sh[0] 2,2 -_gimp_apply_RGBcurve[-1] @{-2,26-38} -rm[-1]
-endl -done
-rm[-1]
_gimp_apply_RGBcurve :
-apply_curve $13,0,$1,\
@{"-if {$2>=0} -u $2,$3, -else -u \"\" -endif"}\
@{"-if {$4>=0} -u $4,$5, -else -u \"\" -endif"}\
@{"-if {$6>=0} -u $6,$7, -else -u \"\" -endif"}\
@{"-if {$8>=0} -u $8,$9, -else -u \"\" -endif"}\
@{"-if {$10>=0} -u $10,$11, -else -u \"\" -endif"}\
255,$12
-c 0,255
gimp_apply_Rcurve_preview :
-gimp_apply_RGBcurve_configfile
-sh[-1] 0,0,0,0 -f[-1] ${1--3} -rm[-1]
-gimp_apply_RGBcurve_preview[^-1] @-1,0,${-2,-1} -rm[-1]
gimp_apply_Gcurve_preview :
-gimp_apply_RGBcurve_configfile
-sh[-1] 1,1,0,0 -f[-1] ${1--3} -rm[-1]
-gimp_apply_RGBcurve_preview[^-1] @-1,1,${-2,-1} -rm[-1]
gimp_apply_Bcurve_preview :
-gimp_apply_RGBcurve_configfile
-sh[-1] 2,2,0,0 -f[-1] ${1--3} -rm[-1]
-gimp_apply_RGBcurve_preview[^-1] @-1,2,${-2,-1} -rm[-1]
gimp_apply_RGBcurve_configfile :
filename=@{-path_tmp}/.gmic_RGBcurve.dlm
-if $filename $filename -else (0,-1,128,-1,128,-1,128,-1,128,-1,128,255,1) -r[-1] 100%,3 -endif
gimp_apply_RGBcurve_preview :
(${1--3}) -r[-1] 13,3,1,1,-1 -o[-1] @{-path_tmp}/.gmic_RGBcurve.dlm -rm[-1]
-function1d $13,0,$1,\
@{"-if {$2>=0} -u $2,$3, -else -u \"\" -endif"}\
@{"-if {$4>=0} -u $4,$5, -else -u \"\" -endif"}\
@{"-if {$6>=0} -u $6,$7, -else -u \"\" -endif"}\
@{"-if {$8>=0} -u $8,$9, -else -u \"\" -endif"}\
@{"-if {$10>=0} -u $10,$11, -else -u \"\" -endif"}\
255,$12
-function1d $26,0,$14,\
@{"-if {$15>=0} -u $15,$16, -else -u \"\" -endif"}\
@{"-if {$17>=0} -u $17,$18, -else -u \"\" -endif"}\
@{"-if {$19>=0} -u $19,$20, -else -u \"\" -endif"}\
@{"-if {$21>=0} -u $21,$22, -else -u \"\" -endif"}\
@{"-if {$23>=0} -u $23,$24, -else -u \"\" -endif"}\
255,$25
-function1d $39,0,$27,\
@{"-if {$28>=0} -u $28,$29, -else -u \"\" -endif"}\
@{"-if {$30>=0} -u $30,$31, -else -u \"\" -endif"}\
@{"-if {$32>=0} -u $32,$33, -else -u \"\" -endif"}\
@{"-if {$34>=0} -u $34,$35, -else -u \"\" -endif"}\
@{"-if {$36>=0} -u $36,$37, -else -u \"\" -endif"}\
255,$38
-a[-3--1] y -mv[-1] 0
-repeat {@#-1}
--gimp_split_preview[-1] "-gimp_apply_RGBcurve 0",$-1
100%,100% -axes[-1] 0,255,255,0,13,1,255 --dilate[-1] 3 -r[-2] [-3] -j[-3] [-2],0,0,0,0,1,[-1],255 -rm[-2,-1]
-grid[-1] 10%,10%,0,0,0.3,0xCCCCCCCC,255
-line[-1] 0,100%,100%,0,0.3,0xCCCCCCCC,255
-if $-2
[-1],[-1],1,1,-{$-2*255/100} -to_gray[-3] -histogram[-3] 256,0,255 -graph[-1] [-3],3,0,0,0,1,0
-rm[-3] -+[-1] {$-2*255/100} -+[-2,-1] -c[-1] 0,255
-else -rm[-2] -endif
-line[-1] 0,100%,100%,0,0.3,0xCCCCCCCC,255
-sh[0] 0,0,0,0
-graph[-2] [-1],1,0,255,0,1,255,128,128 --[-1] 1
-graph[-2] [-1],1,0,255,0,0.5,200,0,0 -rm[-1]
-sh[0] 1,1,0,0
-graph[-2] [-1],1,0,255,0,1,128,255,128 --[-1] 1
-graph[-2] [-1],1,0,255,0,0.5,0,200,0 -rm[-1]
-sh[0] 2,2,0,0
-graph[-2] [-1],1,0,255,0,1,128,128,255 --[-1] 1
-graph[-2] [-1],1,0,255,0,0.5,0,0,200 -rm[-1]
-if {$40==0}
-_gimp_apply_curve_preview 0,$1,0 -_gimp_apply_curve_preview $2,$3,1
-_gimp_apply_curve_preview $4,$5,2 -_gimp_apply_curve_preview $6,$7,3
-_gimp_apply_curve_preview $8,$9,4 -_gimp_apply_curve_preview $10,$11,5
-_gimp_apply_curve_preview 255,$12,6
-elif {$40==1}
-_gimp_apply_curve_preview 0,$14,0 -_gimp_apply_curve_preview $15,$16,1
-_gimp_apply_curve_preview $17,$18,2 -_gimp_apply_curve_preview $19,$20,3
-_gimp_apply_curve_preview $21,$22,4 -_gimp_apply_curve_preview $23,$24,5
-_gimp_apply_curve_preview 255,$25,6
-else
-_gimp_apply_curve_preview 0,$27,0 -_gimp_apply_curve_preview $28,$29,1
-_gimp_apply_curve_preview $30,$31,2 -_gimp_apply_curve_preview $32,$33,3
-_gimp_apply_curve_preview $34,$35,4 -_gimp_apply_curve_preview $36,$37,5
-_gimp_apply_curve_preview 255,$38,6
-endif
-mv[-1] 1 -done -rm[0]
#@gimp Green : gimp_apply_RGBcurve, gimp_apply_Gcurve_preview
#@gimp : Starting y = int(0,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(1) = int(-1,-1,255)
#@gimp : Y-coord(1) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(2) = int(-1,-1,255)
#@gimp : Y-coord(2) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(3) = int(-1,-1,255)
#@gimp : Y-coord(3) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(4) = int(-1,-1,255)
#@gimp : Y-coord(4) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(5) = int(-1,-1,255)
#@gimp : Y-coord(5) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : Ending y = int(255,0,255)
#@gimp : Sep = separator()
#@gimp : Curve smoothness = float(1,0,1)
#@gimp : Display histogram = float(0,0,100)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp Red : gimp_apply_RGBcurve, gimp_apply_Rcurve_preview
#@gimp : Starting y = int(0,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(1) = int(-1,-1,255)
#@gimp : Y-coord(1) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(2) = int(-1,-1,255)
#@gimp : Y-coord(2) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(3) = int(-1,-1,255)
#@gimp : Y-coord(3) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(4) = int(-1,-1,255)
#@gimp : Y-coord(4) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(5) = int(-1,-1,255)
#@gimp : Y-coord(5) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : Ending y = int(255,0,255)
#@gimp : Sep = separator()
#@gimp : Curve smoothness = float(1,0,1)
#@gimp : Display histogram = float(0,0,100)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp _
#@gimp <i>Curves [YCbCr]</i>
#@gimp Blue chrominance : gimp_apply_YCbCrcurve, gimp_apply_Cbcurve_preview
#@gimp : Starting y = int(0,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(1) = int(-1,-1,255)
#@gimp : Y-coord(1) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(2) = int(-1,-1,255)
#@gimp : Y-coord(2) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(3) = int(-1,-1,255)
#@gimp : Y-coord(3) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(4) = int(-1,-1,255)
#@gimp : Y-coord(4) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(5) = int(-1,-1,255)
#@gimp : Y-coord(5) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : Ending y = int(255,0,255)
#@gimp : Sep = separator()
#@gimp : Curve smoothness = float(1,0,1)
#@gimp : Display histogram = float(0,0,100)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp Luminance : gimp_apply_YCbCrcurve, gimp_apply_Ycurve_preview
#@gimp : Starting y = int(0,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(1) = int(-1,-1,255)
#@gimp : Y-coord(1) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(2) = int(-1,-1,255)
#@gimp : Y-coord(2) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(3) = int(-1,-1,255)
#@gimp : Y-coord(3) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(4) = int(-1,-1,255)
#@gimp : Y-coord(4) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(5) = int(-1,-1,255)
#@gimp : Y-coord(5) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : Ending y = int(255,0,255)
#@gimp : Sep = separator()
#@gimp : Curve smoothness = float(1,0,1)
#@gimp : Display histogram = float(0,0,100)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp Red chrominance : gimp_apply_YCbCrcurve, gimp_apply_Crcurve_preview
#@gimp : Starting y = int(0,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(1) = int(-1,-1,255)
#@gimp : Y-coord(1) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(2) = int(-1,-1,255)
#@gimp : Y-coord(2) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(3) = int(-1,-1,255)
#@gimp : Y-coord(3) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(4) = int(-1,-1,255)
#@gimp : Y-coord(4) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : X-coord(5) = int(-1,-1,255)
#@gimp : Y-coord(5) = int(128,0,255)
#@gimp : Sep = separator()
#@gimp : Ending y = int(255,0,255)
#@gimp : Sep = separator()
#@gimp : Curve smoothness = float(1,0,1)
#@gimp : Display histogram = float(0,0,100)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_apply_YCbCrcurve : -skip $1
-gimp_apply_YCbCrcurve_configfile
-repeat {@#-1} -l[$>,-1]
-to_colormode[0] {max(3,s)} -sh[0] 0,2 -rgb2ycbcr[-1] -rm[-1]
-sh[0] 0,0 -_gimp_apply_YCbCrcurve[-1] @{-2,0-12} -rm[-1]
-sh[0] 1,1 -_gimp_apply_YCbCrcurve[-1] @{-2,13-25} -rm[-1]
-sh[0] 2,2 -_gimp_apply_YCbCrcurve[-1] @{-2,26-38} -rm[-1]
-sh[0] 0,2 -ycbcr2rgb[-1] -rm[-1]
-endl -done
-rm[-1]
_gimp_apply_YCbCrcurve :
-apply_curve $13,0,$1,\
@{"-if {$2>=0} -u $2,$3, -else -u \"\" -endif"}\
@{"-if {$4>=0} -u $4,$5, -else -u \"\" -endif"}\
@{"-if {$6>=0} -u $6,$7, -else -u \"\" -endif"}\
@{"-if {$8>=0} -u $8,$9, -else -u \"\" -endif"}\
@{"-if {$10>=0} -u $10,$11, -else -u \"\" -endif"}\
255,$12
-c 0,255
gimp_apply_Ycurve_preview :
-gimp_apply_YCbCrcurve_configfile
-sh[-1] 0,0,0,0 -f[-1] ${1--3} -rm[-1]
-gimp_apply_YCbCrcurve_preview[^-1] @-1,0,${-2,-1} -rm[-1]
gimp_apply_Cbcurve_preview :
-gimp_apply_YCbCrcurve_configfile
-sh[-1] 1,1,0,0 -f[-1] ${1--3} -rm[-1]
-gimp_apply_YCbCrcurve_preview[^-1] @-1,1,${-2,-1} -rm[-1]
gimp_apply_Crcurve_preview :
-gimp_apply_YCbCrcurve_configfile
-sh[-1] 2,2,0,0 -f[-1] ${1--3} -rm[-1]
-gimp_apply_YCbCrcurve_preview[^-1] @-1,2,${-2,-1} -rm[-1]
gimp_apply_YCbCrcurve_configfile :
filename=@{-path_tmp}/.gmic_YCbCrcurve.dlm
-if $filename $filename -else (0,-1,128,-1,128,-1,128,-1,128,-1,128,255,1) -r[-1] 100%,3 -endif
gimp_apply_YCbCrcurve_preview :
(${1--3}) -r[-1] 13,3,1,1,-1 -o[-1] @{-path_tmp}/.gmic_YCbCrcurve.dlm -rm[-1]
-function1d $13,0,$1,\
@{"-if {$2>=0} -u $2,$3, -else -u \"\" -endif"}\
@{"-if {$4>=0} -u $4,$5, -else -u \"\" -endif"}\
@{"-if {$6>=0} -u $6,$7, -else -u \"\" -endif"}\
@{"-if {$8>=0} -u $8,$9, -else -u \"\" -endif"}\
@{"-if {$10>=0} -u $10,$11, -else -u \"\" -endif"}\
255,$12
-function1d $26,0,$14,\
@{"-if {$15>=0} -u $15,$16, -else -u \"\" -endif"}\
@{"-if {$17>=0} -u $17,$18, -else -u \"\" -endif"}\
@{"-if {$19>=0} -u $19,$20, -else -u \"\" -endif"}\
@{"-if {$21>=0} -u $21,$22, -else -u \"\" -endif"}\
@{"-if {$23>=0} -u $23,$24, -else -u \"\" -endif"}\
255,$25
-function1d $39,0,$27,\
@{"-if {$28>=0} -u $28,$29, -else -u \"\" -endif"}\
@{"-if {$30>=0} -u $30,$31, -else -u \"\" -endif"}\
@{"-if {$32>=0} -u $32,$33, -else -u \"\" -endif"}\
@{"-if {$34>=0} -u $34,$35, -else -u \"\" -endif"}\
@{"-if {$36>=0} -u $36,$37, -else -u \"\" -endif"}\
255,$38
-a[-3--1] y -mv[-1] 0
-repeat {@#-1}
--gimp_split_preview[-1] "-gimp_apply_YCbCrcurve 0",$-1
-axes[-1] 0,255,255,0,13,1,255
100%,100% -axes[-1] 0,255,255,0,13,1,255 --dilate[-1] 3 -r[-2] [-3] -j[-3] [-2],0,0,0,0,1,[-1],255 -rm[-2,-1]
-grid[-1] 10%,10%,0,0,0.3,0xCCCCCCCC,255
-line[-1] 0,100%,100%,0,0.3,0xCCCCCCCC,255
-if $-2
[-1],[-1],1,1,-{$-2*255/100} -to_gray[-3] -histogram[-3] 256,0,255 -graph[-1] [-3],3,0,0,0,1,0
-rm[-3] -+[-1] {$-2*255/100} -+[-2,-1] -c[-1] 0,255
-else -rm[-2] -endif
-line[-1] 0,100%,100%,0,0.3,0xCCCCCCCC,255
-sh[0] 0,0,0,0
-graph[-2] [-1],1,0,255,0,1,255,255,255 --[-1] 1
-graph[-2] [-1],1,0,255,0,0.5,200,200,200 -rm[-1]
-sh[0] 1,1,0,0
-graph[-2] [-1],1,0,255,0,1,128,128,255 --[-1] 1
-graph[-2] [-1],1,0,255,0,0.5,0,0,200 -rm[-1]
-sh[0] 2,2,0,0
-graph[-2] [-1],1,0,255,0,1,255,128,128 --[-1] 1
-graph[-2] [-1],1,0,255,0,0.5,200,0,0 -rm[-1]
-if {$40==0}
-_gimp_apply_curve_preview 0,$1,0 -_gimp_apply_curve_preview $2,$3,1
-_gimp_apply_curve_preview $4,$5,2 -_gimp_apply_curve_preview $6,$7,3
-_gimp_apply_curve_preview $8,$9,4 -_gimp_apply_curve_preview $10,$11,5
-_gimp_apply_curve_preview 255,$12,6
-elif {$40==1}
-_gimp_apply_curve_preview 0,$14,0 -_gimp_apply_curve_preview $15,$16,1
-_gimp_apply_curve_preview $17,$18,2 -_gimp_apply_curve_preview $19,$20,3
-_gimp_apply_curve_preview $21,$22,4 -_gimp_apply_curve_preview $23,$24,5
-_gimp_apply_curve_preview 255,$25,6
-else
-_gimp_apply_curve_preview 0,$27,0 -_gimp_apply_curve_preview $28,$29,1
-_gimp_apply_curve_preview $30,$31,2 -_gimp_apply_curve_preview $32,$33,3
-_gimp_apply_curve_preview $34,$35,4 -_gimp_apply_curve_preview $36,$37,5
-_gimp_apply_curve_preview 255,$38,6
-endif
-mv[-1] 1 -done -rm[0]
#@gimp _
#@gimp Decompose channels : gimp_decompose_channels, gimp_decompose_channels_preview
#@gimp : Color basis = choice(7,"RGB","HSV","HSL","HSI","YUV","YCbCr","XYZ","Lab","Lch","CMY","CMYK")
#@gimp : Action = choice("Decompose","Recompose")
#@gimp : Output multiple layers = bool(0)
#@gimp : Include opacity layer = bool(1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_decompose_channels :
-if {!$2}
-if $4 -to_rgba -else -to_rgb -endif
-repeat @# -l[-1]
nm=@{0,n}
-split_opacity -_gimp_decompose_channels$1[0]
-s[0] c -if {!$3} -a x -endif
nb=@#
-nm $nm
-endl -mv[-$nb--1] 0 -done
-else
-channels 0 nbc={3+($1==10)} nb={$nbc+$4}
-if $3 -repeat {int(@#/$nb)} -l[0-{$nb-1}]
-a[0-{$nbc-1}] c -_gimp_recompose_channels$1[0] -a c
-endl -mv[-1] 0 -done
-else -repeat @# -l[$>]
-s x,$nb -a[0-{$nbc-1}] c -_gimp_recompose_channels$1[0] -a c
-endl -mv[-1] 0 -done -endif
-endif
gimp_decompose_channels_preview :
-gimp_decompose_channels ${^0} -append_tiles ,
_gimp_decompose_channels0 :
_gimp_decompose_channels1 : -rgb2hsv8
_gimp_decompose_channels2 : -rgb2hsl8
_gimp_decompose_channels3 : -rgb2hsi8
_gimp_decompose_channels4 : -rgb2yuv8
_gimp_decompose_channels5 : -rgb2ycbcr
_gimp_decompose_channels6 : -rgb2xyz8
_gimp_decompose_channels7 : -rgb2lab8
_gimp_decompose_channels8 : -rgb2lch8
_gimp_decompose_channels9 : -rgb2cmy
_gimp_decompose_channels10 : -rgb2cmyk
_gimp_recompose_channels0 :
_gimp_recompose_channels1 : -hsv82rgb
_gimp_recompose_channels2 : -hsl82rgb
_gimp_recompose_channels3 : -hsi82rgb
_gimp_recompose_channels4 : -yuv82rgb
_gimp_recompose_channels5 : -ycbcr2rgb
_gimp_recompose_channels6 : -xyz82rgb
_gimp_recompose_channels7 : -lab82rgb
_gimp_recompose_channels8 : -lch82rgb
_gimp_recompose_channels9 : -cmy2rgb
_gimp_recompose_channels10 : -cmyk2rgb
#@gimp Detect skin : gimp_detect_skin, gimp_detect_skin_preview(1)
#@gimp : Skin estimation = choice(1,"Manual","Automatic")
#@gimp : Sep = separator()
#@gimp : Tolerance = float(0.5,0,1)
#@gimp : Smoothness = float(0.5,0,5)
#@gimp : Threshold = float(1,0,10)
#@gimp : Pre-normalize image = bool(1)
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Manual estimation:</b>\n
#@gimp : Use the sliders below to target as much skin pixels as you can.</small>")
#@gimp : X-coordinate = float(50,0,100)
#@gimp : Y-coordinate = float(50,0,100)
#@gimp : Radius = float(5,0,25)
#@gimp : Sep = separator()
#@gimp : Output mode = choice(1,"Probability map","Opaque skin","Transparent skin")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/03/2014</i>.</small>")
gimp_detect_skin :
-to_rgb
-m "_gimp_detect_skin :
-if $5 -balance_gamma 128,128,128 -endif
-if $1 -detect_skin $2 -else -detect_skin $2,$6%,$7%,$8% -endif
M={iM} -b $3% -* {255*$M/iM} -* $4 -c 0,255"
-repeat @# -l[$>]
-if $9
--_gimp_detect_skin -a c
-if {$9>1} -sh 100%,100% -*[-1] -1 -+[-1] 255 -rm[-1] -endif
-else -_gimp_detect_skin
-endif
-endl -done
-uncommand _gimp_detect_skin
gimp_detect_skin_preview :
-gimp_split_preview "-gimp_detect_skin $*",$-1
-to_rgba
-if {!$1}
-circle $6%,$7%,$8%,0.3,0,255,0,255
-circle $6%,$7%,$8%,1,0xFFFFFFFF,0,255,0,255
-line {$6-0.25*$8}%,{$7-0.25*$8}%,{$6+0.25*$8}%,{$7+0.25*$8}%,1,255,255,0,255
-line {$6+0.25*$8}%,{$7-0.25*$8}%,{$6-0.25*$8}%,{$7+0.25*$8}%,1,255,255,0,255
-endif
#@gimp Equalize HSV : gimp_hsv_equalizer, gimp_hsv_equalizer_preview
#@gimp : Preview bands = bool(false)
#@gimp : Sep = separator()
#@gimp : Hue band = float(180,0,360)
#@gimp : Band width = float(40,1,360)
#@gimp : Hue shift = float(0,-180,180)
#@gimp : Saturation correction = float(0,-0.99,0.99)
#@gimp : Value correction = float(0,-0.99,0.99)
#@gimp : Sep = separator()
#@gimp : Hue band = float(180,0,360)
#@gimp : Band width = float(40,1,360)
#@gimp : Hue shift = float(0,-180,180)
#@gimp : Saturation correction = float(0,-0.99,0.99)
#@gimp : Value correction = float(0,-0.99,0.99)
#@gimp : Sep = separator()
#@gimp : Hue band = float(180,0,360)
#@gimp : Band width = float(40,1,360)
#@gimp : Hue shift = float(0,-180,180)
#@gimp : Saturation correction = float(0,-0.99,0.99)
#@gimp : Value correction = float(0,-0.99,0.99)
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author: <i>J&#233;rome Ferrari</i>.      Latest update: <i>01/14/2011</i>.</small>")
#@gimp : Note = link("Filter explained here","http://www.flickr.com/groups/gmic/discuss/72157625798533482")
gimp_hsv_equalizer :
-repeat @# -l[@{>,-1}]
-to_rgb -rgb2hsv -s c
--f[0] if(abs(i-$2)<$3/2|abs(i-$2-360)<$3/2|abs(i-$2+360)<$3/2,1,0)
--f[0] if(abs(i-$7)<$8/2|abs(i-$7-360)<$8/2|abs(i-$7+360)<$8/2,1,0)
--f[0] if(abs(i-$12)<$13/2|abs(i-$12-360)<$13/2|abs(i-$12+360)<$13/2,1,0)
--threshold[1,2] 0.01 -*[-1,-2] [-1]x2 -*[-1,3] -*[-1,4] -*[-1,5]
--*[3] $4 --*[4] $9 --*[5] $14 -+[-1,-2,-3]
-+[-1,0] -%[0] 360
-if {$5>=0} --*[3] -$5 -else --*[3] {1/(1+$5)-1} -endif -+[-1] 1
-if {$10>=0} --*[4] -$10 -else --*[4] {1/(1+$10)-1} -endif -+[-1] 1
-if {$15>=0} --*[5] -$15 -else --*[5] {1/(1+$15)-1} -endif -+[-1] 1
-*[-1,-2,-3] -^[1,-1]
-if {$6>=0} --*[3] -$6 -else --*[3] {1/(1+$6)-1} -endif -+[-1] 1
-if {$11>=0} --*[4] -$11 -else --*[4] {1/(1+$11)-1} -endif -+[-1] 1
-if {$16>=0} --*[5] -$16 -else --*[5] {1/(1+$16)-1} -endif -+[-1] 1
-*[-1,-2,-3] -^[2,-1]
-rm[3,4,5] -a[0,1,2] c -hsv2rgb
-endl -done
gimp_hsv_equalizer_preview :
-l[-1]
-if {$1==0} -gimp_hsv_equalizer $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16
-else
-to_rgb -rgb2hsv -s c
(0,359) -r[-1] [-2],{@{0,h}/10},1,1,3 [-1] -f[-1] 1
-j[0] [3],0,91% -j[1] [4],0,91% -j[2] [4],0,91% -rm[-1,-2]
--f[0] if(abs(i-$2)<$3/2|abs(i-$2-360)<$3/2|abs(i-$2+360)<$3/2,1,0)
--f[0] if(abs(i-$7)<$8/2|abs(i-$7-360)<$8/2|abs(i-$7+360)<$8/2,1,0)
--f[0] if(abs(i-$12)<$13/2|abs(i-$12-360)<$13/2|abs(i-$12+360)<$13/2,1,0)
-or[-3--1] -+[-1] 0.33 -/[-1] 1.33
-*[2,-1] -a c -hsv2rgb
-endif -endl
#@gimp HSL adjustment : gcd_hsl, gcd_hsl_preview(1)
#@gimp : Note = note("\n<i>Input Saturation Settings</i>"), sep = separator()
#@gimp : Contrast = float(1,0,2)
#@gimp : Level = float(0,-1,1)
#@gimp : Auto reduce level (level slider is disabled) = bool(0)
#@gimp : Note = note("\n<i>Output Hue Settings</i>"), sep = separator()
#@gimp : Hue = float(180,0,360)
#@gimp : Amount = float(0.2,0,1)
#@gimp : Auto set hue inverse (hue slider is disabled) = bool(0)
#@gimp : Note = note("\n<i>Output Luminance Settings</i>"), sep = separator()
#@gimp : Gamma = float(1,0,2)
#@gimp : Contrast = float(1,0,2)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2014/06/20</i>.</small>")
gcd_hsl : -skip ${1=1},${2=0},${3=0},${4=180},${5=0.2},${6=0},${7=1},${8=1}
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2hsv[0]
-if $6
--channels[0] 0
-histogram[-1] 360,0,360
hue={(xM+180)%360} -rm[-1]
-else hue=$4 -endif
-sh[0] 1,1
-if $3 sat={-max(0,@{-1,a}-0.5)} -else sat=$2 -endif
--[-1] 0.5 -*[-1] $1 -+[-1] $sat
-+[-1] 0.5 -c[-1] 0,1 -rm[-1]
-hsv2rgb[0]
--rgb2ycbcr[0] -channels[-1] 0
-apply_gamma[-1] {max(0.001,$7)}
-if {$8!=1} --[-1] 128 -*[-1] $8 -+[-1] 128 -endif
-c[-1] 0,255
--fc[0] $hue,1,1 -hsv2rgb[-1]
-n[-1] {1-$5},1 -*[0,-1]
-rgb2ycbcr[0]
-channels[0] 1,2 -rv[0,-1] -a[0,-1] c
-ycbcr2rgb[0] -a c
-endl -done
gcd_hsl_preview :
-gimp_split_preview "-gcd_hsl ${1--2}",$-1
#@gimp HSV select : gcd_hsv_select, gcd_hsv_select(2)
#@gimp : Note = note("<i>Color Selection</i>"), sep = separator()
#@gimp : Hue = int(0,0,360)
#@gimp : Saturation = float(0.5,0,1)
#@gimp : Value = float(1,0,1)
#@gimp : Note = note("\n<i>Color Range</i>"), sep = separator()
#@gimp : Hue range = int(180,0,180)
#@gimp : Sat range = float(0.5,0,0.5)
#@gimp : Val range = float(0.5,0,0.5)
#@gimp : Note = note("\n<i>Output Options</i>"), sep = separator()
#@gimp : Grow alpha = int(2,-20,20)
#@gimp : Blur alpha = int(2,0,20)
#@gimp : Note = note("\n<i>Advanced Options</i>"), sep = separator()
#@gimp : Patch size = int(18,3,100)
#@gimp : Fill holes % = int(0,0,50)
#@gimp : Min area % = int(0,0,50)
#@gimp : Show watershed = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2013/02/11</i>.</small>")
gcd_hsv_select :
-skip ${1=0},${2=0.5},${3=1} -skip ${4=180},${5=0.5},${6=0.5}
-skip ${7=2},${8=2} -skip ${9=18},${10=0},${11=0},${12=0}
-repeat @# -l[$>]
-to_rgba[0] -remove_opacity[0]
-if {!$12} [0] -endif
-l[-1]
-gcd_shrink
--rgb2hsv[0] -s[-1] c
bh={$1-$4} th={$1+$4}
--ge[1] {360+$bh} --le[1] {$th-360}
-t2[1] {max($bh,0)},{min($th,360)}
-or[-2,-1] -or[1,-1]
-t2[2] {$2-$5},{$2+$5}
-t2[3] {$3-$6},{$3+$6}
-and[-2,-1] -and[-2,-1]
-meancurvature_flow[0] 3 -median[0] 3
-+[0] 1 --gradient_norm[0] --b[-1] 2,1,1 -min_patch[-1] $9
-*[0,-1] -*[-1] -1
--*[0] [1] -gt[0] 0 -negative[1] -*[0,1] -*[0] 0.5 -max[0,-1]
--watershed[0] [-1] -k[-1] --[-1] 1
-gcd_unshrink
-endl
-if {!$12}
-channels[-1] 0 -ge[-1] 0
--area[-1] 0 --le[-1] {($10%*max(w,h))^2}
--negative[-3] -*[-2,-1] -inpaint[-3] [-1] -rm[-1]
-le[-1] {($11%*max(w,h))^2} -*[-1] [-2]
-inpaint[-2] [-1] -rm[-1] -*[-1] 255
-if {$7>0} -dilate[-1] $7
-elif {$7<0} -erode[-1] {abs($7)} -endif
-if $8 -b[-1] $8,1,1 -endif
-a[-2,-1] c
-endif
-c[-1] 0,255
-endl -done
#@gimp Hue lighten-darken : iain_hue_light_dark_p, iain_hue_light_dark_p
#@gimp : Red = float(0,-255,255)
#@gimp : 2 = float(0,-255,255)
#@gimp : 3 = float(0,-255,255)
#@gimp : Yellow = float(0,-255,255)
#@gimp : 5 = float(0,-255,255)
#@gimp : 6 = float(0,-255,255)
#@gimp : Green = float(0,-255,255)
#@gimp : 8 = float(0,-255,255)
#@gimp : Cyan = float(0,-255,255)
#@gimp : 10 = float(0,-255,255)
#@gimp : 11 = float(0,-255,255)
#@gimp : Blue = float(0,-255,255)
#@gimp : 13 = float(0,-255,255)
#@gimp : 14 = float(0,-255,255)
#@gimp : Magenta = float(0,-255,255)
#@gimp : 16 = float(0,-255,255)
#@gimp : 17 = float(0,-255,255)
#@gimp : 18 = float(0,-255,255)
#@gimp : Sep = separator()
#@gimp : Global = float(0,-255,255)
#@gimp : HSL = bool (0)
#@gimp : Sep = separator()
#@gimp : Sat top = float(255,0,255)
#@gimp : Sat bottom = float(100,0,255)
#@gimp : Value top = float(255,0,255)
#@gimp : Value bottom = float(0,0,255)
#@gimp : Sep = separator()
#@gimp : B&w = bool (0)
#@gimp : Sep = separator()
#@gimp : Parallel processing = choice(0,"Auto","Off")
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author : <i>Iain Fergusson</i>. Update: 4 March 2014 - Added parallel processing option</small>")
iain_hue_light_dark_p:
-repeat @# -l[$>]
-apply_parallel_overlap "-iain_hue_light_dark ${1--2}",0,${-1}
-endl -done
iain_hue_light_dark:
-repeat @# -l[$>] -split_opacity -l[0]
--l[0]
-to_rgb
-if {$20==0}
-rgb2hsv8
-else
-rgb2hsl8
-endif
-s c
--apply_curve[0] 0,0,{128+$1},16,{128+$2},30,{128+$3},42,{128+$4},60,{128+$5},75,{128+$6},85,{128+$7},105,{128+$8},127,{128+$9},135,{128+$10},150,{128+$11},170,{128+$12},180,{128+$13},195,{128+$14},213,{128+$15},225,{128+$16},240,{128+$17},255,{128+$18}
-sub[-1] 128
-add[-1] $19
-add[-1,-2]
-a c
-if {$20==0}
-hsv82rgb
-else
-hsl82rgb
-endif
-endl
--rgb2hsv[0]
-s[-1] c
-keep[0,1,-1,-2]
-mul[-1,-2] 255
-apply_curve[-2] 0,0,0,$22,0,$21,255,255,255
-apply_curve[-1] 0,0,0,$24,0,$23,255,255,255
-mul[-1] [-2]
-div[-1] 255
-remove[-2]
-c[-1] 0,255
-a[1,2] c
-compose_alpha[0,1]
-if {$25==1}
-to_gray
-endif
-endl -a c -endl -done
#@gimp Metallic look : gimp_tk_metallic, gimp_tk_metallic_preview(1)
#@gimp : Strength = float(1,0,1)
#@gimp : Smoothness = float(0,0,20)
#@gimp : Metal = choice("Silver","Gold","Copper","Bronze","Blue steel")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Tom Keil</i>.      Latest update: <i>04/12/2011</i>.</small>")
#@gimp : Note = link("Filter explained here",http://www.tkfilter.bplaced.net/TKFilter%20filter.html)
gimp_tk_metallic :
-repeat @# -l[$>]
-gimp_gaussian_blur $2,0,0,1,1,0,0
-luminance --luminance
-gimp_apply_curve[1] 0,31,111,64,17,110,176,148,75,177,235,186,1,0,0,0,0
-gimp_apply_curve[1] 0,31,111,64,17,110,176,148,75,177,235,186,1,0,0,0,0
-rv[0,1] -gimp_compose_value[0,1] $1,0
-if {$3==1} -gimp_mix_rgb 1,50,0,1,50,0,1,-50,0,0,2,0
-elif {$3==2} -gimp_mix_rgb 1,75,0,1,5,0,1,-25,0,0,2,0
-elif {$3==3} -gimp_mix_rgb 1,70,0,1,40,0,1,-20,0,0,2,0
-elif {$3==4} -gimp_mix_rgb 1,-5,0,1,0,0,1.1,12,0,0,2,0
-endif -endl -done
gimp_tk_metallic_preview :
-gimp_split_preview "-gimp_tk_metallic ${1--2}",$-1
#@gimp Mixer [CMYK] : gimp_mix_cmyk, gimp_mix_cmyk_preview(1)
#@gimp : Cyan contrast = float(1,0,4)
#@gimp : Cyan brightness = float(0,-255,255)
#@gimp : Cyan smoothness = float(0,0,10)
#@gimp : Magenta contrast = float(1,0,4)
#@gimp : Magenta brightness = float(0,-255,255)
#@gimp : Magenta smoothness = float(0,0,10)
#@gimp : Yellow contrast = float(1,0,4)
#@gimp : Yellow brightness = float(0,-255,255)
#@gimp : Yellow smoothness = float(0,0,10)
#@gimp : Key contrast = float(1,0,4)
#@gimp : Key brightness = float(0,-255,255)
#@gimp : Key smoothness = float(0,0,10)
#@gimp : Note = note()
#@gimp : Tones range = choice("All tones","Shadows","Mid-tones","Highlights")
#@gimp : Tones smoothness = float(2,0,10)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_mix_cmyk :
-repeat @# -l[-1] -split_opacity -rv -to_rgb[-1]
-gimp_start_mix $13,$14
-rgb2cmyk[-1] -s[-1] c
-*[-4] $1 -+[-4] $2 -b[-4] $3%
-*[-3] $4 -+[-3] $5 -b[-3] $6%
-*[-2] $7 -+[-2] $8 -b[-2] $9%
-*[-1] $10 -+[-1] $11 -b[-1] $12%
-a[-4--1] c -cmyk2rgb[-1]
-gimp_end_mix $13
-if {@#!=3} -rv -a c -endif -endl -mv[-1] 0 -done
gimp_mix_cmyk_preview :
-gimp_split_preview "-gimp_mix_cmyk $*",$-1
#@gimp Mixer [HSV] : gimp_mix_hsv, gimp_mix_hsv_preview(1)
#@gimp : Hue contrast = float(1,0,4)
#@gimp : Hue brightness = float(0,-180,180)
#@gimp : Hue smoothness = float(0,0,10)
#@gimp : Saturation contrast = float(1,0,4)
#@gimp : Saturation brightness = float(0,-1,1)
#@gimp : Saturation smoothness = float(0,0,10)
#@gimp : Value contrast = float(1,0,4)
#@gimp : Value brightness = float(0,-1,1)
#@gimp : Value smoothness = float(0,0,10)
#@gimp : Note = note()
#@gimp : Tones range = choice("All tones","Shadows","Mid-tones","Highlights")
#@gimp : Tones smoothness = float(2,0,10)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_mix_hsv :
-repeat @# -l[-1] -split_opacity -rv -to_rgb[-1]
-gimp_start_mix $10,$11
-rgb2hsv[-1] -s[-1] c --[-2,-1] 0.5
-*[-3] $1 -+[-3] $2 -b[-3] $3%
-*[-2] $4 -+[-2] $5 -b[-2] $6%
-*[-1] $7 -+[-1] $8 -b[-1] $9%
-%[-3] 360 -+[-2,-1] 0.5 -c[-2,-1] 0,1 -a[-3--1] c -hsv2rgb[-1]
-gimp_end_mix $10
-if {@#!=3} -rv -a c -endif -endl -mv[-1] 0 -done
gimp_mix_hsv_preview :
-gimp_split_preview "-gimp_mix_hsv $*",$-1
#@gimp Mixer [Lab] : gimp_mix_lab, gimp_mix_lab_preview(1)
#@gimp : Lightness contrast = float(1,0.5,1.5)
#@gimp : Lightness brightness = float(0,-50,50)
#@gimp : Lightness smoothness = float(0,0,10)
#@gimp : A-color contrast = float(1,0,4)
#@gimp : A-color brightness = float(0,-20,20)
#@gimp : A-color smoothness = float(0,0,10)
#@gimp : B-color contrast = float(1,0,4)
#@gimp : B-color brightness = float(0,-20,20)
#@gimp : B-color smoothness = float(0,0,10)
#@gimp : Note = note()
#@gimp : Tones range = choice("All tones","Shadows","Mid-tones","Highlights")
#@gimp : Tones smoothness = float(2,0,10)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_mix_lab :
-repeat @# -l[$>] -split_opacity -to_rgb[0]
-gimp_parallel_overlap[0] "-_gimp_mix_lab $*",0,{3*max($3,$6,$9)}
-a c
-endl -mv[$>] 0 -done
_gimp_mix_lab :
-gimp_start_mix $10,$11
-rgb2lab[-1] -s[-1] c
-*[-3] $1 -+[-3] $2 -b[-3] $3%
-*[-2] $4 -+[-2] $5 -b[-2] $6%
-*[-1] $7 -+[-1] $8 -b[-1] $9%
-a[-3--1] c -lab2rgb[-1]
-gimp_end_mix $10
gimp_mix_lab_preview :
-gimp_split_preview "-gimp_mix_lab $*",$-1
#@gimp Mixer [RGB] : gimp_mix_rgb, gimp_mix_rgb_preview(1)
#@gimp : Red contrast = float(1,0,4)
#@gimp : Red brightness = float(0,-255,255)
#@gimp : Red smoothness = float(0,0,10)
#@gimp : Green contrast = float(1,0,4)
#@gimp : Green brightness = float(0,-255,255)
#@gimp : Green smoothness = float(0,0,10)
#@gimp : Blue contrast = float(1,0,4)
#@gimp : Blue brightness = float(0,-255,255)
#@gimp : Blue smoothness = float(0,0,10)
#@gimp : Note = note()
#@gimp : Tones range = choice("All tones","Shadows","Mid-tones","Highlights")
#@gimp : Tones smoothness = float(2,0,10)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_start_mix :
-if {$1==1} --tones[-1] 3 -+[-2,-1] -b[-2,-1] $2% -r[-2,-1] [-3] -*[-1] [-3] -mv[-3] @#
-elif {$1==2} --tones[-1] 3 -+[-3,-1] -b[-2,-1] $2% -r[-2,-1] [-3] -*[-2] [-3] -mv[-3] @#
-elif {$1==3} --tones[-1] 3 -+[-3,-2] -b[-2,-1] $2% -r[-2,-1] [-3] -*[-2] [-3] -mv[-3] @#
-endif
gimp_end_mix :
-if {$1==1} -*[-3,-1] -+[-2,-1]
-elif {$1==2} -*[-2,-1] -+[-2,-1]
-elif {$1==3} -*[-2,-1] -+[-2,-1]
-endif
gimp_mix_rgb :
-repeat @# -l[-1] -split_opacity -rv -to_rgb[-1]
-gimp_start_mix $10,$11
--[-1] 128 -s[-1] c
-*[-3] $1 -+[-3] $2 -b[-3] $3%
-*[-2] $4 -+[-2] $5 -b[-2] $6%
-*[-1] $7 -+[-1] $8 -b[-1] $9%
-a[-3--1] c -+[-1] 128 -c[-1] 0,255
-gimp_end_mix $10
-if {@#!=3} -rv -a c -endif -endl -mv[-1] 0 -done
gimp_mix_rgb_preview :
-gimp_split_preview "-gimp_mix_rgb $*",$-1
#@gimp Mixer [YCbCr] : gimp_mix_ycbcr, gimp_mix_ycbcr_preview(1)
#@gimp : Luminance contrast = float(1,0,4)
#@gimp : Luminance brightness = float(0,-255,255)
#@gimp : Luminance smoothness = float(0,0,10)
#@gimp : Blue chroma contrast = float(1,0,4)
#@gimp : Blue chroma brightness = float(0,-255,255)
#@gimp : Blue chroma smoothness = float(0,0,10)
#@gimp : Red chroma contrast = float(1,0,4)
#@gimp : Red chroma brightness = float(0,-255,255)
#@gimp : Red chroma smoothness = float(0,0,10)
#@gimp : Note = note()
#@gimp : Tones range = choice("All tones","Shadows","Mid-tones","Highlights")
#@gimp : Tones smoothness = float(2,0,10)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_mix_ycbcr :
-repeat @# -l[-1] -split_opacity -rv -to_rgb[-1]
-gimp_start_mix $10,$11
-rgb2ycbcr[-1] --[-1] 128 -s[-1] c
-*[-3] $1 -+[-3] $2 -b[-3] $3%
-*[-2] $4 -+[-2] $5 -b[-2] $6%
-*[-1] $7 -+[-1] $8 -b[-1] $9%
-a[-3--1] c -+[-1] 128 -c[-1] 0,255 -ycbcr2rgb[-1]
-gimp_end_mix $10
-if {@#!=3} -rv -a c -endif -endl -mv[-1] 0 -done
gimp_mix_ycbcr_preview :
-gimp_split_preview "-gimp_mix_ycbcr $*",$-1
#@gimp RGB tone : iain_rgb_tone, iain_rgb_tone
#@gimp : Note = note{"<b>Adjust Reds</b> for pixels that have:"}
#@gimp : Little red = float(0,-255,255)
#@gimp : Some red = float(0,-255,255)
#@gimp : Much red = float(0,-255,255)
#@gimp : Note = note{"<b>Adjust Reds</b> for pixels that have:"}
#@gimp : Little green = float(0,-255,255)
#@gimp : Some green = float(0,-255,255)
#@gimp : Much green = float(0,-255,255)
#@gimp : Note = note{"<b>Adjust Reds</b> for pixels that have:"}
#@gimp : Little blue = float(0,-255,255)
#@gimp : Some blue = float(0,-255,255)
#@gimp : Much blue = float(0,-255,255)
#@gimp : Sep = separator(xx)
#@gimp : Note = note{"<b>Adjust Greens</b> for pixels that have:"}
#@gimp : Little red = float(0,-255,255)
#@gimp : Some red = float(0,-255,255)
#@gimp : Much red = float(0,-255,255)
#@gimp : Note = note{"<b>Adjust Greens</b> for pixels that have:"}
#@gimp : Little green = float(0,-255,255)
#@gimp : Some green = float(0,-255,255)
#@gimp : Much green = float(0,-255,255)
#@gimp : Note = note{"<b>Adjust Greens</b> for pixels that have:"}
#@gimp : Little blue = float(0,-255,255)
#@gimp : Some blue = float(0,-255,255)
#@gimp : Much blue = float(0,-255,255)
#@gimp : Sep = separator()
#@gimp : Note = note{"<b>Adjust Blues</b> for pixels that have:"}
#@gimp : Little red = float(0,-255,255)
#@gimp : Some red = float(0,-255,255)
#@gimp : Much red = float(0,-255,255)
#@gimp : Note = note{"<b>Adjust Blues</b> for pixels that have:"}
#@gimp : Little green = float(0,-255,255)
#@gimp : Some green = float(0,-255,255)
#@gimp : Much green = float(0,-255,255)
#@gimp : Note = note{"<b>Adjust Blues</b> for pixels that have:"}
#@gimp : Little blue = float(0,-255,255)
#@gimp : Some blue = float(0,-255,255)
#@gimp : Much blue = float(0,-255,255)
#@gimp : Sep = separator()
#@gimp : Note = note{"Strength of effect for Saturation level:"}
#@gimp : None = float(255,0,255)
#@gimp : Little = float(255,0,255)
#@gimp : Some = float(255,0,255)
#@gimp : Much = float(255,0,255)
#@gimp : Most = float(255,0,255)
#@gimp : Sep = separator()
#@gimp : Output = choice(0,"Perserve Luminance","Clip","Scale")
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author : <i>Iain Fergusson</i>.</small>")
iain_rgb_tone:
-repeat @# -l[$>] -split_opacity -l[0]
-to_rgb
--split c
--apply_curve[1] 0,0,$1,128,$2,255,$3
--apply_curve[2] 0,0,$4,128,$5,255,$6
--apply_curve[3] 0,0,$7,128,$8,255,$9
-add[-1,-2,-3]
--apply_curve[1] 0,0,$10,128,$11,255,$12
--apply_curve[2] 0,0,$13,128,$14,255,$15
--apply_curve[3] 0,0,$16,128,$17,255,$18
-add[-1,-2,-3]
--apply_curve[1] 0,0,$19,128,$20,255,$21
--apply_curve[2] 0,0,$22,128,$23,255,$24
--apply_curve[3] 0,0,$25,128,$26,255,$27
-add[-1,-2,-3]
-add[1,4]
-add[2,4]
-add[3,4]
-a[-1,-2,-3] c
--sub[0,1]
--rgb2hsv[0] -split[-1] c -remove[-1,-3] -mul[-1] 255
-apply_curve[-1] 0,0,$28,64,$29,128,$30,192,$31,255,$32
-compose_multiply[-1,-2]
--sub[0,-1]
-if {$33==0}
-luminance[0]
--luminance[-1]
-compose_grainextract[-1,-2]
-compose_grainmerge[0,-1]
-keep[0]
-endif
-if {$33==1}
-keep[-1]
-c 0,255
-endif
-if {$33==2}
-keep[-1]
-n 0,255
-endif
-endl -a c -endl -done
#
####################################
#@gimp Saturation equalizer : Saturation_EQ_p, Saturation_EQ_p
#@gimp : Note = note{"<b>Lightness</b>"}
#@gimp : Black = float(0,-128,128)
#@gimp : Near black = float(0,-128,128)
#@gimp : Dark grey = float(0,-128,128)
#@gimp : Mid-dark grey = float(0,-128,128)
#@gimp : Middle grey = float(0,-128,128)
#@gimp : Mid-light grey = float(0,-128,128)
#@gimp : Light grey = float(0,-128,128)
#@gimp : Highlights = float(0,-128,128)
#@gimp : White = float(0,-128,128)
#@gimp : Sep = separator()
#@gimp : Note = note{"<b>Hue</b>"}
#@gimp : 0 = float(0,-128,128)
#@gimp : 45 = float(0,-128,128)
#@gimp : 90 = float(0,-128,128)
#@gimp : 135 = float(0,-128,128)
#@gimp : 180 = float(0,-128,128)
#@gimp : 225 = float(0,-128,128)
#@gimp : 270 = float(0,-128,128)
#@gimp : 315 = float(0,-128,128)
#@gimp : 360 = float(0,-128,128)
#@gimp : Rotate hue bands = float (0,-45,45)
#@gimp : Sep = separator()
#@gimp : Parallel processing = choice(0,"Auto","Off")
#@gimp : Sep = separator()
#@gimp : Note = note{"This filter allows you to adjust the Saturation based on the Lightness or Hue of the pixel. The <i>Rotate Hue Bands</i> control allows you shift the hue that each band controls by 45 degrees."}
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author : <i>Iain Fergusson</i>. Update: 4 March 2014 - Added parallel processing option</small>")
Saturation_EQ_p:
-repeat @# -l[$>]
-apply_parallel_overlap "-Saturation_EQ ${1-19}",
-endl -done
Saturation_EQ:
-repeat @# -l[$>] -split_opacity -l[0]
-to_rgb -rgb2hsl8
-split[-1] c
--apply_curve[2] .5,0,{128+$1},31,{128+$2},63,{128+$3},95,{128+$4},128,{128+$5},160,{128+$6},192,{128+$7},224,{128+$8},255,{128+$9}
--+[0] {((($19/360)*255))*-1}
-mod[-1] 255
-apply_curve[-1] .5,0,{128+$10},31,{128+$11},63,{128+$12},95,{128+$13},128,{128+$14},160,{128+$15},192,{128+$16},224,{128+$17},255,{128+$18}
-sub[-1,-2] 128
-add[-1,-2]
-mul[-1] 2
-add[1,3]
-c[1] 0,255
-append c
-hsl82rgb
-endl -a c -endl -done
#@gimp Select-replace color : gimp_select_color, gimp_select_color_preview(0)
#@gimp : Similarity space = choice(0,"RGB[A]","RGB","YCbCr","Red","Green","Blue","Opacity","Luminance","Blue & Red chrominances","Hue","Saturation")
#@gimp : Tolerance = float(20,0,100)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Fill holes = int(0,0,256)
#@gimp : Selected color = color(255,255,255,255)
#@gimp : Output as = choice(0,"Selected colors","Selected mask","Rejected colors","Rejected mask","Replaced color")
#@gimp : Replacement color = color(255,0,0,255)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
_gimp_select_color :
-if {$1==1} -to_rgb
-elif {$1==2} -to_rgb -rgb2ycbcr
-elif {$1==3} -channels 0
-elif {$1==4} -channels 1
-elif {$1==5} -channels 2
-elif {$1==6} -to_rgba -channels 3
-elif {$1==7} -to_rgb -rgb2ycbcr -channels 0
-elif {$1==8} -to_rgb -rgb2ycbcr -channels 1,2
-elif {$1==9} -to_rgb -rgb2hsv -channels 0
-elif {$1==10} -to_rgb -rgb2hsv -channels 1
-endif
gimp_select_color :
($5^$6^$7^$8) -_gimp_select_color[-1] $1 color=@-1 -rm[-1]
-repeat @# -l[$>] -to_rgba
--_gimp_select_color $1
-select_color[1] $2%,$color
-if $4 --area[-1] 0,0 -<=[-1] {round($4^1.5)} -inpaint[-2] [-1],0,3 -rm[-1] -endif
-b[1] $3 -n[1] 0,255
-if {$9==0} -sh[0] 100%,100% -and[-1] [1]
-elif {$9==1} -rm[0]
-elif {$9==2} --[1] 255 -*[1] -1 -sh[0] 100%,100% -and[-1] [1]
-elif {$9==3} -rm[0] -- 255 -* -1
-else
-/[1] 255 --*[0,1] --*[1] $11 --*[1] $12 --*[1] $13 -*[1] $10 -a[1,-3--1] c --[1,2] -+
-endif
-k[0]
-endl -done
gimp_select_color_preview :
-gimp_split_preview "-gimp_select_color $*",$-1
#@gimp Sepia : gimp_sepia, gimp_sepia_preview
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_sepia :
-sepia
-repeat @#
-sh[-1] 0,2 -apply_gamma[-1] {10^$1} --[-1] 128 -*[-1] $2 -+[-1] {128+$3} -c[-1] 0,255
-rm[-1] -mv[-1] 0 -done
gimp_sepia_preview :
-gimp_split_preview "-gimp_sepia $*",$-1
#@gimp Tone presets : iain_tone_presets_p, iain_tone_presets_p
#@gimp : Preset = choice("Whiter Whites","Warm Vintage","Magenta-Yellow","Velvetia","Seventies Magazine","Faded Print","Expired 69","Modern Film")
#@gimp : Strength = float (100,-200,200)
#@gimp : Scale output = bool (0)
#@gimp : Sep = separator()
#@gimp : Parallel processing = choice(0,"Auto","Off")
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author : <i>Iain Fergusson</i>. Update: 4 March 2014 - Added parallel processing option</small>")
iain_tone_presets_p:
-repeat @# -l[$>]
-apply_parallel_overlap "-iain_tone_presets ${1--2}",0,${-1}
-endl -done
iain_tone_presets:
-repeat @# -l[$>] -split_opacity -l[0]
-if {$1==0}
--iain_rgb_tone 00,10,00,00,00,00,00,00,00,00,00,00,00,10,00,00,00,00,00,20,00,00,20,00,00,00,00,255,0,0,0,0,0
-endif
-if {$1==1}
--iain_cmyk_tone 00,00,00,00,00,00,-8,-20,00,00,00,-49,00,00,00,00,00,00,00,-25,00,00,17,0,00,00,00,00,00,00,35,-25,17,8,26,31,00,00,00,00,17,00,-9,-31,29,00,00,-9,188,255,181,133,72,1
-endif
-if {$1==2}
--iain_cmyk_tone 00,-38,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,-164,88,255,00,00,00,00,00,00,00,00,00,65,33,-15,00,00,00,00,00,00,00,00,00,00,00,-25,128,92,62,45,38,1
-endif
-if {$1==3}
--iain_cmyk_tone -25,50,00,25,00,00,25,00,00,00,00,00,025,25,00,-50,00,00,25,00,00,00,00,00,025,00,00,25,00,00,-50,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,36,178,255,169,94,2
-endif
-if {$1==4}
--iain_cmyk_tone 25,-50,00,-25,00,00,-25,00,00,00,00,00,-025,-25,00,50,00,00,-25,00,00,00,00,00,-025,00,00,-25,00,00,50,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,17,120,240,255,255,4
-endif
-if {$1==5}
--iain_cmyk_tone 000,00,00,00,00,00,00,00,00,00,00,-60,000,00,00,00,00,00,00,00,00,-22,40,161,000,00,00,0,00,00,00,00,28,33,33,16,00,00,00,00,00,00,00,00,00,77,-8,-80,255,255,255,255,255,0
-endif
-if {$1==6}
--iain_cmyk_tone 000,00,00,00,00,00,00,00,00,00,00,00,000,00,00,00,00,00,00,00,00,07,-20,-33,000,00,00,00,00,00,00,00,00,48,-65,-77,000,00,00,00,00,00,00,00,00,45,45,00,255,255,255,255,255,0,0
-endif
-if {$1==7}
--iain_cmyk_tone 000,20,00,00,08,00,00,00,00,00,-23,00,000,-13,00,0,17,00,00,00,00,-1,29,00,000,00,00,00,00,-12,00,00,00,19,68,18,000,00,00,00,00,00,00,00,00,-5,55,-15,128,255,255,255,255,0,0
-endif
--sub[0,1]
-mul[-1] {{$2/100}*-1}
-+[0,-1]
-keep[0]
-if {$3==0}
-c 0,255
-else
-n 0,255
-endif
-endl -a c -endl -done
#
#######################################
#@gimp User-defined : gimp_custom_transform, gimp_custom_transform
#@gimp : Red - green - blue - alpha = text{"i"}
#@gimp : Red - green - blue = text{"i + 90*(x/w)*cos(i/10)"}
#@gimp : Red = text{"i"}
#@gimp : Green = text{"i"}
#@gimp : Blue = text{"i"}
#@gimp : Alpha = text{"i"}
#@gimp : Value normalization = choice("None","RGB","RGBA")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_custom_transform :
-to_rgba -repeat @#
-f[-1] "$1"
-s[-1] c -a[-4--2] c -f[-2] "$2"
-s[-2] c -f[-4] "$3" -f[-3] "$4" -f[-2] "$5" -f[-1] "$6"
-if {$7==0} -a[-4--1] c -c[-1] 0,255
-elif {$7==1} -a[-4--2] c -n[-2] 0,255 -c[-1] 0,255 -a[-2,-1] c
-else -a[-4--1] c -n[-1] 0,255
-endif
-mv[-1] 0 -done
#@gimp Vintage style : gimp_tk_vintage, gimp_tk_vintage_preview(1)
#@gimp : Exposure = float(2,-5,5)
#@gimp : Contrast = float(0.85,0.5,1.5)
#@gimp : Saturation = float(0.7,0,4)
#@gimp : Shadows threshold = float(80,0,128)
#@gimp : Highlights threshold = float(200,128,255)
#@gimp : Transition smoothness = float(5,0,50)
#@gimp : Sep = separator()
#@gimp : Color shadows = color(147,26,161)
#@gimp : Strength shadows = float(0.3,0,1)
#@gimp : Color midtones = color(235,220,176)
#@gimp : Strength midtones = float(0.4,0,1)
#@gimp : Color highlights = color(190,181,108)
#@gimp : Strength highlights = float(0.2,0,1)
#@gimp : Color overall effect = color(0,0,100)
#@gimp : Color effect mode = choice("exclusion","overlay","soft  Light","multiply","screen")
#@gimp : Strength effect = float(0.3,0,1)
#@gimp : Sep = separator()
#@gimp : Vignette size = float(25,0,100)
#@gimp : Vignette strenth = float(0,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward  horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Tom Keil</i>.       Latest update: <i>06/04/2011</i>.</small>")
#@gimp : Note = link("Filter explained  here",http://www.tkfilter.bplaced.net/TKFilter%20filter.html)
gimp_tk_vintage :
-repeat @# -l[$>]
-to_rgb[0] --luminance[0] --luminance[0] --luminance[0]
-gimp_mix_lab[0] $2,{$1*10},0,$3,0,0,$3,0,0,0,2,0
-tk_gimp_channel_processing[-1] 1,1,0,0,4,{$4/2.55},100,256,0,1,0,2,0,0
-tk_gimp_channel_processing[-2] 1,1,0,0,4,{$4/2.55},{$5/2.55},256,0,0,0,2,0,0
-tk_gimp_channel_processing[-3] 1,1,0,0,4,0,{$5/2.55},256,0,1,0,2,0,0
-to_gray[-1,-2,-3] -gimp_gaussian_blur[-1,-2,-3] $6,0,0,1,0,0,0
--fc[0] $7,$8,$9 --fc[0] $11,$12,$13 --fc[0] $15,$16,$17 -to_rgba[-1,-2,-3]
-s[-1] c -rv[-1,-9] -compose_multiply[-1,-9] -mv[-8] 9 -a[-4,-3,-2,-1] c
-s[-2] c -rv[-2,-8] -compose_multiply[-2,-8] -mv[-7] 7 -a[-5,-4,-3,-2] c
-s[-3] c -rv[-3,-7] -compose_multiply[-3,-7] -mv[-6] 5 -a[-6,-5,-4,-3] c
--fc[0] $19,$20,$21 -rv[-1,-5]
-if {$22==0} -gimp_compose_exclusion[-1,-5] $23
-elif {$22==1} -gimp_compose_overlay[-1,-5] $23
-elif {$22==2} -gimp_compose_softlight[-1,-5] $23
-elif {$22==3} -gimp_compose_multiply[-1,-5] $23
-elif {$22==4} -gimp_compose_screen[-1,-5] $23
-endif
-rv[-3,-4] -gimp_compose_lighten[-3,-4] $10
-rv[-2,-3] -gimp_compose_overlay[-2,-3] $14
-rv[-1,-2] -gimp_compose_darken[-1,-2] $18
-if {$25!=0}
--fc[0] 255,255,255 -gimp_frame_round[-1] 2,$24,0,0,0,0,0,255,100,0.1,3
-gimp_gaussian_blur[-1] {$6*5},0,0,1,0,0,0
-rv[-1,-2] -gimp_compose_multiply[-1,-2] $25 -endif
-endl -done
gimp_tk_vintage_preview :
-gimp_split_preview "-gimp_tk_vintage ${1--2}",$-1
#@gimp Zone system : gimp_zonesystem, gimp_zonesystem_preview(1)
#@gimp : Shadows zone = int(1,1,5)
#@gimp : Highlights zone = int(10,6,10)
#@gimp : Gamma = float(1,0,5)
#@gimp : Contrast = float(1,0,4)
#@gimp : Black point = int(0,0,255)
#@gimp : White point = int(255,0,255)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Tom Keil</i>.      Latest update: <i>02/13/2011</i>.</small>")
gimp_zonesystem :
-repeat @# -l[$>] -to_rgb -rgb2lab -s c -n[0] {{$1-1}*10}%,{$2*10}%
-a c -lab2rgb -tk_gimp_channel_processing $3,$4,0,0,0,0,100,256,0,0,0,2,7,0
-gimp_apply_curve 0,$5,0,$6,255,-1,128,-1,128,-1,128,255,1,7,0,0,0
-endl -done
gimp_zonesystem_preview :
-gimp_split_preview "-gimp_zonesystem ${1--2}",$-1
#@gimp _
#@gimp <b>Contours</b>
#@gimp Convolve : gimp_convolve, gimp_convolve_preview(0)
#@gimp : Kernel = choice("Custom","Average 3x3","Average 5x5","Average 7x7","Average 9x9","Prewitt-X","Prewitt-Y","Sobel-X","Sobel-Y","Rotinv-X","Rotinv-Y","Laplacian","Robert Cross 1","Robert Cross 2","Impulses 5x5","Impulses 7x7","Impulses 9x9")
#@gimp : Boundary = choice(1,"Dirichlet","Neumann")
#@gimp : Sep = separator(), note = note("<small><b>Note:</b> If parameter <i>Kernel</i> is set to <i>Custom</i>, it uses the custom convolution kernel defined below. Use commas and semicolons as separators for res. matrix columns and rows.</small>")
#@gimp : Custom kernel = text("0,1,0;1,-4,1;0,1,0")
#@gimp : Sep = separator(), note = note("<small><b>Note:</b> Kernel multiplier is useful only when parameter <i>Value range</i> is set to <i>Cut</i>.</small>")
#@gimp : Value range = choice(1,"Cut","Normalize")
#@gimp : Kernel multiplier = float(1,0,50)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>06/06/2013</i>.</small>")
gimp_convolve :
-ac "-_gimp_convolve $1,$2,\"$3\",${4--3}",$-2
_gimp_convolve :
-if $1 -_gimp_convolve$1[] -else ($3) -endif
-if {!$4} -*[-1] $5 -endif
-convolve[0--2] [-1],$2
-if $4 -n 0,255 -else -c 0,255 -endif
-rm[-1]
_gimp_convolve1 : 3,3 -f 1 -normalize_sum
_gimp_convolve2 : 5,5 -f 1 -normalize_sum
_gimp_convolve3 : 7,7 -f 1 -normalize_sum
_gimp_convolve4 : 9,9 -f 1 -normalize_sum
_gimp_convolve5 : (1,0,-1;1,0,-1;1,0,-1)
_gimp_convolve6 : (1,1,1;0,0,0;-1,-1,-1)
_gimp_convolve7 : (1,0,-1;2,0,-2;1,0,-1)
_gimp_convolve8 : (1,2,1;0,0,0;-1,-2,-1)
_gimp_convolve9 : a={0.25*(2-sqrt(2))} b={0.5*(sqrt(2)-1)} ($a,0,-$a;$b,0,-$b;$a,0,-$a)
_gimp_convolve10 : a={0.25*(2-sqrt(2))} b={0.5*(sqrt(2)-1)} ($a,$b,$a;0,0,0;-$a,-$b,-$a)
_gimp_convolve11 : (0,1,0;1,-4,1;0,1,0)
_gimp_convolve12 : (1,0;0,-1)
_gimp_convolve13 : (0,1;-1,0)
_gimp_convolve14 : 3,3 -f 1 -r 7,7,1,1,4,0,0.5,0.5 -autocrop -normalize_sum
_gimp_convolve15 : 3,3 -f 1 -r 9,9,1,1,4,0,0.5,0.5 -autocrop -normalize_sum
_gimp_convolve16 : 3,3 -f 1 -r 11,11,1,1,4,0,0.5,0.5 -autocrop -normalize_sum
gimp_convolve_preview :
-gimp_split_preview "-gimp_convolve $1,$2,\"$3\",${4--1}",$-1
#@gimp Curvature : gimp_curvature, gimp_curvature_preview(0)
#@gimp : Smoothness = float(2,0,10)
#@gimp : Min threshold = float(0,0,100)
#@gimp : Max threshold = float(100,0,100)
#@gimp : Absolute value = bool(0)
#@gimp : Negative colors = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_curvature :
-repeat @# -l[$>] -split_opacity -l[0]
-b $1 -iee
-if $4 -abs -endif
-c $2%,$3%
-if $5 -negative -endif
-n 0,255
-endl -a c -endl -done
gimp_curvature_preview :
-gimp_split_preview "-gimp_curvature ${^0}",$-1
#@gimp Difference of gaussians : gimp_dog, gimp_dog_preview(1)
#@gimp : 1st variance = float(1.4,0,5)
#@gimp : 2nd variance = float(1.5,0,5)
#@gimp : Threshold = float(0,0,49)
#@gimp : Negative colors = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_dog :
-dog $1%,$2%
-c $3%,{100-$3}%
-if $4 -negative -endif
-n 0,255
gimp_dog_preview :
-gimp_split_preview "-gimp_dog ${^0}",$-1
#@gimp Distance transform : gimp_distance, gimp_distance_preview(0)
#@gimp : Value = int(128,0,255)
#@gimp : Metric = choice(2,"Chebyshev","Manhattan","Euclidean","Squared-Euclidean")
#@gimp : Normalization = choice(2,"Cut","Normalize","Modulo")
#@gimp : Modulo value = int(32,1,255)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>04/07/2011</i>.</small>")
gimp_distance :
-repeat @# -l[$>] -split_opacity -l[0]
-distance $1,$2
-if {$3==0} -c 0,255
-elif {$3==1} -n 0,255
-else -% $4 -n 0,255
-endif
-endl -a c -endl -done
gimp_distance_preview :
-gimp_split_preview "-gimp_distance ${^0}",$-1
#@gimp Edges : gimp_edges, gimp_edges_preview(0)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Threshold = float(15,0,50)
#@gimp : Negative colors = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_edges :
-to_rgb -b $1% -edges $2%
-if $3 -negative -endif
-n 0,255
gimp_edges_preview :
-gimp_split_preview "-gimp_edges ${^0}",$-1
#@gimp Edges offsets : gimp_edge_offsets, gimp_edge_offsets_preview(0)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Threshold = float(15,0,50)
#@gimp : Scale = int(4,0,32)
#@gimp : Thickness = int(1,0,16)
#@gimp : Negative colors = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_edge_offsets :
-repeat @#
os={s}
-b[-1] $1% -gradient_norm[-1] ->=[-1] $2% -skeleton[-1] 0 -distance[-1] 1 -round[-1] 1 -%[-1] $3 ->=[-1] {max(1,$3-$4)}
-if {!$5} -negative[-1] -endif
-n[-1] 0,255 -to_colormode[-1] $os
-mv[-1] 0 -done
gimp_edge_offsets_preview :
-gimp_split_preview "-gimp_edge_offsets ${^0}",$-1
#@gimp Extract foreground [interactive] : gimp_extract_foreground, gimp_no_preview
#@gimp : Feathering = _float(0,0,4)
#@gimp : Dilation = int(0,-32,32)
#@gimp : Output mode = choice{3,"RGBA image (full-transparency / 1 layer)","RGBA image (updatable / 1 layer)","RGB image + binary mask (2 layers)","RGBA foreground + background (2 layers)"}
#@gimp : View resolution = _choice{1,"Small (faster)","Medium","High (slower)","Very high (even slower)"}
#@gimp : Sep = separator()
#@gimp : Note = note{"<small><b>Description:</b>\n
#@gimp : This filter allows to quickly extract foreground objects from background in opaque RGB images.
#@gimp : Click on the <i>Apply</i> or <i>OK</i> buttons below to open the interactive window and start adding foreground and background control points.
#@gimp : When you're done, exit the interactive window: your extracted foreground will be transfered back to GIMP.\n\n
#@gimp : If you are not satisfied with the result, click on <i>Apply</i> once again to modify your control points defined previously.
#@gimp : To remove all control points, click on the <i>Reset</i> button below.
#@gimp : </small>"}
#@gimp : Last image size = const(0,0)
#@gimp : Control points = const(-1)
#@gimp : Sep = separator()
#@gimp : Note = note{"<small><b>Interactions:</b>\n
#@gimp : Use the following actions in the interactive window to build your extraction mask :\n\n
#@gimp : - <b>Left mouse button</b> or key <b>F</b> create a new <b>foreground</b> control point (or move an existing one).\n
#@gimp : - <b>Right mouse button</b> or key <b>B</b> create a new <b>background</b> control point (or move an existing one).\n
#@gimp : - <b>Mouse wheel</b>, or keys <b>CTRL+arrows UP/DOWN</b> zoom view in/out.\n
#@gimp : - Key <b>SPACE</b> updates the extraction mask.\n
#@gimp : - Key <b>TAB</b> toggles background view modes.\n
#@gimp : - Key <b>M</b> toggles marker view modes.\n
#@gimp : - Key <b>BACKSPACE</b> deletes the last control point added.\n
#@gimp : - Key <b>PAGE UP</b> increases background opacity.\n
#@gimp : - Key <b>PAGE DOWN</b> decreases background opacity.\n
#@gimp : - Keys <b>CTRL+D</b> increase window size.\n
#@gimp : - Keys <b>CTRL+C</b> decrease window size.\n
#@gimp : - Keys <b>CTRL+R</b> reset window size.\n
#@gimp : - Keys <b>ESC</b>, <b>Q</b> or <b>ENTER</b> exit the interactive window.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>09/29/2014</i>.</small>")
gimp_extract_foreground :
-if {!@#} -return -endif
resolution={arg(1+$3,512,1024,2048,0)}
-repeat @# -l[$<]
nm=@{-gimp_layer_name}
-nm "[G"{`39`}"MIC] Interactive foreground extraction"
-if {$7==-1||$5!=w||$6!=h} _gimp_control_points= -else _gimp_control_points=${7--1} -endif
status=@{-x_segment\ $resolution}
-sh 3,3 -b[-1] $1% -if {$2>0} -dilate[-1] {1+2*$2} -elif {$2<0} -erode[-1] {1-2*$2} -endif
-rm[-1]
-if {$3==1} -sh 3,3 -max[-1] 1 -rm[-1]
-elif {$3==2} -s c,-3 -r[-1] 100%,100%,1,4 -rv -nm[0] name(Mask) -nm[1] name($nm)
-elif {$3==3}
[-1]
-sh[-2] 0,2 --channels[-3] 3,3 ->=[-1] 3 -*[-2,-1] -rm[-1]
-sh[-1] 0,2 --channels[-2] 3,3 -<=[-1] {255-3} -*[-2,-1] -rm[-1]
-sh[-1] 3,3 -*[-1] -1 -+[-1] 255 -rm[-1]
-gimp_autocrop_layers
pos0=@{-gimp_layer_pos[0]} pos1=@{-gimp_layer_pos[1]}
-nm[0] name($nm" [foreground]"),pos($pos0)
-nm[1] name($nm" [background]"),pos($pos1)
-endif
-endl -done
-if {narg($status)>=4} -u \{$1\}\{$2\}\{$3\}\{$4\}\{{w},{h}\}\{$status\} -else -u "" -endif
#@gimp Gradient norm : gimp_gradient_norm, gimp_gradient_norm_preview(0)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Linearity = float(0.5,0,1.5)
#@gimp : Min threshold = float(0,0,100)
#@gimp : Max threshold = float(100,0,100)
#@gimp : Negative colors = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_gradient_norm :
-b $1 -gradient_norm -^ $2
-c $3%,$4%
-if $5 -negative -endif
-n 0,255
gimp_gradient_norm_preview :
-gimp_split_preview "-gimp_gradient_norm ${^0}",$-1
#@gimp Gradient RGB : gimp_gradient2rgb, gimp_gradient2rgb_preview(0)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Min threshold = float(0,0,100)
#@gimp : Max threshold = float(100,0,100)
#@gimp : Orientation only = bool(0)
#@gimp : Negative colors = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_gradient2rgb :
-b $1 -gradient2rgb $4
-c $2%,$3%
-if $5 -negative -endif
-n 0,255
gimp_gradient2rgb_preview :
-gimp_split_preview "-gimp_gradient2rgb ${^0}",$-1
#@gimp Isophotes : gimp_isophotes, gimp_isophotes_preview(0)
#@gimp : Levels = int(8,1,256)
#@gimp : Smoothness = float(0,0,5)
#@gimp : Filling = choice(1,"Transparent","Colors")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_isophotes :
-if $3
-topographic_map $1,$2
-else
-b $2 -isophotes $1
-endif
gimp_isophotes_preview :
-gimp_split_preview "-gimp_isophotes ${^0}",$-1
#@gimp Laplacian : gimp_laplacian, gimp_laplacian_preview(0)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Min threshold = float(0,0,100)
#@gimp : Max threshold = float(100,0,100)
#@gimp : Absolute value = bool(0)
#@gimp : Negative colors = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_laplacian :
-b $1 -laplacian
-if $4 -abs -endif
-c $2%,$3%
-if $5 -negative -endif
-n 0,255
gimp_laplacian_preview :
-gimp_split_preview "-gimp_laplacian ${^0}",$-1
#@gimp Local orientation : gimp_local_orientation, gimp_local_orientation_preview(1)
#@gimp : Smoothness = float(0,0,5)
#@gimp : Min threshold = float(0,0,100)
#@gimp : Max threshold = float(100,0,100)
#@gimp : Negative colors = bool(0)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
_gimp_local_orientation :
-repeat @# -l[$>] -split_opacity -l[0]
-b $1% -gradient_orientation 2 -complex2polar -rm[0--1:2]
-c $2%,$3%
-if $4 -negative -endif
-n 0,255
-endl -a c -endl -done
gimp_local_orientation :
-ac "-_gimp_local_orientation $1,$2,$3,$4",$5,2
gimp_local_orientation_preview :
-gimp_split_preview "-gimp_local_orientation ${^0}",$-1
#@gimp Morphological filter : gimp_morpho, gimp_morpho_preview(0)
#@gimp : Action = choice("Erosion","Dilation","Opening","Closing",
#@gimp : "Original - Erosion","Dilation - Original","Original - Opening","Closing - Original")
#@gimp : Size = int(5,2,60)
#@gimp : Negative = bool()
#@gimp : Shape = choice(0,"Square","Octagonal","Circular")
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Stretch")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/06/2014</i>.</small>")
gimp_morpho :
-ac "-__gimp_morpho ${^0}",$5,$6
gimp_morpho_preview :
-gimp_split_preview "-gimp_morpho ${^0}",$-1
__gimp_morpho :
-if {$4==1} suf="_oct" -elif {$4==0} suf="" -else suf="_circ" -endif
-if {$1==0} -erode$suf $2
-elif {$1==1} -dilate$suf $2
-elif {$1==2} -erode$suf $2 -dilate$suf $2
-elif {$1==3} -dilate$suf $2 -erode$suf $2
-elif {$1==4} -repeat @# --erode$suf $2 --[-2,-1] -mv[-1] 0 -done
-elif {$1==5} -repeat @# --dilate$suf $2 -rv[-2,-1] --[-2,-1] -mv[-1] 0 -done
-elif {$1==6} -repeat @# --erode$suf $2 -dilate$suf[-1] $2 --[-2,-1] -mv[-1] 0 -done
-else -repeat @# --dilate$suf $2 -erode$suf[-1] $2 -rv[-2,-1] --[-2,-1] -mv[-1] 0 -done
-endif
-if $3 -repeat @# -l[$>] -split_opacity -negative[0] -a c -endl -done -endif
#@gimp Segmentation : gimp_segment_watershed, gimp_segment_watershed_preview(0)
#@gimp : Edge threshold = float(2,0,15)
#@gimp : Smoothness = float(1,0,5)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_segment_watershed : -skip ${4=1}
-ac "-b $2 -segment_watershed $1",$3,$4
gimp_segment_watershed_preview :
-gimp_split_preview "-gimp_segment_watershed ${^0}",$-1
#@gimp Skeleton : gimp_skeleton, gimp_skeleton_preview(1)
#@gimp : Method = choice{"Distance (fast)","Thinning (slow)"}
#@gimp : Smoothness = float(0,0,10)
#@gimp : Curviness = float(0,0,10)
#@gimp : Multiple channels = bool(1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>04/07/2011</i>.</small>")
gimp_skeleton :
-remove_opacity
-if {!$4} -norm -endif
-b $2%
-if $1 -thinning -else -skeleton $3% -endif
-* 255
gimp_skeleton_preview :
-gimp_split_preview "-gimp_skeleton ${^0}",$-1
#@gimp Thin edges : gimp_thin_edges, gimp_thin_edges_preview(0)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Threshold = float(15,0,50)
#@gimp : Negative colors = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_thin_edges :
-b $1% -gradient_norm ->= $2% -thinning
-if {!$3} -negative -endif
-n 0,255
gimp_thin_edges_preview :
-gimp_split_preview "-gimp_thin_edges ${^0}",$-1
#@gimp _
#@gimp <b>Deformations</b>
#@gimp Cartesian transform : gimp_custom_deformation, gimp_custom_deformation(1)
#@gimp : X-warping = text{"(w+h)/20 * cos(y*20/h)"}
#@gimp : Y-warping = text{"(w+h)/20 * sin(x*20/w)"}
#@gimp : Relative warping = bool(1)
#@gimp : Interpolation = choice(1,"Nearest neighbor","Linear")
#@gimp : Boundary = choice(1,"Black","Nearest","Repeat")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_custom_deformation :
-repeat @#
--norm[-1] [-1] -f[-2] "$1" -f[-1] "$2"
-a[-2,-1] c -warp[-2] [-1],$3,$4,$5,1 -rm[-1]
-mv[-1] 0 -done
#@gimp Circle transform : gimp_circle_transform, gimp_circle_transform_preview(1)
#@gimp : X-center (%) = float(50,0,100)
#@gimp : Y-center (%) = float(50,0,100)
#@gimp : X-scale = float(-2,-16,16)
#@gimp : Y-scale = float(-2,-16,16)
#@gimp : Radius = float(0.2,0,1)
#@gimp : Symmetry = choice("None","Inside","Outside")
#@gimp : Interpolation = choice(1,"Nearest neighbor","Linear")
#@gimp : Boundary = choice(1,"Transparent","Nearest","Repeat")
#@gimp : Preview reference circle = bool(1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/08/2013</i>.</small>")
gimp_circle_transform :
-repeat @# -l[$>] -to_rgba
r={$5*sqrt(w^2+h^2)}
-if {$6==0} cond="i(X,Y,z,c,$7,$8)"
-elif {$6==1} cond="if(N<"$r",i(X,Y,z,c,$7,$8),i)"
-else cond="if(N>"$r",i(X,Y,z,c,$7,$8),i)"
-endif
-f 'U=x-w*$1%;V=y-h*$2%;N=sqrt(U*U+V*V);Nr=N-$r;X=x+$3*Nr*U/N;Y=y+$4*Nr*V/N;$cond'
-endl -done
gimp_circle_transform_preview :
-gimp_circle_transform $*
-repeat @# -l[$>]
x0={$1%*w}
y0={$2%*h}
r={$5*sqrt(w^2+h^2)}
-if $9
-circle $x0,$y0,{$r-1},1,0xFFFFFFFF,0,0,0,255
-circle $x0,$y0,{$r+1},1,0xFFFFFFFF,0,0,0,255
-circle $x0,$y0,$r,1,0xFFFFFFFF,0,255,0,255
-endif
-endl -done
#@gimp Euclidean - polar : gimp_euclidean2polar, gimp_euclidean2polar(1)
#@gimp : X-center (%) = float(50,0,100)
#@gimp : Y-center (%) = float(50,0,100)
#@gimp : Dilation = float(1,0.1,10)
#@gimp : Boundary = choice(1,"Black","Nearest","Repeat")
#@gimp : Inverse transform = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_euclidean2polar :
-if $5 -polar2euclidean $1%,$2%,$3,$4 -else -euclidean2polar $1%,$2%,$3,$4 -endif
#@gimp Fish-eye : fisheye, fisheye(1)
#@gimp : X-center = float(50,0,100)
#@gimp : Y-center = float(50,0,100)
#@gimp : Radius = float(70,0,100)
#@gimp : Amplitude = float(1,0,2)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp Flower : gimp_flower, gimp_flower(1)
#@gimp : Amplitude = float(30,-100,100)
#@gimp : Petals = int(6,2,20)
#@gimp : Offset = float(0,0,100)
#@gimp : Angle = float(0,0,360)
#@gimp : X-center (%) = float(50,0,100)
#@gimp : Y-center (%) = float(50,0,100)
#@gimp : Boundary = choice(1,"Black","Nearest","Repeat")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_flower :
-flower $1,$2,$3%,$4,$5%,$6%,$7
#@gimp Kaleidoscope [blended] : gimp_rotoidoscope, gimp_rotoidoscope(1)
#@gimp : X-center (%) = float(50,0,100)
#@gimp : Y-center (%) = float(50,0,100)
#@gimp : Angular tiles = int(10,1,72)
#@gimp : Smoothness = float(0.5,0,5)
#@gimp : Boundary = choice(2,"Black","Nearest","Repeat")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_rotoidoscope :
-rotoidoscope $1%,$2%,$3,$4%,$5
#@gimp Kaleidoscope [polar] : gimp_kaleidoscope, gimp_kaleidoscope(1)
#@gimp : X-center (%) = float(50,0,100)
#@gimp : Y-center (%) = float(50,0,100)
#@gimp : X-offset (%) = float(0,0,100)
#@gimp : Y-offset (%) = float(0,0,100)
#@gimp : Radius cut = float(100,0,100)
#@gimp : Angle cut = float(10,0,100)
#@gimp : Boundary = choice(2,"Black","Nearest","Repeat")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_kaleidoscope :
-shift $3%,$4%,0,0,2 -kaleidoscope $1%,$2%,$5,$6,$7
#@gimp Kaleidoscope [symmetry] : gimp_symmetrizoscope, gimp_symmetrizoscope(1)
#@gimp : Iterations = int(4,1,32)
#@gimp : Angle = float(0,0,360)
#@gimp : Boundary = choice(1,"Transparent","Nearest","Repeat")
#@gimp : Symmetry sides = choice("Backward","Forward","Swap")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/07/2013</i>.</small>")
gimp_symmetrizoscope :
-to_rgba -repeat $1
ang={$2+180*$>/max(1,$1-1)}
-symmetrize 50%,50%,$ang,$3,0,{if($4!=2,$4,$>%2)}
-done
#@gimp Perspective : gimp_warp_perspective, gimp_warp_perspective(1)
#@gimp : X-angle = float(1.73,-4,4)
#@gimp : Y-angle = float(0,-4,4)
#@gimp : Zoom = float(1,0.1,4)
#@gimp : X-center = float(50,0,100)
#@gimp : Y-center = float(50,0,100)
#@gimp : X-offset = float(0,0,100)
#@gimp : Y-offset = float(0,0,100)
#@gimp : Boundary = choice(2,"Black","Nearest","Repeat")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_warp_perspective :
-shift $6%,$7%,0,0,2 -warp_perspective $1,$2,$3,$4,$5,$8
#@gimp Polar transform : gimp_transform_polar, gimp_transform_polar(1)
#@gimp : Preset = choice("Custom transform","Inverse radius","Swap radius/angle")
#@gimp : X-center (%) = float(50,0,100)
#@gimp : Y-center (%) = float(50,0,100)
#@gimp : Radius = text{"r + R/10*cos(a*5)"}
#@gimp : Angle = text{"a"}
#@gimp : Boundary = choice(1,"Black","Nearest","Repeat")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_transform_polar :
-if {$1==0}
-transform_polar "$4","$5",$2%,$3%,$6
-elif {$1==1}
-transform_polar R-r,a,$2%,$3%,$6
-else
-transform_polar a*R/(2*pi),r*2*pi/R,$2%,$3%,$6
-endif
#@gimp Raindrops : raindrops, raindrops(0)
#@gimp : Amplitude = float(80,0,300)
#@gimp : Density = float(0.1,0,1)
#@gimp : Wavelength = float(1,0,2)
#@gimp : Merging steps = int(0,0,20)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/28/2012</i>.</small>")
#@gimp Random : deform, deform(0)
#@gimp : Amplitude = float(10,0,100)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp Reflection : gimp_reflect, gimp_reflect(1)
#@gimp : Height = float(50,0,100)
#@gimp : Attenuation = float(1,0.1,4)
#@gimp : Color = color(110,160,190,64)
#@gimp : Waves amplitude = float(0,0,100)
#@gimp : Waves smoothness = float(1.5,0,4)
#@gimp : X-angle = float(0,-10,10)
#@gimp : Y-angle = float(-3.30,-10,10)
#@gimp : Focale = float(7,0,10)
#@gimp : Zoom = float(1.5,1,5)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_reflect :
-repeat @#
-to_rgba[-1] --rows[-1] {100-$1}%,100% -mirror[-1] y -water[-1] $7,$8
-s[-1] c
-f[-4] "(i*(255-$6) + $6*$3)/255"
-f[-3] "(i*(255-$6) + $6*$4)/255"
-f[-2] "(i*(255-$6) + $6*$5)/255" -a[-4--1] c
-*[-1] '(h^$2-y^$2)/h^$2' -a[-2,-1] y
100%,100%,100%,1,$11*$12*(x/w-0.5)
100%,100%,100%,1,$11*$12*(y/h-0.5)
100%,100%,100%,1,"$10*(x/w-0.5) + $9*(y/h-0.5) + $11"
-/[-3] [-1] -+[-3] 0.5 -*[-3] @{-3,w}
-/[-2,-1] -+[-1] 0.5 -*[-1] {h}
-a[-2,-1] c -warp[-2] [-1],0,1,0 -rm[-1]
-mv[-1] 0 -done
-autocrop 0,0,0,0
#@gimp Ripple : ripple, ripple(0)
#@gimp : Amplitude = float(10,0,100)
#@gimp : Bandwidth = float(20,1,300)
#@gimp : Shape = choice(2,"Bloc","Triangle","Sine","Sine+","Random")
#@gimp : Angle = float(0,0,360)
#@gimp : Offset = float(0,0,500)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/23/2011</i>.</small>")
#@gimp Seamcarve : gimp_seamcarve, gimp_seamcarve_preview(1)
#@gimp : Width (%) = float(85,0,200)
#@gimp : Height (%) = float(100,0,200)
#@gimp : Maximal seams per iteration (%) = float(15,0,100)
#@gimp : Use top layer as a priority mask = bool(0)
#@gimp : Antialiasing = bool(1)
#@gimp : Sep = separator()
#@gimp : Note = note{"<small><b>Note:</b>
#@gimp : You can define a transparent top layer that will help the seam-carving algorithm to preserve or force removing image structures:\n
#@gimp : \n  - Draw areas in <i>red</i> to force removing them.
#@gimp : \n  - Draw areas in <i>green</i> to preserve them.
#@gimp : \n  - Don't forget also to set the <i>Input layers...</i> parameter to input both layers to the filter.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Garagecoder</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>06/02/2014</i>.</small>")
gimp_seamcarve :
-if $4
-if {@#<2} -error "Priority mask (top layer) is missing!" -endif
-_gimp_seamcarve
-endif
-seamcarve $1%,$2%,$4,$5,$3%
-if $4 -repeat @# -channels[$>] 0,@{$>,s-2} -done -endif
-c 0,255
gimp_seamcarve_preview :
-if $4
-if {@#<2} -to_rgb -text_outline "Priority mask (top layer) is missing!",5,5,18,2 -return -endif
-_gimp_seamcarve
-endif
-repeat @# -l[$>]
w={w} h={h}
-seamcarve $1%,$2%,$4,$5,{max($3,10)}%
-if $4 -channels 0,{s-2} -endif
-to_rgba -r $w,$h,1,100%,0,0,0.5,0.5
-endl -done
-c 0,255
_gimp_seamcarve :
-mv[0] @#
-l[-1]
-s c -k[0,1]
->[1] [0] -!=[0] 0 --[0] [1] -*[0] -1 -+ -* 256
-endl
-repeat {@#-1} -a[$>] [-1],c -done -rm[-1]
#@gimp Sphere : gimp_map_sphere, gimp_map_sphere_preview(1)
#@gimp : Width = _int(512,1,4096)
#@gimp : Height = _int(512,1,4096)
#@gimp : Radius = float(90,0,400)
#@gimp : Dilation = float(0.5,0,1)
#@gimp : Angle = float(0,-50,50)
#@gimp : Border smoothness = float(0,0,200)
#@gimp : Border width = float(20,0,100)
#@gimp : Orientation = choice("0 deg.","90 deg.","180 deg.","270 deg.")
#@gimp : Background = choice("Transparent","Mean color")
#@gimp : Fading = float(0,0,100)
#@gimp : Fading shape = float(0.5,0,3)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/07/2011</i>.</small>")
gimp_map_sphere :
-rotate {$8*90}
-if $6
-repeat @#
-shift[-1] 50%,0,0,0,2 --columns[-1] {(1-$7/100)*w/2},{(1+$7/100)*w/2}
100% -gaussian[-1] {0.1*w},{h},0 100% 100% -a[-3--1] c -r[-1] [-2],[-2],1,3
-smooth[-2] [-1],$6,5,0 -rm[-1]
-j[-2] [-1],{(1-$7/100)*@{-2,w}/2} -rm[-1] -shift[-1] -50%,0,0,0,2
-mv[-1] 0 -done
-endif
-shift $5%,0,0,0,2 -to_rgba
-if $9
-repeat @#
--rows[$>] 0 -r[-1] 1,1,1,4,2 RGBA$>=@-1
-r[-1] [$>],[$>],1,4 --[$>,-1]
-done
-endif
-map_sphere $1,$2,$3,$4,$10,$11
-if $9
-repeat @#
(${RGBA$>}) -y[-1] c -r[-1] [$>],[$>],1,4 -+[$>,-1]
-done
-endif
gimp_map_sphere_preview :
-gimp_map_sphere {w},{h},${3--1}
#@gimp Symmetrize : gimp_symmetrize, gimp_symmetrize_preview(1)
#@gimp : X-center = float(50,0,100)
#@gimp : Y-center = float(50,0,100)
#@gimp : Angle = float(90,0,360)
#@gimp : Boundary = choice(1,"Transparent","Nearest","Repeat")
#@gimp : Type = choice("Symmetry","Antisymmetry")
#@gimp : Swap sides = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/07/2013</i>.</small>")
gimp_symmetrize :
-to_rgba -symmetrize $1%,$2%,$3,$4,$5,$6
gimp_symmetrize_preview :
-gimp_symmetrize $*
theta={$3*pi/180} u={cos($theta)} v={sin($theta)}
-repeat @# -l[$>]
x0={w*$1%}
y0={h*$2%}
x1={$x0-max(w,h)*$u} y1={$y0-max(w,h)*$v}
x2={$x0+max(w,h)*$u} y2={$y0+max(w,h)*$v}
-line $x1,$y1,$x2,$y2,1,0x0F0F0F0F,0
-line $x1,$y1,$x2,$y2,1,0xF0F0F0F0,255
-circle $x0,$y0,3,1,0,255,0,255
-circle $x0,$y0,3,1,0xFFFFFFFF,0,0,0,255
-endl -done
#@gimp Textured glass : gimp_textured_glass, gimp_textured_glass_preview(0)
#@gimp : X-amplitude = float(40,0,400)
#@gimp : Y-amplitude = float(40,0,400)
#@gimp : X-smoothness = float(1,0,5)
#@gimp : Y-smoothness = float(1,0,5)
#@gimp : Edge attenuation = float(0,0,1)
#@gimp : Edge influence = float(2,0,10)
#@gimp : Noise scale = int(0,0,16)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/21/2013</i>.</small>")
gimp_textured_glass :
-repeat @# -l[$>]
100%,100%,1,1
-if $7 -plasma[-1] 1,1,$7 -else -rand[-1] 0,1 -endif
-g[-1] xy
-if $5
--gradient_norm[-3] -+[-1] 1 -b[-1] $6 -^[-1] -$5
-*[-3] [-1] -*[-2,-1]
-endif
-blur_xy[-2,-1] $3,$4
-*[-2] @{-2,$1/max(abs(im),abs(iM))}
-*[-1] @{-1,$2/max(abs(im),abs(iM))}
-a[-2,-1] c
-warp[-2] [-1],1,1 -rm[-1]
-endl -done
gimp_textured_glass_preview :
-gimp_split_preview "-gimp_textured_glass $*",$-1
#@gimp Twirl : gimp_twirl, gimp_twirl(1)
#@gimp : Amplitude = float(1,-5,5)
#@gimp : X-center (%) = float(50,0,100)
#@gimp : Y-center (%) = float(50,0,100)
#@gimp : Boundary = choice(1,"Black","Nearest","Repeat")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_twirl :
-twirl $1,$2%,$3%,$4
#@gimp Water : water, water(0)
#@gimp : Amplitude = float(30,0,300)
#@gimp : Smoothness = float(1.5,0,4)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp Wave : wave, wave(1)
#@gimp : Amplitude = float(10,0,30)
#@gimp : Frequency = float(0.4,0,2)
#@gimp : X-center = float(50,0,100)
#@gimp : Y-center = float(50,0,100)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp Wind : gimp_wind, gimp_wind_preview(0)
#@gimp : Amplitude = int(20,0,500)
#@gimp : Angle = float(0,0,360)
#@gimp : Attenuation = float(0.7,0,1)
#@gimp : Threshold = float(20,0,100)
#@gimp : Mode = choice(1,"Darker","Brighter")
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>07/13/2011</i>.</small>")
gimp_wind :
-if {!$5} -negative -endif
-ac "-wind ${1-4}",$6,$7
-if {!$5} -negative -endif
gimp_wind_preview :
-gimp_split_preview "-gimp_wind $*",$-1
#@gimp Zoom : gimp_zoom, gimp_zoom(1)
#@gimp : Factor = float(2,0.01,10)
#@gimp : X-center = float(50,0,100)
#@gimp : Y-center = float(50,0,100)
#@gimp : Boundary = choice(0,"Black","Nearest","Repeat")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_zoom :
-if {$1<1} -to_rgba -endif
-zoom $1,{$2%},{$3%},0,$4
#@gimp _
#@gimp <b>Degradations</b>
#@gimp Blur [angular] : gimp_blur_angular, gimp_blur_angular_preview(1)
#@gimp : Amplitude = float(2,0,10)
#@gimp : X-center (%) = float(50,0,100)
#@gimp : Y-center (%) = float(50,0,100)
#@gimp : Sharpness = float(0,0,500)
#@gimp : Preview guides = bool(1)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/16/2015</i>.</small>")
gimp_blur_angular :
-ac "-blur_angular $1%,$2%,$3% -sharpen $4",$6,$7
gimp_blur_angular_preview :
-gimp_blur_angular $*
-if $5
-line 0,$3%,100%,$3%,0.5,0xF0F0F0F0,255 -line 0,$3%,100%,$3%,0.5,0x0F0F0F0F,0
-line $2%,0,$2%,100%,0.5,0xF0F0F0F0,255 -line $2%,0,$2%,100%,0.5,0x0F0F0F0F,0
-circle $2%,$3%,5,0.7,0 -circle $2%,$3%,3,0.7,0,255,0
-endif
#@gimp Blur [depth-of-field] : gimp_blur_dof, gimp_blur_dof_preview(1)
#@gimp : Blur amplitude = float(3,0,20)
#@gimp : Blur precision = int(16,2,64)
#@gimp : Depth-of-field type = choice{"Gaussian","User-defined (bottom layer)"}
#@gimp : Invert blur = bool(0)
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Gaussian depth-of-field:</b></small>")
#@gimp : X-center = float(50,0,100)
#@gimp : Y-center = float(50,0,100)
#@gimp : First radius = float(30,0,200)
#@gimp : Second radius = float(30,0,200)
#@gimp : Angle = float(0,0,180)
#@gimp : Sharpness = float(1,0,8)
#@gimp : Preview guides = bool(1)
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>User-defined depth-of-field:</b></small>")
#@gimp : Gamma = float(0,-2,2)
#@gimp : Note = note("<small>You can specify your own depth-of-field image, as a <b>bottom layer</b> image whose luminance encodes the depth for each pixel.
#@gimp : Don't forget to modify the <b>Input layers</b> combo-box to make this layer active for the filter.</small>")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>02/25/2014</i>.</small>")
gimp_blur_dof :
-_$0 ${1-10},0,$12
gimp_blur_dof_preview :
-_gimp_blur_dof $*
_gimp_blur_dof :
-if {!$3}
-repeat @# -l[$>] -if $11 -drgba -endif -split_opacity -l[0]
rmax={(w*w+h*h)^0.5} R={$7*$rmax/100} r={$8*$rmax/100}
t={$9*pi/180} u={cos($t)} v={sin($t)}
l1={($rmax/(1e-8+$R))^2} l2={($rmax/(1e-8+$r))^2}
a={$l1*($u)^2+$l2*($v)^2} b={$u*$v*($l1-$l2)} c={$l1*($v)^2+$l2*($u)^2}
100%,100%,1,1,'X=(x-$5*w/100)/max(w,h);Y=(y-$6*h/100)/max(w,h);f=$a*X*X+2*$b*X*Y+$c*Y*Y;exp(-f^$10/2.5)'
--[1] 1 -*[1] -$1 ms={im} Ms={iM}
-if $11
--isoline3d[1] {0.1*$1} -col3d[-1] 255,255,0
--isoline3d[1] {0.5*$1} -col3d[-1] 255,128,0
-+3d[-2--1]
-__gimp_dof_blur[0,1] $2,$ms,$Ms,$4
[0],[0],1,3 -j3d[-1] [-2],0,0,0,1,1,0,0 -rm[-2]
-circle[-1] $5%,$6%,3,1,255,255,255
--compose_channels[-1] + -!=[-1] 0 -dilate[-1] 3
-j[0] [-2],0,0,0,0,0.5,[-1],1 -rm[-2,-1]
-else -__gimp_dof_blur[0,1] $2,$ms,$Ms,$4
-endif
-endl -if $11 -k[0] -endif -a c -endl -done
-elif {@#>1}
-luminance[-1] -n[-1] 0,1 -^[-1] {10^$12}
-repeat {@#-1} --r[-1] @{$>,w},@{$>,h},1,1,3 -l[$>,-1] -split_opacity[0]
-__gimp_dof_blur[0,-1] $2,0,$1,$4
-a c -endl -done -rm[-1]
-else -drgba -text_outline "Depth-of-field (bottom layer) is missing !",2,2,13,2,1,255
-endif
__gimp_dof_blur :
-n[1] 0,{$1-1} -round[1]
[0],[0],1,@{0,s+1}
s=0
-repeat $1
--==[1] {if($4,$<,$>)} -b[-1] 2%
-j[-2] [0],0,0,0,0,-1,[-1],1
-j[-2] [-1],0,0,0,100%,-1
-rm[-1]
ns={$2+($3-$2)*($>+1)/($1-1)}
-b[0] {sqrt($ns^2-$s^2)}%
s=$ns
-done
-s[-1] c,{-s+1} -/[-2,-1] -rm[0,1]
#@gimp Blur [gaussian] : gimp_gaussian_blur, gimp_gaussian_blur_preview(0)
#@gimp : Xy-amplitude = float(3,0,20)
#@gimp : X-amplitude = float(0,0,20)
#@gimp : Y-amplitude = float(0,0,20)
#@gimp : Border conditions = choice(1,"Black","Nearest")
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
_gimp_gaussian_blur :
-b $1,$4
-if {$2>0} -repeat @# -l[-1] -s y -b $2,$4 -a y -endl -mv[-1] 0 -done -endif
-if {$3>0} -repeat @# -l[-1] -s x -b $3,$4 -a x -endl -mv[-1] 0 -done -endif
gimp_gaussian_blur :
-ac "-_gimp_gaussian_blur $1,$2,$3,$4",$5,$6
gimp_gaussian_blur_preview :
-gimp_split_preview "-gimp_gaussian_blur $*",$-1
#@gimp Blur [glow] : gimp_glow, gimp_glow_preview(0)
#@gimp : Amplitude = float(6,0,20)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_glow :
-ac "-glow $1",$2,$3
gimp_glow_preview :
-gimp_split_preview "-gimp_glow $*",$-1
#@gimp Blur [linear] : gimp_blur_linear, gimp_blur_linear_preview(1)
#@gimp : Tangent radius = float(10,0,100)
#@gimp : Orthogonal radius = float(0.5,0,100)
#@gimp : Angle = float(0,0,180)
#@gimp : Sharpness = float(0,0,500)
#@gimp : Border conditions = choice(1,"Black","Nearest")
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_blur_linear :
-ac "-blur_linear $1,{$2*$1/100},$3,$5 -sharpen $4",$6,$7
gimp_blur_linear_preview :
-gimp_split_preview "-gimp_blur_linear $*",$-1
#@gimp Blur [radial] : gimp_blur_radial, gimp_blur_radial_preview(1)
#@gimp : Amplitude = float(3,0,20)
#@gimp : X-center (%) = float(50,0,100)
#@gimp : Y-center (%) = float(50,0,100)
#@gimp : Sharpness = float(0,0,500)
#@gimp : Preview guides = bool(1)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/16/2015</i>.</small>")
gimp_blur_radial :
-ac "-blur_radial $1%,$2%,$3% -sharpen $4",$6,$7
gimp_blur_radial_preview :
-gimp_blur_radial $*
-if $5
-line 0,$3%,100%,$3%,0.5,0xF0F0F0F0,255 -line 0,$3%,100%,$3%,0.5,0x0F0F0F0F,0
-line $2%,0,$2%,100%,0.5,0xF0F0F0F0,255 -line $2%,0,$2%,100%,0.5,0x0F0F0F0F,0
-circle $2%,$3%,5,0.7,0 -circle $2%,$3%,3,0.7,0,255,0
-endif
#@gimp CRT sub-pixels : gimp_gcd_crt, gimp_gcd_crt(2)
#@gimp : Note = note("<i>Cathode ray tube sub-pixel rendering filter</i>"), sep = separator()
#@gimp : Horizontal blur = float(1.8,0,5)
#@gimp : Vertical blur = float(1.8,0,5)
#@gimp : Screen border = bool(0)
#@gimp : Equalize = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2014/12/11</i>.</small>")
gimp_gcd_crt : -skip ${1=1.8},${2=1.8},${3=0},${4=0}
-repeat @# -l[$>]
-to_rgb[0]
-expand_xy 12,0 24,14,1,3,0
-f[-1] "if((x-c*4)%12<4,255,0)"
-f[-1] "if(x%4==0,0,i)"
-f[-1] "if((y%14==0)&&(x%24<12),0,i)"
-f[-1] "if(((y-7)%14==0)&&((x+12)%24<12),0,i)"
-array[-1] {round(@{0,w}/24)},{round(@{0,h}/14)},2
-z[-1] 0,0,{@{0,w}-1},{@{0,h}-1}
-s c -repeat 3 -blend[-4,-1] shapeaverage0 -done -a c
-n[-1] 0,255 -meancurvature_flow[-1] 4
-if $3
{w},{h},1,1,0
-rectangle[-1] 5%,5%,95%,95%,1,1
-b[-1] 10% -*[0,1]
-endif
-deriche[-1] $1,0,x -deriche[-1] $2,0,y
-shrink_xy[-1] 12 -n[-1] 0,255
-if $4 -equalize[-1] 256 -endif
-endl -done
#@gimp Dirty : gimp_dirty, gimp_dirty_preview(0)
#@gimp : Amplitude = float(30,0,100)
#@gimp : Monochrome = bool(1)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/24/2014</i>.</small>")
gimp_dirty :
-ac "-_gimp_dirty ${1-2}",$3,$4
gimp_dirty_preview :
-gimp_split_preview "-gimp_dirty ${1--2}",$-1
_gimp_dirty :
-repeat @# -l[$>]
-dct 100%,100%,1,{if($2,1,s)} -noise[-1] $1,2
-==[-1] 0 -point[-1] 0,0,0,1,1
-* -idct -c 0,255
-endl -done
#@gimp Lomo : gimp_lomo, gimp_lomo_preview(1)
#@gimp : Vignette size = float(20,0,100)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>J&#233;rome Boulanger</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>06/06/2012</i>.</small>")
gimp_lomo :
-remove_opacity -repeat @# -l[$>] -to_rgb
--gaussian {100-$1}%,{100-$1}% -normalize[-1] 0,1 -*
-s c
-f[0] '255*atan((i-128)/128)'
-f[1] '255*tan((i-128)/128)'
-f[2] '255*atan((i-128)/255)'
-a c
-sharpen 1
-normalize 0,255
-endl -done
gimp_lomo_preview :
-gimp_split_preview "-gimp_lomo $*",$-1
#@gimp Noise [additive] : gimp_noise, gimp_noise_preview(0)
#@gimp : Amplitude = float(10,0,200)
#@gimp : Noise type = choice("Gaussian","Uniform","Salt and pepper","Poisson")
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice(1,"None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_noise :
-ac "-noise $1,$2",$3,$4
gimp_noise_preview :
-gimp_split_preview "-gimp_noise $*",$-1
#@gimp Noise [spread] : gimp_spread, gimp_spread_preview(0)
#@gimp : X-variations = float(4,0,20)
#@gimp : Y-variations = float(4,0,20)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_spread :
-ac "-spread $1,$2",$3,$4
gimp_spread_preview :
-gimp_split_preview "-gimp_spread $*",$-1
#@gimp Old-movie stripes : gimp_stripes_y, gimp_stripes_y_preview(1)
#@gimp : Frequency = float(10,0,100)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_stripes_y :
-ac "-stripes_y $1",$2,$3
gimp_stripes_y_preview :
-gimp_split_preview "-gimp_stripes_y $*",$-1
#@gimp Oldschool 8bits : gimp_8bits, gimp_8bits_preview(0)
#@gimp : Scale = float(25,1,100)
#@gimp : Dithering = float(800,0,10000)
#@gimp : Levels = int(16,2,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/02/2011</i>.</small>")
gimp_8bits :
-remove_opacity -repeat @# -l[$>]
w={w} h={h}
-r $1%,$1%,1,100%,2
--luminance -sharpen[-1] $2 -otsu[-1] 256 -blend[-2,-1] shapeaverage0
-l[-1] -s c -quantize $3,1,1 -a c -endl
-r[-1] $w,$h,1,100%,1
-endl -done
gimp_8bits_preview :
-gimp_split_preview "-gimp_8bits $*",$-1
#@gimp Random shade stripes : gimp_shade_stripes, gimp_shade_stripes_preview(1)
#@gimp : Frequency = float(30,1,100)
#@gimp : Orientation = choice(1,"Horizontal","Vertical")
#@gimp : Darkness = float(0.8,0,3)
#@gimp : Lightness = float(1.3,0,3)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_shade_stripes :
-ac "-shade_stripes $1,$2,$3,$4",$5,$6
gimp_shade_stripes_preview :
-gimp_split_preview "-gimp_shade_stripes $*",$-1
#@gimp Scanlines : gimp_scanlines, gimp_scanlines_preview(0)
#@gimp : Amplitude = float(60,0,255)
#@gimp : Bandwidth = float(2,1,300)
#@gimp : Shape = choice(0,"Bloc","Triangle","Sine","Sine+","Random")
#@gimp : Angle = float(0,0,360)
#@gimp : Offset = float(0,0,500)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/19/2014</i>.</small>")
gimp_scanlines :
-ac "-scanlines ${1-5}",$6,$7
gimp_scanlines_preview :
-gimp_split_preview "-gimp_scanlines $*",$-1
#@gimp Visible watermark : gimp_watermark_visible, gimp_watermark_visible(0)
#@gimp : Text = text{"\251 G'MIC"}
#@gimp : Opacity = float(0.4,0.1,0.9)
#@gimp : Size = int(50,13,128)
#@gimp : Angle = float(25,0,360)
#@gimp : Smoothness = float(0.5,0,5)
#@gimp : Lightness = choice(1,"Darker","Brighter")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_watermark_visible :
-watermark_visible "$1",$2,$3,$4,$6,$5
#@gimp _
#@gimp <b>Details</b>
#@gimp Details equalizer : gimp_equalize_details, gimp_equalize_details_preview(0)
#@gimp : Note = note("<small><b>Coarse scale:</b></small>")
#@gimp : Threshold = float(0,0,10)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Smoothness type = choice(2,"Gaussian","Bilateral","Diffusion")
#@gimp : Gain = float(0,-4,4)
#@gimp : Sep = separator(), note = note("<small><b>Medium scale:</b></small>")
#@gimp : Threshold = float(0,0,10)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Smoothness type = choice(2,"Gaussian","Bilateral","Diffusion")
#@gimp : Gain = float(0,-4,4)
#@gimp : Sep = separator(), note = note("<small><b>Small scale:</b></small>")
#@gimp : Threshold = float(0,0,10)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Smoothness type = choice(2,"Gaussian","Bilateral","Diffusion")
#@gimp : Gain = float(0,-4,4)
#@gimp : Sep = separator(), note = note("<small><b>Fine scale:</b></small>")
#@gimp : Threshold = float(0,0,10)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Smoothness type = choice(2,"Gaussian","Bilateral","Diffusion")
#@gimp : Gain = float(0,-4,4)
#@gimp : Sep = separator(), Channel(s) = choice(7,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(32,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>J&#233;rome Boulanger</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>12/15/2013</i>.</small>")
_gimp_equalize_details :
-repeat @# -l[$>]
-split_details 5,5%,0.5%
-__gimp_equalize_details[1] ${1-4},8
-__gimp_equalize_details[2] ${5-8},4
-__gimp_equalize_details[3] ${9-12},2
-__gimp_equalize_details[4] ${13-16},1
-+ -c 0,255
-endl -done
__gimp_equalize_details :
-threshold $1,1
-if {$3==0} -b {$2*$5/2}
-elif {$3==1}
-if {$2>0}
m={im} M={iM} -n[-1] 0,255
-repeat {int($2/5)} -bilateral 15,{5*$5} -done
-bilateral 15,{($2%5)*$5}
-*[-1] {($M-$m)/255} -+[-1] $m
-endif
-else -smooth {$2*50},0.2,0.8,$5,$5 -endif
-* {10^$4}
gimp_equalize_details :
-ac "-gimp_parallel_overlap \"-_gimp_equalize_details ${1-16}\",$19,$20",$17,$18
gimp_equalize_details_preview :
-gimp_split_preview "-gimp_equalize_details $*",$-1
#@gimp Dynamic range increase : gimp_tk_dri, gimp_tk_dri_preview(1)
#@gimp : Sep = separator()
#@gimp : Map tones = float(0,0,1)
#@gimp : Recover shadows = float(0,0,1)
#@gimp : Recover highlights = float(0,0,1)
#@gimp : Enhance details = float (1,0,5)
#@gimp : Detail strength = float (0.5,0,1)
#@gimp : Map tones = bool(1)
#@gimp : Enhance details = bool(1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>      Latest update: <i>04/12/2011</i>.</small>")
#@gimp : Note = link("Filter explained here",http://www.tkfilter.bplaced.net/TKFilter%20filter.html)
gimp_tk_dri :
-repeat @# -l[$>]
-if {$6==1}
--negative --to_rgba[0] --luminance[0] --to_rgba[0] --luminance[0]
-gimp_gaussian_blur[1] {{{w+h}/20}*{1.1-$1}},0,0,1,0,0,0 -to_gray[1]
-rv[0,1] -gimp_compose_softlight[0,1] $1
-gimp_gaussian_blur[2] {{w+h}/200},0,0,1,1,0,0 -negative[2] -to_gray[2]
-s[1] c -rv[4,5] -compose_multiply[4,5] -a[1,2,3,4] c -rv[0,1]
-gimp_compose_dodge[0,1] $2
-gimp_gaussian_blur[2] {{w+h}/200},0,0,1,1,0,0 -to_gray[2] -s[1] c
-rv[4,5] -compose_multiply[4,5] -a[1,2,3,4] c -rv[0,1]
-gimp_compose_colorburn[0,1] $3 -endif
-if {$7==1} --map_tones[0] 0.50,0.70,$4,50
--normalize_local[0] $4,6.00,5.00,1.00
-rv[0,1] -gimp_compose_value[0,1] $5,0
-rv[0,1] -gimp_compose_value[0,1] $5,0 -endif
-endl -done
gimp_tk_dri_preview :
-gimp_split_preview "-gimp_tk_dri ${1--2}",$-1
#@gimp Freaky details : gimp_freaky_details, gimp_freaky_details_preview(0)
#@gimp : Amplitude = int(2,1,5)
#@gimp : Scale = float(10,0,100)
#@gimp : Iterations = int(1,1,4)
#@gimp : Sep = separator(), Channel(s) = choice(7,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(32,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>David Tschumperl&#233;</i> and <i>Patrick David</i>.      Latest update: <i>02/27/2013</i>.</small>")
#@gimp : Sep = separator(), note = note("This effect has been done following:")
#@gimp : Link = link("This tutorial from Patrick David","http://blog.patdavid.net/2013/02/calvin-hollywood-freaky-details-in-gimp.html")
_gimp_freaky_details :
-repeat @# -l[$>]
-repeat $3
[-1] ---[-1] 255 -*[-1] -1
-repeat $1 -bilateral[-1] $2,{1.5*$2} -done
-blend[-2,-1] vividlight -blend overlay
-done
-endl -done
gimp_freaky_details :
-ac "-gimp_parallel_overlap \"-_gimp_freaky_details ${1-3}\",$5,$6",$4
-n 0,255
gimp_freaky_details_preview :
-gimp_split_preview "-gimp_freaky_details $*",$-1
#@gimp High pass : gimp_highpass, gimp_highpass_preview(0)
#@gimp : Radius = float(5,0,100)
#@gimp : Contrast = float(2,0,7)
#@gimp : Inverse = bool(0)
#@gimp : Greyscale = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Tom Keil</i>.      Latest update: <i>01/05/2011</i>.</small>")
gimp_highpass :
-repeat @# -l[$>]
-to_rgb --negative
-if {$4==1} -to_gray -endif
-gimp_gaussian_blur[1] $1,0,0,1,0,0,0
-compose_interpolation
-tk_gimp_channel_processing 1,$2,0,0,0,0,100,256,0,0,0,2,0,0
-if {$2>=4} -tk_gimp_channel_processing 1,{$2-3},0,0,0,0,100,256,0,0,0,2,0,0  -endif
-tk_gimp_channel_processing 1,1,0,0,1,50,100,256,0,0,0,2,0,0
-if {$3==1} -negative -endif -endl -done
gimp_highpass_preview :
-gimp_split_preview "-gimp_highpass ${1--2}",$-1
#@gimp Local contrast enhancement : gimp_LCE, gimp_LCE_preview(0)
#@gimp : Note = note("Local contrast enhancement is <i>Unsharp Mask</i> with high radius. Apply to filter to RGB channels for color and contrast enhancement.")
#@gimp : Spatial radius = float(80,30,200)
#@gimp : Amount = float(0.5,0,5)
#@gimp : Darkness level = float(1,0,4)
#@gimp : Lightness level = float(1,0,4)
#@gimp : Channel(s) = choice(3,"All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Alpha","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Sep = separator(), Preview type = choice(0,"Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Note = note{"\n\n<small><b>Note : </b>
#@gimp : Original USM code by <i>by David Tschumperl&#233;</i>.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Authors : <i>Arto Huotari, PhotoComiX</i>.      Latest update : <i>2013/03/23</i>.</small>")
_gimp_LCE :
SpatialRadius=$1
Amount=$2
DarknessLevel=$3
LightnessLevel=$4
Threshold=0
--blur[-1] $SpatialRadius
--[-1] [-2] -*[-1] -$Amount
--norm[-1] -ge[-1] $Threshold% -r[-1] [-2] -*[-2,-1]
--c[-1] 0,100% -c[-2] -100%,0 -*[-2] $DarknessLevel -*[-1] $LightnessLevel -+[-2,-1]
-+[-2,-1] -c[-1] 0,255
gimp_LCE :
-apply_channels_old "-_gimp_LCE $1,$2,$3,$4",$5,0
gimp_LCE_preview :
-gimp_split_preview "-gimp_LCE ${1--2}",$-1
#@gimp Local normalization : gimp_normalize_local, gimp_normalize_local_preview(0)
#@gimp : Amplitude = float(2,0,60)
#@gimp : Radius = int(6,1,64)
#@gimp : Neighborhood smoothness = float(5,0,40)
#@gimp : Average smoothness = float(20,0,40)
#@gimp : Constrain values = bool(1)
#@gimp : Sep = separator(), Channel(s) = choice(7,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_normalize_local :
-repeat @# -l[$>]
-ac "-normalize_local $1,$2,$3,$4,$5,0,255",$6
-endl -done
gimp_normalize_local_preview :
-gimp_split_preview "-gimp_normalize_local $*",$-1
#@gimp Local variance normalization : jeje_normalize_local_variance, jeje_normalize_local_variance_preview
#@gimp : Amplitude = float(50,0,100)
#@gimp : Smoothness = float(5,0,20)
#@gimp : Threshold = float(5,0,100)
#@gimp : Repeat = int (1,1,4)
#@gimp : Channel(s) = choice(3,"All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Alpha","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>. Latest update: <i>2013/10/30</i>.</small>")
jeje_normalize_local_variance :
-apply_channels_old "-normalize_local_variance $1,$2,$3,$4",$5,0
-c 0,255
jeje_normalize_local_variance_preview:
-gimp_split_preview "-jeje_normalize_local_variance $1,$2,$3,$4,$5",$-1
#@gimp Make up : make_up, make_up_preview(0)
#@gimp : Space = float(15,1,40)
#@gimp : Value = float(4,0,30)
#@gimp : Fast = bool(0)
#@gimp : Limit hue range = bool(0)
#@gimp : Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author : <i>Iain Fergusson</i>.  - Update: 1 March 2013: Fixed resizing issue, some memory useage improvements, and added more options.</small>")
makeup_full:
-to_rgb
-sub[-1] 128 -*[-1] .5 -+[-1] 128
-split c
-name[0] red
-name[1] green
-name[2] blue
-sub[green] [red]
-bilateral[green] $1,$2
-add[green] [red]
-sub[blue] [red]
-bilateral[blue] $1,$2
-add[blue] [red]
-append[0,1,2] c
--[-1] 128 -*[-1] 2 -+[-1] 128
-c 0,255
make_up:
cropwidth={w}
cropheight={h}
-resize[0] {w+(2-w%2)},{h+(2-h%2)},1,{s},0,1
width={w}
height={h}
-if {$3==1}
--resize 50%,50%,1,3,5
--makeup_full[1] {$1/2},$2
--resize[1] 200%,200%,1,3,5
--compose_grainextract[0,3]
-resize[2] {w},{h},1,3,5
--compose_grainmerge[2,4]
-keep[0,-1]
-else
-if {$4==1}
--makeup_full[0] $1,$2
-else
-makeup_full[0] $1,$2
-endif
-endif
-if {$4==1}
--rgb2hsl8[1]
-split[-1] c -remove[-1,-2]
-+[-1] 128
-mod[-1] 255
-apply_curve[-1] 0,0,0,130,0,136,255,155,255,160,0,255,0
-median[-1] 3
--edges[1] 10% -n[-1] 0,1
-mul[-1,-2]
-a[1,2] c
-compose_alpha[0,1]
-else
-keep[-1]
-endif
-crop 0,0,{$cropwidth-1},{$cropheight-1}
make_up_preview:
-gimp_split_preview "-make_up ${1--2}",$-1
#
#@gimp Mask creator : gimp_tk_mask, gimp_tk_mask_preview(1)
#@gimp : Sep = separator()
#@gimp : Mask type = choice("Luminance","Saturation","Hue","LAB-lightness")
#@gimp : Color channels = choice("All","Red","Green","Blue","Yellow","Magenta","Cyan","LAB-A","LAB-B")
#@gimp : Shadows threshold = float(0,0,255)
#@gimp : Highlights threshold = float(255,0,255)
#@gimp : Tones smoothness = float(0,0,20)
#@gimp : Mask contrast = float(1,0,10)
#@gimp : Negative = bool(0)
#@gimp : Apply mask = bool(0)
#@gimp : Transparency = float(1,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>.      Latest update: <i>04/11/2011</i>.</small>")
#@gimp : Note = link("Filter explained here",http://www.tkfilter.bplaced.net/TKFilter%20filter.html)
gimp_tk_mask :
-repeat @# -l[$>]
-if {$8==1} --to_rgba[-1] -rv[-1,-2] -endif -to_rgb[-1]
-if {$2==1} -channels[-1] 0
-elif {$2==2} -channels[-1] 1
-elif {$2==3} -channels[-1] 2
-elif {$2==4} -rgb2cmy -channels[-1] 2
-elif {$2==4} -rgb2cmy -channels[-1] 1
-elif {$2==4} -rgb2cmy -channels[-1] 0
-elif {$2==5} -rgb2lab -channels[-1] 1
-elif {$2==6} -rgb2lab -channels[-1] 2
-endif -to_rgb[-1]
-if {$1==0} -luminance[-1] --luminance[-1]
-elif {$1==1} -rgb2hsv[-1] -channels[-1] 1
-n[-1] 0,255 [-1]
-elif {$1==2} -rgb2hsv[-1] -channels[-1] 0
-n[-1] 0,255  [-1]
-elif {$1==3} -rgb2lab[-1] -channels[-1] 0
-n[-1] 0,255  [-1]
-endif
-c[-1] $3,255 -n[-1] 0,255
-f[-2] "if(i<$4,if(c==0,i,i),0)"
-gimp_gaussian_blur[-1,-2] $5,0,0,1,0,0,0
-compose_darken
-if {$8==1} -rv[-1,-2] -endif
-tk_gimp_channel_processing[-1] 1,$6,0,0,0,0,100,256,0,0,0,2,0,0
-if {$7==1} -negative[-1] -endif
-if {$8==1} -s[-2] c  -rv[-1,-2]
-gimp_compose_multiply[-1,-2] $9
-a[-4,-3,-2,-1] c
-endif -endl -done
gimp_tk_mask_preview :
-gimp_split_preview "-gimp_tk_mask ${1--2}",$-1
#@gimp Mighty details : gimp_mighty_details, gimp_mighty_details_preview(0)
#@gimp : Amplitude = float(25,0,100)
#@gimp : Details amount = float(1,0,2)
#@gimp : Details scale = float(25,1,100)
#@gimp : Details smoothness = int(1,0,10)
#@gimp : Sep = separator(), Channel(s) = choice(7,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/08/2014</i>.</small>")
_gimp_mighty_details :
--smooth $3,0,1,0.5,0.5 --[1] [0]
--abs[-1] -sign[-2] M={iM} -^[-1] {2-$2} -*[-1] {$M/iM} -*[-2,-1]
--diffusiontensors[0] 0,1,0.5,0.5
-repeat $4 -smooth[1] [2],20 -done
-*[1] {-$1/5} -+
gimp_mighty_details :
-ac "-_gimp_mighty_details ${1-4}",$5,1
-n 0,255
gimp_mighty_details_preview :
-gimp_split_preview "-gimp_mighty_details $*",$-1
#@gimp Portrait retouching : gimp_tk_portrait, gimp_tk_portrait_preview(0)
#@gimp : Sep = separator()
#@gimp : Retouching style = choice("Standard","Glamour glow","Masculine","High key","Low Key")
#@gimp : Effect strength = float(100,0,100)
#@gimp : Sep = separator()
#@gimp : Note = note("<b>Retouching settings:</b>")
#@gimp : Fine details smoothness = float(1,0,10)
#@gimp : Medium details smoothness = float(5,0,25)
#@gimp : Areas smoothness = float(20,0,100)
#@gimp : Fine details threshold = float(3,0,10)
#@gimp : Medium details threshold = float(20,0,100)
#@gimp : Areas light adjustment = float(10,0,100)
#@gimp : Smoothing type = choice("Gaussian","Bilateral","Anisotropic","Median")
#@gimp : Output mode = choice("Retouched image","Composed layers","All layers and masks")
#@gimp : Sep = separator()
#@gimp : Note = note("<b>Skin tone mask settings:</b>")
#@gimp : Apply skin tone mask = bool(1)
#@gimp : Similarity space = choice(2,"RGB[A]","RGB","YCbCr","Red","Green","Blue","Opacity","Luminance","Blue & Red chrominances","Hue","Saturation")
#@gimp : Tolerance = float(25,0,100)
#@gimp : Smoothness = float(2,0,25)
#@gimp : Selected color = color(250,180,150,255)
#@gimp : Generic skin structure = bool(0)
#@gimp : Sep = separator()
#@gimp : Note = note("<b>Enhancement settings:</b>")
#@gimp : Apply adjustments on = choice(0,"Final image","Retouched areas only","Sharpened areas only","Retouched and sharpened areas")
#@gimp : Sharpening radius = float(1,0,10)
#@gimp : Sharpening strength = float(1.5,0,5)
#@gimp : Edge threshold = float(10,0,50)
#@gimp : Edge smoothness = float(1,0,10)
#@gimp : Color temperature = float(0,-20,20)
#@gimp : Lightness = float(0,-50,50)
#@gimp : Contrast = float(1,0.5,1.5)
#@gimp : Saturation = float(1,0,4)
#@gimp : Sep = separator()
#@gimp : Preview selection = choice("Retouched image final","Retouched image basic","Retouch layer","Sharpening layer","Skin tone mask","Skin tone colors","Edge mask","High frequency layer","Medium frequency layer","Low frequency layer")
#@gimp : Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>.      Latest update: <i>04/18/2012</i>.</small>")
#@gimp : Note = link("Filter explained here","http://www.tkfilter.bplaced.net/TKFilter%20tutorials%20Portrait%20retouching.html")
gimp_tk_portrait :
-repeat @# -l[$>] -to_rgb
-if {narg($_previewflag)==0} _previewflag=0 -endif
-if {{$1==3}||{$1==4}} --luminance[0] -elif {$1==2} --channels[0] 2 -gimp_unsharp[-1] 0,$21,30,$22,0.00,1.00,0.5,1,0,0,0 -endif
--gimp_edges[0] $24,$23,0,0 -if {$23==0} -fc[-1] 0 -endif --gimp_unsharp[0] 0,$21,30,$22,0.00,1.00,0.5,1,0,7,0
-if {{$_previewflag==4}&&{$29==5}} --tk_gimp_select_color[0] ${12-18},0,0 -else --tk_gimp_select_color[0] ${12-18},1,0 -endif
--gimp_split_freq[0] $6 -if {$19==1} -fc[-1] 128,128,128 -noise[-1] {$6*2},0 -luminance[-1] -endif
--gimp_split_freq[0] $7
-rm[-2,-4]
--gimp_tk_dri[0] {$8/100},{$8/200},{$8/200},0,0,1,0,0
-if {$9==0} -blur[-1] $5 -rv[-1,-2] -blur[-1] $4 -blur[-3] $3
-elif {$9==1} -bilateral[-1] $7,$5 -rv[-1,-2] -bilateral[-1] $6,$4 -bilateral[-3] {$3/5},$3
-elif {$9==2} -smooth[-1] $5 -rv[-1,-2] -smooth[-1] $4 -smooth[-3] $3
-elif {$9==3} -median[-1] $5 -rv[-1,-2] -median[-1] $4 -median[-3] $3
-endif
-if {{{$_previewflag!=0}&&{$_previewflag<=3}}||{{$10<=1}&&{$_previewflag==0}}}
-gimp_compose_freq[-1,-2] -rv[-1,-2] -gimp_compose_freq[-1,-2]
-if {$11==1} -to_rgba[-1] -blur[-2] $14 -s[-1] c -negative[-1] -+[-1] [-5] -a[-1,-2,-3,-4] c -endif -rm[-2] -mv[-1] 1
-to_rgba[-1] -s[-1] c -negative[-1,-5] -+[-1] [-5] -a[-1,-2,-3,-4] c -rm[-2] -if {$23==50} -fc[-1] 0,0,0,0 -endif
-if {{{$_previewflag==1}||{$_previewflag==2}}||{{$10==0}&&{$_previewflag==0}}}
-if {{$1!=0}&&{$1!=1}} -mv[-2] 0 -endif
-if {$20==1} -gimp_mix_lab[-2] $27,$26,0,$28,{if({$25>=0},{$25/4},{$25*0.75})},0,$28,$25,0,0,2,0
-elif {$20==2} -gimp_mix_lab[-1] $27,$26,0,$28,{if({$25>=0},{$25/4},{$25*0.75})},0,$28,$25,0,0,2,0
-elif {$20==3} -gimp_mix_lab[-1,-2] $27,$26,0,$28,{if({$25>=0},{$25/4},{$25*0.75})},0,$28,$25,0,0,2,0
-endif
-gimp_compose_alpha[-2,-3] {if({$1==0},{$2/100},1)},0 -gimp_compose_alpha[-1,-2] {if({$1==0},{$2/100},1)},0
-if {$23==50} -gimp_unsharp[0] 0,$21,30,$22,0.00,1.00,0.5,1,0,0,0 -endif
-if {$_previewflag<=1}
-if {$1==1} -gimp_glow[0] {$2/10},0,0
-elif {$1==2} -gimp_compose_hardlight[0,1] {$2/100}
-elif {$1==3} -gimp_compose_screen[0,1] {$2/100}
-elif {$1==4} -gimp_compose_multiply[0,1] {$2/100}
-endif
-if {$20==0} -gimp_mix_lab[0] $27,$26,0,$28,{if({$25>=0},{$25/4},{$25*0.75})},0,$28,$25,0,0,2,0  -endif
-endif -endif -endif -endl -done
gimp_tk_portrait_preview :
_previewflag=1
-if {$29==1} _previewflag=2 -elif {{$29==2}||{$29==3}} _previewflag=3 -elif {$29>=4} _previewflag=4 -endif
-if {$29>=2} -gimp_split_preview "-gimp_tk_portrait ${1--2}",0
-else -gimp_split_preview "-gimp_tk_portrait ${1--2}",$-1 -endif
-if {$29==1} -k[0] -elif {$29==2} -k[2] -elif {$29==3} -k[0] -elif {$29==4} -k[-3] -elif {$29==5} -k[-3]
-elif {$29==6} -k[-5] -negative -elif {$29==7} -k[-2] -elif {$29==8} -k[0] -elif {$29==9} -k[-1] -endif
_previewflag=0
#@gimp Sharpen [deblur] : gimp_deblur, gimp_deblur_preview(0)
#@gimp : Radius = float(2,0,20)
#@gimp : Iterations = int(10,0,100)
#@gimp : Time step = float(20,0,50)
#@gimp : Smoothness = float(0.1,0,10)
#@gimp : Regularization = choice(1,"Tikhonov","Mean curvature","Total variation")
#@gimp : Sep = separator(), Channel(s) = choice(7,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_deblur :
-ac "-gimp_parallel_overlap \"-deblur ${1-5} -c 0,255\",$7,$8",$6,1
gimp_deblur_preview :
-gimp_split_preview "-gimp_deblur $*",$-1
#@gimp Sharpen [gold-meinel] : gimp_unsharp_goldmeinel, gimp_unsharp_goldmeinel_preview
#@gimp : Sigma = float(1,0.5,10)
#@gimp : Iterations = int(5,1,15)
#@gimp : Acceleration = float(1,1,3)
#@gimp : Blur = choice(1,"Exponential","Gaussian")
#@gimp : Cut = bool(true)
#@gimp : Sep = separator(), Channel(s) = choice(7,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>.      Latest update: <i>03/29/2013</i>.</small>")
gimp_unsharp_goldmeinel:
-ac "-gimp_parallel_overlap \"-_gimp_unsharp_goldmeinel $*\",$7,$8",$6,1
_gimp_unsharp_goldmeinel :
-deblur_goldmeinel $*
-if $5 -c 0,255 -else -n 0,255 -endif
gimp_unsharp_goldmeinel_preview:
-gimp_split_preview "-gimp_unsharp_goldmeinel $*",$-1
#@gimp Sharpen [inverse diffusion] : gimp_sharpen_inversediff, gimp_sharpen_inversediff_preview(0)
#@gimp : Amplitude = float(50,1,300)
#@gimp : Iterations = int(2,1,10)
#@gimp : Sep = separator(), Channel(s) = choice(7,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_sharpen_inversediff :
-ac "-gimp_parallel_overlap \"-repeat $2 -sharpen $1 -c 0,255 -done\",$4,$5",$3,1
gimp_sharpen_inversediff_preview :
-gimp_split_preview "-gimp_sharpen_inversediff $*",$-1
#@gimp Sharpen [octave sharpening] : gimp_unsharp_octave, gimp_unsharp_octave_preview(0)
#@gimp : Scales = int(4,1,10)
#@gimp : Maximal radius = float(5,0,20)
#@gimp : Amount = float(3,0,10)
#@gimp : Threshold = float(0,0,255)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_unsharp_octave :
-ac "-gimp_parallel_overlap \"-unsharp_octave $1,$2,$3,$4\",$6,$7",$5,1
gimp_unsharp_octave_preview :
-gimp_split_preview "-gimp_unsharp_octave $*",$-1
#@gimp Sharpen [richardson-lucy] : gimp_unsharp_richardsonlucy, gimp_unsharp_richardsonlucy_preview
#@gimp : Sigma = float(1,0.5,10)
#@gimp : Iterations = int(10,1,100)
#@gimp : Blur = choice(1,"Exponential","Gaussian")
#@gimp : Cut = bool(true)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>.      Latest update: <i>03/29/2013</i>.</small>")
gimp_unsharp_richardsonlucy :
-deblur_richardsonlucy $*
-if $4 -c 0,255 -else -n 0,255 -endif
gimp_unsharp_richardsonlucy_preview :
-gimp_split_preview "-gimp_unsharp_richardsonlucy $*",$-1
#@gimp Sharpen [shock filters] : gimp_sharpen_shock, gimp_sharpen_shock_preview(0)
#@gimp : Amplitude = float(150,1,400)
#@gimp : Edge threshold = float(0.1,0,0.7)
#@gimp : Gradient smoothness = float(0.8,0,10)
#@gimp : Tensor smoothness = float(1.1,0,10)
#@gimp : Iterations = int(1,1,10)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_sharpen_shock :
-ac "-gimp_parallel_overlap \"-repeat $5 -sharpen $1,$2,$3,$4 -c 0,255 -done\",$7,$8",$6,1
gimp_sharpen_shock_preview :
-gimp_split_preview "-gimp_sharpen_shock $*",$-1
#@gimp Sharpen [unsharp mask] : gimp_unsharp, gimp_unsharp_preview(0)
#@gimp : Sharpening type = choice(0,"Gaussian","Bilateral")
#@gimp : Spatial radius = float(1.25,0,20)
#@gimp : Bilateral radius = float(30,0,60)
#@gimp : Amount = float(3,0,10)
#@gimp : Threshold = float(0,0,20)
#@gimp : Darkness level = float(1,0,4)
#@gimp : Lightness level = float(1,0,4)
#@gimp : Iterations = int(1,1,10)
#@gimp : Negative effect = bool(0)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Note = note{"\n\n<small><b>Note: </b>
#@gimp : This filter is inspired by the original <i>Unsharp Mask</i> filter in GIMP, with additional parameters.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
_gimp_unsharp :
-repeat @# -repeat $8
-if {$1==0} --b[-1] $2 -else --bilateral[-1] $2,$3 -endif
--[-1] [-2] -*[-1] -$4
--norm[-1] ->=[-1] $5% -r[-1] [-2] -*[-2,-1]
-if $9 -*[-1] -1 -endif
--c[-1] 0,100% -c[-2] -100%,0 -*[-2] $6 -*[-1] $7 -+[-2,-1]
-+[-2,-1] -c[-1] 0,255
-done -mv[-1] 0 -done
gimp_unsharp :
-ac "-_gimp_unsharp $1,$2,$3,$4,$5,$6,$7,$8,$9",$10,1
gimp_unsharp_preview :
-gimp_split_preview "-gimp_unsharp $*",$-1
#@gimp Sharpen [whiten] : jeje_whiten_frequency, jeje_whiten_frequency_preview
#@gimp : Alpha = float(50,0,100)
#@gimp : Cut = bool(false)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note(<b>Note:</b>This filter equalizes frequencies in the image.)
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>.      Latest update: <i>2013/06/01</i>.</small>")
jeje_whiten_frequency :
-whiten_frequency {exp($1/100)-1}
-if $2 -c 0,255 -n 0,255 -else -n 0,255 -endif
jeje_whiten_frequency_preview :
-gimp_split_preview "-jeje_whiten_frequency $1,$2",$-1
#@gimp Simple local contrast : simplelocalcontrast_p,simplelocalcontrast_p(0)
#@gimp : Edge sensitivity = float (16,0,25)
#@gimp : Iterations = int (2,1,5)
#@gimp : Paint effect = float (0,0,50)
#@gimp : Channels = Choice (1,"Colour","Luminance Only")
#@gimp : Pre-gamma = float (1,.1,5)
#@gimp : Post-gamma = float (1,.1,5)
#@gimp : Sep = separator ()
#@gimp : Note = note("<small><b>Luminance Mask</b></small>" )
#@gimp : Blacks = float (1,0,1)
#@gimp : Dark grey = float (1,0,1)
#@gimp : Mid grey = float (1,0,1)
#@gimp : Light grey = float (1,0,1)
#@gimp : Whites = float (1,0,1)
#@gimp : Sep = separator ()
#@gimp : Parallel processing = Choice (0,"Auto","None"))
#@gimp : Sep = separator ()
#@gimp : Note = note("Author: Iain Fergusson - update 18 April 2014 - added parallel processing and luminance mask")
simplelocalcontrast_p:
-to_rgb
[0]
-apply_parallel_overlap[1] "
-simplelocalcontrast[0] ${1-6}",{30+$3},$12
--luminance[-1]
-apply_curve[-1] 0,0,$7,64,$8,128,$9,196,$10,255,$11
-mul[-1] 255
-append[1,2] c
-blend alpha,1,0
simplelocalcontrast:
str1=$1
str2={$str1*0.7}
str3={$str2*0.7}
str4={$str3*0.7}
str5={$str4*0.7}
str6={$str5*0.7}
str7={$str6*0.7}
str8={$str7*0.7}
-apply_gamma $5
-conttest4 $4,$str1,$str2,$str3,$str4,$str5,$str6,$str7,$str8,$2,$3,$3,$3,$3,$3,$3,2,1
-apply_gamma $6
-n 0,255
conttest4:
-to_rgb
-if {$1==1}
--luminance
--smoothbase4[-1] $2,$3,$4,$5,$6,$7,$8,$9,$10
--compose_grainextract[-1,-2]
-ms_smooth[-1] $11,$12,$13,$14,$15,$16,$17,$18,1
-remove[1,2]
-sub[-1] 128 -mul[-1] 2 -add[-1] 128
--compose_grainmerge
-remove[0,1]
-else
--smoothbase4 $2,$3,$4,$5,$6,$7,$8,$9,$10
--compose_grainextract
-ms_smooth[-1] $11,$12,$13,$14,$15,$16,$17,$18,1
-remove[1]
-sub[-1] 128 -mul[-1] 2 -add[-1] 128
--compose_grainmerge
-remove[1]
-rgb2hsv
-split c
-remove[1,2,3]
-append c
-hsv2rgb
-endif
smoothbase4:
-repeat $9
cropwidth={w}
cropheight={h}
-resize[0] {w+(256-w%256)},{h+(256-h%256)},1,{s},0,1
width={w}
height={h}
-if {$1!=0}
-denoise[0] 10,$1,3,5,0,1
-endif
--resize[0] {$width/2},{$height/2},1,{s},2,1
--resize[-1] $width,$height,1,{s},3,1
-blur[-1] .5
-compose_grainextract[0,-1]
-if {$2!=0}
-denoise[-1] 10,$2,3,5,0,1
-endif
--resize[-1] {$width/4},{$height/4},1,{s},2,1
--resize[-1] {$width/2},{$height/2},1,{s},3,1
-blur[-1] .5
-compose_grainextract[1,-1]
-if {$3!=0}
-denoise[-1] 10,$3,3,5,0,1
-endif
--resize[-1] {$width/8},{$height/8},1,{s},2,1
--resize[-1] {$width/4},{$height/4},1,{s},3,1
-blur[-1] .5
-compose_grainextract[2,-1]
-if {$4!=0}
-denoise[-1] 10,$4,3,5,0,1
-endif
--resize[-1] {$width/16},{$height/16},1,{s},2,1
--resize[-1] {$width/8},{$height/8},1,{s},3,1
-blur[-1] .5
-compose_grainextract[3,-1]
-if {$5!=0}
-denoise[-1] 10,$5,3,5,0,1
-endif
--resize[-1] {$width/32},{$height/32},1,{s},2,1
--resize[-1] {$width/16},{$height/16},1,{s},3,1
-blur[-1] .5
-compose_grainextract[4,-1]
-if {$6!=0}
-denoise[-1] 10,$6,3,5,0,1
-endif
--resize[-1] {$width/64},{$height/64},1,{s},2,1
--resize[-1] {$width/32},{$height/32},1,{s},3,1
-blur[-1] .5
-compose_grainextract[5,-1]
-if {$7!=0}
-denoise[-1] 10,$7,3,5,0,1
-endif
--resize[-1] {$width/128},{$height/128},1,{s},2,1
--resize[-1] {$width/64},{$height/64},1,{s},3,1
-blur[-1] .5
-compose_grainextract[6,-1]
-if {$8!=0}
-denoise[-1] 10,$8,3,5,0,1
-endif
--resize[-1] {$width/256},{$height/256},1,{s},2,1
--resize[-1] {$width/128},{$height/128},1,{s},3,1
-blur[-1] .5
-compose_grainextract[7,-1]
-resize[-1] {$width/128},{$height/128},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-resize[-1] {$width/64},{$height/64},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-resize[-1] {$width/32},{$height/32},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-resize[-1] {$width/16},{$height/16},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-resize[-1] {$width/8},{$height/8},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-resize[-1] {$width/4},{$height/4},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-resize[-1] {$width/2},{$height/2},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-resize[-1] {$width/1},{$height/1},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-crop 0,0,{$cropwidth-1},{$cropheight-1}
-done
#@gimp Split details [alpha] : gimp_split_details_alpha, gimp_split_details_alpha_preview(0)
#@gimp : Number of levels = int(6,2,8)
#@gimp : Base scale = float(10,0,30)
#@gimp : Details scale = float(1,0,20)
#@gimp : Opacity gain = float(5,1,20)
#@gimp : Sep = separator()
#@gimp : Preview without alpha = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>04/22/2014</i>.</small>")
gimp_split_details_alpha :
-remove_opacity
-repeat @# -l[$<]
-repeat {$1-1}
s={$3+($2-$3)*$>/if($1-2>0,$1-2,1)}
--_gimp_split_details_alpha_blur[-1] $s
-sub_alpha[-2] [-1],$4
-done
-endl -done
_gimp_split_details_alpha_blur :
-if {$1>=0.1} -b[-1] $1
-else
-if {$1>=0.05} (1,4,7,4,1;4,16,26,16,4;7,26,41,26,7;4,16,26,16,4;1,4,7,4,1)
-else (1,2,1;2,4,2;1,2,1) -endif
-normalize_sum[-1] -convolve[-2] [-1] -rm[-1]
-endif
gimp_split_details_alpha_preview :
-repeat @# -l[$>]
-gimp_split_details_alpha ${1-4}
-if $5 -remove_opacity[^-1] -else -to_rgba[-1] -endif
-drgba
-repeat @# -l[$>] -text_outline "\#"{1+$>},1,1,43,7,1,255 -endl -done
-frame 1,1,0 -frame 3,3,255 -append_tiles ,
-endl -done
#@gimp Split details [layers] : gimp_split_details_layers, gimp_split_details_layers_preview(0)
#@gimp : Number of scales = int(6,3,12)
#@gimp : Base scale = float(10,0,40)
#@gimp : Details scale = float(1,0,20)
#@gimp : Sharpen details in preview = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/22/2015</i>.</small>")
gimp_split_details_layers :
-remove_opacity -repeat @# -l[$>]
nm=@{-gimp_layer_name}
pos=@{-gimp_layer_pos}
-split_details $1,$2,$3
-+[^0] 128 -c[^0] 0,255
-repeat {@#-1} -nm[{1+$>}] "mode(grainmerge), name"($nm" [freq ""#"{1+$>}"]), pos("$pos")" -done
-nm[0] "name"($nm" [base]), pos("$pos")"
-rv
-endl -done
gimp_split_details_layers_preview :
-repeat @# -l[$>]
-gimp_split_details_layers $*
-if $4 -equalize[^-1] 256 -endif
-n[^-1] 0,255
-repeat @# -l[$>] -text_outline "\#"{1+$>},1,1,43,7,1,255 -endl -done
-frame 1,1,0 -frame 3,3,255 -append_tiles ,
-endl -done
#@gimp Spotify : jeje_spotify,jeje_spotify_preview
#@gimp : Scale = float(1,0.75,10)
#@gimp : Iteration = int(1,1,50)
#@gimp : Gamma = float(1,0,10)
#@gimp : Cut = bool(1)
#@gimp : Channel(s) = choice(3,"All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Alpha","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>. Latest update: <i>2013/12/16</i>.</small>")
jeje_spotify:
-apply_channels_old "-spotify $1,$2  -apply_gamma $3 -if $4 -c 0,255 -else -n 0,255 -endif",$5,0
jeje_spotify_preview:
-gimp_split_preview "-jeje_spotify $1,$2,$3,$4,$5",$6
#@gimp Texture enhance : iain_texture_enhance_p, iain_texture_enhance_p_preview(0)
#@gimp : Radius = int (2,2,11)
#@gimp : Strength = float (2,0,10)
#@gimp : Reduce halos = float (30,0,255)
#@gimp : Reduce noise = float (0,0,255)
#@gimp : Channel(s) = choice(7,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator()
#@gimp : Parallel processing = choice(0,"Auto","Off")
#@gimp : Sep = separator()
#@gimp : Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author : <i>Iain Fergusson</i>. Update: 4 March 2014 - Added parallel processing option</small>")
#@gimp : Note = note("<small>Update: 4 March 2013 - Different halo protection method, added option to reduce noise, faster.</small>")
iain_texture_enhance_p:
-apply_parallel_overlap "-iain_texture_enhance ${1--2}",{$1*2},$-2
iain_texture_enhance_p_preview :
-gimp_split_preview "-iain_texture_enhance_p ${1--2}",$-1
iain_texture_enhance:
-tic
-ac "
-if {$1%2!=0}
--erode_circ[0] $1  -dilate_circ[-1] $1
--dilate_circ[0] $1  -erode_circ[-1] $1
-else
--erode_oct[0] $1  -dilate_oct[-1] $1
--dilate_oct[0] $1  -erode_oct[-1] $1
-endif
-sub[1] [0]
-sub[2] [0]
-add[1] [2]
-remove[2]
-mul[1] $2
--abs[1]
pt1={min(0,($4-10))}
-apply_curve[-1] 0,0,0,$pt1,0,{$4+1},1,255,1
(0.0579710145,0.1304347826,0.0579710145;0.1304347826,0.2463768116,0.1304347826;0.0579710145,0.1304347826,0.0579710145)
-convolve[-2] [-1]
-remove[-1]
-mul[1] [2]
-c[1] {$3*-1},$3
-sub[0] [1]
-keep[0]
",$5
-c 0,255
-toc
iain_texture_enhance_preview :
-gimp_split_preview "-iain_texture_enhance ${1--2}",$-1
#@gimp Tone mapping : gimp_map_tones, gimp_map_tones_preview(0)
#@gimp : Threshold = float(0.5,0,1)
#@gimp : Gamma = float(0.7,0,1)
#@gimp : Smoothness = float(0.1,0,10)
#@gimp : Iterations = int(30,0,500)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_map_tones :
-ac "-map_tones ${1-4}",$5,1
-n 0,255
gimp_map_tones_preview :
-gimp_split_preview "-gimp_map_tones $*",$-1
#@gimp Tone mapping [fast] : gimp_map_tones_fast, gimp_map_tones_fast_preview(0)
#@gimp : Radius = float(3,0,20)
#@gimp : Power = float(0.5,0,1)
#@gimp : Sep = separator(), Channel(s) = choice(7,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Paul Nasca</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>06/10/2011</i>.</small>")
gimp_map_tones_fast :
-ac "-map_tones_fast $1,$2",$3,2
gimp_map_tones_fast_preview :
-gimp_split_preview "-gimp_map_tones_fast ${^0}",$-1
#@gimp Yag effect : gimp_yag_soften, gimp_yag_soften_preview(0)
#@gimp : Darken = float(0,0,100)
#@gimp : Soften = float(0,0,100)
#@gimp : Sep = separator(), Preview type = choice(0,"Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Arto Huotari</i>.      Latest update : <i>2013/09/28</i>.</small>")
#@gimp : Note = link("Filter Explained here","http://www.flickr.com/photos/naggobot/6260257923/")
gimp_yag_soften :
Darken=$1
Soften=$2
--gimp_laplacian[0] 0,0,100,0,0,0
-if {$Soften>0}
-gimp_gaussian_blur[1] {$Soften/10},0,0,1,0,0,0
-endif
--gimp_mix_lab[0] 0.5,50,0.2,1,2,1,1,2,1,0,10,0
-if {$Darken>0}
--blend[0,2] softlight
-blend[0,3] multiply,{$Darken/100}
-endif
-blend[0,2] hardlight
-if {$Soften!=100}
-blend[0,1] grainextract
-elif {$Soften==100}
-remove[1]
-endif
gimp_yag_soften_preview :
-gimp_split_preview "-gimp_yag_soften ${1--2}",$-1
#@gimp _
#@gimp <b>Film emulation</b>
#@gimp Add grain : gimp_emulate_grain, gimp_emulate_grain_preview(0)
#@gimp : Preset = choice{"Orwo NP20-GDR","Kodak TMAX 400","Kodak TMAX 3200","Kodak TRI-X 1600","Unknown"}
#@gimp : Blend mode = choice(1,"Alpha","Grain merge","Hard light","Overlay","Soft light","Grain only")
#@gimp : Opacity = float(0.2,0,1)
#@gimp : Scale = float(100,30,200)
#@gimp : Colored grain = bool()
#@gimp : Sep = separator()
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Hue = float(0,-180,180)
#@gimp : Saturation = float(0,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Preview grain alone = bool()
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>04/10/2014</i>.</small>")
gimp_emulate_grain :
-__gimp_emulate_grain @{-arg\ {1+$1},@{-_gimp_emulate_grain}},${2-10},0,0
_gimp_emulate_grain :
-u grain_orwo_np20,grain_kodak_tmax400,grain_kodak_tmax3200,grain_kodak_trix1600,grain_unknown
gimp_emulate_grain_preview :
-gimp_split_preview "-_gimp_emulate_grain_preview $*",$-2
_gimp_emulate_grain_preview :
-__gimp_emulate_grain @{-arg\ {1+$1},@{-_gimp_emulate_grain}},${2-12}
__gimp_emulate_grain :
bm0=alpha bm1=grainmerge bm2=hardlight bm3=overlay bm4=softlight bm5=alpha
dir=@{-path_user}
-if {!@{-is_windows}}
dir=$dir/.gmic_film_presets
-if $dir -else -x "mkdir "$dir -endif
-endif
-if {narg($_force_redownload)}
-i http://gmic.eu/data_film_presets/$1.cimgz -o[-1] $dir/gmic_$1.cimgz
-else
-if $dir/gmic_$1.cimgz -i $dir/gmic_$1.cimgz
-else -i http://gmic.eu/data_film_presets/$1.cimgz -o[-1] $dir/gmic_$1.cimgz
-endif
-endif
-repeat {@#-1} -l[$>,-1] -split_opacity[0]
--syntexturize[-1] @{0,max(10,100*w/$4)},@{0,max(10,100*h/$4)}
-if $5 --syntexturize[-2] {w},{h} --syntexturize[-3] {w},{h} -a[-3--1] c -endif
-r[-1] @{0,w},@{0,h},1,100%,5 -c[-1] 0,255
-apply_gamma[-1] {10^$6}
--[-1] 128 -*[-1] $7 -+[-1] 128 -+[-1] $8 -c[-1] 0,255
-if {$9||$10}
-to_color[-1] -rgb2hsv[-1]
-sh[-1] 0,0 -+[-1] $9 -%[-1] 360 -rm[-1]
-sh[-1] 1,1 -+[-1] $10 -rm[-1]
-hsv2rgb[-1]
-endif
-if $12 -k[0,-1] -rv
-else -blend[0,-1] ${bm$2},{if($2<=4,$3,1)}
-endif
-a[^-1] c -endl -done -rm[-1]
#@gimp B&amp;W films : gimp_emulate_film_bw, gimp_emulate_film_bw_preview(1)
#@gimp : Preset = choice{"None",
#@gimp : "Agfa APX 100","Agfa APX 25","Fuji Neopan 1600","Fuji Neopan Acros 100","Ilford Delta 100","Ilford Delta 3200","Ilford Delta 400","Ilford FP4 Plus 125",
#@gimp : "Ilford HP5 Plus 400","Ilford HPS 800","Ilford Pan F Plus 50","Ilford XP2","Kodak BW 400 CN","Kodak HIE (HS Infra)","Kodak T-Max 100","Kodak T-Max 3200",
#@gimp : "Kodak T-Max 400","Kodak Tri-X 400","Polaroid 664","Polaroid 667","Polaroid 672","Rollei IR 400","Rollei Ortho 25","Rollei Retro 100 Tonal","Rollei Retro 80s"}
#@gimp : Sep = separator()
#@gimp : Opacity = float(1,0,1)
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Hue = float(0,-180,180)
#@gimp : Saturation = float(0,-1,1)
#@gimp : Post-normalize = bool(0)
#@gimp : Sep = separator()
#@gimp : Pseudo-gray dithering = int(0,0,5)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small><b>Note:</b> The color LUTs used in this section have been designed by <b>Patrick David</b>. More infos at:</small>")
#@gimp : Link = link{"Film Emulation Presets in G'MIC","http://gmic.eu/film_emulation/index.shtml"}
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Patrick David</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>01/16/2015</i>.</small>")
gimp_emulate_film_bw :
-_gimp_emulate_film $1,@{-arg\ $1,@{-_$0}},${2--1}
-if {$1" && "$9} -to_pseudogray $9,1 -endif
_gimp_emulate_film_bw :
-u agfa_apx_100,agfa_apx_25,fuji_neopan_1600,fuji_neopan_acros_100,ilford_delta_100,ilford_delta_3200,ilford_delta_400,ilford_fp4_plus_125,\
ilford_hp5_plus_400,ilford_hps_800,ilford_pan_f_plus_50,ilford_xp2,kodak_bw_400_cn,kodak_hie_(hs_infra),kodak_t-max_100,kodak_t-max_3200,\
kodak_t-max_400,kodak_tri-x_400,polaroid_664,polaroid_667,polaroid_672,rollei_ir_400,rollei_ortho_25,rollei_retro_100_tonal,rollei_retro_80s
gimp_emulate_film_bw_preview :
-gimp_split_preview "-gimp_emulate_film_bw $*",$-1
#@gimp Instant [consumer] : gimp_emulate_film_instant_consumer, gimp_emulate_film_instant_consumer_preview(1)
#@gimp : Preset = choice{"None",
#@gimp : "Polaroid PX-100UV+ Cold --","Polaroid PX-100UV+ Cold -","Polaroid PX-100UV+ Cold","Polaroid PX-100UV+ Cold +","Polaroid PX-100UV+ Cold ++","Polaroid PX-100UV+ Cold +++",
#@gimp : "Polaroid PX-100UV+ Warm --","Polaroid PX-100UV+ Warm -","Polaroid PX-100UV+ Warm","Polaroid PX-100UV+ Warm +","Polaroid PX-100UV+ Warm ++","Polaroid PX-100UV+ Warm +++",
#@gimp : "Polaroid PX-680 --","Polaroid PX-680 -","Polaroid PX-680","Polaroid PX-680 +","Polaroid PX-680 ++",
#@gimp : "Polaroid PX-680 Cold --","Polaroid PX-680 Cold -","Polaroid PX-680 Cold","Polaroid PX-680 Cold +","Polaroid PX-680 Cold ++","Polaroid PX-680 Cold ++a",
#@gimp : "Polaroid PX-680 Warm --","Polaroid PX-680 Warm -","Polaroid PX-680 Warm","Polaroid PX-680 Warm +","Polaroid PX-680 Warm ++",
#@gimp : "Polaroid PX-70 --","Polaroid PX-70 -","Polaroid PX-70","Polaroid PX-70 +","Polaroid PX-70 ++","Polaroid PX-70 +++",
#@gimp : "Polaroid PX-70 Cold --","Polaroid PX-70 Cold -","Polaroid PX-70 Cold","Polaroid PX-70 Cold +","Polaroid PX-70 Cold ++",
#@gimp : "Polaroid PX-70 Warm --","Polaroid PX-70 Warm -","Polaroid PX-70 Warm","Polaroid PX-70 Warm +","Polaroid PX-70 Warm ++",
#@gimp : "Polaroid Time Zero (Expired) ---","Polaroid Time Zero (Expired) --","Polaroid Time Zero (Expired) -","Polaroid Time Zero (Expired)","Polaroid Time Zero (Expired) +","Polaroid Time Zero (Expired) ++",
#@gimp : "Polaroid Time Zero (Expired) Cold ---","Polaroid Time Zero (Expired) Cold --","Polaroid Time Zero (Expired) Cold -","Polaroid Time Zero (Expired) Cold"}
#@gimp : Sep = separator()
#@gimp : Opacity = float(1,0,1)
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Hue = float(0,-180,180)
#@gimp : Saturation = float(0,-1,1)
#@gimp : Post-normalize = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small><b>Note:</b> The color LUTs used in this section have been designed by <b>Patrick David</b>. More infos at:</small>")
#@gimp : Link = link{"Film Emulation Presets in G'MIC","http://gmic.eu/film_emulation/index.shtml"}
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Patrick David</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>08/29/2013</i>.</small>")
gimp_emulate_film_instant_consumer :
-_gimp_emulate_film $1,@{-arg\ $1,@{-_$0}},${2--1}
_gimp_emulate_film_instant_consumer :
-u polaroid_px-100uv+_cold_--,polaroid_px-100uv+_cold_-,polaroid_px-100uv+_cold,polaroid_px-100uv+_cold_+,polaroid_px-100uv+_cold_++,polaroid_px-100uv+_cold_+++,\
polaroid_px-100uv+_warm_--,polaroid_px-100uv+_warm_-,polaroid_px-100uv+_warm,polaroid_px-100uv+_warm_+,polaroid_px-100uv+_warm_++,polaroid_px-100uv+_warm_+++,\
polaroid_px-680_--,polaroid_px-680_-,polaroid_px-680,polaroid_px-680_+,polaroid_px-680_++,\
polaroid_px-680_cold_--,polaroid_px-680_cold_-,polaroid_px-680_cold,polaroid_px-680_cold_+,polaroid_px-680_cold_++,polaroid_px-680_cold_++_alt,\
polaroid_px-680_warm_--,polaroid_px-680_warm_-,polaroid_px-680_warm,polaroid_px-680_warm_+,polaroid_px-680_warm_++,\
polaroid_px-70_--,polaroid_px-70_-,polaroid_px-70,polaroid_px-70_+,polaroid_px-70_++,polaroid_px-70_+++,\
polaroid_px-70_cold_--,polaroid_px-70_cold_-,polaroid_px-70_cold,polaroid_px-70_cold_+,polaroid_px-70_cold_++,\
polaroid_px-70_warm_--,polaroid_px-70_warm_-,polaroid_px-70_warm,polaroid_px-70_warm_+,polaroid_px-70_warm_++,\
polaroid_time_zero_(expired)_---,polaroid_time_zero_(expired)_--,polaroid_time_zero_(expired)_-,polaroid_time_zero_(expired),polaroid_time_zero_(expired)_+,polaroid_time_zero_(expired)_++,\
polaroid_time_zero_(expired)_cold_---,polaroid_time_zero_(expired)_cold_--,polaroid_time_zero_(expired)_cold_-,polaroid_time_zero_(expired)_cold
gimp_emulate_film_instant_consumer_preview :
-gimp_split_preview "-gimp_emulate_film_instant_consumer $*",$-1
#@gimp Instant [pro] : gimp_emulate_film_instant_pro, gimp_emulate_film_instant_pro_preview(1)
#@gimp : Preset = choice{"None",
#@gimp : "Fuji FP-100c --","Fuji FP-100c -","Fuji FP-100c","Fuji FP-100c +","Fuji FP-100c ++","Fuji FP-100c ++a","Fuji FP-100c +++",
#@gimp : "Fuji FP-100c Cool --","Fuji FP-100c Cool -","Fuji FP-100c Cool","Fuji FP-100c Cool +","Fuji FP-100c Cool ++",
#@gimp : "Fuji FP-100c Negative --","Fuji FP-100c Negative -","Fuji FP-100c Negative","Fuji FP-100c Negative +","Fuji FP-100c Negative ++","Fuji FP-100c Negative ++a","Fuji FP-100c Negative +++",
#@gimp : "Fuji FP-3000b --","Fuji FP-3000b -","Fuji FP-3000b","Fuji FP-3000b +","Fuji FP-3000b ++","Fuji FP-3000b +++",
#@gimp : "Fuji FP-3000b HC",
#@gimp : "Fuji FP-3000b Negative --","Fuji FP-3000b Negative -","Fuji FP-3000b Negative","Fuji FP-3000b Negative +","Fuji FP-3000b Negative ++","Fuji FP-3000b Negative +++",
#@gimp : "Fuji FP-3000b Negative Early",
#@gimp : "Polaroid 665 --","Polaroid 665 -","Polaroid 665","Polaroid 665 +","Polaroid 665 ++",
#@gimp : "Polaroid 665 Negative -","Polaroid 665 Negative","Polaroid 665 Negative +",
#@gimp : "Polaroid 665 Negative HC",
#@gimp : "Polaroid 669 --","Polaroid 669 -","Polaroid 669","Polaroid 669 +","Polaroid 669 ++","Polaroid 669 +++",
#@gimp : "Polaroid 669 Cold --","Polaroid 669 Cold -","Polaroid 669 Cold","Polaroid 669 Cold +",
#@gimp : "Polaroid 690 --","Polaroid 690 -","Polaroid 690","Polaroid 690 +","Polaroid 690 ++",
#@gimp : "Polaroid 690 Cold --","Polaroid 690 Cold -","Polaroid 690 Cold","Polaroid 690 Cold +","Polaroid 690 Cold ++",
#@gimp : "Polaroid 690 Warm --","Polaroid 690 Warm -","Polaroid 690 Warm","Polaroid 690 Warm +","Polaroid 690 Warm ++"}
#@gimp : Sep = separator()
#@gimp : Opacity = float(1,0,1)
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Hue = float(0,-180,180)
#@gimp : Saturation = float(0,-1,1)
#@gimp : Post-normalize = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small><b>Note:</b> The color LUTs used in this section have been designed by <b>Patrick David</b>. More infos at:</small>")
#@gimp : Link = link{"Film Emulation Presets in G'MIC","http://gmic.eu/film_emulation/index.shtml"}
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Patrick David</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>08/29/2013</i>.</small>")
gimp_emulate_film_instant_pro :
-_gimp_emulate_film $1,@{-arg\ $1,@{-_$0}},${2--1}
_gimp_emulate_film_instant_pro :
-u fuji_fp-100c_--,fuji_fp-100c_-,fuji_fp-100c,fuji_fp-100c_+,fuji_fp-100c_++,fuji_fp-100c_++_alt,fuji_fp-100c_+++,\
fuji_fp-100c_cool_--,fuji_fp-100c_cool_-,fuji_fp-100c_cool,fuji_fp-100c_cool_+,fuji_fp-100c_cool_++,\
fuji_fp-100c_negative_--,fuji_fp-100c_negative_-,fuji_fp-100c_negative,fuji_fp-100c_negative_+,fuji_fp-100c_negative_++,fuji_fp-100c_negative_++_alt,fuji_fp-100c_negative_+++,\
fuji_fp-3000b_--,fuji_fp-3000b_-,fuji_fp-3000b,fuji_fp-3000b_+,fuji_fp-3000b_++,fuji_fp-3000b_+++,fuji_fp-3000b_hc,\
fuji_fp-3000b_negative_--,fuji_fp-3000b_negative_-,fuji_fp-3000b_negative,fuji_fp-3000b_negative_+,fuji_fp-3000b_negative_++,fuji_fp-3000b_negative_+++,fuji_fp-3000b_negative_early,\
polaroid_665_--,polaroid_665_-,polaroid_665,polaroid_665_+,polaroid_665_++,\
polaroid_665_negative_-,polaroid_665_negative,polaroid_665_negative_+,polaroid_665_negative_hc,\
polaroid_669_--,polaroid_669_-,polaroid_669,polaroid_669_+,polaroid_669_++,polaroid_669_+++,\
polaroid_669_cold_--,polaroid_669_cold_-,polaroid_669_cold,polaroid_669_cold_+,\
polaroid_690_--,polaroid_690_-,polaroid_690,polaroid_690_+,polaroid_690_++,\
polaroid_690_cold_--,polaroid_690_cold_-,polaroid_690_cold,polaroid_690_cold_+,polaroid_690_cold_++,\
polaroid_690_warm_--,polaroid_690_warm_-,polaroid_690_warm,polaroid_690_warm_+,polaroid_690_warm_++
gimp_emulate_film_instant_pro_preview :
-gimp_split_preview "-gimp_emulate_film_instant_pro $*",$-1
#@gimp Negative [color] : gimp_emulate_film_negative_color, gimp_emulate_film_negative_color_preview(1)
#@gimp : Preset = choice{"None",
#@gimp : "Agfa Ultra Color 100","Agfa Vista 200","Fuji Superia 200","Fuji Superia HG 1600","Fuji Superia Reala 100","Fuji Superia X-Tra 800",
#@gimp : "Kodak Elite 100 XPRO","Kodak Elite Color 200","Kodak Elite Color 400","Kodak Portra 160 NC","Kodak Portra 160 VC","Lomography Redscale 100"}
#@gimp : Sep = separator()
#@gimp : Opacity = float(1,0,1)
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Hue = float(0,-180,180)
#@gimp : Saturation = float(0,-1,1)
#@gimp : Post-normalize = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small><b>Note:</b> The color LUTs used in this section have been designed by <b>Patrick David</b>. More infos at:</small>")
#@gimp : Link = link{"Film Emulation Presets in G'MIC","http://gmic.eu/film_emulation/index.shtml"}
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Patrick David</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>08/29/2013</i>.</small>")
gimp_emulate_film_negative_color :
-_gimp_emulate_film $1,@{-arg\ $1,@{-_$0}},${2--1}
_gimp_emulate_film_negative_color :
-u agfa_ultra_color_100,agfa_vista_200,fuji_superia_200,fuji_superia_hg_1600,fuji_superia_reala_100,fuji_superia_x-tra_800,\
kodak_elite_100_xpro,kodak_elite_color_200,kodak_elite_color_400,kodak_portra_160_nc,kodak_portra_160_vc,lomography_redscale_100
gimp_emulate_film_negative_color_preview :
-gimp_split_preview "-gimp_emulate_film_negative_color $*",$-1
#@gimp Negative [new] : gimp_emulate_film_negative_new, gimp_emulate_film_negative_new_preview(1)
#@gimp : Preset = choice{"None","Fuji 160C","Fuji 400H","Fuji 800Z","Fuji Ilford HP5","Kodak Portra 160","Kodak Portra 400","Kodak Portra 800","Kodak TMAX 3200","Kodak TRI-X 400"}
#@gimp : Effect = choice(1,"Low","Standard","High","Higher")
#@gimp : Sep = separator()
#@gimp : Opacity = float(1,0,1)
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Hue = float(0,-180,180)
#@gimp : Saturation = float(0,-1,1)
#@gimp : Post-normalize = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small><b>Note:</b> The color LUTs used in this section have been designed by <b>Patrick David</b>. More infos at:</small>")
#@gimp : Link = link{"Film Emulation Presets in G'MIC","http://gmic.eu/film_emulation/index.shtml"}
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Patrick David</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>08/29/2013</i>.</small>")
gimp_emulate_film_negative_new :
-_gimp_emulate_film $1,@{-arg\ {max(1,4*$1+$2-3)},@{-_$0}},${3--1}
_gimp_emulate_film_negative_new :
-u fuji_160c_-,fuji_160c,fuji_160c_+,fuji_160c_++,\
fuji_400h_-,fuji_400h,fuji_400h_+,fuji_400h_++,\
fuji_800z_-,fuji_800z,fuji_800z_+,fuji_800z_++,\
fuji_ilford_hp5_-,fuji_ilford_hp5,fuji_ilford_hp5_+,fuji_ilford_hp5_++,\
kodak_portra_160_-,kodak_portra_160,kodak_portra_160_+,kodak_portra_160_++,\
kodak_portra_400_-,kodak_portra_400,kodak_portra_400_+,kodak_portra_400_++,\
kodak_portra_800_-,kodak_portra_800,kodak_portra_800_+,kodak_portra_800_++,\
kodak_tmax_3200_-,kodak_tmax_3200,kodak_tmax_3200_+,kodak_tmax_3200_++,\
kodak_tri-x_400_-,kodak_tri-x_400,kodak_tri-x_400_+,kodak_tri-x_400_++
gimp_emulate_film_negative_new_preview :
-gimp_split_preview "-gimp_emulate_film_negative_new $*",$-1
#@gimp Negative [old] : gimp_emulate_film_negative_old, gimp_emulate_film_negative_old_preview(1)
#@gimp : Preset = choice{0,"None","Fuji Ilford Delta 3200","Fuji Neopan 1600","Fuji Superia 100","Fuji Superia 400","Fuji Superia 800","Fuji Superia 1600",
#@gimp : "Kodak Portra 160 NC","Kodak Portra 160 VC","Kodak Portra 400 NC","Kodak Portra 400 UC","Kodak Portra 400 VC"}
#@gimp : Effect = choice(1,"Low","Standard","High","Higher")
#@gimp : Sep = separator()
#@gimp : Opacity = float(1,0,1)
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Hue = float(0,-180,180)
#@gimp : Saturation = float(0,-1,1)
#@gimp : Post-normalize = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small><b>Note:</b> The color LUTs used in this section have been designed by <b>Patrick David</b>. More infos at:</small>")
#@gimp : Link = link{"Film Emulation Presets in G'MIC","http://gmic.eu/film_emulation/index.shtml"}
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Patrick David</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>08/29/2013</i>.</small>")
gimp_emulate_film_negative_old :
-_gimp_emulate_film $1,@{-arg\ {max(1,4*$1+$2-3)},@{-_$0}},${3--1}
_gimp_emulate_film_negative_old :
-u fuji_ilford_delta_3200_-,fuji_ilford_delta_3200,fuji_ilford_delta_3200_+,fuji_ilford_delta_3200_++,\
fuji_neopan_1600_-,fuji_neopan_1600,fuji_neopan_1600_+,fuji_neopan_1600_++,\
fuji_superia_100_-,fuji_superia_100,fuji_superia_100_+,fuji_superia_100_++,\
fuji_superia_400_-,fuji_superia_400,fuji_superia_400_+,fuji_superia_400_++,\
fuji_superia_800_-,fuji_superia_800,fuji_superia_800_+,fuji_superia_800_++,\
fuji_superia_1600_-,fuji_superia_1600,fuji_superia_1600_+,fuji_superia_1600_++,\
kodak_portra_160_nc_-,kodak_portra_160_nc,kodak_portra_160_nc_+,kodak_portra_160_nc_++,\
kodak_portra_160_vc_-,kodak_portra_160_vc,kodak_portra_160_vc_+,kodak_portra_160_vc_++,\
kodak_portra_400_nc_-,kodak_portra_400_nc,kodak_portra_400_nc_+,kodak_portra_400_nc_++,\
kodak_portra_400_uc_-,kodak_portra_400_uc,kodak_portra_400_uc_+,kodak_portra_400_uc_++,\
kodak_portra_400_vc_-,kodak_portra_400_vc,kodak_portra_400_vc_+,kodak_portra_400_vc_++
gimp_emulate_film_negative_old_preview :
-gimp_split_preview "-gimp_emulate_film_negative_old $*",$-1
#@gimp Print films : gimp_emulate_film_print, gimp_emulate_film_print_preview(1)
#@gimp : Preset = choice{"None","Fuji 3510 (Constlclip)","Fuji 3510 (Constlmap)","Fuji 3510 (Cuspclip)",
#@gimp : "Fuji 3513 (Constlclip)","Fuji 3513 (Constlmap)","Fuji 3513 (Cuspclip)",
#@gimp : "Kodak 2383 (Constlclip)","Kodak 2383 (Constlmap)","Kodak 2383 (Cuspclip)",
#@gimp : "Kodak 2393 (Constlclip)","Kodak 2393 (Constlmap)","Kodak 2393 (Cuspclip)"}
#@gimp : Sep = separator()
#@gimp : Opacity = float(1,0,1)
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Hue = float(0,-180,180)
#@gimp : Saturation = float(0,-1,1)
#@gimp : Post-normalize = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small><b>Note:</b> The color LUTs used in this section have been provided by <b>Juan Melara</b>, and are freely available at:</small>")
#@gimp : Link = link("Print Film Emulation LUTs For Download","http://juanmelara.com.au/print-film-emulation-luts-for-download/")
#@gimp : Note = note("<small>More infos at:</small>")
#@gimp : Link = link{"Film Emulation Presets in G'MIC","http://gmic.eu/film_emulation/index.shtml"}
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Juan Melara</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>04/15/2014</i>.</small>")
gimp_emulate_film_print :
-_gimp_emulate_film $1,@{-arg\ $1,@{-_$0}},${2--1}
_gimp_emulate_film_print :
-u fuji3510_constlclip,fuji3510_constlmap,fuji3510_cuspclip,\
fuji3513_constlclip,fuji3513_constlmap,fuji3513_cuspclip,\
kodak2383_constlclip,kodak2383_constlmap,kodak2383_cuspclip,\
kodak2393_constlclip,kodak2393_constlmap,kodak2393_cuspclip
gimp_emulate_film_print_preview :
-gimp_split_preview "-gimp_emulate_film_print $*",$-1
#@gimp Slide [color] : gimp_emulate_film_colorslide, gimp_emulate_film_colorslide_preview(1)
#@gimp : Preset = choice{"None",
#@gimp : "Agfa Precisa 100","Fuji Astia 100F","Fuji FP 100C","Fuji Provia 100F","Fuji Provia 400F","Fuji Provia 400X","Fuji Sensia 100",
#@gimp : "Fuji Superia 200 XPRO","Fuji Velvia 50","Generic Fuji Astia 100","Generic Fuji Provia 100","Generic Fuji Velvia 100",
#@gimp : "Generic Kodachrome 64","Generic Kodak Ektachrome 100 VS","Kodak E-100 GX Ektachrome 100","Kodak Ektachrome 100 VS","Kodak Elite Chrome 200",
#@gimp : "Kodak Elite Chrome 400","Kodak Elite ExtraColor 100","Kodak Kodachrome 200","Kodak Kodachrome 25","Kodak Kodachrome 64","Lomography X-Pro Slide 200",
#@gimp : "Polaroid 669","Polaroid 690","Polaroid Polachrome"}
#@gimp : Sep = separator()
#@gimp : Opacity = float(1,0,1)
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Hue = float(0,-180,180)
#@gimp : Saturation = float(0,-1,1)
#@gimp : Post-normalize = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small><b>Note:</b> The color LUTs used in this section have been designed by <b>Patrick David</b>. More infos at:</small>")
#@gimp : Link = link{"Film Emulation Presets in G'MIC","http://gmic.eu/film_emulation/index.shtml"}
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Patrick David</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>08/29/2013</i>.</small>")
gimp_emulate_film_colorslide :
-_gimp_emulate_film $1,@{-arg\ $1,@{-_$0}},${2--1}
_gimp_emulate_film_colorslide :
-u agfa_precisa_100,fuji_astia_100f,fuji_fp_100c,fuji_provia_100f,fuji_provia_400f,fuji_provia_400x,fuji_sensia_100,\
fuji_superia_200_xpro,fuji_velvia_50,generic_fuji_astia_100,generic_fuji_provia_100,generic_fuji_velvia_100,\
generic_kodachrome_64,generic_kodak_ektachrome_100_vs,kodak_e-100_gx_ektachrome_100,kodak_ektachrome_100_vs,kodak_elite_chrome_200,\
kodak_elite_chrome_400,kodak_elite_extracolor_100,kodak_kodachrome_200,kodak_kodachrome_25,kodak_kodachrome_64,lomography_x-pro_slide_200,\
polaroid_669,polaroid_690,polaroid_polachrome
gimp_emulate_film_colorslide_preview :
-gimp_split_preview "-gimp_emulate_film_colorslide $*",$-1
#@gimp User-defined : gimp_emulate_film_userdefined, gimp_emulate_film_userdefined(1)
#@gimp : Specify clut as = choice(2,"Top layer","Bottom layer","Filename")
#@gimp : Clut filename = file()
#@gimp : Note = note("<small><b>Note:</b> Do not forget to set the <i>Input layers</i> option if you select <i>Top layer</i> or <i>Bottom layer</i>.</small>")
#@gimp : Sep = separator()
#@gimp : Opacity = float(1,0,1)
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Hue = float(0,-180,180)
#@gimp : Saturation = float(0,-1,1)
#@gimp : Post-normalize = bool(0)
#@gimp : Sep = separator(), note = note("<small>More infos at:</small>")
#@gimp : Link = link{"Film Emulation Presets in G'MIC","http://gmic.eu/film_emulation/index.shtml"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>07/30/2014</i>.</small>")
gimp_emulate_film_userdefined :
-if {$1<2}
-if {@#<2} -gimp_warning_preview "Input layer with CLUT is missing" -return -endif
ind={if($1,-1,0)} -map_clut[^$ind] [$ind] -rm[$ind]
-else
-l "$2" -onfail -gimp_warning_preview "Specified CLUT filename not found" -return -endl
-map_clut[^-1] [-1] -rm[-1]
-endif
-_gimp_emulate_film 0,0,${3--1}
#@gimp Various : gimp_emulate_film_various, gimp_emulate_film_various_preview(1)
#@gimp : Preset = choice{"None","60's","60's (faded)","60's (faded alt)","Black & White","Color (rich)","Faded","Faded (alt)","Faded (analog)","Faded (extreme)","Faded (vivid)",
#@gimp : "Hong Kong","Light (blown)","Lomo","Natural (vivid)","Nostalgic","Purple","Retro",
#@gimp : "Summer","Summer (alt)","Sunny","Sunny (alt)","Sunny (warm)","Sunny (rich)","Super warm","Super warm (rich)","Sutro FX","Vibrant","Vibrant (alien)",
#@gimp : "Vintage","Vintage (alt)","Vintage (brighter)","Warm","Warm (yellow)"}
#@gimp : Sep = separator()
#@gimp : Opacity = float(1,0,1)
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Hue = float(0,-180,180)
#@gimp : Saturation = float(0,-1,1)
#@gimp : Post-normalize = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>More infos at:</small>")
#@gimp : Link = link{"Film Emulation Presets in G'MIC","http://gmic.eu/film_emulation/index.shtml"}
#@gimp : Sep = separator(), note = note("<small>Authors: <i>David Tschumperl&#233;</i> and <i>Patrick David</i>.      Latest update: <i>07/29/2014</i>.</small>")
gimp_emulate_film_various :
-_gimp_emulate_film $1,@{-arg\ $1,@{-_$0}},${2--1}
_gimp_emulate_film_various :
-u 60{`39`}s,60{`39`}s_faded,60{`39`}s_faded_alt,black_and_white,color_rich,faded,faded_alt,faded_analog,faded_extreme,faded_vivid,\
hong_kong,light_blown,lomo,natural_vivid,nostalgic,purple,retro,\
summer,summer_alt,sunny,sunny_alt,sunny_warm,sunny_rich,super_warm,super_warm_rich,sutro_fx,vibrant,vibrant_alien,\
vintage,vintage_alt,vintage_brighter,warm,warm_yellow
gimp_emulate_film_various_preview :
-gimp_split_preview "-gimp_emulate_film_various $*",$-1
_gimp_emulate_film :
-if $1
dir=@{-path_user}
-if {!@{-is_windows}}
dir=$dir/.gmic_film_presets
-if $dir -else -x "mkdir "$dir -endif
-endif
-if {narg($_force_redownload)}
-i http://gmic.eu/data_film_presets/$2.cimgz -o[-1] $dir/gmic_$2.cimgz
-else
-if $dir/gmic_$2.cimgz -i $dir/gmic_$2.cimgz
-else -i http://gmic.eu/data_film_presets/$2.cimgz -o[-1] $dir/gmic_$2.cimgz
-endif
-endif
-repeat {@#-1}
-if {$3<1} --map_clut[$>] [-1] -j[$>] [-1],0,0,0,0,$3 -rm[-1]
-else -map_clut[$>] [-1]
-endif
-done
-rm[-1]
-endif
-repeat @# -l[$>] -split_opacity
-apply_gamma[0] {10^$4}
--[0] 128 -*[0] $5 -+[0] 128 -+[0] $6 -c[0] 0,255
-if {$7||$8||$9}
-rgb2hsv[0]
-sh[0] 0,0 -+[-1] $7 -%[-1] 360 -rm[-1]
-sh[0] 1,1 -+[-1] $8 -c[-1] 0,1 -rm[-1]
-hsv2rgb[0]
-if $9 -n[0] 0,255 -endif
-endif
-a c -endl -done
#@gimp <i>[collages]</i>
#@gimp B&amp;W films - collage : gimp_emulate_film_collage_bw, gimp_no_preview
#@gimp : Image size = float(512,16,1024)
#@gimp : Columns for collage = int(4,1,8)
#@gimp : Label size = int(16,10,100)
#@gimp : Output as = choice("Table","Multiple layers")
#@gimp : Sep = separator()
#@gimp : Note = note{"<small><b>Note:</b> This filter will create a collage of all available <i>B&amp;W</i> film emulation presets
#@gimp : to show you how those presets modify the look of your image. It will also download all corresponding color profiles
#@gimp : (this may take some time at the first run).
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/28/2013</i>.</small>")
gimp_emulate_film_collage_bw :
-k[0] -to_rgb -if {max(w,h)>$1} -if {w>h} -r2dx $1 -else -r2dy $1 -endif -endif
_nbc=$2 _label_size=$3 _output_type=$4 -_gimp_emulate_film_collage @{-_gimp_emulate_film_bw}
#@gimp Instant - collage [consumer] : gimp_emulate_film_collage_instant_consumer, gimp_no_preview
#@gimp : Image size = float(512,16,1024)
#@gimp : Columns for collage = int(4,1,8)
#@gimp : Label size = int(16,10,100)
#@gimp : Output as = choice("Table","Multiple layers")
#@gimp : Note = note{"<small><b>Note:</b> This filter will create a collage of all available <i>Instant [consumer]</i> film emulation presets
#@gimp : to show you how those presets modify the look of your image. It will also download all corresponding color profiles
#@gimp : (this may take some time at the first run).
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/28/2013</i>.</small>")
gimp_emulate_film_collage_instant_consumer :
-k[0] -to_rgb -if {max(w,h)>$1} -if {w>h} -r2dx $1 -else -r2dy $1 -endif -endif
_nbc=$2 _label_size=$3 _output_type=$4 -_gimp_emulate_film_collage @{-_gimp_emulate_film_instant_consumer}
#@gimp Instant - collage [pro] : gimp_emulate_film_collage_instant_pro, gimp_no_preview
#@gimp : Image size = float(512,16,1024)
#@gimp : Columns for collage = int(4,1,8)
#@gimp : Label size = int(16,10,100)
#@gimp : Output as = choice("Table","Multiple layers")
#@gimp : Note = note{"<small><b>Note:</b> This filter will create a collage of all available <i>Instant [pro]</i> film emulation presets
#@gimp : to show you how those presets modify the look of your image. It will also download all corresponding color profiles
#@gimp : (this may take some time at the first run).
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/28/2013</i>.</small>")
gimp_emulate_film_collage_instant_pro :
-k[0] -to_rgb -if {max(w,h)>$1} -if {w>h} -r2dx $1 -else -r2dy $1 -endif -endif
_nbc=$2 _label_size=$3 _output_type=$4 -_gimp_emulate_film_collage @{-_gimp_emulate_film_instant_pro}
#@gimp Negative - collage [color] : gimp_emulate_film_collage_negative_color, gimp_no_preview
#@gimp : Image size = float(512,16,1024)
#@gimp : Columns for collage = int(4,1,8)
#@gimp : Label size = int(16,10,100)
#@gimp : Output as = choice("Table","Multiple layers")
#@gimp : Note = note{"<small><b>Note:</b> This filter will create a collage of all available <i>Negative [color]</i> film emulation presets
#@gimp : to show you how those presets modify the look of your image. It will also download all corresponding color profiles
#@gimp : (this may take some time at the first run).
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/28/2013</i>.</small>")
gimp_emulate_film_collage_negative_color :
-k[0] -to_rgb -if {max(w,h)>$1} -if {w>h} -r2dx $1 -else -r2dy $1 -endif -endif
_nbc=$2 _label_size=$3 _output_type=$4 -_gimp_emulate_film_collage @{-_gimp_emulate_film_negative_color}
#@gimp Negative - collage [new] : gimp_emulate_film_collage_negative_new, gimp_no_preview
#@gimp : Image size = float(512,16,1024)
#@gimp : Columns for collage = int(4,1,8)
#@gimp : Label size = int(16,10,100)
#@gimp : Output as = choice("Table","Multiple layers")
#@gimp : Note = note{"<small><b>Note:</b> This filter will create a collage of all available <i>Negative [new]</i> film emulation presets
#@gimp : to show you how those presets modify the look of your image. It will also download all corresponding color profiles
#@gimp : (this may take some time at the first run).
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/28/2013</i>.</small>")
gimp_emulate_film_collage_negative_new :
-k[0] -to_rgb -if {max(w,h)>$1} -if {w>h} -r2dx $1 -else -r2dy $1 -endif -endif
_nbc=$2 _label_size=$3 _output_type=$4 -_gimp_emulate_film_collage @{-_gimp_emulate_film_negative_new}
#@gimp Negative - collage [old] : gimp_emulate_film_collage_negative_old, gimp_no_preview
#@gimp : Image size = float(512,16,1024)
#@gimp : Columns for collage = int(4,1,8)
#@gimp : Label size = int(16,10,100)
#@gimp : Output as = choice("Table","Multiple layers")
#@gimp : Note = note{"<small><b>Note:</b> This filter will create a collage of all available <i>Negative [old]</i> film emulation presets
#@gimp : to show you how those presets modify the look of your image. It will also download all corresponding color profiles
#@gimp : (this may take some time at the first run).
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/28/2013</i>.</small>")
gimp_emulate_film_collage_negative_old :
-k[0] -to_rgb -if {max(w,h)>$1} -if {w>h} -r2dx $1 -else -r2dy $1 -endif -endif
_nbc=$2 _label_size=$3 _output_type=$4 -_gimp_emulate_film_collage @{-_gimp_emulate_film_negative_old}
#@gimp Print films - collage : gimp_emulate_film_collage_print, gimp_no_preview
#@gimp : Image size = float(512,16,1024)
#@gimp : Columns for collage = int(4,1,8)
#@gimp : Label size = int(16,10,100)
#@gimp : Output as = choice("Table","Multiple layers")
#@gimp : Note = note{"<small><b>Note:</b> This filter will create a collage of all available <i>Others</i> film emulation presets
#@gimp : to show you how those presets modify the look of your image. It will also download all corresponding color profiles
#@gimp : (this may take some time at the first run).
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>04/15/2014</i>.</small>")
gimp_emulate_film_collage_print :
-k[0] -to_rgb -if {max(w,h)>$1} -if {w>h} -r2dx $1 -else -r2dy $1 -endif -endif
_nbc=$2 _label_size=$3 _output_type=$4 -_gimp_emulate_film_collage @{-_gimp_emulate_film_print}
#@gimp Slide - collage [color] : gimp_emulate_film_collage_colorslide, gimp_no_preview
#@gimp : Image size = float(512,16,1024)
#@gimp : Columns for collage = int(4,1,8)
#@gimp : Label size = int(16,10,100)
#@gimp : Output as = choice("Table","Multiple layers")
#@gimp : Note = note{"<small><b>Note:</b> This filter will create a collage of all available <i>Slide [color]</i> film emulation presets
#@gimp : to show you how those presets modify the look of your image. It will also download all corresponding color profiles
#@gimp : (this may take some time at the first run).
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/28/2013</i>.</small>")
gimp_emulate_film_collage_colorslide :
-k[0] -to_rgb -if {max(w,h)>$1} -if {w>h} -r2dx $1 -else -r2dy $1 -endif -endif
_nbc=$2 _label_size=$3 _output_type=$4 -_gimp_emulate_film_collage @{-_gimp_emulate_film_colorslide}
_gimp_emulate_film_collage :
$=arg -progress 0
-repeat $#
preset=${arg{$>+1}}
--l[0]
-_gimp_emulate_film[0] 1,$preset,1,0,1,0,0,0,0,0
({'$preset'}) -replace[-1] {'_'},32 -f[-1] if(x==0&&i>={'a'}&&i<={'z'},i+{'A'}-{'a'},i) title=@{-1,t} -rm[-1]
-text_outline[-1] $title,2,2,$_label_size,2,1,255
-endl
-progress {(1+$>)*100/$#}
-done
-text_outline[0] "Original image",2,2,$_label_size,2,1,255
-if {!$_output_type} -frame 1,1,0 -frame 5,5,255 -- 255 -append_tiles {min($_nbc,@#)} -+ 255 -endif
#@gimp Various - collage : gimp_emulate_film_collage_various, gimp_no_preview
#@gimp : Image size = float(512,16,1024)
#@gimp : Columns for collage = int(4,1,8)
#@gimp : Label size = int(16,10,100)
#@gimp : Output as = choice("Table","Multiple layers")
#@gimp : Note = note{"<small><b>Note:</b> This filter will create a collage of all available <i>Others</i> film emulation presets
#@gimp : to show you how those presets modify the look of your image. It will also download all corresponding color profiles
#@gimp : (this may take some time at the first run).
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Authors: <i>David Tschumperl&#233;</i> and <i>Patrick David</i>.      Latest update: <i>07/29/2014</i>.</small>")
gimp_emulate_film_collage_various :
-k[0] -to_rgb -if {max(w,h)>$1} -if {w>h} -r2dx $1 -else -r2dy $1 -endif -endif
_nbc=$2 _label_size=$3 _output_type=$4 -_gimp_emulate_film_collage @{-_gimp_emulate_film_various}
#@gimp _
#@gimp [download all presets] : gimp_emulate_film_download, gimp_no_preview(1)
#@gimp : Note = note{"This filter will download the color and grain profiles for all film emulation presets available in <i>G'MIC</i>,
#@gimp : and will install them as persistent data files on your hard drive. After this operation, you won't need a permanent
#@gimp : internet connection anymore in order to use the G'MIC film emulation filters."}
#@gimp : Note = note()
#@gimp : Note = note{"<b><span color="red">Warning:</span></b> About <b>90 Mb</b> of data will be downloaded by this filter. This can take a long time !"}
#@gimp : Sep = separator()
#@gimp : Force re-download = _bool(0)
#@gimp : Sep = separator()
#@gimp : Note = note{"<b><span color="red">Alternative (manual) method:</span></b>\nIf, for any reasons, your plug-in is unable to retrieve data from the Internet, you can download all
#@gimp : color profiles manually (as a single .zip file) at this address :"}
#@gimp : Link = link{"http://gmic.eu/data_film_presets/all_gmic_film_presets.zip"}
#@gimp : Note = note{"You must then decompress all files contained in this archive at the following location:\n
#@gimp : - for <b>unix</b>-like systems : <span color ="blue"><tt>$HOME/.gmic_film_presets/</tt></span>\n
#@gimp : - for <b>windows</b> systems : <span color ="blue"><tt>%APPDATA/</tt></span>
#@gimp : "}
#@gimp : Sep = separator(), note = note("<small>More infos at:</small>")
#@gimp : Link = link{"Film Emulation Presets in G'MIC","http://gmic.eu/film_emulation/index.shtml"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>04/16/2014</i>.</small>")
gimp_emulate_film_download :
-_gimp_emulate_film_download @{-_gimp_emulate_film_bw},\
@{-_gimp_emulate_film_instant_consumer},\
@{-_gimp_emulate_film_instant_pro},\
@{-_gimp_emulate_film_negative_color},\
@{-_gimp_emulate_film_negative_new},\
@{-_gimp_emulate_film_negative_old},\
@{-_gimp_emulate_film_print},\
@{-_gimp_emulate_film_colorslide},\
@{-_gimp_emulate_film_various},\
@{-_gimp_emulate_grain}
-l[] -progress 0
-if $1 _force_redownload=1 -endif
-repeat $_nb_presets -l[] -_gimp_emulate_film 1,${_preset{1+$>}},1,0,1,0,0,0,0 -progress {($>+1)*100/$_nb_presets} -onfail -endl -rm -done
-endl
_gimp_emulate_film_download :
_nb_presets=$#
$=_preset
#@gimp _
#@gimp <b>Frames</b>
#@gimp Droste : gimp_droste, gimp_droste_preview(1)
#@gimp : Note = note("<span color=\"red\">Upper-left coordinates :</span>")
#@gimp : X0 = float(20,0,100)
#@gimp : Y0 = float(20,0,100)
#@gimp : Sep = separator(), note = note("<span color=\"magenta\">Upper-right coordinates :</span>")
#@gimp : X1 = float(80,0,100)
#@gimp : Y1 = float(20,0,100)
#@gimp : Sep = separator(), note = note("<span color=\"blue\">Lower-right coordinates :</span>")
#@gimp : X2 = float(80,0,100)
#@gimp : Y2 = float(80,0,100)
#@gimp : Sep = separator(), note = note("<span color=\"cyan\">Lower-left coordinates :</span>")
#@gimp : X3 = float(20,0,100)
#@gimp : Y3 = float(80,0,100)
#@gimp : Sep = separator()
#@gimp : Iterations = int(1,1,10)
#@gimp : X-shift = float(0,-100,100)
#@gimp : Y-shift = float(0,-100,100)
#@gimp : Angle = float(0,0,360)
#@gimp : Zoom = float(1,0.1,5)
#@gimp : Mirror = choice("None","x-axis","y-axis","xy-axes")
#@gimp : Boundary = choice(1,"Black","Nearest","Repeat")
#@gimp : Drawing mode = choice{"Replace","Replace (sharpest)","Behind","Below"}
#@gimp : View outlines only = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>06/11/2012</i>.</small>")
gimp_droste :
-repeat @#
-if {$16==1} 100%,100%,1,1,'x' 100%,100%,1,1,'y' -a[-2,-1] c -endif
-repeat $9
x0={round($1*w/100)} y0={round($2*h/100)} x1={round($3*w/100)} y1={round($4*h/100)}
x2={round($5*w/100)} y2={round($6*h/100)} x3={round($7*w/100)} y3={round($8*h/100)}
100%,100%,1,2,-32767 -polygon[-1] 4,$x0,$y0,$x1,$y1,$x2,$y2,$x3,$y3,1,-65535
-sh[-1] 0,0 -f[-1] 'if(i==-65535,x03=$x0+(y-$y0)/($y3-$y0)*($x3-$x0);x12=$x1+(y-$y1)/($y2-$y1)*($x2-$x1);(x-x03)/(x12-x03)*(w-1),i)' -rm[-1]
-sh[-1] 1,1 -f[-1] 'if(i==-65535,y01=$y0+(x-$x0)/($x1-$x0)*($y1-$y0);y32=$y3+(x-$x3)/($x2-$x3)*($y2-$y3);(y-y01)/(y32-y01)*(h-1),i)' -rm[-1]
xshift={w*$10/100} yshift={h*$11/100} alpha={-$12*pi/180} ca={cos($alpha)/$13} sa={sin($alpha)/$13} w2={w/2} h2={h/2}
-f[-1] 'if(i==-32767,i,X=i(x,y,0,0)-$w2;Y=i(x,y,0,1)-$h2;if(c==0,$w2-$xshift+X*$ca-Y*$sa,$h2-$yshift+X*$sa+Y*$ca))'
-if {$14==0} -sh[-1] 0,0 -f[-1] 'if(i==-32767,x,i)' -rm[-1] -sh[-1] 1,1 -f[-1] 'if(i==-32767,y,i)' -rm[-1]
-elif {$14==1} -sh[-1] 0,0 -f[-1] 'if(i==-32767,x,w-1-i)' -rm[-1] -sh[-1] 1,1 -f[-1] 'if(i==-32767,y,i)' -rm[-1]
-elif {$14==2} -sh[-1] 0,0 -f[-1] 'if(i==-32767,x,i)' -rm[-1] -sh[-1] 1,1 -f[-1] 'if(i==-32767,y,h-1-i)' -rm[-1]
-else -sh[-1] 0,0 -f[-1] 'if(i==-32767,x,w-1-i)' -rm[-1] -sh[-1] 1,1 -f[-1] 'if(i==-32767,y,h-1-i)' -rm[-1]
-endif
-if {$16<2} -warp[-2] [-1],0,{$16==0},$15 -rm[-1]
-else
--warp[-2] [-1],0,1,$15 -rm[-2]
-if {$16==3} -rv[-2,-1] -endif
-blend[-2,-1] alpha
-endif
-done
-if {$16==1} -warp[-2] [-1],0,1,1 -rm[-1] -endif
-mv[-1] 0 -done
gimp_droste_preview :
-if {!$17} -gimp_droste $* -else -polygon 4,$1%,$2%,$3%,$4%,$5%,$6%,$7%,$8%,0.3,0,0,0,255 -endif
-polygon 4,$1%,$2%,$3%,$4%,$5%,$6%,$7%,$8%,1,0xFFFFFFFF,0,0,0,255
-ellipse $1%,$2%,3,3,0,1,255,0,0,255 -ellipse $1%,$2%,3,3,0,1,0xFFFFFFFF,0,0,0,255
-ellipse $3%,$4%,3,3,0,1,255,0,255,255 -ellipse $3%,$4%,3,3,0,1,0xFFFFFFFF,0,0,0,255
-ellipse $5%,$6%,3,3,0,1,0,0,255,255 -ellipse $5%,$6%,3,3,0,1,0xFFFFFFFF,0,0,0,255
-ellipse $7%,$8%,3,3,0,1,0,255,255,255 -ellipse $7%,$8%,3,3,0,1,0xFFFFFFFF,0,0,0,255
#@gimp Frame [blur] : gimp_frame_blur, gimp_frame_blur(1)
#@gimp : Horizontal size (%) = float(30,0,100)
#@gimp : Vertical size (%) = float(30,0,100)
#@gimp : Sep = separator()
#@gimp : Crop = float(0,0,100)
#@gimp : Blur = float(5,0,10)
#@gimp : Roundness = float(0,0,1)
#@gimp : Apply color balance = bool(0)
#@gimp : Balance color = color(128,128,128)
#@gimp : Normalization = choice("None","Stretch","Equalize")
#@gimp : Sep = separator()
#@gimp : Outline size = float(5,0,50)
#@gimp : Outline color = color(255,255,255)
#@gimp : X-shadow = float(2,-10,10)
#@gimp : Y-shadow = float(2,-10,10)
#@gimp : Shadow smoothness = float(1,0,5)
#@gimp : Shadow contrast = float(0,0,100)
#@gimp : X-centering = float(0.5,0,1)
#@gimp : Y-centering = float(0.5,0,1)
#@gimp : Angle = float(0,-180,180)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/19/2014</i>.</small>")
gimp_frame_blur :
-repeat @# -l[$>] -to_rgb
sx={$1%*max(w,h)} sy={$2%*max(w,h)}
--r {w+$sx},{h+$sy},1,100%,3 -b[1] $4%
-if $6 -balance_gamma[1] ${7-9} -endif
-if {$10==1} -n[1] 0,255 -elif {$10==2} -n[1] 0,255 -equalize[1] 256 -endif
-rv
-z[1] {$3/2}%,{$3/2}%,{100-$3/2}%,{100-$3/2}%
-to_rgba[1]
-if $5 r={1+1/$5} -sh[1] 100%,100% -f[-1] '1-(abs(x/w-0.5)^$r+abs(y/h-0.5)^$r)^(1/$r)'
v={min(i(w/2,0),i(w-1,h/2),i(w/2,h-1),i(0,h/2))}
-c[-1] $v,{$v+0.5/max(w,h)} -n[-1] 0,255 -rm[-1] -endif
s={$11%*max(w,h)}
-r[1] {w+$s},{h+$s},1,4,0,0,0.5,0.5
-i[1] 100%,100%,1,3 -fc[1] ${12-14} -blend[1,2] alpha -to_a[-1]
-if $5 -sh[1] 100%,100% -f[-1] '1-(abs(x/w-0.5)^$r+abs(y/h-0.5)^$r)^(1/$r)'
v={min(i(w/2,0),i(w-1,h/2),i(w/2,h-1),i(0,h/2))}
-c[-1] $v,{$v+0.5/max(w,h)} -n[-1] 0,255 -rm[-1] -endif
-rotate[1] $21,1,0
-r[1] [0],[0],1,4,0,0,$19,$20
--channels[1] 100% -b[-1] $17%,0 -c[-1] 0,{max(1,100-$18)}% -n[-1] 0,255
-shift[-1] $15%,$16%,0,0,0 -/[-1] -255 -+[-1] 1 -*[0,-1]
-blend alpha
-endl -done
#@gimp Frame [cube] : frame_cube, frame_cube(1)
#@gimp : Depth = float(3,0,30)
#@gimp : X-center = float(0,-2,2)
#@gimp : Y-center = float(0,-2,2)
#@gimp : Left side orientation = choice("Normal","Mirror-X","Mirror-Y","Mirror-XY")
#@gimp : Right side orientation = choice("Normal","Mirror-X","Mirror-Y","Mirror-XY")
#@gimp : Upper side orientation = choice("Normal","Mirror-X","Mirror-Y","Mirror-XY")
#@gimp : Lower sider orientation = choice("Normal","Mirror-X","Mirror-Y","Mirror-XY")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;, Angelo Lama</i>.      Latest update: <i>01/29/2012</i>.</small>")
#@gimp Frame [fuzzy] : gimp_frame_fuzzy, gimp_frame_fuzzy(0)
#@gimp : Horizontal size (%) = float(5,0,100)
#@gimp : Vertical size (%) = float(5,0,100)
#@gimp : Fuzzyness = float(10,0,40)
#@gimp : Smoothness = float(1,0,5)
#@gimp : Color = color(255,255,255,255)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_frame_fuzzy :
-repeat @# -l[$>]
sx={$1%*max(w,h)/2} sy={$2%*max(w,h)/2}
-frame_fuzzy $sx,$sy,${3-7}
-endl -done
#@gimp Frame [painting] : gimp_frame_painting, gimp_frame_painting_preview(1)
#@gimp : Size (%) = float(10,0,100)
#@gimp : Contrast = float(0.4,0,1)
#@gimp : Smoothness = float(6,0,30)
#@gimp : Color = color(225,200,120)
#@gimp : Sep = separator()
#@gimp : Vignette size = float(2,0,50)
#@gimp : Vignette contrast = float(400,0,1000)
#@gimp : Sep = separator()
#@gimp : Defects contrast = float(50,0,512)
#@gimp : Defects density = float(10,0,100)
#@gimp : Defects size = float(1,0,10)
#@gimp : Defects smoothness = float(0.5,0,20)
#@gimp : Sep = separator()
#@gimp : Serial number = int(123456,0,1000000)
#@gimp : Frame as a new layer = _bool(false)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>06/07/2012</i>.</small>")
gimp_frame_painting :
-if $14
-repeat @# 100%,100%,1,4 -frame_painting[-1] $1%,$2,$3%,${4-6},$7%,${8-13}
-rv[-2,-1] -to_a[-1] -r[-1] [-2],[-2],1,4,0,0,0.5,0.5 -mv[-2,-1] 0 -done
-else -frame_painting $1%,$2,$3%,${4-6},$7%,${8-13}
-endif
gimp_frame_painting_preview :
-frame_painting $1%,$2,$3%,${4-6},$7%,${8-13}
#@gimp Frame [pattern] : gimp_frame_pattern, gimp_frame_pattern_preview(1)
#@gimp : Tiles = int(10,3,30)
#@gimp : Pattern = choice(1,"Top layer","Self image")
#@gimp : Iterations = int(1,1,10)
#@gimp : Constrain image size = _bool(1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/01/2014</i>.</small>")
gimp_frame_pattern :
-if {$2||@#==1} -repeat $3 -frame_pattern $1,$4 -done
-else -repeat $3 -frame_pattern[^0] $1,[0],$4 -done -endif
gimp_frame_pattern_preview :
-gimp_frame_pattern ${1-3},1
#@gimp Frame [regular] : gimp_frame, gimp_frame(1)
#@gimp : Note = note("<b>Crop parameters :</b>")
#@gimp : X-start (%) = int(0,0,100)
#@gimp : X-end (%) = int(100,0,100)
#@gimp : Y-start (%) = int(0,0,100)
#@gimp : Y-end (%) = int(100,0,100)
#@gimp : Sep = separator(), note = note("<b>Frame parameters :</b>")
#@gimp : Width (%) = int(10,0,100)
#@gimp : Height (%) = int(10,0,100)
#@gimp : Color = color(0,0,0,255)
#@gimp : Outline size = int(1,0,100)
#@gimp : Outline color = color(255,255,255,255)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_frame :
-to_rgba -repeat @#
-z[-1] $1%,$3%,$2%,$4%
-frame[-1] $11,$11,${12-15}
sx={$5%*max(w,h)} sy={$6%*max(w,h)}
-frame[-1] $sx,$sy,${7-10}
-mv[-1] 0 -done
#@gimp Frame [round] : gimp_frame_round, gimp_frame_round(1)
#@gimp : Sharpness = float(6,0.1,40)
#@gimp : Size (%) = float(20,0,100)
#@gimp : Smoothness = float(0.1,0,15)
#@gimp : Shade = float(0,0,1)
#@gimp : Color = color(255,255,255,255)
#@gimp : Blur frame = float(0,0,100)
#@gimp : Blur shade = float(0.1,0,1)
#@gimp : Blur amplitude = float(3,0,10)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_frame_round :
-frame_round ${1-8}
-if $9 -frame_blur $1,{min(99,$1+$9)},$3,$10,$11% -endif
#@gimp Old photograph : gimp_old_photo, gimp_old_photo(1)
#@gimp : Vignette strength = float(200,0,255)
#@gimp : Vignette min radius = float(50,0,100)
#@gimp : Vignette max radius = float(85,0,100)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_old_photo :
-vignette ${1-3} -old_photo
#@gimp Polaroid : gimp_polaroid, gimp_polaroid(1)
#@gimp : Frame size = int(10,0,400)
#@gimp : Bottom size = int(20,0,400)
#@gimp : X-shadow = float(0,-20,20)
#@gimp : Y-shadow = float(0,-20,20)
#@gimp : Smoothness = float(3,0,5)
#@gimp : Angle = float(20,-180,180)
#@gimp : Vignette strength = float(50,0,255)
#@gimp : Vignette min radius = float(70,0,100)
#@gimp : Vignette max radius = float(95,0,100)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_polaroid :
-vignette ${7-9} -polaroid $1,$2 -drop_shadow $3%,$4%,$5% -rotate $6,1,0
#@gimp Tunnel : gimp_tunnel, gimp_tunnel(1)
#@gimp : Depth = int(4,1,100)
#@gimp : Factor = float(80,1,99)
#@gimp : X-center = float(0.5,0,1)
#@gimp : Y-center = float(0.5,0,1)
#@gimp : Opacity = float(0.2,0,1)
#@gimp : Angle = float(0,-90,90)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/22/2012</i>.</small>")
gimp_tunnel :
-tunnel $1,$2%,${3-6}
#@gimp Vignette : gimp_vignette, gimp_vignette
#@gimp : Strength = float(70,0,255)
#@gimp : Min radius = float(70,0,100)
#@gimp : Max radius = float(95,0,100)
#@gimp : Color = color(0,0,0,255)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/24/2012</i>.</small>")
gimp_vignette :
-repeat @# -to_rgb -l[$>]
-to_rgba -split_opacity
-=[-1] 0 -vignette[-1] ${1-3} -a c --fc ${4-7} -rv -blend alpha
-endl -done
#@gimp _
#@gimp <b>Frequencies</b>
#@gimp Bandpass : gimp_bandpass, gimp_bandpass_preview(0)
#@gimp : Low frequency = float(0,0,100)
#@gimp : High frequency = float(100,0,100)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice(2,"None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_bandpass :
-repeat @# -l[$>] -split_opacity -l[0]
-ac "-bandpass $1%,$2%",$3,$4
-endl -a c -endl -done
gimp_bandpass_preview :
-gimp_split_preview "-gimp_bandpass $*",$-1
#@gimp Fourier analysis : gimp_display_fft, gimp_display_fft(1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_display_fft :
-to_rgb -display_fft
#@gimp Fourier transform : gimp_fourier, gimp_fourier_preview(1)
#@gimp : Transform = choice(0,"Direct","Inverse")
#@gimp : Discard transparency = bool(1)
#@gimp : Link = link("Click here for a video tutorial","http://www.youtube.com/watch?v=3137dDa6P4s")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/11/2014</i>.</small>")
gimp_fourier : -skip ${2=0}
-if $2 -remove_opacity -endif
-if $1 -repeat @# -l
-fft82float -c 0,255
-onfail -error "Image ["$>"] does not seem to be a FFT transform."
-endl -done
-else -float2fft8 -endif
gimp_fourier_preview :
-if $2 -remove_opacity -endif
-if $1 -gimp_no_preview 0
-else -dfft
-endif
#@gimp Fourier watermark : gimp_watermark_fourier, _none_
#@gimp : Text = text{"(c) G'MIC"}
#@gimp : Size = int(53,13,128)
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Note: </b> To make the watermark visible afterwards, use the 'Fourier Analysis' filter. </small>")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_watermark_fourier :
-watermark_fourier "$1",$2 -c 0,255
#@gimp _
#@gimp <b>Layers</b>
#@gimp Align layers : gimp_align_layers, gimp_align_layers_preview
#@gimp : Alignment type = choice(0,"Rigid","Non-rigid")
#@gimp : Smoothness = float(0.7,0,1)
#@gimp : Scales = choice(0,"Auto","1","2","3","4","5","6","7","8")
#@gimp : Revert layers = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_align_layers :
-to_colormode 0
-r @{-max_wh},1,100%,0,0,0.5,0.5
-if ${4=0} -_gimp_revert_layers -endif
-remove_opacity
-if $1 -register_nonrigid[^-1] [-1],$2,0.1,$3
-else -register_rigid[^-1] [-1],{3*$2}
-endif
gimp_align_layers_preview :
-gimp_align_layers $1,$2,0 -blend_edges 0.1
_gimp_revert_layers :
-repeat {int(@#/2)} -rv[{2*$>},{2*$>+1}] -done
#@gimp Blend [average all] : gimp_blend_average_all, gimp_blend_average_all
#@gimp : Note = note{"<small><b>Note:</b>
#@gimp : This filter takes multiple layers as input and average them. Set the <i>Input layers</i> option to handle multiple input layers.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/11/2013</i>.</small>")
gimp_blend_average_all :
-if @#
N=@# -r @{-max_wh},1,100%,0,0,0.5,0.5 -+ -/ $N
-endif
#@gimp Blend [edges] : gimp_blend_edges, gimp_blend_edges(0)
#@gimp : Opacity = float(1,0,1)
#@gimp : Smoothness = float(0.8,0,5)
#@gimp : Revert layers = bool(0)
#@gimp : Sep = separator(), note = note{"<small><b>Note:</b>
#@gimp : This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/21/2013</i>.</small>")
gimp_blend_edges :
-repeat {int(@#/2)} -l[$>,{$>+1}] -if $3 -rv -endif --blend_edges[-2,-1] $2 -rm[-3] -blend[-2,-1] alpha,$1 -endl -done
#@gimp Blend [fade] : gimp_blend_fade, gimp_blend_fade(1)
#@gimp : Preset = choice{1,"Custom","Linear","Circular","Wave","Keftales"}
#@gimp : Offset = float(0,-1,1)
#@gimp : Thinness = float(0,0,10)
#@gimp : Sharpness = float(5,1,20)
#@gimp : Sharpest = bool(0)
#@gimp : Revert layers = bool(0)
#@gimp : Color space = choice("RGB","HSV","Lab")
#@gimp : Note = note{\n<small>
#@gimp : The parameters below are used in most presets.
#@gimp : </small>}
#@gimp : 1st parameter = float(0,-1,1)
#@gimp : 2nd parameter = float(0,-1,1)
#@gimp : 3rd parameter = float(0,-1,1)
#@gimp : Note = note{\n<small>
#@gimp : The formula below is used for the <i>Custom</i> preset.
#@gimp : </small>}
#@gimp : Formula = text{"cos(4*pi*x/w) * sin(4*pi*y/h)"}
#@gimp : Note = note{"<small><b>Note:</b>
#@gimp : This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/21/2013</i>.</small>")
gimp_blend_fade :
-if {@#==1} -return -endif
-to_colormode 4
-if {$7==1} -repeat @# -sh[$>] 0,2 -rgb2hsv[-1] -rm[-1] -done
-elif {$7==2} -repeat @# -sh[$>] 0,2 -srgb2rgb[-1] -rgb2lab[-1] -rm[-1] -done
-endif
-if {$1==0} [0],[0],1,1,"$11"
-else -_gimp_blend_fade$1 $8,$9,$10 -r[-1] [0],[0],1,1,3
-endif
-n[-1] {-(@#-2)*$3},{(@#-2)*(1+$3)}
--[-1] {$2*(1+$3)*(@#-2)}
-c[-1] 0,{@#-2}
-if $6 -rv[^-1] -endif
-if $5 -round[-1] 1
-else -roundify[-1] $4
-endif
-blend_fade[^-1] [-1] -rm[-1]
-if {$7==1} -repeat @# -sh[$>] 0,2 -hsv2rgb[-1] -rm[-1] -done
-elif {$7==2} -repeat @# -sh[$>] 0,2 -lab2rgb[-1] -rgb2srgb[-1] -rm[-1] -done
-endif
-c 0,255
_gimp_blend_fade1 : [0],[0],1,1,"a=$1*pi/2; x*cos(a) + y*sin(a)"
_gimp_blend_fade2 : [0],[0],1,1,0 -=[-1] 1,{($1+1)*50}%,{($2+1)*50}% -distance[-1] 1
_gimp_blend_fade3 : [0],[0],1,1,0 -=[-1] 1,{($1+1)*50}%,{($2+1)*50}% -distance[-1] 1 -*[-1] {0.01+$3/2} -cos[-1]
_gimp_blend_fade4 : [0],[0],1,1,"((x-w*($1+0.5))*(y-h*($2+0.5)))%(0.2*w*h*(1.001+$3))"
#@gimp Blend [median] : blend_median, blend_median(0)
#@gimp : Sep = separator(), note = note{"<small><b>Note:</b>
#@gimp : This filter needs at least two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Authors: <i>David Tschumperl&#233;</i> and <i>Iain Fergusson</i>.      Latest update: <i>12/16/2014</i>.</small>")
#@gimp Blend [seamless] : gimp_blend_seamless, gimp_blend_seamless_preview(1)
#@gimp : Mixed mode = bool(0)
#@gimp : Inner fading = float(0,0,100)
#@gimp : Outer fading = float(25,0,100)
#@gimp : Sep = separator()
#@gimp : Output as separate layers = _bool(0)
#@gimp : Sep = separator(), note = note{"<small><b>Note:</b>
#@gimp : This filter needs at least two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.
#@gimp : </small>"}
#@gimp : Sep = separator(), link = link("Click here for a detailed description of this filter.","http://gimpchat.com/viewtopic.php?f=28&t=10204")
#@gimp : Link = link("+ Video tutorial 1","http://www.youtube.com/watch?v=Nu-S1HmOCgE")
#@gimp : Link = link("+ Video tutorial 2","http://www.youtube.com/watch?v=zsHgQY6025I")
#@gimp : Link = link("+ Video tutorial 3","http://www.youtube.com/watch?v=2e6FikWMkaQ")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>05/04/2014</i>.</small>")
gimp_blend_seamless :
-rv -to_a[^0]
-r[^0] [0],[0],1,100%,0
-repeat @# pos=@{"-_gimp_merge_layers["$>"] pos,0,0"} -shift[$>] @{-u\ $pos},0,0 -done
-if $4
--blend_seamless $1,$2%,$3%
-k[0,-1] -rv -sub_alpha[0] [1],1
-else -blend_seamless $1,$2%,$3%
-endif
gimp_blend_seamless_preview :
-gimp_blend_seamless ${1-3},0
#@gimp Blend [standard] : gimp_blend, gimp_blend_preview
#@gimp : Mode = choice{"Add","Alpha","And","Average","Blue","Burn","Darken","Difference",
#@gimp : "Divide","Dodge","Edges","Exclusion","Freeze","Grain extract","Grain merge","Green","Hard light",
#@gimp : "Hard mix","Hue","Interpolation","Lighten","Lightness","Linear burn","Linear light","Luminance",
#@gimp : "Multiply","Negation","Or","Overlay","Pin light","Red","Reflect","Saturation",
#@gimp : "Shape Average","Shape Average0","Soft burn","Soft dodge","Soft light","Screen","Stamp","Subtract","Value",
#@gimp : "Vivid light","Xor"}
#@gimp : Process as = choice("Two-by-two","Upper layer is the top layer for all blends","Lower layer is the bottom layer for all blends")
#@gimp : Opacity = float(1,0,1)
#@gimp : Revert layers = bool(0)
#@gimp : Preview all outputs = bool(1)
#@gimp : Sep = separator(), note = note{"<small><b>Note:</b>
#@gimp : This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.
#@gimp : </small>"}
#@gimp : Link = link("Reference page for G'MIC blending modes","https://sourceforge.net/p/gmic/wiki/Blending%20modes/")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>06/24/2014</i>.</small>")
gimp_blend :
mode=@{-arg\ 1+$1,add,alpha,and,average,blue,burn,darken,difference,\
divide,dodge,edges,exclusion,freeze,grainextract,grainmerge,green,hardlight,\
hardmix,hue,interpolation,lighten,lightness,linearburn,linearlight,luminance,\
multiply,negation,or,overlay,pinlight,red,reflect,saturation,\
shapeaverage,shapeaverage0,softburn,softdodge,softlight,screen,stamp,subtract,value,\
vividlight,xor}
-if {$2==0} -repeat {int(@#/2)} -l[$>,{$>+1}] -rv -blend $mode,$3,$4 -endl -done
-elif {$2==1" && "@#>1} -blend[^0] [0],$mode,$3,1 -rm[0]
-elif {$2==2" && "@#>1} -blend[^-1] [-1],$mode,$3,0 -rm[-1]
-endif
gimp_blend_preview :
-gimp_blend $*
-if $5 -append_tiles , -endif
#@gimp Colors to layers : gimp_split_colors, gimp_split_colors_preview(1)
#@gimp : Color tolerance = float(50,0,256)
#@gimp : Maximum number of output layers = int(16,2,256)
#@gimp : Minimal area (%) = float(1,0,100%)
#@gimp : Autocrop output layers = bool()
#@gimp : Sep = separator()
#@gimp : Note = note{"<small><b>Note:</b> This filter decomposes an image into several layers each with a single color + a residual layer (if any).
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>03/11/2015</i>.</small>")
gimp_split_colors : -skip ${2=0}
-to_rgb -repeat @# -l[$>]
nm=@{-gimp_layer_name}
min_area={max(1,w*h*$3%)}
-split_colors $1,$2,$min_area
-nm name($nm)
-if $4 -gimp_autocrop_layers -endif
-endl -done
gimp_split_colors_preview :
-repeat @# -l[$>]
--gimp_split_colors ${1-4} -drgba
-repeat @# -l[$>] -text_outline @{-arg\ {1+!!$>},"Original","\#"$>},1,1,43,7,1,255 -endl -done
-frame 1,1,0 -frame 3,3,255 -to_rgba -append_tiles ,
-endl -done
#@gimp Fade layers : gimp_fade_layers, gimp_fade_layers_preview
#@gimp : Inter-frames = _int(10,2,100)
#@gimp : Sep = separator(), note = note{"<small><b>Note:</b>
#@gimp : This filter needs at least two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/04/2012</i>.</small>")
gimp_fade_layers :
-if {@#<2} -return -endif
-to_colormode 0
-r @{-max_wh},1,100%,0,0,0.5,0.5
-a z -r 100%,100%,{(d-1)*$1+1},100%,3 -s z
gimp_fade_layers_preview :
-if {@#<2} -return -endif
-to_colormode 0
-r @{-max_wh},1,100%,0,0,0.5,0.5
-k[0,1] -+ -/ 2
#@gimp Layers to tiles : append_tiles, gimp_append_tiles_preview(1)
#@gimp : X-tiles = int(0,0,256)
#@gimp : Y-tiles = int(0,0,256)
#@gimp : Note = note("<small>For both parameters, <i>0</i> means <i>automatic</i>.</small>")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_append_tiles_preview :
-frame 1,1,0,0,0,255 -append_tiles $1,$2
#@gimp Morph layers : gimp_morph, gimp_no_preview
#@gimp : Inter-frames = _int(10,2,100)
#@gimp : Smoothness = _float(0.2,0,2)
#@gimp : Precision = _float(0.1,0,2)
#@gimp : Revert layers = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_morph :
-if ${4=0} -_gimp_revert_layers -endif
-to_rgb -morph $1,$2,$3
#@gimp Tiles to layers : split_tiles, gimp_tiles2layers_preview(1)
#@gimp : X-tiles = int(3,1,100)
#@gimp : Y-tiles = int(3,1,100)
#@gimp : Force tiles to have same size = _bool(false)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_tiles2layers_preview :
-split_tiles $1,$2,$3 -to_rgba -frame 1,1,0,0,0,255 -frame 3,3,0,0,0,0 -append_tiles ,
#@gimp Tones to layers : gimp_tones2layers, gimp_tones2layers_preview(0)
#@gimp : Number of tones = int(3,2,10)
#@gimp : Start of mid-tones = int(85,0,255)
#@gimp : End of mid-tones = int(170,0,255)
#@gimp : Smoothness = float(0.5,0,5)
#@gimp : Alpha = choice("Binary","Scalar")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>04/05/2014</i>.</small>")
gimp_tones2layers :
sval=$2 eval={max($2,$3)}
-remove_opacity -repeat @# -l[$<]
--luminance -rv
-repeat {$1-1}
[1]
val0={$sval+($eval-$sval)*$>/($1-2)}
val1={$sval+($eval-$sval)*($>+1)/($1-2)-1}
--ir[0] $val0,$val1
-if $5 -*[-1] [0] -b[-1] $4% -n[-1] 0,255
-else -b[-1] $4% -n[-1] 0,255
-endif
-a[-2,-1] c
-done
-rm[0] -rv
-endl -done
gimp_tones2layers_preview :
-gimp_tones2layers $* -rv
-r {100/@#}%,{100/@#}%,1,100%,2
-to_rgba -frame 1,1,0,0,0,255 -frame 3,3,0,0,0,0 -append_tiles ,
#@gimp Transfer colors : gimp_transfer_colors, gimp_transfer_colors
#@gimp : Transfer brighness = bool(0)
#@gimp : Revert layers = bool(0)
#@gimp : Note = note{"<small><b>Note: </b>
#@gimp : The bottom layer contains the target colors.\n
#@gimp : This filter needs at least two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_transfer_colors :
-if ${2=0} -_gimp_revert_layers -endif
-transfer_colors[^-1] [-1],$1
#@gimp _
#@gimp <b>Lights &amp; shadows</b>
#@gimp Burn : gimp_burn, gimp_burn_preview(1)
#@gimp : Amplitude = float(0.5,0,1)
#@gimp : Scale = float(30,1,100)
#@gimp : Smoothness = float(1,0,4)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/24/2012</i>.</small>")
_gimp_burn :
-repeat @# -l[$>]
w={w} h={h}
--norm
-gimp_fourier[-1] 0
--rows[-1] 0,{$h-1} -r[-1] $2%,$2%,1,100%,0,0,0.5,0.5 -b[-1] $3%
-j[-2] [-1],{($w-w)/2},{($h-h)/2} -rm[-1]
-gimp_fourier[-1] 1
-blend overlay,$1
-endl -done
gimp_burn :
-ac "-_gimp_burn ${1-3}",$4,$5
gimp_burn_preview :
-gimp_split_preview "-gimp_burn ${^0}",$-1
#@gimp Contrast swiss mask : gimp_contrast_swm , gimp_contrast_swm(0)
#@gimp : Sep = separator()
#@gimp : Blur the mask = float(2,0.5,10)
#@gimp : Sep = separator()
#@gimp : Note = note ("Contrast Mask need the negative of the mask")
#@gimp : Skip to use the mask to boost = bool(false)
#@gimp : Note = note ("Uncheck for Contrast Mask,Check for Contrast Boost")
#@gimp : Sep = separator()
#@gimp : Note = note("Merge the Mask")
#@gimp : Intensity = float(1,0,1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update: <i>01/01/2011</i>.</small>")
#@gimp : Note = link("Filter explained here","http://www.gimpchat.com/viewtopic.php?f=9&t=864")
gimp_contrast_swm :
-repeat @# -l[$>] -split_opacity -l[0]
--luminance -to_rgb
-blur_xy[1] $1,$1
-if {$2==0} -negative[1] -elif {$2==1} -gimp_do_nothing -endif
-rv -blend hardlight,$3
-endl -a c -endl -done
#@gimp Dodge and burn : gimp_dodgeburn, gimp_dodgeburn_preview(1)
#@gimp : Note = note("automatic dodging and burning")
#@gimp : Sep = separator()
#@gimp : Highlights selection = float(15,0,100)
#@gimp : Highlights abstraction = float(1.5,0,10)
#@gimp : Dodge strength = float(25,0,256)
#@gimp : Dodge blur = float(10,0,20)
#@gimp : Shadows selection = float(40,0,100)
#@gimp : Shadows abstraction = float(1.5,0,10)
#@gimp : Burn strength = float(25,0,256)
#@gimp : Burn blur = float(10,0,20)
#@gimp : Sep = separator()
#@gimp : Note = note("Advanved: output dodge and burn layer separate")
#@gimp : Keep layers seperate = bool(0)
#@gimp : Keep original layer = bool(0)
#@gimp : Blur dodge and burn layer = float(10,0,20)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>.      Latest update: <i>02/15/2011</i>.</small>")
gimp_dodgeburn :
-repeat @# -l[$>] --luminance -if {$9==1} --fc[0] 128,128,128,255 -endif
-tk_gimp_channel_processing[1] 1,1,0,$2,4,0,{100-$1},256,0,1,0,2,0,0
-tk_gimp_channel_processing[1] 1,1,{-{256-$3}},0,0,0,100,256,0,0,0,2,0,0
-gimp_gaussian_blur[1] $4,0,0,1,0,0,0 --luminance[0]
-if {$9==0} -compose_dodge[0,1] -else -rv[1,2] -compose_dodge[1,2] -endif
-tk_gimp_channel_processing[-1] 1,1,0,$6,4,$5,100,256,0,0,0,2,0,0
-tk_gimp_channel_processing[-1] 1,1,{256-$7},0,0,0,100,256,0,0,0,2,0,0
-gimp_gaussian_blur[-1] $8,0,0,1,0,0,0
-if {$9==0} -compose_colorburn[0,1] -else -compose_colorburn[-1,-2] -endif
-if {$9==1} -gimp_gaussian_blur[-1] $11,0,0,1,0,0,0 -endif
-if {$10==0} -if {$9==1} -rm[0] -endif -endif -endl -done
gimp_dodgeburn_preview :
-gimp_split_preview "-gimp_dodgeburn ${1--2}",$-1
#@gimp Drop shadow : gimp_drop_shadow, gimp_drop_shadow(1)
#@gimp : X-shadow = float(3,-20,20)
#@gimp : Y-shadow = float(3,-20,20)
#@gimp : Smoothness = float(1.8,0,5)
#@gimp : Curvature = float(0,0,1)
#@gimp : Corner brightness = float(0,0,1)
#@gimp : Angle = float(0,0,360)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/14/2012</i>.</small>")
gimp_drop_shadow :
-* -1 -+ 255 -vignette {255*$5},80,95 -* -1 -+ 255
-drop_shadow $1%,$2%,$3%,$4 -rotate $6,1,0
#@gimp Drop shadow 3d : gimp_drop_shadow3d, gimp_drop_shadow3d_preview(1)
#@gimp : X-angle = float(0,-90,90)
#@gimp : Y-angle = float(0,-90,90)
#@gimp : Z-angle = float(0,-90,90)
#@gimp : Zoom = float(0,-100,100)
#@gimp : X-offset = float(1,-50,50)
#@gimp : Y-offset = float(1,-50,50)
#@gimp : Perspective = float(2,0,10)
#@gimp : Smoothness = float(0.5,0,5)
#@gimp : Color = color(0,0,0,200)
#@gimp : Preview only shadow = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>07/02/2013</i>.</small>")
gimp_drop_shadow3d :
-repeat @# -l[$<]
--_gimp_drop_shadow3d $*
-endl -done
gimp_drop_shadow3d_preview :
-repeat @# -l[$<]
-if $13 -_gimp_drop_shadow3d $*
-else --_gimp_drop_shadow3d $* -rv -blend alpha
-endif
-endl -done
_gimp_drop_shadow3d :
-point3d 0,0,1 -r3d[-1] 1,0,0,$1 -r3d[-1] 0,1,0,$2 -r3d[-1] 0,0,1,$3
u={i(0,8)} v={i(0,9)} w={i(0,10)} -rm[-1]
-to_a -channels 100% -if {im==iM} -return -endif
--f 'X=x/w-0.5;Y=y/h-0.5;A=($7-$4*$7/100)*$w/(X*$u+Y*$v+$7*$w);if(A<0,1e8,A)'
--*[-1] 'y/h-0.5' -*[-2] 'x/w-0.5' -+[-2] {0.5-$5/100} -+[-1] {0.5-$6/100} -*[-2] {w} -*[-1] {h}
-a[-2,-1] c -warp[0] [-1],0,1,0 -rm[-1]
-b $8% -n 0,$12 -i[-2] ($9^$10^$11) -r[-2] [-1],[-1],1,3 -a[-2,-1] c
#@gimp Equalize shadow : gimp_equalize_shadow, gimp_equalize_shadow_preview(1)
#@gimp : Amplitude = float(1,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Francois Grassard</i> and <i>David Tschumperl&#233;</i>.      Latest update: <i>11/24/2012</i>.</small>")
gimp_equalize_shadow :
-repeat @# -l[$>] --negative -blend softlight,$1 -endl -done
gimp_equalize_shadow_preview :
-gimp_split_preview "-gimp_equalize_shadow $1",$-1
#@gimp Light glow : gimp_lightglow, gimp_lightglow_preview(0)
#@gimp : Density = float(30,0,100)
#@gimp : Amplitude = float(0.5,0,2)
#@gimp : Mode = choice(8,"Burn","Dodge","Freeze","Grain merge","Hard light","Interpolation","Lighten","Multiply","Overlay","Reflect","Soft light","Stamp","Value")
#@gimp : Opacity = float(0.8,0,1)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>02/21/2011</i>.</small>")
_gimp_lightglow :
mode=@{-arg\ 1+$3,burn,dodge,freeze,grainmerge,hardlight,interpolation,lighten,multiply,overlay,reflect,softlight,stamp,value}
-repeat @#
--gradient_norm[-1] ->=[-1] {100-$1}% -distance[-1] 1 -^[-1] $2 -*[-1] -1 -n[-1] 0,255 -blend $mode,$4
-mv[-1] 0 -done
gimp_lightglow :
-ac "-_gimp_lightglow ${1-4}",$5
gimp_lightglow_preview :
-gimp_split_preview "-gimp_lightglow $*",$-1
#@gimp Light patch : gimp_light_patch, gimp_light_patch(0)
#@gimp : Density = int(5,2,30)
#@gimp : Darkness = float(0.7,0,1)
#@gimp : Lightness = float(2.5,1,4)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_light_patch :
-repeat @# -l[$>] -split_opacity -l[0]
-ac "-light_patch $1,$2,$3",$4
-endl -a c -endl -done
#@gimp Light rays : gimp_lightrays, gimp_lightrays(1)
#@gimp : Density = float(80,0,100)
#@gimp : X-center (%) = float(50,0,100)
#@gimp : Y-center (%) = float(50,0,100)
#@gimp : Length = float(1,0,1)
#@gimp : Attenuation = float(0.5,0,1)
#@gimp : Transparency = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/03/2011</i>.</small>")
gimp_lightrays :
-lightrays $1,$2%,$3%,$4,$5
-if $6 -repeat @# -r[$>] 100%,100%,1,{@{$>,s}+(@{$>,s}%2)} -done -endif
#@gimp Relief light : gimp_light_relief, gimp_light_relief(1)
#@gimp : Ambient lightness = float(0.3,0,5)
#@gimp : Specular lightness = float(0.2,0,2)
#@gimp : Specular size = float(0.2,0,1)
#@gimp : Darkness = float(0,0,1)
#@gimp : Light smoothness = float(1,0,5)
#@gimp : X-light = float(0.5,0,1)
#@gimp : Y-light = float(0.5,0,1)
#@gimp : Z-light = float(5,0,20)
#@gimp : Z-scale = float(0.5,0,3)
#@gimp : Opacity as heightmap = bool(0)
#@gimp : Image smoothness = float(0,0,10)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_light_relief :
-b $11% -light_relief ${1-10}
#@gimp Shadow patch : gimp_shadow_patch, gimp_shadow_patch(1)
#@gimp : Opacity = float(0.7,0,1)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_shadow_patch :
-repeat @# -l[$>] -split_opacity -l[0]
-ac "-shadow_patch $1",$2
-endl -a c -endl -done
#@gimp _
#@gimp <b>Patterns</b>
#@gimp Bayer filter : rgb2bayer, rgb2bayer(0)
#@gimp : Starting pattern = choice(0,"Red-Green","Blue-Green","Green-Red","Green-Blue")
#@gimp : Keep colors = bool(1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp Box fitting : gimp_boxfitting, gimp_boxfitting_preview(0)
#@gimp : Minimal size = int(3,1,32)
#@gimp : Maximal size = int(0,0,32)
#@gimp : Note = note("<small><b>Note:</b> Set <i>Maximal size</i> to <i>0</i> to allow any size for the squares.</small>")
#@gimp : Initial density = float(0.1,0,1)
#@gimp : Transparency = bool(0)
#@gimp : Sep = separator(), note = note("<small><b>Note:</b> This filter has been highly inspired by the work of Jared Tarbell, described on the page:</small>")
#@gimp : Link = link("http://www.complexification.net/gallery/machines/boxFittingImg/")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>06/06/2013</i>.</small>")
gimp_boxfitting :
-boxfitting ${1-3},3
-if $4 -to_rgba -replace_color 0,0,0,0,0,255,0,0,0,0 -endif
gimp_boxfitting_preview :
-boxfitting ${1-3},1
-if $4 -to_rgba -replace_color 0,0,0,0,0,255,0,0,0,0 -endif
#@gimp Canvas : gimp_canvas, gimp_canvas_preview(0)
#@gimp : Note = note{"<b>First direction :</b>"}
#@gimp : Amplitude = float(70,0,300)
#@gimp : Angle = float(45,0,180)
#@gimp : Sharpness = float(400,0,2000)
#@gimp : Note = note{"\n<b>Second direction : </b>"}
#@gimp : Activate second direction = bool(true)
#@gimp : Amplitude = float(70,0,300)
#@gimp : Angle = float(135,0,180)
#@gimp : Sharpness = float(400,0,2000)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_canvas :
-repeat @# -l[-1]
-if $4
({cos($2*pi/180)}^{sin($2*pi/180)}) -vector2tensor[-1] -r[-1] [-2],[-2] --smooth[-2] [-1],$1 -rm[-2] -sharpen[-1] $3 -c[-1] 0,255
({cos($6*pi/180)}^{sin($6*pi/180)}) -vector2tensor[-1] -r[-1] [-2],[-2] -smooth[-3] [-1],$5 -rm[-1] -sharpen[-2] $7 -c[-2] 0,255 -+[-2,-1] -/[-1] 2
-else
({cos($2*pi/180)}^{sin($2*pi/180)}) -vector2tensor[-1] -r[-1] [-2],[-2] -smooth[-2] [-1],$1 -rm[-1] -sharpen[-1] $3 -c[-1] 0,255
-endif
-endl -mv[-1] 0 -done
gimp_canvas_preview :
-gimp_split_preview "-gimp_canvas $*",$-1
#@gimp Canvas texture : texturize_canvas, texturize_canvas(0)
#@gimp : Amplitude = float(20,0,256)
#@gimp : Fibrousness = float(3,0,20)
#@gimp : Emboss = float(0.6,0,1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp Clouds : jeje_clouds, jeje_clouds_preview
#@gimp : Density = float(50,0,100)
#@gimp : Smoothness = float(.5,0,1)
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>. Latest update: <i>2013/05/29</i>.</small>")
jeje_clouds :
--clouds $1%,1,$2 -blend alpha
jeje_clouds_preview :
-jeje_clouds $1,$2
#@gimp Cracks : gimp_cracks, gimp_cracks_preview(0)
#@gimp : Density = float(1,0.1,10)
#@gimp : Amplitude = float(-80,-255,255)
#@gimp : Relief = bool(true)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_cracks :
-ac "-cracks $1,$2,$3",$4
gimp_cracks_preview :
-gimp_split_preview "-gimp_cracks $*",$-1
#@gimp Crystal : gimp_crystal, gimp_crystal_preview(0)
#@gimp : Density = float(50,0,100)
#@gimp : Smoothness = float(0.2,0,2)
#@gimp : Edges = float(20,0,100)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/19/2015</i>.</small>")
gimp_crystal :
-repeat @# -l[$>] -split_opacity -l[0]
s={s}
--gradient_norm ->=[-1] {(100-$3)/5} -remove_pixels[-1] {100-max(0.1,$1*$3%)}%,@{-1,+} -*
--norm -neq[-1] 0 -a c
sigma=0.2
-do
--b[-1] $sigma sigma={$sigma*(1+$2)}
-sh[0,-1] $s,$s -max[-1] [-2] -rm[-2,-1]
-f[-1] 'W=i(x,y,z,$s);if(W<0.001||W>=1,0,if(c<$s,i/W,1))'
-if {!iM} -rm[1] -break -endif
-sh[-1] $s,$s
-j[0] [1],0,0,0,0,1,[2] -k[0]
-while 1
-channels 0,{$s-1}
-endl -a c -endl -done
gimp_crystal_preview :
-gimp_split_preview "-gimp_crystal $*",$-1
#@gimp Denim : Denim_samj_en, Denim_samj_en(0)
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Texture</small></span>")
#@gimp : Dimension a = int(5,2,30)
#@gimp : Dilate = int(2,0,5)
#@gimp : Flip the pattern = bool(0)
#@gimp : Noise a = int(40,0,200)
#@gimp : Noise b = int(40,0,200)
#@gimp : Noise c = int(25,0,100)
#@gimp : Noise d = int(50,0,100)
#@gimp : Sharpness = float(0,0,500)
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Color</small></span>")
#@gimp : Denim = color(43,108,126,255)
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/15</i>.</small>")
Denim_samj_en :
-Denim_samj $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12
#@gimp Halftone : gimp_halftone, gimp_halftone_preview(0)
#@gimp : Note = note("<b><small>Image parameters :</small></b>")
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Sep = separator(), note = note("<b><small>Halftone parameters :</small></b>")
#@gimp : Number of tones = int(5,2,32)
#@gimp : Size for dark tones = int(8,2,256)
#@gimp : Size for bright tones = int(8,2,256)
#@gimp : Shape = choice{5,"Square","Diamond","Circle","Square (inv.)","Diamond (inv.)","Circle (inv.)"}
#@gimp : Smoothness = float(0.1,0,32)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>07/23/2012</i>.</small>")
gimp_halftone :
-apply_gamma {10^$1} -- 128 -* $2 -+ 128 -+ $3 -b $4 -c 0,255
-repeat @# -l[$>] -split_opacity
-halftone[0] ${5-9}
-a c -endl -done
gimp_halftone_preview :
-gimp_split_preview "-gimp_halftone $*",$-1
#@gimp Halftone shapes : iain_halftone_shapes, iain_halftone_shapes(0)
#@gimp : Scale = float(100,10,200)
#@gimp : Negative =bool(0)
#@gimp : Shape = choice("Circle","Star","Triangle","Heart")
#@gimp : Oversample = bool(0)
#@gimp : Rotate = float(0,0,180)
#@gimp : Twirl = float(0,0,2)
#@gimp : Sep = separator()
#@gimp : Note = note("Oversample gives smoother results but takes much longer.")
#@gimp : Note = note("Twirl distorts the hafltone grid. The preview is not accurate. For best results use with oversample.")
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author : <i>Iain Fergusson</i>.</small>")
iain_halftone_shapes:
-remove_opacity
scale=$1
-luminance
-if {$4==1}
-resize 400%,400%,1,1,3
scale={$scale*4}
-endif
-if {$3==0}
sx1=353
sx2=515
sx3=677
sx4=1000
sx5=1323
sx6=1485
sx7=1647
sx8=1485
sx9=1323
sx10=1000
sx11=677
sx12=515
sy1=1000
sy2=1280
sy3=1560
sy4=1560
sy5=1560
sy6=1280
sy7=1000
sy8=720
sy9=440
sy10=440
sy11=440
sy12=720
level=19
-luminance
--l
-rm
2000,2000,1,1,0
-repeat 19
-polygon 12,$sx1,$sy1,$sx2,$sy2,$sx3,$sy3,$sx4,$sy4,$sx5,$sy5,$sx6,$sy6,$sx7,$sy7,$sx8,$sy8,$sx9,$sy9,$sx10,$sy10,$sx11,$sy11,$sx12,$sy12,1,$level
sy3={$sy3-(78/16)}
sy5={$sy5-(78/16)}
sy9={$sy9+(78/16)}
sy11={$sy11+(78/16)}
sx1={$sx1+(90/16)}
sx3={$sx3+(45/16)}
sx5={$sx5-(45/16)}
sx7={$sx7-(90/16)}
sx9={$sx9-(45/16)}
sx11={$sx11+(45/16)}
level={$level+10}
-done
radius={560}
level=209
-repeat 57
-circle 50%,50%,$radius,1,$level
radius={$radius-10}
level={$level+10}
-done
-n 0,255
--shift[0] 972,560,0,0
--shift[0] 972,-560,0,0
--shift[0] -972,560,0,0
--shift[0] -972,-560,0,0
-add
-crop 29,440,1972,1560
-endl
-resize[1] 194,112,1,1,2
-equalize[1] 65555
-resize[1] $scale%,$scale%,1,1,3
-if {$2==1}
-negative[1]
-endif
-endif
-if {$3==1}
sx1=50
sx2=194
sx3=281
sx4=511
sx5=742
sx6=829
sx7=972
sx8=829
sx9=742
sx10=511
sx11=281
sx12=192
sy1=450
sy2=633
sy3=849
sy4=817
sy5=849
sy6=633
sy7=450
sy8=267
sy9=50
sy10=83
sy11=50
sy12=267
level=10
-luminance
--l
-rm
2000,2000,1,1,0
-repeat 128
-polygon 12,$sx1,$sy1,$sx2,$sy2,$sx3,$sy3,$sx4,$sy4,$sx5,$sy5,$sx6,$sy6,$sx7,$sy7,$sx8,$sy8,$sx9,$sy9,$sx10,$sy10,$sx11,$sy11,$sx12,$sy12,1,$level
sx2={$sx2+(40/16)}
sx6={$sx6-(40/16)}
sx8={$sx8-(40/16)}
sx12={$sx12+(40/16)}
sy2={$sy2-(23/16)}
sy4={$sy4-(47/16)}
sy6={$sy6-(23/16)}
sy8={$sy8+(23/16)}
sy10={$sy10+(47/16)}
sy12={$sy12+(23/16)}
level={$level+12}
-done
-n 0,255
-resize 200,200,1,1,3
--shift[0] -69,-40,0,0
--shift[0] -69,40,0,0
--shift[0] 69,-40,0,0
--shift[0] 69,40,0,0
-add
-crop 5,5,142,84
-endl
-resize[1] 194,112,1,1,2
-equalize[1] 65555
-resize[1] $scale%,$scale%,1,1,3
-if {$2==1}
-negative[1]
-endif
-endif
-if {$3==2}
sx1=161
sx2=1000
sx3=1839
sy1=273
sy2=1727
sy3=273
level=10
-luminance
--l
-rm
2000,2000,1,1,0
-repeat 375
-polygon 3,$sx1,$sy1,$sx2,$sy2,$sx3,$sy3,1,$level
sx1={$sx1+2.21}
sx3={$sx3-2.21}
sy1={$sy1+1.28}
sy2={$sy2-2.56}
sy3={$sy3+1.28}
level={$level+1}
-done
--rotate[0] 180
--shift[1] {840+2}
-shift[1] -840
-add
-crop 160,{216+56},1842,1727
-n 0,255
-endl
-equalize[1] 256
-resize[1] 168,145,1,1,2
-resize[1] $scale%,$scale%,1,1,3
-if {$2==1}
-negative[1]
-endif
-endif
-if {$3==3}
-luminance
--l
-rm
-l
190,190,1,1,0
-circle 50,50,50,1,10
-circle 140,50,50,1,10
-polygon 5,10,80,50,50,140,50,180,80,95,190,1,10
-resize[-1] @{0,w+2},@{0,h+2},1,1,0,0,0.5,0.5
--resize[0] 95%,95%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 90%,90%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 85%,85%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 75%,75%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 65%,65%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 55%,55%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 50%,50%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 45%,45%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 40%,40%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 35%,35%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 30%,30%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 25%,25%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 20%,20%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 15%,15%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 10%,10%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 5%,5%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
-add
-endl
[0]
-append y
-resize 200%,100%,1,1,0,0,0.5,0.5
--shift[0] 160,100,0,0
--shift[0] -160,100,0,0
-add
-crop 30,190,350,100%
-n 0,255
-endl
-resize[-1] $scale,$scale,1,1,2
-if {$2==1}
-negative[1]
-endif
-endif
width=@{-1,w}
height=@{-1,h}
w_tiles={round(@{0,w}/$width)}
h_tiles={round(@{0,h}/$height)}
total_tiles=$h_tiles*$w_tiles
[-1]x{$total_tiles-1}
-append_tiles[1--1] $w_tiles,$h_tiles
-equalize[-1] 256
-rotate[-1] $5,1,2,50%,50%,1
-twirl[-1] $6,.5,.5,2
-blend alpha,0.5,1
-gt 128
-mul 255
-if {$4==1}
-resize 25%,25%,1,1,3
-endif
#@gimp Hearts : gimp_hearts, gimp_hearts_preview(0)
#@gimp : Density = float(10,0,100)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_hearts :
-ac "-hearts $1",$2
gimp_hearts_preview :
-gimp_split_preview "-gimp_hearts $*",$-1
#@gimp Lava : gimp_lava, gimp_lava_preview(0)
#@gimp : Perturbation = int(8,0,15)
#@gimp : Smoothness = float(5,0,100)
#@gimp : Scale = float(3,0,20)
#@gimp : Sharpness = float(0,0,1000)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/26/2012</i>.</small>")
gimp_lava :
-repeat @# -l[$>] -split_opacity -l[0] -norm
100%,100% -plasma[-1] 1,1,{16-$1} -smooth[-1] $2,0,1,$3,$3,0.8,90 -*
-gradient_norm -n 0,255
-equalize -map 3
-sharpen $4
-endl -a c -endl -done
gimp_lava_preview :
-gimp_split_preview "-gimp_lava $*",$-1
#@gimp Marble : gimp_marble, gimp_marble
#@gimp : Image weight = float(.5,0,30)
#@gimp : Pattern weight = float(1,0,30)
#@gimp : Pattern angle = float(0,0,360)
#@gimp : Amplitude = float(0,0,1000)
#@gimp : Sharpness = float(.4,0,5)
#@gimp : Anisotropy = float(.6,0,1)
#@gimp : Alpha = float(.6,0,20)
#@gimp : Sigma = float(1.1,0,20)
#@gimp : Cut low = float(0,0,100)
#@gimp : Cut high = float(100,0,100)
#@gimp : Sep = separator(), note = note("<small>Author: <i>Preben Soeberg</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_marble :
-repeat @# -l[$>] -split_opacity -l[0]
-marble $1/10,$2/10,$3,$4,$5,$6,$7,$8,$9%,$10%
-endl -a c -endl -done
#@gimp Maze : gimp_maze, gimp_maze
#@gimp : Cell size = int(24,1,256)
#@gimp : Thickness = int(1,1,10)
#@gimp : Masking = choice("None","Render on dark areas","Render on white areas")
#@gimp : Preserve image dimension = bool(1)
#@gimp : Maze type = choice("Dark walls","White walls")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>09/02/2011</i>.</small>")
gimp_maze :
-repeat @#
w={w} h={h}
-r[-1] {100/$1}%,{100/$1}%,1,100%,2
-if {$3==0} -f[-1] 1
-elif {$3==1} -negative[-1]
-endif
-maze_mask[-1] $1 -dilate[-1] $2 -*[-1] 255
-if {!$5} -negative[-1] -endif
-if $4 -r[-1] $w,$h,100%,100% -endif
-mv[-1] 0 -done
#@gimp Mineral mosaic : gimp_mineral_mosaic,gimp_mineral_mosaic(0)
#@gimp : Density = float(1,0,3)
#@gimp : Area = float(2,0,32)
#@gimp : Smoothness = float(1,0,10)
#@gimp : Shade strength = float(100,0,255)
#@gimp : Shade angle = float(0,0,360)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>02/01/2013</i>.</small>")
gimp_mineral_mosaic :
-repeat @# -l[$>] -to_rgb
--b $3 -segment_watershed[-1] $1 --norm[-1]
-area[-1] 0 --<=[-1] {$2^2} -inpaint[-2] [-1] -rm[-1] -label[-1]
--f[0] 'if(c==0,x,y)' --blend[-2,-1] shapeaverage,1,1
--[-2,-1] -rm[0,2] -channels[-1] 0,1
alpha={$5*pi/180} -sh[-1] 0,0 -*[-1] {cos($alpha)} -rm[-1] -sh[-1] 1,1 -*[-1] {sin($alpha)} -rm[-1] -compose_channels[-1] +
-normalize_local[-1] 1000 -n[-1] -$4,$4
-+ -c 0,255
-endl -done
#@gimp Mosaic : gimp_mosaic, gimp_mosaic_preview(0)
#@gimp : Density = float(1,0.1,10)
#@gimp : Keep edges = bool(true)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_mosaic :
-ac "-mosaic $1,$2",$3
gimp_mosaic_preview :
-gimp_split_preview "-gimp_mosaic $*",$-1
#@gimp Op art : gimp_shapes,gimp_shapes_preview(0)
#@gimp : Shape = choice{1,"Custom layers","Circles","Squares","Diamonds","Triangles","Horizontal stripes","Vertical stripes","Balls","Hearts","Stars","Arrows","Truchet",
#@gimp : "Circles (outline)","Squares (outline)","Diamonds (outline)","Triangles (outline)","Hearts (outline)","Stars (outline)","Arrows (outline)"}
#@gimp : Number of scales = int(16,2,24)
#@gimp : Resolution = float(10,1,50)
#@gimp : Zoom factor = _int(2,1,8)
#@gimp : Minimal size = float(5,0,150)
#@gimp : Maximal size = float(90,0,150)
#@gimp : Stencil type = choice(0,"Black & white","RGB","Color")
#@gimp : Allow angle = choice("0 deg.","90 deg.","180 deg.")
#@gimp : Negative = bool(1)
#@gimp : Antialiasing = bool(1)
#@gimp : Sep = separator()
#@gimp : Note = note{"<small><b>Note:</b>
#@gimp : If you set the parameter <i>Shape</i> to <i>Custom layers</i>, the different shapes used to map the pixel intensities will be defined as
#@gimp : the <i>Number of scales</i> top layers of your image. Don't forget to set also <i>Input layers</i> to <i>All</i> to be sure
#@gimp : these layers are passed to the filter.
#@gimp : </small>"}
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/16/2013</i>.</small>")
gimp_shapes :
-if $1
-remove_opacity -repeat @# -l[$>]
-if {!$7} -_gimp_shapes $* -* 255
-elif {$7==1} -split_opacity -to_rgb[0] -s[0] c -repeat 3 -_gimp_shapes[$>] $* -done -*[0-2] 255 -a[0-2] c -a c
-else --_gimp_shapes $* -r[0] $3%,$3% -r[0] [1],[1] -*
-endif
-endl -done
-else
-if {@#<=$2} -error[] "Command '-gimp_shapes': Some layers are missing in 'Custom layers' mode ("{$2+1}" expected at least, "@#" provided)." -endif
-to_colormode[0-{$2-1}] @{-max_s[0-{$2-1}]} -remove_opacity[$2--1]
-repeat {@#-$2} -l[0-{$2-1},{$2+$>}]
-norm[-1] w={w} h={h} -r[-1] $3%,$3%,1,1,2
s={$4*max(round($w/w),round($h/h))}
r0={$s*$5%} r1={$s*$6%}
-repeat $2 r={round($r0+$>*($r1-$r0)/($2-1))} -if $r --r[$>] $r,$r,1,100%,3 -else 1,1 -endif -done
-r[-$2--1] $s,$s,1,100%,0,0,0.5,0.5
-map_sprites[$2--1] $2,$8
-endl -done -rm[0-{$2-1}]
-endif
gimp_shapes_preview :
-if $1 -repeat @# -l[$>]
w={w} h={h}
-gimp_split_preview "-gimp_shapes ${1-3},1,${5--2}",$-1
-r $w,$h,1,100%,0,0,0.5,0.5
-endl -done
-else
-if {@#>$2} -repeat {@#-$2} -l[0-{$2-1},{$2+$>}]
w={w} h={h}
--gimp_shapes ${1-3},1,${5--2} -rm[-2]
-r[-1] $w,$h,1,100%,0,0,0.5,0.5
-endl -done -rm[0-{$2-1}]
-else -gimp_warning_preview "Missing input layers!"
-endif
-endif
_gimp_shapes :
-norm w={w} h={h} -r $3%,$3%,1,1,2
s={(1+$10)*$4*max(round($w/w),round($h/h))}
r0={$s*$5%} r1={$s*$6%}
-repeat $2 r={round($r0+$>*($r1-$r0)/($2-1))} -if $r -_gimp_shapes{$1-1}[] $r,$s -else 1,1 -endif -done
-r[-$2--1] $s,$s,1,1,0,0,0.5,0.5
-if $9 -rv[-$2--1] -*[-$2--1] -1 -+[-$2--1] 1 -endif
-map_sprites $2,$8
-if $10 -r 50%,50%,1,1,2 -endif
_gimp_shapes0 :
-_dt_circle[] $1
_gimp_shapes1 :
$1,$1,1,1,1
_gimp_shapes2 :
$1,$1,1,1 -= 1,50%,50% -distance 1,1 -< {$1/2}
_gimp_shapes3 :
$2,$2,1,1,'x+y<=2*$1-1'
_gimp_shapes4 :
$2,$1,1,1,1
_gimp_shapes5 :
$1,$2,1,1,1
_gimp_shapes6 :
-ball $1,200 -n 0,1
_gimp_shapes7 :
-heart 65 -r $1,$1,1,1,2 ->= 50%
_gimp_shapes8 :
-star $1,$1
_gimp_shapes9 :
-arrow3d 0,0,0,1,0,0,15%,40%,30% -col3d 1 -*3d $1 -c3d
$2,$2 -j3d[-1] [-2],50%,50%,0,1,2,0,0
-rm[-2] --mirror y -max
_gimp_shapes10 :
S={$2+1-($2%2)}
$S,$S,1,1,"X=x/(w-1);Y=y/(h-1);r=abs(0.5-sqrt(X^2+Y^2));a=atan2(y,x);r<0.1-0.17*(0.5-$1/$2)*sin(2*a)"
--mirror xy -max
_gimp_shapes11 :
-_gimp_shapes0 $* -expand_xy 1,0 --erode 3 --
_gimp_shapes12 :
-_gimp_shapes1 $* -expand_xy 1,0 --erode 3 --
_gimp_shapes13 :
-_gimp_shapes2 $* -expand_xy 1,0 --erode 3 --
_gimp_shapes14 :
-_gimp_shapes3 $* -expand_xy 1,0 --erode 3 --
_gimp_shapes15 :
-_gimp_shapes7 $* -expand_xy 1,0 --erode 3 --
_gimp_shapes16 :
-_gimp_shapes8 $* -expand_xy 1,0 --erode 3 --
_gimp_shapes17 :
-_gimp_shapes9 $* -expand_xy 1,0 --erode 3 --
#@gimp Pack sprites : gimp_pack_sprites, gimp_no_preview
#@gimp : Number of scales = int(5,1,16)
#@gimp : Minimal scale (%) = float(25,1,100)
#@gimp : Allow angle = choice(3,"0 deg.","180 deg.","90 deg.","Any")
#@gimp : Spacing = int(1,-16,16)
#@gimp : Precision = int(7,1,32)
#@gimp : Sep = separator()
#@gimp : Masking = choice("No masking","Mask as bottom layer")
#@gimp : Width = int(512,32,2048)
#@gimp : Height = int(512,32,2048)
#@gimp : Note = note("<small><b>Notes:</b>\n - Parameters <i>Width</i> and <i>Height</i> are considered only when <i>No masking</i> mode is selected.\n
#@gimp : - Set different sprites on different layers to pack multiple sprites at the same time.</small>")
#@gimp : Link = link("Click here for a video tutorial","http://www.youtube.com/watch?v=bpg7CGH7vCM")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>06/24/2013</i>.</small>")
gimp_pack_sprites :
-if $6
-if {@#<2} -error[] "Command '-gimp_pack_sprites': Masking requires at least two input layers ! (please check that 'Input Layers' is correctly set)." -endif
-repeat {@#-1} -l[$>] -to_rgba -split_opacity --!=[1] 0 -*[0] [-1] -a c -autocrop 0 -endl -done
-remove_empty[0--2] --channels[-1] 100% -channels[-1] -4,0 -mv[-1] 0
-pack_sprites[0--2] ${1-5}
-else
-repeat @# -l[$>] -to_rgba -split_opacity --!=[1] 0 -*[0] [-1] -a c -autocrop 0 -endl -done
-remove_empty -i[0] $7,$8,1,5 -pack_sprites ${1-5}
-endif
-channels[0] 0,@{0,s-2}
#@gimp Paper texture : gimp_paper, gimp_paper_preview(0)
#@gimp : Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_paper :
-ac "-texturize_paper",$1
gimp_paper_preview :
-gimp_split_preview "-gimp_paper $*",$-1
#@gimp Periodic dots : jeje_periodic_dots, jeje_periodic_dots_preview
#@gimp : Number = int(6,2,32)
#@gimp : Scale = float(4,1,12)
#@gimp : Angle = float(0,0,360)
#@gimp : Repeat = int(1,1,10)
#@gimp : Map = choice(None,default,HSV,lines,hot,cool,jet,flag,cube)
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>. Latest update: <i>2013/05/29</i>.</small>")
jeje_periodic_dots:
tW={max(w,h)/$4}
$tW,$tW
-periodic_dots[-1] $*
-repeat {$4*$4-1}
-i [-1]
-done
-append_tiles[1--1] $4,$4 -k[-1]
-if {$5>0} -n 0,255 -map {$5-1} -endif
jeje_periodic_dots_preview:
-jeje_periodic_dots $*
#@gimp Plaid : gimp_plaid_texture,gimp_plaid_texture(1)
#@gimp : Line = float(50,0,100)
#@gimp : Number of angles = int(2,1,8)
#@gimp : Starting angle = float(0,0,360)
#@gimp : Angle range = float(90,0,360)
#@gimp : Smoothness = float(1,0,5)
#@gimp : Sharpen = float(300,0,1000)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>05/16/2011</i>.</small>")
gimp_plaid_texture :
-repeat @# -l[$>]
w={w} h={h} s={s}
-rows $1%
-b $5% -sharpen $6
-r $w,$h,1,$s,2
--rotate[0] $3,1,2,50%,50%
-repeat {$2-1} --rotate[0] {$3+$4*($>+1)/($2-1)},1,2,50%,50% -+[-2,-1] -done -rm[0]
-/ $2
-endl -done
#@gimp Plasma : gimp_plasma, gimp_plasma(0)
#@gimp : Alpha = float(0.5,0,5)
#@gimp : Beta = float(0,0,100)
#@gimp : Scale = int(8,2,10)
#@gimp : Randomize = bool(0)
#@gimp : Transparency = bool(0)
#@gimp : Color balance = color(128,128,128)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>03/20/2011</i>.</small>")
gimp_plasma : -skip ${4=0},${5=0}
-if $5 -to_rgba -else -to_rgb -endif
-if $4 -rand 0,255 -endif
-plasma $1,$2,$3 -n 0,255
-balance_gamma ${6-8}
#@gimp Polka dots : gimp_polka_dots, gimp_polka_dots(1)
#@gimp : Size = float(80,0,100)
#@gimp : Density = float(20,0.1,100)
#@gimp : First offset = float(50,0,100)
#@gimp : Second offset = float(50,0,100)
#@gimp : Angle = float(0,0,180)
#@gimp : Aliasing = float(0.5,0.1,1)
#@gimp : Shading = float(0.1,0.1,1)
#@gimp : Opacity = float(1,0,1)
#@gimp : Color = color(255,0,0,255)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_polka_dots :
-to_rgba -polka_dots {$1*$2/100},${2--1}
#@gimp Random color ellipses : gimp_color_ellipses, gimp_color_ellipses(1)
#@gimp : Density = int(400,0,3000)
#@gimp : Radius = float(8,0,30)
#@gimp : Opacity = float(0.1,0.01,0.5)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_color_ellipses :
-color_ellipses $1,$2,$3
#@gimp Random pattern courtepointe : samj_en_Courtepointe, gimp_no_preview
#@gimp : Note = note("Random Pattern")
#@gimp : Sep = separator()
#@gimp : Parameter 1 = int(20,1,100)
#@gimp : Parameter 2 = bool(0)
#@gimp : Repeat = int(1,1,5)
#@gimp : Cross = bool(0)
#@gimp : Texture = bool(1)
#@gimp : Color curves = choice("RGB","CMY","CMYK","HSI","HSL","HSV","Lab","Lch","YCbCr")
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/07</i>.</small>")
samj_en_Courtepointe :
-samj_Courtepointe $1,$2,$3,$4,$5,$6
#@gimp Rays : jeje_rays, jeje_rays_preview
#@gimp : X center = float(50,0,100)
#@gimp : Y center = float(50,0,100)
#@gimp : Frequency = float(10,0,100)
#@gimp : Angle = float(0,0,360)
#@gimp : Proportion = float(0.5,0,1)
#@gimp : Color 1 = color(255,0,0)
#@gimp : Color 2 = color(255,255,0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>. Latest update: <i>2013/10/29</i>.</small>")
jeje_rays :
-s c
-l[0] -rays {w*$1/100},{h*$2/100},$3,$4 -n 0,1 -gt $5 -n $6,$9 -endl
-l[1] -rays {w*$1/100},{h*$2/100},$3,$4 -n 0,1 -gt $5 -n $7,$10 -endl
-l[2] -rays {w*$1/100},{h*$2/100},$3,$4 -n 0,1 -gt $5 -n $8,$11 -endl
-a c
jeje_rays_preview:
-gimp_split_preview "-jeje_rays $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11",$-1
#@gimp Resynthetize texture : syntexturize, gimp_syntexturize_preview(1)
#@gimp : Width = int(1024,32,8192)
#@gimp : Height = int(1024,32,8192)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator()
#@gimp : Note = note{"<small><b>Note:</b> This filter tries to re-synthetize a <b>micro</b>-texture (given as the input image) onto an output (seamless) image with an arbitrary size.
#@gimp : It uses a phase randomization technique, as described in:</small>"}
#@gimp : Link = link("Micro-Texture Synthesis by Phase Randomization","http://www.ipol.im/pub/art/2011/ggm_rpn/")
#@gimp : Note = note("<small>This filter is based on the work of <i>Bruno Galerne</i>, <i>Yann Gousseau</i> and <i>Jean-Michel Morel</i>.</small>")
#@gimp : Sep = separator(), link = link("Click here for a detailed description of this filter.","http://gimpchat.com/viewtopic.php?f=28&t=10141")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>David Tschumperl&#233;</i> and <i>J&#233;rome Boulanger</i>.      Latest update: <i>04/09/2014</i>.</small>")
gimp_syntexturize_preview :
-gimp_split_preview "-syntexturize 100%",$-1
#@gimp Rorschach : gimp_rorschach, gimp_rorschach
#@gimp : Scale = float(3,0,10)
#@gimp : Mirror = choice(1,"None","x-axis","y-axis","xy-axes")
#@gimp : Stencil type = choice(2,"Black & White","RGB","Color")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>03/12/2011</i>.</small>")
gimp_rorschach :
-repeat @# -remove_opacity -l[$>]
-if {$3==0} -norm -rorschach $1%,$2 -* 255
-elif {$3==1} -to_rgb -rorschach $1%,$2 -* 255
-else --norm -rorschach[-1] $1%,$2 -blend shapeaverage0
-endif
-endl -done
#@gimp Seamless deco : gimp_mad_rorscharchp,gimp_mad_rorscharchp
#@gimp : Scale = float(3,0,15)
#@gimp : Mixer = choice ("Average","Grain Extract","Vivid Edges","Difference", "Exclusion"," Negation")
#@gimp : Sep = separator()
#@gimp : Line = float(50,0,100)
#@gimp : Smoothness = float(1,0,5)
#@gimp : Sharpen = float(300,0,1000)
#@gimp : Sep = separator()
#@gimp : Remix = choice ( "Vivid Edges", "Average", "Difference","Negation","Dark Edges")
#@gimp : Photocomix preset = choice( "Neat Merge","Lighty Smooth","Dream","Moody" "Soft","Naif","Dark Boost","Whitening"," None- Skip" )
#@gimp : Activate mirror = choice ("No-Skip", XY Mirror"," 2XY Mirror")
#@gimp : Sep = separator()
#@gimp : Note = note("WARNING,"Expanding Mirrors" multiply image size of x4 or if "2XY Mirrors" x9")
#@gimp : Sep = separator()
#@gimp : Expanding mirrors = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComix</i>.      Latest update : <i>11/13/2011</i>.</small>")
gimp_mad_rorscharchp :
-gimp_rorschach $1,1,1
--mirror y
-if {$2==0} -gimp_compose_average 1,0
-elif {$2==1} -gimp_compose_grainextract 1,0
-elif {$2==1} -gimp_compose_vividedges 1,1,0.5,1 -endif
--gimp_plaid_texture $3,2,0,90,$4,$5
-if {$6==0} -gimp_compose_vividedges 1,1,0.5,1
-elif {$6==1} -gimp_compose_average 1,0
-elif {$6==2} -gimp_compose_difference 1,0
-elif {$6==3} -gimp_compose_negation 1,0
-elif {$6==4} -gimp_compose_negation 1,0
-elif {$6==5} -gimp_compose_darkedges 1,1,0.8,1 -endif
-if {$7==0} -gimp_graphic_novelfxl 0,2,6,5,20,0,0.62,14,0,1,0.5,0.78,1.92,0,0,12,1,1,1,0.5,0.8,1.28,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,0,1,1,1,0.5,0.45,1
-elif {$7==1}-gimp_graphic_novelfxl 0,7.2,14.65,5,20,0,1.06,36.14,0,1,0.5,0.85,1.93,0,0,8,1,1,1,0.5,0.95,2.89,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,0,1,1,1,0.5,0.45,1
-elif {$7==2} -gimp_graphic_novelfxl 0,7.22892,14.6506,5,20,0,1.6,36.1,0,1,0.5,0.6,3.6,0,0,11,1,1,1,0.5,0.8,2.16,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,7,1,1,1,0.5,0.45,1
-elif {$7==3}  -gimp_graphic_novelfxl 0,7.22892,14.6506,5,20,0,1.59036,36.1446,0,1,0.5,0.590361,3.61446,0,1,17,1,1,1,0.5,0.795181,2.16867,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,7,1,1,1,0.5,0.45,1
-elif {$7==4} -gimp_graphic_novelfxl 0,7.22892,14.6506,5,20,0,1.59036,36.1446,0,1,0.5,0.855422,1.92771,0,0,8,1,1,1,0.5,0.373494,2.89157,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,0,1,1,1,0.5,0.45,1
-elif {$7==5} -gimp_graphic_novelfxl 1,7.22892,14.6506,5,20,0,1.06024,14,0,1,0.5,0.855422,1.3253,0,0,12,1,1,1,0.5,0.8,1.28,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,0,1,1,1,0.5,0.45,1
-elif {$7==6} -gimp_graphic_novelfxl 1,7.22892,14.6506,5,20,0,1.06024,36.1446,0,1,0.5,0.855422,1.92771,0,0,7,1,1,1,0.5,0.951807,1.92771,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,0,1,1,1,0.5,0.45,1
-elif {$7==7} -gimp_graphic_novelfxl 1,7.22892,14.6506,5,20,0,1.59036,36.1446,0,1,0.5,0.590361,3.61446,0,1,18,1,1,1,0.5,0.795181,2.16867,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,0,1,1,1,0.5,0.45,1 -endif
-if {$8==1} -gimp_array_mirror 1,0,0,2,0,$9
-elif {$8==2} -gimp_array_mirror 1,0,0,3,0,$9 -endif
#@gimp Seamless turbulence : gimp_seamless_turbulence, gimp_seamless_turbulence(0)
#@gimp : Amplitude = float(15,0,30)
#@gimp : Smoothness = float(20,0,40)
#@gimp : Orientation = float(0,0,180)
#@gimp : Deviation = float(1,0,1)
#@gimp : Contrast = float(3,0,4)
#@gimp : Color rendering = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>04/02/2013</i>.</small>")
gimp_seamless_turbulence :
-repeat @# -l[$>]
wh={w},{h} -rm
$wh,1,{if($6,3,1)} -rand[-1] 0,255
$wh -rand[-1] {$3*pi/180-$4*10*pi},{$3*pi/180+$4*10*pi} --sin[-1] -cos[-2] -a[-2,-1] c
-r[-2,-1] 130%,130%,1,100%,0,2,0.5,0.5 -b[-1] $2 -orientation[-1]
-vector2tensor[-1]
-smooth[-2] [-1],$1,0.5,20 -rm[-1]
-r[-1] $wh,1,100%,0,0,0.5,0.5
-if {$5!=1} ia={ia} -- $ia -* $5 -+ $ia -endif
-endl -done
-c 0,255 -n 0,255
#@gimp Shock waves : gimp_shockwaves, gimp_shockwaves_preview
#@gimp : Amplitude = float(10,0,100)
#@gimp : Low frequency = float(10,0,100)
#@gimp : Frequency range = float(20,0,100)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/01/2014</i>.</small>")
_gimp_shockwaves :
-dct
100%,100%,1,1,1 -circle[-1] 0,0,{$2+$3}%,1,{$1+1} -circle[-1] 0,0,$2%,1,1
-* -idct -c 0,255
gimp_shockwaves :
-ac "-_gimp_shockwaves ${1-3}",$4
gimp_shockwaves_preview :
-gimp_split_preview "-gimp_shockwaves $*",$-1
#@gimp Simple noise canvas : gimp_SimpleNoiseCanvas, gimp_SimpleNoiseCanvasPreview(0)
#@gimp : Note = note("Simpe noise based xy canvas effect. Preserve canvas and bumpmap image with canvas after filtering for best results. Merge option DoNothing outputs only original image if Preserve canvas option is not selected.")
#@gimp : Sep = separator()
#@gimp : Scale factor = float(0,0,1)
#@gimp : Sep = separator()
#@gimp : Note = note("Noise parameters")
#@gimp : Amplitude = float(3,0,20)
#@gimp : Noise type = choice(2,"Gaussian","Uniform","Salt and pepper","Poisson")
#@gimp : Sep = separator()
#@gimp : Note = note("Thread length")
#@gimp : Horisontal length = float(5,2,15)
#@gimp : Vertical length = float(5,2,15)
#@gimp : Over all blurr = float(0,0,15)
#@gimp : Canvas brightness = float(255,230,255)
#@gimp : Canvas darkness = float(0,0,255)
#@gimp : Sep = separator()
#@gimp : Note = note("How to combine XY threads")
#@gimp : Merging option = choice(2,"Average","Multiply","Darken","Edges")
#@gimp : Invert canvas colors = bool(0)
#@gimp : Invert image colors = bool(0)
#@gimp : Note = note("How to combine image + canvas")
#@gimp : Reverse order = bool(0)
#@gimp : Merging option = choice (1,"Avg","Multiply","Scr","Darken","Lighten","Dif","Negation","Exclusion","Overlay","Hardlight","Softlight","Dodge","Colorburn","Reflect","Freeze","Stamp","Interpolate","Grainext","Grainmerge","Xor","Edges","DoNothing")
#@gimp : Preserve canvas for post bump mapping = bool(0)
#@gimp : Canvas color = color(255,255,255,255)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Arto Huotari</i>.      Latest update : <i>2013/09/28</i>.</small>")
#@gimp : Note = link("Filter Explained here","http://www.flickr.com/photos/naggobot/6152040642/")
gimp_SimpleNoiseCanvas :
CanvasScale={$1}
NoiseAmplitude=$2
NoiseType=$3
ThreadHorizLen=$4
ThreadVertLen=$5
OverAllBlurr=$6
HighCut=$7
LowCut=$8
CanvasMergeChoice=$9
InvertCanvasColors=$10
InvertImageColors=$11
ReverseChoice=$12
MergeChoice=$13
PreserveCanvas=$14
-to_rgb[0]
CanvasScale={1.2-$CanvasScale}
(255^255^255)
-r[-1] [0]
-r[1] {100*$CanvasScale}%,{100*$CanvasScale}%
-if {$NoiseType!=2} NoiseAmplitude={($NoiseAmplitude*10)} -endif
-gimp_noise[1] $NoiseAmplitude,$NoiseType,0,1,0
-gimp_ditheredbw[1] 1,1,0,0,0,0
--gimp_gaussian_blur[1] 0,$ThreadHorizLen,0,1,0,0,0
--gimp_gaussian_blur[1] 0,0,$ThreadVertLen,1,0,0,0
-normalize[2] 0,255
-normalize[3] 0,255
-if {$CanvasMergeChoice==0} -blend[2,3] average
-elif {$CanvasMergeChoice==1} -blend[2,3] multiply
-elif {$CanvasMergeChoice==2} -blend[2,3] darken
-elif {$CanvasMergeChoice==3} -blend_edges[2,3] 0.9
-endif
-gimp_gaussian_blur[2] $OverAllBlurr,0,0,1,0,0,0
-remove[1]
-r[1] [0]
($15^$16^$17)
-r[2] [0]
-blend[1,2] multiply
-gimp_apply_curve {$LowCut},-1,128,-1,128,-1,128,-1,128,-1,128,{$HighCut},1,3,0,0,0
-if {$ReverseChoice==1} -reverse[0,1] -endif
-if {$InvertCanvasColors==1} -negative[1] -endif
-if {$InvertImageColors==1} -negative[0] -endif
-if {$MergeChoice==0} --blend[1,0] average
-elif {$MergeChoice==1} --blend[1,0] multiply
-elif {$MergeChoice==2} --blend[1,0] screen
-elif {$MergeChoice==3} --blend[1,0] darken
-elif {$MergeChoice==4} --blend[1,0] lighten
-elif {$MergeChoice==5} --blend[1,0] difference
-elif {$MergeChoice==6} --blend[1,0] negation
-elif {$MergeChoice==7} --blend[1,0] exclusion
-elif {$MergeChoice==8} --blend[1,0] overlay
-elif {$MergeChoice==9} --blend[1,0] hardlight
-elif {$MergeChoice==10} --blend[1,0] softlight
-elif {$MergeChoice==11} --blend[1,0] dodge
-elif {$MergeChoice==12} --blend[1,0] colorburn
-elif {$MergeChoice==13} --blend[1,0] reflect
-elif {$MergeChoice==14} --blend[1,0] freeze
-elif {$MergeChoice==15} --blend[1,0] stamp
-elif {$MergeChoice==16} --blend[1,0] interpolation
-elif {$MergeChoice==17} --blend[1,0] grainextract
-elif {$MergeChoice==18} --blend[1,0] grainmerge
-elif {$MergeChoice==19} --blend[1,0] xor
-elif {$MergeChoice==20} --blend_edges[1,0] 0.8
-endif
-if {$ReverseChoice==1} -reverse[0,1] -endif
-if {$PreserveCanvas==0} -remove[1]  -endif
-if {$PreserveCanvas==1" && "$MergeChoice!=21} -reverse[1,2]  -endif
-if {$MergeChoice!=21} -remove[0] -endif
-if {$MergeChoice!=21" && "$PreserveCanvas==1} -reverse[0,1] -endif
gimp_SimpleNoiseCanvasPreview :
-gimp_split_preview "-gimp_SimpleNoiseCanvas ${1--2}",$-1
#@gimp Sponge : gimp_sponge, gimp_sponge_preview(0)
#@gimp : Size = int(13,3,21)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_sponge :
-ac "-sponge $1",$2
gimp_sponge_preview :
-gimp_split_preview "-gimp_sponge $*",$-1
#@gimp Stained glass : gimp_stained_glass, gimp_stained_glass_preview(0)
#@gimp : Edges = float(20,0,100)
#@gimp : Shading = float(0.1,0,0.5)
#@gimp : Thin separators = bool(1)
#@gimp : Sep = separator()
#@gimp : Equalize = bool(1)
#@gimp : Colors = float(1,0,3)
#@gimp : Gamma = float(0,-1.2,1.2)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>03/18/2011</i>.</small>")
gimp_stained_glass :
-repeat @# -l[$>] -split_opacity -l[0] -to_rgb
-stained_glass $1,$2,$3
-n 0,255
-if $4 -equalize[-1] -endif
-rgb2lab[-1] -sh[-1] 1,2 -*[-1] $5 -rm[-1] -lab2rgb[-1]
-apply_gamma[-1] {10^$6} --[-1] 128 -*[-1] $7 -+[-1] {128+$8}
-c[-1] 0,255
-endl -a c -endl -done
gimp_stained_glass_preview :
-gimp_split_preview "-gimp_stained_glass $*",$-1
#@gimp Stars : gimp_stars, gimp_stars(0)
#@gimp : Density = float(10,0,200)
#@gimp : Depth = float(0,0,5)
#@gimp : Size = int(32,8,128)
#@gimp : Branches = int(5,3,16)
#@gimp : Thickness = float(0.38,0.1,1)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Color = color(255,255,100,200)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/01/2012</i>.</small>")
gimp_stars :
-repeat @# -l[$>] -split_opacity -rv
-stars $1%,$2,$3,$4,$5,$6%,${7-9},{$10/255}
-rv -a c -endl -done
#@gimp Stencil : gimp_stencil, gimp_stencil_preview(0)
#@gimp : Radius = float(3,0,10)
#@gimp : Smoothness = float(0,0,30)
#@gimp : Iterations = int(8,1,100)
#@gimp : Aliasing = float(0,0,5)
#@gimp : Stencil type = choice(2,"Black & White","RGB","Color")
#@gimp : Transparency = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_stencil :
-v -
-if {$5==0} -norm -stencil $1,$2,$3
-elif {$5==1} -stencil $1,$2,$3
-else -repeat @#
--norm[-1] -stencil[-1] $1,$2,$3 ->=[-1] 50% -blend[-2,-1] shapeaverage0
-mv[-1] 0 -done -endif
-if $6 -to_rgba -replace_color 0,0,0,0,0,255,0,0,0,0 -endif
-if $4 -smooth {30*$4},0,1,1 -endif
gimp_stencil_preview :
-gimp_split_preview "-gimp_stencil $*",$-1
#@gimp Strip : jeje_strip, jeje_strip_preview
#@gimp : Angle = float(45,0,90)
#@gimp : Frequency = float(50,0,100)
#@gimp : Phase =  float(0,0,180)
#@gimp : Amplitude = float(1,0,2)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>. Latest update: <i>2013/06/07</i>.</small>")
jeje_strip :
theta={pi*$1/180}
-f '0.5*i*(1+$4*sin(2*pi*$2*(cos($theta)*x/w+sin($theta)*y/h)+2*pi*$3/180))'
-c 0,255
jeje_strip_preview :
-gimp_split_preview "-jeje_strip $*",$-1
#@gimp Tetris : gimp_tetris, gimp_tetris(0)
#@gimp : Scale = int(10,1,20)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_tetris :
-tetris $1
#@gimp Truchet : gimp_truchet, gimp_truchet(0)
#@gimp : Scale = int(32,1,256)
#@gimp : Radius = int(5,1,64)
#@gimp : Smoothness = float(1,0,10)
#@gimp : Type = choice(1,"Straight","Curved")
#@gimp : Color = choice("White on black","Black on white","White on transparent","Black on transparent","Transparent on white","Transparent on black","Random")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/26/2011</i>.</small>")
gimp_truchet :
-repeat @# -l[$>]
100%,100% -truchet $1,$2,$4 -rm[-2]
-if {$5==1} -* -1
-elif {$5==2} -i[0] 100%,100%,1,1,1
-elif {$5==3} -i[0] 100%,100%
-elif {$5==4} -* -1 -i[0] 100%,100%
-elif {$5==5} -* -1 -i[0] 100%,100%,1,1,-1
-elif {$5==6} -label 0,1 {iM+1},1,1,3 -rand[-1] 0,255 -map[-2] [-1] -rm[-1]
-endif
-a c -b $3 -n 0,255
-endl -done
#@gimp Turbulence : gimp_turbulence, gimp_turbulence
#@gimp : Radius = float(128,1,1024)
#@gimp : Octaves = int(6,1,12)
#@gimp : Damping per octave = float(4,1,10)
#@gimp : Difference mixing = float(0,-10,10)
#@gimp : Mode = choice("Turbulence","Turbulence 2","Fractal Noise","Fractured Clouds","Stardust","Pea Soup")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Preben Soeberg</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_turbulence :
-repeat @# -l[$>] -split_opacity -l[0]
-turbulence ${^0}
-endl -a c -endl -done
#@gimp Turing : jeje_turing_pattern,gimp_no_preview
#@gimp : Scale = float(1,0,1)
#@gimp : Iterations = int(2000,1,10000)
#@gimp : Time step = float(.1,.01,1)
#@gimp : Alpha = float(.899,0,2)
#@gimp : Beta = float(-.91,-2,2)
#@gimp : Q = float(2,0,3)
#@gimp : R = float(.1,0,3)
#@gimp : Diffusivity = float(.25,.01,.6)
#@gimp : Sep = separator(), note = note(<small>Generate turing pattern using a system of coupled reaction/diffusion equations. The patterns can change from line to spots like structures depending on the parameters. You may use the 'Stencil' filter to achieve similar effects. http://en.wikipedia.org/wiki/The_Chemical_Basis_of_Morphogenesis</small>), note=note(<small>Since the computation is long there is no preview. </small>)
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>. Latest update: <i>2015/01/16</i>.</small>")
jeje_turing_pattern:
--l
-r {$1*w},{$1*h},1,2
-turing_pattern $2,$3,$4,$5,$6,$7,$8
-endl
-r[1] 100%,100%,100%,3,0 -r[1] [0],5 -rm[0] -blur .75 -n 0,255
#@gimp Weave : weave, weave(1)
#@gimp : Density = int(6,1,32)
#@gimp : Thickness = float(65,0,100)
#@gimp : Shadow = float(0,0,100)
#@gimp : Shading = float(0.5,0,3)
#@gimp : Fibers amplitude = float(0,0,255)
#@gimp : Fibers smoothness = float(0,0,10)
#@gimp : Angle = choice("0 deg.","22.5 deg.","45 deg.","67.5 deg.")
#@gimp : X-curvature = float(0,-1,1)
#@gimp : Y-curvature = float(0,-1,1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>01/18/2013</i>.</small>")
#@gimp Whirls : gimp_whirls, gimp_whirls_preview(0)
#@gimp : Density = int(7,3,20)
#@gimp : Smoothness = float(2,0,10)
#@gimp : Darkness = float(0.2,0,1)
#@gimp : Lightness = float(1.8,1,3)
#@gimp : Sep = separator(), Channel(s) = choice(7,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_whirls :
-ac "-whirls $1,$2,$3,$4",$5
gimp_whirls_preview :
-gimp_split_preview "-gimp_whirls $*",$-1
#@gimp _
#@gimp <b>Rendering</b>
#@gimp 3d blocks : gimp_blocks3d, gimp_blocks3d(1)
#@gimp : Resolution = int(32,1,128)
#@gimp : Smoothness = float(0,0,40)
#@gimp : Elevation = float(2,-10,10)
#@gimp : Size = float(1.5,0,3)
#@gimp : Angle = float(30,0,360)
#@gimp : Tilt = float(60,0,90)
#@gimp : Fov = float(45,1,90)
#@gimp : X-centering = float(50,0,100)
#@gimp : Y-centering = float(50,0,100)
#@gimp : Sep = separator()
#@gimp : X-light = float(0,-100,100)
#@gimp : Y-light = float(-50,-100,100)
#@gimp : Z-light = float(-100,-100,0)
#@gimp : Specular lightness = float(0.5,0,1)
#@gimp : Specular shininess = float(0.7,0,3)
#@gimp : Use light = bool(1)
#@gimp : Antialiasing = bool(1)
#@gimp : Outline color = color(0,0,0,128)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>02/10/2014</i>.</small>")
gimp_blocks3d :
-repeat @# -l[$>]
nm=@{"-gimp_layer_name"}
W={w} H={h} M={max(w,h)}
-if {w>h} -r2dx $1 -else -r2dy $1 -endif
w={w} h={h} m={max(w,h)}
-if {$3>0} -mirror y -endif
-imageblocks3d $3,$2%
--3d[-1] {$w/2},{$h/2} f={$4*$M/($m*(2-$16))} -*3d $f,$f,{$f*abs($3*$1/100)}
-if {$3>0} -r3d 1,0,0,180 -endif
-r3d 0,0,1,$5 -r3d 1,0,0,$6
-if $16 {2*$M},{2*$M},1,4,-1 -else $M,$M,1,4,-1 -endif
f3d={0.5*w/tan($7*pi/360)} -f3d $f3d
-l3d {$10*$f3d},{$11*$f3d},{$12*$f3d} -sl3d $13 -ss3d $14
-j3d[-1] [0],$8%,$9%,0,1,{if($15,3,2)},0,1
-sh[-1] 100%,100% -+[-1] 1 -*[-1] 255 -rm[-1]
-if $20
[-1],[-1],1,3,-1
-j3d[-1] [0],$8%,$9%,0,1,3,0,1 -rm[0]
-g[-1] xy,1 -+[-2,-1] -norm[-1] -!=[-1] 0
--r[-1] 100%,100%,1,3
-sh[-1] 0,0 -*[-1] $17 -rm[-1]
-sh[-1] 1,1 -*[-1] $18 -rm[-1]
-sh[-1] 2,2 -*[-1] $19 -rm[-1]
-j[0] [-1],0,0,0,0,{$20/255},[-2] -rm[-2,-1]
-else -rm[0]
-endif
-replace_color 0,0,-1,-1,-1,0,0,0,0,0
-if $16 -r 50%,50%,1,4,2 -endif
-c 0,255 -nm name($nm)
-endl -done
#@gimp 3d colored object : gimp_coloredobject3d, gimp_coloredobject3d_preview(1)
#@gimp : Type = choice{1,"Plane","Box","Pyramid","Ellipsoid","Torus","Gyroid","Weird","Cup"}
#@gimp : Color = color(128,128,128,255)
#@gimp : Sep = separator()
#@gimp : Size-1 = float(0.5,0,3)
#@gimp : Size-2 = float(0.5,0,3)
#@gimp : Size-3 = float(0.5,0,3)
#@gimp : X-angle = float(57,0,360)
#@gimp : Y-angle = float(41,0,360)
#@gimp : Z-angle = float(21,0,360)
#@gimp : Fov = float(45,1,90)
#@gimp : X-light = float(0,-100,100)
#@gimp : Y-light = float(0,-100,100)
#@gimp : Z-light = float(-100,-100,0)
#@gimp : Specular lightness = float(0.5,0,1)
#@gimp : Specular shininess = float(0.7,0,3)
#@gimp : Rendering = choice(4,"Dots","Wireframe","Flat","Flat shaded","Gouraud","Phong")
#@gimp : Antialiasing = bool(1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>05/16/2011</i>.</small>")
_gimp_coloredobject3d :
-to_rgb -_gimp_coloredobject3d$1$2 ${6-8} -col3d[-1] ${3-5}
-db3d 0
gimp_coloredobject3d :
-_gimp_coloredobject3d "_",${1-4,6-8}
-repeat {@#-1}
--gimp_render3d[-1] @{$>,w},@{$>,h},$6,${9--1}
-sh[-1] 3,3 -*[-1] {$5/255} -rm[-1]
-blend[$>,-1] alpha
-done
-rm[-1]
gimp_coloredobject3d_preview :
-_gimp_coloredobject3d "_preview_",${1-4,6-8}
-repeat {@#-1}
--gimp_render3d[-1] @{$>,w},@{$>,h},$6,${9--1}
-sh[-1] 3,3 -*[-1] {$5/255} -rm[-1]
-blend[$>,-1] alpha
-done -rm[-1]
_gimp_coloredobject3d_0 : -plane3d 1 -*3d[-1] $1,$2,1
_gimp_coloredobject3d_1 : -box3d 1 -*3d[-1] $1,$2,$3
_gimp_coloredobject3d_2 : -pyramid3d 1,1 -*3d[-1] $1,$2,$3
_gimp_coloredobject3d_3 : -sphere3d 1 -*3d[-1] 1,{2*$2},{2*$3}
_gimp_coloredobject3d_4 : -torus3d $1,{$2/2},100,50 -*3d[-1] $3,0.5,0.5
_gimp_coloredobject3d_5 : -gyroid3d 24 -*3d[-1] $1,$2,$3
_gimp_coloredobject3d_6 : -weird3d 32 -*3d[-1] $1,$2,$3
_gimp_coloredobject3d_7 : -cup3d 128 -*3d[-1] $1,$2,$3
_gimp_coloredobject3d_preview_0 : -plane3d 1 -*3d[-1] $1,$2,1
_gimp_coloredobject3d_preview_1 : -box3d 1 -*3d[-1] $1,$2,$3
_gimp_coloredobject3d_preview_2 : -pyramid3d 1,1 -*3d[-1] $1,$2,$3
_gimp_coloredobject3d_preview_3 : -sphere3d 1 -*3d[-1] 1,{2*$2},{2*$3}
_gimp_coloredobject3d_preview_4 : -torus3d $1,{$2/2},100,50 -*3d[-1] $3,0.5,0.5
_gimp_coloredobject3d_preview_5 : -gyroid3d 8 -*3d[-1] $1,$2,$3
_gimp_coloredobject3d_preview_6 : -weird3d 12 -*3d[-1] $1,$2,$3
_gimp_coloredobject3d_preview_7 : -cup3d 64 -*3d[-1] $1,$2,$3
#@gimp 3d elevation : gimp_elevation3d, gimp_elevation3d_preview(1)
#@gimp : Factor = float(100,-1000,1000)
#@gimp : Smoothness = float(1,0,10)
#@gimp : Sep = separator()
#@gimp : Width = _int(1024,8,4096)
#@gimp : Height = _int(1024,8,4096)
#@gimp : Size = float(0.8,0,3)
#@gimp : X-angle = float(25,0,360)
#@gimp : Y-angle = float(0,0,360)
#@gimp : Z-angle = float(21,0,360)
#@gimp : Fov = float(45,1,90)
#@gimp : X-light = float(0,-100,100)
#@gimp : Y-light = float(0,-100,100)
#@gimp : Z-light = float(-100,-100,0)
#@gimp : Specular lightness = float(0.5,0,1)
#@gimp : Specular shininess = float(0.7,0,3)
#@gimp : Rendering = choice(2,"Dots","Wireframe","Flat","Flat shaded","Gouraud","Phong")
#@gimp : Antialiasing = bool(1)
#@gimp : Sep = separator(), note = note{"<small><b>Note:</b> Add a top layer to define object texture.</small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
_gimp_elevation3d :
-repeat {@#/2} -l[$>,{min($>+1,@#-1)}]
-if {@#==1} --norm -else -r[1] [0],3 -endif
-n[1] 0,$1 -b[1] $2
-elevation3d[0] [1] -rm[1]
-endl -done
-db3d
gimp_elevation3d :
-_gimp_elevation3d ${1-2} -gimp_render3d ${3--1}
gimp_elevation3d_preview :
-gimp_elevation3d ${1-2},{w},{h},${5--1}
#@gimp 3d extrusion : gimp_extrude3d, gimp_extrude3d_preview(1)
#@gimp : Depth = float(10,1,1024)
#@gimp : Resolution = int(512,1,1024)
#@gimp : Smoothness = float(0.6,0,3)
#@gimp : Sep = separator()
#@gimp : Width = _int(1024,1,4096)
#@gimp : Height = _int(1024,1,4096)
#@gimp : Size = float(0.5,0,3)
#@gimp : X-angle = float(57,0,360)
#@gimp : Y-angle = float(41,0,360)
#@gimp : Z-angle = float(21,0,360)
#@gimp : Fov = float(45,1,90)
#@gimp : X-light = float(0,-100,100)
#@gimp : Y-light = float(0,-100,100)
#@gimp : Z-light = float(-100,-100,0)
#@gimp : Specular lightness = float(0.5,0,1)
#@gimp : Specular shininess = float(0.7,0,3)
#@gimp : Rendering = choice(4,"Dots","Wireframe","Flat","Flat shaded","Gouraud","Phong")
#@gimp : Antialiasing = bool(1)
#@gimp : Sep = separator(), note = note{"<small><b>Note:</b> Add a top layer to define object texture.</small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
_gimp_extrude3d :
-repeat {@#/2} -l[$>,{min($>+1,@#-1)}]
-extrude3d[-1] $1,$2,$3%
-if {@#==2} -t3d[-1] [-2] -rm[-2] -endif
-endl -done
-db3d 0
gimp_extrude3d :
-_gimp_extrude3d ${1-3} -gimp_render3d ${4--1}
gimp_extrude3d_preview :
-gimp_extrude3d ${1-3},{w},{h},${6--1}
#@gimp 3d image object : gimp_imageobject3d, gimp_imageobject3d_preview(1)
#@gimp : Type = choice{1,"Plane","Cube","Pyramid","Sphere","Torus","Gyroid","Weird","Cup","Rubik"}
#@gimp : Sep = separator()
#@gimp : Width = _int(1024,1,4096)
#@gimp : Height = _int(1024,1,4096)
#@gimp : Size = float(0.5,0,3)
#@gimp : X-angle = float(57,0,360)
#@gimp : Y-angle = float(41,0,360)
#@gimp : Z-angle = float(21,0,360)
#@gimp : Fov = float(45,1,90)
#@gimp : X-light = float(0,-100,100)
#@gimp : Y-light = float(0,-100,100)
#@gimp : Z-light = float(-100,-100,0)
#@gimp : Specular lightness = float(0.5,0,1)
#@gimp : Specular shininess = float(0.7,0,3)
#@gimp : Rendering = choice(4,"Dots","Wireframe","Flat","Flat shaded","Gouraud","Phong")
#@gimp : Antialiasing = bool(1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
_gimp_imageobject3d :
-to_rgb -repeat @# -l[$>] -_gimp_imageobject3d$1$2 -endl -done
-db3d 0
gimp_imageobject3d :
-_gimp_imageobject3d "_",$1 -gimp_render3d ${2--1}
gimp_imageobject3d_preview :
w={w} h={h} -_gimp_imageobject3d "_preview_",$1 -gimp_render3d $w,$h,${4--1}
_gimp_imageobject3d_0 : -imageplane3d
_gimp_imageobject3d_1 : -imagecube3d
_gimp_imageobject3d_2 : -imagepyramid3d
_gimp_imageobject3d_3 : -imagesphere3d 64,32
_gimp_imageobject3d_4 : -torus3d 100,30,100,50 -t3d[-1] [-2] -rm[-2]
_gimp_imageobject3d_5 : -gyroid3d 24 -t3d[-1] [-2] -rm[-2]
_gimp_imageobject3d_6 : -weird3d 32 -t3d[-1] [-2] -rm[-2]
_gimp_imageobject3d_7 : -cup3d 128 -t3d[-1] [-2] -rm[-2]
_gimp_imageobject3d_8 : -imagerubik3d 5,5
_gimp_imageobject3d_preview_0 : -imageplane3d
_gimp_imageobject3d_preview_1 : -imagecube3d
_gimp_imageobject3d_preview_2 : -imagepyramid3d
_gimp_imageobject3d_preview_3 : -imagesphere3d 16,8
_gimp_imageobject3d_preview_4 : -torus3d 100,30,100,50 -t3d[-1] [-2] -rm[-2]
_gimp_imageobject3d_preview_5 : -gyroid3d 8 -c3d[-1] -n3d[-1] -t3d[-1] [-2] -rm[-2]
_gimp_imageobject3d_preview_6 : -weird3d 12 -t3d[-1] [-2] -rm[-2]
_gimp_imageobject3d_preview_7 : -cup3d 64 -t3d[-1] [-2] -rm[-2]
_gimp_imageobject3d_preview_8 : -imagerubik3d 3,3,5,5
#@gimp 3d lathing : gimp_lathing3d, gimp_lathing3d_preview(1)
#@gimp : Resolution = int(76,1,1024)
#@gimp : Smoothness = float(2,0,5)
#@gimp : Max angle = float(361,0,361)
#@gimp : Sep = separator()
#@gimp : Width = _int(1024,1,4096)
#@gimp : Height = _int(1024,1,4096)
#@gimp : Size = float(0.5,0,3)
#@gimp : X-angle = float(0,0,360)
#@gimp : Y-angle = float(0,0,360)
#@gimp : Z-angle = float(0,0,360)
#@gimp : Fov = float(45,1,90)
#@gimp : X-light = float(0,-100,100)
#@gimp : Y-light = float(0,-100,100)
#@gimp : Z-light = float(-100,-100,0)
#@gimp : Specular lightness = float(0.5,0,1)
#@gimp : Specular shininess = float(0.7,0,3)
#@gimp : Rendering = choice(4,"Dots","Wireframe","Flat","Flat shaded","Gouraud","Phong")
#@gimp : Antialiasing = bool(1)
#@gimp : Sep = separator(), note = note{"<small><b>Note:</b> Add a top layer to define object texture.</small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
_gimp_lathing3d :
-repeat {@#/2} -l[$>,{min($>+1,@#-1)}]
-lathe3d[-1] $1,$2%,$3
-if {@#==2} -t3d[-1] [-2] -rm[-2] -endif
-endl -done
-db3d 0
gimp_lathing3d :
-_gimp_lathing3d ${1-3} -gimp_render3d ${4--1}
gimp_lathing3d_preview :
-gimp_lathing3d ${1-3},{w},{h},${6--1}
#@gimp 3d random objects : gimp_random3d, gimp_random3d(1)
#@gimp : Type = choice("Cube","Cone","Cylinder","Sphere","Torus")
#@gimp : Density = int(50,1,300)
#@gimp : Size = float(3,1,20)
#@gimp : Z-range = float(100,0,300)
#@gimp : Fov = float(45,1,90)
#@gimp : X-light = float(0,-100,100)
#@gimp : Y-light = float(0,-100,100)
#@gimp : Z-light = float(-100,-100,0)
#@gimp : Specular lightness = float(0.5,0,1)
#@gimp : Specular shininess = float(0.7,0,3)
#@gimp : Rendering = choice(3,"Dots","Wireframe","Flat","Flat shaded","Gouraud","Phong")
#@gimp : Opacity = float(1,0,1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_random3d :
-repeat @# -l[$>]
f3d={0.5*max(w,h)/tan($5*pi/360)} -f3d $f3d -l3d {$6*$f3d},{$7*$f3d},{$8*$f3d} -sl3d $9 -ss3d $10
-to_rgb ({w},{h},{d},{s}) -/[-1] 2 -repeat $2
(@{1,0}) -+[-1] @{1,1} -*[-1] $3 -/[-1] 100 -_gimp_random3d$1 @-1 -rm[-2]
-r3d[-1] 1,1,0,{?(0,360)}
({?(-1,1)}) -*[-1] @{1,0} ({?(-1,1)}) -*[-1] @{1,1}
-+3d[-3] @-2,@-1,{?(-$4,$4)} -rm[-2,-1]
-col3d[-1] {?(255)},{?(255)},{?(255)} -done -+3d[2--1] -j3d[0] [-1],50%,50%,0,$12,$11,0,1
-k[0]
-endl -done
_gimp_random3d0 : -box3d $1
_gimp_random3d1 : ($1) -/[-1] 2 -cone3d @-1,$1 -rm[-2]
_gimp_random3d2 : ($1) -/[-1] 2 -cylinder3d @-1,$1 -rm[-2]
_gimp_random3d3 : -sphere3d $1,2
_gimp_random3d4 : ($1) -/[-1] 3 -torus3d $1,@-1 -rm[-2]
#@gimp Adjacent rectangles : samj_en_Rectangles_Adjacents, samj_en_Rectangles_Adjacents(1)
#@gimp : Sep = separator(), note = note("<small>Rendering</small>")
#@gimp : X top left = float(10,-100,100)
#@gimp : Y top left = float(10,-100,100)
#@gimp : X down right = float(80,0,100)
#@gimp : Y down right = float(80,0,100)
#@gimp : Type / location contact = choice(0,"Haut - Top","Bas - Down","Gauche - Left","Droite - Right")
#@gimp : Position contact = float(50,0,100)
#@gimp : Nb rectangles = int(6,2,25)
#@gimp : Type n = choice(0,"Inc 1","Lin 0.1","Lin 0.2","Lin 0.3","Rand","M1","M2")
#@gimp : Tilt = float(0,0,360)
#@gimp : Contours = color(0,0,0,255)
#@gimp : Display contours = bool(1)
#@gimp : Rectangle a = color(255,255,0,127)
#@gimp : Rectangle b = color(0,0,255,127)
#@gimp : Random colors = bool(0)
#@gimp : Mirror = choice(0,"Sans - Wihout"," X "," Y "," X Y ")
#@gimp : Blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : Deform = float(0,0,5)
#@gimp : Noise = float(0,0,100)
#@gimp : Shadow = bool(0)
#@gimp : X-shadow = float(0.5,-5,5)
#@gimp : Y-shadow = float(0.5,-5,5)
#@gimp : Smoothness shadow = float(1.8,0,5)
#@gimp : Curvature shadow = float(0,0,1)
#@gimp : Shadow offset x = float(0,-20,20)
#@gimp : Shadow offset y = float(0,-20,20)
#@gimp : Alpha channel = bool(0)
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/06</i>.</small>")
samj_en_Rectangles_Adjacents :
-samj_Rectangles_Adjacents $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35,$36
#@gimp Annular steiner chains : samj_en_Annular_Steiner_Chains, samj_en_Annular_Steiner_Chains(1)
#@gimp : Note = link("http://en.wikipedia.org/wiki/Steiner_chain","http://en.wikipedia.org/wiki/Steiner_chain")
#@gimp : Sep = separator(), note = note("<small>Rendering</small>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Radius outer circle a (>0 w%) (<0 h%) = float(50,-400,400)
#@gimp : Nb circles surrounding = int(6,3,360)
#@gimp : Tilt = float(0,0,360)
#@gimp : Contours = color(0,0,0,255)
#@gimp : Display contours = choice(1,"Sans","CE CI CA","CE CI CA CC","CE CI CA CC CT","CE CI CA CT","CE CA","CI CA","CA")
#@gimp : Exterior circle a = color(255,255,0,127)
#@gimp : Centre circle b = color(64,192,128,127)
#@gimp : Circle c = color(0,255,0,127)
#@gimp : Circle d = color(0,0,255,127)
#@gimp : Random colors = bool(0)
#@gimp : Inversions = int(0,0,3)
#@gimp : Blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : Deform = float(0,0,5)
#@gimp : Noise = float(0,0,100)
#@gimp : Shadow = bool(0)
#@gimp : X-shadow = float(0.5,-5,5)
#@gimp : Y-shadow = float(0.5,-5,5)
#@gimp : Smoothness shadow = float(1.8,0,5)
#@gimp : Curvature shadow = float(0,0,1)
#@gimp : Shadow offset x = float(0,-20,20)
#@gimp : Shadow offset y = float(0,-20,20)
#@gimp : Alpha channel = bool(0))
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/08</i>.</small>")
samj_en_Annular_Steiner_Chains :
-samj_Annular_Steiner_Chains $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35,$36,$37,$38,$39,$40
#@gimp Ball : gimp_ball, gimp_ball_preview(0)
#@gimp : Radius = int(128,1,1024)
#@gimp : Specular light = float(0.8,0,8)
#@gimp : Specular size = float(1,0,8)
#@gimp : Shadow = float(1.5,0,4)
#@gimp : Color = color(255,0,255)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/27/2013</i>.</small>")
gimp_ball :
-ball $1,${5-7},${2-4} -mv[-1] 0 -nm[0] "name(Ball)"
gimp_ball_preview :
-gimp_ball $*
-if {@#>1} -rv[-2,-1] -blend[-2,-1] alpha -endif
#@gimp Circle art : gimp_circle_art, gimp_circle_art
#@gimp : Type = choice(1,"Random","Lissajous spiral")
#@gimp : Density = float(15,0,100)
#@gimp : Radius = float(0.5,0,1)
#@gimp : Modulo = int(8,2,16)
#@gimp : Anti-aliasing = bool(1)
#@gimp : Random colors = bool(1)
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Lissajous parameters:</b></small>")
#@gimp : Curve length = float(15,0,50)
#@gimp : Curve angle = float(0,0,360)
#@gimp : Minimal radius = float(0,-5,5)
#@gimp : Maximal radius = float(0.5,-5,5)
#@gimp : X-dispersion = float(1,0,4)
#@gimp : Y-dispersion = float(1,0,4)
#@gimp : X-factor = int(1,0,16)
#@gimp : Y-factor = int(1,0,16)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/22/2014</i>.</small>")
gimp_circle_art :
-if {!$2} -f 0 -return -endif
-if {$1==0}
{round(2*($2^1.5))}
-rand[-1] -1,1 --rand[-1] -1,1 --rand[-1] -$3,$3 -a[-3--1] y
-else
{max(1,round($2*$7))}
t0={$8*2*pi/180}
-rows[-1] 0,2 -f[-1] 'r=x/(w-1);t=2*pi*x/$2;if(y==0,(r^$11)*cos($t0+$13*t),if(y==1,(r^$12)*sin($t0+$14*t),max(0,$3*($9+($10-$9)*r))))'
-endif
-l[-1]
-transpose -s x,-1 h={h}
-i[0] ({'CImg3d'},{2*$h},$h)
--+[-3] [-1] --[-4,-2] -i [-2] -i[-3,-1] 1,100% -a[-6--1] x
1,$h,1,1,5 1,$h,1,1,2*y --+[-1] 1 -a[-3--1] x -z[-1] 0,5
3,$h,1,1,1 1,$h,1,1,-1 -y -a y
-endl
-repeat {@#-1} -l[$>,-1]
s=@{0,max(w,h)} -rm[0]
-if $5 {2*$s},{2*$s} --*3d[0] $s
-else $s,$s --*3d[0] {$s/2}
-endif
-j3d[1] [2],50%,50%,0,1,2,0,0 -rm[2]
-%[-1] $4
-if $6 -i[-2] 100%,100%,1,3 -rand[-2] 0,255 -plasma[-2] 1,1 -equalize[-2] 256 -n[-2] 0,255 -blend[-2,-1] shapeaverage -endif
-rv
-endl -done
-rm[-1]
-n 0,255
-if $5 -r 50%,50%,1,100%,2 -endif
#@gimp Cupid : gimp_cupid, gimp_cupid
#@gimp : Smoothness = float(0,0,10)
#@gimp : Color = color(255,0,0,255)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/13/2013</i>.</small>")
gimp_cupid :
-if {@#>0} siz={min(@{-min_w},@{-min_h})} -else siz=512 -endif
-cupid $siz -to_rgba[-1]
-replace_color[-1] 0,0,0,0,0,255,$2,$3,$4,0
-replace_color[-1] 0,0,1,1,1,255,$2,$3,$4,$5
-frame[-1] {2.5*$1}%,{2.5*$1}%,$2,$3,$4,0 -b[-1] $1%
-blend[-2,-1] alpha
#@gimp Equation plot [parametric] : gimp_equation_parametric, gimp_equation_parametric
#@gimp : X(t) = text{"sin(t)*(exp(cos(t))-2*cos(4*t)-sin(t/12)^5)"}
#@gimp : Y(t) = text{"cos(t)*(exp(cos(t))-2*cos(4*t)-sin(t/12)^5)"}
#@gimp : Min-t = float(0,-1000,1000)
#@gimp : Max-t = float(100,-1000,1000)
#@gimp : Resolution = int(4096,2,32768)
#@gimp : Outline opacity = float(1,0,1)
#@gimp : Dot size = int(0,0,16)
#@gimp : Start color = color(64,0,0)
#@gimp : End color = color(128,0,0)
#@gimp : Colored outline = bool(1)
#@gimp : Antialiasing = bool(1)
#@gimp : Decoration = bool(1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/13/2013</i>.</small>")
gimp_equation_parametric :
-repeat @# -l[$>]
w={w} h={h} -rm
$5,1,1,2,'"t=$3+x*($4-$3)/($5-1);if(c==0,$1,$2)"'
-channels[-1] 0,2
($8,$11^$9,$12^$10,$13) -r[-1] @{-2,w},1,1,3,3 -a c
-display_parametric $w,$h,{$6+$14*1.001},$7,$15,$16
-endl -done
#@gimp Equation plot [y=f(x)] : gimp_equation_plot, gimp_equation_plot
#@gimp : F(x) = text{"X*c+10*cos(X+c+?)"}
#@gimp : X-min = float(-10,-100,100)
#@gimp : X-max = float(10,-100,100)
#@gimp : Resolution = int(100,2,1024)
#@gimp : Channels = int(3,1,32)
#@gimp : Plot type = choice(2,"None","Lines","Splines","Bars")
#@gimp : Vertex type = choice(0,"None","Points","Crosses 1","Crosses 2","Circles 1","Circles 2","Square 1","Square 2")
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Note</b> :
#@gimp : Use variable <b>X</b> instead of <b>x</b> in the above equation to take care of the X-min/max settings.
#@gimp : Variable <b>c</b> refers to the current channel number.
#@gimp : Variable <b>?</b> refers to a uniformly distributed random value in [0,1].
#@gimp : Reduce resolution to be able to view
#@gimp : separate graph vertices.</small>")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_equation_plot :
-repeat @# -l[$>]
w={w} h={h} -rm
$4,1,1,$5,"X=$2+($3-$2)*x/($4-1);$1"
-dg $w,$h,$6,$7,$2,$3
-endl -done
#@gimp Gradient cie Lab [linear] : samj_en_Linear_Gradient_CIE_Lab, samj_en_Linear_Gradient_CIE_Lab(1)
#@gimp : Sep = separator(), note = note("<small>Gradient CIE Lab</small>")
#@gimp : Type h / v = choice(0,"H","V")
#@gimp : Swap colors = bool(0)
#@gimp : Starting color a = color(240,40,160,255)
#@gimp : Ending color b = color(240,240,40,255)
#@gimp : Sep = separator(), note = note("<small>samj - Latest update : <i>2015/03/02</i>.</small>")
samj_en_Linear_Gradient_CIE_Lab :
-samj_Linear_Gradient_CIE_Lab $1,$2,$3,$4,$5,$6,$7,$8,$9,$10
#@gimp Gradient cie Lab [shape] : samj_en_Shape_Linear_Gradient_CIE_Lab, samj_en_Shape_Linear_Gradient_CIE_Lab(1)
#@gimp : Note = note("Gradient CIE Lab")
#@gimp : Sep = separator(), note = note("<small><b><span foreground="red">Starting Point / Diameter :</span></b></small>")
#@gimp : X0 = float(10,0,100)
#@gimp : Y0 = float(10,0,100)
#@gimp : Note = note("<small><b><span foreground="blue">Ending Point / Center :</span></b></small>")
#@gimp : X1 = float(90,0,100)
#@gimp : Y1 = float(90,0,100)
#@gimp : Note = note("<small><b><span foreground="black">Parameters :</span></b></small>")
#@gimp : Shape = choice(2,"Linear H","Linear V","Square","Square Overflow","Circle X0","Circle X0+YO")
#@gimp : Swap colors = bool(0)
#@gimp : Starting color a = color(240,40,160,255)
#@gimp : Ending color b = color(240,240,40,255)
#@gimp : Background = choice(0,"Image","Transparent","Color")
#@gimp : Background color = color(0,0,0,255)
#@gimp : Examples = choice(0,"None","10 10 90 90 Linear H","10 10 90 90 Linear V","10 10 90 90 Square","10 10 90 90 Square Overflow","40 40 50 50 Circle X0","40 40 50 50 Circle X0+YO","71 71 100 100 Circle X0+YO")
#@gimp : Sep = separator(), note = note("<small>samj - Latest update : <i>2014/04/29</i>.</small>")
samj_en_Shape_Linear_Gradient_CIE_Lab :
-samj_Shape_Linear_Gradient_CIE_Lab $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20
#@gimp Gradient [corners] : gimp_corner_gradient, gimp_corner_gradient
#@gimp : Color 1 (up/left corner) = color(255,255,255,128)
#@gimp : Color 2 (up/right corner) = color(255,0,0,255)
#@gimp : Color 3 (bottom/left corner) = color(0,255,0,255)
#@gimp : Color 4 (bottom/right corner) = color(0,0,255,255)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_corner_gradient :
-repeat @#
({w},{h}) -rm[-2]
($1,$5;$9,$13^$2,$6;$10,$14^$3,$7;$11,$15^$4,$8;$12,$16) -r[-1] @-2,1,4,3 -rm[-2]
-mv[-1] 0 -done
#@gimp Gradient [custom shape] : gimp_custom_gradient, gimp_custom_gradient_preview(1)
#@gimp : Note = note("<small><b>Shape selection:</b></small>")
#@gimp : Select by = choice("Auto","Dark pixels","Bright pixels","Opaque pixels")
#@gimp : Smoothness = float(0,0,10)
#@gimp : Threshold = float(0,0,100)
#@gimp : Preview shape = bool(1)
#@gimp : Note = note("<small><b>Note:</b> Shapes with small strokes may lead to incorrect previews.</small>")
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Gradient parameters:</b></small>")
#@gimp : Number of colors = int(4,2,10)
#@gimp : Cycles = float(1,1,16)
#@gimp : Offset = float(0,0,100)
#@gimp : Shading = float(128,1,256)
#@gimp : Inner length = float(100,0,100)
#@gimp : Outer length = float(100,0,100)
#@gimp : Spatial metric = choice(2,"Chebyshev","Manhattan","Euclidean")
#@gimp : Color metric = choice("RGB","HSV","Lab")
#@gimp : Shade back to first color = bool(1)
#@gimp : Preview gradient = bool(0)
#@gimp : Save gradient as = _text("")
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Color definitions:</b></small>")
#@gimp : Colormap type = choice(1,"Pre-defined","User-defined")
#@gimp : Pre-defined colormap = int(0,0,65535)
#@gimp : 1st color = color(0,0,0,255)
#@gimp : 2nd color = color(255,0,0,255)
#@gimp : 3rd color = color(255,255,0,255)
#@gimp : 4th color = color(255,255,255,255)
#@gimp : 5th color = color(0,255,255,255)
#@gimp : 6th color = color(0,255,0,255)
#@gimp : 7th color = color(0,0,255,255)
#@gimp : 8th color = color(128,128,128,255)
#@gimp : 9th color = color(255,0,255,255)
#@gimp : 10th color = color(0,0,0,0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/03/2013</i>.</small>")
gimp_custom_gradient_preview : -skip "${15=}"
-repeat @# -l[$>]
-if $4
--_gimp_custom_gradient1 ${1-14},"$15",${16--1} --erode[-1] 3 --[-2,-1] --dilate[-1] 5 -a[-2,-1] c -n[-1] 0,255
-gimp_custom_gradient[0] ${1-14},"$15",${16--1},-1 -blend alpha
-else -gimp_custom_gradient ${1-14},"$15",${16--1},-1
-endif
-if $14
--_gimp_custom_gradient0[] ${1-14},"$15",${16--1} -r[-1] {@{0,w}-16},16,1,4 -frame[-1] 1,1,0 -j[0] [-1],8,@{0,h-25} -rm[-1]
-endif
-endl -done
gimp_custom_gradient : -skip "${15=}"
-_gimp_custom_gradient0 ${1-14},"$15",${16--1}
-if {$-1>=0&&narg("$15")}
dir_ggr=@{-path_gimp}/gradients
0 -nm[-1] @{"-normalize_filename \"$15\""} name_ggr=@{-1,b} -rm[-1] -output_ggr[-1] $dir_ggr/$name_ggr.ggr,"$15"
-endif
-i[-2] (0^0^0^0) -a[-2,-1] x
-repeat {@#-1} -l[$>,-1]
-_gimp_custom_gradient1[0] ${1-14},"$15",${16--1}
--distance[0] 1,$11 --distance[0] 0,$11 -*[-1] -1 -+[0] 1 -+[0,-2,-1]
m={$9%*@{0,m}} M={$10%*@{0,M}}
--[0] $m -*[0] {@{1,w-2}/($M-$m)} -+[0] 1
-round[0] -map[0] [-1]
-endl -done
-rm[-1]
_gimp_custom_gradient0 :
-if $16 4,8,1,1,${18-56} -permute[-1] yzcx
-else 8,1,1,3 -srand $17 -rand[-1] 0,255 -to_rgba[-1]
-endif
-z[-1] 0,{$5-1}
-if $13
-r[-1] {200*$6}%,1,1,4,0,2
-__gimp_custom_gradient0[-1] $12,$8
-shift[-1] {-$7/2}%,0,0,0,2 -z[-1] 0,{w/2-1}
-else
-__gimp_custom_gradient0[-1] $12,$8
-r[-1] {100*$6}%,1,1,4,0,2 -shift[-1] -$7%,0,0,0,2
-endif
__gimp_custom_gradient0 :
-if {$1==1} -sh[-1] 0,2 -rgb2hsv[-1] -rm[-1]
-elif {$1==2} -sh[-1] 0,2 -srgb2rgb[-1] -rgb2lab[-1] -rm[-1]
-endif
-r[-1] {$2*w},1,1,4,3
-if {$1==1} -sh[-1] 0,2 -hsv2rgb[-1] -rm[-1]
-elif {$1==2} -sh[-1] 0,2 -lab2rgb[-1] -rgb2srgb[-1] -rm[-1]
-endif
_gimp_custom_gradient1 :
-b $2%
-if {$1==0}
-to_a -split_opacity
-if {iM>im+32}
-rm[-2] ->=[0] {100-$3}%
-else
-rm[-1] -norm -n 0,1
-if {ia>0.5} -<=[0] $3% -else ->=[0] {100-$3}% -endif
-endif
-elif {$1==1}
-remove_opacity -norm -<= $3%
-elif {$1==2}
-remove_opacity -norm ->= {100-$3}%
-else
-to_a -channels 100% ->= {100-$3}%
-endif
#@gimp Gradient [from line] : gimp_line_gradient, gimp_line_gradient_preview(1)
#@gimp : Note = note("<small><b><span foreground="red">Starting point:</span></b></small>")
#@gimp : X0 = float(0,0,100)
#@gimp : Y0 = float(0,0,100)
#@gimp : Note = note("<small><b><span foreground="blue">Ending point:</span></b></small>")
#@gimp : X1 = float(100,0,100)
#@gimp : Y1 = float(100,0,100)
#@gimp : Sep = separator()
#@gimp : Sampling = float(100,0,100)
#@gimp : Length = int(0,0,4096)
#@gimp : Note = note("<small><b>Note:</b> Set length to <i>0</i> to release gradient length constraints.</small>")
#@gimp : Sort colors = choice("Don't sort","By red component","By green component","By blue component","By luminance","By blue chrominance","By red chrominance","By lightness")
#@gimp : Reverse gradient = bool(0)
#@gimp : Sep = separator()
#@gimp : Preview gradient = bool(1)
#@gimp : Save gradient as = _text("")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/09/2013</i>.</small>")
gimp_line_gradient : -skip "${10=}"
-_gimp_line_gradient $*
-if {narg("$10")}
dir_ggr=@{-path_gimp}/gradients
0 -nm[-1] @{"-normalize_filename \"$10\""} name_ggr=@{-1,b} -rm[-1] -output_ggr[-1] $dir_ggr/$name_ggr.ggr,"$10"
-endif
-repeat @# -r[$>] 100%,64,1,100% -done
gimp_line_gradient_preview :
-repeat @# -l[$>]
-to_rgba
-if $9 --_gimp_line_gradient $* -endif
-l[0]
-line $1%,$2%,$3%,$4%,1,0xF0F0F0F0,255,255,255,255
-line $1%,$2%,$3%,$4%,1,0x0F0F0F0F,0,0,0,255
-circle $1%,$2%,4,1,255,0,0,255
-circle $3%,$4%,4,1,0,0,255,255
-circle $1%,$2%,4,1,0xFFFFFFFF,0,0,0,255
-circle $3%,$4%,4,1,0xFFFFFFFF,0,0,0,255
-endl
-if {@#>1} -r[-1] {@{0,w}-32},32,1,4,1 -frame[-1] 1,1,0,0,0,255 -j[0] [1],16,{@{0,h}-48} -rm[-1] -endif
-endl -done
_gimp_line_gradient :
-at_line $1%,$2%,0,$3%,$4%,0 -r {max(0.1,$5)}%,1,1,100%,1
-m "feature1 : -channels 0"
-m "feature2 : -channels 1"
-m "feature3 : -channels 2"
-m "feature4 : -to_rgb -luminance"
-m "feature5 : -to_rgb -rgb2ycbcr -channels 1"
-m "feature6 : -to_rgb -rgb2ycbcr -channels 2"
-m "feature7 : -to_rgb -srgb2rgb -rgb2lab -channels 0"
-if $7 -repeat @# -l[$>] --feature$7 -rv -a y -sort +,x -rows 1 -endl -done -endif
-if $6 -r $6,1,1,100%,3 -endif
-if $8 -mirror x -endif
#@gimp Gradient [linear] : gimp_linear_gradient, gimp_linear_gradient
#@gimp : Starting color = color(0,0,0,255)
#@gimp : Ending color = color(255,255,255,255)
#@gimp : Swap colors = bool(0)
#@gimp : Angle = float(45,0,360)
#@gimp : Fade start = float(0,0,100)
#@gimp : Fade end = float(100,0,100)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_linear_gradient :
-repeat @#
({w},{h}) -rm[-2]
($1^$2^$3^$4) ($5^$6^$7^$8)
-if $9 -rv[-2,-1] -endif
-r[-2,-1] @-3 -rm[-3]
-fade_linear $10,$11,$12
-mv[-1] 0 -done
#@gimp Gradient [radial] : gimp_radial_gradient, gimp_radial_gradient
#@gimp : Starting color = color(0,0,0,255)
#@gimp : Ending color = color(255,255,255,255)
#@gimp : Swap colors = bool(0)
#@gimp : Fade start = float(0,0,100)
#@gimp : Fade end = float(100,0,100)
#@gimp : X-center = float(50,0,100)
#@gimp : Y-center = float(50,0,100)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_radial_gradient :
-repeat @#
({w},{h}) -rm[-2]
($1^$2^$3^$4) ($5^$6^$7^$8)
-if $9 -rv[-2,-1] -endif
-r[-2,-1] @-3 -rm[-3]
100%,100% -=[-1] 1,$12%,$13% -distance[-1] 1 -_fade $10,$11
-mv[-1] 0 -done
#@gimp Hair locks : gtutor_hairlock, gtutor_hairlock_preview(0)
#@gimp : Note = note("<b>Geometry</b>")
#@gimp : Spread = float(0.5,0,1)
#@gimp : Thickness = float(0.5,0,1)
#@gimp : Length = float(0.5,0,1)
#@gimp : Sep = separator()
#@gimp : Note = note("<b>Color</b>")
#@gimp : Color = color(255,255,0,255)
#@gimp : Variance = float(0.5,0,1)
#@gimp : Sep = separator()
#@gimp : Note = note("<b>Lighting</b>")
#@gimp : Azimuth = float(45,0,360)
#@gimp : Highlight = float(0.5,0,1)
#@gimp : Specular = float(0.5,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Garry R. Osgood</i>. Latest update: <i>2014/12/11</i>.</small>")
#@gimp : Note = link("Hairlock instructions and tutorial.","http://gmic.eu/tutorial/the-hairlock-filter.shtml")
gtutor_hairlock :
($4^$5^$6)
-rgb2hsl[-1]
hue={i[0]}
sat={0.97*i[1]}
light={i[2]}
opac={$7/255}
var={0.1*$8}
-rm[-1]
-repeat @#
-local[$>]
--diffusiontensors[-1] 1,0,0.1,{8*$1},0
-diffusiontensors[-2] 0,1,0.1,{20*$1},0
-eigen[-2,-1]
-rm[-1]
-split[-1] c
-rm[-1]
-mul[-1] -1
-add[-1]
-normalize[-1] 0,1
-mv[-1] 0
-split[-2] c
-rm[-3]
-mul[-2] -1
-add[-2] 1
--mul[-2] 0
-reverse[-1,-2]
-append[-3,-2] c
-eigen2tensor[-2,-1]
-input 100%,100%,1,3
-_hcolor[-1] $hue,$sat,$light,$var,{0.05+0.5*$2},0.98,1
-dilate_circ[-1] {2+2*$2}
--luminance[-1]
-gt[-1] 0.01
-mul[-4,-1]
-normalize[-1] 0,255
-replace_color[-1] 0,0,0,0,0,$4,$5,$6
-reverse[-2,-1]
-repeat 3
-smooth[-3,-2] [-1],{5+595*$3}
-done
-rm[-1]
-reverse[-2,-1]
-sharpen[-1] {1.2*(1-$2)}
-normalize[-1] 0,1
--_hlight[-1] $9,$10,1
-mul[-1] [-3]
-add[-3,-1]
--_hlight[-1] $9,$10,$11
-input [-3],[-3],[-3],[-3],255,255,255
-image[-4] [-1],0,0,0,0,1,[-2]
-keep[-4,-3]
-normalize[-1] 0,{51*(1+4*$opac)}
-append[-2,-1] c
-normalize[-1] 0,255
-endlocal
-done
gtutor_hairlock_preview :
-gimp_split_preview "-gtutor_hairlock ${^0}",$-1
_hlight : -check "${1=45}<=360 && $1>=0 && ${2=0.5}>=0 && ${3=0.5}>=0"
-if {$2>0}
-resize2dx[-1] 400%,5
-blur[-1] 2,1
-gradient_orientation[-1] 2
-append[-2,-1] c
-input ({cos(2*$1*pi/360)}^{sin(2*$1*pi/360)})
-resize[-1] [-2],[-2],[-1],[-1],1
-mul[-2,-1]
-compose_channels[-1] add
-cut[-1] {ia},{iM}
-normalize[-1] {195*$3-200},0
-exp[-1]
-resize2dx[-1] 25%,5
-normalize[-1] 0,{$2}
-else
-fill_color[-1] 0
-endif
-to_rgb[-1]
_hcolor : -skip ${1=40},${2=0.5},${3=0.5},${4=0},${5=0.5},${6=1},${7=1}
-repeat @#
-local[$>]
pcnt={0.5*w*h*$5}
{$pcnt},1,1,1,(@{0,w}*(1-$6)/2)+@{0,w}*$6*u
{$pcnt},1,1,1,(@{0,h}*(1-$6)/2)+@{0,h}*$6*u
{$pcnt},1,1,1
ra={$1/360.0}
-if $7
{$pcnt},{s},1,1,360.0*($ra+$4*(2*g-1))%1
{$pcnt},{s},1,1,($2+$4*(2*g-1))%1
{$pcnt},{s},1,1,($3+$4*(2*g-1))%1
-else
{$pcnt},{s},1,1,360.0*($ra+$4*(2*g-1))
{$pcnt},{s},1,1,$2+$4*(2*g-1)
{$pcnt},{s},1,1,$3+$4*(2*g-1)
-endif
-append[^0] y
-pointcloud[-1] 0,@{-2,w},@{-2,h},1,@{-2,s}
-rm[-2]
-hsl2rgb[-1]
-endlocal
-done
#@gimp Harmonograph : Harmonograph_samj_en, Harmonograph_samj_en(1)
#@gimp : Note = link("http://en.wikipedia.org/wiki/Harmonograph")
#@gimp : Sep = separator(), note = note("<small>Center</small>")
#@gimp : Center x (%) = float(50,0,100)
#@gimp : Center y (%) = float(50,0,100)
#@gimp : Sep = separator(), note = note("<small>Harmonograph</small>")
#@gimp : Pen (color) = color(192,128,64,255)
#@gimp : Pen (color variation) = choice("No change","Random colors","Poorly nuanced","Moderately nuanced","Highly nuanced")
#@gimp : Pen (dilate pixels) = int(0,0,32)
#@gimp : It\303\251rations = int(1000,2,30000)
#@gimp : Iterations = choice(0,"Iterations * 1","Iterations * 5 SLOW","Iterations * 10 VERY SLOW")
#@gimp : Time increment [*10000] = float(400,10,500)
#@gimp : Sep = separator(), note = note("<small>Amplitude</small>")
#@gimp : Amplitude 1 (>0 w) (<0 h) = float(150,-1000,1000)
#@gimp : Amplitude 2 (>0 w) (<0 h) = float(200,-1000,1000)
#@gimp : Amplitude 3 (>0 w) (<0 h) = float(200,-1000,1000)
#@gimp : Amplitude 4 (>0 w) (<0 h) = float(100,-1000,1000)
#@gimp : Sep = separator(), note = note("<small>Frequency</small>")
#@gimp : Frequency 1 = float(4,0,16)
#@gimp : Frequency 2 = float(6,0,16)
#@gimp : Frequency 3 = float(2,0,16)
#@gimp : Frequency 4 = float(2,0,16)
#@gimp : Sep = separator(), note = note("<small>Phase</small>")
#@gimp : Phase 1 = float(15,0,360)
#@gimp : Phase 2 = float(270,0,360)
#@gimp : Phase 3 = float(75,0,360)
#@gimp : Phase 4 = float(60,0,360)
#@gimp : Sep = separator(), note = note("<small>Damping</small>")
#@gimp : Damping 1 = float(0.04,0,1)
#@gimp : Damping 2 = float(0.04,0,1)
#@gimp : Damping 3 = float(0.05,0,1)
#@gimp : Damping 4 = float(0.06,0,1)
#@gimp : Sep = separator(), note = note("<small>Distorsions</small>")
#@gimp : Blur = float(0,0,10)
#@gimp : Spread = float(0,0,10)
#@gimp : Deform = float(0,0,25)
#@gimp : Sep = separator(), note = note("<small>Blend</small>")
#@gimp : Mode = choice{1,"Add","Alpha","And","Average","Blue","Burn","Darken","Difference",
#@gimp : "Divide","Dodge","Edges","Exclusion","Freeze","Grain extract","Grain merge","Green","Hard light",
#@gimp : "Hard mix","Hue","Interpolation","Lighten","Lightness","Linear burn","Linear light","Luminance",
#@gimp : "Multiply","Negation","Or","Overlay","Pin light","Red","Reflect","Saturation",
#@gimp : "Shape Average","Shape Average0","Soft burn","Soft dodge","Soft light","Screen","Stamp","Subtract","Value",
#@gimp : "Vivid light","Xor"}
#@gimp : Opacity = float(1,0,1)
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/15</i>.</small>")
Harmonograph_samj_en :
-Harmonograph_samj $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32
#@gimp Hawaiian earring : samj_en_Hawaiian_Earring, samj_en_Hawaiian_Earring(1)
#@gimp : Note = link("http://en.wikipedia.org/wiki/Hawaiian_earring","http://en.wikipedia.org/wiki/Hawaiian_earring")
#@gimp : Sep = separator(), note = note("<small>Rendering</small>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Circle a radius (%) = float(40,1,200)
#@gimp : Nb  circles = int(6,2,25)
#@gimp : Type n = choice(0,"Inc 1","Lin 0.1","Lin 0.2","Lin 0.3","Rand")
#@gimp : Tilt = float(0,0,360)
#@gimp : Contours = color(0,0,0,255)
#@gimp : Display contours = bool(1)
#@gimp : Circle a = color(255,255,0,127)
#@gimp : Circles b = color(0,0,255,127)
#@gimp : Random colors = bool(0)
#@gimp : Mirror = choice(0,"Sans - Wihout"," X "," Y "," X Y ")
#@gimp : Blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : Deform = float(0,0,5)
#@gimp : Noise = float(0,0,100)
#@gimp : Shadow = bool(0)
#@gimp : X-shadow = float(0.5,-5,5)
#@gimp : Y-shadow = float(0.5,-5,5)
#@gimp : Smoothness shadow = float(1.8,0,5)
#@gimp : Curvature shadow = float(0,0,1)
#@gimp : Shadow offset x = float(0,-20,20)
#@gimp : Shadow offset y = float(0,-20,20)
#@gimp : Alpha channel = bool(0)
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/06</i>.</small>")
samj_en_Hawaiian_Earring :
-samj_Hawaiian_Earring $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33
#@gimp Heart : gimp_heart, gimp_heart_preview
#@gimp : Size = float(75,0,100)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Color = color(255,0,0,255)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/13/2013</i>.</small>")
gimp_heart :
-if {@#>0} wh=@{-max_wh} w={$1%*min(512,arg(1,$wh))} h={$1%*min(512,arg(2,$wh))} -else w={$1%*512} h={$1%*512} -endif
-heart {max(1,$w)},{max(1,$h)} -to_rgba[-1]
-replace_color[-1] 0,0,1,1,1,255,$3,$4,$5,$6
-replace_color[-1] 0,0,0,0,0,255,$3,$4,$5,0
-b[-1] $2% -mv[-1] 0
gimp_heart_preview :
-gimp_heart $* -blend[^0] [0],alpha -rm[0]
#@gimp Lightning : gimp_lightning, gimp_lightning_preview
#@gimp : Note = note{"<small><b>Global parameters:</b></small>"}
#@gimp : Number of streaks = int(20,1,1024)
#@gimp : Size (%) = float(90,0,150)
#@gimp : Resolution = int(256,2,4096)
#@gimp : Randomness = float(3,0,16)
#@gimp : Smoothness = float(1.5,0,10)
#@gimp : Balance = float(0.75,0,1)
#@gimp : Color = color(255,255,255,255)
#@gimp : Seed = int(0,0,65536)
#@gimp : Sep = separator()
#@gimp : Note = note{"<small><b>Initial streak:</b></small>"}
#@gimp : X-coordinate (%) = float(50,0,100)
#@gimp : Y-coordinate (%) = float(5,0,100)
#@gimp : Angle (deg.) = float(0,-180,180)
#@gimp : Thickness (px.) = int(6,1,64)
#@gimp : Blur = float(0.2,0,3)
#@gimp : Sep = separator()
#@gimp : Note = note{"<small><b>Auxiliary streaks:</b></small>"}
#@gimp : Min offset (%) = float(25,0,100)
#@gimp : Max offset (%) = float(60,0,100)
#@gimp : Min length (%) = float(95,0,200)
#@gimp : Max length (%) = float(100,0,200)
#@gimp : Min angle deviation (deg.) = float(30,0,180)
#@gimp : Max angle deviation (deg.) = float(40,0,180)
#@gimp : Thickness factor = float(-0.25,-1,1)
#@gimp : Blur factor = float(-0.1,-1,1)
#@gimp : Opacity factor = float(-0.20,-1,1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/27/2014</i>.</small>")
gimp_lightning :
-repeat @# -l[$<]
100%,100% -l[-1] fact={max(w,h)/$3*$2%} -srand $11
-repeat $1
-if {@#<=1}
i=0
new_level=1
new_length=$3
new_x=0
new_y=0
new_angle=$14
-else
i={round(?(1,max(1,(@#-1)*$6)))}
level=@{$i,-2}
angle=@{$i,-1}
nb_points=@{$i,i[6]}
p={round(($nb_points-2)*?($17%,$18%))}
new_level={$level+1}
new_length={max(2,round(($nb_points-$p)*?($19%,$20%)))}
new_x=@{$i,i[8+3*$p]}
new_y=@{$i,i[9+3*$p]}
new_angle={$angle+?($21,$22)*if(?>0.5,1,-1)}
-endif
-_gimp_lightning $new_length,$4,$5
-r3d[-1] 0,0,1,$new_angle
-+3d[-1] $new_x,$new_y
--*3d[-1] $fact [0],[0] -j3d[-1] [-2],$12%,$13%,0,1,1,0,0 -rm[-2]
dilation={$15*(if($23>0,1.5,10)^($23*($new_level-1)))}
blur={max(0,-1+(1+$16)*(if($24>0,2,5)^($24*($new_level-1))))}
opacity={min(1,$10/255*(2^($25*($new_level-1))))}
-dilate[-1] $dilation -b[-1] $blur% -n[-1] 0,1 -*[-1] $opacity -max[0,-1]
($new_level;$new_angle) -a[-2,-1] y
-progress {($>*100)/($1-1)}
-done
-k[0] -* 255 -i[0] 100%,100%,1,3 -fc[0] ${7-9} -a c
-endl
-rv
-endl -done
gimp_lightning_preview :
-repeat @# -l[$>]
-gimp_lightning $* -rv -blend alpha
-endl -done
_gimp_lightning :
-l[]
({'CImg3d'},$1,{$1-1})
1,$1 -noise[-1] $2,1 -cumulate[-1] -b[-1] $3 -shift[-1] 0,1 1,100%,1,1,y 1,100% -a[-3--1] x
1,{h-1},1,1,2 --f[-1] y --+[-1] 1 -a[-3--1] x
4,100%,1,1,1
-y -a y
-endl
#@gimp Lines around a point : Traits_Strokes_samj_en, Traits_Strokes_samj_en(1)
#@gimp : Sep = separator(), note = note("<small>Origine</small>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Sep = separator(), note = note("<small>Lines</small>")
#@gimp : Length (>0 %w) (<0 $h) = float(35,-400,400)
#@gimp : Variations (length) = choice(0,"No","A","B","C","D")
#@gimp : Variations % (length) = float(100,0,1000)
#@gimp : Distance from the center (>0 %w) (<0 $h) = float(0,-400,400)
#@gimp : Number of lines = int(30,1,2160)
#@gimp : Angle (start) = float(0,0,360)
#@gimp : Angle (end) = float(360,0,360)
#@gimp : Color = color(240,60,120,255)
#@gimp : Color variation = choice("No","Random colors","Poorly nuanced","Moderately nuanced","Highly nuanced")
#@gimp : Thickness = int(0,0,32)
#@gimp : Sep = separator(), note = note("<small>Symmetry</small>")
#@gimp : Symmetry = bool(0)
#@gimp : Length (%) = float(20,0,100)
#@gimp : Sep = separator(), note = note("<small>Distorsions</small>")
#@gimp : Blur = float(0,0,10)
#@gimp : Spread = float(0,0,10)
#@gimp : Deform = float(0,0,25)
#@gimp : Sep = separator(), note = note("<small>Blend</small>")
#@gimp : Mode = choice{1,"Add","Alpha","And","Average","Blue","Burn","Darken","Difference",
#@gimp : "Divide","Dodge","Edges","Exclusion","Freeze","Grain extract","Grain merge","Green","Hard light",
#@gimp : "Hard mix","Hue","Interpolation","Lighten","Lightness","Linear burn","Linear light","Luminance",
#@gimp : "Multiply","Negation","Or","Overlay","Pin light","Red","Reflect","Saturation",
#@gimp : "Shape Average","Shape Average0","Soft burn","Soft dodge","Soft light","Screen","Stamp","Subtract","Value",
#@gimp : "Vivid light","Xor"}
#@gimp : Opacity = float(1,0,1)
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/15</i>.</small>")
Traits_Strokes_samj_en:
-Traits_Strokes_samj $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22
#@gimp Lines of varying thickness : samj_en_Lignes_Epaisseur_Variable, samj_en_Lignes_Epaisseur_Variable(1)
#@gimp : Note = note("Lines Of Varying Thickness")
#@gimp : Sep = separator(), note = note("<small>Rendering</small>")
#@gimp : Lines = choice(0,"Vertical lines","Horizontal lines")
#@gimp : Resolution width = int(32,16,64)
#@gimp : Line thickness = int(3,1,7)
#@gimp : Background = color(0,0,0,255)
#@gimp : Line = color(255,255,255,255)
#@gimp : Invert background-line = bool(0)
#@gimp : Random colors = bool(0)
#@gimp : Resize = choice(1,"No","Dim. Origines")
#@gimp : Blur = int(0,0,200)
#@gimp : Deblur = int(0,0,48)
#@gimp : Dilate = int(0,0,48)
#@gimp : Deform / deform = float(0,0,5)
#@gimp : Noise = float(0,0,100)
#@gimp : Shadow = bool(0)
#@gimp : X-shadow = float(0.5,-5,5)
#@gimp : Y-shadow = float(0.5,-5,5)
#@gimp : Smoothness shadow = float(1.8,0,5)
#@gimp : Curvature shadow = float(0,0,1)
#@gimp : Alpha channel = bool(0)
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/05</i>.</small>")
samj_en_Lignes_Epaisseur_Variable :
-samj_Lignes_Epaisseur_Variable $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25
#
#
#@gimp Lissajous : gimp_lissajous, gimp_lissajous(1)
#@gimp : Resolution = int(4096,2,8192)
#@gimp : Sep = separator()
#@gimp : X-size = float(0.9,0,2)
#@gimp : Y-size = float(0.9,0,2)
#@gimp : Z-size = float(3,1,10)
#@gimp : Sep = separator()
#@gimp : X-multiplier = float(8,0,32)
#@gimp : Y-multiplier = float(7,0,32)
#@gimp : Z-multiplier = float(0,0,32)
#@gimp : Sep = separator()
#@gimp : X-offset = float(0,0,1)
#@gimp : Y-offset = float(0,0,1)
#@gimp : Z-offset = float(0,0,1)
#@gimp : Sep = separator()
#@gimp : X-angle = float(0,0,360)
#@gimp : Y-angle = float(0,0,360)
#@gimp : Z-angle = float(0,0,360)
#@gimp : Sep = separator()
#@gimp : Thickness = float(0,0,50)
#@gimp : Color = color(255,255,255,255)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>04/18/2011</i>.</small>")
gimp_lissajous :
-repeat @# -l[$>] -to_rgba
{w},{h}
-f3d {0.5*max(w,h)/tan($4*pi/360)}
-lissajous3d $1,$5,$8,$6,$9,$7,$10
-r3d[-1] 0,0,1,$13 -r3d[-1] 0,1,0,$12 -r3d[-1] 1,0,0,$11
-*3d[-1] {0.5*$2*@{-2,w}},{0.5*$3*@{-2,h}},{0.5*$4*max(@{-2,w},@{-2,h})}
-col3d[-1] 1 -j3d[-2] [-1],50%,50%,0,1,1,0,0 -rm[-1]
-distance[-1] 1 ->[-1] $14% -*[-2] [-1] -==[-1] 0
-r[-1] 100%,100%,1,4
-sh[-1] 0,0 -*[-1] $15 -rm[-1]
-sh[-1] 1,1 -*[-1] $16 -rm[-1]
-sh[-1] 2,2 -*[-1] $17 -rm[-1]
-sh[-1] 3,3 -*[-1] $18 -rm[-1]
-+[-2,-1]
-endl -done
#@gimp Mandelbrot-julia sets : gimp_mandelbrot, gimp_mandelbrot_preview
#@gimp : X-center = float(0,-2,2)
#@gimp : Y-center = float(0,-2,2)
#@gimp : Zoom = float(0,0,100)
#@gimp : Iterations = int(128,1,512)
#@gimp : Fractal set = choice(Mandelbrot, Julia)
#@gimp : X-seed (julia) = text("0.317")
#@gimp : Y-seed (julia) = text("0.03")
#@gimp : Color 1 = color(0,0,255)
#@gimp : Color 2 = color(0,255,0)
#@gimp : Color 3 = color(255,0,0)
#@gimp : Color 4 = color(255,0,255)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_mandelbrot :
(0^0^0) ($8^$9^$10) ($11^$12^$13) ($14^$15^$16) ($17^$18^$19)
-a[-4--1] x -r[-1] $4,1,1,3,3 -a[-2,-1] x -mv[-1] 0
-repeat {@#-1}
wh={w},{h} -rm[-1] $wh
-mandelbrot[-1] {$1-2/(1+$3)},{$2-2/(1+$3)},{$1+2/(1+$3)},{$2+2/(1+$3)},$4,$5,{if($5,$6,0)},{if($5,$7,0)}
-map[-1] [0]
-mv[-1] 1 -done -rm[0]
gimp_mandelbrot_preview :
-gimp_mandelbrot ${^0}
-line 0,50%,100%,50%,0.5,255
-line 50%,0,50%,100%,0.5,255
#@gimp Pappus chain : samj_en_Cercles_Tangents_Dans_Cercle, samj_en_Cercles_Tangents_Dans_Cercle(1)
#@gimp : Note = link("http://en.wikipedia.org/wiki/Pappus_chain","http://en.wikipedia.org/wiki/Pappus_chain")
#@gimp : Note = link("http://en.wikipedia.org/wiki/Steiner_chain","http://en.wikipedia.org/wiki/Steiner_chain")
#@gimp : Sep = separator(), note = note("<small>Rendering</small>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Radius outer circle a (>0 w%) (<0 h%) = float(50,-400,400)
#@gimp : Radius first circle b = float(40,0,99)
#@gimp : Tilt = float(0,0,360)
#@gimp : Contours = color(0,0,0,255)
#@gimp : Display contours = bool(1)
#@gimp : Outer circle a = color(127,127,127,127)
#@gimp : First circle b = color(255,0,0,127)
#@gimp : Circle c = color(0,255,0,127)
#@gimp : Circle d = color(0,0,255,127)
#@gimp : Circle e = color(255,0,255,127)
#@gimp : Circle f = color(255,255,0,127)
#@gimp : Circle g = color(0,255,255,127)
#@gimp : Circle h = color(192,128,64,127)
#@gimp : Circle i = color(64,192,128,127)
#@gimp : Circle j = color(128,64,192,127)
#@gimp : Circle k = color(192,64,128,127)
#@gimp : Random colors = bool(0)
#@gimp : Inversions = int(0,0,3)
#@gimp : Blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : Deform = float(0,0,5)
#@gimp : Noise = float(0,0,100)
#@gimp : Shadow = bool(0)
#@gimp : X-shadow = float(0.5,-5,5)
#@gimp : Y-shadow = float(0.5,-5,5)
#@gimp : Smoothness shadow = float(1.8,0,5)
#@gimp : Curvature shadow = float(0,0,1)
#@gimp : Shadow offset x = float(0,-20,20)
#@gimp : Shadow offset y = float(0,-20,20)
#@gimp : Alpha channel = bool(0))
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/08</i>.</small>")
samj_en_Cercles_Tangents_Dans_Cercle :
-samj_Cercles_Tangents_Dans_Cercle $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35,$36,$37,$38,$39,$40,$41,$42,$43,$44,$45,$46,$47,$48,$49,$50,$51,$52,$53,$54,$55,$56,$57,$58,$59,$60,$61,$62,$63,$64,$65,$66,$67,$68
#@gimp Pintograph : Pintograph_samj_en, Pintograph_samj_en(1)
#@gimp : Note = link("http://en.wikipedia.org/wiki/Pintograph")
#@gimp : Sep = separator(), note = note("<small>Center</small>")
#@gimp : Center x (%) = float(50,0,100)
#@gimp : Center y (%) = float(50,0,100)
#@gimp : Sep = separator(), note = note("<small>Pintograph</small>")
#@gimp : Pen (color) = color(192,128,64,255)
#@gimp : Pen (color variation) = choice("No change","Random colors","Poorly nuanced","Moderately nuanced","Highly nuanced")
#@gimp : Pen (dilate pixels) = int(0,0,32)
#@gimp : It\303\251rations = int(1000,2,30000)
#@gimp : Iterations = choice(0,"Iterations * 1","Iterations * 5 SLOW","Iterations * 10 VERY SLOW")
#@gimp : Time increment [*10000] = float(400,10,500)
#@gimp : Sep = separator(), note = note("<small>Amplitude</small>")
#@gimp : Amplitude 1 (>0 w) (<0 h) = float(150,-1000,1000)
#@gimp : Amplitude 2 (>0 w) (<0 h) = float(200,-1000,1000)
#@gimp : Amplitude 3 (>0 w) (<0 h) = float(200,-1000,1000)
#@gimp : Amplitude 4 (>0 w) (<0 h) = float(100,-1000,1000)
#@gimp : Sep = separator(), note = note("<small>Frequency</small>")
#@gimp : Frequency 1 = float(4.00,0,16)
#@gimp : Frequency 2 = float(4.05,0,16)
#@gimp : Frequency 3 = float(4.16,0,16)
#@gimp : Frequency 4 = float(4.32,0,16)
#@gimp : Sep = separator(), note = note("<small>Phase</small>")
#@gimp : Phase 1 = float(75,0,360)
#@gimp : Phase 2 = float(150,0,360)
#@gimp : Phase 3 = float(75,0,360)
#@gimp : Phase 4 = float(60,0,360)
#@gimp : Sep = separator(), note = note("<small>Distorsions</small>")
#@gimp : Blur = float(0,0,10)
#@gimp : Spread = float(0,0,10)
#@gimp : Deform = float(0,0,25)
#@gimp : Sep = separator(), note = note("<small>Blend</small>")
#@gimp : Mode = choice{1,"Add","Alpha","And","Average","Blue","Burn","Darken","Difference",
#@gimp : "Divide","Dodge","Edges","Exclusion","Freeze","Grain extract","Grain merge","Green","Hard light",
#@gimp : "Hard mix","Hue","Interpolation","Lighten","Lightness","Linear burn","Linear light","Luminance",
#@gimp : "Multiply","Negation","Or","Overlay","Pin light","Red","Reflect","Saturation",
#@gimp : "Shape Average","Shape Average0","Soft burn","Soft dodge","Soft light","Screen","Stamp","Subtract","Value",
#@gimp : "Vivid light","Xor"}
#@gimp : Opacity = float(1,0,1)
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/15</i>.</small>")
Pintograph_samj_en :
-Pintograph_samj $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28
#@gimp Quick copyright : gimp_quick_copyright, gimp_quick_copyright(0)
#@gimp : Text = text{"\251 G'MIC"}
#@gimp : Size = int(27,13,128)
#@gimp : Color = color(255,255,255,128)
#@gimp : Outline = int(1,0,4)
#@gimp : Position = choice(3,"Up-left","Up-right","Bottom-left","Bottom-right")
#@gimp : Offset = int(5,0,40)
#@gimp : Orientation = choice(1,"-90 deg.","0 deg.","+90 deg.","+180 deg.")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_quick_copyright :
-i[0] 0 -t[0] "$1",0,0,$2,1,$3,$4,$5 -autocrop[0] 0 -r[0] {@{0,w}+2*$7},{@{0,h}+2*$7},1,3,0,0,0.5,0.5
-i[1] 0 -t[1] "$1",0,0,$2,1,1 -autocrop[1] 0 -r[1] {@{1,w}+2*$7},{@{1,h}+2*$7},1,1,0,0,0.5,0.5 -dilate[1] {1+2*$7}
-rotate[0,1] {90*($10-1)}
-repeat {@#-2}
-if {$8==0} -j[-1] [0],$9,$9,0,0,{$6/255},[1]
-elif {$8==1} -j[-1] [0],{w-1-@{0,w}-$9},$9,0,0,{$6/255},[1]
-elif {$8==2} -j[-1] [0],$9,{h-1-@{0,h}-$9},0,0,{$6/255},[1]
-else -j[-1] [0],{w-1-@{0,w}-$9},{h-1-@{0,h}-$9},0,0,{$6/255},[1]
-endif
-mv[-1] 2 -done
-rm[0,1]
#@gimp Rainbow : gimp_rainbow, gimp_rainbow
#@gimp : Left position = float(80,0,100)
#@gimp : Right position = float(80,0,100)
#@gimp : Left slope = float(175,0,400)
#@gimp : Right slope = float(175,0,400)
#@gimp : Thinness = float(3,0.1,8)
#@gimp : Opacity = float(80,0,199)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_rainbow :
-repeat @# -l[$>]
100%,100% -spline[-1] 0,$1%,100,{-$3}%,100%,$2%,100,$4%,256,1,1
-flood[-1] 0,0,0,0,0,1,1 -flood[-1] {w-1},0,0,0,0,1,1
-distance[-1] 0 -c[-1] 0,255 -n[-1] 0,{$5*255}
-rainbow_lut --luminance[-1] -c[-1] 0,{min(100,200-$6)}% -n[-1] 0,255 -a[-2,-1] c
-map[-2] [-1] -rm[-1]
-if {$6<100} -sh[-1] 3,3 -*[-1] {$6/100} -rm[-1] -endif
-blend alpha
-endl -done
#@gimp Rotating circles : samj_en_Cercles_Qui_Tournent, samj_en_Cercles_Qui_Tournent(1)
#@gimp : Note = note("Rotating Circles")
#@gimp : Sep = separator(), note = note("<small>New Image</small>")
#@gimp : Dimension image = int(800,2,32768)
#@gimp : Background = color(255,255,255,255)
#@gimp : Sep = separator(), note = note("<small>Examples</small>")
#@gimp : Examples = choice(0,"No","A","B","C","D","E","F")
#@gimp : Sep = separator(), note = note("<small>Param. X</small>")
#@gimp : Cax = float(1,0.5,2)
#@gimp : Cbx = float(0.5,0.05,5)
#@gimp : Ccx = float(0.33,0.05,5)
#@gimp : Vbx = int(7,-50,50)
#@gimp : Vcx = int(17,-50,50)
#@gimp : Sep = separator(), note = note("<small>Param. Y</small>")
#@gimp : Cay = float(1,0.5,2)
#@gimp : Cby = float(0.5,0.05,5)
#@gimp : Ccy = float(0.33,0.05,5)
#@gimp : Vby = int(7,-50,50)
#@gimp : Vcy = int(17,-50,50)
#@gimp : Sep = separator(), note = note("<small>Rendering</small>")
#@gimp : Equality : param. x & param. y = bool(1)
#@gimp : Theta = int(10,1,5000)
#@gimp : Line = color(0,0,0,255)
#@gimp : Tilt = float(0,-360,360)
#@gimp : Random colors = bool(0)
#@gimp : Blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : Deform = float(0,0,5)
#@gimp : Noise = float(0,0,200)
#@gimp : Shadow = bool(0)
#@gimp : X-shadow = float(0.5,-5,5)
#@gimp : Y-shadow = float(0.5,-5,5)
#@gimp : Smoothness shadow = float(1.8,0,5)
#@gimp : Curvature shadow = float(0,0,1)
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/05</i>.</small>")
samj_en_Cercles_Qui_Tournent :
-samj_Cercles_Qui_Tournent $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33
#@gimp Shade bobs : gimp_shadebobs, gimp_shadebobs
#@gimp : Note = note("<small>Bobs parameters :</small>")
#@gimp : Density = int(50,1,200)
#@gimp : Radius = int(5,1,100)
#@gimp : Duration = int(200,1,500)
#@gimp : Velocity = float(1,0,10)
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Curve parameters :</small>")
#@gimp : Rx = float(-1,-3,3)
#@gimp : Ry = float(2,-3,3)
#@gimp : Rz = float(1,-3,3)
#@gimp : Rt = float(0.8,-3,3)
#@gimp : Rcx = float(0,-3,3)
#@gimp : Colormap = choice(8,"Grayscale","Standard","HSV","Lines","Hot","Cool","Jet","Flag","Cube")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>04/18/2012</i>.</small>")
gimp_shadebobs :
-channels 0 -f 0
-repeat @# -l[$>]
t=0
-repeat $3
-repeat $1
r={$6+$5*cos(6*$7*$t)+(1-$5)*sin(6*$8*$t)}
a={(360*sin($7*$t)+30*$6*$>)*pi/180}
ax={2*$>*pi/$1+$t}
cx={(1+$9*cos($ax)+$r*cos($a))*w/2}
cy={(1+$9*sin($ax)+$r*sin($a))*h/2}
-ellipse[-1] $cx,$cy,$2%,$2%,0,-1,1
-done
t={$t+$4/100}
-done
-endl -done
-and 255 -if $10 -map {$10-1} -endif
#@gimp Sierpinski triangle : gimp_sierpinski, gimp_sierpinski(1)
#@gimp : Recursions = int(6,0,10)
#@gimp : 1st x-coord = float(50,0,100)
#@gimp : 1st y-coord = float(0,0,100)
#@gimp : 2nd x-coord = float(0,0,100)
#@gimp : 2nd y-coord = float(100,0,100)
#@gimp : 3rd x-coord = float(100,0,100)
#@gimp : 3rd y-coord = float(100,0,100)
#@gimp : Color = color(128,128,128)
#@gimp : Opacity = float(1,0,1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_sierpinski :
-repeat @# -l[$>] -split_opacity -l[0]
100%,100% -sierpinski[-1] ${1-7}
--fc[-2] $8,$9,$10 -j[0] [-1],0,0,0,0,$11,[-2],255 -rm[-2,-1]
-endl -a c -endl -done
#@gimp Simple geometric shapes : samj_en_Formes_Geometriques_Simples, samj_en_Formes_Geometriques_Simples(0)
#@gimp : Sep = separator(), note = note("<span foreground="black">Simple Geometric Shapes</span>")
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Effect</small></span>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : External color = color(127,127,127,127)
#@gimp : Interior color = color(255,255,0,255)
#@gimp : Color contour = color(0,0,255,255)
#@gimp : Forme / shape = choice(5,"Joined polygon Dimension 1","Joined polygon Dimension 2","Circle / Ellipse","Star Dimension 1","Star Dimension 2","Polygon Star Dimension 1","Polygon Star Dimension 2")
#@gimp : Dimension 1  (% width) = float(40,0,400)
#@gimp : Dimension 2  (% height) = float(40,0,400)
#@gimp : Number of sides = int(4,3,26)
#@gimp : Tilt = float(0,0,120)
#@gimp : Dilate = int(0,0,48)
#@gimp : Blend = bool(1)
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/09</i>.</small>")
samj_en_Formes_Geometriques_Simples :
-samj_Formes_Geometriques_Simples $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21
#@gimp Snowflake : gimp_snowflake, gimp_snowflake_preview(1)
#@gimp : Recursions = int(3,0,5)
#@gimp : 1st x-coord = float(20,0,100)
#@gimp : 1st y-coord = float(70,0,100)
#@gimp : 2nd x-coord = float(80,0,100)
#@gimp : 2nd y-coord = float(70,0,100)
#@gimp : 3rd x-coord = float(50,0,100)
#@gimp : 3rd y-coord = float(10,0,100)
#@gimp : Opacity = float(1,0,1)
#@gimp : Color = color(128,128,128)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_snowflake :
-repeat @# -l[$>] -split_opacity -l[0]
-snowflake ${1-11}
-endl -a c -endl -done
gimp_snowflake_preview :
-gimp_snowflake $*
-polygon 3,$2%,$3%,$4%,$5%,$6%,$7%,0.7,0xF0F0F0F0,255,255,255,255
-polygon 3,$2%,$3%,$4%,$5%,$6%,$7%,0.7,0x0F0F0F0F,0,0,0,255
-circle $2%,$3%,5,0.7,0,0,0,255 -circle $2%,$3%,3,1,255,0,0,255
-circle $4%,$5%,5,0.7,0,0,0,255 -circle $4%,$5%,3,1,0,255,0,255
-circle $6%,$7%,5,0.7,0,0,0,255 -circle $6%,$7%,3,1,0,0,255,255
#@gimp Snowflake en : samj_en_Flocon_De_Neige, samj_en_Flocon_De_Neige(1)
#@gimp : Note = note("<small>Ah! comme la neige a neig&#233;! <i>Soir d'hiver / &#278;mile Nelligan</i></small>")
#@gimp : Sep = separator(), note = note("<small>Rendering</small>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Rays = int(6,3,12)
#@gimp : Radius outer circle a (>0 w%) (<0 h%) = float(50,-400,400)
#@gimp : Radius middle circle = float(40,1,100)
#@gimp : Tilt = float(0,0,360)
#@gimp : Contours recursion = int(3,0,5)
#@gimp : Contours = color(192,192,192)
#@gimp : Opacity contours = float(1,0,1)
#@gimp : Display contours = choice(0,"Non / No","Contours + Flocon/Snowflake","Contours")
#@gimp : Snowflake recursion = int(3,0,5)
#@gimp : Snowflake = color(255,255,255)
#@gimp : Opacity snowflake = float(0.7,0,1)
#@gimp : Type snowflake = choice(0,"A","B","C","A2","B2","C2")
#@gimp : Random colors = bool(0)
#@gimp : Inversions = int(0,0,3)
#@gimp : Blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : Deform = float(0,0,5)
#@gimp : Noise = float(0,0,100)
#@gimp : Shadow = bool(0)
#@gimp : X-shadow = float(0.5,-5,5)
#@gimp : Y-shadow = float(0.5,-5,5)
#@gimp : Smoothness shadow = float(1.8,0,5)
#@gimp : Curvature shadow = float(0,0,1)
#@gimp : Shadow offset x = float(0,-20,20)
#@gimp : Shadow offset y = float(0,-20,20)
#@gimp : Alpha channel = bool(0))
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2014/04/24</i>.</small>")
samj_en_Flocon_De_Neige :
-samj_Flocon_De_Neige $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32
#@gimp Spiral : mathmap_spiral, mathmap_spiral
#@gimp : Rotations = float(5,0,20)
#@gimp : Time = float(0,0,1)
mathmap_spiral:
q="sin(rmath*$1*pi*2-amath+$2*2*pi)*0.5+0.5"
-mathmap_grayColor $q
mathmap_xy:
-e[^-1] "mathmap xy: fonction with formulas : "$1" and "$2"."
-v -
-repeat @# -local[@{>,-1}]
{w},{h},1,1 [-1] -reverse
-fill[0] "H=2*h/max(w,h);W=2*w/max(w,h);x0=(w-1)/2+1e-10; y0=(h-1)/2; xmath=(x-x0)*W/w;  ymath=-(y-y0)*H/h; ($1)*w/W+x0"
-fill[1] "H=2*h/max(w,h);W=2*w/max(w,h);x0=(w-1)/2+1e-10; y0=(h-1)/2; xmath=(x-x0)*W/w;  ymath=-(y-y0)*H/h; -($2)*h/H+y0"
-a[0,1] c
-warp[-1] [0],0,1,0
-k[-1]
-endlocal -done
-v +
mathmap_ra:
-e[^-1] "mathmap ra: fonction with formulas : "$1" and "$2"."
-v -
-repeat @# -local[@{>,-1}]
{w},{h},1,1 [-1] -reverse
-fill[0] "x0=(w-1)/2+1e-10; y0=(h-1)/2; rmath=((x-x0)^2+(y-y0)^2)^0.5*2/w; amath=(atan(-(y-y0)/(x-x0))+pi/2*(sign(x-x0)-1))%(2*pi); x0+($1)*x0*cos($2)"
-fill[1] "x0=(w-1)/2+1e-10; y0=(h-1)/2; rmath=((x-x0)^2+(y-y0)^2)^0.5*2/w; amath=(atan(-(y-y0)/(x-x0))+pi/2*(sign(x-x0)-1))%(2*pi); y0-($1)*x0*sin($2)"
-a[0,1] c
-warp[-1] [0],0,1,0
-k[-1]
-endlocal -done
-v +
mathmap_grayColor:
-e[^-1] "mathmap grayColor: fonction with formulas : "$1"."
-v -
-repeat @# -local[@{>,-1}]
-resize 100%,100%,1,1
-fill "H=2*h/max(w,h);W=2*w/max(w,h);x0=(w-1)/2+1e-10; y0=(h-1)/2; rmath=((x-x0)^2+(y-y0)^2)^0.5*2/w; amath=(atan(-(y-y0)/(x-x0))+pi/2*(sign(x-x0)-1))%(2*pi); ($1)"
-n 0,255 -to_rgba
-endlocal -done
-v +
#@gimp Spirograph : Spirographe_samj_en, Spirographe_samj_en(1)
#@gimp : Note = link("http://en.wikipedia.org/wiki/Spirograph")
#@gimp : Sep = separator(), note = note("<small>Center</small>")
#@gimp : Center x (%) = float(50,0,100)
#@gimp : Center y (%) = float(50,0,100)
#@gimp : Sep = separator(), note = note("<small>Spirographe</small>")
#@gimp : Radius r (>0 w) (<0 h) = float(200,-500,500)
#@gimp : Radius r (>0 w) (<0 h) = float(50,-500,500)
#@gimp : Pen (position) (>0 w) (<0 h) = float(150,-500,500)
#@gimp : Pen (color) = color(192,128,64,255)
#@gimp : Pen (color variation) = choice("No change","Random colors","Poorly nuanced","Moderately nuanced","Highly nuanced")
#@gimp : Pen (dilate pixels) = int(0,0,32)
#@gimp : Number of turns = float(3,0.01,20)
#@gimp : Iterations = choice(0,"Turns * 1","Turns * 10 SLOW","Turns * 100 VERY SLOW")
#@gimp : Angular increment (degr\303\251s) = float(1,1,360)
#@gimp : Divide = choice(0,"Angular increment / 1","Angular increment /10 SLOW","Angular increment /100 VERY SLOW")
#@gimp : Rendering = choice("Formula 1","Formula 2","Formula 3","Formula 4","Formula 5","Formula 6","Formula 7","Formula 8")
#@gimp : Points (radius) = int(0,0,32)
#@gimp : Points (color) = color(255,0,0,255)
#@gimp : Lines (thickness) = int(0,0,32)
#@gimp : Lines (color) = color(255,255,0,255)
#@gimp : Sep = separator(), note = note("<small>Distorsions</small>")
#@gimp : Blur = float(0,0,10)
#@gimp : Spread = float(0,0,10)
#@gimp : Deform = float(0,0,25)
#@gimp : Sep = separator(), note = note("<small>Blend</small>")
#@gimp : Mode = choice{1,"Add","Alpha","And","Average","Blue","Burn","Darken","Difference",
#@gimp : "Divide","Dodge","Edges","Exclusion","Freeze","Grain extract","Grain merge","Green","Hard light",
#@gimp : "Hard mix","Hue","Interpolation","Lighten","Lightness","Linear burn","Linear light","Luminance",
#@gimp : "Multiply","Negation","Or","Overlay","Pin light","Red","Reflect","Saturation",
#@gimp : "Shape Average","Shape Average0","Soft burn","Soft dodge","Soft light","Screen","Stamp","Subtract","Value",
#@gimp : "Vivid light","Xor"}
#@gimp : Opacity = float(1,0,1)
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/15</i>.</small>")
Spirographe_samj_en :
-Spirographe_samj $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31
#@gimp Straight lines : samj_en_Des_Lignes_002, samj_en_Des_Lignes_002(1)
#@gimp : Sep = separator(), note = note("<small>Straight Lines</small>")
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Lines parameters</small></span>")
#@gimp : Number of lines = int(100,1,4096)
#@gimp : Random colors = bool(0)
#@gimp : Gray = bool(0)
#@gimp : Color = color(192,128,64,255)
#@gimp : Symmetry = int(0,0,3)
#@gimp : Effect = choice(0,"1","2","3","4","5","6","7","8","9","10","11","12")
#@gimp : Extend = float(1,1,10)
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Effect 12</small></span>")
#@gimp : Origine x (% w) = float(50,-400,400)
#@gimp : Origine y (% h) = float(50,-400,400)
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Distorsions</small></span>")
#@gimp : Blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : Deform = float(0,0,5)
#@gimp : Noise = float(0,0,100)
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Blend</small></span>")
#@gimp : Blend = bool(1)
#@gimp : Sep = separator(), note = note("<small>samj - Update : <i>2015/03/09</i>.</small>")
samj_en_Des_Lignes_002 :
-samj_Des_Lignes_002 $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17
#@gimp Superformula : gimp_superformula, gimp_superformula(1)
#@gimp : Resolution = int(4096,2,8192)
#@gimp : Sep = separator()
#@gimp : X-size = float(0.9,0,2)
#@gimp : Y-size = float(0.9,0,2)
#@gimp : Sep = separator()
#@gimp : M = int(8,1,32)
#@gimp : N1 = float(1,-32,32)
#@gimp : N2 = float(5,-32,32)
#@gimp : N3 = float(8,-32,32)
#@gimp : Sep = separator()
#@gimp : X-angle = float(0,0,360)
#@gimp : Y-angle = float(0,0,360)
#@gimp : Z-angle = float(0,0,360)
#@gimp : Sep = separator()
#@gimp : Thickness = float(3,0,50)
#@gimp : Color = color(128,255,128,255)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>04/18/2011</i>.</small>")
gimp_superformula :
-repeat @# -l[$>] -to_rgba
{w},{h}
-f3d {0.5*max(w,h)/tan($4*pi/360)}
-superformula3d $1,${4-7}
-r3d[-1] 0,0,1,$10 -r3d[-1] 0,1,0,$9 -r3d[-1] 1,0,0,$8
-*3d[-1] {0.5*$2*@{-2,w}},{0.5*$3*@{-2,h}}
-col3d[-1] 1 -j3d[-2] [-1],50%,50%,0,1,1,0,0 -rm[-1]
-distance[-1] 1 ->[-1] $11% -*[-2] [-1] -==[-1] 0
-r[-1] 100%,100%,1,4
-sh[-1] 0,0 -*[-1] $12 -rm[-1]
-sh[-1] 1,1 -*[-1] $13 -rm[-1]
-sh[-1] 2,2 -*[-1] $14 -rm[-1]
-sh[-1] 3,3 -*[-1] $15 -rm[-1]
-+[-2,-1]
-endl -done
gimp_animate_preview : -skip ${4=1},${5=0},${6=$5}
-repeat @#
-if $5 width=$5 -else width={w} -endif
-if $6 height=$6 -else height={h} -endif
-if $4 -s[-1] x,2 -else [-1] -endif
-$1[-2] $2 -$1[-1] $3
-r[-2,-1] {max(w,@{-2,w})},{max(h,@{-2,h})},1,100%,3
-if {!$4} -columns[-2] 0,50% -columns[-1] 50%,100% -endif
-a[-2,-1] x -r[-1] $width,$height,1,100%,2 -drgba[-1]
-line[-1] 50%,0,50%,100%,1,0,0,0,255
-text_outline[-1] "Start",3,-1,13,2,1,255 -text_outline[-1] "End",{w-24},{h-18},13,2,1,255
-mv[-1] 0 -done
#@gimp _
#@gimp <b>Repair</b>
#@gimp Banding denoise : banding_denoise, banding_denoise_preview(0)
#@gimp : V cutoff = float(5,0,50)
#@gimp : H cutoff = float(5,0,50)
#@gimp : Space = float(5,0,20)
#@gimp : Value = float(10,0,100)
#@gimp : Show difference = bool(0)
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author : <i>Iain Fergusson</i>.</small>")
banding_denoise:
-repeat 2 --bilateral[-1] $3,$4 -keep[0,-1] -done
--compose_grainextract[0,1]
-fftpolar[-1]
-polygon[-2] 4,0,{(h/2)+1},{50-$1}%,{(h/2)+1},{50-$1}%,{(h/2)-1},0,{(h/2)-1}
-polygon[-2] 4,{50+$1}%,{(h/2)+1},{w},{(h/2)+1},{w},{(h/2)-1},{50+$1}%,{(h/2)-1}
-polygon[-2] 4,{(w/2)+1},0,{(w/2)+1},{50-$2}%,{(w/2)-1},{50-$2}%,{(w/2)-1},0
-polygon[-2] 4,{(w/2)-1},{h},{(w/2)+1},{h},{(w/2)+1},{50+$2}%,{(w/2)-1},{50+$2}%
-ifftpolar[-1,-2]
-compose_grainmerge[1,2]
-keep[-1]
banding_denoise_preview:
-if {$5==0}
-banding_denoise ${1--1}
-else
--banding_denoise ${1--1}
-compose_grainextract[0,1]
--[-1] 128 -*[-1] 5 -+[-1] 128
-endif
#@gimp Bayer reconstruction : bayer2rgb, gimp_no_preview
#@gimp : G/m smoothness = _float(6,0,20)
#@gimp : R/b smoothness (principal) = _float(6,0,20)
#@gimp : R/b smoothness (secondary) = _float(4,0,20)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp Deinterlace : deinterlace, gimp_deinterlace_preview(0)
#@gimp : Algorithm = choice("Standard","Motion-compensated")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_deinterlace :
-deinterlace 0 -skip ${^0}
gimp_deinterlace_preview :
-gimp_split_preview "-gimp_deinterlace $*",$-1
#@gimp Despeckle : gcd_despeckle, gcd_despeckle(3)
#@gimp : Note = note("<i>Remove small dots and specks</i>"), sep = separator()
#@gimp : Tolerance = int(20,0,50)
#@gimp : Max area = int(10,0,100)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.   Latest update : <i>2013/02/01</i>.</small>")
#@gimp : Note = note("\n<small><b><u>Notes</u></b></small>")
#@gimp : Note = note("<small>Set max area to 0 for no area size limit.</small>")
gcd_despeckle : -skip ${1=15},${2=30}
-repeat @# -l[$>]
ma={if(!$2,w*h,$2)}
--label[-1] $1,1 nb=@{-1,1+iM}
--histogram[-1] $nb,0,{$nb-1}
-map[-2] [-1] -rm[-1]
-le[-1] $ma -*[-1] 255
-inpaint[-2] [-1] -rm[-1]
-endl -done
#@gimp Iain's fast denoise p : iain_fast_denoise_p,iain_fast_denoise_p_preview(0)
#@gimp : Luma = float(0,0,3)
#@gimp : Chroma = float(0,0,3)
#@gimp : Gamma = float (1,.5,3)
#@gimp : Despeckle = float(0,0,1)
#@gimp : Dither output = bool(0)
#@gimp : Preview shows = choice (0,"Normal Output","Luma Noise",  "Chroma Noise")
#@gimp : Sep = separator ()
#@gimp : Parallel processing = choice(1,"Off","Auto")
#@gimp : Sep = separator()
#@gimp : Note = note("This noise reduction filter is designed for speed, and some quality has been sacrificed.")
#@gimp : Sep = separator ()
#@gimp : Note = note("<small>Author: Iain Fergusson</small>")
#@gimp : Note = note("<small>Update 26 Oct 2013 - parallel processing</small>")
#@gimp : Note = note("<small>Released 22 Feb 2013</small>")
iain_fast_denoise_p:
-tic
-if $7
-apply_parallel_overlap "-iain_fast_denoise ${1--1}",64,0
-else
-iain_fast_denoise ${1--1}
-endif
-toc
iain_fast_denoise:
-repeat @# -l[$>] -split_opacity -l[0]
fastluma1={$1*5000}
fastluma2={$fastluma1*.9}
fastluma3={$fastluma1*.65}
fastluma4={$fastluma1*.44}
fastchroma1={$2*5000}
fastchroma2=$fastchroma1
fastchroma3={$fastchroma2/2}
fastchroma4={$fastchroma3/2}
despeckle_threshold={($4/25)*100000}
-if {$3!=1}
scale={255*1000}
ex={$3}
pt1x={$scale*0.025}
pt2x={$scale*0.05}
pt3x={$scale*0.075}
pt4x={$scale*0.1}
pt5x={$scale*0.125}
pt6x={$scale*0.15}
pt7x={$scale*0.175}
pt8x={$scale*0.2}
pt9x={$scale*0.225}
pt10x={$scale*0.25}
pt11x={$scale*0.275}
pt12x={$scale*0.3}
pt13x={$scale*0.325}
pt14x={$scale*0.35}
pt15x={$scale*0.375}
pt16x={$scale*0.4}
pt17x={$scale*0.425}
pt18x={$scale*0.45}
pt19x={$scale*0.475}
pt20x={$scale*0.5}
pt21x={$scale*0.525}
pt22x={$scale*0.55}
pt23x={$scale*0.575}
pt24x={$scale*0.6}
pt25x={$scale*0.625}
pt26x={$scale*0.65}
pt27x={$scale*0.675}
pt28x={$scale*0.7}
pt29x={$scale*0.725}
pt30x={$scale*0.75}
pt31x={$scale*0.775}
pt32x={$scale*0.8}
pt33x={$scale*0.825}
pt34x={$scale*0.85}
pt35x={$scale*0.875}
pt36x={$scale*0.9}
pt37x={$scale*0.925}
pt38x={$scale*0.95}
pt39x={$scale*0.975}
pt40x={$scale*1}
pt1y={(0.025^$ex)*$scale}
pt2y={(0.05^$ex)*$scale}
pt3y={(0.075^$ex)*$scale}
pt4y={(0.1^$ex)*$scale}
pt5y={(0.125^$ex)*$scale}
pt6y={(0.15^$ex)*$scale}
pt7y={(0.175^$ex)*$scale}
pt8y={(0.2^$ex)*$scale}
pt9y={(0.225^$ex)*$scale}
pt10y={(0.25^$ex)*$scale}
pt11y={(0.275^$ex)*$scale}
pt12y={(0.3^$ex)*$scale}
pt13y={(0.325^$ex)*$scale}
pt14y={(0.35^$ex)*$scale}
pt15y={(0.375^$ex)*$scale}
pt16y={(0.4^$ex)*$scale}
pt17y={(0.425^$ex)*$scale}
pt18y={(0.45^$ex)*$scale}
pt19y={(0.475^$ex)*$scale}
pt20y={(0.5^$ex)*$scale}
pt21y={(0.525^$ex)*$scale}
pt22y={(0.55^$ex)*$scale}
pt23y={(0.575^$ex)*$scale}
pt24y={(0.6^$ex)*$scale}
pt25y={(0.625^$ex)*$scale}
pt26y={(0.65^$ex)*$scale}
pt27y={(0.675^$ex)*$scale}
pt28y={(0.7^$ex)*$scale}
pt29y={(0.725^$ex)*$scale}
pt30y={(0.75^$ex)*$scale}
pt31y={(0.775^$ex)*$scale}
pt32y={(0.8^$ex)*$scale}
pt33y={(0.825^$ex)*$scale}
pt34y={(0.85^$ex)*$scale}
pt35y={(0.875^$ex)*$scale}
pt36y={(0.9^$ex)*$scale}
pt37y={(0.925^$ex)*$scale}
pt38y={(0.95^$ex)*$scale}
pt39y={(0.975^$ex)*$scale}
pt40y={(1^$ex)*$scale}
-endif
interpolation=1
-tic
-to_rgb
-mul[0] 1000
-if {$3!=1}
-apply_curve[0] 0,0,0,$pt1x,$pt1y,$pt2x,$pt2y,$pt3x,$pt3y,$pt4x,$pt4y,$pt5x,$pt5y,$pt6x,$pt6y,$pt7x,$pt7y,$pt8x,$pt8y,$pt9x,$pt9y,$pt10x,$pt10y,$pt11x,$pt11y,$pt12x,$pt12y,$pt13x,$pt13y,$pt14x,$pt14y,$pt15x,$pt15y,$pt16x,$pt16y,$pt17x,$pt17y,$pt18x,$pt18y,$pt19x,$pt19y,$pt20x,$pt20y,$pt21x,$pt21y,$pt22x,$pt22y,$pt23x,$pt23y,$pt24x,$pt24y,$pt25x,$pt25y,$pt26x,$pt26y,$pt27x,$pt27y,$pt28x,$pt28y,$pt29x,$pt29y,$pt30x,$pt30y,$pt31x,$pt31y,$pt32x,$pt32y,$pt33x,$pt33y,$pt34x,$pt34y,$pt35x,$pt35y,$pt36x,$pt36y,$pt37x,$pt37y,$pt38x,$pt38y,$pt39x,$pt39y,$pt40x,$pt40y
-endif
redmul=.299
greenmul=.587
bluemul=.114
-to_rgb[0]
--split[0] c
-mul[1] $redmul
-mul[2] $greenmul
-mul[3] $bluemul
-add[1-3]
-split[0] c
-name[0] red
-name[1] green
-name[2] blue
-name[3] luma
--sub[blue] [luma]
-name[-1] cb
--sub[red] [luma]
-name[-1] cr
-keep[luma,cb,cr]
-if {$despeckle_threshold>0}
-iain_fast_despeckle[0] {1-$despeckle_threshold}
-endif
-if {$1>0}
-iain_fast_denoise_main[0] {$fastluma1},{$fastluma2},{$fastluma3},{$fastluma4},$interpolation
-endif
-if {$2>0}
-iain_fast_denoise_main[1] {$fastchroma1},{$fastchroma2},{$fastchroma3},{$fastchroma4},$interpolation
-iain_fast_denoise_main[2] {$fastchroma1},{$fastchroma2},{$fastchroma3},{$fastchroma4},$interpolation
-endif
-name[0] luma
-name[1] cb
-name[2] cr
--add[cb] [luma]
-name[-1] blueout
--add[cr] [luma]
-name[-1] redout
-remove[1,2]
--mul[redout] $redmul
--mul[blueout] $bluemul
-sub[luma] [-1]
-sub[luma] [-2]
-div[luma] $greenmul
-remove[-1,-2]
-move[2] 0
-append c
-if {$5==1}
100%,100%,1,1,0
-noise[-1] 0.7,0
--laplacian[0]
-threshold[-1] 4
-dilate[-1] 3
-mul[-1] -1
-add[-1] 1
-mul[-2] [-1]
-remove[-1]
-add
-endif
-if {$3!=1}
scale={255*1000}
ex={1/$3}
pt1y={(0.025^$ex)*$scale}
pt2y={(0.05^$ex)*$scale}
pt3y={(0.075^$ex)*$scale}
pt4y={(0.1^$ex)*$scale}
pt5y={(0.125^$ex)*$scale}
pt6y={(0.15^$ex)*$scale}
pt7y={(0.175^$ex)*$scale}
pt8y={(0.2^$ex)*$scale}
pt9y={(0.225^$ex)*$scale}
pt10y={(0.25^$ex)*$scale}
pt11y={(0.275^$ex)*$scale}
pt12y={(0.3^$ex)*$scale}
pt13y={(0.325^$ex)*$scale}
pt14y={(0.35^$ex)*$scale}
pt15y={(0.375^$ex)*$scale}
pt16y={(0.4^$ex)*$scale}
pt17y={(0.425^$ex)*$scale}
pt18y={(0.45^$ex)*$scale}
pt19y={(0.475^$ex)*$scale}
pt20y={(0.5^$ex)*$scale}
pt21y={(0.525^$ex)*$scale}
pt22y={(0.55^$ex)*$scale}
pt23y={(0.575^$ex)*$scale}
pt24y={(0.6^$ex)*$scale}
pt25y={(0.625^$ex)*$scale}
pt26y={(0.65^$ex)*$scale}
pt27y={(0.675^$ex)*$scale}
pt28y={(0.7^$ex)*$scale}
pt29y={(0.725^$ex)*$scale}
pt30y={(0.75^$ex)*$scale}
pt31y={(0.775^$ex)*$scale}
pt32y={(0.8^$ex)*$scale}
pt33y={(0.825^$ex)*$scale}
pt34y={(0.85^$ex)*$scale}
pt35y={(0.875^$ex)*$scale}
pt36y={(0.9^$ex)*$scale}
pt37y={(0.925^$ex)*$scale}
pt38y={(0.95^$ex)*$scale}
pt39y={(0.975^$ex)*$scale}
pt40y={(1^$ex)*$scale}
-apply_curve[0] 0,0,0,$pt1x,$pt1y,$pt2x,$pt2y,$pt3x,$pt3y,$pt4x,$pt4y,$pt5x,$pt5y,$pt6x,$pt6y,$pt7x,$pt7y,$pt8x,$pt8y,$pt9x,$pt9y,$pt10x,$pt10y,$pt11x,$pt11y,$pt12x,$pt12y,$pt13x,$pt13y,$pt14x,$pt14y,$pt15x,$pt15y,$pt16x,$pt16y,$pt17x,$pt17y,$pt18x,$pt18y,$pt19x,$pt19y,$pt20x,$pt20y,$pt21x,$pt21y,$pt22x,$pt22y,$pt23x,$pt23y,$pt24x,$pt24y,$pt25x,$pt25y,$pt26x,$pt26y,$pt27x,$pt27y,$pt28x,$pt28y,$pt29x,$pt29y,$pt30x,$pt30y,$pt31x,$pt31y,$pt32x,$pt32y,$pt33x,$pt33y,$pt34x,$pt34y,$pt35x,$pt35y,$pt36x,$pt36y,$pt37x,$pt37y,$pt38x,$pt38y,$pt39x,$pt39y,$pt40x,$pt40y
-endif
-mul[0] 0.001
-c 0,255
-toc
-endl -a c -endl -done
fastblur:
(0.0579710145,0.1304347826,0.0579710145;0.1304347826,0.2463768116,0.1304347826;0.0579710145,0.1304347826,0.0579710145)
-convolve[0] [1]
-remove[-1]
iain_fast_despeckle:
(0,0.2,0;0.2,0.2,0.2;0,0.2,0)
--convolve[0] [1]
--sub[-1] [0]
-abs[-1]
--convolve[-1] [1]
-sub[-1] [-2]
-abs[-1]
-keep[0,2,-1]
-threshold[-1] $1
-mul[-1] 255
-append[1,2] c
-blend alpha
iain_fast_denoise_main:
cropwidth={w}
cropheight={h}
-resize[0] {w+(8-w%8)},{h+(8-h%8)},1,{s},0,1
width={w}
height={h}
--resize[0] 50%,50%,{d},{s},2
--resize[1] $width,$height,{d},{s},$5
-fastblur[-1]
-sub[0] [2]
-remove[2]
--resize[1] 50%,50%,{d},{s},2
--resize[2] {$width/2},{$height/2},{d},{s},$5
-fastblur[-1]
-sub[1] [3]
-remove[3]
--resize[2] 50%,50%,{d},{s},2
--resize[3] {$width/4},{$height/4},{d},{s},$5
-fastblur[-1]
-sub[2] [4]
-remove[4]
--resize[3] 50%,50%,{d},{s},2
--resize[4] {$width/8},{$height/8},{d},{s},$5
-fastblur[-1]
-sub[3] [5]
-remove[5]
-rmsthresh[0] $1
-rmsthresh[1] $2
-rmsthresh[2] $3
-rmsthresh[3] $4
-resize[-1] @{3,w},@{3,h},{d},{s},$5
-fastblur[-1]
-add[-2] [-1]
-remove[-1]
-resize[-1] @{2,w},@{2,h},{d},{s},$5
-fastblur[-1]
-add[-2] [-1]
-remove[-1]
-resize[-1] @{1,w},@{1,h},{d},{s},$5
-fastblur[-1]
-add[-2] [-1]
-remove[-1]
-resize[-1] @{0,w},@{0,h},{d},{s},$5
-fastblur[-1]
-add[-2] [-1]
-remove[-1]
-crop 0,0,{$cropwidth-1},{$cropheight-1}
rmsthresh:
--abs[0]
-fastblur[1]
-threshold[1] {$1}
-fastblur[1]
-mul[0] [1]
-keep[0]
iain_fast_denoise_p_preview:
-if {$-2==0}
-iain_fast_denoise ${1--3}
-endif
-if {$-2==1}
--iain_fast_denoise_p $1,0,1,$4,0,0,$7
-compose_grainextract
-sub 128
-mul 3
-add 128
-endif
-if {$-2==2}
--iain_fast_denoise_p 0,$2,1,$4,0,0,$7
-compose_grainextract
-sub 128
-mul 3
-add 128
-endif
#@gimp Iain's noise reduction : iain_iains_nr,iain_iains_nr_preview(0)
#@gimp : 1 luma nr = float (3,0,20)
#@gimp : 2 chroma nr = float (3,0,20)
#@gimp : 3 despeckle = int (1,0,4)
#@gimp : Note = note("       <small>Adjust noise reduction by tone</small>")
#@gimp : 4 highlights = float (0,-50000,50000)
#@gimp : 5 shadows = float (0,-32000,32000)
#@gimp : Sep = separator ()
#@gimp : Note = note("<b>Recover Details</b>")
#@gimp : 6 recover details = choice (0,"Do not Recover Details","Recover Details", "Recover Details as separate layer"))
#@gimp : 7 recovery amount = float(1,.1,10)
#@gimp : Note = note("       <small>Adjust detial recovery by size</small>")
#@gimp : 8 adjust fine details = float (0,-500,500)
#@gimp : 9 adjust medium details = float (0,-500,500)
#@gimp : 10 adjust large details = float (0,-500,500)
#@gimp : 11 detail emphasis = float (1.35,1,4)
#@gimp : Sep = separator ()
#@gimp : 12 sharpen edges = float (0,0,4)
#@gimp : Note = note("<b>Preview options</b>")
#@gimp : 13 preview shows = choice (0,"Normal Output","Luma Noise",  "Chroma Noise","Details"))
#@gimp : Sep = separator ()
#@gimp : Note = note("Author: Iain Fergusson - update 10 Jan 2013")
iain_iains_nr:
-repeat @# -l[$>] -split_opacity -l[0]
lnr=$1
cnr=$2
despek=$3
highs=$4
shadow=$5
recovery_choice=$6
detail_recovery={5000-($7*500)}
fast=1
fine_det=$8
med_det=$9
large_det=$10
det_emphasis=$11
sharp=$12
-to_rgb
-apply_gamma {1/1.3}
-mul 900
-apply_curve 1,0,0,32000,{32000-$shadow},160000,{160000-$shadow},256000,{256000-$highs-$shadow}
-div 2000
-iain_rgb2ycbcr
-split c
-if {$lnr>0}
-if {$recovery_choice==0}
-iains_nr_patchb[0] 10,$lnr,3,3,0,$fast,1,$despek,.5,.4,.2,0,1,1,2,0
-unsharp[0] .7,$sharp,0
-endif
-if {$recovery_choice==1}
--iains_nr_patchb[0] 10,$lnr,3,3,0,$fast,1,$despek,.5,.4,.2,0,1,1,2,0
--sub[0] [-1]
-add[-1] {128}
-remove[0]
-unsharp[2] .7,$sharp,0
-resize[-1] {w+48},{h+48},{d},{s},0,0,0,0
-resize[-1] {w+48},{h+48},{d},{s},0,0,1,1
-rectangle[-1] 0,0,100%,48,1,128
-rectangle[-1] 0,0,48,100%,1,128
-rectangle[-1] 0,100%,100%,{h-48},1,128
-rectangle[-1] {w-48},100%,100%,0,1,128
-iains_nr_fft_tile3[-1] {$detail_recovery},48,0,$fine_det,$med_det,$large_det,1,3
-crop[-1] 48,48,{w-49},{h-49}
-sub[-1] {128}
-mul[-1] $det_emphasis
-add[2] [-1]
-remove[-1]
-move[-1] 0
-endif
-if {$recovery_choice==2}
--iains_nr_patchb[0] 10,$lnr,3,3,0,$fast,1,$despek,.5,.4,.2,0,1,1,2,0
--sub[0] [-1]
-add[-1] {128}
-remove[0]
-unsharp[2] .7,$sharp,0
-resize[-1] {w+48},{h+48},{d},{s},0,0,0,0
-resize[-1] {w+48},{h+48},{d},{s},0,0,1,1
-rectangle[-1] 0,0,100%,48,1,128
-rectangle[-1] 0,0,48,100%,1,128
-rectangle[-1] 0,100%,100%,{h-48},1,128
-rectangle[-1] {w-48},100%,100%,0,1,128
-iains_nr_fft_tile3[-1] {$detail_recovery},48,0,$fine_det,$med_det,$large_det,1,3
-crop[-1] 48,48,{w-49},{h-49}
-sub[-1] 128
-mul[-1] $det_emphasis
-add[-1] 128
-move[-2] 0
-endif
-endif
-if {$cnr>0}
-add[1,2] 300
-iains_nr_patchb[1] 10,$cnr,3,3,0,1,1,4,.5,.4,.2,0,1,1,2,0
-iains_nr_patchb[2] 10,$cnr,3,3,0,1,1,4,.5,.4,.2,0,1,1,2,0
-sub[1,2] 300
-endif
-append[0,1,2] c
-iain_ycbcr2rgb[0]
-mul[0] 2000
-apply_curve[0] 1,0,0,{32000-$shadow},32000,{160000-$shadow},160000,{256000-$highs-$shadow},256000
-div[0] 900
-apply_gamma[0] 1.3
-c 0,255
-endl -a c -endl -done
iains_nr_med3stack16:
--max[0,1]
--min[0,1]
-keep[2,3,4]
--max[0,2]
--min[1,3]
-keep[-1]
iains_nr_med5stack16:
--min[0,1]
--max[0,1]
-remove[0,1]
--min[0,4]
--max[0,4]
-remove[0,4]
--min[0,4]
--max[0,4]
-remove[0,4]
--min[0,4]
--max[0,4]
-remove[0,4]
--min[0,1]
--max[0,1]
-remove[0,1]
--min[0,4]
--max[0,4]
-remove[0,4]
--min[0,4]
--max[0,4]
-remove[0,4]
--min[1,2]
--max[1,2]
-remove[1,2]
--max[1,4]
-keep[-1]
iains_nr_fft_tile3_fft:
--fftpolar[0]
100%,100%,1,1,1
-ellipse[-1] 50%,50%,50%,50%,0,1,$4
-ellipse[-1] 50%,50%,15%,15%,0,1,$5
-ellipse[-1] 50%,50%,5%,5%,0,1,$6
--add[1] [-1]
-threshold[-1] $1
-set[-1] 1,50%,50%
-mul[1] [-1]
--ifftpolar[1,2]
-remove[0,1,2]
-keep[-1]
iains_nr_fft_tile3_clean:
tc={round(w/$2)} tr={round(h/$2)}
-split_tiles $tc,$tr
-repeat @# -local[@{>,-1}]
-iains_nr_fft_tile3_fft[0--1] $1,$2,$3,$4,$5,$6
-endlocal -done
-append_tiles $tc,$tr
-c 0,255
iains_nr_fft_tile3:
--resize[0] {w+$2},{h+$2},1,1,0,1,1,1
-resize[-1] {w+$2},{h+$2},1,1,0,1,0,0
-iains_nr_fft_tile3_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] $2,$2,{w-$2-1},{h-$2-1}
-if {$8>2}
push={round($2*1.5)}
pull={$2-$push}
--resize[0] {w+$push},{h+$2},1,1,0,1,1,1
-resize[-1] {w+$pull},{h+$2},1,1,0,1,0,0
-iains_nr_fft_tile3_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] {$push},{$2},{w-$pull-1},{h-($2)-1}
--resize[0] {w+$2},{h+$push},1,1,0,1,1,1
-resize[-1] {w+$2},{h+$pull},1,1,0,1,0,0
-iains_nr_fft_tile3_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] $2,{$push},{w-$2-1},{h-$pull-1}
-endif
-if {$8>1}
dia1={round($2/3)}
dia2={$2-$dia1}
--resize[0] {w+$dia1},{h+$dia1},1,1,0,1,1,1
-resize[-1] {w+$dia2},{h+$dia2},1,1,0,1,0,0
-iains_nr_fft_tile3_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] {$dia1},{$dia1},{w-$dia2-1},{h-$dia2-1}
--resize[0] {w+$dia2},{h+$dia2},1,1,0,1,1,1
-resize[-1] {w+$dia1},{h+$dia1},1,1,0,1,0,0
-iains_nr_fft_tile3_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] {$dia2},{$dia2},{w-$dia1-1},{h-$dia1-1}
-endif
-remove[0]
-if {$8==3}
-iains_nr_med5stack16
-endif
-if {$8==2}
-iains_nr_med3stack16
-endif
iains_nr_patchb_smoothing:
-repeat $7 -denoise $1,$2,$3,$4,$5,$6 -done
iains_nr_patchb_2:
--resize[0] 50%,50%,1,{s},2
--iains_nr_patchb_smoothing[-1] $1,$2,$3,$4,$5,$6,$7,$8
--resize[1] @{0,w},@{0,h},1,{s},5
--sub[0] [3]
-resize[2] @{0,w},@{0,h},1,{s},5
--add[2] [4]
-keep[-1]
iains_nr_patchb_3:
--resize[0] 25%,25%,1,{s},2
--iains_nr_patchb_smoothing[-1] $1,$2,$3,$4,$5,$6,$7,$8
--resize[1] @{0,w},@{0,h},1,{s},5
--sub[0] [3]
-resize[2] @{0,w},@{0,h},1,{s},5
--add[2] [4]
-keep[-1]
iains_nr_patchb_4:
--resize[0] 12.5%,12.5%,1,{s},2
--iains_nr_patchb_smoothing[-1] $1,$2,$3,$4,$5,$6,$7,$8
--resize[1] @{0,w},@{0,h},1,{s},5
--sub[0] [3]
-resize[2] @{0,w},@{0,h},1,{s},5
--add[2] [4]
-keep[-1]
iains_nr_patchb_5:
--resize[0] 6.125%,6.125%,1,{s},2
--iains_nr_patchb_smoothing[-1] $1,$2,$3,$4,$5,$6,$7,$8
--resize[1] @{0,w},@{0,h},1,{s},5
--sub[0] [3]
-resize[2] @{0,w},@{0,h},1,{s},5
--add[2] [4]
-keep[-1]
iains_nr_patchb:
-apply_gamma {1/$14}
-if {$8==1}
-hybrid_median[-1] 1,0,0
-endif
-if {$8==2}
-hybrid_median[-1] 3,0,0
-endif
-if {$8==3}
-median[-1] 3
-endif
-if {$8==4}
-median[-1] 3
-median[-1] 3
-median[-1] 3
-endif
-repeat $15
-if {$8<4}
-if {$13==1}
-iains_nr_patchb_smoothing[-1] $1,$2,$3,$4,$5,$6,$7,$8
-endif
-endif
-iains_nr_patchb_2 $1,{$2*$9},$3,$4,$5,$6,$7,$8
-iains_nr_patchb_3 $1,{$2*$10},$3,$4,$5,$6,$7,$8
-iains_nr_patchb_4 $1,{$2*$11},$3,$4,$5,$6,$7,$8
-iains_nr_patchb_5 $1,{$2*$12},$3,$4,$5,$6,$7,$8
-done
-apply_gamma $14
iain_rgb2ycbcr:
redmul=.299
greenmul=.587
bluemul=.114
-to_rgb[0]
--split[0] c
-mul[1] $redmul
-mul[2] $greenmul
-mul[3] $bluemul
-add[1-3]
-split[0] c
-name[0] red
-name[1] green
-name[2] blue
-name[3] luma
--sub[blue] [luma]
-name[-1] cb
--sub[red] [luma]
-name[-1] cr
-keep[luma,cb,cr]
-append[luma,cb,cr] c
iain_ycbcr2rgb:
redmul=.299
greenmul=.587
bluemul=.114
-split c
-name[0] luma
-name[1] cb
-name[2] cr
--add[cb] [luma]
-name[-1] blueout
--add[cr] [luma]
-name[-1] redout
-remove[1,2]
--mul[redout] $redmul
--mul[blueout] $bluemul
-sub[luma] [-1]
-sub[luma] [-2]
-div[luma] $greenmul
-remove[-1,-2]
-move[2] 0
-append c
iain_iains_nr_preview:
-if {$-1==0}
-iain_iains_nr ${1--2}
-endif
-if {$-1==1}
--iain_iains_nr $1,0,$3,$4,$5,$6,$7,$8,$9,$10,1.3,0
-compose_grainextract
-sub 128
-mul 3
-add 128
-endif
-if {$-1==2}
--iain_iains_nr 0,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,0
-compose_grainextract
-sub 128
-mul 3
-add 128
-endif
-if {$-1==3}
-iain_iains_nr $1,$2,$3,$4,$5,2,$7,$8,$9,$10,$11,0
-keep[-1]
-sub 128
-mul 3
-add 128
-endif
#@gimp Inpaint [diffusion] : gimp_inpaint_diffusion, gimp_inpaint_diffusion_preview(0)
#@gimp : Smooth inpaint = bool(true)
#@gimp : Global iterations = int(10,1,30)
#@gimp : Local iterations = int(10,1,30)
#@gimp : Time step = float(20,5,50)
#@gimp : Gradient smoothness = float(0.7,0,5)
#@gimp : Tensor smoothness = float(1.2,0,5)
#@gimp : Sep = separator()
#@gimp : Mask type = choice(1,"Opaque regions in top layer","Mask by color")
#@gimp : Note = note("<small>If <i>Mask by color</i> has been selected :</small>")
#@gimp : Mask color = color(255,0,0,255)
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Note:</b>
#@gimp : When <i>'Mask by color'</i> mode is selected, preview is likely to be inaccurate.
#@gimp : </small>")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_inpaint_diffusion :
-if $7
-repeat @# -l[$>]
--select_color 0,${8-11} -rv
-if $1 -inpaint_flow $2,$3,$4,$5%,$6% -c 0,255 -else -inpaint[1] [0] -endif
-rm[0]
-endl -done
-else
-if {@#==1} -return -endif
-to_a[0] -channels[0] 100% ->=[0] 50%
-if $1 -inpaint_flow $2,$3,$4,$5%,$6% -c 0,255 -else -inpaint[^0] [0] -endif
-to_a[0] -f[0] 0
-endif
gimp_inpaint_diffusion_preview :
-gimp_inpaint_diffusion ${^0}
-if {!$7" && "@#>1} -rm[0] -endif
#@gimp Inpaint [holes] : gimp_inpaint_holes, gimp_inpaint_holes(0)
#@gimp : Maximal area = float(4,1,512)
#@gimp : Tolerance = float(20,0,255)
#@gimp : Connectivity = choice(1,"Low","High")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>05/27/2014</i>.</small>")
gimp_inpaint_holes :
-inpaint_holes {$1^1.5},$2,$3
#@gimp Inpaint [patch-based] : gimp_inpaint_patch, gimp_no_preview
#@gimp : Patch size = int(7,1,64)
#@gimp : Lookup size = float(16,1,32)
#@gimp : Lookup factor = float(0.1,0,1)
#@gimp : Blend size = float(1.2,0,5)
#@gimp : Blend threshold = float(0,0,1)
#@gimp : Blend decay = float(0.05,0,0.5)
#@gimp : Blend scales = int(10,1,20)
#@gimp : Allow outer blending = bool(1)
#@gimp : Sep = separator()
#@gimp : Mask type = choice(1,"Opaque regions in top layer","Mask by color")
#@gimp : Note = note("<small>If <i>Mask by color</i> has been selected :</small>")
#@gimp : Mask color = color(255,0,0,255)
#@gimp : Sep = separator(), note = note("<small>A quick tutorial on how to use this filter can be found here:</small>")
#@gimp : Link = link("G'MIC Inpainting tutorial on Patrick David's blog.","http://blog.patdavid.net/2014/02/getting-around-in-gimp-gmic-inpainting.html")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>David Tschumperl&#233;</i> and <i>Maxime Daisy</i>.      Latest update: <i>03/25/2013</i>.</small>")
gimp_inpaint_patch :
-if $9
-repeat @# -l[$>]
--select_color 0,${10-13}
-inpaint[0] [1],$1,{$1*$2},$3,1,{$4*$1},${5-8}
-rm[1]
-endl -done
-else
-if {@#==1} -return -endif
-to_a[0] -channels[0] 100% ->=[0] 50%
-inpaint[^0] [0],$1,{$1*$2},$3,1,{$4*$1},${5-8}
-to_a[0] -f[0] 0
-endif
#@gimp Inpaint [solidify] : gimp_solidify, gimp_solidify_preview(0)
#@gimp : Interpolation type = choice("Linear","Morphological")
#@gimp : Sep = separator(), note = note("<small><b>For linear method only :</b></small>")
#@gimp : Smoothness = float(1.5,1,5)
#@gimp : Smoothness factor = float(1,1,1.2)
#@gimp : Precision = float(0.5,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small><b>Note:</b>
#@gimp : This filter replaces transparent regions by interpolated colors. It may take long to render!
#@gimp : </small>")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/01/2011</i>.</small>")
gimp_solidify :
-if $1 -solidify
-else -solidify_linear $2,$3,$4
-endif
gimp_solidify_preview :
-gimp_split_preview "-gimp_solidify $*",$-1
#@gimp Local similarity mask : local_similarity_mask, local_similarity_mask_preview(1)
#@gimp : Note = note("Select pixels at")
#@gimp : Centre h = float (50,0,100)
#@gimp : Centre v = float (50,0,100)
#@gimp : Note = note("With similarity")
#@gimp : Keep = int (50,0,255)
#@gimp : Reject = int (128,0,255)
#@gimp : Note = note("On these channels")
#@gimp : Channel(s) = choice(4,"RGB","Red","Green","Blue","Luminance","a-component","b-component","Hue","Saturation","Value","Lightness","[Cyan]MYK","C[Magenta]YK","CM[Yellow]K","CMY[Key]")
#@gimp : Fast = bool(1)
#@gimp : Sep = separator()
#@gimp : Note = note("This filter creates a mask based on pixels that are close to, and similar to, the selected pixel.")
#@gimp : Note = note("The <i>fast</i> option scales the image to half-size to do the calculations and gives a softer result in around one quarter of the time")
#@gimp : Note = note("Speed is also determined by the difference between <i>Keep</i> and <i>Reject</i> large differences will drastically slow down the filter.")
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author : <i>Iain Fergusson</i>.</small>")
local_similarity_mask:
-if {$6==1}
-resize 50%,50%,1,3,2
-endif
-to_rgb
-if {$5!=0}
-if {$5==1}  -split[0] c -keep[0] -endif
-if {$5==2}  -split[0] c -keep[1] -endif
-if {$5==3}  -split[0] c -keep[2] -endif
-if {$5==4} -luminance -endif
-if {$5==5} -rgb2lab[0] -split[0] c -keep[1] -endif
-if {$5==6} -rgb2lab[0] -split[0] c -keep[2] -endif
-if {$5==7} -rgb2hsv[0] -split[0] c -keep[0] -endif
-if {$5==8} -rgb2hsv[0] -split[0] c -keep[1] -endif
-if {$5==9} -rgb2hsv[0] -split[0] c -keep[2] -endif
-if {$5==10} -rgb2hsl[0] -split[0] c -keep[2] -endif
-if {$5==11} -rgb2cmyk[0] -split[0] c -keep[0] -endif
-if {$5==12} -rgb2cmyk[0] -split[0] c -keep[1] -endif
-if {$5==13} -rgb2cmyk[0] -split[0] c -keep[2] -endif
-if {$5==14} -rgb2cmyk[0] -split[0] c -keep[3] -endif
-endif
-n 0,255
-mul[0] 0.9
{w},{h},1,1,0
-repeat {$4-$3}
--flood[0] $1%,$2%,0,{$3+$>},0,1,255 -threshold[-1] 99%
-add[-1,-2]
-done
-keep[-1]
-n 0,255
-if {$6==1}
-resize 200%,200%,1,3,3
-endif
local_similarity_mask_preview:
-local_similarity_mask $1,$2,$3,$4,$5,0
-to_rgb
-line 100%,$2%,{$1+5}%,$2%,0.5,255,0,0
-line 0%,$2%,{$1-5}%,$2%,0.5,255,0,0
-line $1%,100%,$1%,{$2+5}%,0.5,255,0,0
-line $1%,0%,$1%,{$2-5}%,0.5,255,0,0
#@gimp Pixel denoise : iain_pixel_denoise_p, iain_pixel_denoise_p_preview(0)
#@gimp : Method = choice(2,"Old Method - slowest","Hybrid Median - medium speed softest output","Morphological - fastest sharpest output")
#@gimp : Sep = separator()
#@gimp : Iterations = int(1,1,10)
#@gimp : Channel(s) = choice(7,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator()
#@gimp : Preview shows = choice(0,"Output","Difference")
#@gimp : Sep = separator()
#@gimp : Parallel processing = choice(1,"Off","Auto")
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author : <i>Iain Fergusson</i>. </small>")
#@gimp : Note = note("<small>Update - 1 July 2014 - Added much faster Morphological method. Note: The iteration setting is ignored for this method. There is no change to the output for iterations greater than one.</small>")
#@gimp : Note = note("<small>Update - 1 December 2013 - Fixed some bugs.</small>")
#@gimp : Note = note("<small>Update - 20 October 2013 - Parallel Processing</small>")
#@gimp : Note = note("<small>Update - 8 March 2013 - Incorperated Hybrid Median into this filter and added a choice between the old method and hybrid median</small>")
createbc:
(0.5,0.5,0;0,0,0;0,0,0)
(0.5,0,0.5;0,0,0;0,0,0)
--convolve[0] [1]
--convolve[0] [2]
-keep[0,-1,-2]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbd:
(0.5,0,0;0,0,0.5;0,0,0)
(0.5,0,0;0,0,0;0,0,0.5)
--convolve[0] [1]
--convolve[0] [2]
-keep[0,-1,-2]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbe:
(0.5,0,0;0,0,0;0,0.5,0)
(0.5,0,0;0,0,0;0.5,0,0)
--convolve[0] [1]
--convolve[0] [2]
-keep[0,-1,-2]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbf:
(0.5,0,0;0.5,0,0;0,0,0)
(0,0.5,0.5;0,0,0;0,0,0)
--convolve[0] [1]
--convolve[0] [2]
-keep[0,-1,-2]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbg:
(0,0.5,0;0,0,0.5;0,0,0)
(0,0.5,0;0,0,0;0,0,0.5)
--convolve[0] [1]
--convolve[0] [2]
-keep[0,-1,-2]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbh:
(0,0.5,0;0,0,0;0,0.5,0)
(0,0.5,0;0,0,0;0.5,0,0)
--convolve[0] [1]
--convolve[0] [2]
-keep[0,-1,-2]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbi:
(0,0.5,0;0.5,0,0;0,0,0)
(0,0,0.5;0,0,0.5;0,0,0)
--convolve[0] [1]
--convolve[0] [2]
-keep[0,-1,-2]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbj:
(0,0,0.5;0,0,0;0,0,0.5)
(0,0,0.5;0,0,0;0,0.5,0)
--convolve[0] [1]
--convolve[0] [2]
-keep[0,-1,-2]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbk:
(0,0,0.5;0,0,0;0.5,0,0)
(0,0,0.5;0.5,0,0;0,0,0)
--convolve[0] [1]
--convolve[0] [2]
-keep[0,-1,-2]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbl:
(0,0,0;0,0,0.5;0,0,0.5)
(0,0,0;0,0,0.5;0,0.5,0)
--convolve[0] [1]
--convolve[0] [2]
-keep[0,-1,-2]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbm:
(0,0,0;0,0,0.5;0.5,0,0)
(0,0,0;0.5,0,0.5;0,0,0)
--convolve[0] [1]
--convolve[0] [2]
-keep[0,-1,-2]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbn:
(0,0,0;0,0,0;0,0.5,0.5)
(0,0,0;0,0,0;0.5,0,0.5)
--convolve[0] [1]
--convolve[0] [2]
-keep[0,-1,-2]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbo:
(0,0,0;0.5,0,0;0,0,0.5)
(0,0,0;0,0,0;0.5,0.5,0)
--convolve[0] [1]
--convolve[0] [2]
-keep[0,-1,-2]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbp:
(0,0,0;0.5,0,0;0,0.5,0)
(0,0,0;0.5,0,0;0.5,0,0)
--convolve[0] [1]
--convolve[0] [2]
-keep[0,-1,-2]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbq:
--createbc[0]
--createbd[0]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbr:
--createbe[0]
--createbf[0]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbs:
--createbg[0]
--createbh[0]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbt:
--createbi[0]
--createbj[0]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbu:
--createbk[0]
--createbl[0]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbv:
--createbm[0]
--createbn[0]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbw:
--createbo[0]
--createbp[0]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbx:
--createbq[0]
--createbr[0]
-iain_median_3_stack[0,1,2]
-keep[-1]
createby:
--createbs[0]
--createbt[0]
-iain_median_3_stack[0,1,2]
-keep[-1]
createbz:
--createbu[0]
--createbv[0]
-iain_median_3_stack[0,1,2]
-keep[-1]
createca:
--createbx[0]
--createby[0]
-iain_median_3_stack[0,1,2]
-keep[-1]
createcb:
--createbz[0]
--createbw[0]
-iain_median_3_stack[0,1,2]
-keep[-1]
megaclean:
--createca[0]
--createcb[0]
-iain_median_3_stack[0,1,2]
-keep[-1]
cross:
--shift[0] 0,1,0,0,2
--shift[0] 0,-1,0,0,2
--shift[0] 1,0,0,0,2
--shift[0] -1,0,0,0,2
-iain_median_5_stack
ex:
--shift[0] 1,1,0,0,2
--shift[0] 1,-1,0,0,2
--shift[0] -1,-1,0,0,2
--shift[0] -1,1,0,0,2
-iain_median_5_stack
hybrid_median:
-ac "
-repeat $1
--cross[0]
--ex[0]
-iain_median_3_stack[0,1,2]
-done
",$2
iain_hybrid_median:
-repeat $1
--cross[0]
--ex[0]
-iain_median_3_stack[0,1,2]
-done
iain_pixel_denoise:
-if {$1==0}
-ac "
-repeat $2
-megaclean
-done
",$3
-elif {$1==1}
-hybrid_median[0] $2,$3
-elif {$2==1}
--l[0]
(1,1,1;1,0,1;1,1,1)
-dilate[0] [1]
-rm[1]
-endl
--l[0]
(1,1,1;1,0,1;1,1,1)
-erode[0] [1]
-rm[1]
-endl
-min[0,1]
-max[0,1]
-endif
iain_pixel_denoise_p:
-if $5
-if {$1==0}
-ac "
-repeat $2
-apply_parallel_overlap \"-megaclean \",4,0
-done
",$3
-elif {$1==1}
-ac "
-apply_parallel_overlap \"-iain_hybrid_median[0] $2\",4,0
",$3
-elif {$1==2}
-ac "
-apply_parallel_overlap \"
--l[0]
(1,1,1;1,0,1;1,1,1)
-dilate[0] [1]
-rm[1]
-endl
--l[0]
(1,1,1;1,0,1;1,1,1)
-erode[0] [1]
-rm[1]
-endl
-min[0,1]
-max[0,1]
\",4,0
",$3
-endif
-else
-if {$1==0}
-ac "
-repeat $2
-megaclean
-done
",$3
-elif {$1==1}
-ac "
-iain_hybrid_median_p[0] $2
",$3
-elif {$1==2}
-ac "
--l[0]
(1,1,1;1,0,1;1,1,1)
-dilate[0] [1]
-rm[1]
-endl
--l[0]
(1,1,1;1,0,1;1,1,1)
-erode[0] [1]
-rm[1]
-endl
-min[0,1]
-max[0,1]
",$3
-endif
-endif
time=@|
iain_pixel_denoise_p_preview:
-if {$4==0}
-iain_pixel_denoise_p ${1--1}
-endif
-if {$4==1}
--iain_pixel_denoise_p ${1--1}
-sub[0] [1]
-keep[0]
-n 0,255
-endif
#@gimp Recursive median : iain_recursive_median_p, iain_recursive_median_p_preview(0)
#@gimp : Median radius = int(3,1,20)
#@gimp : Repeats = int(1,1,20)
#@gimp : Channel(s) = choice(0,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator()
#@gimp : Preview shows = choice("Output","Difference")
#@gimp : Sep = separator()
#@gimp : Parallel processing = choice(1,"Off","Auto")
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author : <i>Iain Fergusson</i>.</small>")
#@gimp : Note = note("<small>Update - 25 October 2013 - Parallel Processing was not working properly, fixed now.
#@gimp : Note = note("<small>Update - 20 October 2013 - Parallel Processing and Control Layout</small>")
iain_recursive_median_p:
-if $5
-ac "
-apply_parallel_overlap \"
-repeat $2 -median $1 -done
\",{$1*2},0
",$3,0
-else
-ac "
-repeat $2 -median $1 -done
",$3,0
-endif
recursive_median:
-ac "-repeat $3 -median $1 -done",$2,0
iain_recursive_median_p_preview:
-if {$-2==0}
-iain_recursive_median_p $1,$2,$3,$4,$5
-endif
-if {$-2==1}
-remove_opacity
--iain_recursive_median_p $1,$2,$3,$4,$5
-sub[0] [1]
-keep[0]
-mul 2
-add 128
-endif
#@gimp Red-eye attenuation : red_eye, red_eye
#@gimp : Threshold = float(75,0,100)
#@gimp : Smoothness = float(3.5,0,20)
#@gimp : Factor = float(0.1,0,1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
#@gimp Remove hot pixels : gimp_remove_hotpixels, gimp_remove_hotpixels_preview(0)
#@gimp : Mask size = int(3,3,20)
#@gimp : Threshold = float(10,0,200)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>J&#233;rome Boulanger</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_remove_hotpixels :
-remove_hotpixels $1,$2
gimp_remove_hotpixels_preview :
-gimp_split_preview "-gimp_remove_hotpixels $*",$-1
#@gimp Repair scanned document : jeje_scandoc, jeje_scandoc_preview(0)
#@gimp : Note = note(Use filter is useful to post process document you scan with a digital camera. It peforms smoothing, background correction and white balance adjustement)
#@gimp : Smoothness = int(3,1,7)
#@gimp : Background = float(1,10,100)
#@gimp : White level = float(90,0,100)
#@gimp : Black level = float(5,0,100)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>. Latest update: <i>2013/11/03</i>.</small>")
jeje_scandoc :
-scandoc $1,$2%,$3%,$4%
jeje_scandoc_preview :
-gimp_split_preview "-jeje_scandoc $1,$2,$3,$4",$-1
#@gimp Smooth [anisotropic] : gimp_anisotropic_smoothing, gimp_anisotropic_smoothing_preview(0)
#@gimp : Amplitude = float(60,0,1000)
#@gimp : Sharpness = float(0.7,0,2)
#@gimp : Anisotropy = float(0.3,0,1)
#@gimp : Gradient smoothness = float(0.6,0,10)
#@gimp : Tensor smoothness = float(1.1,0,10)
#@gimp : Spatial precision = float(0.8,0.1,2)
#@gimp : Angular precision = float(30,1,180)
#@gimp : Value precision = float(2,0.1,5)
#@gimp : Interpolation = choice(0,"Nearest neighbor","Linear","Runge-Kutta")
#@gimp : Fast approximation = bool(1)
#@gimp : Iterations = int(1,1,10)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/27/2013</i>.</small>")
gimp_anisotropic_smoothing :
-repeat @# -l[$>]
-ac "-repeat $11 -smooth $1,$2,$3,$4,$5,$6,$7,$8,$9,$10 -done",$12
-endl -done -c 0,255
gimp_anisotropic_smoothing_preview :
-gimp_split_preview "-gimp_anisotropic_smoothing $*",$-1
#@gimp Smooth [bilateral] : gimp_bilateral, gimp_bilateral_preview(0)
#@gimp : Spatial variance = float(10,0,100)
#@gimp : Value variance = float(7,0,100)
#@gimp : Iterations = int(2,1,10)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/27/2013</i>.</small>")
gimp_bilateral : -skip ${5=0},${6=0}
-ac "-gimp_parallel_overlap \"-repeat $3 -bilateral $1,$2 -done\",$5,$6",$4
gimp_bilateral_preview :
-gimp_split_preview "-gimp_bilateral $*",$-1
#@gimp Smooth [block pca] : jeje_denoise_patch_dict, jeje_denoise_patch_dict_preview
#@gimp : Patch = choice(1,4,8,16,32)
#@gimp : Cycles = int(8,1,32)
#@gimp : Components = float(1.1,1,9)
#@gimp : Coefficients = float(1.1,0,9)
#@gimp : Remix = float(0,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note(<b>Note:</b>This filter is quite time consuming.)
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>.      Latest update: <i>2013/03/29</i>.</small>")
jeje_denoise_patch_dict:
--denoise_patch_dict {2^($1+2)},$2,$3,$4
-*[0] $5 -*[1] {1-$5} -+ -c 0,255
#@gimp Smooth [diffusion] : gimp_diffusion_smoothing, gimp_diffusion_smoothing_preview(0)
#@gimp : Sharpness = float(0.7,0,2)
#@gimp : Anisotropy = float(0.3,0,1)
#@gimp : Gradient smoothness = float(0.6,0,10)
#@gimp : Tensor smoothness = float(1.1,0,10)
#@gimp : Time step = float(15,5,50)
#@gimp : Iterations = int(8,1,100)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/27/2013</i>.</small>")
gimp_diffusion_smoothing :
-ac "-gimp_parallel_overlap \"-smooth $6,$1,$2,$3,$4,$5,0 -c 0,255\",$8,$9",$7
gimp_diffusion_smoothing_preview :
-gimp_split_preview "-gimp_diffusion_smoothing $*",$-1
#@gimp Smooth [guided] : gimp_blur_guided, gimp_blur_guided_preview(0)
#@gimp : Radius = int(5,1,100)
#@gimp : Smoothness = float(30,0,512)
#@gimp : Iterations = int(1,1,10)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/29/2014</i>.</small>")
gimp_blur_guided : -skip ${5=0},${6=0}
-ac "-gimp_parallel_overlap \"-repeat $3 -guided $1,$2 -done\",$5,$6",$4
gimp_blur_guided_preview :
-gimp_split_preview "-gimp_blur_guided $*",$-1
#@gimp Smooth [iuwt] : jeje_denoise_iuwt,jeje_denoise_iuwt_preview
#@gimp : Threshold = float(3,0,10)
#@gimp : Number of scales = int(4,2,6)
#@gimp : Wavelet = choice(2,"Spline B1","Spline B2","Spline B3","Spline B4","Spline B5","Spline B6")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small><b>Note:</b>Denoise the image by thresholding the coefficient of the Isotropic Undecimated Wavelet Transform.</small>")
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>. Latest update: <i>2013/17/12</i>.</small>")
jeje_denoise_iuwt :
-denoise_iuwt $1,$2,{$3+1}
jeje_denoise_iuwt_preview:
-gimp_split_preview "-jeje_denoise_iuwt $1,$2,$3",$-1
#@gimp Smooth [mean-curvature] : gimp_meancurvature_smoothing, gimp_meancurvature_smoothing_preview(0)
#@gimp : Time step = float(30,5,50)
#@gimp : Iterations = int(4,1,30)
#@gimp : Keep iterations as different layers = bool(false)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/27/2013</i>.</small>")
gimp_meancurvature_smoothing :
-ac "-gimp_parallel_overlap \"-meancurvature_flow $2,$1,$3 -c 0,255\",$5,$6",$4
gimp_meancurvature_smoothing_preview :
-gimp_split_preview "-gimp_meancurvature_smoothing $*",$-1
#@gimp Smooth [median] : gimp_median, gimp_median_preview(0)
#@gimp : Radius = int(3,1,20)
#@gimp : Threshold = float(255,0,255)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_median :
-ac "-median $1,$2",$3
gimp_median_preview :
-gimp_split_preview "-gimp_median $*",$-1
#@gimp Smooth [nlmeans] : gimp_nlmeans, gimp_nlmeans_preview(0)
#@gimp : Patch size = float(4,0.5,10)
#@gimp : Spatial bandwidth = int(4,3,13)
#@gimp : Tonal bandwidth = float(10,1,50)
#@gimp : Patch measure = choice(3,"Linf-norm","L1-norm","L2-norm","Luminance","Lightness","RGB")
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>J&#233;r&#244;me Boulanger</i>.      Latest update: <i>2015/01/07</i>.</small>")
gimp_nlmeans:
-repeat @# -l[$>]
-if {s==1} -nlmeans $1,$2,$3,-_gimp_nlmeans$4
-else -ac "-gimp_parallel_overlap \"-nlmeans $1,$2,$3,-_gimp_nlmeans$4\",$6,$7",$5
-endif
-endl -done
_gimp_nlmeans0 : -s c -abs -max
_gimp_nlmeans1 : -s c -abs -+
_gimp_nlmeans2 : -norm
_gimp_nlmeans3 : -if {s>=3} -channels 0,2 -luminance -else -norm -endif
_gimp_nlmeans4 : -if {s>=3} -channels 0,2 -srgb2rgb -rgb2lab -channels 0 -else -norm -endif
_gimp_nlmeans5 :
gimp_nlmeans_preview:
-gimp_split_preview "-gimp_nlmeans $*",$-1
#@gimp Smooth [patch-based] : gimp_patch_smoothing, gimp_patch_smoothing_preview(0)
#@gimp : Spatial variance = float(10,0.1,200)
#@gimp : Patch variance = float(10,0.1,200)
#@gimp : Patch size = int(3,2,21)
#@gimp : Lookup size = int(5,2,21)
#@gimp : Patch smoothness = float(0,0,4)
#@gimp : Fast approximation = bool(1)
#@gimp : Iterations = int(1,1,10)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/27/2013</i>.</small>")
gimp_patch_smoothing :
-ac "-gimp_parallel_overlap \"-repeat $7 -denoise $1,$2,$3,$4,$5,$6 -done -c 0,255\",$9,$10",$8
gimp_patch_smoothing_preview :
-gimp_split_preview "-gimp_patch_smoothing $*",$-1
#@gimp Smooth [perona-malik] : gimp_peronamalik_smoothing, gimp_peronamalik_smoothing_preview(0)
#@gimp : K-factor = float(20,0,255)
#@gimp : Time step = float(5,5,50)
#@gimp : Iterations = int(5,1,30)
#@gimp : Keep iterations as different layers = bool(false)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/26/2014</i>.</small>")
gimp_peronamalik_smoothing :
-ac "-gimp_parallel_overlap \"-peronamalik_flow $1,$3,$2,$4 -c 0,255\",$6,$7",$5
gimp_peronamalik_smoothing_preview :
-gimp_split_preview "-gimp_peronamalik_smoothing $*",$-1
#@gimp Smooth [selective gaussian] : gimp_selective_smoothing, gimp_selective_smoothing_preview(0)
#@gimp : Amplitude = float(5,0,20)
#@gimp : Edges = float(0.5,0,2)
#@gimp : Scales = int(5,1,10)
#@gimp : Iterations = int(1,1,10)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/27/2013</i>.</small>")
gimp_selective_smoothing :
-ac "-gimp_parallel_overlap \"-repeat $4 -blur_selective $1,$2,$3 -done -c 0,255\",$6,$7",$5
gimp_selective_smoothing_preview :
-gimp_split_preview "-gimp_selective_smoothing $*",$-1
#@gimp Smooth [skin] : gimp_smooth_skin, gimp_smooth_skin_preview(1)
#@gimp : Note = note("<small><b>Step 1:</b> Skin detection</small>")
#@gimp : Skin estimation = choice(2,"None","Manual","Automatic")
#@gimp : Tolerance = float(0.5,0,1)
#@gimp : Smoothness = float(1,0,5)
#@gimp : Threshold = float(1,0,10)
#@gimp : Pre-normalize image = bool(1)
#@gimp : X-coordinate [manual] = float(50,0,100)
#@gimp : Y-coordinate [manual] = float(50,0,100)
#@gimp : Radius [manual] = float(5,0,25)
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Step 2:</b> Medium scale smoothing</small>")
#@gimp : Base scale = float(2,0,10)
#@gimp : Fine scale = float(0.2,0,0.8)
#@gimp : Smoothness = float(3,0,10)
#@gimp : Smoothness type = choice(1,"Gaussian","Bilateral")
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Step 3:</b> Details enhancement</small>")
#@gimp : Gain = float(0.05,0,0.5)
#@gimp : Sep = separator()
#@gimp : Preview data = choice{5,"Skin mask","Base scale","Medium scale (original)","Medium scale (smoothed)","Fine scale","Result image"}
#@gimp : Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), link = link("Click here for a video tutorial","http://www.youtube.com/watch?v=H8pQfq-ybCc")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/20/2013</i>.</small>")
gimp_smooth_skin :
-repeat @# -l[$>] -split_opacity -l[0] -to_rgb
-if $5 --balance_gamma 128,128,128 -else [0] -endif
-if {$1==0} -channels[-1] 0 -f[-1] 1 -elif {$1==2} -detect_skin[-1] $2 -else -detect_skin[-1] $2,$6%,$7%,$8% -endif
M={iM} -b[-1] $3% -*[-1] {$M/iM} -*[-1] $4 -c[-1] 0,1
-split_details[0] 4,$9%,$10%
--_gimp_smooth_skin[2] $12,$11
-j[2] [-1],0,0,0,0,1,[-2] -rm[-2,-1]
-*[-1] {10^$13} -+ -c 0,255
-endl -a c -endl -done
_gimp_smooth_skin :
-if {$1==0} -b {$2/8}%
-else
-if {$2>0}
m={im} M={iM} -n 0,255
-repeat {int($2/5)} -bilateral 3%,{5*3} -done
-bilateral 3%,{($2%5)*3}
-* {($M-$m)/255} -+ $m
-endif
-endif
gimp_smooth_skin_preview :
-if {$-2==0}
-gimp_split_preview "-if $5 -balance_gamma 128,128,128 -endif -if {$1==0} -f 1 -elif {$1==2} -detect_skin $2 -else -detect_skin $2,$6%,$7%,$8% -endif M={iM} -b $3% -* {255*$M/iM} -* $4 -c 0,255",$-1
-elif {$-2==1}
-gimp_split_preview "-b $9%",$-1
-elif {$-2==2}
-gimp_split_preview "-split_details 4,$9%,$10% -k[-2] -n 0,255",$-1
-elif {$-2==3}
-gimp_split_preview "-split_details 4,$9%,$10% -k[-2] -_gimp_smooth_skin $12,$11 -n 0,255",$-1
-elif {$-2==4}
-gimp_split_preview "-split_details 4,$9%,$10% -k[-1] -n 0,255",$-1
-else
-gimp_split_preview "-gimp_smooth_skin $*",$-1
-endif
-if {$1==1}
-to_rgb
-circle $6%,$7%,$8%,0.2,0,255,0
-circle $6%,$7%,$8%,0.4,0xFFFFFFFF,0,255,0
-line {$6-0.25*$8}%,{$7-0.25*$8}%,{$6+0.25*$8}%,{$7+0.25*$8}%,0.8,255,255,0
-line {$6+0.25*$8}%,{$7-0.25*$8}%,{$6-0.25*$8}%,{$7+0.25*$8}%,0.8,255,255,0
-endif
#@gimp Smooth [thin brush] : gimp_anisotropic_smoothing, gimp_anisotropic_smoothing(0)
#@gimp : Amplitude = float(60,0,1000)
#@gimp : Sharpness = float(0.9,0,2)
#@gimp : Anisotropy = float(0.64,0,1)
#@gimp : Gradient smoothness = float(3.1,0,10)
#@gimp : Tensor smoothness = float(1.10,0,10)
#@gimp : Spatial precision = float(0.8,0.1,2)
#@gimp : Angular precision = float(30,1,180)
#@gimp : Value precision = float(2,0.1,5)
#@gimp : Interpolation = choice(0,"Nearest neighbor","Linear","Runge-Kutta")
#@gimp : Fast approximation = bool(1)
#@gimp : Iterations = int(1,1,10)
#@gimp : Channel(s) = choice("RGB","Luminance","Blue & Red chrominances","Blue chrominance","Red chrominance")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Note = note{"\n<small><b>Note: </b>This set of anisotropic smoothing parameters has been suggested by PhotoComiX.</small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update: <i>12/26/2010</i>.</small>")
#@gimp Smooth [total variation] : gimp_tv_smoothing, gimp_tv_smoothing_preview(0)
#@gimp : Time step = float(30,5,100)
#@gimp : Iterations = int(10,1,40)
#@gimp : Keep iterations as different layers = bool(false)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/27/2013</i>.</small>")
gimp_tv_smoothing :
-ac "-gimp_parallel_overlap \"-tv_flow $2,$1,$3 -c 0,255\",$5,$6",$4
gimp_tv_smoothing_preview :
-gimp_split_preview "-gimp_tv_smoothing $*",$-1
#@gimp Smooth [wavelets] : gimp_haar_smoothing, gimp_haar_smoothing_preview(0)
#@gimp : Threshold = float(1,0,10)
#@gimp : Iterations = int(10,1,32)
#@gimp : Scales = int(10,2,10)
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Parallel processing = choice("Auto","One thread","Two threads","Four threads","Eight threads","Sixteen threads"), Spatial overlap = int(24,0,256)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>J&#233;rome Boulanger and David Tschumperl&#233;</i>.      Latest update: <i>08/27/2013</i>.</small>")
gimp_haar_smoothing :
-ac "-gimp_parallel_overlap \"-denoise_haar $1,$3,$2 -c 0,255\",$5,$6",$4
gimp_haar_smoothing_preview :
-gimp_split_preview "-gimp_haar_smoothing $*",$-1
#@gimp Smooth [wiener] : jeje_local_wiener, jeje_local_wiener_preview
#@gimp : Scale = float(2,.5,10)
#@gimp : Channel(s) = choice("All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Green chrominance","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>. Latest update: <i>2013/06/07</i>.</small>")
jeje_local_wiener :
-apply_channels_old "-local_wiener $1",$2,0 -c 0,255
jeje_local_wiener_preview:
-gimp_split_preview "-jeje_local_wiener $*",$-1
#@gimp Unstrip : jeje_unstrip, jeje_unstrip_preview
#@gimp : Smoothness = float(1,0,10)
#@gimp : Size = float(20,1,50)
#@gimp : Sensitivity = float(4,1,10)
#@gimp : Normalize = bool(true)
#@gimp : Fft preview = bool(false)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>. Latest update: <i>2013/06/10</i>.</small>")
jeje_unstrip :
-unstrip $1,$2,$3
-if $5 -tape -powerspectrum -else
-if -$4 -n 0,255 -else -c 0,255 -endif
-endif
jeje_unstrip_preview :
-gimp_split_preview "-jeje_unstrip $1,$2,$3,$4,$5",$-1
#@gimp Upscale [diffusion] : gimp_upscale_smart, gimp_upscale_smart_preview(0)
#@gimp : Width = text("200%")
#@gimp : Height = text("200%")
#@gimp : Smoothness = float(2,0,20)
#@gimp : Anisotropy = float(0.4,0,1)
#@gimp : Sharpness = float(50,0,100)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_upscale_smart :
-to_rgb -upscale_smart $1,$2,1,$3,$4,$5 -c 0,255
gimp_upscale_smart_preview :
-repeat @#
--r[-1] $1,$2,1,1,0
-if {w<@{-2,w}||h<@{-2,h}}
-rm[-1] -/[-1] 4
0 -t[-1] "Downscaling is\nnot allowed!",5,5,20,1,255 -r[-1] [-2],[-2],1,1,0,0,0.5,0.5
-or[-2,-1]
-else
-z[-2] {50-50*@{-2,w}/w}%,{50-50*@{-2,h}/h}%,{50+50*@{-2,w}/w}%,{50+50*@{-2,h}/h}%
-rm[-1] -gimp_upscale_smart[-1] $1,$2,$3,$4,$5 -c[-1] 0,255
-endif
-mv[-1] 0 -done
#@gimp Upscale [scale2x] : gimp_scalenx, gimp_scalenx_preview(0)
#@gimp : Scaling factor = choice("x 2","x 3","x 4","x 6","x 8","x 9","x 12","x 16","x 18","x 27")
#@gimp : Colorbase = choice(0,"RGB","YCbCr","Lab")
#@gimp : Note = note{"\n<small><b>Note: </b>
#@gimp : This filter re-implements the scaling algorithm described at :
#@gimp : </small>"}
#@gimp : Note = link("http://scale2x.sourceforge.net")
#@gimp : Note = note{"<small>
#@gimp : This filter is useful for resizing images that have very few colors
#@gimp : (e.g. indexed images). It is generally useless for true colors images.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_scalenx :
-repeat @# -l[$>] -split_opacity
-if {$2==1} -rgb2ycbcr[0] -round[0]
-elif {$2==2} -rgb2lab8[0] -round[0]
-endif
-if {$1==0} -scale2x
-elif {$1==1} -scale3x
-elif {$1==2} -scale2x -scale2x
-elif {$1==3} -scale3x -scale2x
-elif {$1==4} -scale2x -scale2x -scale2x
-elif {$1==5} -scale3x -scale3x
-elif {$1==6} -scale3x -scale2x -scale2x
-elif {$1==7} -scale2x -scale2x -scale2x -scale2x
-elif {$1==8} -scale3x -scale3x -scale2x
-elif {$1==9} -scale3x -scale3x -scale3x
-endif
-if {$2==1} -ycbcr2rgb[0]
-elif {$2==2} -lab82rgb[0]
-endif
-a c -endl -done
gimp_scalenx_preview :
-z 40%,40%,60%,60%
-gimp_scalenx $1,$2
gimp_render3d : -skip ${14=1}
width={(1+$14)*$1} height={(1+$14)*$2}
-n3d -c3d -m3d $13 f3d={0.5*max($width,$height)/tan($7*pi/360)}
-f3d $f3d -l3d {$8*$f3d},{$9*$f3d},{$10*$f3d} -sl3d $11 -ss3d $12
-repeat @# -l[$>]
-*3d {$3*max($width,$height)} -r3d 0,0,1,$6 -r3d 0,1,0,$5 -r3d 1,0,0,$4
$width,$height,1,3,-1
-j3d[-1] [-2],50%,50% -rm[-2]
-to_rgba -replace_color 0,0,-1,-1,-1,255,0,0,0,0
-if $14
-r $1,$2,1,100%,2 -s c,-3 -+[-1] 1e-5 -/[0] [1] -*[0] 255 -a c
-endif
-endl -done
#@gimp _
#@gimp <b>Sequences</b>
#@gimp 3d elevation [animated] : gimp_animate_elevation3d, gimp_animate_elevation3d_preview(1)
#@gimp : Frames = _int(10,2,100)
#@gimp : Output as frames = _bool(1)
#@gimp : Output as files = _bool(0)
#@gimp : Output folder = _folder()
#@gimp : Note = note{"\n<b>Global parameters :</b>"}
#@gimp : Factor = float(100,-1000,1000)
#@gimp : Smoothness = float(1,0,10)
#@gimp : Width = _int(1024,8,4096)
#@gimp : Height = _int(1024,8,4096)
#@gimp : Rendering = choice(2,"Dots","Wireframe","Flat","Flat shaded","Gouraud","Phong")
#@gimp : Note = note{"\n<b>Starting parameters :</b>"}
#@gimp : Size = float(0.8,0,3)
#@gimp : X-angle = float(35,0,360)
#@gimp : Y-angle = float(0,0,360)
#@gimp : Z-angle = float(0,0,360)
#@gimp : Fov = float(45,1,90)
#@gimp : X-light = float(0,-100,100)
#@gimp : Y-light = float(0,-100,100)
#@gimp : Z-light = float(-100,-100,0)
#@gimp : Specular lightness = float(0.5,0,1)
#@gimp : Specular shininess = float(0.7,0,3)
#@gimp : Note = note{"\n<b>Ending parameters :</b>"}
#@gimp : Size = float(0.8,0,3)
#@gimp : X-angle = float(35,0,1440)
#@gimp : Y-angle = float(0,0,1440)
#@gimp : Z-angle = float(360,0,1440)
#@gimp : Fov = float(45,1,90)
#@gimp : X-light = float(0,-100,100)
#@gimp : Y-light = float(0,-100,100)
#@gimp : Z-light = float(-100,-100,0)
#@gimp : Specular lightness = float(0.5,0,1)
#@gimp : Specular shininess = float(0.7,0,3)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_animate_elevation3d :
-if $3 filename="$4/gmic_elevation3d.png" -else filename="" -endif
-_gimp_elevation3d ${5-6}
-animate gimp_render3d,"${7-8},${10-19},$9",\
"${7-8},${20-29},$9",$1,$2,@{-quote\ $filename}
gimp_animate_elevation3d_preview :
w={w} h={h}
-_gimp_elevation3d ${5-6}
-gimp_animate_preview gimp_render3d,$w","$h",${10-19},$9",\
$w","$h",${20-29},$9",0,$w,$h
#@gimp 3d extrusion [animated] : gimp_animate_extrude3d, gimp_animate_extrude3d_preview(1)
#@gimp : Frames = _int(10,2,100)
#@gimp : Output as frames = _bool(1)
#@gimp : Output as files = _bool(0)
#@gimp : Output folder = _folder()
#@gimp : Note = note{"\n<b>Global parameters :</b>"}
#@gimp : Depth = float(10,1,256)
#@gimp : Resolution = int(512,1,1024)
#@gimp : Smoothness = float(0.6,0,3)
#@gimp : Width = _int(1024,8,4096)
#@gimp : Height = _int(1024,8,4096)
#@gimp : Rendering = choice(4,"Dots","Wireframe","Flat","Flat shaded","Gouraud","Phong")
#@gimp : Note = note{"\n<b>Starting parameters :</b>"}
#@gimp : Size = float(0.8,0,3)
#@gimp : X-angle = float(35,0,360)
#@gimp : Y-angle = float(0,0,360)
#@gimp : Z-angle = float(0,0,360)
#@gimp : Fov = float(45,1,90)
#@gimp : X-light = float(0,-100,100)
#@gimp : Y-light = float(0,-100,100)
#@gimp : Z-light = float(-100,-100,0)
#@gimp : Specular lightness = float(0.5,0,1)
#@gimp : Specular shininess = float(0.7,0,3)
#@gimp : Note = note{"\n<b>Ending parameters :</b>"}
#@gimp : Size = float(0.8,0,3)
#@gimp : X-angle = float(35,0,1440)
#@gimp : Y-angle = float(360,0,1440)
#@gimp : Z-angle = float(0,0,1440)
#@gimp : Fov = float(45,1,90)
#@gimp : X-light = float(0,-100,100)
#@gimp : Y-light = float(0,-100,100)
#@gimp : Z-light = float(-100,-100,0)
#@gimp : Specular lightness = float(0.5,0,1)
#@gimp : Specular shininess = float(0.7,0,3)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_animate_extrude3d :
-if $3 filename="$4/gmic_extrude3d.png" -else filename="" -endif
-_gimp_extrude3d ${5-7}
-animate gimp_render3d,"${8-9},${11-20},$10",\
"${8-9},${21-30},$10",$1,$2,@{-quote\ $filename}
gimp_animate_extrude3d_preview :
w={w} h={h}
-_gimp_extrude3d ${5-7}
-gimp_animate_preview gimp_render3d,$w","$h",${11-20},$10",\
$w","$h",${21-30},$10",0,$w,$h
#@gimp 3d image object [animated] : gimp_animate_imageobject3d, gimp_animate_imageobject3d_preview(1)
#@gimp : Frames = _int(10,2,100)
#@gimp : Output as frames = _bool(1)
#@gimp : Output as files = _bool(0)
#@gimp : Output folder = _folder()
#@gimp : Note = note{"\n<b>Global parameters :</b>"}
#@gimp : Type = choice{1,"Plane","Cube","Pyramid","Sphere","Torus","Gyroid","Weird","Cup","Rubik"}
#@gimp : Width = _int(1024,1,4096)
#@gimp : Height = _int(1024,1,4096)
#@gimp : Rendering = choice(4,"Dots","Wireframe","Flat","Flat shaded","Gouraud","Phong")
#@gimp : Note = note{"\n<b>Starting parameters :</b>"}
#@gimp : Size = float(0.5,0,3)
#@gimp : X-angle = float(57,0,360)
#@gimp : Y-angle = float(41,0,360)
#@gimp : Z-angle = float(21,0,360)
#@gimp : Fov = float(45,1,90)
#@gimp : X-light = float(0,-100,100)
#@gimp : Y-light = float(0,-100,100)
#@gimp : Z-light = float(-100,-100,0)
#@gimp : Specular lightness = float(0.5,0,1)
#@gimp : Specular shininess = float(0.7,0,3)
#@gimp : Note = note{"\n<b>Ending parameters :</b>"}
#@gimp : Size = float(0.5,0,3)
#@gimp : X-angle = float(57,0,1440)
#@gimp : Y-angle = float(401,0,1440)
#@gimp : Z-angle = float(21,0,1440)
#@gimp : Fov = float(45,1,90)
#@gimp : X-light = float(0,-100,100)
#@gimp : Y-light = float(0,-100,100)
#@gimp : Z-light = float(-100,-100,0)
#@gimp : Specular lightness = float(0.5,0,1)
#@gimp : Specular shininess = float(0.7,0,3)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_animate_imageobject3d :
-if $3 filename="$4/gmic_imageobject3d.png" -else filename="" -endif
-_gimp_imageobject3d "_",$5
-animate gimp_render3d,"${6-7},${9-18},$8",\
"${6-7},${19-28},$8",$1,$2,@{-quote\ $filename}
gimp_animate_imageobject3d_preview :
w={w} h={h}
-_gimp_imageobject3d "_preview_",$5
-gimp_animate_preview gimp_render3d,$w","$h",${9-18},$8",\
$w","$h",${19-28},$8",0,$w,$h
#@gimp 3d text pointcloud : gimp_text_pointcloud3d, gimp_text_pointcloud3d_preview
#@gimp : Frames = _int(64,1,256)
#@gimp : 1st text = text("G'MIC")
#@gimp : 2nd text = text("Rocks!")
#@gimp : Smoothness = float(1,0,5)
#@gimp : Color = color(200,220,255)
#@gimp : Background = color(255,255,255,255)
#@gimp : X-shadow = float(2,0,10)
#@gimp : Y-shadow = float(2,0,10)
#@gimp : Shadow smoothness = float(1,0,5)
#@gimp : Stationary frames = _int(19,1,32)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>09/01/2012</i>.</small>")
gimp_text_pointcloud3d :
W={w} H={h} M={round(1.5*max(w,h))} -rm
-text_pointcloud3d "$2","$3",$4
-col3d[-1] ${5-7} -*3d[-1] {0.7*$M}
-f3d 4000 -db3d 0 -m3d
-repeat $1
-rprogress {60*$>/$1}
angle={$>*360/$1}
--r3d[0] 1,0,1,$angle
$M,$M,1,3,-1 -j3d[-1] [-2],50%,50%,0,1 -rm[-2]
-done
-rm[0] -a z -autocrop -1 -to_rgba -s z -replace_color 0,0,-1,-1,-1,255,0,0,0,0
-if $11 N=@# -repeat @# -l[$>] -rprogress {60+40*$>/$N}
-i[0] 100%,100%,1,4 -fc[0] ${8-11} --channels[-1] 3,3 --negative[-1] -b[-2,-1] $14% -to_rgba[-1]
-j[0] [-1],$12%,$13%,0,0,1,[-2],255 -rm[-2,-1] -blend alpha
-endl -done -endif
-if {$W>$H} -r2dx $W -else -r2dy $H -endif
-if {$15>1}
-i[{int($1/2)}] [{int($1/2)}]x{$15-1}
-i[0] [0]x{$15-1}
-endif
gimp_text_pointcloud3d_preview :
-gimp_text_pointcloud3d 4,"$2","$3",$4,${5-7},${8-11},${12-14},1 -drgba
-frame 1,1,0 -append_tiles 2,2
#@gimp 3d tiles : gimp_transition3d, gimp_transition3d_preview(0)
#@gimp : Inter-frames = _int(10,3,100)
#@gimp : X-tiles = int(8,1,64)
#@gimp : Y-tiles = int(8,1,64)
#@gimp : X-rotation = text("1")
#@gimp : Y-rotation = text("1")
#@gimp : Z-rotation = text("0")
#@gimp : Focale = float(800,100,2000)
#@gimp : Enable antialiasing = bool(1)
#@gimp : Sep = separator(), note = note{"<small><b>Note:</b>
#@gimp : This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/13/2012</i>.</small>")
gimp_transition3d :
-f3d $7
-transition3d $1,$2,$3,"$4","$5","$6",$8
gimp_transition3d_preview :
-if {@#==1} -gimp_warning_preview "Missing input layer" -return -endif
-f3d $7
-k[0,1] -transition3d 4,$2,$3,"$4","$5","$6",$8
-k[1,2]
-r[0] 50%,100%,1,100%,0
-r[1] 50%,100%,1,100%,0,0,1
-a x
-line 50%,0,50%,100%,1,0,0,0,255
#@gimp B&amp;W pencil [animated] : gimp_animate_pencilbw, gimp_animate_pencilbw_preview(0)
#@gimp : Frames = _int(10,2,100)
#@gimp : Output frames = _bool(1)
#@gimp : Output files = _bool(0)
#@gimp : Output folder = _folder()
#@gimp : Note = note{"\n<b>Starting parameters :</b>"}
#@gimp : Pencil type = float(2.3,0,5)
#@gimp : Amplitude = float(100,0,200)
#@gimp : Note = note{"\n<b>Ending parameters :</b>"}
#@gimp : Pencil type = float(0.3,0,5)
#@gimp : Amplitude = float(60,0,200)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_animate_pencilbw :
-if $3 filename="$4/gmic_pencilbw.png" -else filename="" -endif
-animate pencilbw,"${5-6}",\
"${7-8}",$1,$2,@{-quote\ $filename}
gimp_animate_pencilbw_preview :
-gimp_animate_preview pencilbw,"${5-6}",\
"${7-8}"
#@gimp B&amp;W stencil [animated] : gimp_animate_stencilbw, gimp_animate_stencilbw_preview(1)
#@gimp : Frames = _int(10,2,100)
#@gimp : Output frames = _bool(1)
#@gimp : Output files = _bool(0)
#@gimp : Output folder = _folder()
#@gimp : Note = note{"\n<b>Starting parameters :</b>"}
#@gimp : Edge threshold = float(10,0,30)
#@gimp : Smoothness = float(10,0,30)
#@gimp : Note = note{"\n<b>Ending parameters :</b>"}
#@gimp : Edge threshold = float(10,0,30)
#@gimp : Smoothness = float(20,0,30)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_animate_stencilbw :
-if $3 filename="$4/gmic_stencilbw.png" -else filename="" -endif
-animate stencilbw,"${5-6}",\
"${7-8}",$1,$2,@{-quote\ $filename}
gimp_animate_stencilbw_preview :
-gimp_animate_preview stencilbw,"${5-6}",\
"${7-8}"
#@gimp Cartoon [animated] : gimp_animate_cartoon, gimp_animate_cartoon_preview(0)
#@gimp : Frames = _int(10,2,100)
#@gimp : Output frames = _bool(1)
#@gimp : Output files = _bool(0)
#@gimp : Output folder = _folder()
#@gimp : Note = note{"\n<b>Global parameters :</b>"}
#@gimp : Color quantization = int(4,2,256)
#@gimp : Note = note{"\n<b>Starting parameters :</b>"}
#@gimp : Smoothness = float(0.5,0,2)
#@gimp : Sharpening = float(200,0,400)
#@gimp : Edge threshold = float(10,1,30)
#@gimp : Edge thickness = float(0.1,0,1)
#@gimp : Color strength = float(1.5,0,3)
#@gimp : Note = note{"\n<b>Ending parameters :</b>"}
#@gimp : Smoothness = float(3,0,2)
#@gimp : Sharpening = float(200,0,400)
#@gimp : Edge threshold = float(10,1,30)
#@gimp : Edge thickness = float(0.1,0,1)
#@gimp : Color strength = float(1.5,0,3)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_animate_cartoon :
-if $3 filename="$4/gmic_cartoon.png" -else filename="" -endif
-animate cartoon,"${6-10},$5",\
"${11-15},$5",$1,$2,@{-quote\ $filename}
gimp_animate_cartoon_preview :
-gimp_animate_preview cartoon,"${6-10},$5",\
"${11-15},$5"
#@gimp Edges on fire : gimp_fire_edges, gimp_fire_edges_preview(0)
#@gimp : Edges = float(0.7,0,3)
#@gimp : Attenuation = float(0.25,0,1)
#@gimp : Smoothness = float(0.5,0,5)
#@gimp : Threshold = float(25,0,100)
#@gimp : Sep = separator()
#@gimp : Number of frames = _int(20,1,999)
#@gimp : Starting frame = int(20,0,199)
#@gimp : Frame skip = _int(0,0,20)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>07/06/2011</i>.</small>")
gimp_fire_edges :
-fire_edges ${1-7} -rv
gimp_fire_edges_preview :
-gimp_split_preview "-fire_edges $1,$2,$3,$4,1,$6,0",$-1
#@gimp Edges [animated] : gimp_animate_edges, gimp_animate_edges_preview(0)
#@gimp : Frames = _int(10,2,100)
#@gimp : Output frames = _bool(1)
#@gimp : Output files = _bool(0)
#@gimp : Output folder = _folder()
#@gimp : Note = note{"\n<b>Global parameters :</b>"}
#@gimp : Negative colors = bool(0)
#@gimp : Note = note{"\n<b>Starting parameters :</b>"}
#@gimp : Smoothness = float(0,0,10)
#@gimp : Edge threshold = float(10,0,30)
#@gimp : Note = note{"\n<b>Ending parameters :</b>"}
#@gimp : Smoothness = float(0,0,10)
#@gimp : Edge threshold = float(30,0,30)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_animate_edges :
-if $3 filename="$4/gmic_edges.png" -else filename="" -endif
-animate gimp_edges,"${6-7},$5",\
"${8-9},$5",$1,$2,@{-quote\ $filename}
gimp_animate_edges_preview :
-gimp_animate_preview gimp_edges,"${6-7},$5",\
"${8-9},$5"
#@gimp Lava lamp : gimp_lavalampbw, gimp_lavalampbw_preview(0)
#@gimp : Number of key-frames = _int(3,2,50)
#@gimp : Number of inter-frames = _int(30,2,100)
#@gimp : Smooth looping = _bool(1)
#@gimp : Sep = separator()
#@gimp : Resolution = float(20,1,100)
#@gimp : Size = float(2,0,30)
#@gimp : Smoothness = _float(0.01,0,1)
#@gimp : Transparent background = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>07/06/2011</i>.</small>")
gimp_lavalampbw :
-if {!@#} (255;100^64;16^128;0) -r[-1] 512,512,1,3,3 -endif
-repeat @# -l[$<]
w={w} h={h}
--r $4%,$4%,1,1,0 [-1]x{$1-1} -rand[^0] 0,1 -stencil[^0] $5,0
-if $3 [1] -endif
-morph[^0] $2,$6,0
-stencil[^0] $5,0
-r[^0] $w,$h,1,1,3 -b[^0] 10 ->=[^0] 50% -*[^0] 255
-r[^0] 100%,100%,1,4 -j[^0] [0] -rm[0]
-if $3 -rm[-1] -endif
-endl -done
-if {!$7} -repeat @# -l[$>] -split_opacity -n[-1] 0,1 -*[^-1] [-1] -rm[-1] -endl -done -endif
gimp_lavalampbw_preview :
-gimp_lavalampbw 2,2,1,$4,$5,$6,$7 -k[0]
#@gimp Lissajous [animated] : gimp_animate_lissajous, gimp_animate_lissajous_preview(1)
#@gimp : Frames = _int(10,2,100)
#@gimp : Output as frames = _bool(1)
#@gimp : Output as files = _bool(0)
#@gimp : Output folder = _folder()
#@gimp : Sep = separator()
#@gimp : Note = note{"<b>Starting parameters :</b>"}
#@gimp : Resolution = int(4096,2,8192)
#@gimp : X-size = float(0.9,0,2)
#@gimp : Y-size = float(0.9,0,2)
#@gimp : Z-size = float(3,1,10)
#@gimp : X-multiplier = float(8,0,32)
#@gimp : Y-multiplier = float(7,0,32)
#@gimp : Z-multiplier = float(0,0,32)
#@gimp : X-offset = float(0,0,1)
#@gimp : Y-offset = float(0,0,1)
#@gimp : Z-offset = float(0,0,1)
#@gimp : X-angle = float(0,0,360)
#@gimp : Y-angle = float(0,0,360)
#@gimp : Z-angle = float(0,0,360)
#@gimp : Thickness = float(0,0,50)
#@gimp : Color = color(255,255,255,255)
#@gimp : Sep = separator()
#@gimp : Note = note{"<b>Ending parameters :</b>"}
#@gimp : Resolution = int(4096,2,8192)
#@gimp : X-size = float(0.9,0,2)
#@gimp : Y-size = float(0.9,0,2)
#@gimp : Z-size = float(3,1,10)
#@gimp : X-multiplier = float(8,0,32)
#@gimp : Y-multiplier = float(7,0,32)
#@gimp : Z-multiplier = float(0,0,32)
#@gimp : X-offset = float(0,0,1)
#@gimp : Y-offset = float(0,0,1)
#@gimp : Z-offset = float(0,0,1)
#@gimp : X-angle = float(0,0,360)
#@gimp : Y-angle = float(0,0,360)
#@gimp : Z-angle = float(0,0,360)
#@gimp : Thickness = float(0,0,50)
#@gimp : Color = color(255,255,255,255)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>04/18/2011</i>.</small>")
gimp_animate_lissajous :
-if $3 filename="$4/gmic_lissajous.png" -else filename="" -endif
-animate gimp_lissajous,"${5-22}",\
"${23-40}",$1,$2,@{-quote\ $filename}
gimp_animate_lissajous_preview :
-gimp_animate_preview gimp_lissajous,"${5-22}",\
"${23-40}",0
#@gimp Morphological filter [animated] : gimp_animate_morpho, gimp_animate_morpho_preview(0)
#@gimp : Frames = _int(10,2,100)
#@gimp : Output as frames = _bool(1)
#@gimp : Output as files = _bool(0)
#@gimp : Output folder = _folder()
#@gimp : Note = note{"\n<b>Global parameters :</b>"}
#@gimp : Action = choice("Erosion","Dilation","Opening","Closing",
#@gimp : "Original - Erosion","Dilation - Original","Original - Opening","Closing - Original")
#@gimp : Negative = bool()
#@gimp : Shape = choice(0,"Square","Octagonal","Circular")
#@gimp : Note = note{"\n<b>Starting parameters :</b>"}
#@gimp : Size = int(5,1,100)
#@gimp : Note = note{"\n<b>Ending parameters :</b>"}
#@gimp : Size = int(50,2,100)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_animate_morpho :
-if $3 filename="$4/gmic_morpho.png" -else filename="" -endif
-animate gimp_morpho,"$5,$8,$6,$7,0,1",\
"$5,$9,$6,$7,0,1",$1,$2,@{-quote\ $filename}
gimp_animate_morpho_preview :
-gimp_animate_preview gimp_morpho,"$5,$8,$6,$7,0,1",\
"$5,$9,$6,$7,0,1"
#@gimp Object animation : gimp_tk_animateobject, gimp_tk_animateobject_preview(1)
#@gimp : Sep = separator()
#@gimp : Note = note("Object motion:")
#@gimp : X-motion = float(0,-100,100)
#@gimp : Y-motion = float(0,-100,100)
#@gimp : Z-motion = float(0,-10,50)
#@gimp : Sep = separator()
#@gimp : Note = note("Camera position:")
#@gimp : Camera x = float(0.5,0,1)
#@gimp : Camera y = float(0.5,0,1)
#@gimp : Sep = separator()
#@gimp : Note = note("Frame settings:")
#@gimp : Frame size = int(400,50,1920)
#@gimp : Frames = int(2,2,100)
#@gimp : Reverse motion = bool(0)
#@gimp : Note = note("<small>Your mask must be placed below your image. Switch input layers to <i><b>Active and below</b></i>.</small>")
#@gimp : Sep = separator()
#@gimp : Work on frameset = bool(0)
#@gimp : Note = note("<small>To use this option your mask must be placed below your frames. Switch input layers to <i><b>All</b></i>.</small>")
#@gimp : Sep = separator()
#@gimp : Note = note("Advanced settings:")
#@gimp : Sharpen object = float(0,0,10)
#@gimp : Expand background reconstruction = float(0,0,50)
#@gimp : Smoothen background reconstruction = float(0,0,1)
#@gimp : Adjust background reonstruction = float(1,1,256)
#@gimp : Sep = separator()
#@gimp : Blue screen mode = bool(0)
#@gimp : Note = note("<small>Layer stack for images: Object image top, background image below, mask bottom. Layer stack for framesets: Frameset top, object image below, mask bottom. Switch input layers to <i><b>All</b></i>.</small>")
#@gimp : Sep = separator()
#@gimp : Camera motion only = bool(0)
#@gimp : Closeup = float(1,1,10)
#@gimp : Note = note("<small>Use this option without mask layer. Switch input layers to <i><b>Active</b></i> or <i><b>All</b></i></small>")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Tom Keil</i>.      Latest update: <i>04/08/2012</i>.</small>")
gimp_tk_animateobject :
-if {@#<=1} -return -endif
-if {$15==0}
-to_rgb -if {$9==0}
-r {w*{$6/max(w,h)}},{h*{$6/max(w,h)}},1,{s},6 -c 0,255
-if {$14==0}
[-1,-2] [0] -rv[0,1]
-blur_xy[0] $11 -t2[0] $13,256 -n[0] 0,255
-tk_gimp_replace_color[0] 1,0,0,0,0,255,0,0,0,0
-blur_xy[0] $12 -inpaint[1] [0]
-rm[0] -rv[-1,-2]
-else [0] -rv[0,1] -rv[-1,-2]
[0] [0]
[-3] [-1]
-to_gray[-1,-2] -t2[-1,-2] 128,256 -n[-1,-2] 0,255
-s[1] c -a[1,2,3,-1] c
-s[2] c -a[2,3,4,-1] c
-rv[1,-1] -compose_rgba[1,-1]
-rv[2,-1] -compose_rgba[2,-1]
-to_rgb[1,2]
-endif
dx={$1/$7} dy={$2/$7} dz=1 -repeat $7
-shift[-1,-2] $dx%,$dy%
-if {$3>=0} dz={$dz+{{$3}/$7}}
-else dz={$dz-{{{1-{10.01+$3}/10}}/$7}} -endif
--gimp_zoom[-1,-2] $dz,$4,$5,0
-to_gray[-1] -t2[-1] 128,256 -n[-1] 0,255 -to_rgb[-2]
-s[-2] c -a[-4,-3,-2,-1] c
-if {$10!=0} -unsharp[-1] {$10/5},{$10/2},0 -cut[-1] 0,255  -endif
-mv[-1] -3 -done -rm[-1,-2] -rv -rv[-1,-2]
index={-3} -repeat $7
[-2] -rv[-1,-2] index={$index-1}
-rv[-3,$index] -compose_rgba[-3,$index]
-done -rm[-2] -if {$8==1} -rv -endif
-else
-if {$14==0} frames={@#-1} counter={-5}
[-1,-2]
--blur_xy[-1] $11 -t2[-1] $13,256 -n[-1] 0,255
-tk_gimp_replace_color[-1] 1,0,0,0,0,255,0,0,0,0
-blur_xy[-1] $12
-repeat $frames -inpaint[$counter] [-1]
counter={$counter-1} -done -rm[-1,-4]
[-1,-2]
-else frames={@#-2} --to_gray[-1]
-s[-3] c -a[-5,-4,-3,-1] c
--to_gray[-1] --fc[-1] 0,0,0
-rv[-1,-4] -compose_rgba[-1,-4] -mv[-1] -3
-endif
counter={-6} dx=0 dy=0 dz=1 -repeat {$frames}
[-1,-2]
-shift[-1,-2] $dx%,$dy%
-if {$3>=0} dz={$dz+{{$3}/$frames}}
-else dz={$dz-{{{1-{10.01+$3}/10}}/$frames}} -endif
--gimp_zoom[-1,-2] $dz,$4,$5,0
-to_gray[-1] -t2[-1] 128,256 -n[-1] 0,255 -to_rgb[-2]
-s[-2] c -a[-4,-3,-2,-1] c
-if {$10!=0} -unsharp[-1] {$10/5},{$10/2},0 -cut[-1] 0,255 -endif
-mv[-1] $counter
-compose_rgba[$counter,{$counter-1}]
dx={$dx+{$1/$frames}} dy={$dy+{$2/$frames}}
counter={$counter-1}
-rm[-1,-2]
-done  -rm[-1,-2,-3,0]
-endif
#camera motion only
-else
-to_rgb -if {$9==0}
-r {w*{$6/max(w,h)}},{h*{$6/max(w,h)}},1,{s},6 -c 0,255 -endif
dx=0 dy=0 dz=1 -if {$9==0} counter=$7 -else counter={@#-1} -endif
index={-2} -repeat $counter
-if {$9==0} [-1] -mv[-1] $index -endif
dx={$dx+{$1/$7}} dy={$dy+{$2/$7}}
-shift[$index] $dx%,$dy%
-if {$3>=0} dz={$dz+{{$3}/$7}}
-else dz={$dz-{{{1-{10.01+$3}/10}}/$7}} -endif
-gimp_zoom[$index] $16,$4,$5,0
-gimp_zoom[$index] $dz,$4,$5,0
-if {$10!=0} -unsharp[$index] {$10/5},{$10/2},0 -cut[$index] 0,255 -endif
index={$index-1} -done
-if {$16!=1} -rm[-1] -endif -endif
#preview function
gimp_tk_animateobject_preview:
-if {$15==0} start_x={{xM/w}*100} start_y={{yM/h}*100} -else start_x=50 start_y=50 -endif
-gimp_tk_animateobject ${1-6},1,${8--1} -k[0]
-line[0] {$1+$start_x}%,{$2+$start_y-10}%,{$1+$start_x}%,{$2+$start_y+10}%,1,255,0,0
-line[0] {$1+$start_x-10}%,{$2+$start_y}%,{$1+$start_x+10}%,{$2+$start_y}%,1,255,0,0
-line[0] {$4*100}%,0%,{$4*100}%,{{$5*100}-5}%,1,255,255,0
-line[0] {$4*100}%,{{$5*100}+5}%,{$4*100}%,100%,1,255,255,0
-line[0] 0%,{$5*100}%,{{$4*100}-5}%,{$5*100}%,1,255,255,0
-line[0] {{$4*100}+5}%,{$5*100}%,100%,{$5*100}%,1,255,255,0
#@gimp Plasma transition : gimp_transition_plasma, gimp_transition_plasma_preview(0)
#@gimp : Frames = _int(30,2,100)
#@gimp : Scale = int(5,0,10)
#@gimp : Smoothness = float(0.5,0,4)
#@gimp : Sep = separator(), note = note{"<small><b>Note:</b>
#@gimp : This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/09/2012</i>.</small>")
gimp_transition_plasma :
-transition_plasma $1,$2,$3%
gimp_transition_plasma_preview :
-if {@#==1} -gimp_warning_preview "Missing input layer" -return -endif
-k[0,1] -transition_plasma 6,$2,$3% -k[1--2] -frame 1,1,0 -append_tiles ,
#@gimp Rodilius [animated] : gimp_animate_rodilius, gimp_animate_rodilius_preview(1)
#@gimp : Frames = _int(10,2,100)
#@gimp : Output as frames = _bool(1)
#@gimp : Output as files = _bool(0)
#@gimp : Output folder = _folder()
#@gimp : Color mode = choice(1,"Darker","Lighter")
#@gimp : Note = note{"\n<b>Starting parameters :</b>"}
#@gimp : Amplitude = float(10,0,30)
#@gimp : Thickness = float(10,0,100)
#@gimp : Sharpness = float(300,0,1000)
#@gimp : Orientations = int(5,2,20)
#@gimp : Offset = float(0,0,180)
#@gimp : Note = note{"\n<b>Ending parameters :</b>"}
#@gimp : Amplitude = float(10,0,30)
#@gimp : Thickness = float(10,0,100)
#@gimp : Sharpness = float(300,0,1000)
#@gimp : Orientations = int(5,2,20)
#@gimp : Offset = float(180,0,180)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_animate_rodilius :
-if $3 filename="$4/gmic_rodilius.png" -else filename="" -endif
-animate rodilius,"${6-10},$5",\
"${11-15},$5",$1,$2,@{-quote\ $filename}
gimp_animate_rodilius_preview :
-gimp_animate_preview rodilius,"${6-10},$5",\
"${11-15},$5"
#@gimp Soft glow [animated] : gimp_animate_glow, gimp_animate_glow_preview(1)
#@gimp : Frames = _int(10,2,100)
#@gimp : Output as frames = _bool(1)
#@gimp : Output as files = _bool(0)
#@gimp : Output folder = _folder()
#@gimp : Note = note{"\n<b>Starting parameters :</b>"}
#@gimp : Amplitude = float(0,0,8)
#@gimp : Note = note{"\n<b>Ending parameters :</b>"}
#@gimp : Amplitude = float(3,0,8)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_animate_glow :
-if $3 filename="$4/gmic_glow.png" -else filename="" -endif
-animate glow,"$5",\
"$6",$1,$2,@{-quote\ $filename}
gimp_animate_glow_preview :
-gimp_animate_preview glow,"$5",\
"$6"
#@gimp _
#@gimp <b>Stereoscopic 3d</b>
#@gimp 3d conversion : gimp_tk_make3D, gimp_tk_make3D_preview(1)
#@gimp : Sep = separator()
#@gimp : Note = note("Stereoscopic settings:")
#@gimp : Scene selector = choice("automatic depth estimation","daylight scene","optimized lateral inhibition","light motive","dark motive","landscape","center foreground","center background","left foreground","left diagonal foreground","right foreground","right diagonal foreground","left and right foreground","left and right background","bottom and top foreground","bottom and left foreground","bottom and right foreground","central perspective outdoor","central perspective indoor","portrait","human 1","human 2","studio","underwater","flat")
#@gimp : Far point deviation = float(20,-100,100)
#@gimp : Stereoscopic window position = float(0,-100,100)
#@gimp : Depth field control = float(20,0,100)
#@gimp : Feature analyzer threshold = float(0,0,5)
#@gimp : Feature analyzer smoothness = float(0,0,5)
#@gimp : Local detail enhancer = float(0,0,5)
#@gimp : Dof analyzer = float(0,0,5)
#@gimp : Frequency analyzer = float(0,0,5)
#@gimp : Flip left / right = bool(0)
#@gimp : Use individual depth map = bool(0)
#@gimp : Note = note("<small>To use this option your depth map must be placed below your image. Switch input layers to <i><b>Active and below</b></i>.</small>")
#@gimp : Sep = separator()
#@gimp : Note = note("Image settings:")
#@gimp : Black & white = bool (0)
#@gimp : Output format = choice("Anaglyph red/cyan","Anaglyph red/cyan optimized","Anaglyph blue/yellow","Anaglyph blue/yellow optimized","Anaglyph green/magenta","Anaglyph green/magenta optimized","Full side by side keep width","Full side by side keep uncompressed","Full bottom/top","Half side  by side","Half bottom/top","Interlace horizontal","Interlace vertical","Full HD frame packing","Unaligned images","Depth map only")
#@gimp : Gamma compensation = float(1.2,0,4)
#@gimp : Anti-ghosting = float(25,0,255)
#@gimp : Color boost = float(1,0,4)
#@gimp : Anaglyph glasses adjustment = float(0,-100,100)
#@gimp : Autocrop = bool (1)
#@gimp : Bidirectional rendering = bool (0)
#@gimp : Sep = separator()
#@gimp : Note = note("Frame settings:")
#@gimp : Render multiple frames = bool (0)
#@gimp : Render routine for wiggle animations = bool (0)
#@gimp : Frames = int(2,2,100)
#@gimp : Frame size = int(200,50,1920)
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>.      Latest update: <i>09/20/2012</i>.</small>")
#@gimp : Note = link("Filter explained here",http://www.tkfilter.bplaced.net/TKFilter%20tutorials%202Dto3D%203D-automatic%20stereoscopic%20conversion.html)
gimp_tk_make3D :
# prepare image
sh={-$2} sw={-$sh-$3} size1={w} size2={h} -to_rgb[0] -r[0] $size1,$size2 [0]
# create depth map
-if {$11==0}
--gimp_tk_depthmap[-1] $1,$4,$5,$6,$7,$8,$9,0,0,0 -r[-1] $size1,$size2
-gimp_gaussian_blur[-1] 0,{{w+h}/700},{{w+h}/350},1,0,0,0
# individual depth map
-else -if {{@#}!=3}
-error[] "For individual depth map select input mode ACTIVE AND BELOW" -endif
-rv[1,-1] -to_rgb[-1] -luminance[-1]
# analyze image features to enrich individual maps
-if {$11==1}
-if {$9!=0}
--fc[0] 128,128,128 --channels[0] 2 -negative[-1] -c[-1] 0,90
-n[-1] 0,128 -rv[-1,-2] -compose_darken[-1,-2]
--channels[0] 0 -negative[-1] -c[-1] 165,255 -n[-1] 128,255 -rv[-1,-2]
-compose_hardlight[-1,-2] -rv[-1,-2]
-if {$11==0} -if {$1!=20} -gimp_compose_average[-1,-2] {$9/5}
-else -gimp_compose_value[-1,-2] {$9/5},0
-tk_gimp_channel_processing[-1] 1,{$4/25},0,0,0,0,100,256,0,0,0,2,0,0
-endif
-else -gimp_compose_value[-1,-2] {$9/5},0 -endif -endif
-if {$8!=0} --gimp_highpass[0] 2,2,0,0,0
-tk_gimp_replace_color[-1] 5,0,128,128,128,255,0,0,0,255
-gimp_morpho[-1] 3,70,0,0,0,1,0   -to_gray[-1] av=@{-1,a}
-t2[-1] $av,255 -n[-1] 0,255 -blur_xy[-1] 25
-rv[-1,-2] -gimp_compose_overlay[-1,-2] {$8/5} -endif
-if {$5!=0} --gimp_isophotes[0] {{$5*3}+2},0,0,0
-gimp_morpho[-1] 3,{5-{$5/2}},0,0,0,1,0
-tk_gimp_channel_processing[-1] 1,1,255,0,0,0,100,256,0,0,0,2,0,0
-rv[-1,-2] -gimp_compose_overlay[-1,-2] {$5/10}
--gimp_gradient_norm[0] {$6*2},{1.5-{0.1+{$5/3.6}}},0,100,0,0
-rv[-1,-2] -compose_lighten[-1,-2] -gimp_segment_watershed[-1] $5,$6,0,0
-endif
-if {$7!=0} --luminance[0] -gimp_map_tones[-1] 1,{0.25-{$7/20}},0,30,3,0
-rv[-1,-2] -gimp_compose_overlay[-1,-2] {$7/10} -endif
-n[-1] 0,255
-endif -endif
#frame size for multiple frames
-if {$20==1} -r {w*{$23/max(w,h)}},{h*{$23/max(w,h)}},1,3,6 -c 0,255 -endif
#create second view
-if {$20==0}
-if {$13!=15} -if {$19==0}
-if {$sw<=0} -negative[-1] -endif
-r[-1] $size1,$size2,1,2 -s[-1] c -f[-1] 0 -n[-2] 0,$sw -a[-1,-2] c
-warp[-2] [-1],1 -shift[-2] $sh,0 -rm[-1]
-else
[-1] -r[-1,-2] 100%,100%,1,2
-s[-1] c -f[-1] 0 -n[-2] 0,{abs($sw/2)} -a[-1,-2] c
-negative[-2] -s[-2] c -f[-2] 0 -n[-3] 0,{-abs($sw/2)} -a[-2,-3] c
-warp[-4] [-2],1 -warp[-3] [-1],1
-shift[-3] $sh,0 -rm[-1,-2]
-endif -endif
-else
#create multiple frames
-if {$19==0}
count={$22} dev=0 -repeat $count dev={$dev+{$sw/$22}}
[0] -rv[-1,-2]
-if {$sw<=0} -negative[-1] -endif
-r[-1] 100%,100%,1,2 -s[-1] c -f[-1] 0
-if {$21==0} -n[-2] 0,$dev -else -n[-2] {-$dev},$dev -endif
-a[-1,-2] c -warp[-2] [-1],1 -to_gray[-1] -n[-1] 0,255
-if {$sw<=0} -negative[-1] -endif
-done -rm[-1,0] -rv
-else
count={abs($22/2)} dev=0
-repeat $count dev={$dev+{$sw/$count}}
[-2] -rv[-1,-2]
[-2] -rv[-1,-2]
[-1] -r[-1,-2] 100%,100%,1,2
-s[-1] c -f[-1] 0
-if {$21==0} -n[-2] 0,{abs($dev/2)}
-else -n[-2] {-abs($dev/2)},{abs($dev/2)} -endif
-a[-1,-2] c
-negative[-2] -s[-2] c -f[-2] 0
-if {$21==0} -n[-3] 0,{-abs($dev/2)}
-else -n[-3] {-abs($dev/2)},{abs($dev/2)} -endif
-a[-2,-3] c
-warp[-4] [-2],1 -warp[-3] [-1],1 -rm[-2] -to_gray[-1] -n[-1] 0,255
-mv[-4] -1 -done -rm[-1,-2] -mv[0--1:2] -1 -rv[0-50%] -mv[0] 50%
-endif -endif
#crop images
-if {$20==0} -if {$18==1} -if {$13!=15}
-if {$sh>=0} -crop[-1,-2] $sh,0,{w},{h} -else -crop[-1,-2] 0,0,{w+$sh},{h} -endif
-if {$19==0}
-if {$sw>=0} -crop[-1,-2] $sw,0,{w},{h} -else -crop[-1,-2] 0,0,{w+$sw},{h} -endif
-else -crop[-1,-2] {abs($sw/2)},0,{w-abs($sw/2)},{h}
-endif -endif -endif -endif
#align stereoscopic image
-if {$12==1} -gimp_blackandwhite 0.299,0,0.587,0,0.114,0,1,1,0,0,0,0,0,0,2,0,0,0,16,4,0,0,0 -endif
-if {$20==0}
-if {{$13!=14}&&{$13!=15}}
-gimp_tk_stereoimage[0,1] $13,$10,$14,$15,$16,$17
-elif {$13==14} -k[0,1]
-elif {$13==15} -k[-1]
-endif
-endif
-if {$13==14} -apply_gamma $14 -tk_gimp_channel_processing 1,1,$15,0,0,0,100,256,0,0,1,10,7,0
-gimp_mix_lab 1,0,0,$16,0,0,$16,0,0,0,2,0 -endif
gimp_tk_make3D_preview :
-if {$20==0} shpre={$2/3} swpre={$3/3} -else shpre={$2*{400/$23}} swpre={$3*{400/$23}} -endif
-if {{$11==1}&&{{@#}!=2}} -fc[0] 255,0,128,255 -k[0] -text "For individual depth map",10,80%,20,1,0,0,0,255
-text "select input mode ACTIVE AND BELOW.",10,90%,20,1,0,0,0,255
-else
-gimp_tk_make3D $1,$shpre,$swpre,${4-12},{if({$20==1},14,$13)},${14-19},0,${21-23} -if {{$13==14}||{$20==1}} -k[1] -endif
-endif
#@gimp 3d video conversion : gimp_tk_video3D, gimp_tk_video3D_preview(1)
#@gimp : Sep = separator()
#@gimp : Note = note("<b>Stereoscopic settings:</b>")
#@gimp : Scene selector = choice("automatic depth estimation","daylight scene","optimized lateral inhibition","light motive","dark  motive","landscape","center foreground","center background","left  foreground","left diagonal foreground","right foreground","right diagonal  foreground","left and right foreground","left and right background","bottom and top foreground","bottom and left foreground","bottom and right foreground","central  perspective outdoor","central perspective indoor","portrait","human 1","human  2","studio","underwater","flat")
#@gimp : Far point deviation = float(10,-100,100)
#@gimp : Stereo window position = float(-10,-100,100)
#@gimp : Depth field control = float(20,0,100)
#@gimp : Feature analyzer threshold = float(0,0,5)
#@gimp : Feature analyzer smoothness = float(0,0,5)
#@gimp : Local detail enhancer = float(0,0,5)
#@gimp : Dof analyzer = float(0,0,5)
#@gimp : Frequency analyzer = float(0,0,5)
#@gimp : Motion analyzer = float(0,-5,5)
#@gimp : Flip left / right = bool(0)
#@gimp : Sep = separator()
#@gimp : Note = note("<b>Frames settings:</b>")
#@gimp : Black & white = bool (0)
#@gimp : Output format = choice("Anaglyph red/cyan","Anaglyph red/cyan optimized","Anaglyph blue/yellow","Anaglyph blue/yellow optimized","Anaglyph green/magenta","Anaglyph green/magenta optimized","Full side by side keep width","Full side by uncompressed","Full bottom/top","Half side  by side","Half bottom/top","Interlace horizontal","Interlace vertical","Full HD frame packing","Left and right image streams","Depth maps only")
#@gimp : Output to folder = bool(0)
#@gimp : Folder name = folder()
#@gimp : Gamma compensation = float(1.2,0,4)
#@gimp : Anti-ghosting = float(25,0,255)
#@gimp : Color boost = float(1,0,4)
#@gimp : Anaglyph glasses adjustment = float(0,-100,100)
#@gimp : Autocrop = bool (1)
#@gimp : Set frame format = bool (1)
#@gimp : Frame width = int(1280,128,4096)
#@gimp : Frame format = choice(1,"4:3","16:9","3:2","2:1","21:9","Keep aspect ratio")
#@gimp : Frames offset = int(0,-5,5)
#@gimp : Reverse frame stack = bool(0)
#@gimp : Sep = separator()
#@gimp : Note = note("<b>Input settings:</b>")
#@gimp : Processing mode = choice("Layer processing","Batch processing")
#@gimp : Input folder = folder()
#@gimp : Input frame files name = text("frame_")
#@gimp : Start frame number = int(0,0,99998)
#@gimp : End frame number = int(1,1,99999)
#@gimp : Frame files format = choice(".png",".bmp")
#@gimp : Sep = separator()
#@gimp : Note = note("<b>Advanced editing:</b>")
#@gimp : Activate custom filter = choice("off","on","left stream only", "right stream only")
#@gimp : Custom filter code = text(1,"# old movie #\n#-luminance -gimp_stripes_y 10,3,0 -sepia \n\n#simple vintage#\n#--fc 0,15,125 -rv -gimp_compose_exclusion 0.3 \n\n# HDR popout #\n#-gimp_map_tones_fast 2,0.3,3,2 -gimp_unsharp_octave 4,5,3,0,0,0\n\n")
#@gimp : Depth fade in frames = int(0,0,120)
#@gimp : Depth fade out frames = int(0,0,120)
#@gimp : Sep = separator()
#@gimp : Note = note("<b>Advanced quality control:</b>")
#@gimp : Key frame rate = int(1,1,100)
#@gimp : Stabilizer = float(5,0,100)
#@gimp : Preprocessor radius = float(0,0,5)
#@gimp : Preprocessor power = float(0,0,5)
#@gimp : Custom depth correction = choice("None","Custom correction map","Single custom depth map","Custom depth maps stream")
#@gimp : Rendering mode = choice(1,"Right eye view","Bidirectional rendering","Align image streams","Anaglyph reconstruction")
#@gimp : Sep = separator()
#@gimp : Note = note("<b>Preview:</b>")
#@gimp : Preview type = Choice("first frame","last frame","selected frame","full layer stack -slow!-")
#@gimp : Preview frame selection = int(0,0,99999)
#@gimp : Sep = separator(), note = note("<small><b>Switch input layers to All.</b></small>")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>.       Latest update: <i>10/07/2012</i>.</small>")
#@gimp : Note = link("Filter explained  here",http://www.tkfilter.bplaced.net/TKFilter%20tutorials%202Dto3D%203D-automatic%20stereoscopic%20conversion.html)
gimp_tk_video3D :
sh={-$2} sw={-$sh-$3} size1={w} size2={h}
-if {narg($_previewflag)==0} _previewflag=0 -endif
-if {$_previewflag!=0} sh={$sh*{400/$22}} sw={$sw*{400/$22}} -endif
-if {$26==0}
####layer based conversion####
-if {{$34!=0}||{$35!=0}}
-if {{$34>={{@#}-$35}}||{$35>={{@#}-$34}}} -error[] "Fade out of frame range."
-endif -endif
-if {$13!=14} -channels 0,2 -endif
-if {$_previewflag!=2}  frames={@#} -else frames=1  -endif
counter={@#} index=0
-if {$_previewflag!=0} -r 400,328 -endif
# image stream alignment and 2D filtering only modes
#-if {{$41==3}&&{$_previewflag==0}} -error[] "Anaglyph video reconstruction in batch processing mode only" -endif
flag3d=0 -if {$41!=2}
-if {!{{$2==0}&&{$3==0}&&{$1==24}&&{$13==14}&&{$32!=0}}} flag3d=1
# start 3D conversion per frame
-repeat {$frames}
# prepare images
[$index]
# create depth maps
-if {{$40==0}||{$40==1}}
--gimp_tk_depthmap[$index] $1,$4,$5,$6,$7,$8,$9,$38,$39,{w*{$37/1000}}
-r[-1] $size1,$size2 -endif
-if {$40==1}
infilec="correction.png" inpathc="$27/"$infilec""
-input[-1] @{"-quote \""$inpathc"\""}
-to_rgba[-1,-2] -compose_rgba[-1,-2] -to_rgb[-1]
-elif {$40==2}
infilec="depthmap.png" inpathc="$27/"$infilec""
-input[-1] @{"-quote \""$inpathc"\""}
-elif {$40==3}
-if {$_previewflag==2}
infilec="depthmap_"$_mapin".png" inpathc="$27/depthmaps/"$infilec""
-else
infilec="depthmap_"{$frames-$index}".png" inpathc="$27/depthmaps/"$infilec""
-endif
-input[-1] @{"-quote \""$inpathc"\""}
-rv[$index,-2]
-endif
-if {$_previewflag!=0} -r 400,328 -endif
# motion analysis
-if {$10!=0}
-if {$_previewflag==2} [0] -mv[-4] -1
-compose_difference[-1,-2] -luminance[-1] -n[-1] 0,255
-t2[-1] 0,{{$37/2}+1} -negative[-1] -n[-1] 0,255
-else
[$index] [{$index+1}]
-compose_difference[-1,-2] -luminance[-1] -n[-1] 0,255
-t2[-1] 0,{{$37/2}+1}
-negative[-1] -n[-1] 0,255
-if {$index<={$frames-2}} --negative[-1] -endif
-endif
-endif
index={$index+1} -done
-if {$10!=0}
-if {$_previewflag==2}
-if {$42==0}  infile={$29} -elif {$42==1} infile={$30} -elif {$42==2} infile={$43} -endif
-if {$infile==2} -rv[-1,-2] -else -if {$infile>={$29+2}}
-compose_difference[-4,-5] -luminance[-4] -n[-4] 0,255
-t2[-4] 0,1 -negative[-4] -n[-4] 0,255
-negative[-4] -compose_darken[-1,-4]
-mv[-3] -1 -endif -endif
-blur_xy[-2] {w*{$37/1000}}
-if {$infile!=$29} -if {$10>=0} -gimp_compose_lighten[-1,-2] {abs($10)/5}
-else -negative[-2] -gimp_compose_darken[-1,-2] {abs($10)/5} -endif -endif
-else
-rm[-1] -rm[{$counter+3}]
-repeat {$frames-2}
-mv[{$counter+6}] {$counter+2}
-compose_darken[{$counter+2},{$counter+3}]
-rv[{$counter+1},{$counter+2}]
-blur_xy[{$counter+1}] {w*{$37/1000}}
-if {$10>=0}
-gimp_compose_lighten[{$counter+1},{$counter+2}] {abs($10)/5}
-else -negative[{$counter+1}]
-gimp_compose_darken[{$counter+1},{$counter+2}] {abs($10)/5}
-endif
counter={$counter+2} -done
-rv[-3,-4] -blur_xy[-4] {w*{$37/1000}}
-if {$10>=0} -gimp_compose_lighten[-3,-4] {abs($10)/5}
-else -negative[-4] -gimp_compose_darken[-3,-4] {abs($10)/5} -endif
-endif
-endif
# create second view frameset
-if {$_previewflag==2} -if {$24!=0} -rm[-2] -endif -endif
index={-1} -repeat $frames
-if {$13!=15}
-if {$41==0} -if {$sw<=0} -negative[$index] -endif -endif
-if {$_previewflag!=2}
-if {$34!=0} -if {{-$index}<=$34} sw={{{-$index}/$34}*$sw} sh={{{-$index}/$34}*$sh}
-endif -endif
-if {$35!=0} -if {-{$index+1}>={$frames-$35}} sw={$sw*{{$frames-{-{$index+1}}}/$35}}
sh={$sh*{{$frames-{-{$index+1}}}/$35}} -endif -endif -endif
-if {$41==0}
-r[$index] 100%,100%,1,2 -s[$index] c -f[$index] 0 -n[{$index-1}] 0,$sw
-a[$index,{$index-1}] c -warp[{$index-1}] [$index],1
-shift[{$index-1}] $sh,0 -rm[$index]
-else
[$index]
-mv[-1] {$frames+{$index+1}}
-r[$index,{$frames+{$index+1}}] 100%,100%,1,2
-s[$index] c -f[$index] 0 -n[{$index-1}] 0,{abs($sw/2)} -a[$index,{$index-1}] c
-negative[{$frames+{$index+1}}] -s[{$frames+{$index+1}}] c
-f[{$frames+{$index+2}}] 0 -n[{$frames+{$index+1}}] 0,{-abs($sw/2)}
-a[{$frames+{$index+1}},{$frames+{$index+2}}] c
-warp[{$frames+{$index+0}}] [{$frames+{$index+1}}],1
-warp[{$index-1}] [$index],1
-shift[{$index-1}] $sh,0
-rm[$index,{$frames+{$index+1}}]
-endif
-endif
sh={-$2} sw={-$sh-$3}
-if {$_previewflag!=0} sh={$sh*{400/$22}} sw={$sw*{400/$22}} -endif
index={$index-1} -done
# frames offset
-if {$13!=15} -if {$_previewflag!=2}
-if {$24>=0} -repeat $24 -rm[-1] [$frames]
-mv[-1] $frames -done
-else counter={1} -repeat {abs($24)} -rm[$frames]
[{-$counter}] -mv[-1] {-$counter-1} counter={$counter+1} -done -endif
-endif -endif
# autocrop frames
-if {$20==1} -if {$13!=15}
-if {$sh>=0} -crop $sh,0,{w},{h} -else -crop 0,0,{w+$sh},{h} -endif
-if {$sw>=0} -crop $sw,0,{w},{h} -else -crop 0,0,{w+$sw},{h} -endif
-endif -endif
#end image stream alignment and 2D mode bypass
-endif -endif
# apply custom filter
-if {$_previewflag!=2}
-if {$32!=0} -if {$13!=15} -repeat @# -l[$>] -gimp_custom_code "$33",0,0,0 -endl -done -endif -endif
-else
-if {$32==1} -if {$13!=15} -gimp_custom_code[0,1] "$33",0,0,0 -endif
-elif {$32==2} -if {$13!=15} -l[0] -gimp_custom_code "$33",0,0,0 -endl -endif
-elif {$32==3} -if {$13!=15} -l[1] -gimp_custom_code "$33",0,0,0 -endl -endif
-endif -endif
# align stereoscopic images
-if {$41==2} -if {{$13==14}||{$13==15}} -error[] "Output format not allowed for image stream alignment" -endif -endif
-if {$12==1} -apply_channels_old "-gimp_blackandwhite 0.3,0,0.6,0,0.1,0,1,1,0,0,0,0,0,0,2,0,0,0,16,4,0,0,0",2 -endif
counter={$frames-1} index={-2}
-repeat $frames
-if {{$13!=14}&&{$13!=15}}
-gimp_tk_stereoimage[-1,$counter] $13,$11,$16,$17,$18,$19
-elif {$13==15} -rm[0,$index]
-endif counter={$counter-1} index={$index-1} -done
# adjust output image streams
-if {$13==14} -apply_gamma $16 -tk_gimp_channel_processing 1,1,$17,0,0,0,100,256,0,0,1,10,7,0
-gimp_mix_lab 1,0,0,$18,0,0,$18,0,0,0,2,0 -endif
# resize frames to output format
-if {$21==1} -if {$13!=13}
-if {$23==0} -r $22,{$22*0.75},1,{s},6
-elif {$23==1} -r $22,{{$22*9}/16},1,{s},6
-elif {$23==2} -r $22,{{$22*2}/3},1,{s},6
-elif {$23==3} -r $22,{$22*0.5},1,{s},6
-elif {$23==4} -r $22,{{$22*9}/21},1,{s},6
-elif {$23==5} -r $22,{$22*{h/w}},1,{s},6 -endif
-endif -endif  -c 0,255
-if {$25==1} -rv -endif
# save frames to folder
-if {$14==1}
-if {{$31==0}||{$13==15}} end=".png" -else end=".bmp" -endif
-rv
index={0} name=0
-if {{$13==14}&&{$flag3d==1}}
fileleft="$15/frame_left_"{$name+1}$end fileright="$15/frame_right_"{$name+1}$end
-else  -if {$13!=15} filename="$15/frame_"{$index+1}$end
-else  filename="$15/depthmap_"{$index+1}$end -endif -endif
-repeat $frames
-if {{$13==14}&&{$flag3d==1}}
-output[$index] @{"-quote \""$fileright"\""}
-output[{$index+$frames}] @{"-quote \""$fileleft"\""}
index={$index+1} name={$name+1}
fileleft="$15/frame_left_"{$name+1}$end fileright="$15/frame_right_"{$name+1}$end
-else
-output[$index] @{"-quote \""$filename"\""}
index={$index+1} -if {$13!=15} filename="$15/frame_"{$index+1}$end -else filename="$15/depthmap_"{$index+1}$end -endif
-endif
-done -rv
-endif
####batch based conversion####
-else
# load images in batch mode
-if {$31==0} end=".png" -else end=".bmp" -endif
infile={$29} inpath="$27/$28"$infile""$end"" outfile={$29}
frames={{$30-$29}+1} counter=1
-if {{$34!=0}||{$35!=0}}
-if {{$34>={$frames-$35}}||{$35>={$frames-$34}}} -error[] "Fade out of frame range"
-endif -endif
-if {$41==2}
inpathleft="$27/$28""left_"$infile$end inpathright="$27/$28""right_"$infile$end
-endif
av=1 var=1 avprev=1 varprev=1
-repeat $frames
-if {$41!=2}
-rm -input[0] @{"-quote \""$inpath"\""}
-if {{$24==0}} [0]
-else infile2={$infile+$24}
-if {$infile2<=$29} infile2={$29} -endif
-if {$infile2>=$30} infile2={$30} -endif
inpath2="$27/$28"$infile2""$end""
-input[1] @{"-quote \""$inpath2"\""} -endif
-else
-rm -input[0] @{"-quote \""$inpathleft"\""}
-input[1] @{"-quote \""$inpathright"\""}
-endif
size1={w} size2={h}
# image stream alignment and 2D filtering only modes
flag3d=0 -if {$41==3} flag3d=1 -endif -if {{$41!=2}&&{$41!=3}}
-if {!{{$2==0}&&{$3==0}&&{$1==24}&&{$13==14}&&{$32!=0}}} flag3d=1
# prepare images
-if {$13!=14} -channels[0,1] 0,2 -endif
# create depth map
-if {{$40==0}||{$40==1}}
av=@{0,a} var=@{0,v} diffav={{$av-$avprev}/$avprev*100} diffvar={{$var-$varprev}/$varprev*100}
-if {{abs($diffav)>=10}||{abs($diffvar)>=10}} scenechange=1 -else scenechange=0 -endif
-if {{$counter==1}||{$scenechange==1}||{{$counter/$36}=={round($counter/$36,1)}}}
--gimp_tk_depthmap[0] $1,$4,$5,$6,$7,$8,$9,$38,$39,{w*{$37/1000}} -r[-1] $size1,$size2
-if {$av!=0} avprev=$av -endif -if {$var!=0} varprev=$var -endif
-if {$36!=1} filename="$15/depthmap_temp.png"
-output[-1] @{"-quote \""$filename"\""} -endif
-else
filename="$15/depthmap_temp.png"
-input[-1] @{"-quote \""$filename"\""}
-endif
-endif
-if {$40==1}
infilec="correction.png" inpathc="$27/"$infilec""
-input[-1] @{"-quote \""$inpathc"\""}
-compose_rgba[-1,-2]
-elif {$40==2}
infilec="depthmap.png" inpathc="$27/"$infilec""
-input[-1] @{"-quote \""$inpathc"\""}
-elif {$40==3}
infilec="depthmap_"$infile".png" inpathc="$27/depthmaps/"$infilec""
-input[-1] @{"-quote \""$inpathc"\""}
-endif
# motion analysis
-if {$10!=0} -if {$infile!=$29}
[0]
infilemov={$infile-1} inpathmov="$27/$28"$infilemov""$end""
-input[-1] @{"-quote \""$inpathmov"\""}
-compose_difference[-1,-2] -luminance[-1] -n[-1] 0,255
-t2[-1] 0,{{$37/2}+1} -negative[-1] -n[-1] 0,255
-if {$infile>={$29+2}}
infilemov2={$infile-2} inpathmov2="$27/$28"$infilemov2""$end""
-input[-1] @{"-quote \""$inpathmov2"\""}
infilemov3={$infile-1} inpathmov3="$27/$28"$infilemov3""$end""
-input[-1] @{"-quote \""$inpathmov3"\""}
-compose_difference[-1,-2] -luminance[-1] -n[-1] 0,255
-t2[-1] 0,1 -n[-1] 0,255 -compose_darken[-1,-2]
-endif -blur_xy[-1] {w*{$37/1000}} -rv[-1,-2]
-if {$10>=0}
-gimp_compose_lighten[-1,-2] {abs($10)/5}
-else
-negative[-2]
-gimp_compose_darken[-1,-2] {abs($10)/5}
-endif
-endif -endif
# create second view
-if {$13!=15}
-if {$41==0}
-if {$sw<=0} -negative[2] -endif
-if {$34!=0} -if {$counter<=$34} sw={{$counter/$34}*$sw} sh={{$counter/$34}*$sh} -endif -endif
-if {$35!=0} -if {$counter>={$frames-$35}} sw={$sw*{{{$frames-$counter}+1}/$35}}
sh={$sh*{{{$frames-$counter}+1}/$35}} -endif -endif
-r[-1] 100%,100%,1,2 -s[-1] c -f[-1] 0 -n[-2] 0,$sw -a[-1,-2] c
-warp[-2] [-1],1 -shift[-2] $sh,0 -rm[-1]
-else
[-1] -r[-1,-2] 100%,100%,1,2
-s[-1] c -f[-1] 0 -n[-2] 0,{abs($sw/2)} -a[-1,-2] c
-negative[-2] -s[-2] c -f[-2] 0 -n[-3] 0,{-abs($sw/2)} -a[-2,-3] c
-warp[-4] [-2],1 -warp[-3] [-1],1
-shift[-3] $sh,0 -rm[-1,-2]
-endif
-endif
sh={-$2} sw={-$sh-$3}
# autocrop frames
-if {$20==1} -if {$13!=15}
-if {$sh>=0} -crop $sh,0,{w},{h} -else -crop 0,0,{w+$sh},{h} -endif
-if {$sw>=0} -crop $sw,0,{w},{h} -else -crop 0,0,{w+$sw},{h} -endif
-endif -endif
#end image stream alignment and 2D mode bypass
-endif  -endif
-if {$41==3} -gimp_tk_deana[0] $37,{{$38*2}+0.1} -to_rgb -endif
# apply custom filter
-if {$32==1} -if {$13!=15} -gimp_custom_code[0,1] "$33",0,0,0 -endif
-elif {$32==2} -if {$13!=15} -l[0] -gimp_custom_code "$33",0,0,0 -endl -endif
-elif {$32==3} -if {$13!=15} -l[1] -gimp_custom_code "$33",0,0,0 -endl -endif
-endif
# align stereoscopic image
-if {$12==1} -apply_channels_old[0,1] "-gimp_blackandwhite 0.3,0,0.6,0,0.1,0,1,1,0,0,0,0,0,0,2,0,0,0,16,4,0,0,0",2 -endif
-if {{$41==2}&&{$13==14}} -error[] "Output format not allowed for image stream alignment"
-elif {{$41==3}&&{$13==15}} -error[] "Output format not allowed for anaglyph video reconstruction"
-elif {{$41==2}&&{$13==15}} --gimp_tk_depth_obtain[0,1] $11,{$37/100},{100-{$38*20}},{$39*20}
-if {$32!=0} -gimp_custom_code[0,1,-1] "$33",0,0,0 -endif -k[-1]
-elif {{$41!=2}&&{$13==15}} -k[-1]
-elif {{$41==3}&&{$13==14}} -k[0,1]
-else -gimp_tk_stereoimage[0,1] $13,$11,$16,$17,$18,$19 -endif
# adjust output image streams
-if {$13==14} -apply_gamma $16 -tk_gimp_channel_processing 1,1,$17,0,0,0,100,256,0,0,1,10,7,0
-gimp_mix_lab 1,0,0,$18,0,0,$18,0,0,0,2,0 -endif
# resize frame to output format
-if {$21==1} -if {$13!=13}
-if {$23==0}   -r $22,{$22*0.75},1,{s},6
-elif {$23==1} -r $22,{{$22*9}/16},1,{s},6
-elif {$23==2} -r $22,{{$22*2}/3},1,{s},6
-elif {$23==3} -r $22,{$22*0.5},1,{s},6
-elif {$23==4} -r $22,{{$22*9}/21},1,{s},6
-elif {$23==5} -r $22,{$22*{h/w}},1,{s},6
-endif -endif -endif -c 0,255
# save frame to folder
-if {{$13==14}&&{$flag3d==1}}
fileleft="$15/frame_left_"$outfile$end fileright="$15/frame_right_"$outfile$end
-else  -if {$13!=15} filename="$15/frame_"$outfile$end
-else  filename="$15/depthmap_"$outfile$end -endif -endif
-if {{$13==14}&&{$flag3d==1}}
-output[0] @{"-quote \""$fileleft"\""} -output[1] @{"-quote \""$fileright"\""}
-else -output[0] @{"-quote \""$filename"\""}
-endif
outfile={$outfile+1}
# end batch processing loops and delete temporary file
infile={$infile+1} inpath="$27/$28"$infile""$end""
-if {$41==2} inpathleft="$27/$28""left_"$infile$end inpathright="$27/$28""right_"$infile$end -endif
counter={$counter+1} -done -endif
-if {{$_previewflag==0}&&{$26==1}} -if {$36!=1}
-if @{-is_windows} path="$15" path=${path}{`92`}
-x "cd \""$path"\" && del depthmap_temp.png"
-else file="$15/depthmap_temp.png" -x "rm -f \"$file\"" -endif
-endif -endif
#####preview function####
gimp_tk_video3D_preview :
shpre={$2*{400/$22}} swpre={$3*{400/$22}}
-if {$26==0}
#####preview layer mode###
-if {{@#}==1} -fc[0] 255,0,128,255 -k[0] -text "Select multiple layer",10,80%,24,1,0,0,0,255
-text "input mode ALL.",10,90%,24,1,0,0,0,255
-elif {$41==2} -fc[0] 255,0,128,255 -k[0] -text "Alignment of image streams",10,80%,24,1,0,0,0,255
-text "in BATCH processing mode only!",10,90%,24,1,0,0,0,255
-elif {$41==3} -fc[0] 255,0,128,255 -k[0] -text "Anaglyph video reconstruction",10,80%,24,1,0,0,0,255
-text "in BATCH processing mode only!",10,90%,24,1,0,0,0,255
-else
_previewflag=1
-if {$40==3} -if {$42==0} _mapin=1 -elif {$42==1} _mapin={@#} -elif {$42==2}  _mapin=$43 -endif -endif
-if {$42==0} nr=1 pv={-1} -elif {$42==1} nr={@#} pv={-@#} -elif {{$42==2}||{$42==3}} nr=$43 pv={-$43} -endif
-if {{$42==2}||{$42==3}} -if {$43>={@#}} nr={@#} pv={-@#} _mapin={@#} -endif -endif
-if {$42!=3}
-gimp_tk_video3D[$pv] $1,$shpre,$swpre,${4-9},0,${11-13},0,"$15",${16-23},0,${25-26},"$27","$28",${29-32},"$33",0,0,${36-39},0,${41-43} -k[$pv]
-text[0] "layer "@{"-quote \""$nr"\""},20,75%,{h*0.1},1,255,{if({{$13==2}||{$13==3}||{$13==15}},0,255)},0,255
-if {$24!=0} -text "For preview with frames offset ",20,70%,{h*0.05},1,255,{if({$13==15},0,255)},{if({$13==15},0,255)},255
-text "use full layer stack preview mode!",20,85%,{h*0.05},1,255,{if({$13==15},0,255)},{if({$13==15},0,255)},255 -endif
-if {{$34!=0}||{$35!=0}} -text "For fade in/out effect preview",20,65%,{h*0.05},1,255,{if({$13==15},0,255)},{if({$13==15},0,255)},255
-text "use full layer stack preview mode!",20,85%,{h*0.05},1,255,{if({$13==15},0,255)},{if({$13==15},0,255)},255  -endif
-if {$40!=0} -text "For preview with custom depth correction ",20,60%,{h*0.05},1,255,{if({$13==15},0,255)},{if({$13==15},0,255)},255
-text "use full layer stack preview mode!",20,85%,{h*0.05},1,255,{if({$13==15},0,255)},{if({$13==15},0,255)},255 -endif
-if {$10!=0} -text "For preview with motion analyzer ",20,55%,{h*0.05},1,255,{if({$13==15},0,255)},{if({$13==15},0,255)},255
-text "use full layer stack preview mode!",20,85%,{h*0.05},1,255,{if({$13==15},0,255)},{if({$13==15},0,255)},255 -endif
-if {{$32==2}||{$32==3}} -text[0] "Separate stream filtering ignored in layer mode",20,50%,{h*0.05},1,255,255,0,255 -endif
-else
-gimp_tk_video3D $1,$shpre,$swpre,${4-13},0,"$15",${16-26},"$27","$28",${29-32},"$33",${34-43} -k[$pv]
-endif
-text[0] "layer "@{"-quote \""$nr"\""},20,75%,{h*0.1},1,255,{if({{$13==2}||{$13==3}||{$13==15}},0,255)},0,255
-if {{$2==0}&&{$3==0}&&{$1==24}&&{$13==14}&&{$32!=0}} -text[0] "2D filter mode on!",50%,75%,{h*0.075},1,255,255,0,255 -endif
-if {$36!=1} -text "Key frame settings ignored in layer processing mode. ",20,50%,{h*0.05},1,255,255,0,255 -endif
_previewflag=0
-endif
-else
####preview batch mode####
_previewflag=2
-if {$42==3}
--fc[0] 255,0,128,255 -k[-1]
-text "No preview available",20,50,28,1,0,0,0,255
-text "for batch input stack!",20,80,28,1,0,0,0,255
-text "Please select frame to adjust settings.",20,150,16,1,0,0,0,255
-elif {{$42==2}&&{{$43<={$29-1}}||{$43>={$30+1}}}} -fc[0] 255,0,128,255 -k[0]
-text[0] "Selected frame out of range! ",10,80%,24,1,0,0,0,255
-elif {{$41==2}&&{$13==14}} -fc[0] 255,0,128,255 -k[0]
-text[0] "Output format not allowed!",10,80%,24,1,0,0,0,255
-elif {{$41==3}&&{$13==15}} -fc[0] 255,0,128,255 -k[0]
-text[0] "Output format not allowed!",10,80%,24,1,0,0,0,255
-else
-rm
-if {$31==0} end=".png" -else end=".bmp" -endif
-if {$42==0}  infile={$29}
-if {$34!=0} swpre={{1/$34}*$swpre} shpre={{1/$34}*$shpre} -endif
-elif {$42==1} infile={$30}
-if {$35!=0} swpre={{1-{1/$35}}*$swpre} shpre={{1-{1/$35}}*$shpre} -endif
-elif {$42==2} infile={$43}
-if {{$34!=0}||{$35!=0}}
-if {$43<={$29+$34}} swpre={{$43/$34}*$swpre} shpre={{$43/$34}*$shpre} -endif
-if {$43>={$30-$35}} swpre={{$30-$43}*{$swpre/$35}} shpre={{$30-$43}*{$shpre/$35}} -endif
-endif
-endif
-if {$41!=2}
inpath1="$27/$28"$infile""$end""
-input[0] @{"-quote \""$inpath1"\""}
-if {$24!=0} infileoff={$infile+$24}
-if {$infileoff<=$29} infileoff={$29} -endif
-if {$infileoff>=$30} infileoff={$30} -endif
inpathoff="$27/$28"$infileoff""$end""
-input[1] @{"-quote \""$inpathoff"\""}
-endif
-if {$infile!=$29} -if {$10!=0}
infilemov={$infile-1} inpathmov="$27/$28"$infilemov""$end""
-input[-1] @{"-quote \""$inpathmov"\""}
-if {$infile>={$29+2}}
infilemov2={$infile-2} inpathmov2="$27/$28"$infilemov2""$end""
-input[-1] @{"-quote \""$inpathmov2"\""}
infilemov3={$infile-1} inpathmov3="$27/$28"$infilemov3""$end""
-input[-1] @{"-quote \""$inpathmov3"\""}
-endif -endif -endif
-else
inpathleft="$27/$28""left_"$infile$end inpathright="$27/$28""right_"$infile$end
-rm -input[0] @{"-quote \""$inpathleft"\""}
-input[1] @{"-quote \""$inpathright"\""}
-endif
-if {$42==0} _mapin=$29 -elif {$42==1} _mapin=$30 -elif {$42==2} _mapin=$43 -endif
framesn={{$30-$29}+1}
-if {{{$34!=0}||{$35!=0}}&&{{$34>={$framesn-$35}}||{$35>={$framesn-$34}}}} -fc[0] 255,0,128,255 -k[0]
-text "Fade out of frame range! ",10,80%,{h*0.1},1,0,0,0,255
-else
-if {{$41==2}&&{$13==15}} --gimp_tk_depth_obtain[0,1] $11,{$37/100},{100-{$38*20}},{$39*20}
-if {$32!=0} -gimp_custom_code[0,1,-1] "$33",0,0,0  -endif -k[-1]
-else
-gimp_tk_video3D $1,$shpre,$swpre,${4-9},{if({$infile==$29},0,$10)},${11-13},0,"$15",${16-25},0,"$27","$28",${29-31},{if({{$2==0}&&{$3==0}&&{$1==24}&&{$13==14}&&{$32!=0}},2,$32)},"$33",0,0,1,${37-43}
-endif -to_rgb -if {$13==14} -k[-1] -endif
-text[0] "frame "@{"-quote \""$infile"\""},20,75%,{h*0.1},1,255,{if({{$13==2}||{$13==3}||{$13==15}},0,255)},0,255
-if {$41!=2} -if {$36!=1} -if {{$40==0}||{$40==1}} -text[0] "Preview always forced to key frame. ",20,50%,{h*0.05},1,255,255,0,255 -else
-text[0] "No keyframe computation for individual maps. ",20,64%,{h*0.05},1,255,255,0,255 -endif -endif -endif
-if {{$2==0}&&{$3==0}&&{$1==24}&&{$13==14}&&{$32!=0}} -text[0] "2D filter mode on!",50%,75%,{h*0.075},1,255,255,0,255 -endif
-endif -endif -endif
_previewflag=0
#@gimp Automatic depth estimation : gimp_tk_autodepth, gimp_tk_autodepth(1)
#@gimp : Sep = separator()
#@gimp : Note = note("This filter estimates a depth map from a 2D image by analyzing various monoscopic image properties.")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>       Latest update: <i>07/30/2012</i>.</small>")
gimp_tk_autodepth :
-repeat @# -l[$>] -to_rgb size1={w} -resize2dx 400,2
#coefficient settings
whpos=128 blpos=128 rpos=255 gpos=200 blupos=200 crga=1.5 crmix1=0.5 crmix2=0.5 geocomp1=75 geocomp2=30
geostr=0.3 focstr=0.3 featsize=60 featpos=128 feattr=35 tr=30 rtr=90 gtr=90 blutr=90 contstr=0.9
featinfl=1 foctol=5 focmorph=70 focavt=85 focavt2=140 focvart=2000 latinhib=0.5
#depth from gravity
--gimp_map_tones_fast[-1] 10,0.5,0,0 -luminance[-1]
-gimp_segment_watershed[-1] 0.5,1,0  -label[-1] 5,0
--gimp_gradient_norm[0] 0,0.5,0,100,0,0 -compose_lighten[-1,-2]
-gimp_segment_watershed[-1] 0.5,1,0 -label[-1] 5,0 -n[-1] 0,255
#depth from luminance and compensate over/underexposed areas
--luminance[0]
--channels[0] 1 -t2[-1] $gtr%,100%
-gimp_morpho[-1] 2,2,0,0,0,1,0 -n[-1] 0,$gpos
-tk_gimp_replace_color[-1] 1,0,0,0,0,255,0,0,0,0  -compose_alpha[-1,-2]
--channels[0] 0 -t2[-1] $rtr%,100%
-gimp_morpho[-1] 2,2,0,0,0,1,0 -n[-1] 0,$rpos
-tk_gimp_replace_color[-1] 1,0,0,0,0,255,0,0,0,0 -compose_alpha[-1,-2]
--channels[0] 2 -t2[-1] $blutr%,100%  -n[-1] 0,$blupos
-gimp_morpho[-1] 2,2,0,0,0,1,0
-tk_gimp_replace_color[-1] 1,0,0,0,0,255,0,0,0,0
-to_rgba[-1] --gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,90,0,100
-s[-2] c -rv[-1,-2] -compose_multiply[-1,-2] -to_gray[-1] -a[-4,-3,-2,-1] c
-compose_alpha[-1,-2]
--channels[0] 0 --luminance[0] -compose_average[-1,-2] -t2[-1] 80%,95%
-gimp_morpho[-1] 2,2,0,0,0,1,0 -n[-1] 0,$whpos
-tk_gimp_replace_color[-1] 1,0,0,0,0,255,0,0,0,0 -compose_alpha[-1,-2]
--channels[0] 0 --luminance[0] -compose_average[-1,-2] -t2[-1] 5%,20%
-gimp_morpho[-1] 2,2,0,0,0,1,0 -n[-1] 0,$blpos
-tk_gimp_replace_color[-1] 1,0,0,0,0,255,0,0,0,0 -compose_alpha[-1,-2]
#depth from lateral inhibition
--gimp_gradient_norm[0] 0,0.5,0,50,0,0
[-1]
-gimp_morpho[-1] 2,$featsize,0,0,0,1,0
-t2[-1] $feattr%,100%
-n[-1] 0,$featpos
-blur_xy[-1] 2
-gimp_compose_lighten[-1,-2] $contstr
-blur_xy[-1] 2
#depth from color
-to_rgb[0] -rgb2ycbcr[0] --channels[0] 2 -ycbcr2rgb[0]
-n[-1] 0,255 -c[-1] 25%,100%  -apply_gamma[-1] $crga
--channels[0] 2 -negative[-1] -c[-1] 0,128
-to_rgba[-1] --gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,270,0,100
-s[-2] c -rv[-1,-2] -compose_multiply[-1,-2] -to_gray[-1]
-a[-4,-3,-2,-1] c -rv[-1,-2] -gimp_compose_darken[-1,-2] $crmix1
#depth from geometry
--luminance[0] -gimp_houghsketchbw[-1] 10,5,15,$tr,1,1,0 complex=@{-1,a}
-if {$complex>=$geocomp1}
-do tr={$tr+10} -rm[-1] --luminance[0] -gimp_houghsketchbw[-1] 10,5,15,$tr,1,1,0 complex=@{-1,a}
-while {{$complex>=$geocomp2}&&{$tr<=90}} -endif
-gimp_morpho[-1] 3,5,0,0,0,1,0 -blur_xy[-1] 1 -gimp_distance[-1] 255,0,1,1,0
complex=@{-1,a}
#depth from focus
--gimp_highpass[0] 2,2,0,0,0
-tk_gimp_replace_color[-1] $foctol,0,128,128,128,255,0,0,0,255
-gimp_morpho[-1] 3,$focmorph,0,0,0,1,0   -to_gray[-1]
av=@{-1,a} var=@{-1,v}
-if {{$av<=$focavt}||{{$av>=$focavt}&&{$av<=$focavt2}&&{$var<=$focvart}}}
-t2[-1] $av,255 -n[-1] 0,255 -blur_xy[-1] 10 -else -fc[-1] 128,128,128 -endif
#lateral inhibition emphaziser
--gimp_gradient_norm[0] 0,0.5,0,50,0,0
#composing depth representations
-rm[0]
-gimp_compose_overlay[-7,-6] 0.5
-gimp_compose_overlay[-6,-5] $featinfl
-gimp_compose_value[-5,-4] $crmix2
-rv[-4,-3]
-if {$complex!=0} -gimp_compose_overlay[-4,-3] $geostr -else -rm[-3] -endif
-rv[-3,-2]
-gimp_compose_overlay[-3,-2] $focstr
-rv[-2,-1]
-gimp_compose_lighten[-1,-2] $latinhib
#final segmentation and smoothing
-blur_xy[-1] 2  -gimp_morpho[-1] 3,20,0,0,0,1,0
-gimp_segment_watershed[-1] 15,0,0 -n[-1] 0,255
-blur_y[-1] 2 -blur_x[-1] 1
-resize2dx $size1,2
-endl -done
#@gimp De-anaglyph : gimp_tk_deana, gimp_tk_deana(1)
#@gimp : Sep = separator()
#@gimp : Note = note("This filter reconstructs strereoscopic full colour views from anaglyphs")
#@gimp : Sep = separator()
#@gimp : Colour smoothing = float(20,0,100)
#@gimp : Gamma equalizer = float(2,0.1,10)
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>     Latest update: <i>09/20/2012</i>.</small>")
gimp_tk_deana :
-repeat @# -l[$>] -to_rgb --s c -rm[-1]
-to_rgb[-1,-2] -rgb2lab[-1,-2] -channels[-1,-2] 0
-rgb2lab[0] -s[0] c -blur_x[1,2] $1
-c[-1,-2] @{0,m},@{0,M}
-apply_gamma[-1] {{{{$2^{@{0,a}/@{-1,a}}}-$2}*$2}+1}
-apply_gamma[-2] {{{{$2^{@{0,a}/@{-2,a}}}-$2}*$2}+1}
[1,2] -rm[0] -mv[2] 0
-a[0,1,2] c -a[1,2,3] c -lab2rgb[0,1]
-endl -done
#@gimp Depth map construction : gimp_tk_depthmap, gimp_tk_depthmap(1)
#@gimp : Sep = separator()
#@gimp : Note = note("This filter estimates and constructs a depth map for a 2D image ")
#@gimp : Scene selector = choice("automatic depth estimation","daylight scene","optimized lateral inhibition","light motive","dark  motive","landscape","center foreground","center background","left  foreground","left diagonal foreground","right foreground","right diagonal  foreground","left and right foreground","left and right background","bottom and top foreground","bottom and left foreground","bottom and right foreground","central  perspective outdoor","central perspective indoor","portrait","human 1","human  2","studio","underwater","flat")
#@gimp : Depth field control = float(20,0,100)
#@gimp : Feature analyzer threshold = float(0,0,5)
#@gimp : Feature analyzer smoothness = float(0,0,5)
#@gimp : Local detail enhancer = float(0,0,5)
#@gimp : Dof analyzer = float(0,0,5)
#@gimp : Frequency analyzer = float(0,0,5)
#@gimp : Preprocessor radius = float(0,0,5)
#@gimp : Preprocessor power = float(0,0,5)
#@gimp : Smoothing = float(0,0,100)
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>       Latest update: <i>07/30/2012</i>.</small>")
gimp_tk_depthmap :
-repeat @# -l[$>] -to_rgb size1={w} -resize2dx 400,2
-if {{$8!=0}||{$8!=0}} -gimp_map_tones_fast {$8*4},{$9/5},3,0 -endif
-if {$1==0} --gimp_tk_autodepth[-1]
--luminance[0] -gimp_map_tones[-1] 1,0.25,0,30,3,0
-rv[-1,-2] -gimp_compose_value[-1,-2] 0.15
-tk_gimp_channel_processing[-1] 1,{$2/20},0,0,0,0,100,256,0,0,0,2,0,0
-elif {$1==1} --channels[0] 2
-tk_gimp_channel_processing[-1] 1,{{$2/25}+0.1},0,0,0,0,100,256,0,1,0,2,0,0
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,90,0,{100-{$2/1.5}}
-rv[-1,-2] -gimp_compose_lighten[-1,-2] {0.5+{$2/200}}
-elif {$1==2} --s[-1] c -gimp_dog[-1] 0.4,0,0,0,0
-negative[-2]  -gimp_dog[-3] 0.4,0,0,0,0
-gimp_compose_alpha[-1,-2] 0.44,0
-gimp_compose_alpha[-1,-2] 0.44,0
-tk_gimp_channel_processing[-1] 1,{$2/20},0,0,0,0,100,256,0,0,0,2,0,0
-elif {$1==3} --luminance[-1]
-tk_gimp_channel_processing[-1] 1,{$2/25},0,0,0,0,100,256,0,0,0,2,0,0
-elif {$1==4} --luminance[-1] -negative[-1]
-tk_gimp_channel_processing[-1] 1,{$2/25},0,0,0,0,100,256,0,0,0,2,0,0
-elif {$1==5}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,90,0,{100-$2}
-elif {$1==6}
--gimp_radial_gradient[-1] 0,0,0,255,255,255,255,255,1,$2,100,50,50
-elif {$1==7}
--gimp_radial_gradient[-1] 0,0,0,255,255,255,255,255,0,0,{100-$2},50,50
-elif {$1==8}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,1,0,$2,100
-elif {$1==9}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,1,315,$2,100
-elif {$1==10}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,0,0,{100-$2}
-elif {$1==11}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,45,0,{100-$2}
-elif {$1==12}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,0,50,{100-{$2/2}}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,180,50,{100-{$2/2}}
-compose_lighten[-1,-2]
-elif {$1==13}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,1,180,100,{50+{$2/2}}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,180,{50-{$2/2}},0
-compose_darken[-1,-2]
-elif {$1==14}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,90,50,{100-{$2/2}}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,270,50,{100-{$2/2}}
-compose_lighten[-1,-2]
-elif {$1==15}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,180,50,{100-{$2/2}}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,90,50,{100-{$2/2}}
-compose_lighten[-1,-2]
-elif {$1==16}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,0,50,{100-{$2/2}}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,90,50,{100-{$2/2}}
-compose_lighten[-1,-2]
-elif {$1==17}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,0,50,{100-{$2/4}}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,180,50,{100-{$2/4}}
-compose_lighten[-1,-2]
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,90,0,{100-{$2/2}}
-compose_lighten[-1,-2]
-elif {$1==18}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,0,50,{100-{$2/4}}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,180,50,{100-{$2/4}}
-compose_lighten[-1,-2]
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,90,0,{100-{$2/4}}
-compose_lighten[-1,-2]
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,270,50,{100-{$2/4}}
-compose_lighten[-1,-2]
-elif {$1==19} --channels[-1] 0
-tk_gimp_channel_processing[-1] 1,{$2/25},0,0,0,0,100,256,0,0,0,2,0,0
--gimp_radial_gradient[-1] 0,0,0,255,255,255,255,255,1,$2,100,50,50
-rv[-1,-2] -compose_multiply[-1,-2]
-elif {$1==20}
--gimp_gaussian_blur[-1] $6,0,0,1,0,0,0
-gimp_edges[-1] {$4/2},{50-{$2/2}},1,0
--gimp_gradient_norm[0] {$4/2},{1.5-{$2/67}},0,{100-$2},0,0
-rv[-1,-2] -compose_lighten[-1,-2] --channels[0] 0
-tk_gimp_channel_processing[-1] 1,{{$2/25}+1},0,0,0,0,100,256,0,0,0,2,0,0
-rv[-1,-2] -compose_lighten[-1,-2]
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,0,50,{100-{$2/4}}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,180,50,{100-{$2/4}}
-compose_lighten[-1,-2]
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,90,0,{100-{$2/2}}
-compose_lighten[-1,-2] -rv[-1,-2] -compose_lighten[-1,-2]
-elif {$1==21} --gimp_gaussian_blur[-1] $4,0,0,1,0,0,0
-gimp_edges[-1] {$4/2},{50-{$2/2}},1,0
--gimp_gradient_norm[0] {$4/2},{1.5-{$2/67}},0,{100-$2},0,0
-rv[-1,-2] -compose_lighten[-1,-2] --channels[0] 0
-tk_gimp_channel_processing[-1] 1,{{$2/25}+0.5},0,0,0,0,100,256,0,0,0,2,0,0
-rv[-1,-2] -compose_lighten[-1,-2]
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,0,0,{100-$2}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,180,0,{100-$2}
-compose_darken[-1,-2] -rv[-1,-2] -compose_darken[-1,-2]
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,90,75,{100-{$2/4}}
-rv[-1,-2] -gimp_compose_lighten[-1,-2] 0.5
-elif {$1==22} --gimp_gaussian_blur[-1] $4,0,0,1,0,0,0
-gimp_edges[-1] {$4/2},{50-{$2/2}},1,0
--gimp_gradient_norm[0] {$4/2},{1.5-{$2/67}},0,{100-$2},0,0
-rv[-1,-2] -compose_lighten[-1,-2] --channels[0] 0
-tk_gimp_channel_processing[-1] 1,{{$2/25}+0.5},0,0,0,0,100,256,0,0,0,2,0,0
-rv[-1,-2] -compose_lighten[-1,-2]
-elif {$1==23} --channels[-1] 0
-tk_gimp_channel_processing[-1] 1,{$2/25},0,0,0,0,100,256,0,0,0,2,0,0
-elif {$1==24} --fc[-1] 0,0,0
-endif
# analyze image features
-if {$7!=0}
--fc[0] 128,128,128 --channels[0] 2 -negative[-1] -c[-1] 0,90
-n[-1] 0,128 -rv[-1,-2] -compose_darken[-1,-2]
--channels[0] 0 -negative[-1] -c[-1] 165,255 -n[-1] 128,255 -rv[-1,-2]
-compose_hardlight[-1,-2] -rv[-1,-2]
-if {$1!=19} -gimp_compose_average[-1,-2] {$7/5}
-else -gimp_compose_value[-1,-2] {$7/5},0
-tk_gimp_channel_processing[-1] 1,{$2/25},0,0,0,0,100,256,0,0,0,2,0,0
-endif -endif
-if {$6!=0} --gimp_highpass[0] 2,2,0,0,0
-tk_gimp_replace_color[-1] 5,0,128,128,128,255,0,0,0,255
-gimp_morpho[-1] 3,70,0,0,0,1,0   -to_gray[-1] av=@{-1,a}
-t2[-1] $av,255 -n[-1] 0,255 -blur_xy[-1] 25
-rv[-1,-2] -gimp_compose_overlay[-1,-2] {$6/5} -endif
-if {$3!=0} --gimp_isophotes[0] {{$3*3}+2},0,0,0
-gimp_morpho[-1] 3,{5-{$3/2}},0,0,0,1,0
-tk_gimp_channel_processing[-1] 1,1,255,0,0,0,100,256,0,0,0,2,0,0
-rv[-1,-2] -gimp_compose_overlay[-1,-2] {$3/10}
--gimp_gradient_norm[0] {$4*2},{1.5-{0.1+{$3/3.6}}},0,100,0,0
-rv[-1,-2] -compose_lighten[-1,-2] -gimp_segment_watershed[-1] $3,$4,0,0
-endif
-blur_y[-1] $10 -blur_x[-1] {$10/2}
-if {$5!=0} --luminance[0] -gimp_map_tones[-1] 1,{0.25-{$5/20}},0,30,3,0
-rv[-1,-2] -gimp_compose_overlay[-1,-2] {$5/10} -endif
-n[-1] 0,255 -rm[0] -resize2dx $size1,2 -endl -done
#@gimp Depth map reconstruction : gimp_tk_depth_obtain, gimp_tk_depth_obtain(1)
#@gimp : Note = note("This filter estimates a depth map from the left and the right view of a stereoscopic image. Images must be aligned correct to compute correct depth information.")
#@gimp : Flip left/right = bool(0)
#@gimp : Smoothness = float(0.1,0,1)
#@gimp : Center size = float(100,0,100)
#@gimp : Center smoothness = float(0,0,50)
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>       Latest update: <i>09/04/2012</i>.</small>")
gimp_tk_depth_obtain :
-if {@#<=1} -return -endif
-l
-to_rgb size1={w} size2={h} -resize2dx 400,2
-if {$1==1} -rv -endif
-if {$3!=100}
-gimp_frame_round 10,{100-$3},$4,0,255,255,255,255,0,0.1,3
-endif
-displacement[0] [1],$2
-rm[1]
-channels 0
-n 0,255
-r $size1,$size2 -endl
#@gimp Lenticular print : gimp_tk_lenticular, gimp_tk_lenticular(1)
#@gimp : Sep = separator()
#@gimp : Lenticular density lpi = float(30,5,200)
#@gimp : Lenticular orientation = choice("vertical","horizontal")
#@gimp : Print size width = float(5,1,50)
#@gimp : Print size unit = choice("inch","centimeter")
#@gimp : Print adjustment marks = bool(1)
#@gimp : Automatic upscale for optimum results = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>.      Latest update: <i>06/10/2011</i>.</small>")
#@gimp : Note = link("Filter explained here",http://www.tkfilter.bplaced.net/TKFilter%20tutorials%202Dto3D%203D-automatic%20stereoscopic%20conversion.html)
gimp_tk_lenticular :
-if {@#<=1} -return -endif
frames={@#} index=0 -if {$4==0} length=$3 -else length={$3/2.54} -endif
lenses={$length*$1} lensewidth={w/$lenses}
picstripe={$lensewidth/$frames} x=0 y=0 end={$picstripe}
step={$lensewidth-$picstripe}
#automatic upscale
-if {$6==1}
-if {$picstripe!={int($picstripe)}} scale={{int($picstripe)+1}/$picstripe}
-r {w*$scale},{h*$scale} lensewidth={w/$lenses} picstripe={$lensewidth/$frames}
end={$picstripe} step={$lensewidth-$picstripe} -endif -endif
-to_rgb --fc[-1] 255,255,255 -repeat $lenses
-if {$2==0}
-fill[-1] if(x>=$end,0,i) x={$x+$step} end={$end+$step}
-fill[-1] if(x>=$end,255,i) x={$x+$picstripe} end={$end+$picstripe}
-else
-fill[-1] if(y>=$end,0,i) y={$y+$step} end={$end+$step}
-fill[-1] if(y>=$end,255,i) y={$y+$picstripe} end={$end+$picstripe}
-endif -done
-repeat {$frames-1} --to_gray[-1] -t2[-1] 128,256 -n[-1] 0,255
-if {$2==0} -shift[-1] {{$picstripe}*{$frames-{$index+1}}}
-else -shift[-1] 0,{{$picstripe}*{$frames-{$index+1}}} -endif
-s[$index] c -a[$index,{$index+1},{$index+2},-1] c
index={$index+1} -done
-repeat {$frames-1} -rv[0,-2] -compose_rgba[0,-2] -rv[0,-2] -done
-if {$5==1} -to_rgba[0]
-if {$2==0} -shift[0] 0,5 -else -shift[0] 5,0 -endif
-negative[-1] -rv -compose_rgba -else -rm[-1] -endif
#@gimp Single image stereogram : gimp_tk_stereogram, gimp_tk_stereogram_preview(1)
#@gimp : Sep = separator()
#@gimp : Deviation = float(50,0,200)
#@gimp : Sep = separator(), note = note("Pattern generator")
#@gimp : Pattern variation 1 = float(0.5,0,1)
#@gimp : Pattern variation 2 = float(10,0,20)
#@gimp : Pattern variation 3 = float(0,0,1)
#@gimp : Tiles = int(40,10,100)
#@gimp : Color 1 = color(255,255,0)
#@gimp : Color 2 = color(255,0,0)
#@gimp : Color 3 = color(0,255,0)
#@gimp : Color 4 = color(0,0,255)
#@gimp : Color strength = float(0.5,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>.      Latest update: <i>02/25/2012</i>.</small>")
#@gimp : Note = note("Input image should be a <b>depth map</b> which is turned into an autostereogram, also known as magic eye image")
#@gimp : Note = link("Filter explained here",http://www.tkfilter.bplaced.net/TKFilter%20filter.html)
#@gimp : Note = link("Background explained here","http://en.wikipedia.org/wiki/Autostereogram")
gimp_tk_stereogram :
-repeat @# -l[$>] -to_gray --fc[-1] 255,255,255
-gimp_plasma[-1] $2,$3,8,0,0,128,128,128
-gimp_array[-1] 10,10,0,0,0,0
-gimp_array_fade[-1] {$5/10},{$5/10},0,0,80,90,3,0
-r[-1] [0],[0]
-gimp_noise[-1] {w/30},0,3,0,0
--gimp_rorschach[-1] $4,1,0 -rv[-1,-2] -gimp_compose_multiply[-1,-2] 0.5
--gimp_corner_gradient[-1] $6,$7,$8,255,$9,$10,$11,255,$12,$13,$14,255,$15,$16,$17,255
-rv[-1,-2] -gimp_compose_hardlight[-1,-2] $18
-rv[-1,-2]
-r[-1] 100%,100%,1,2
-s[-1] c -f[-1] 0 -n[-2] 0,$1 -a[-1,-2] c
-warp[-2] [-1],1
-rm[-1] -endl -done
gimp_tk_stereogram_preview :
-gimp_split_preview "-gimp_tk_stereogram ${1--2}",$-1
#@gimp Stereoscopic image alignment : gimp_tk_stereoimage, gimp_tk_stereoimage(1)
#@gimp : Sep = separator()
#@gimp : Mode = choice("Anaglyph red/cyan","Anaglyph red/cyan optimized","Anaglyph blue/yellow","Anaglyph blue/yellow optimized","Anaglyph green/magenta","Anaglypgh green/magenta optimized","Full side by side keep width","Full side by side keep uncompressed","Full bottom/top","Half side  by side","Half bottom/top","Interlace horizontal","Interlace vertical","Full HD frame packing")
#@gimp : Flip left / right = bool(0)
#@gimp : Gamma compensation = float(1,0,4)
#@gimp : Anti-ghosting = float(0,0,255)
#@gimp : Color boost = float(1,0,4)
#@gimp : Anaglyph glasses adjustment = float(0,-100,100)
#@gimp : Sep = separator()  note = note("This filter needs two aligned input images.")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>     Latest update: <i>08/04/2012</i>.</small>")
gimp_tk_stereoimage :
-if {@#<=1} -return -endif
-local -to_rgb
-if {$4!=0} -tk_gimp_channel_processing 1,1,$4,0,0,0,100,256,0,0,1,10,7,0 -endif
-if {{$1==0}||{$1==1}||{$1==2}||{$1==3}||{$1==4}||{$1==5}} -apply_gamma $3 -endif
-if {$1==0} -if {$2==0} -rv[-1,-2] -endif -s c
-rm[-3,-4,-5] -a[-1,-2,-3] c
-elif {$1==1} -if {$2==1} -rv[-1,-2] -endif
-apply_gamma[-1] 1.15 -apply_gamma[-2] 1.0 -s c
rlr=456 rlg=500 rlb=176 rrr={-43} rrg={-88} rrb={-2}
glr={-40} glg={-38} glb={-16} grr=378 grg=734 grb={-18}
blr={-15} blg={-21} blb={-5} brr={-72} brg={-113} brb=1226
[0-5]
-*[-3] $rlr -*[-2] $rlg -*[-1] $rlb -*[-6] $rrr -*[-5] $rrg -*[-4] $rrb
-+[-6] [-5] -+[-6] [-4] -+[-6] [-3] -+[-6] [-2] -+[-6] [-1] -rm[-1--5]
-/[-1] 1000 -n[-1] 0,255 -to_gray[-1]
[0-5]
-*[-3] $glr -*[-2] $glg -*[-1] $glb -*[-6] $grr -*[-5] $grg -*[-4] $grb
-+[-6] [-5] -+[-6] [-4] -+[-6] [-3] -+[-6] [-2] -+[-6] [-1] -rm[-1--5]
-/[-1] 1000 -n[-1] 0,255 -to_gray[-1]
[0-5]
-*[-3] $blr -*[-2] $blg -*[-1] $blb -*[-6] $brr -*[-5] $brg -*[-4] $brb
-+[-6] [-5] -+[-6] [-4] -+[-6] [-3] -+[-6] [-2] -+[-6] [-1] -rm[-1--5]
-/[-1] 1000 -n[-1] 0,255 -to_gray[-1]
-k[-1--3] -a[-1,-2,-3] c
-elif {$1==2} -if {$2==0} -rv[-1,-2] -endif -s c
-rm[-6,-5,-1] -mv[0] 3  -a[-1,-2,-3] c
-elif {$1==3} -if {$2==1} -rv[-1,-2] -endif
-apply_gamma[-1] 0.9 -apply_gamma[-2] 1.25 -s c
rrr=1062 rrg={-205} rrb=299 rlr={-16} rlg={-123} rlb={-17}
grr={-26} grg=908 grb=68 glr=6 glg=62 glb={-17}
brr={-38} brg={-173} brb=22 blr=94 blg=185 blb=911
[0-5]
-*[-3] $rlr -*[-2] $rlg -*[-1] $rlb -*[-6] $rrr -*[-5] $rrg -*[-4] $rrb
-+[-6] [-5] -+[-6] [-4] -+[-6] [-3] -+[-6] [-2] -+[-6] [-1] -rm[-1--5]
-/[-1] 1000 -n[-1] 0,255 -to_gray[-1]
[0-5]
-*[-3] $glr -*[-2] $glg -*[-1] $glb -*[-6] $grr -*[-5] $grg -*[-4] $grb
-+[-6] [-5] -+[-6] [-4] -+[-6] [-3] -+[-6] [-2] -+[-6] [-1] -rm[-1--5]
-/[-1] 1000 -n[-1] 0,255 -to_gray[-1]
[0-5]
-*[-3] $blr -*[-2] $blg -*[-1] $blb -*[-6] $brr -*[-5] $brg -*[-4] $brb
-+[-6] [-5] -+[-6] [-4] -+[-6] [-3] -+[-6] [-2] -+[-6] [-1] -rm[-1--5]
-/[-1] 1000 -n[-1] 0,255 -to_gray[-1]
-k[-1--3] -a[-3,-2,-1] c
-elif {$1==4} -if {$2==0} -rv[-1,-2] -endif  -s c
-rm[-1,-3,-5] -mv[-1] -2 -a[-3,-2,-1] c
-elif {$1==5} -if {$2==1} -rv[-1,-2] -endif  -s c
-apply_gamma[-1] 1 -apply_gamma[-2] 1.15 -s c
rrr={-62} rrg={-158} rrb={-39} rlr={529} rlg={705} rlb={24}
grr={284} grg=668 grb=143 glr={-16} glg={-15} glb={-65}
brr={-15} brg={-27} brb=21 blr=9 blg=75 blb=937
[0-5]
-*[-3] $rlr -*[-2] $rlg -*[-1] $rlb -*[-6] $rrr -*[-5] $rrg -*[-4] $rrb
-+[-6] [-5] -+[-6] [-4] -+[-6] [-3] -+[-6] [-2] -+[-6] [-1] -rm[-1--5]
-/[-1] 1000 -n[-1] 0,255 -to_gray[-1]
[0-5]
-*[-3] $glr -*[-2] $glg -*[-1] $glb -*[-6] $grr -*[-5] $grg -*[-4] $grb
-+[-6] [-5] -+[-6] [-4] -+[-6] [-3] -+[-6] [-2] -+[-6] [-1] -rm[-1--5]
-/[-1] 1000 -n[-1] 0,255 -to_gray[-1]
[0-5]
-*[-3] $blr -*[-2] $blg -*[-1] $blb -*[-6] $brr -*[-5] $brg -*[-4] $brb
-+[-6] [-5] -+[-6] [-4] -+[-6] [-3] -+[-6] [-2] -+[-6] [-1] -rm[-1--5]
-/[-1] 1000 -n[-1] 0,255 -to_gray[-1]
-k[-1--3] -a[-3,-2,-1] c
-elif {$1==6} -if {$2==1} -rv[-1,-2] -endif
-r[-1,-2] 50%,50%,1,3,6 -a[-1,-2] x
-elif {$1==7} -if {$2==1} -rv[-1,-2] -endif -a[-1,-2] x
-elif {$1==8} -if {$2==1} -rv[-1,-2] -endif -a[-1,-2] y
-elif {$1==9} -if {$2==1} -rv[0,1] -endif
-r[0,1] 50%,100%,1,3,6 -a[0,1] x
-elif {$1==10} -if {$2==1} -rv[0,1] -endif
-r[0,1] 100%,50%,1,3,6 -a[0,1] y
-elif {$1==11} -to_rgba[0,1]
-if {$2==1} -rv[0,1] -endif
-fill[0] if(y%2==0,0,i) -rv[0,1] -compose_rgba[0,1] -to_rgb
-elif {$1==12} -to_rgba[0,1]
-if {$2==1} -rv[0,1] -endif
-fill[0] if(x%2==0,0,i) -rv[0,1] -compose_rgba[0,1] -to_rgb
-elif {$1==13}
-if {$2==1} -rv[0,1] -endif
-r[0,1] 1920,1080,1,3,6 --fc[-1] 0,0,0 -r[-1] 1920,45
-rv[-1,-2] -a[-1,-2] y -a[-1,-2] y
-endif -c 0,255
-if {{$1==6}||{$1==7}||{$1==8}||{$1==9}||{$1==10}||{$1==11}||{$1==12}||{$1==13}}
-apply_gamma $3 -endif
-gimp_mix_lab 1,0,0,$5,0,0,$5,0,0,0,2,0
-if {{$1==0}||{$1==1}} -gimp_mix_rgb 1,$6,0,1,0,0,1,0,0,0,2,0 -endif
-if {{$1==2}||{$1==3}} -gimp_mix_rgb 1,0,0,1,0,0,1,$6,0,0,2,0 -endif
-if {$1==4} -gimp_mix_rgb 1,0,0,1,$6,0,1,0,0,0,2,0 -endif
-if {$1==5} -gimp_mix_rgb 1,0,0,1,$6,0,1,{if({$6>=0},$6,0)},0,0,2,0 -endif
-endl
#@gimp Stereo image : gcd_stereo_img, gcd_stereo_img(1)
#@gimp : Note = note("<u>Create a 3D image from a flat one</u>")
#@gimp : Note = note("\n<i>3D Options</i>"), sep = separator()
#@gimp : 3d image type = choice("Anaglyph: Red/Cyan","Side by Side","Depth Map","Inverse Depth Map")
#@gimp : Balance color = choice(4,"None","Fast Half","Fast Full","Low","Medium","High","Full")
#@gimp : Depth = float(1.2,0,3)
#@gimp : Distance = float(1,-2,2)
#@gimp : Note = note("\n<i>Depth Map Options</i>"), sep = separator()
#@gimp : Blur percentage = float(0.25,0,2)
#@gimp : Object ratio = float(2,0,4)
#@gimp : Object tolerance = int(4,0,5)
#@gimp : Despeckle = bool(1)
#@gimp : Note = note("\n<i>Output Options</i>"), sep = separator()
#@gimp : Auto crop = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2014/05/31</i>.</small>")
gcd_stereo_img : -skip ${1=0},${2=2},${3=1.2},${4=1},${5=0.25},${6=2},${7=4},${8=1},${9=0}
-repeat @# -l[$>]
-to_rgb[0] b={abs($3%*w*$4)}
--gcd_depth[0] $5,$6,$7,$8
-gcd_stereo[0,1] $1,$2,$3%,$4
-if {!$1" && "$9} -z[-1] $b,{w-1-$b} -endif
-endl -done
gcd_depth : -skip ${1=0.25},${2=2},${3=4},${4=1}
-repeat @# -l[$>]
-if {w>h} -if {w>700} --r[-1] 700,{h*700/w} -else [0] -endif
-elif {@{0,h}>700} --r[-1] {@{0,w}*700/@{0,h}},700 -else [0] -endif
-apply_parallel_overlap[-1] "-median 7",4 -segment_watershed[-1] 1,1
-channels[-1] 0 -if $4 -gcd_label[-1] $3 -else -label[-1] $3,1 -endif
-srgb2rgb[-1] -rgb2srgb[-1] -b[-1] 0.45% -n[-1] 0,$2
-r[-1] [0],[0]
-norm[0] -n[0] 0,1 -add[-2,-1] -b[-1] $1% -n[-1] 0,255
-endl -done
gcd_stereo : -skip ${1=0},${2=1},${3=1.2%},${4=1}
-l[-2,-1]
-if {$1==2} -keep[-1] -return
-elif {$1==3} -keep[-1] -negative -return -endif
wfac={if(@{"-is_percent $3"},$3*w,$3)} -n[-1] 0,$wfac
-if {$1==0" && "$2>0} -gcd_balance_anaglyph[0] $2 -endif
-i[1] [0] -warp[0] [-1],1 -mul[-1] -1 -warp[1] [-1],1 -rm[-1]
-if $1 -rv[0,1] -append[0,1] x -else -shift[0] {-$wfac*$4} -shift[1] {$wfac*$4}
-channels[0] 0 -channels[1] 1,2 -append[0,1] c
-endif
-endl
gcd_balance_anaglyph : -skip ${1=4}
-if {$1==0} -return -elif {$1<3} -gcd_balance_anaglyph_simple $1
-else -gcd_balance_anaglyph_exp 0.43,0.45,{if($1<5,if($1==3,2,1.6),if($1==5,1.2,1))} -endif
gcd_balance_anaglyph_simple : -skip ${1=1}
-l[-1] -s c
---[1] [0] -/[-1] {4/$1} --[1,2] [-1] -+[0,-1]
---[2] [0] -c[-1] 0,255 -/[-1] {4/$1} -+[0,-1]
-n[0] {10*$1},255 -a[0-2] c -c[0] 0,255
-endl
gcd_balance_anaglyph_exp : -skip ${1=0.5},${2=0.5},${3=1}
-l[-1] -s c
-m "_exp: -l --sign -abs[0] -^[0] $""1 -*[0] {255/255^$""1} -*[0,-1] -endl"
---[1] [0] -_exp[-1] $3 -*[-1] $1 --[1,2] [-1] -*[-1] {(1-$1)/$1} -+[0,-1]
--*[2] 0.65 --[-1] [0] -c[-1] 0,255 -*[-1] $2 --[2] [-1] -*[-1] {(1-$2)/$2} -+[0,-1]
-apply_gamma[0] 1.15 -a[0-2] c -c 0,255 -uncommand _exp
-endl
#@gimp Undo anaglyph : gcd_unstereo, gcd_unstereo_preview(1)
#@gimp : Note = note("<u>Attempt to revert red/cyan anaglyph to 2D</u>")
#@gimp : Note = note("<b>Warning: with high precision or large image this can be VERY slow!</b>")
#@gimp : Note = note("\n<i>Displacement Settings</i>"), sep = separator()
#@gimp : Precision = float(5,1,6)
#@gimp : Smoothness = float(0.1,0,1)
#@gimp : Horizontal warp only = bool(1)
#@gimp : Fast (low precision) preview = bool(1)
#@gimp : Note = note("\n<i>Tile Settings</i>"), sep = separator()
#@gimp : Horizontal tiles = int(1,1,8)
#@gimp : Vertical tiles = int(1,1,8)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2013/10/26</i>.</small>")
gcd_unstereo : -skip ${1=5},${2=0.1},${3=0},${4=1},${5=1},${6=1},${7=0},${8=0}
-repeat @# -l[$>]
-if {$4" && "$8} pr=1 -else pr=$1 -endif
-to_rgb[0] -split_tiles[0] $5,$6
-repeat @# -l[$>]
-s[0] c --equalize[0,1] 256
--displacement[-2] [-1],$2,$pr
-if $3 -sh[-1] 1,1 -f[-1] 0 -rm[-1] -endif
-/[-1] 2 -warp[1,2] [-1],1 -*[-1] -1 -warp[0] [-1],1
-keep[0-2] -a c -c[0] 0,255
-endl -done
-append_tiles $5,$6
-endl -done
gcd_unstereo_preview :
-gimp_split_preview "-gcd_unstereo ${1--1},1",$-1
#@gimp _
#@gimp <b>Testing</b>
#@gimp <i>Corvo</i>
#@gimp Corvo's painting 5 : gimp_corvo_painting_5, gimp_corvo_painting_5(0)
#@gimp : Note = note("Polygonize settings")
#@gimp : Amplitude = int(35,0,2000)
#@gimp : Smoothness = float(10,0,100)
#@gimp : Minimal area = float(10,0,100)
#@gimp : Alpha polygonize = float(0.5,0,1)
#@gimp : Sep = separator()
#@gimp : Texture = float(50,0,100)
#@gimp : Plasma = float(0.3,0,1)
#@gimp : Sep = separator()
#@gimp : Note = note("Smooth settings")
#@gimp : Amplitude = float(50,0,1000)
#@gimp : Gradient smoothness = float(2,0,10)
#@gimp : Tensor smoothness = float(5,0,10)
#@gimp : Alpha filter = float(1,0,1)
gimp_corvo_painting_5 :
--polygonize $1,$2,$3,10,10
--blend[0,1] alpha,$4
-texturize_canvas[2] $5,0.5,0.6
-smooth[2] $7,0.4,0.7,$8,$9
--plasma[2] 0.7,100,8 -n 0,255
-blend[3,2] grainmerge,$6
-bilateral[0,2] 10,7
-blend[0,2] alpha,$10
-rm[-1]
#@gimp _
#@gimp <i>Garagecoder</i>
#@gimp <i>.image repair [old]</i>
#@gimp Anti alias : gcd_anti_alias, gcd_anti_alias_preview(0)
#@gimp : Note = note("<i>Selectively smooth resizing pixelation</i>"), sep = separator()
#@gimp : Smooth amount = int(60,0,200)
#@gimp : Edge exponent = float(0.3,0,10)
#@gimp : Lighten edges = int(50,0,255)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2013/02/09</i>.</small>")
gcd_anti_alias : -skip ${1=10},${2=0.3},${3=10}
-repeat @# -l[$>]
-remove_opacity[-1]
--smooth[0] $1,0,1,1.6,1.1,0.8,30,0.6
--gradient_norm[0] --n[-1] 0,$3 -add[0,-1]
-pow[-1] $2 -n[-1] 0,255
--gradient_norm[-1] -pow[-1] $2 -n[-1] 0,255
-blend[-2,-1] overlay -append[-2,-1] c
-blend[0,1] alpha -c 0,255
-endl -done
gcd_anti_alias_preview :
-gimp_split_preview "-gcd_anti_alias ${1--2}",$-1
gcd_srgb2jpeg :
-repeat @# -l[$>]
-if {s<3} -continue -endif
-if {s==4} -split_opacity -endif
-mix_rgb[0] 0.299,0.587,0.114,-0.168736,-0.331264,0.5,0.5,-0.418688,-0.081312
-sh[0] 1,2 -+[-1] 128 -rm[-1] -a c
-endl -done
gcd_jpeg2srgb :
-repeat @# -l[$>]
-if {s<3} -continue -endif
-if {s==4} -split_opacity -endif
-sh[0] 1,2 --[-1] 128 -rm[-1]
-mix_rgb[0] 1,0,1.402,1,-0.34414,-0.71414,1,1.772,0 -a c
-endl -done
gcd_srgb2luma :
-repeat @# -l[$>]
-remove_opacity
-if {s!=3} -continue -endif
-sh[0] 0,0 -sh[0] 1,1 -sh[0] 2,2
-*[1] 0.299 -*[2] 0.587 -*[3] 0.114
-+[1-3] -rm[1] -channels[0] 0 -a c
-endl -done
gcd_srgb2luminance :
-repeat @# -l[$>]
-remove_opacity
-if {s!=3} -continue -endif
-srgb2rgb[0] -sh[0] 0,0 -sh[0] 1,1 -sh[0] 2,2
-*[1] 0.2126 -*[2] 0.7152 -*[3] 0.0722
-+[1-3] -rm[1] -channels[0] 0 -a c
-endl -done
gcd_label : -skip ${1=4},${2=0.067}
-repeat @# -l[$>]
-label[-1] $1,1 nb=@{-1,1+iM}
--histogram[-1] $nb,0,{$nb-1}
--map[-2] [-1] -rm[-2]
-le[-1] {$2%*w*h} -*[-1] 255
-inpaint[-2] [-1] -rm[-1]
-endl -done
gcd_shrink :
_gcd_w=@{0,w} _gcd_h=@{0,h}
-repeat @# -l[$>] -if {max(w,h)>700} -rr2d[-1] 700,700,0,1 -endif -endl -done
gcd_unshrink :
-repeat @# -l[$>] -r $_gcd_w,$_gcd_h -endl -done
#@gimp Compression blur : gcd_comp_blur, gcd_comp_blur_preview(0)
#@gimp : Note = note("<i>For subtle smoothing of compression artifacts</i>")
#@gimp : Sep = separator(), note = note("<small>1. Preview will <b>not</b> show the final result accurately.</small>")
#@gimp : Note = note("<small>2. Be sure to apply <b>before</b> any image resizing.</small>")
#@gimp : Note = note("<small>3. Reduce grid width when increasing divisions to avoid over-smoothing.</small>")
#@gimp : Note = note("<small>4. Set grid divisions to zero for 100% smoothing.\n</small>")
#@gimp : Sep = separator()
#@gimp : Grid divisions = int(2,0,3)
#@gimp : Grid width = int(3,1,3)
#@gimp : Grid smoothing = float(1,0,1)
#@gimp : Preserve edges = int(100,0,100)
#@gimp : Colour channels = bool(1)
#@gimp : Boost smooth = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2013/02/09</i>.</small>")
gcd_comp_blur : -skip ${1=2},${2=3},${3=1},${4=100},${5=1},${6=0}
gsz={2^(5-$1)}
-repeat @# -l[$>]
-remove_opacity[-1]
--to_gray[0] -edges[-1] 14.5% -n[-1] {100-$4}%,100%
-if {@{0,s}>1" && "$5}
--apply_channels_old[0] "-median 5",4
-image[0] [-1],0,0,0,0,1,[-2] -rm[-1]
-endif
-if {$1==0} {w},{h},1,1,255 -mul[-2,-1] -else
{w},{h},1,1,0
-grid[-1] $gsz,$gsz,0,0,1,255
-if {$2>=2} -grid[-1] $gsz,$gsz,1,1,1,255 -endif
-if {$2==3} -grid[-1] $gsz,$gsz,-1,-1,1,255 -endif
-blur[-1] $3,0 -mul[-2,-1]
-endif
-i[-2] [0] -append[-2,-1] c
-smooth[1] {100*$6+100},0.6,0.3
-blend[0,1] alpha
-if {!$6} -sharpen[-1] 20 -endif
-endl -done
gcd_comp_blur_preview :
-gimp_split_preview "-gcd_comp_blur ${1--2}",$-1
#@gimp Jpeg smooth : gcd_jpeg_smooth, gcd_jpeg_smooth_preview(0)
#@gimp : Note = note("<i>Quick JPEG cleanup for moderate compression glitches</i>")
#@gimp : Sep = separator()
#@gimp : Compression filter = bool(1)
#@gimp : Anti alias = bool(1)
#@gimp : Quick enlarge = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2013/02/09</i>.</small>")
gcd_jpeg_smooth : -skip ${1=1},${2=1},${3=0}
-repeat @# -l[$>]
-if $1 -gcd_comp_blur[-1] 2,3,1,100,1 -endif
-if $3 -r[-1] 140%,140%,1,3,5 -c[-1] 0,255 -endif
-if $2 -gcd_anti_alias[-1] 10,0.3,10 -endif
-endl -done
gcd_jpeg_smooth_preview :
-gimp_split_preview "-gcd_jpeg_smooth ${1--2}",$-1
#@gimp _
#@gimp Blend [feather] : gcd_blend_feather, gcd_blend_feather(1)
#@gimp : Note = note("<u>Overlay layers seamlessly by feathering edges</u>")
#@gimp : Note = note("<small>1. Set Input layers to <b>Active &amp; below</b> for two layers</small>")
#@gimp : Note = note("<small>2. For best results ensure layers are the same size</small>")
#@gimp : Note = note("\n<i>Output Options</i>"), sep = separator()
#@gimp : Max delta = int(100,0,200)
#@gimp : Color transfer = float(0.5,0,1)
#@gimp : Hue extent = float(2,0,6)
#@gimp : Remove bg = int(0,0,20)
#@gimp : Keep layers = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2014/05/05</i>.</small>")
#@gimp : Note = note("\n<small><b><u>Notes</u></b></small>")
#@gimp : Note = note("<small>Remove BG can help mask off unwanted areas, which works</small>")
#@gimp : Note = note("<small>best on objects surrounded by simple backgrounds.</small>")
#@gimp : Note = note("<small>Overlaying a larger area can sometimes improve the output.</small>")
gcd_blend_feather : -skip ${1=100},${2=0.5},${3=2},${4=0},${5=0}
-r[^-1] [-1],[-1],1,100%,0,0,0.5,0.5
-if $5
--gcd_blend_maxdelta ${1-4}
-to_a[0] -split_opacity[0] -rv[1,-1] -a[1,-1] c -rm[0]
-else -gcd_blend_maxdelta ${1-4} -endif
gcd_blend_maxdelta : -skip ${1=100},${2=0.5},${3=2},${4=0}
-if {@#>1} -repeat {@#-1} -l[0,1]
-to_a -split_opacity -/[1,3] 255
-nm[0] upper -nm[1] alpha -nm[2] lower -nm[3] mask
--r[lower] 1,1,1,100%,2
--+[upper] 0.1 -*[-1] [alpha]
-s[-1] c -discard[-3--1] 0 -a[-3--1] c
-r[-1] 1,1,1,100%,2 -r[-2,-1] [upper]
-*[-2,-1] $2 -sub[upper,-1] -add[upper,-1] -c[upper] 0,255
--distance[alpha] 0 -nm[-1] dist
-eq[mask] 0 -*[mask] @{dist,M} -max[dist] [mask]
-if {$4>0}
[upper] [alpha] -a[-2,-1] c
-gcd_fgmask[-1] {20-$4} -b[-1] 3 -*[alpha,-1]
-endif
--n[dist] 0,$3 -c[-1] 0,1 -*[-1] [alpha]
-gcd_srgb2jpeg[upper,lower] -sh[upper,lower] 1,2
-j[-1] [-2],0,0,0,0,1,[-3] -rm[-3--1]
-gcd_jpeg2srgb[upper,lower]
-n[dist] 0,{255*$1%}
--sub[upper] [lower] -*[-1] [alpha]
--sign[-1] -abs[-2] -min[dist,-2] -*[dist,-1]
-+[lower] [dist] -k[lower] -c 0,255
-endl -done -endif
gcd_fgmask : -skip ${1=0}
-repeat @# -l[$>]
-to_a -expand_xy 20,0 -split_opacity -gt[-1] 0
--distance[-1] 0 -max_patch[-1] 3 -*[-1] 2
--erode[1] 20 -*[-2,-1] -dilate[-1] $1
--gradient_norm[-2] -gt[-1] 0
-gradient_norm[0] --eq[-1] 0 -*[0,-1]
-max[-2,-1] -*[0,1] -*[0] -1
-watershed[-1] [-2] -rm[-2]
-shrink_xy 20 -- 1
-endl -done
#@gimp Depth blur : gcd_depth_blur, gcd_depth_blur(1)
#@gimp : Note = note("<u>Selectively blur based on estimated depth</u>")
#@gimp : Note = note("<small>Amount of blur applied is relative to luminance of the depth map</small>")
#@gimp : Note = note("\n<i>Focus Options</i>"), sep = separator()
#@gimp : Distance threshold = int(0,0,100)
#@gimp : Blur amount = int(15,0,100)
#@gimp : Note = note("\n<i>Depth Map Options</i>"), sep = separator()
#@gimp : Blur percentage = float(0.25,0,2)
#@gimp : Object ratio = float(2,0,4)
#@gimp : Object tolerance = int(4,0,5)
#@gimp : Create/view depth map = bool(0)
#@gimp : Reverse map = bool(1)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2013/02/24</i>.</small>")
gcd_depth_blur : -skip ${1=0},${2=15},${3=0.25},${4=2},${5=4},${6=0},${7=1}
-repeat @# -l[$>]
sa={$2*max(w,h)/1000}
-to_rgb[0]
--gcd_depth[0] $3,$4,$5
-if $7 -negative[-1] -endif
-threshold[-1] $1%,1 -n[-1] 0,255
-if $6 -keep[-1] -else
{w},{h},1,1,0 [-2] -a[-3--1] c
-smooth[-2] [-1],$sa,30,0 -rm[-1]
-c[-1] 0,255
-endif
-endl -done
#@gimp Emboss : gcd_emboss, gcd_emboss(1)
#@gimp : Note = note("<i>Make an image look embossed</i>"), sep = separator()
#@gimp : Midpoint = int(128,0,255)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2014/11/11</i>.</small>")
gcd_emboss : -skip ${1=128}
-repeat @# -l[$>]
--norm --bilateral[0] 2%,30 -norm[-1] --[-2,-1]
--n[0] 0,255 -median[-1] 3 -bilateral[-1] 2%,30
-gcd_srgb2luma[-1] --[-1] $1
--abs[-1] -negative[-1]
--max[-2] 0 -min[-3] 0 -abs[-3]
-pde_flow[1] 20,7,iee
--n[-3] 0,2 -*[-1] [1] -+[0,-1]
--n[-1] 0,2 -*[-1] [1] -+[0,-1]
--n[-2] 0,2 -*[-1] [1] -+[0,-1]
-+[0,2] --[0,3] -k[0]
-gcd_srgb2luminance -c 0,255
-endl -done
#@gimp Recolor : gcd_recol, gcd_recol(1)
#@gimp : Note = note("<i>Apply colors to a black and white image</i>"), sep = separator()
#@gimp : Min hue drift = int(-14,-45,0)
#@gimp : Max hue drift = int(14,0,45)
#@gimp : Sep = separator(), note = note("<b>Note :</b> This filter needs two layers to work properly.")
#@gimp : Note = note("<small>Original Author : <i>David Tschumperl&#233;</i></small>")
#@gimp : Note = note("<small>Adapted by : <i>Garagecoder</i>.   Latest update: <i>2013/01/16</i>.</small>")
gcd_recol :
-repeat {int(@#/2)} -l[$>,{$>+1}]
-rv[-2,-1]
-channels[-2] 0 -to_rgb[-2]
-to_rgba[-1] -split_opacity[-1] -neq[-1] 0
-srgb2rgb[-3,-2] -rgb2lab8[-3,-2] -channels[-3] 0 -channels[-2] 1,2
-+[-2] 1 -*[-2] [-1]
--meancurvature_flow[-3] 3 -median[-1] 3
-gradient_norm[-1] -*[-1] -1 -watershed[-3] [-1] -rm[-1] --[-2] 1
-rm[-1] -a[-2,-1] c -lab82rgb[-1] -rgb2srgb[-1]
-rgb2hsv[-1] -s c --equalize[2] 512 -n[-1] $1,$2 -+[0,-1] -%[0] 360 -a c -hsv2rgb[-1]
-endl -done
#@gimp Seam carve : gcd_seamcarve, gimp_no_preview
#@gimp : Note = note("<i>Basic seam-carving algorithm</i>"), sep = separator()
#@gimp : Seams = int(10,1,100)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.     Optimisations : <i>David Tschumperl&#233;</i>.</small>")
#@gimp : Sep = separator(), note = note("<small>Latest update : <i>2014/05/20</i>.</small>")
#@gimp : Note = note("\n<small><b>Warning:</b> can be extremely slow with high number of seams!</small>")
#@gimp : Note = link("http://en.wikipedia.org/wiki/Seam_carving")
gcd_seamcarve : -skip ${1=10}
-v - -l[-1] -to_rgb -repeat $1
ow={w} oh={h} os={s}
--compose_channels + -g[-1] xy,3 -abs[-2,-1] -+[-2,-1] -sqr[-1]
-repeat $oh
--rows[-1] {$>-1} -erode[-1] 3
-j[-2] [-1],0,$>,0,0,-1 -rm[-1]
-done
-sh[-1] 100%,100%,0,0 cx={xm} -rm[-1] $oh,1,1,1 -=[-1] $cx,100%
-repeat {$oh-1}
--z[-2] {$cx-1},$<,{$cx+1},$<,1
cx={max($cx+xm-1,0)} -rm[-1] -=[-1] $cx,$<
-done
-gcd_vpointcloud2d[0,-1] -1
-rm[-1] -discard -1 -r {$ow-1},$oh,1,$os,-1
-rprogress {$>*100/$1}
-done -endl -v +
gcd_vpointcloud2d : -skip ${1=1}
-l[-2,-1]
pts={w} ch=@{0,s}
(67.5;73.5;109.5;103.5;51.5;100.5;$pts;$pts)
--y[1] 1,$pts,1,1,y 1,$pts,1,1,0 -a[-3--1] x
1,$pts,1,1,1 1,$pts,1,1,y -a[-2,-1] x
(-128,1,1,$ch,$1) -z[-1] 0,0,{$ch+3},{$pts-1},1
-y[-3--1] 1,$pts,1,1,1 -a[-5--1] y
-object3d[0] [-1],0,0,0,1,0,0,0 -rm[-2,-1]
-endl
#@gimp Seam carve [fast] : gcd_opt_seams, gcd_opt_seams(1)
#@gimp : Note = note("<i>Optimised seam-carving algorithm</i>"), sep = separator()
#@gimp : Size = int(75,0,200), Sep = separator()
#@gimp : Note = note("<small>Author : <i>Garagecoder</i>.    Latest update : <i>2014/06/04</i>.</small>"), Sep = separator()
#@gimp : Note = note("<small>Based on the paper \'Real-time content-aware image resizing\' - HUANG Hua et al.</small>")
#@gimp : Note = link("http://en.wikipedia.org/wiki/Seam_carving")
gcd_opt_seams : -skip ${1=75}
-v -
ow={w} oh={h} os={s} ssms={max(min(round(w*$1/100-w),w),1-w)} sms={abs($ssms)}
--gradient[-1] -a[-2,-1] c -abs[-1] -compose_channels[-1] + -+[-1] 0.1
[-1]
-repeat $oh
--rows[-1] {$<+1} -erode[-1] 3
-j[-2] [-1],0,$<,0,0,-1 -rm[-1]
-done
$ow,$oh,1,1,0 --rows[1] 0
-nm[1] grad -nm[2] low -nm[3] seam -nm[4] top
-repeat {$oh-1} nr={$>+1}
--rows[low] $nr
--*[4,5] --shift[4] 1 -*[-1] [5] --shift[5] 1 -*[-1] [4]
-+[-2,-1] -j[5] [4] -a[-3--1] c
-f[-1] ">if(c,i,max(j(-1)+j(0,0,0,1),j(-2)+j(0,0,0,2)))"
-s[-1] c -shift[-3] 1 -+[-2] [-3] -shift[-3] 1 -+[-3,-1]
-gt[-2,-1] -f[-1] "<if(j(1)<0,1,-i)"
-j[seam] [-1],0,$>
-a[-2,-1] c -f[-1] "j(i,0,0,-1)" -channels[-1] 1
--rows[grad] $nr -+[top,-1]
-done
max={iM*2} mw={w-1} --mirror[-1] x
-repeat $sms
-if {$>%2} pos=@{-2,xm} -=[-2] $max,$pos -=[-1] $max,{$mw-$pos}
-else pos=@{-1,xm} -=[-1] $max,$pos -=[-2] $max,{$mw-$pos} -endif
-done -rm[-1]
-j[grad] [-1],0,100% -rm[low,top] -a[-2,-1] c
-f[-1] "<if(c,i,j(j(0,0,0,1),1,0,0,0,1))" -channels[-1] 0
-+[0] 0.1 -neq[-1] $max
-if {$ssms<=0} -* -discard 0
-else
--[-1] 2 -s[0] c
-repeat $os -if {$><($os-1)} [-1] -endif -a[$>,-1] c -done
-permute cxyz -a c -discard -1 --eq[-1] -2 -shift[-1] 0,-1
-j[-2] [-2],0,1,0,0,1,[-1] -rm[-1]
-endif
-r {$ow+$ssms},$oh,1,$os,-1 --[0] 0.1
-v +
#@gimp Sharpen [tones] : gcd_sharpen_tones, gcd_sharpen_tones(1)
#@gimp : Note = note("<i>Sharpen shadows and highlights</i>"), sep = separator()
#@gimp : Amount = float(1,0,4)
#@gimp : Centre = int(128,0,255)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2014/06/19</i>.</small>")
gcd_sharpen_tones : -skip ${1=1},${2=128}
-repeat @# -l[$>]
--norm --bilateral[0] 2%,30 -norm[-1] --[-2,-1]
--n[0] 0,255 -median[-1] 3 -bilateral[-1] 2%,30
-gcd_srgb2luma[-1] --[-1] $2
--max[-1] 0 -min[-2] 0 -abs[-2]
-n[-2,-1] 0,$1 -*[-2,-1] [1]
-rm[-3] -+ -c 0,255
-endl -done
#@gimp Smart rotate : gcd_srotate, gcd_srotate(1)
#@gimp : Note = note("<u>Rotate an image and extrapolate the corners</u>")
#@gimp : Note = note("\n<i>Rotation Options</i>"), sep = separator()
#@gimp : Angle = int(0,-90,90)
#@gimp : Centrex = int(50,0,100)
#@gimp : Centrey = int(50,0,100)
#@gimp : Note = note("\n<i>Quality Options</i>"), sep = separator()
#@gimp : Interpolation = choice(1,"Linear","Bicubic")
#@gimp : Inpainting = choice(1,"Low","Normal","High","Ultra")
#@gimp : Lookup scale = int(6,1,16)
#@gimp : Lookup factor = float(0.6,0.2,2)
#@gimp : Seamless = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2014/12/05</i>.</small>")
#@gimp : Note = note("\n<small><b><u>Notes</u></b></small>")
#@gimp : Note = note("<small>* Dimensions are not altered</small>")
#@gimp : Note = note("<small>* Quality settings affect speed!</small>")
#@gimp : Note = note("<small>The preview is a rough guide only.  Images with simple edges tend to work best.</small>")
#@gimp : Note = note("<small>Results can be improved by selecting a higher inpainting quality, but processing will take longer.</small>")
#@gimp : Note = note("<small>Select seamless to reduce visible seams at the corners.</small>")
gcd_srotate : -skip ${1=0},${2=50},${3=50},${4=1},${5=1},${6=6},${7=0.6},${8=0}
-repeat @# -l[$>]
-rotate $1,{$4+1},1,$2%,$3%,1 -c 0,255 -split_opacity
-l[0]
{w},{h},1,1,1 -rotate[-1] $1,0,0,$2%,$3%,1
-eq[-1] 0 --area[-1] 0 -*[-1] [-2]
ps={max(round(iM^0.5/6),4)} -rm[-1]
-if $8
--inpaint[0] [-1],$ps,{$ps*$6},$7,{9-$5*2},{$ps*1.2},0,0.08
-rv[-2,-1] -a[-2,-1] c -blend_seamless 0,0,25%
-else
-inpaint[0] [-1],$ps,{$ps*$6},$7,{9-$5*2},{$ps*1.2},0,0.08 -rm[-1]
-endif
-endl -a c
-endl -done
#@gimp Split objects : gcd_splitobj, gcd_splitobj(1)
#@gimp : Note = note("<u>Extract objects from an image to a new layer</u>")
#@gimp : Note = note("<small>1. Create a new transparent layer, mark background red and objects green</small>")
#@gimp : Note = note("<small>2. Set Input layers to <b>Active &amp; below</b>, objects will be split to two layers</small>")
#@gimp : Note = note("\n<i>Edge Detection Options</i>"), sep = separator()
#@gimp : Alpha min = int(50,0,100)
#@gimp : Edge flow = int(3,0,20)
#@gimp : Median = int(3,0,7)
#@gimp : Note = note("\n<i>Output Options</i>"), sep = separator()
#@gimp : Swap layers = bool(0)
#@gimp : Grow alpha = int(0,-20,20)
#@gimp : Blur alpha = int(0,0,20)
#@gimp : Inpainting = choice(0,"Off","Low","Normal","High","Ultra")
#@gimp : Sep = separator(), note = note("<b>Note :</b> This filter needs two layers to work properly.")
#@gimp : Note = note("<small>Author : <i>Garagecoder</i>.   Latest update: <i>2014/03/14</i>.</small>")
gcd_splitobj : -skip ${1=50},${2=3},${3=3},${4=0},${5=0},${6=0},${7=0}
-if {@.<1584} -rm 400,400,1,3,0 -text[-1] "Requires\nversion 1.5.8.4\nor later!",30%,10%,24,1,255 -return -endif
-repeat {int(@#/2)} -l[$>,{$>+1}]
-to_rgba [-1]
--channels[1] 100% -ge[-1] $1% -luminance[1] -*[1,-1]
-split_opacity[0] -neq[1] 0 -channels[0] 0,1 -+[0] 1 -*[0,1]
-meancurvature_flow[1] $2 -median[1] $3
-gradient_norm[1] -*[1] -1 -watershed[0] [1] --[0] 1
-rm[1] -s[0] c -n[0,1] 0,1
-if {$4} -rv[0,1] -endif
-if {$5>0} -dilate[1] $5 -elif {$5<0} -erode[1] {abs($5)} -endif
-if $6 -b[1] $6,1,1 -c[1] 0,1 -endif
--*[2] [0] -rm[0]
-if {$7>0}
-le[0] 80% --area[0] 0 -*[-1] [0]
ps={max(round(iM^0.5/6),4)} -rm[-1] -n[0] 0,255
-inpaint[1] [0],$ps,{$ps*6},1,{9-$7*2},{$ps*1.2},0,0.08,10,1
-else -*[1] [0] -endif
-rm[0]
-if {s==2||s==4} -sh 100%,100% -max[-2] 1 -max[-1] 1 -rm[-2,-1] -endif
-endl -done
#@gimp Stereo video : gcd_stereo_vid, gcd_stereo_vid_preview(1)
#@gimp : Note = note("<u>Convert a series of image files to 3D</u>")
#@gimp : Note = note("\n<i>File Options</i>"), sep = separator()
#@gimp : Start image = file()
#@gimp : End image = file()
#@gimp : Output folder = _folder()
#@gimp : Note = note("\n<i>3D Options</i>"), sep = separator()
#@gimp : 3d image type = choice("Anaglyph: Red/Cyan","Side by Side","Depth Map","Inverse Depth Map")
#@gimp : Balance color = choice(4,"None","Fast Half","Fast Full","Low","Medium","High","Full")
#@gimp : Depth = float(1.2,0,2)
#@gimp : Note = note("\n<i>Depth Map Options</i>"), sep = separator()
#@gimp : Blur percentage = float(0.25,0,2)
#@gimp : Object ratio = float(2,0,4)
#@gimp : Object tolerance = int(4,0,5)
#@gimp : Despeckle = bool(1)
#@gimp : Note = note("\n<i>Video Options</i>"), sep = separator()
#@gimp : Frame buffer = _int(5,1,10)
#@gimp : Scene detection = bool(1)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2014/05/31</i>.</small>")
gcd_stereo_vid :
1 -l[-1]
-i "$1" st_folder=@{-1,f} st_file=@{-1,b} st_ext=@{-1,x} ({'$st_file'}) cpx=@{-1,w}
-do cpx={$cpx-1} dgt={i($cpx)} isnum={($dgt>47)&&($dgt<58)} -while {($isnum)&&($cpx>0)}
-if {$cpx>0} --z[-1] 0,$cpx fsname=@{-1,t} -rm[-1] -else fsname="" -endif
-z[-1] {$cpx+{!$isnum}},100% dgts=@{-1,w} fsnum={@{-1,t}} -rm[-1]
1 -nm[-1] "$2" en_file=@{-1,b} ({'$en_file'}) cpx=@{-1,w}
-do cpx={$cpx-1} dgt={i($cpx)} isnum={($dgt>47)&&($dgt<58)} -while {($isnum)&&($cpx>0)}
-z[-1] {$cpx+{!$isnum}},100% fenum={@{-1,t}} -rm[-2,-1]
bufsz=$11 ttlbuf={$bufsz*2} ttlimg={$fenum-$fsnum+1}
scene=1 scframe=0 ov=@{-1,v} oa=@{-1,a}
-repeat {$ttlimg}
-if {$scene" && "$>==$scframe}
-k[-1] scene=0
-repeat {min($ttlbuf,$ttlimg-$scframe-1)}
curnum={$fsnum+$scframe+$>+1} curnum=@{-gcd_add0\ $curnum,$dgts}
-i ""${st_folder}${fsname}${curnum}.${st_ext}""
vr=@{-1,v} av=@{-1,a} pvr={abs($vr-$ov)/$vr} pav={abs($av-$oa)/$av}
ov=$vr oa=$av
-if {$12&&($pvr>0.1" || "$pav>0.1)} scene=1 scframe={$scframe+$>+1} -break
-endif
-done
--l[0--{1+$scene}] -apply_parallel "-gcd_depth $7,$8,$9,$10" --add[0--1] -a[0--2] z -endl
-mv[-1] 0 -mv[-1] 1 -a[2--{1+$scene}] z
-endif
--slices[2] 0 --div[0] @{1,d} -gcd_stereo[-2,-1] $4,$5,$6%
curnum={$fsnum+$>} curnum=@{-gcd_add0\ $curnum,$dgts}
-if @{-is_windows} -o[-1] "$3"""{`92`}${fsname}${curnum}.${st_ext}""
-else -o[-1] "$3"""{`47`}${fsname}${curnum}.${st_ext}"" -endif
-progress {($>+1)/$ttlimg*100}
-rm[-1] -slices[2] 1,100%
-if {!$scene" && "($>>=($scframe+$bufsz))" && "($><($ttlimg-$bufsz-1))}
curnum={$fsnum+$>+$bufsz+1} curnum=@{-gcd_add0\ $curnum,$dgts}
-i ""${st_folder}${fsname}${curnum}.${st_ext}""
vr=@{-1,v} av=@{-1,a} pvr={abs($vr-$ov)/$vr} pav={abs($av-$oa)/$av}
ov=$vr oa=$av
-if {$12&&($pvr>0.1" || "$pav>0.1)} scene=1 scframe={$>+$bufsz+1}
-else
--gcd_depth[-1] $7,$8,$9,$10 -add[0] [-1] -a[1,-1] z -a[2,-1] z
--slices[1] 0 -sub[0,-1] -slices[1] 1,100%
-endif
-endif
-done
-rm
-endl
gcd_stereo_vid_preview : -skip ${1=""},${2=""}
-l -i "$1" -onfail 100,100,1,3,0 -text[-1] "Select\nStart\nImage   ",0,0,32,1,255 -endl
-l -i "$2" -onfail 100,100,1,3,0 -text[-1] "Select\nEnd\nImage   ",0,0,32,1,255 -endl
-k[-2,-1] -a[0,1] x -to_rgb[0] --gcd_depth[-1] $7,$8,$9,$10 -gcd_stereo $4,$5,$6%
gcd_add0 :
({'$1'}) -if {@{-1,w}<$2} {$2-@{-1,w}},1,1,1,48 -rv[-2,-1] -a[-2,-1] x -endif -u @{-1,t} -rm[-1]
#@gimp Tone enhance : gcd_tone_enhance, gcd_tone_enhance(1)
#@gimp : Note = note("<u>Sharpen or adjust shadows and highlights</u>")
#@gimp : Note = note("\n<i>Shadows</i>"), sep = separator()
#@gimp : Detail = float(1,0,2)
#@gimp : Bright = float(0,-1,1)
#@gimp : Contrast = float(0,0,2)
#@gimp : Note = note("\n<i>Highlights</i>"), sep = separator()
#@gimp : Detail = float(1,0,2)
#@gimp : Bright = float(0,-1,1)
#@gimp : Note = note("\n<i>Mid Point</i>"), sep = separator()
#@gimp : Centre = int(128,0,255)
#@gimp : Detail = float(0,0,2)
#@gimp : Bright = float(0,-1,1)
#@gimp : Note = note("\n<i>Detail Mask</i>"), sep = separator()
#@gimp : Smooth = int(0,0,20)
#@gimp : Sep = separator()
#@gimp : Values = choice("cut","normalize","normalize luma")
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2014/10/26</i>.</small>")
gcd_tone_enhance : -skip ${1=1},${2=0},${3=0},${4=1},${5=0},${6=128},${7=0},${8=0},${9=0},${10=0}
-repeat @# -l[$>]
--norm --bilateral[0] 2%,30 -norm[-1] --[-2,-1]
--n[0] 0,255 -median[-1] 3 -bilateral[-1] 2%,30
-gcd_srgb2luma[-1] --[-1] $6
--abs[-1] -negative[-1]
--max[-2] 0 -min[-3] 0 -abs[-3]
-if $9 -pde_flow[1] $9,7,iee -endif
--n[-3] 0,$1 -*[-1] [1] -+[0,-1]
--n[-1] 0,$4 -*[-1] [1] -+[0,-1]
--n[-2] 0,$7 -*[-1] [1] -+[0,-1]
--apply_gamma[-3] 0.3 -n[-1] 0,$3 -+[-1] 1 -*[0,-1]
-*[2] $2 -*[3] $8 -*[4] $5 -+[0,2,3,4] -k[0]
-if {$10>1}
-gcd_srgb2jpeg
-sh 0,0 -n[-1] 0,255 -rm[-1]
-gcd_jpeg2srgb -c 0,255
-elif $10 -n 0,255 -else -c 0,255 -endif
-endl -done
#@gimp Unquantize [jpeg smooth] : gcd_unquantize, gcd_unquantize(0)
#@gimp : Note = note("<u>Remove quantization artifacts</u>")
#@gimp : Note = note("<small>1. Preview will <b>not</b> show the final result accurately.</small>")
#@gimp : Note = note("<small>2. Be sure to apply <b>before</b> any image resizing.</small>")
#@gimp : Note = note("\n<i>Block Smoothing Options</i>"), sep = separator()
#@gimp : Iterations = int(6,0,8)
#@gimp : Preserve edges = float(1,0,1)
#@gimp : Color channels = bool(1)
#@gimp : Note = note("\n<i>Anti-Aliasing Options</i>"), sep = separator()
#@gimp : Iterations = int(5,0,30)
#@gimp : Threshold = int(15,1,200)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2014/04/29</i>.</small>")
#@gimp : Note = note("\n<small><b><u>Notes</u></b></small>")
#@gimp : Note = note("<small>Useful for removal of common compression and rescaling artifacts.</small>")
#@gimp : Note = note("<small>* If a specific glitch remains, try reducing edge preservation.</small>")
#@gimp : Note = note("<small>* For AA only set Block Iterations to 0.</small>")
gcd_unquantize : -skip ${1=6},${2=1},${3=1},${4=5},${5=15}
-repeat @# -l[$>]
-gcd_srgb2jpeg -s c
-if {$1>0}
--edges[0] 14.5% -n[-1] {1-$2},1
-if {$3" && "@#>2}
-a[1,2] c --apply_parallel_overlap[1] "-median 5",3
-j[1] [-1],0,0,0,0,1,[-2] -rm[-1]
-endif
{w},{h},1,1,0 -grid[-1] 8,8,0,0,1,1 -grid[-1] 8,8,-1,-1,1,1
-b[-1] 1,0 -*[-2,-1] -n[-1] 0,1 --pde_flow[0] $1,30,iee,0
-j[0] [-1],0,0,0,0,1,[-2] -rm[-2,-1]
-endif
-if {$4>0}
--median[0] 3 -sub[-1] [0]
-abs[-1] -ge[-1] $5
-dilate[-1] 3 -n[-1] 0,1
--apply_parallel_overlap[0] "-pde_flow "$4",7,iee,0",8
-j[0] [-1],0,0,0,0,1,[-2] -rm[-2,-1]
-endif
-a c -gcd_jpeg2srgb -c 0,255
-endl -done
#@gimp Warp map : gcd_warpmap, gcd_warpmap(1)
#@gimp : Note = note("<i>Warp an image using another as a surface</i>"), sep = separator()
#@gimp : Depth = float(5,0,20)
#@gimp : Detail = float(0,0,10)
#@gimp : Smoothness = float(0,0,10)
#@gimp : Blend mode = choice("Warp","Multiply","Softlight","None")
#@gimp : Swap layers = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.      Latest update : <i>2013/02/09</i>.</small>")
#@gimp : Note = note("\n<small><b><u>Notes</u></b></small>")
#@gimp : Note = note("<small>The top layer will be warped using the bottom layer as a surface.</small>")
#@gimp : Note = note("<small>\nDepth: Set the apparent depth of the surface.</small>")
#@gimp : Note = note("<small>Detail: Perform second warp with no smooth for fine detail.</small>")
#@gimp : Note = note("<small>Smooth: Set low for emboss, high to wrap around large objects.</small>")
gcd_warpmap : -skip ${1=5},${2=0},${3=0},${4=0},${5=0}
-repeat {int(@#/2)} -l[$>,{$>+1}]
-if $5 -rv -endif
-if {$4==3} bm=0 -i[0] [-1] -else bm=$4 -endif
-if $2 --gcd_warp[-2,-1] $1,$3 -rm[-3] -rv[-2,-1] -gcd_warp[-2,-1] $2,0,$bm
-else -gcd_warp[-2,-1] $1,$3,$bm -endif
-if {$4==3} -rv -endif
-endl -done
gcd_warp : -skip ${1=5},${2=0},${3=0}
-repeat {int(@#/2)} -l[$>,{$>+1}]
wfac={$1%*w} -to_rgba[-2,-1] --norm[-1]
-blur_xy[-1] $2%,$2% -n[-1] 0,255 -g[-1] xy -a[-2,-1] c
-*[-1] -1 -n[-1] -$wfac,$wfac -warp[0] [-1],1 -rm[-1]
-if {$3==0} -rm[-1] -break -endif
-if {$3==1} -blend multiply,1,1 -else -blend softlight,1,1 -endif
-endl -done
#@gimp Xbr2x : gcd_xbr2x, gcd_xbr2x(1)
#@gimp : Note = note("Implementation of the xBR 2x [noblend] algorithm by Hyllian.")
#@gimp : Note = note("For more info visit: "), note = link("http://board.byuu.org/viewtopic.php?f=10&t=2248")
#@gimp : Note = link("http://code.google.com/p/2dimagefilter/wiki/ImageResizer")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Garagecoder</i>.  Latest update : <i>2013/05/29</i>.</small>")
#@gimp : Note = note("<small>Disclaimer : This is a near complete recode based on C# source from ImageResizer</small>")
#@gimp : Note = note("<small>The results may not fully represent the original routine!</small>")
gcd_xbr2x :
-repeat @# -l[$>] -to_rgb[0]
(-1,-1;0,-1;1,-1;-1,0;0,0;1,0;-1,1;0,1;1,1;\
-1,-2;0,-2;1,-2;-2,-1;-2,0;-2,1;2,-1;2,0;2,1;-1,2;0,2;1,2)
pa_=0 pb_=1 pc_=2  pd_=3 pe_=4 pf_=5  pg_=6 ph_=7 pi_=8
a1_=9 b1_=10 c1_=11  a0_=12 d0_=13 g0_=14
c4_=15 f4_=16 i4_=17  g5_=18 h5_=19 i5_=20
e0=21 e1=22 e2=23 e3=24
($pe_,$pi_,$ph_,$pf_,$pg_,$pc_,$pd_,$pb_,$f4_,$i4_,$h5_,$i5_,$e1,$e2,$e3;\
$pe_,$pc_,$pf_,$pb_,$pi_,$pa_,$ph_,$pd_,$b1_,$c1_,$f4_,$c4_,$e0,$e3,$e1;\
$pe_,$pa_,$pb_,$pd_,$pc_,$pg_,$pf_,$ph_,$d0_,$a0_,$b1_,$a1_,$e2,$e1,$e0;\
$pe_,$pg_,$pd_,$ph_,$pa_,$pi_,$pb_,$pf_,$h5_,$g5_,$d0_,$g0_,$e3,$e0,$e2)
-*[1] -1
-repeat 21 --shift[0] @{1,(0,$>)},@{1,(1,$>)},0,0,1 -done
[0] [0] [0] [0]
-nm[0] orig -mv[0] @# -rm[0] -nm[0] kern -mv[0] @#
-repeat 4
pe=@{kern,(0,$>)} pi=@{kern,(1,$>)} ph=@{kern,(2,$>)}
pf=@{kern,(3,$>)} pg=@{kern,(4,$>)} pc=@{kern,(5,$>)}
pd=@{kern,(6,$>)} pb=@{kern,(7,$>)} f4=@{kern,(8,$>)}
i4=@{kern,(9,$>)} h5=@{kern,(10,$>)} i5=@{kern,(11,$>)}
n1=@{kern,(12,$>)} n2=@{kern,(13,$>)} n3=@{kern,(14,$>)}
--gcd_eq[$pe,$pf] --gcd_eq[$pe,$ph] -or[-2,-1] -eq[-1] 0 -nm[-1] lvl1
--gcd_yuv[$pe,$pc] --gcd_yuv[$pe,$pg] -+[-2,-1]
--gcd_yuv[$pi,$h5] -+[-2,-1] --gcd_yuv[$pi,$f4] -+[-2,-1]
--gcd_yuv[$ph,$pf] -*[-1] 4 -+[-2,-1]
-nm[-1] red
--gcd_yuv[$ph,$pd] --gcd_yuv[$ph,$i5] -+[-2,-1]
--gcd_yuv[$pf,$i4] -+[-2,-1] --gcd_yuv[$pf,$pb] -+[-2,-1]
--gcd_yuv[$pe,$pi] -*[-1] 4 -+[-2,-1]
-nm[-1] blue
--gcd_yuv[$pe,$pf] --gcd_yuv[$pe,$ph] -le[-2,-1]
--image[$ph] [$pf],0,0,0,0,1,[-1] -nm[-1] px -rm[-2]
--lt[red,blue]
--gcd_neq[$pf,$i4] --gcd_neq[$ph,$i5] -and[-2,-1] --gcd_eq[$pe,$pi] -and[-2,-1]
--gcd_neq[$pf,$pb] --gcd_neq[$ph,$pd] -and[-2,-1] -or[-2,-1]
--gcd_eq[$pe,$pg] -or[-2,-1] --gcd_eq[$pe,$pc] -or[-2,-1]
-and[-2,-1] -nm[-1] lvl2
--gcd_yuv[$pf,$pg] -nm[-1] lver
--gcd_yuv[$ph,$pc] -nm[-1] uver
--*[lver] 2 -le[-1] [uver]
--gcd_neq[$pg,$pe] --gcd_neq[$pg,$pd] -and[-2,-1]
-and[-2,-1] -and[-1] [lvl2] -image[$n3] [px],0,0,0,0,1,[-1]
--*[uver] 2 -lt[-1] [lver]
--gcd_neq[$pc,$pe] --gcd_neq[$pc,$pb] -and[-2,-1]
-and[-2,-1] -and[-1] [lvl2] -image[$n3] [px],0,0,0,0,1,[-1]
-rm[-2,-1,lver,uver]
-rm[red,blue,lvl1,lvl2,px]
-done
@{orig,w},@{orig,h},1,1,1 -r2dx[-1] {@{orig,w}*2},4 -nm[-1] msk
-r2dx[orig,$e0,$e1,$e2,$e3] {@{orig,w}*2},1
-image[orig] [$e0],0,0,0,0,1,[msk] -shift[msk] 1
-image[orig] [$e1],0,0,0,0,1,[msk] -shift[msk] -1,1
-image[orig] [$e2],0,0,0,0,1,[msk] -shift[msk] 1
-image[orig] [$e3],0,0,0,0,1,[msk]
-k[orig]
-endl -done
gcd_eq : -l[-2,-1] --[-2,-1] -norm[-1] -eq[-1] 0 -endl
gcd_neq : -l[-2,-1] --[-2,-1] -norm[-1] -neq[-1] 0 -endl
gcd_yuv : -l[-2,-1] --[-2,-1] -abs[-1] -rgb2yuv[-1] -abs[-1] -s[-1] c -*[-3] 48 -*[-2] 7 -*[-1] 6 -+[-3--1] -endl
#@gimp _
#@gimp <i>Gentlemanbeggar</i>
#@gimp 60's cinema : gimp_gb_cfx, gimp_gb_cfx_preview(0)
#@gimp : Grain = float(10,0,25)
#@gimp : Noon for midnight = bool(0)
#@gimp : Genekelly = bool()
#@gimp : Rayharryhausen = bool()
#@gimp : Carygrant = bool()
#@gimp : Sep = separator()
#@gimp : Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator()
#@gimp : Note = note{"\nUsage Notes:  Set Output mode to 'New Layer'.  After running filter, I recommend setting the newly created layer blend mode to 'hard light' when using 'noon for midnight' and 'soft light' for other images.  This filter looks best on well lit scenes."}
gimp_gb_cfx :
-if {$5==1}
-noise[0] {$1/1},4
--gimp_bwrecolorize 1,1,0,0,0,1,0,5,0,0,0,255,47,106,121,255,209,136,49,255,228,207,191,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0
-gimp_compose_edges 0.9,0.5
-else
-if {$4==1}
-gimp_bwrecolorize 1,1,0,0,0,1,0,6,0,0,0,255,27,25,55,255,137,152,189,255,191,217,228,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0
--noise[0] {$1/1},4
-compose_interpolation
-else
-if {$3==1}
-sepia
--fc[0] 0,65,00 -to_rgba[0]
-compose_interpolation
-noise[0] {$1/1},4
-compose_grainmerge
-else
-if {$2==0}
-sepia
--noise[0] $1,4
-compose_grainmerge
-else
-sepia
--fc[0] 0,0,255 -to_rgba[0]
-compose_interpolation
-noise[0] {$1/2},4
-compose_grainmerge -endif
-endif
-endif
-endif
gimp_gb_cfx_preview :
-gimp_split_preview "-gimp_gb_cfx ${1--2}",$-1
#@gimp About : _none_, gimp_gb_about
#@gimp : Note = note{"
#@gimp : <span foreground ="purple">( <b>G</b>entlemanbeggar?s <b>F</b>ilter <b>S</b>et for <b>G'MIC</b>)</span>\n\nis proposed to you by"}
#@gimp : Note = note("Gentlemanbeggar")
#@gimp : Note = note{"\n"}
#@gimp : Sep = separator()
#@gimp : Note = note{"
#@gimp : The source code of this filter is available at :"}
#@gimp : Note = link("http://gentlemanbeggar.wordpress.com")
#@gimp : "}
#@gimp : Sep = separator()
#@gimp : Note = note{"\nThe filters in this folder are still under development and may be subject to changes."}
gimp_gb_about :
-gimp_logo "GB"'"s Filters"
#@gimp Lens blur : gimp_gb_lb, gimp_gb_lb_preview(0)
#@gimp : Note = note{"\nUsage Notes:  Set Output mode to 'New image' or 'in place' to simply reverse the frames in this image.  Set mode to 'New layers' to add the reversing effect to your current image."}
#@gimp : Amplitude = float(10,5,20)
#@gimp : Bokeh = float(7,0,20)
#@gimp : Sep = separator()
#@gimp : Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
gimp_gb_lb :
-spread 3
-heat_flow $1
-dilate_circ $2
-compose_lighten
gimp_gb_lb_preview :
-gimp_split_preview "-gimp_gb_lb ${1--2}",$-1
#@gimp Maxfield parrish : gimp_gb_mp, gimp_gb_mp_preview(0)
#@gimp : Lithograph = float(2,.5,3)
#@gimp : Warm = bool()
#@gimp : Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
gimp_gb_mp :
-equalize 255
-if {$2==1}
--gimp_corner_gradient 255,246,219,255,255,144,100,255,54,164,54,255,0,0,255,255
-else
--gimp_corner_gradient 255,250,237,255,255,200,178,255,2,104,2,255,0,0,143,255
-endif
-rv
-gimp_transfer_colors [-2,-1]1
-compose_value
-equalize 255
-gimp_glow {$1},0,0
gimp_gb_mp_preview :
-gimp_split_preview "-gimp_gb_mp ${1--2}",$-1
#@gimp Modern cinema : gimp_gb_mcfx, gimp_gb_mcfx_preview(0)
#@gimp : Genre = choice("Blockbuster","Feel the heat","Cyberpunk-o-rama","Procedural police drama")
#@gimp : Sep = seperator()
#@gimp : Auto-apply filter = bool(0)
#@gimp : Sep = seperator()
#@gimp : Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator()
#@gimp : Note = note{Usage Notes: When using "auto apply" the adjustment layer is automatically applied to the image using the "Hard light" mode.  For more control and tweaking, set Output mode to 'New Layer'.  After running filter, I suggest setting the newly created layer blend mode to 'hard light' for most images.}
gimp_gb_mcfx :
-if {$1==0}
--gimp_corner_gradient 255,255,255,255,0,93,131,255,248,121,2,255,0,0,0,255
-elif {$1==1}
--gimp_corner_gradient 219,247,251,255,255,145,115,255,238,222,151,255,0,0,0,255
-elif {$1==2}
--gimp_corner_gradient 238,251,228,255,0,117,7,255,28,73,63,255,0,0,0,255
-elif {$1==3}
--gimp_corner_gradient 228,251,250,255,0,78,117,255,28,28,73,255,0,0,0,255
-endif
-move[-1] 0
-if $2
--gimp_transfer_colors 0 -rm[0]
-compose_hardlight
-else
-gimp_transfer_colors 0
-endif
gimp_gb_mcfx_preview :
-gimp_split_preview "-gimp_gb_mcfx ${1--2}",$-1
#@gimp Ping pong : gimp_gb_pp, gimp_no_preview
#@gimp : Note = note{"\nUsage Notes:  Set Output mode to 'New image' or 'in place' to simply reverse the frames in this image.  Set mode to 'New layers' to add the reversing effect to your current image."}
gimp_gb_pp :
-rv
#@gimp Urban blight : gimp_gb_ub,gimp_gb_ub_preview(0)
#@gimp : Colour = float(-1,-1,.03)
#@gimp : Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
gimp_gb_ub :
-gimp_normalize_local 2,8,5,20,1,3,0
--gimp_gb_mp 3,0,0
-rv
-gimp_mix_hsv 1,0,0,1,{$1},.5,1,0,0,0,2,0
-compose_overlay
gimp_gb_ub_preview :
-gimp_split_preview "-gimp_gb_ub ${1--2}",$-1
#@gimp _
#@gimp <i>Gmic tutorials</i>
#@gimp Blur by color : gtutor_blur_img, gtutor_blur_img_preview
#@gimp : Range = choice(3,"XL","VL","L","N","M","VM","XM")
#@gimp : Amplitude = float(0.5,0,1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>Garry R. Osgood.</i> Latest update: <i>2014/08/30</i>.</small>")
#@gimp : Note = link("Blur by color instructions and tutorial.","http://gmic.eu/tutorial/blur-by-color-filter.shtml")
gtutor_blur_img :
-local[-2,-1]
-if {s>3}
-remove_opacity[-1]
-endif
range={700*$1+700}
-rgb2hsl[-1]
-split[-1] c
-mul[-1] $2
-reverse[-2,-1]
-negative[-1]
-mul[-1] [-2]
-reverse[-3,-1]
-div[-1] 360
-mul[-1] {2*pi}
--sin[-1]
-cos[-2]
-append[-4,-3] c
-append[-2,-1] c
-eigen2tensor[-2,-1]
-repeat 3
-smooth[-2] [-1],$range
-done
-rm[-1]
-endlocal
gtutor_blur_img_preview :
-gtutor_blur_img ${^0}
colorwheel : -check ${1=512}>=1 -skip ${2=0},${3=0}
-e[^-1] "Input colorwheel $1 pixels square; cclockwise=$2; oriented $3 degrees"
-v -
$1,$1,1,1,'x=x-w/2;y=y-h/2;((1-2*!!$2)*(atan2(y,x)*180/pi+90-$3))%360'
100%,100%,1,2,1 -a[-2,-1] c -hsv2rgb[-1] -nm[-1] [colorwheel]
-v +
#@gimp Hedcut (experimental) : hedcut, gtutor_hedcut_preview(0)
#@gimp : Note = note("<b>Photometric:</b>")
#@gimp : Contrast = float(0.5,0,1)
#@gimp : Luminance level = float(0.5,0,1)
#@gimp : Sep = separator()
#@gimp : Note = note("<b>Pattern:</b>")
#@gimp : Smoothing = float(0.5,0,1)
#@gimp : Size = float(0.0,0,1)
#@gimp : Step = float(0.5,0,1)
#@gimp : Note = note("<b>Choice:</b>")
#@gimp : Quality =  bool(0)
#@gimp : Force gray = bool(1)
#@gimp : Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), Note = note("<small>Author: <i>Garry R. Osgood</i>. Latest update: <i>2015/03/05</i>.</small>")
#@gimp : Link = link("Hedcut instructions and tutorial","http://gmic.eu/tutorial/hedcut-filter.shtml")
gtutor_hedcut_preview :
-gimp_split_preview "-hedcut ${^0}",$-1
hedcut : -check "${1=0.5}<=1 && $1>=0 && ${2=0.5}<=1 && $2>=0 && ${3=0.5}<=1 && $3>=0 && ${4=0.0}<=1 && $4>=0 && ${5=0.5}<=1 && $5>=0 && isbool(${6=0}) && isbool(${7=1})"
-echo[^-1] "Applying faux intaglio etch to selected images. Contrast: "{$1}". Lumenance Level: "$2". Pattern smoothing: "$3". Pattern size: "$4". Pattern stepping: "$5". Quality (low=0,1=high): "$6". Force gray (0=no,1=yes):"$7"."
-verbose -
con={(9.0^$1)}
llv={round(20000*(0.5-$2))/100}
smt={(round((100*(10^$3)/2))/100)+4*$4}
psz={0.0001*(1+99*(1-$4))}
del={$psz+round(1000*(10^(-$4-2)))/1000}
stp={round(2+10*$5)}
qfc={$6}
gry={$7}
tol=30
spn=0
-repeat @#
-local[$>]
-remove_opacity[-1]
-if {$gry}
-luminance[-1]
-endif
-split[-1] c
-repeat @#
-local[$>]
-if $qfc
--resize2dx[-1] 400%,5
-else
[-1]
-endif
spn={(iM-im)/2}
-mv[-1] 0
-_multigrad[-1] $stp,$tol,$smt
-bandpass[-1] {$psz},{$del}
-orientation[-1]
-if $qfc
-resize[-1] [-2],[-2],[-1],[-1],5,1
-blur[-1] {$con},1,1
-else
-blur[-1] {$con/4},1,1
-endif
-normalize[-2,-1] {-$spn},{$spn}
-add[-1] [-2]
-normalize[-1] -{(iM-im)/2},{(iM-im)/2}
-rm[-2]
-threshold[-1] {$llv}
-if $qfc
-resize2dx[-1] 25%,5
-endif
-normalize[-1] 0,255
-endlocal
-done
-append c
-if {$gry}
-to_rgb
-endif
-endlocal
-done
-verbose +
_multigrad : -skip ${1=50},${2=10},${3=5}
smt={$3}
stp={$1}
tol={$2}
-repeat @#
-local[$>]
-blur {$smt}
-normalize_local 3,32,4%,2%,1,0,255
-gradient_norm[-1]
ld={log(iM)}
-add[-1] 1e-10
-log[-1]
-div[-1] {$ld}
-cut[-1] 0,1
--ge[-1] $tol%
-if {round($smt)}
-erode_circ[-1] {round(1.5*$smt)}
-dilate_circ[-1] {round(1.5*$smt)}
-endif
-negative[-2]
-normalize[-2] 0,1
--distance[-1] 1,[-2],0
-rm[-3]
-round[-1] 2
-mod[-1] {1+$stp}
-threshold 90%
-add[-2,-1]
-mul[-1] -1
-add[-1] 1
-endlocal
-done
tiletex : -check "${1=8}>0 && isval(${2=-1.0}) && ${3=0}>=0 && ${3}<3"
-verbose -
-if {$2>=0}
addenda2="Common default angle: $2."
-else
addenda2="Explicit angles from provided images."
-endif
addenda3="Real and imaginary"
-if {$3!=0}
-if {$3==1}
addenda3="Real"
-else
addenda3="Imaginary"
-endif
-endif
-verbose +
-echo[^-1] "Rendering tilable texture on $? at window size $1 "$addenda2". "$addenda3" output to be provided."
-verbose -
rsz={$1}
impla={2*pi*$2/255.0}
all={$3}
iszed=1
ccc={@{0,s}}
badccc="Selected images have different number of channels. Have you accidently included alpha channels in some (but not all) images?"
-repeat @#
-if {round(@{$>,a})!=0||round(@{$>,M}-@{$>,m})!=0}
iszed=0
-break
-endif
-done
-if $iszed
-repeat @#
-local[$<]
-if {$ccc!=@{$<,s}}
-error $badccc
-endif
-input [-1]
-append[-2,-1] c
-input {2*$rsz+1},{2*$rsz+1},1,{@{-1,s}},(2*u-1)*(@{-1,w}*@{-1,h})
-image[-2] [-1],{(@{-2,w}-@{-1,w})/2},{(@{-2,h}-@{-1,h})/2},0,0,1
-remove[-1]
-endlocal
-done
-else
-if {$impla<0}
-if {@#%2!=0}
-error "Selected images contain data, but selection count is odd. Cannot determine angles for some coefficients. Consider setting an implied angle or providing an even number of images."
-endif
-repeat {@#/2}
-local[{2*$<},{2*$<+1}]
-if {{$ccc!=@{$<,s}}||{$ccc!=@{{$<+1},s}}}
-error $badccc
-endif
-split[-2,-1] c
-repeat {@#/2}
-local[{$>},{@#/2+$>}]
-div[0,1] 255
-mul[1] {2*pi}
-polar2complex[0,1]
-endlocal
-done
-append[0--1] c
-endlocal
-done
-else
-repeat @#
-local[$<]
-if {$ccc!=@{$<,s}}
-error $badccc
-endif
-input [0]
-split[-2,-1] c
-repeat {@#/2}
-local[{$>},{@#/2+$>}]
-div[0,1] 255
-mul[0] {cos($impla)}
-mul[1] {sin($impla)}
-endlocal
-done
-append[0--1] c
-endlocal
-done
-endif
-endif
-repeat @#
-local[$<]
-shift[-1] -50%,-50%,0,0,2
-split[-1] c,2
-ifft[-2,-1]
-if {$all!=0}
-if {$all==1}
-remove[-1]
-else
-remove[-2]
-endif
-endif
-endlocal
-done
-verbose +
#@gimp _
#@gimp <i>Iain fergusson</i>
#@gimp Automixer : automixer,automixer(0)
#@gimp : Output colour difference = bool (0)
#@gimp : Use partial image for noise calulation = bool (0)
#@gimp : Sep = separator ()
#@gimp : Note = note{"This filter creates a black and white mage with the most pleasant noise characteristics (IMHO). It measures the noise in each colour channel and scales each channel so that the noise levels are even and produces a greyscale output and optionally an extra image with the colour information."}
#@gimp : Note = note("Author : <i>Iain Fergusson</i>.      Latest update : 2012/10/26")
automixer:
-to_rgb
--split[-1] c
-if {$2==1}
-crop[-1,-2,-3] 40%,40%,60%,60%
-endif
bluenoise=@{-variance_noise}
-remove[-1]
greennoise=@{-variance_noise}
-remove[-1]
rednoise=@{-variance_noise}
-remove[-1]
greennoise={$greennoise*0.5}
redadjust={$greennoise/$rednoise}
blueadjust={$greennoise/$bluenoise}
-to_rgb
--split[0] c
-mul[1] {$redadjust/($redadjust+1+$blueadjust)}
-mul[2] {1/($redadjust+1+$blueadjust)}
-mul[3] {$blueadjust/($redadjust+1+$blueadjust)}
-add[1-3]
-if {$1==0}
-keep[-1]
-else
--compose_grainextract
-remove[0]
-endif
#@gimp Brown spot clean : iain_brown_spot_clean,iain_brown_spot_clean(0)
#@gimp : Red/green radius = int (1,1,7)
#@gimp : Blue radius = int (2,1,7)
iain_brown_spot_clean:
red_radius={($1*2)+1}
green_radius={($1*2)+1}
blue_radius={($2*2)+1}
-to_rgb
--l
-split c
-l[0]
-median $red_radius
-median $red_radius
-median $red_radius
-endl
-l[1]
-median $green_radius
-median $green_radius
-median $green_radius
-endl
-l[2]
-median $blue_radius
-median $blue_radius
-median $blue_radius
-endl
-append c
-endl
-sub[0] [1]
-add[0] 128
--l[0]
-rgb2hsv8
-split c
-keep[0]
-apply_curve 0,0,0,11,0,13,255,65,255,67,0,255,0
-lt 1
-endl
-sub[0] 128
-mul[0,2]
-add
-c 0,255
nozip:
-remove_opacity
--l[0]
(1;-1)
-convolve[0] [1]
-rm[1]
-abs
-split c
-max
-endl
--l[1]
(1,-1)
-convolve[0] [1]
-rm[1]
-abs
-split c
-max
-endl
--l[0]
--l
-split c
-add
-div 3
-endl
-sub
-abs
-split c
-max
-endl
--l[1]
--l
-split c
-add
-div 3
-endl
-sub
-abs
-split c
-max
-endl
-mul[-1,-2] $1
-add[2,4]
-add[3,4]
-l[-1,-2]
-blur 2
-sub
-gt 0
-mul 255
-endl
-append[1,2] c
-blend alpha,1,0
#@gimp Ca correction : iain_CA_correction, iain_CA_correction_pr(0)
#@gimp : Blue adjustment = float(0,-5,5)
#@gimp : Red adjustment = float(0,-5,5)
#@gimp : Interpolation quality = choice (2,"Low","Med","high")
#@gimp : Sep = separator()
#@gimp : Preview shows = choice ("Output","colours only")
#@gimp : Preview corner = choice (3,"North-West","North-East","South-East","South-West")
#@gimp : Note = note("The preview is only accurate for the corners. Make sure you navigate to the same corner as selected above. ")
iain_CA_correction:
-to_rgb
longest_side={max(w,h)}
-split c
-l[0]
$longest_side,$longest_side
50%,1
-fill[-1] 1-(x/w)
--mirror[-1] x
-mul[-2] -1
-append[-1,-2] x
-resize[-1] @{1,w},@{1,h},1,1,1
[-1]
-rotate[-1] 90
-append[-1,-2] c
-rm[1]
-resize[1] @{0,w},@{0,h},{d},{s},0,0,0.5,0.5
-mul[-1] $2
-warp[0] [1],1,$3,1
-keep[0]
-endl
-l[2]
$longest_side,$longest_side
50%,1
-fill[-1] 1-(x/w)
--mirror[-1] x
-mul[-2] -1
-append[-1,-2] x
-resize[-1] @{1,w},@{1,h},1,1,1
[-1]
-rotate[-1] 90
-append[-1,-2] c
-rm[1]
-resize[1] @{0,w},@{0,h},{d},{s},0,0,0.5,0.5
-mul[-1] $1
-warp[0] [1],1,$3,1
-keep[0]
-endl
-append c
-c 0,255
iain_CA_correction_pr:
-to_rgb
x_mul={w/max(w,h)}
y_mul={h/max(w,h)}
-if {$-1==0}
rx_shift={$2*-1*$x_mul}
ry_shift={$2*-1*$y_mul}
bx_shift={$1*-1*$x_mul}
by_shift={$1*-1*$y_mul}
-elif {$-1==1}
rx_shift={$2*$x_mul}
ry_shift={$2*-1*$y_mul}
bx_shift={$1*$x_mul}
by_shift={$1*-1*$y_mul}
-elif {$-1==2}
rx_shift={$2*$x_mul}
ry_shift={$2*$y_mul}
bx_shift={$1*$x_mul}
by_shift={$1*$y_mul}
-elif  {$-1==3}
rx_shift={$2*-1*$x_mul}
ry_shift={$2*$y_mul}
bx_shift={$1*-1*$x_mul}
by_shift={$1*$y_mul}
-endif
-split c
-l[0]
[0]
[0]
-fill[1] $rx_shift
-fill[2] $ry_shift
-append[1,2] c
-warp[0] [1],1,$3,1
-keep[0]
-endl
-l[2]
[0]
[0]
-fill[1] $bx_shift
-fill[2] $by_shift
-append[1,2] c
-warp[0] [1],1,$3,1
-keep[0]
-endl
-append c
-if {$-2}
-rgb2hsv
-split c
-fill[-1] .5
-append c
-hsv2rgb
-sub 128
-mul 2
-add 128
-c 0,255
-endif
#@gimp Easy skin retouch : iain_easy_skin_retouch,iain_easy_skin_retouch_preview(0)
#@gimp : Note = note("<b>Base Smoothing</b>")
#@gimp : Edge sensitivity = float (7,0,25)
#@gimp : Iterations = int (2,1,5)
#@gimp : Low bias = float(.7,0,1)
#@gimp : Sep = separator ()
#@gimp : Note = note("<b>Detail Intensity</b>")
#@gimp : Note = note("If preview appears dark, increase size of preview window.")
#@gimp : On = bool(1)
#@gimp : Very fine = float (1,0,2)
#@gimp : Fine 2 = float (.7,0,2)
#@gimp : Medium 3 = float (.6,0,2)
#@gimp : Course 4 = float (.5,0,2)
#@gimp : Very course 5 = float (.5,0,2)
#@gimp : Reduce redness = float (.5,0,1)
#@gimp : Sep = separator ()
#@gimp : Split base and detail output = bool(0)
#@gimp : Sep = separator ()
#@gimp : Note = note("Author: Iain Fergusson - update 12 May 2013 - now handles alpha channel and some internal changes")
iain_easy_skin_retouch:
-repeat @# -l[$>] -split_opacity -l[0]
str1=$1
str2={$str1*$3}
str3={$str2*$3}
str4={$str3*$3}
str5={$str4*$3}
str6={$str5*$3}
str7={$str6*$3}
str8={$str7*$3}
--l[0]
-repeat $2
cropwidth={w}
cropheight={h}
-resize[0] {w+(256-w%256)},{h+(256-h%256)},1,{s},0,1
width={w}
height={h}
-if {$str1!=0}
-denoise[0] 10,$str1,3,5,0,1
-endif
--resize[0] {$width/2},{$height/2},1,{s},2,1
--resize[-1] $width,$height,1,{s},3,1
-blur[-1] .5
-compose_grainextract[0,-1]
-if {$str2!=0}
-denoise[-1] 10,$str2,3,5,0,1
-endif
--resize[-1] {$width/4},{$height/4},1,{s},2,1
--resize[-1] {$width/2},{$height/2},1,{s},3,1
-blur[-1] .5
-compose_grainextract[1,-1]
-if {$str3!=0}
-denoise[-1] 10,$str3,3,5,0,1
-endif
--resize[-1] {$width/8},{$height/8},1,{s},2,1
--resize[-1] {$width/4},{$height/4},1,{s},3,1
-blur[-1] .5
-compose_grainextract[2,-1]
-if {$str4!=0}
-denoise[-1] 10,$str4,3,5,0,1
-endif
--resize[-1] {$width/16},{$height/16},1,{s},2,1
--resize[-1] {$width/8},{$height/8},1,{s},3,1
-blur[-1] .5
-compose_grainextract[3,-1]
-if {$str5!=0}
-denoise[-1] 10,$str5,3,5,0,1
-endif
--resize[-1] {$width/32},{$height/32},1,{s},2,1
--resize[-1] {$width/16},{$height/16},1,{s},3,1
-blur[-1] .5
-compose_grainextract[4,-1]
-if {$str6!=0}
-denoise[-1] 10,$str6,3,5,0,1
-endif
--resize[-1] {$width/64},{$height/64},1,{s},2,1
--resize[-1] {$width/32},{$height/32},1,{s},3,1
-blur[-1] .5
-compose_grainextract[5,-1]
-if {$str7!=0}
-denoise[-1] 10,$str7,3,5,0,1
-endif
--resize[-1] {$width/128},{$height/128},1,{s},2,1
--resize[-1] {$width/64},{$height/64},1,{s},3,1
-blur[-1] .5
-compose_grainextract[6,-1]
-if {$str8!=0}
-denoise[-1] 10,$str8,3,5,0,1
-endif
--resize[-1] {$width/256},{$height/256},1,{s},2,1
--resize[-1] {$width/128},{$height/128},1,{s},3,1
-blur[-1] .5
-compose_grainextract[7,-1]
-resize[-1] {$width/128},{$height/128},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-resize[-1] {$width/64},{$height/64},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-resize[-1] {$width/32},{$height/32},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-resize[-1] {$width/16},{$height/16},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-resize[-1] {$width/8},{$height/8},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-resize[-1] {$width/4},{$height/4},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-resize[-1] {$width/2},{$height/2},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-resize[-1] {$width/1},{$height/1},1,{s},3,1
-blur[-1] .5
-compose_grainmerge[-1,-2]
-crop 0,0,{$cropwidth-1},{$cropheight-1}
-done
-endl
-if {$4==1}
--compose_grainextract[0,-1]
--rgb2hsv8[-1]
-split[-1] c
-remove[-1,-2]
-add[-1] 30
-mod[-1] 255
-ge[-1]  40
-n[-1] 0,255
-negative[-1]
-blur[-1] 4
--split[-2] c
-remove[-1,-2]
-move[-1] -2
-append[-2,-1] c
--compose_alpha[-1,-2]
-remove[-2]
-mul[-1] {$10}
-mul[-2] {1-$10}
-add[-1] [-2]
-remove[-2]
-l[-1]
--fftpolar[0]
100%,100%,1,1,1
-ellipse[-1] 50%,50%,50%,50%,0,1,$5
-ellipse[-1] 50%,50%,25%,25%,0,1,$6
-ellipse[-1] 50%,50%,12%,12%,0,1,$7
-ellipse[-1] 50%,50%,6%,6%,0,1,$8
-ellipse[-1] 50%,50%,3%,3%,0,1,$9
-ellipse[-1] 50%,50%,0.1%,0.1%,0,1,1
-set[-1] 1,50%,50%
-mul[1] [-1]
-ifftpolar[1,2]
-keep[1]
-c 0,255
-endl
-remove[0]
-if {$11==0}
-compose_grainmerge[-1,-2]
-endif
-else
-keep[-1]
-endif
-endl -a c -endl -done
iain_easy_skin_retouch_preview:
-iain_easy_skin_retouch ${1--1}
#@gimp Exfuse : exfuse, exfuse
#@gimp : Exposure = float (1,0,2)
#@gimp : Contrast bias = float(0.6,0,1)
#@gimp : Saturation bias = float(0,0,1)
#@gimp : Exposure sigma = float(0.5,0,1)
#@gimp : Exposure bias = float(1,0,1)
#@gimp : Blur = float(5,0,50)
exfuse:
cropwidth={w}
cropheight={h}
--mul[0] {2*$1}
--mul[0] {4*$1}
-c 0,255
--gimp_ExposureWeightMap[0] $2,$3,$4,$5,0
--gimp_ExposureWeightMap[1] $2,$3,$4,$5,0
--gimp_ExposureWeightMap[2] $2,$3,$4,$5,0
-parallel "
-freq_pyramid[0]","
-freq_pyramid[1]","
-freq_pyramid[2]","
-dumb_pyramid[3]","
-dumb_pyramid[4]","
-dumb_pyramid[5]"
-parallel "-blur[-1] $6","-blur[-2] $6","-blur[-3] $6"
-replace[-1,-2,-3] 0,0.000000001
--add[-1,-2,-3]
-div[-2] [-1]
-div[-3] [-1]
-div[-4] [-1]
-rm[-1]
-parallel "
-mul[0] [3]","
-mul[1] [4]","
-mul[2] [5]"
-add[0,1,2]
-keep[0]
-ifreq_pyramid[0]
-crop 0,0,{$cropwidth-1},{$cropheight-1}
-c 0,255
dumb_pyramid:
cropwidth={w}
cropheight={h}
-resize {w+(1024-w%1024)},{h+(1024-h%1024)},1,3,0,1
newwidth={w}
--resize[-1] 50%,50%,{d},{s},2
--resize[-1] 50%,50%,{d},{s},2
--resize[-1] 50%,50%,{d},{s},2
--resize[-1] 50%,50%,{d},{s},2
--resize[-1] 50%,50%,{d},{s},2
-append x
-resize {$newwidth*2},100%,1,3,0,0
ifreq_pyramid:
-split x,2
-split[1] x,2
-split[2] x,2
-split[3] x,2
-split[4] x,2
-crop[1] 0,0,100%,{@{0,h/2}-1}
-crop[2] 0,0,100%,{@{0,h/4}-1}
-crop[3] 0,0,100%,{@{0,h/8}-1}
-crop[4] 0,0,100%,{@{0,h/16}-1}
-crop[5] 0,0,@{4,(w/2)-1},{@{0,h/32}-1}
-resize[-1] @{-2,w},@{-2,h},{d},{s},3
-add[-1,-2]
-resize[-1] @{-2,w},@{-2,h},{d},{s},3
-add[-1,-2]
-resize[-1] @{-2,w},@{-2,h},{d},{s},3
-add[-1,-2]
-resize[-1] @{-2,w},@{-2,h},{d},{s},3
-add[-1,-2]
-resize[-1] @{-2,w},@{-2,h},{d},{s},3
-add[-1,-2]
freq_pyramid:
cropwidth={w}
cropheight={h}
-resize {w+(1024-w%1024)},{h+(1024-h%1024)},1,3,0,1
newwidth={w}
--resize[-1] 50%,50%,{d},{s},2
--resize[-1] @{-2,w},@{-2,h},{d},{s},3
-sub[-3,-1]
--resize[-1] 50%,50%,{d},{s},2
--resize[-1] @{-2,w},@{-2,h},{d},{s},3
-sub[-3,-1]
--resize[-1] 50%,50%,{d},{s},2
--resize[-1] @{-2,w},@{-2,h},{d},{s},3
-sub[-3,-1]
--resize[-1] 50%,50%,{d},{s},2
--resize[-1] @{-2,w},@{-2,h},{d},{s},3
-sub[-3,-1]
--resize[-1] 50%,50%,{d},{s},2
--resize[-1] @{-2,w},@{-2,h},{d},{s},3
-sub[-3,-1]
-append x
-resize {$newwidth*2},100%,1,3,0,0
#@gimp Exfusion : exfusion, exfusion
#@gimp : Width = float (20,0,50)
exfusion:
cropwidth={w}
cropheight={h}
-resize {w+(1024-w%1024)},{h+(1024-h%1024)},1,3,0,1
-repeat 10
-l[-1--4]
--l[0,1,2,3]
--resize[0] 50%,50%,1,3,2
--resize[-1] 200%,200%,1,3,3
-sub[0,-1]
--resize[1] 50%,50%,1,3,2
--resize[-1] 200%,200%,1,3,3
-sub[1,-1]
--resize[2] 50%,50%,1,3,2
--resize[-1] 200%,200%,1,3,3
-sub[2,-1]
--resize[3] 50%,50%,1,3,2
--resize[-1] 200%,200%,1,3,3
-sub[3,-1]
-endl
--iain_weightmap[0] 1,$1
--iain_weightmap[1] 1,$1
--iain_weightmap[2] 1,$1
--iain_weightmap[3] 1,$1
--add[-1,-2,-3,-4]
-replace[-1,-2,-3,-4,-5] 0,0.0000000000001
-div[-2] [-1]
-div[-3] [-1]
-div[-4] [-1]
-div[-5] [-1]
-rm[-1]
-mul[4,12]
-mul[5,12]
-mul[6,12]
-mul[7,12]
-add[4,5,6,7]
-rm[0,1,2,3]
-endl
-done
-l[-1,-2,-3,-4]
-parallel "
--iain_weightmap[0] 4,$1","
--iain_weightmap[1] 4,$1","
--iain_weightmap[2] 4,$1","
--iain_weightmap[3] 4,$1"
--add[-1,-2,-3,-4]
-replace[-1,-2,-3,-4,-5] 0,0.00000000000001
-div[-2] [-1]
-div[-3] [-1]
-div[-4] [-1]
-div[-5] [-1]
-rm[-1]
-mul[0,4]
-mul[1,4]
-mul[2,4]
-mul[3,4]
-add
-endl
-repeat {@#-1}
-resize[-1] @{-2,w},@{-2,h},1,3,3
-add[-1,-2]
-done
-crop 0,0,{$cropwidth-1},{$cropheight-1}
--l[0]
-resize 5%,5%,1,3,2
-endl
min=@{1,im}
max=@{1,iM}
-c[0] $min,$max
-keep[0]
-n 0,255
#@gimp Exfusion3 : exfusion3, exfusion3
#@gimp : Contrast bias = float(0.3,0,1)
#@gimp : Saturation bias = float(0.3,0,1)
#@gimp : Exposure sigma = float(0.2,0,1)
#@gimp : Exposure bias = float(0.3,0,1)
#@gimp : Sep = separator()
#@gimp : Maxlevels adjust = int(-1,-5,0)
#@gimp : Base level median stack = bool(0)
#@gimp : Sep = separator()
#@gimp : Note = note("Pyramid levels are calculated automatically, but you can reduce the number of pyramid levels to save memory. You can choose how the base level is fused, by using weight maps like normal, or by using a median of the image stack")
exfusion3:
cropwidth={w}
cropheight={h}
maxlevels={round(log2(min(w,h))+0.5)+$5}
size={2^$maxlevels}
-resize {w+($size-w%$size)},{h+($size-h%$size)},1,3,0,1
-repeat $maxlevels
-l[-1--3]
--l[0,1,2]
--resize[0] 50%,50%,1,3,2
--resize[-1] 200%,200%,1,3,5
-sub[0,-1]
--resize[1] 50%,50%,1,3,2
--resize[-1] 200%,200%,1,3,5
-sub[1,-1]
--resize[2] 50%,50%,1,3,2
--resize[-1] 200%,200%,1,3,5
-sub[2,-1]
-endl
[0]
-gimp_ExposureWeightMap[-1] $1,$2,$3,$4,0
[1]
-gimp_ExposureWeightMap[-1] $1,$2,$3,$4,0
[2]
-gimp_ExposureWeightMap[-1] $1,$2,$3,$4,0
-rm[0,1,2]
--add[-1,-2,-3]
-replace[-1,-2,-3,-4] 0,0.0000000000001
-div[-2] [-1]
-div[-3] [-1]
-div[-4] [-1]
-rm[-1]
-mul[0,6]
-mul[1,6]
-mul[2,6]
-add[0,1,2]
-endl
-done
-l[-1,-2,-3]
-if $6
-iain_fast_median_stack
-else
[0]
[1]
[2]
-parallel "
-gimp_ExposureWeightMap[-1] $1,$2,$3,$4,0","
-gimp_ExposureWeightMap[-2] $1,$2,$3,$4,0","
-gimp_ExposureWeightMap[-3] $1,$2,$3,$4,0"
--add[-1,-2,-3]
-replace[-1,-2,-3,-4] 0,0.0000000000001
-div[-2] [-1]
-div[-3] [-1]
-div[-4] [-1]
-rm[-1]
-mul[0,3]
-mul[1,3]
-mul[2,3]
-add
-endif
-endl
-repeat {@#-1}
-resize[-1] @{-2,w},@{-2,h},1,3,5
-add[-1,-2]
-done
-crop 0,0,{$cropwidth-1},{$cropheight-1}
--l[0]
-resize 5%,5%,1,3,2
-endl
min=@{1,im}
max=@{1,iM}
-c[0] $min,$max
-keep[0]
-n 0,255
#@gimp Exfusion5 : exfusion5, exfusion5
#@gimp : Contrast bias = float(0,0,1)
#@gimp : Saturation bias = float(.2,0,1)
#@gimp : Exposure sigma = float(0.2,0,1)
#@gimp : Exposure bias = float(1,0,1)
#@gimp : Sep = separator()
#@gimp : Note = note("Post Fusion Options")
#@gimp : Local contrast = float (0,0,3)
#@gimp : Curve = float (0,-127,127)
exfusion5:
images=@#
cropwidth={w}
cropheight={h}
maxlevels={round(log2(min(w,h))+0.5)+0}
size={2^$maxlevels}
-remove_opacity
-resize {w+($size-w%$size)},{h+($size-h%$size)},1,3,0,1,0.5,0.5
--l[0-{$images-1}]
-repeat @# -local[@{>,-1}]
-gimp_ExposureWeightMap[0] $1,$2,$3,$4,0
-endlocal -done
-endl
-l[-1--$images]
--add
-replace 0,0.0000000000001
-repeat {@#-1}
-div[@{<,-1}] [-1]
-done
-rm[-1]
-endl
-repeat $maxlevels
-l[-1--{$images*2}]
--l[0-{$images-1}]
-repeat @# -local[@{>,-1}]
--resize[0] 50%,50%,1,3,2
-resize[-1] 200%,200%,1,3,5,0
-sub[0,-1]
-endlocal -done
-endl
-l[-1--{$images*2}]
-repeat $images -local[@{>,-1},{@{>,-1}+$images}]
-mul[-1] [-2]
-endlocal -done
-endl
-l[-1--$images]
-add
-endl
-move[-1] 0
-l[-1--{$images*2}]
-repeat @# -local[@{>,-1}]
-resize[0] 50%,50%,1,3,2
-endlocal -done
-endl
-endl
-done
-l[-1--{$images*2}]
-if 1
-repeat $images -local[@{>,-1},{@{>,-1}+$images}]
-mul[-1] [-2]
-endlocal -done
-keep[-1--$images]
-add
-else
-keep[0--{$images-1}]
-add
-div $images
-endif
-endl
-repeat {@#-1}
-resize[-1] @{-2,w},@{-2,h},1,3,5,0
-add[-1,-2]
-done
-resize $cropwidth,$cropheight,1,3,0,1,0.5,0.5
-n 0,255
-mul 1000
-apply_curve 1,0,0,128000,{($6*1000)+128000},255000,255000
-mul 0.001
--iain_fast_denoise $5,$5,1,{$5/100},0
-sub[1] [0]
-mul[1] -1
--add
-c 0,255
-rm[1]
-reverse
-rgb2lch
-split c
-keep[0,4,5]
-append c
-lch2rgb
#@gimp Fast formula : iain_fast_formula, iain_fast_formula
#@gimp : Apply formula = text("-apply_gamma 2.2")
iain_fast_formula:
256,1
-fill[-1] x
-local[1]
$1
-endlocal
crv0=@{1,0}
crv1=@{1,1}
crv2=@{1,2}
crv3=@{1,3}
crv4=@{1,4}
crv5=@{1,5}
crv6=@{1,6}
crv7=@{1,7}
crv8=@{1,8}
crv9=@{1,9}
crv10=@{1,10}
crv11=@{1,11}
crv12=@{1,12}
crv13=@{1,13}
crv14=@{1,14}
crv15=@{1,15}
crv16=@{1,16}
crv17=@{1,17}
crv18=@{1,18}
crv19=@{1,19}
crv20=@{1,20}
crv21=@{1,21}
crv22=@{1,22}
crv23=@{1,23}
crv24=@{1,24}
crv25=@{1,25}
crv26=@{1,26}
crv27=@{1,27}
crv28=@{1,28}
crv29=@{1,29}
crv30=@{1,30}
crv31=@{1,31}
crv32=@{1,32}
crv33=@{1,33}
crv34=@{1,34}
crv35=@{1,35}
crv36=@{1,36}
crv37=@{1,37}
crv38=@{1,38}
crv39=@{1,39}
crv40=@{1,40}
crv41=@{1,41}
crv42=@{1,42}
crv43=@{1,43}
crv44=@{1,44}
crv45=@{1,45}
crv46=@{1,46}
crv47=@{1,47}
crv48=@{1,48}
crv49=@{1,49}
crv50=@{1,50}
crv51=@{1,51}
crv52=@{1,52}
crv53=@{1,53}
crv54=@{1,54}
crv55=@{1,55}
crv56=@{1,56}
crv57=@{1,57}
crv58=@{1,58}
crv59=@{1,59}
crv60=@{1,60}
crv61=@{1,61}
crv62=@{1,62}
crv63=@{1,63}
crv64=@{1,64}
crv65=@{1,65}
crv66=@{1,66}
crv67=@{1,67}
crv68=@{1,68}
crv69=@{1,69}
crv70=@{1,70}
crv71=@{1,71}
crv72=@{1,72}
crv73=@{1,73}
crv74=@{1,74}
crv75=@{1,75}
crv76=@{1,76}
crv77=@{1,77}
crv78=@{1,78}
crv79=@{1,79}
crv80=@{1,80}
crv81=@{1,81}
crv82=@{1,82}
crv83=@{1,83}
crv84=@{1,84}
crv85=@{1,85}
crv86=@{1,86}
crv87=@{1,87}
crv88=@{1,88}
crv89=@{1,89}
crv90=@{1,90}
crv91=@{1,91}
crv92=@{1,92}
crv93=@{1,93}
crv94=@{1,94}
crv95=@{1,95}
crv96=@{1,96}
crv97=@{1,97}
crv98=@{1,98}
crv99=@{1,99}
crv100=@{1,100}
crv101=@{1,101}
crv102=@{1,102}
crv103=@{1,103}
crv104=@{1,104}
crv105=@{1,105}
crv106=@{1,106}
crv107=@{1,107}
crv108=@{1,108}
crv109=@{1,109}
crv110=@{1,110}
crv111=@{1,111}
crv112=@{1,112}
crv113=@{1,113}
crv114=@{1,114}
crv115=@{1,115}
crv116=@{1,116}
crv117=@{1,117}
crv118=@{1,118}
crv119=@{1,119}
crv120=@{1,120}
crv121=@{1,121}
crv122=@{1,122}
crv123=@{1,123}
crv124=@{1,124}
crv125=@{1,125}
crv126=@{1,126}
crv127=@{1,127}
crv128=@{1,128}
crv129=@{1,129}
crv130=@{1,130}
crv131=@{1,131}
crv132=@{1,132}
crv133=@{1,133}
crv134=@{1,134}
crv135=@{1,135}
crv136=@{1,136}
crv137=@{1,137}
crv138=@{1,138}
crv139=@{1,139}
crv140=@{1,140}
crv141=@{1,141}
crv142=@{1,142}
crv143=@{1,143}
crv144=@{1,144}
crv145=@{1,145}
crv146=@{1,146}
crv147=@{1,147}
crv148=@{1,148}
crv149=@{1,149}
crv150=@{1,150}
crv151=@{1,151}
crv152=@{1,152}
crv153=@{1,153}
crv154=@{1,154}
crv155=@{1,155}
crv156=@{1,156}
crv157=@{1,157}
crv158=@{1,158}
crv159=@{1,159}
crv160=@{1,160}
crv161=@{1,161}
crv162=@{1,162}
crv163=@{1,163}
crv164=@{1,164}
crv165=@{1,165}
crv166=@{1,166}
crv167=@{1,167}
crv168=@{1,168}
crv169=@{1,169}
crv170=@{1,170}
crv171=@{1,171}
crv172=@{1,172}
crv173=@{1,173}
crv174=@{1,174}
crv175=@{1,175}
crv176=@{1,176}
crv177=@{1,177}
crv178=@{1,178}
crv179=@{1,179}
crv180=@{1,180}
crv181=@{1,181}
crv182=@{1,182}
crv183=@{1,183}
crv184=@{1,184}
crv185=@{1,185}
crv186=@{1,186}
crv187=@{1,187}
crv188=@{1,188}
crv189=@{1,189}
crv190=@{1,190}
crv191=@{1,191}
crv192=@{1,192}
crv193=@{1,193}
crv194=@{1,194}
crv195=@{1,195}
crv196=@{1,196}
crv197=@{1,197}
crv198=@{1,198}
crv199=@{1,199}
crv200=@{1,200}
crv201=@{1,201}
crv202=@{1,202}
crv203=@{1,203}
crv204=@{1,204}
crv205=@{1,205}
crv206=@{1,206}
crv207=@{1,207}
crv208=@{1,208}
crv209=@{1,209}
crv210=@{1,210}
crv211=@{1,211}
crv212=@{1,212}
crv213=@{1,213}
crv214=@{1,214}
crv215=@{1,215}
crv216=@{1,216}
crv217=@{1,217}
crv218=@{1,218}
crv219=@{1,219}
crv220=@{1,220}
crv221=@{1,221}
crv222=@{1,222}
crv223=@{1,223}
crv224=@{1,224}
crv225=@{1,225}
crv226=@{1,226}
crv227=@{1,227}
crv228=@{1,228}
crv229=@{1,229}
crv230=@{1,230}
crv231=@{1,231}
crv232=@{1,232}
crv233=@{1,233}
crv234=@{1,234}
crv235=@{1,235}
crv236=@{1,236}
crv237=@{1,237}
crv238=@{1,238}
crv239=@{1,239}
crv240=@{1,240}
crv241=@{1,241}
crv242=@{1,242}
crv243=@{1,243}
crv244=@{1,244}
crv245=@{1,245}
crv246=@{1,246}
crv247=@{1,247}
crv248=@{1,248}
crv249=@{1,249}
crv250=@{1,250}
crv251=@{1,251}
crv252=@{1,252}
crv253=@{1,253}
crv254=@{1,254}
crv255=@{1,255}
-apply_curve[0] 0,0,$crv0,1,$crv1,2,$crv2,3,$crv3,4,$crv4,5,$crv5,6,$crv6,7,$crv7,8,$crv8,9,$crv9,10,$crv10,11,$crv11,12,$crv12,13,$crv13,14,$crv14,15,$crv15,16,$crv16,17,$crv17,18,$crv18,19,$crv19,20,$crv20,21,$crv21,22,$crv22,23,$crv23,24,$crv24,25,$crv25,26,$crv26,27,$crv27,28,$crv28,29,$crv29,30,$crv30,31,$crv31,32,$crv32,33,$crv33,34,$crv34,35,$crv35,36,$crv36,37,$crv37,38,$crv38,39,$crv39,40,$crv40,41,$crv41,42,$crv42,43,$crv43,44,$crv44,45,$crv45,46,$crv46,47,$crv47,48,$crv48,49,$crv49,50,$crv50,51,$crv51,52,$crv52,53,$crv53,54,$crv54,55,$crv55,56,$crv56,57,$crv57,58,$crv58,59,$crv59,60,$crv60,61,$crv61,62,$crv62,63,$crv63,64,$crv64,65,$crv65,66,$crv66,67,$crv67,68,$crv68,69,$crv69,70,$crv70,71,$crv71,72,$crv72,73,$crv73,74,$crv74,75,$crv75,76,$crv76,77,$crv77,78,$crv78,79,$crv79,80,$crv80,81,$crv81,82,$crv82,83,$crv83,84,$crv84,85,$crv85,86,$crv86,87,$crv87,88,$crv88,89,$crv89,90,$crv90,91,$crv91,92,$crv92,93,$crv93,94,$crv94,95,$crv95,96,$crv96,97,$crv97,98,$crv98,99,$crv99,100,$crv100,101,$crv101,102,$crv102,103,$crv103,104,$crv104,105,$crv105,106,$crv106,107,$crv107,108,$crv108,109,$crv109,110,$crv110,111,$crv111,112,$crv112,113,$crv113,114,$crv114,115,$crv115,116,$crv116,117,$crv117,118,$crv118,119,$crv119,120,$crv120,121,$crv121,122,$crv122,123,$crv123,124,$crv124,125,$crv125,126,$crv126,127,$crv127,128,$crv128,129,$crv129,130,$crv130,131,$crv131,132,$crv132,133,$crv133,134,$crv134,135,$crv135,136,$crv136,137,$crv137,138,$crv138,139,$crv139,140,$crv140,141,$crv141,142,$crv142,143,$crv143,144,$crv144,145,$crv145,146,$crv146,147,$crv147,148,$crv148,149,$crv149,150,$crv150,151,$crv151,152,$crv152,153,$crv153,154,$crv154,155,$crv155,156,$crv156,157,$crv157,158,$crv158,159,$crv159,160,$crv160,161,$crv161,162,$crv162,163,$crv163,164,$crv164,165,$crv165,166,$crv166,167,$crv167,168,$crv168,169,$crv169,170,$crv170,171,$crv171,172,$crv172,173,$crv173,174,$crv174,175,$crv175,176,$crv176,177,$crv177,178,$crv178,179,$crv179,180,$crv180,181,$crv181,182,$crv182,183,$crv183,184,$crv184,185,$crv185,186,$crv186,187,$crv187,188,$crv188,189,$crv189,190,$crv190,191,$crv191,192,$crv192,193,$crv193,194,$crv194,195,$crv195,196,$crv196,197,$crv197,198,$crv198,199,$crv199,200,$crv200,201,$crv201,202,$crv202,203,$crv203,204,$crv204,205,$crv205,206,$crv206,207,$crv207,208,$crv208,209,$crv209,210,$crv210,211,$crv211,212,$crv212,213,$crv213,214,$crv214,215,$crv215,216,$crv216,217,$crv217,218,$crv218,219,$crv219,220,$crv220,221,$crv221,222,$crv222,223,$crv223,224,$crv224,225,$crv225,226,$crv226,227,$crv227,228,$crv228,229,$crv229,230,$crv230,231,$crv231,232,$crv232,233,$crv233,234,$crv234,235,$crv235,236,$crv236,237,$crv237,238,$crv238,239,$crv239,240,$crv240,241,$crv241,242,$crv242,243,$crv243,244,$crv244,245,$crv245,246,$crv246,247,$crv247,248,$crv248,249,$crv249,250,$crv250,251,$crv251,252,$crv252,253,$crv253,254,$crv254,255,$crv255
-keep[0]
#@gimp Fast median stack : iain_fast_median_stack, iain_fast_median_stack
#@gimp : Note = note{"This filter gives the median value of the input images at each pixel location and therefore a single input image will have no change. Two input images will be averaged."}
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author : <i>Iain Fergusson</i>. Update 16 December 2014 - filter now accepts any number of images. ")
#@gimp : Note = note("<small>Author : <i>Iain Fergusson</i>. Update 8 March 2013 - Combined <i>median_3_stack</i> and <i>median_5_stack</i> into this filter, added <i>median_4_stack</i> and added auto-select based on number of input images.</small> ")
iain_fast_median_stack:
-if {@#>2}
-if {@#%2!=0}
-repeat {@#/2}
-repeat {@#-1}
-l[@{>,-1},{@{>,-1}+1}]
--max[0,1]
-min[0,1]
-endl
-done
-progress {(@{>,-1}/@#)*200}
-done
-keep[{round((@#/2)-.5)}]
-else
-repeat {(@#/2)+1}
-repeat {@#-1}
-l[@{>,-1},{@{>,-1}+1}]
--max[0,1]
-min[0,1]
-endl
-done
-progress {(@{>,-1}/@#)*200}
-done
-keep[{round((@#/2)-.5)},{round({@#/2}-.5)-1}]
-add
-mul .5
-endif
-elif {@#==2}
-add
-mul .5
-elif {@#==1}
-endif
iain_median_3_stack:
-iain_fast_median_stack
iain_median_4_stack:
-iain_fast_median_stack
iain_median_5_stack:
-iain_fast_median_stack
#@gimp Fft tile : fft_tile,fft_tile_preview(0)
#@gimp : Threshold = float (500,0,50000)
#@gimp : Tile size = int (128,16,256)
#@gimp : Fast = bool (0)
#@gimp : Sep = separator ()
#@gimp : Note = note("Author : <i>Iain Fergusson</i>.      Latest update : 2012/08/08")
fft_tile_fft:
--fftpolar[0]
--threshold[1] $1
-set[-1] 1,50%,50%
-mul[1] [-1]
--ifftpolar[1,2]
-keep[-1]
fft_tile_clean:
tc={round(w/$2)} tr={round(h/$2)}
-split_tiles $tc,$tr
-repeat @# -local[@{>,-1}]
-fft_tile_fft[0--1] $1
-endlocal -done
-append_tiles $tc,$tr
-c 0,255
fft_tile:
--resize[0] {w+$2},{h+$2},1,1,0,1,1,1
-resize[-1] {w+$2},{h+$2},1,1,0,1,0,0
-fft_tile_clean[-1] $1,$2
-crop[-1] $2,$2,{w-$2-1},{h-$2-1}
-if {$3==0}
push={round($2*1.5)}
pull={$2-$push}
--resize[0] {w+$push},{h+$2},1,1,0,1,1,1
-resize[-1] {w+$pull},{h+$2},1,1,0,1,0,0
-fft_tile_clean[-1] $1,$2
-crop[-1] {$push},{$2},{w-$pull-1},{h-($2)-1}
--resize[0] {w+$2},{h+$push},1,1,0,1,1,1
-resize[-1] {w+$2},{h+$pull},1,1,0,1,0,0
-fft_tile_clean[-1] $1,$2
-crop[-1] $2,{$push},{w-$2-1},{h-$pull-1}
dia1={round($2/3)}
dia2={$2-$dia1}
--resize[0] {w+$dia1},{h+$dia1},1,1,0,1,1,1
-resize[-1] {w+$dia2},{h+$dia2},1,1,0,1,0,0
-fft_tile_clean[-1] $1,$2
-crop[-1] {$dia1},{$dia1},{w-$dia2-1},{h-$dia2-1}
--resize[0] {w+$dia2},{h+$dia2},1,1,0,1,1,1
-resize[-1] {w+$dia1},{h+$dia1},1,1,0,1,0,0
-fft_tile_clean[-1] $1,$2
-crop[-1] {$dia2},{$dia2},{w-$dia1-1},{h-$dia1-1}
-endif
-remove[0]
-if {$3==0}
-iain_median_5_stack
-endif
fft_tile_preview:
-fft_tile $1,$2,$3
-n 0,255
#@gimp Fill holes : fill_holes,fill_holes_preview(0)
#@gimp : Morph radius = int (11,3,50)
#@gimp : Edge radius = int (21,0,50)
#@gimp : Close radius = int (5,0,10)
#@gimp : Channel(s) = choice(0,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Fill light colours = bool (0)
#@gimp : Fast = bool (1)
#@gimp : Sep = separator ()
#@gimp : Note = note("Set Morph radius to close holes, set Edge radius to restore edges, set Close radius to fill small holes near the edge")
#@gimp : Note = note("Author : <i>Iain Fergusson</i>.      Latest update : 28 August 2012 - added 'fast' option")
fill_holes:
-ac "
-if {$5==0}
-if {$6==1}
--dilate[-1] $1
-erode[-1] $2
-compose_lighten
-dilate[-1] $3
-erode[-1] $3
-endif
-if {$6==0}
--dilate_circ[-1] $1
-erode_circ[-1] $2
-compose_lighten
-dilate_circ[-1] $3
-erode_circ[-1] $3
-endif
-endif
-c 0,255
-if {$5==1}
-if {$6==1}
--erode[-1] $1
-dilate[-1] $2
-compose_darken
-erode[-1] $3
-dilate[-1] $3
-endif
-if {$6==0}
--erode_circ[-1] $1
-dilate_circ[-1] $2
-compose_darken
-erode_circ[-1] $3
-dilate_circ[-1] $3
-endif
-endif
-c 0,255
",$4
fill_holes_preview:
-fill_holes $1,$2,$3,$4,$5,$6
#@gimp Grey descreen : iain_descreen2,iain_descreen2(0)
#@gimp : Analysis window = float (3,0,20)
#@gimp : Strength = float(-10000,-10000,10000)
#@gimp : Range = float (10,0,20)
iain_descreen2:
-channels 0
-fftpolar
--blur[0] $1%
-sub[-1] [0]
-gt[-1] $2
-circle[-1] 50%,50%,$3%,1,1
-mul[0] [-1]
-keep[0,1]
-ifftpolar
-c 0,255
#@gimp Hearttone : iain_hearttone, iain_hearttone(0)
#@gimp : Scale = float(100,10,200)
#@gimp : Enhance detail = float(0,0,10)
iain_hearttone:
-if {$2>0}
--iain_fast_denoise[0] $2,0,1,0,0
-sub[1] [0]
-mul[1] -1
-add
-n 0,255
-endif
-luminance
--l
-rm
-l
190,190,1,1,0
-circle 50,50,50,1,10
-circle 140,50,50,1,10
-polygon 5,10,80,50,50,140,50,180,80,95,190,1,10
-resize[-1] @{0,w+2},@{0,h+2},1,1,0,0,0.5,0.5
--resize[0] 95%,95%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 90%,90%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 85%,85%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 75%,75%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 65%,65%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 55%,55%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 50%,50%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 45%,45%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 40%,40%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 35%,35%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 30%,30%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 25%,25%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 20%,20%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 15%,15%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 10%,10%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
--resize[0] 5%,5%,1,1,2
-resize[-1] @{0,w},@{0,h},1,1,0,0,0.5,0.5
-add
-endl
[0]
-append y
-resize 200%,100%,1,1,0,0,0.5,0.5
--shift[0] 160,100,0,0
--shift[0] -160,100,0,0
-add
-crop 30,190,350,100%
-n 0,255
-endl
-resize[-1] $1,$1,1,1,2
width=@{-1,w}
height=@{-1,h}
w_tiles={round(@{0,w}/$width)}
h_tiles={round(@{0,h}/$height)}
total_tiles=$h_tiles*$w_tiles
[-1]x{$total_tiles-1}
-append_tiles[1--1] $w_tiles,$h_tiles
-equalize[-1] 256
-blend alpha,0.5,1
-gt 128
-mul 255
#@gimp Iain 2x : iain_2x, iain_2x(0)
iain_2x:
-repeat @# -local[@{>,-1}]
-resize[0] 200%,200%,1,3,4
-split c
-repeat @# -local[@{>,-1}]
--l[0]
(0,0,0.5;0,1,0;0.5,0,0)
-convolve[0] [1]
-remove[1]
-endl
--l[0]
(0.5,0,0;0,1,0;0,0,0.5)
-convolve[0] [1]
-remove[1]
-endl
-remove[0]
--l[0]
(0,0,0.5;0,-1,0;0.5,0,0)
-convolve[0] [1]
-remove[1]
-abs
-endl
--l[1]
(0.5,0,0;0,-1,0;0,0,0.5)
-convolve[0] [1]
-remove[1]
-abs
-endl
-dilate[-1,-2] 3
-sub[-2] [-1]
-remove[-1]
-l[-1]
--lt[0] 0
--gt[0] 0
-fill[0] 0
-sub[0] [1]
-add[0] [-1]
-keep[0]
-add[0] 1
-mul[0] 127.5
-endl
-append[1,2] c
-blend alpha,1,0
--l[0]
(0.5,1,0.5)
-convolve[0] [1]
-remove[1]
-endl
--l[0]
(0.5;1;0.5)
-convolve[0] [1]
-remove[1]
-endl
-remove[0]
--l[0]
(0.5,-1,0.5)
-convolve[0] [1]
-remove[1]
-abs
-endl
--l[1]
(0.5;-1;0.5)
-convolve[0] [1]
-remove[1]
-abs
-endl
-blur[-1,-2] 3
-sub[-2] [-1]
-remove[-1]
-l[-1]
--lt[0] 0
--gt[0] 0
-fill[0] 0
-sub[0] [1]
-add[0] [-1]
-keep[0]
-add[0] 1
-mul[0] 127.5
-endl
-append[1,2] c
-blend alpha,1,0
-endlocal -done
-append c
-endlocal -done
#@gimp Iain demosiac : iain_demosiac, iain_demosiac(0)
#@gimp : Starting pattern = choice(0,"Red-Green","Blue-Green","Green-Red","Green-Blue")
#@gimp : Sep = separator ()
#@gimp : Note = note("Author: Iain Fergusson - released 6 June 2013")
iain_demosiac:
-to_rgb
-add 1000
-rgb2bayer $1,1
-replace 0,0.0000000001
--l[0]
-replace 0,0.000000001
--l[0]
-to_rgb
--split[0] c
-split[0] c
-name[0] red
-name[1] green
-name[2] blue
-name[-3] redblur
-name[-2] greenblur
-name[-1] blueblur
(0.25,.5,0.5,.5,0.25)
-convolve[redblur] [-1]
-convolve[blueblur] [-1]
-remove[-1]
(1;1)
-convolve[redblur] [-1]
-convolve[blueblur] [-1]
-remove[-1]
(0.5,1,0.5)
-convolve[greenblur] [-1]
-remove[-1]
--div[greenblur] [redblur]
--div[greenblur] [blueblur]
-name[-1] bluemul
-name[-2] redmul
-remove[redblur,greenblur,blueblur]
-mul[red] [redmul]
-mul[blue] [bluemul]
-keep[red,green,blue]
-add
-c -100000000,100000000
-endl
-l[0]
-to_rgb
--split[0] c
-split[0] c
-name[0] red
-name[1] green
-name[2] blue
-name[-3] redblur
-name[-2] greenblur
-name[-1] blueblur
(0.25;.5;0.5;.5;0.25)
-convolve[redblur] [-1]
-convolve[blueblur] [-1]
-remove[-1]
(1,1)
-convolve[redblur] [-1]
-convolve[blueblur] [-1]
-remove[-1]
(0.5;1;0.5)
-convolve[greenblur] [-1]
-remove[-1]
--div[greenblur] [redblur]
--div[greenblur] [blueblur]
-name[-1] bluemul
-name[-2] redmul
-remove[redblur,greenblur,blueblur]
-mul[red] [redmul]
-mul[blue] [bluemul]
-keep[red,green,blue]
-add
-c -100000000,100000000
-endl
## choose one without zippers
(1,-2,1)
--convolve[1] [-1]
-abs[-1]
-remove[-2]
(1;-2;1)
--convolve[0] [-1]
-abs[-1]
-remove[-2]
--add[-2] [-1]
-div[-2] [-1]
-remove[-1,-3]
-lt[-1] 0.5
-mul[-1] 255
-blur[-1] 1
-append[0,-1] c
-blend alpha,1,1
-endl
-split[0] c
-remove[1]
-reverse[1,2]
(0.25,0.5,0.25;0.5,1,0.5;0.25,0.5,0.25)
-convolve[0] [-1]
-convolve[2] [-1]
-remove[-1]
--resize 50%,50%,{d},{s},2
-sub[-1] [-2]
-sub[-3] [-2]
-remove[-2]
-resize[-1,-2] @{0,w},@{0,h},{d},{s},3
-remove[0,2]
-add[1] [0]
-add[2] [0]
-reverse[0,1]
-append c
-sub 1000
-c 0,255
#@gimp Iain star burst : iain_star_burst,iain_star_burst(0)
#@gimp : Threshold = int (254,0,255)
#@gimp : Radius = float (50,1,255)
#@gimp : Intesity = float (5,0,10)
#@gimp : Rotate = int (45,0,90)
#@gimp : Lines = int (2,1,10)
#@gimp : Colour modify = bool(0)
#@gimp : Output stars only = bool(0)
iain_star_burst:
-repeat @# -l[$>] -split_opacity -l[0]
width={w}
height={h}
-resize {w+($2*2)},{h+($2*2)},1,3,0,0,0.5,0.5
--gt[0] $1
-mul[1] 255
-skeleton[1] 0
-if $6
-rgb2hsl
-split c
[0]
-reverse[3,-1]
-rm[-1]
-append[0,1,2] c
-append[1,2,3] c
-hsl2rgb
-endif
-mul[1] 255
-l[1]
{$2*5},{$2*5},1,1,0
-set[-1] 1,50%,50%
-l[-1]
-repeat $5
--blur_linear[0] $2,.5,{$4+((180/$5)*($>+1))}
-done
-rm[0]
-add
-endl
-convolve_fft[0] [1]
-endl
-mul[1] {1/$5}
-mul[1] {$3*10}
-if $7
-keep[1]
-else
-max
-endif
-c 0,255
-crop {$2},{$2},{$width+$2-1},{$height+$2-1}
-endl -a c -endl -done
#@gimp Iain unindex : iain_unindex,iain_unindex_preview(0)
#@gimp : Smooth = float (30,0,100)
#@gimp : Edge threshold = float (20,0,50)
#@gimp : Preview zoom = bool(1)
#@gimp : Zoom center h = float(50,0,100)
#@gimp : Zoom center v = float(50,0,100)
#@gimp : Sep = separator ()
#@gimp : Note = note("Author: Iain Fergusson - released 19 Feb 2013")
iain_unindex:
amplitude=$1
sharpness=.3
anisotropy=1
gradient_smoothness=.6
tensor_smoothness=1
spatial_precision=0.8
angular_precision=30
value_precision=2
interpolation=0
fast_approx=1
-to_rgb
--smooth[0] $amplitude,$sharpness,$anisotropy,$gradient_smoothness,$tensor_smoothness,$spatial_precision,$angular_precision,$value_precision,$interpolation,$fast_approx
--luminance[-1]
-laplacian[-1]
-abs[-1]
-blur[-1] .5
-threshold[-1] $2
-mul[-1] -1
-add[-1] 1
-mul[-1] 255
-append[1,2] c
-blend alpha,1,0
-keep[-1]
iain_unindex_preview:
-iain_unindex $1,$2
-if {$3==1}
topleftx={$4-25}
toplefty={$5-25}
botleftx={$4+25}
botlefty={$5+25}
-crop $topleftx%,$toplefty%,$botleftx%,$botlefty%
-endif
#@gimp Iain weightmap : iain_weightmap, iain_weightmap
#@gimp : Lap weight = float (1,0,4)
#@gimp : Blur width = float (40,0,100)
iain_weightmap:
-split c
-max
255,1
-set[-1] 255,128,0
-blur[-1] $2
-n[-1] 0,255
--map[0] [1]
-rm[1]
-laplacian[0]
-mul[0] $1
-abs[0]
-add
#@gimp Luminance nr : luminance_nr, luminance_nr(0)
#@gimp : Note = note{"Normal Patch based smoothing (scale 1)"}
#@gimp : Patch variance = float (10,0,50)
#@gimp : Fast approximation = bool (1)
#@gimp : Iterations = int (1,1,5)
#@gimp : Sep = separator ()
#@gimp : Note = note{"Smoothing of addition scales"}
#@gimp : Scale 2 = float (6,0,25)
#@gimp : Scale 3 = float (5,0,25)
#@gimp : Scale 4 = float (4,0,25)
#@gimp : Scale 5 = float (3,0,25)
#@gimp : Scale 6 = float (2,0,25)
#@gimp : Scale 7 = float (1,0,25)
#@gimp : Sep = separator ()
#@gimp : Note = note{"Restore details"}
#@gimp : Threshold = float (5000,0,5000)
#@gimp : Tile size = int (64,32,128)
#@gimp : Gamma = float (1.3,1,4)
#@gimp : Sep = separator ()
#@gimp : Note = note("This filter is <b>slow!</b>")
#@gimp : Note = note("Author : <i>Iain Fergusson</i>.      Latest update : 2012/19/08")
luminance_nr:
-apply_gamma {1/$12}
-ac"
--ms_patch_smooth[0] 10,$1,3,3,0,$2,$3,0,$4,$5,$6,$7,$8,$9,1
--compose_grainextract
-fft_tile[-1] $10,$11,0
-compose_grainmerge[1,2]
-keep[-1]
",7
-apply_gamma $12
#@gimp Luminance nr2 : luminance_nr_two, luminance_nr_two(0)
#@gimp : Patch variance = float (10,0.1,20)
#@gimp : Fast approximation = bool (1)
#@gimp : Iterations = int (1,1,5)
#@gimp : Sep = separator ()
#@gimp : Note = note("Adjust NR for for larger scales as %")
#@gimp : Scale 2 = float (.8,0,1)
#@gimp : Scale 3 = float (.7,0,1)
#@gimp : Scale 4 = float (.6,0,1)
#@gimp : Scale 5 = float (.5,0,1)
#@gimp : Scale 6 = float (.4,0,1)
#@gimp : Scale 7 = float (.3,0,1)
#@gimp : Sep = separator ()
#@gimp : Note = note("Master threshold for details")
#@gimp : Threshold = float (1200,0,10000)
#@gimp : Tile size = int (64,32,128)
#@gimp : Nothing = float (0,0,0)
#@gimp : Sep = separator ()
#@gimp : Note = note("Adjust threshold for detials")
#@gimp : Fine = float (0,-1000,1000)
#@gimp : Medium = float (0,-1000,1000)
#@gimp : Course = float (0,-1000,1000)
#@gimp : Recover detail = bool (0)
#@gimp : Sep = separator ()
#@gimp : Note = note("Adjust noise reduction by tone")
#@gimp : Blacks = int (0,0,500)
#@gimp : Darks = int (0,0,500)
#@gimp : Midtones = int (0,0,500)
#@gimp : Lights = int (0,0,500)
#@gimp : White = int (0,0,500)
#@gimp : Sep = separator ()
#@gimp : Median pass first = bool (0)
#@gimp : Note = note("This filter is <b>slow!</b>")
#@gimp : Note = note("Author : <i>Iain Fergusson</i>.      Latest update : 25 August 2012")
fft_tile2_fft:
--fftpolar[0]
100%,100%,1,1,1
-ellipse[-1] 50%,50%,50%,50%,0,1,$4
-ellipse[-1] 50%,50%,15%,15%,0,1,$5
-ellipse[-1] 50%,50%,5%,5%,0,1,$6
-box_blur[-1] {$2*0.01}
--add[1] [-1]
-threshold[-1] {$1/(128/$2)}
-set[-1] 1,50%,50%
-mul[1] [-1]
--ifftpolar[1,2]
-keep[-1]
fft_tile2_clean:
tc={round(w/$2)} tr={round(h/$2)}
-split_tiles $tc,$tr
-repeat @# -local[@{>,-1}]
-fft_tile2_fft[0--1] $1,$2,$3,$4,$5,$6
-endlocal -done
-append_tiles $tc,$tr
-c 0,255
fft_tile2:
--resize[0] {w+$2},{h+$2},1,1,0,1,1,1
-resize[-1] {w+$2},{h+$2},1,1,0,1,0,0
-fft_tile2_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] $2,$2,{w-$2-1},{h-$2-1}
-if {$3==0}
push={round($2*1.5)}
pull={$2-$push}
--resize[0] {w+$push},{h+$2},1,1,0,1,1,1
-resize[-1] {w+$pull},{h+$2},1,1,0,1,0,0
-fft_tile2_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] {$push},{$2},{w-$pull-1},{h-($2)-1}
--resize[0] {w+$2},{h+$push},1,1,0,1,1,1
-resize[-1] {w+$2},{h+$pull},1,1,0,1,0,0
-fft_tile2_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] $2,{$push},{w-$2-1},{h-$pull-1}
dia1={round($2/3)}
dia2={$2-$dia1}
--resize[0] {w+$dia1},{h+$dia1},1,1,0,1,1,1
-resize[-1] {w+$dia2},{h+$dia2},1,1,0,1,0,0
-fft_tile2_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] {$dia1},{$dia1},{w-$dia2-1},{h-$dia2-1}
--resize[0] {w+$dia2},{h+$dia2},1,1,0,1,1,1
-resize[-1] {w+$dia1},{h+$dia1},1,1,0,1,0,0
-fft_tile2_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] {$dia2},{$dia2},{w-$dia1-1},{h-$dia1-1}
-endif
-remove[0]
-if {$3==0}
-iain_median_5_stack
-endif
luminance_nr_two:
-ac "
-mul 9.99
-apply_curve 0,0,0,510,{510-$17},1020,{1020-$17-$18},1530,{1530-$17-$18-$19},2040,{2040-$17-$18-$19-$20},2550,{2550-$17-$18-$19-$20-$21},2550,2550
-mul 0.1
-if {$22==1}
--median[0] 3
-ms_patch_smooth[-1] 10,$1,3,3,0,$2,$3,0,{$1*$4},{$1*$5},{$1*$6},{$1*$7},{$1*$8},{$1*$9},1
-endif
-if {$22==0}
--ms_patch_smooth[0] 10,$1,3,3,0,$2,$3,0,{$1*$4},{$1*$5},{$1*$6},{$1*$7},{$1*$8},{$1*$9},1
-endif
-if {$16==1}
--compose_grainextract
-fft_tile2[-1] $10,$11,3,$13,$14,$15
-compose_grainmerge[1,2]
-endif
-keep[-1]
-mul 9.99
-apply_curve 0,0,0,{510-$17},510,{1020-$17-$18},1020,{1530-$17-$18-$19},1530,{2040-$17-$18-$19-$20},2040,{2550-$17-$18-$19-$20-$21},2550,2550,2550
-mul 0.1
",7
-c 0,255
#@gimp Moire removal : iain_moire_removal, iain_moire_removal(0)
#@gimp : Smoothing = float (5,0,20)
#@gimp : Smart threshold = float (5,0,10)
#@gimp : Moire removal method = choice(0,"Smart","Aggresive","Smooth only")
#@gimp : Sep = separator()
#@gimp : Note = note("Moire removal consists of two parts, first, an edge-protected smoothing and second a frequency analyisis of the difference between the smoothed and original image. The image is broken into tiles, and each tile processed. A tile that is a solid colour is skipped." )
#@gimp : Note = note("Smoothing must be high enough to remove the moire. The <b>Smart Threshold</b> sets the detection of moire for each frequency on each colour channel. If a frequency in one colour channel is determined to be moire it is replaced by the colour channel least likely to have moire." )
#@gimp : Note = note("The <b>Agressive</b> setting skips the thresolding step and uses the lowest frequency level from the colour channels." )
#@gimp : Note = note("The filter will reduce chroma details/noise" )
iain_moire_removal:
tile_size=256
overlap=16
cropwidth={w}
cropheight={h}
-if {$cropwidth%$tile_size>0}
-resize[0] {w+($tile_size-w%$tile_size)},100%,1,{s},0,1
-endif
-if {$cropheight%$tile_size>0}
-resize[0] 100%,{h+($tile_size-h%$tile_size)},1,{s},0,1
-endif
h_tiles={w/$tile_size}
v_tiles={h/$tile_size}
-repeat $v_tiles
-repeat $h_tiles
h_count=@{>,-1}
v_count=@{>,-2}
--crop[0] {($h_count*$tile_size)-$overlap},{($v_count*$tile_size)-$overlap},{($h_count*$tile_size)+($tile_size+$overlap-1)},{($v_count*$tile_size)+($tile_size+$overlap-1)},1
-done
-done
-rm[0]
-repeat @# -l[@{>,-1}]
-if {iM!=im}
[0]
-apply_parallel_channels[1] "
-l[0]
-repeat 3
-l[-1]
-repeat 2
-denoise[0] 10,{$1/(@{>,-1}+1)},5,5,0,{min(@{>,-1},1)}
-done
--resize[0] 50%,50%,{d},{s},2
--resize[-1] 200%,200%,{d},{s},3
-sub[0,-1]
-endl
-done
-repeat {@#-1}
-resize[-1] @{-2,w},@{-2,h},{d},{s},3
-add[-1,-2]
-done
-endl
"
-if {$3<2}
-sub[0] [1]
-l[0]
-fftpolar[0]
-if {$3==1}
-append[0,1] x
-split[0] c
-min
-split[0] x,2
-elif {$3==0}
-fill[1] if(max(i(x,y,z,0),i(x,y,z,1),i(x,y,z,2))-min(i(x,y,z,0),i(x,y,z,1),i(x,y,z,2))<$2,min(i(x,y,z,0),i(x,y,z,1),i(x,y,z,2)),(i(x,y,z,c)))
-endif
-ifftpolar[0,1]
-keep[0]
-endl
-to_rgb
-add
-else
-keep[1]
-endif
-c 0,255
-endif
-endl
-progress {(@{>,-1}/@#)*100}
-done
-repeat @# -l[@{>,-1}]
-crop $overlap,$overlap,{$tile_size+$overlap-1},{$tile_size+$overlap-1}
-endl
-done
-append_tiles $h_tiles,$v_tiles
-crop 0,0,{$cropwidth-1},{$cropheight-1}
#@gimp Moire removal not parallel : iain_moire_removal_NP, iain_moire_removal_NP(0)
#@gimp : Smoothing = float (5,0,20)
#@gimp : Smart threshold = float (5,0,10)
#@gimp : Moire removal method = choice(0,"Smart","Aggresive","Smooth only")
#@gimp : Sep = separator()
#@gimp : Note = note("This filter is the same as the other one but doe snot have parallel processing" )
#@gimp : Sep = separator()
#@gimp : Note = note("Moire removal consists of two parts, first, an edge-protected smoothing and second a frequency analyisis of the difference between the smoothed and original image. The image is broken into tiles, and each tile processed. A tile that is a solid colour is skipped." )
#@gimp : Note = note("Smoothing must be high enough to remove the moire. The <b>Smart Threshold</b> sets the detection of moire for each frequency on each colour channel. If a frequency in one colour channel is determined to be moire it is replaced by the colour channel least likely to have moire." )
#@gimp : Note = note("The <b>Agressive</b> setting skips the thresolding step and uses the lowest frequency level from the colour channels." )
#@gimp : Note = note("The filter will reduce chroma details/noise" )
iain_moire_removal_NP:
tile_size=256
overlap=16
cropwidth={w}
cropheight={h}
-if {$cropwidth%$tile_size>0}
-resize[0] {w+($tile_size-w%$tile_size)},100%,1,{s},0,1
-endif
-if {$cropheight%$tile_size>0}
-resize[0] 100%,{h+($tile_size-h%$tile_size)},1,{s},0,1
-endif
h_tiles={w/$tile_size}
v_tiles={h/$tile_size}
-repeat $v_tiles
-repeat $h_tiles
h_count=@{>,-1}
v_count=@{>,-2}
--crop[0] {($h_count*$tile_size)-$overlap},{($v_count*$tile_size)-$overlap},{($h_count*$tile_size)+($tile_size+$overlap-1)},{($v_count*$tile_size)+($tile_size+$overlap-1)},1
-done
-done
-rm[0]
-repeat @# -l[@{>,-1}]
-if {iM!=im}
[0]
-l[1]
-l[0]
-repeat 3
-l[-1]
-repeat 2
-denoise[0] 10,{$1/(@{>,-1}+1)},5,5,0,{min(@{>,-1},1)}
-done
--resize[0] 50%,50%,{d},{s},2
--resize[-1] 200%,200%,{d},{s},3
-sub[0,-1]
-endl
-done
-repeat {@#-1}
-resize[-1] @{-2,w},@{-2,h},{d},{s},3
-add[-1,-2]
-done
-endl
-endl
-if {$3<2}
-sub[0] [1]
-l[0]
-fftpolar[0]
-if {$3==1}
-append[0,1] x
-split[0] c
-min
-split[0] x,2
-elif {$3==0}
-fill[1] if(max(i(x,y,z,0),i(x,y,z,1),i(x,y,z,2))-min(i(x,y,z,0),i(x,y,z,1),i(x,y,z,2))<$2,min(i(x,y,z,0),i(x,y,z,1),i(x,y,z,2)),(i(x,y,z,c)))
-endif
-ifftpolar[0,1]
-keep[0]
-endl
-to_rgb
-add
-else
-keep[1]
-endif
-c 0,255
-endif
-endl
-progress {(@{>,-1}/@#)*100}
-done
-repeat @# -l[@{>,-1}]
-crop $overlap,$overlap,{$tile_size+$overlap-1},{$tile_size+$overlap-1}
-endl
-done
-append_tiles $h_tiles,$v_tiles
-crop 0,0,{$cropwidth-1},{$cropheight-1}
#@gimp Ms nlmeans c noise2 : ms_nlmeans_c_noise2_p,ms_nlmeans_c_noise2_p_preview(0)
#@gimp : Note = note("<b>Noise Reduction</b>")
#@gimp : 1 fine = float(3,0,10)
#@gimp : 2 coarse = float(1,0,10)
#@gimp : 3 blacks = float (0,-10,10)
#@gimp : 4 shadows = float (0,-10,10)
#@gimp : 5 midtones = float (0,-10,10)
#@gimp : 6 highlights = float (0,-10,10)
#@gimp : 7 whites = float (0,-10,10)
#@gimp : 8 smooth curve = float (10,0,50)
#@gimp : Sep = separator ()
#@gimp : Note = note("<b>Advanced settings</b>")
#@gimp : 9 patch size = float(2,1,10)
#@gimp : 10 search radius = int(4,1,10)
#@gimp : 11 patch size = float(2,1,10)
#@gimp : 12 search radius = int(7,1,10)
#@gimp : Sep = separator ()
#@gimp : Note = note("Side chain Processing")
#@gimp : 13 red/blue median = bool(0)
#@gimp : 14 green despeckle = bool(0)
#@gimp : Sep = separator ()
#@gimp : 15 use noise estimate = bool(0)
#@gimp : Sep = separator ()
#@gimp : 16 show info = bool(0)
ms_nlmeans_c_noise2_p_preview:
-if $16
-remove_opacity
--ms_nlmeans_c_noise2[0] ${1--1}
-sub
-mul 2
-add 128
-c 0,255
-else
-ms_nlmeans_c_noise2[0] ${1--1}
-endif
ms_nlmeans_c_noise2_p:
-ms_nlmeans_c_noise2[0] ${1--1}
ms_nlmeans_c_noise2:
-remove_opacity
hf_strength={2^$1}
lf_strength={2^$2}
hf_patch=$9
hf_search=$10
lf_patch=$11
lf_search=$12
sc_rb=$13
sc_g=$14
blacks={2^$3}
shadows={2^$4}
midtones={2^$5}
highlights={2^$6}
whites={2^$7}
smooth=$8
shadow={2^$3}
highlight={2^$4}
levels=1
size={3^$levels}
cropwidth={w}
cropheight={h}
-resize {w+($size-w%$size)},{h+($size-h%$size)},{d},{s},0,1
--l[0]
-split c
-if $sc_rb
-median[0,2] 4
-endif
-if $sc_g
-l[1]
--l[0]
(1,1,1;1,0,1;1,1,1)
-dilate[0] [1]
-rm[1]
-endl
--l[0]
(1,1,1;1,0,1;1,1,1)
-erode[0] [1]
-rm[1]
-endl
-min[0,1]
-max[0,1]
-endl
-endif
-append c
-luminance
-endl
-if $11
--c_noise[0] 1.6
-else
[1]
-to_rgb[-1]
-negative[-1]
-add[-1] .1
-mul[-1] .1
-blur[-1] 2
-endif
--l[1]
255,1,1,1,1
-line[-1] 0,0,50,0,1,$blacks
-line[-1] 51,0,100,0,1,$shadows
-line[-1] 101,0,152,0,1,$midtones
-line[-1] 153,0,204,0,1,$highlights
-line[-1] 205,0,255,0,1,$whites
-blur[-1] $smooth
-map[0] [1]
-keep[0]
-endl
-mul[2,-1]
--l[0,1,2]
-mul[-1] $hf_strength
-f[-1] '-3.0/i' -nlmeans_core[0] [1],[2],$hf_patch,$hf_search
-keep[0]
-endl
-reverse[0,-1]
-rm[-1]
--l[0,1,2]
-resize[0,1,2] 33.33333%,33.33333%,{d},{s},2
-mul[-1] $lf_strength
-f[-1] '-3.0/i' -nlmeans_core[0] [1],[2],$lf_patch,$lf_search
-keep[0]
-endl
-rm[1,2]
--resize[0] 33.33333%,33.33333%,{d},{s},2
-linear_x3[-1]
-sub[0,-1]
-linear_x3[-1]
-add
-c 0,255
## -repeat {@#-1}
## -done
-crop 0,0,{$cropwidth-1},{$cropheight-1}
-c 0,255
c_noise:
width={w}
height={h}
--l[0]
--shift[0] 0,1,0,0,2
--shift[0] 0,-1,0,0,2
-blend_median
-endl
-sub
-abs
-add .1
-pow $1
-resize 25%,25%,1,3,2
-median 3
-resize $width,$height,1,3,3
#@gimp Ms patch chroma : ms_patch_c, ms_patch_c_preview(0)
#@gimp : Note = note{"Master Patch based smoothing (scale 1)"}
#@gimp : Patch variance = float (5,0.1,50)
#@gimp : Median pass = bool (1)
#@gimp : Global iterations = int (1,1,5)
#@gimp : Sep = separator ()
#@gimp : Scale 2 = float (5,0,25)
#@gimp : Scale 3 = float (4,0,25)
#@gimp : Scale 4 = float (3,0,25)
#@gimp : Scale 5 = float (2,0,25)
#@gimp : Scale 6 = float (1,0,25)
#@gimp : Scale 7 = float (1,0,25)
#@gimp : Undo gamma = float (1.3,1,3)
#@gimp : Sep = separator ()
#@gimp : Note = note{"Customise Luma weighting"}
#@gimp : Red = float (0.375,0,1)
#@gimp : Green = float (.5,0,1)
#@gimp : Blue = float (0.125,0,1)
#@gimp : Sep = separator ()
#@gimp : Show difference = bool (0)
#@gimp : Note = note("Author : <i>Iain Fergusson</i>.      Latest update : 10 December 2012 - added show difference option and changed interations from local operation to global operation.")
create_luma_mix:
--split[0] c
-mul[1] {$1/($1+$2+$3)}
-mul[2] {$2/($1+$2+$3)}
-mul[3] {$3/($1+$2+$3)}
-add[1-3]
-keep[-1]
-to_gray[-1]
ms_patch_c:
-to_rgb
--create_luma_mix[0] $11,$12,$13
-name[-1] luma
-if {$2==1}
-median[0] 3
-median[0] 3
-endif
-repeat $3
-ms_patch_smooth[0] 10,$1,3,5,0,1,1,0,$4,$5,$6,$7,$8,$9,$10
-done
--create_luma_mix[0] $11,$12,$13
-sub[0] [-1]
-add[0] [1]
-keep[0]
-c 0,255
ms_patch_c_preview:
-if {$-1==0}
-ms_patch_c ${1--2}
-endif
-if {$-1==1}
--ms_patch_c ${1--2}
-sub[0] [1]
-keep[0]
-mul 2
-add 128
-endif
#@gimp Ms patch nr : MS_Patch_NR,MS_Patch_NR(0)
#@gimp : Gamma = float(1.3,.5,2)
#@gimp : Fine = float(0,0,250)
#@gimp : Coarse = float(0,0,250)
#@gimp : Coarsest = float(0,0,250)
#@gimp : Patch size = int(3,3,7)
#@gimp : Search radius = int(5,3,17)
linear_x3:
-resize 300%,300%,{d},{s},4,1,.5,.5,0
(.11111,.22222,.33333,.22222,.11111;.22222,.44444,.66666,.44444,.22222;.33333,.66666,1,.66666,.33333;.22222,.44444,.66666,.44444,.22222;.11111,.22222,.33333,.22222,.11111)
-convolve[0] [1],0
-rm[1]
MS_Patch_NR:
-if {$1!=1}
-apply_parallel_overlap "-div 255 -pow $1 -mul 255"
-endif
cropwidth={w}
cropheight={h}
-resize[0] {w+(90-w%90)},{h+(90-h%90)},1,{s},0,1
-l[0]
width={w}
height={h}
-if {$2>0}
-apply_parallel_overlap[-1] "-denoise 10,{$2/10},$5,$6,0,0",16
-endif
--resize[-1] 33.333333333%,33.3333333333%,{d},{s},2
--linear_x3[-1]
-sub[-3,-1]
-if {$3>0}
-apply_parallel_overlap[-1] "-denoise 10,{$3/10},$5,$6,0,0",16
-endif
--resize[-1] 33.333333333%,33.3333333333%,{d},{s},2
--linear_x3[-1]
-sub[-3,-1]
-if {$4>0}
-apply_parallel_overlap[-1] "-denoise 10,{$4/10},$5,$6,0,0",16
-endif
--resize[-1] 33.333333333%,33.3333333333%,{d},{s},2
--linear_x3[-1]
-sub[-3,-1]
-linear_x3[-1]
-add[-1,-2]
-linear_x3[-1]
-add[-1,-2]
-linear_x3[-1]
-add[-1,-2]
-endl
-crop 0,0,{$cropwidth-1},{$cropheight-1}
-if {$1!=1}
-apply_parallel_overlap "-div 255 -pow {1/$1} -mul 255"
-endif
-c 0,255
#@gimp Ms patch nr3 : MS_Patch_NR3,MS_Patch_NR3_p(0)
#@gimp : Gamma = float(1.3,.5,2)
#@gimp : L fine = int(0,0,250)
#@gimp : L coarse = int(0,0,250)
#@gimp : L coarsest = int(0,0,250)
#@gimp : Patch size = int(3,3,7)
#@gimp : Search radius = int(5,3,17)
#@gimp : Fast = choice (1,"smooth","fast")
#@gimp : Pre salt and pepper = choice (0,"none","smooth","fast","strong")
#@gimp : Post salt and pepper = choice (0,"none","smooth","fast","strong")
#@gimp : C fine = int(0,0,250)
#@gimp : C coarse = int(0,0,250)
#@gimp : C coarsest = int(0,0,250)
MS_Patch_NR3_p:
-to_rgb
-MS_Patch_NR3[0] $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12
-n 0,255
linear_x3:
-resize 300%,300%,{d},{s},4,1,.5,.5,0
(.11111,.22222,.33333,.22222,.11111;.22222,.44444,.66666,.44444,.22222;.33333,.66666,1,.66666,.33333;.22222,.44444,.66666,.44444,.22222;.11111,.22222,.33333,.22222,.11111)
-convolve[0] [1],0
-rm[1]
MS_Patch_NR3:
-apply_parallel_overlap[-1] "
-if {$1!=1}
-div 255 -pow $1 -mul 255
-endif
-if {$8==1}
-iain_pixel_denoise_p 1,1,0,0,1
-elif {$8==2}
-iain_pixel_denoise_p 2,1,0,0,1
-elif {$8==3}
-hybrid16 -hybrid16 -hybrid16
-endif
cropwidth={w}
cropheight={h}
-resize[0] {w+(90-w%90)},{h+(90-h%90)},1,{s},0,1
-rgb2yuv8
-split c
-l[0]
width={w}
height={h}
-if {$2>0}
-denoise 10,{$2/10},$5,$6,0,$7
-endif
--resize[-1] 33.333333333%,33.3333333333%,{d},{s},2
--linear_x3[-1]
-sub[-3,-1]
-if {$3>0}
-denoise 10,{$3/10},$5,$6,0,$7
-endif
--resize[-1] 33.333333333%,33.3333333333%,{d},{s},2
--linear_x3[-1]
-sub[-3,-1]
-if {$4>0}
-denoise 10,{$4/10},$5,$6,0,$7
-endif
--resize[-1] 33.333333333%,33.3333333333%,{d},{s},2
--linear_x3[-1]
-sub[-3,-1]
-linear_x3[-1]
-add[-1,-2]
-linear_x3[-1]
-add[-1,-2]
-linear_x3[-1]
-add[-1,-2]
-endl
-l[1]
width={w}
height={h}
-if {$10>0}
-denoise 10,{$10/10},$5,$6,0,$7
-endif
--resize[-1] 33.333333333%,33.3333333333%,{d},{s},2
--linear_x3[-1]
-sub[-3,-1]
-if {$11>0}
-denoise 10,{$11/10},$5,$6,0,$7
-endif
--resize[-1] 33.333333333%,33.3333333333%,{d},{s},2
--linear_x3[-1]
-sub[-3,-1]
-if {$12>0}
-denoise 10,{$12/10},$5,$6,0,$7
-endif
--resize[-1] 33.333333333%,33.3333333333%,{d},{s},2
--linear_x3[-1]
-sub[-3,-1]
-linear_x3[-1]
-add[-1,-2]
-linear_x3[-1]
-add[-1,-2]
-linear_x3[-1]
-add[-1,-2]
-endl
-l[2]
width={w}
height={h}
-if {$10>0}
-denoise 10,{$10/10},$5,$6,0,$7
-endif
--resize[-1] 33.333333333%,33.3333333333%,{d},{s},2
--linear_x3[-1]
-sub[-3,-1]
-if {$11>0}
-denoise 10,{$11/10},$5,$6,0,$7
-endif
--resize[-1] 33.333333333%,33.3333333333%,{d},{s},2
--linear_x3[-1]
-sub[-3,-1]
-if {$12>0}
-denoise 10,{$12/10},$5,$6,0,$7
-endif
--resize[-1] 33.333333333%,33.3333333333%,{d},{s},2
--linear_x3[-1]
-sub[-3,-1]
-linear_x3[-1]
-add[-1,-2]
-linear_x3[-1]
-add[-1,-2]
-linear_x3[-1]
-add[-1,-2]
-endl
-append c
-yuv82rgb
-crop 0,0,{$cropwidth-1},{$cropheight-1}
-if {$1!=1}
-div 255 -pow {1/$1} -mul 255
-endif
-if {$9==1}
-iain_pixel_denoise_p 1,1,0,0,1
-elif {$9==2}
-iain_pixel_denoise_p 2,1,0,0,1
-elif {$9==3}
-hybrid16 -hybrid16 -hybrid16
-endif
-c 0,255
",64
#@gimp Multi scale patch smoothing : ms_patch_smooth,ms_patch_smooth_preview(0)
#@gimp : Note = note{"Normal Patch based smoothing (scale 1)"}
#@gimp : Spatial variance = float (10,0,20)
#@gimp : Patch variance = float (5,0.1,50)
#@gimp : Patch size = int (3,2,21)
#@gimp : Lookup size = int (5,2,21)
#@gimp : Patch smoothness = float (0,0,4)
#@gimp : Fast approximation = bool (1)
#@gimp : Iterations = int (1,1,5)
#@gimp : Channel(s) = choice(7,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator ()
#@gimp : Note = note{"Patch Variance for additional scales"}
#@gimp : Scale 2 = float (5,0,25)
#@gimp : Scale 3 = float (4,0,25)
#@gimp : Scale 4 = float (3,0,25)
#@gimp : Scale 5 = float (2,0,25)
#@gimp : Scale 6 = float (1,0,25)
#@gimp : Scale 7 = float (1,0,25)
#@gimp : Undo gamma = float (1.3,1,3)
#@gimp : Sep = separator ()
#@gimp : Show difference = bool (0)
#@gimp : Sep = separator ()
#@gimp : Note = note("Author : <i>Iain Fergusson</i>.      Latest update : 28 August 2012 - minor speed up, but level 7 does not do anything now.")
ms_patch_smoothsmoothing:
-ac "-repeat $7 -denoise $1,$2,$3,$4,$5,$6 -done",$8 -c 0,255
ms_patch_smooth:
lvl2=2
lvl3=3
lvl4=4
lvl5=5
lvl6=6
lvl7=8
-apply_gamma {1/$15}
-ms_patch_smoothsmoothing[-1] $1,$2,$3,$4,$5,$6,$7,$8
-name[0] full
--resize[full] @{full,w/$lvl2},@{full,h/$lvl2},1,{s},2 -name[1] level2
--ms_patch_smoothsmoothing[level2] $1,$9,$3,$4,$5,$6,$7,$8  -name[2] level2clean
--resize[level2] @{0,w},@{0,h},1,{s},5  -name[3] low2
--sub[full] [low2]  -name[4] level2high
-remove[level2,low2]
--resize[level2clean] @{full,w/$lvl3},@{full,h/$lvl3},1,{s},2 -name[3] level3
--ms_patch_smoothsmoothing[level3] $1,$10,$3,$4,$5,$6,$7,$8  -name[4] level3clean
--resize[level3] @{level2clean,w},@{level2clean,h},1,{s},5  -name[5] low3
--sub[level2clean] [low3]  -name[6] level3high
-remove[level3,low3]
--resize[level3clean] @{full,w/$lvl4},@{full,h/$lvl4},1,{s},2 -name[5] level4
--ms_patch_smoothsmoothing[level4] $1,$11,$3,$4,$5,$6,$7,$8  -name[6] level4clean
--resize[level4] @{level3clean,w},@{level3clean,h},1,{s},5  -name[7] low4
--sub[level3clean] [low4]  -name[8] level4high
-remove[level4,low4]
--resize[level4clean] @{full,w/$lvl5},@{full,h/$lvl5},1,{s},2 -name[-1] level5
--ms_patch_smoothsmoothing[level5] $1,$12,$3,$4,$5,$6,$7,$8  -name[-1] level5clean
--resize[level5] @{level4clean,w},@{level4clean,h},1,{s},5  -name[-1] low5
--sub[level4clean] [low5]  -name[-1] level5high
-remove[level5,low5]
--resize[level5clean] @{full,w/$lvl6},@{full,h/$lvl6},1,{s},2 -name[-1] level6
--ms_patch_smoothsmoothing[level6] $1,$13,$3,$4,$5,$6,$7,$8  -name[-1] level6clean
--resize[level6] @{level5clean,w},@{level5clean,h},1,{s},5  -name[-1] low6
--sub[level5clean] [low6]  -name[-1] level6high
-remove[level6,low6]
-name[-2] base
-resize[base] @{level6high,w},@{level6high,h},1,{s},5
-add[base] [level6high]
-remove[level6high]
-resize[base] @{level5high,w},@{level5high,h},1,{s},5
-add[base] [level5high]
-remove[level5high]
-resize[base] @{level4high,w},@{level4high,h},1,{s},5
-add[base] [level4high]
-remove[level4high]
-resize[base] @{level3high,w},@{level3high,h},1,{s},5
-add[base] [level3high]
-remove[level3high]
-resize[base] @{level2high,w},@{level2high,h},1,{s},5
-add[base] [level2high]
-remove[level2high]
-keep[-1]
-c 0,255
-apply_gamma {$15}
-c 0,255
ms_patch_smooth_preview:
-if {$-1==0}
-ms_patch_smooth ${1--2}
-endif
-if {$-1==1}
--ms_patch_smooth ${1--2}
-sub[0] [1]
-keep[0]
-mul 2
-add 128
-endif
#@gimp Multi scale smoothing : ms_smooth,ms_smooth_preview(0)
#@gimp : Smooth scale 1 = float (0,0,100)
#@gimp : Smooth scale 2 = float (0,0,100)
#@gimp : Smooth scale 3 = float (0,0,100)
#@gimp : Smooth scale 4 = float (0,0,100)
#@gimp : Smooth scale 5 = float (0,0,100)
#@gimp : Smooth scale 6 = float (0,0,100)
#@gimp : Smoothness = float (2,0,15)
#@gimp : Log scales = bool (0)
#@gimp : Global repeats = int (2,0,5)
#@gimp : Show difference = bool (0)
#@gimp : Sep = separator ()
#@gimp : Note = note("Author: Iain Fergusson - update 7 Dec 2012")
ms_smoothsmoothing:
-smooth {$1*5},0.7,0.7,0.6,$2,0.8,30,2,0,1
ms_smooth:
-if {$8==0}
lvl2=2
lvl3=3
lvl4=4
lvl5=5
lvl6=6
-endif
-if {$8==1}
lvl2=2
lvl3=4
lvl4=8
lvl5=16
lvl6=32
-endif
-repeat $9
-if {$1>0}
-ms_smoothsmoothing[-1] $1,$7
-endif
-name[0] full
--resize[full] @{full,w/$lvl2},@{full,h/$lvl2},1,{s},2 -name[1] level2
-if {$2>0}
--ms_smoothsmoothing[level2]  $2,$7
-else [level2]
-endif
-name[2] level2clean
--resize[level2] @{0,w},@{0,h},1,{s},5  -name[3] low2
--sub[full] [low2]  -name[4] level2high
-remove[level2,low2]
--resize[level2clean] @{full,w/$lvl3},@{full,h/$lvl3},1,{s},2 -name[3] level3
-if {$3>0}
--ms_smoothsmoothing[level3] $3,$7
-else [level3]
-endif
-name[4] level3clean
--resize[level3] @{level2clean,w},@{level2clean,h},1,{s},5  -name[5] low3
--sub[level2clean] [low3]  -name[6] level3high
-remove[level3,low3]
--resize[level3clean] @{full,w/$lvl4},@{full,h/$lvl4},1,{s},2 -name[5] level4
-if {$4>0}
--ms_smoothsmoothing[level4] $4,$7
-else [level4]
-endif
-name[6] level4clean
--resize[level4] @{level3clean,w},@{level3clean,h},1,{s},5  -name[7] low4
--sub[level3clean] [low4]  -name[8] level4high
-remove[level4,low4]
--resize[level4clean] @{full,w/$lvl5},@{full,h/$lvl5},1,{s},2 -name[-1] level5
-if {$5>0}
--ms_smoothsmoothing[level5] $5,$7
-else [level5]
-endif
-name[-1] level5clean
--resize[level5] @{level4clean,w},@{level4clean,h},1,{s},5  -name[-1] low5
--sub[level4clean] [low5]  -name[-1] level5high
-remove[level5,low5]
--resize[level5clean] @{full,w/$lvl6},@{full,h/$lvl6},1,{s},2 -name[-1] level6
-if {$6>0}
--ms_smoothsmoothing[level6]  $6,$7
-else [level6]
-endif
-name[-1] level6clean
--resize[level6] @{level5clean,w},@{level5clean,h},1,{s},5  -name[-1] low6
--sub[level5clean] [low6]  -name[-1] level6high
-remove[level6,low6]
-name[-2] base
-resize[base] @{level6high,w},@{level6high,h},1,{s},5
-add[base] [level6high]
-remove[level6high]
-resize[base] @{level5high,w},@{level5high,h},1,{s},5
-add[base] [level5high]
-remove[level5high]
-resize[base] @{level4high,w},@{level4high,h},1,{s},5
-add[base] [level4high]
-remove[level4high]
-resize[base] @{level3high,w},@{level3high,h},1,{s},5
-add[base] [level3high]
-remove[level3high]
-resize[base] @{level2high,w},@{level2high,h},1,{s},5
-add[base] [level2high]
-remove[level2high]
-keep[-1]
-c 0,255
-c 0,255
-done
ms_smooth_preview:
-if {$-1==0}
-ms_smooth $1,$2,$3,$4,$5,$6,$7,$8,$9
-endif
-if {$-1==1}
--ms_smooth $1,$2,$3,$4,$5,$6,$7,$8,$9
-sub[0] [1]
-keep[0]
-mul 2
-add 128
-endif
#@gimp Noise reduction 3 : nr3,nr3(0)
#@gimp : 1 strength = float (1,.25,4)
#@gimp : 2 threshold = float (1,.0,500)
#@gimp : 3 master detail recovery = float (0,0,2000)
#@gimp : 4 adjust fine details = float (0,-500,500)
#@gimp : 5 adjust medium details = float (0,-500,500)
#@gimp : 6 adjust large details = float (0,-500,500)
#@gimp : 7 enhance detials = float (1,0,5)
#@gimp : Sep = separator ()
#@gimp : Note = note("<b> sharpen edges</b>")
#@gimp : 8 radius = float (.75,.25,5)
#@gimp : 9 amount = float (1,0,4)
#@gimp : 10 threshold = float (0,0,5000)
#@gimp : Sep = separator ()
#@gimp : Note = note("<b> sharpen details</b>")
#@gimp : 11 radius = float (.75,.25,5)
#@gimp : 12 amount = float (1,0,4)
#@gimp : 13 threshold = float (0,0,5000)
#@gimp : Sep = separator ()
#@gimp : Note = note{"This filter is only intented for and has only been tested on greyscale images." }
#@gimp : Note = note{"This filter measures noise in at five different brightnesses, if your preview does not have a full range of brightness shown the preview will not give an accurate indication of the final results."}
#@gimp : Note = note("Author : <i>Iain Fergusson</i>.      Latest update : 11 November 2012 - minor quality improvements.")
med3stack16:
--max[0,1]
--min[0,1]
-keep[2,3,4]
--max[0,2]
--min[1,3]
-keep[-1]
med5stack16:
--min[0,1]
--max[0,1]
-remove[0,1]
--min[0,4]
--max[0,4]
-remove[0,4]
--min[0,4]
--max[0,4]
-remove[0,4]
--min[0,4]
--max[0,4]
-remove[0,4]
--min[0,1]
--max[0,1]
-remove[0,1]
--min[0,4]
--max[0,4]
-remove[0,4]
--min[0,4]
--max[0,4]
-remove[0,4]
--min[1,2]
--max[1,2]
-remove[1,2]
--max[1,4]
-keep[-1]
cross16:
--shift[0] 0,1,0,0,2
--shift[0] 0,-1,0,0,2
--shift[0] 1,0,0,0,2
--shift[0] -1,0,0,0,2
-med5stack16
ex16:
--shift[0] 1,1,0,0,2
--shift[0] 1,-1,0,0,2
--shift[0] -1,-1,0,0,2
--shift[0] -1,1,0,0,2
-med5stack16
hybrid16:
--cross16[0]
--ex16[0]
-med3stack16
autonr2:
--crop 30%,30%,70%,70%
noise0=@{-variance_noise}
-remove[-1]
cropwidth={w}
cropheight={h}
-resize[0] {w+(64-w%64)},{h+(64-h%64)},1,{s},0,1
width={w}
height={h}
-if {$noise0>$2}
-denoise[-1] 10,{$noise0*$1},3,5,0,1
-denoise[-1] 10,{$noise0*$1},3,5,0,1
-endif
--resize[0] {$width/2},{$height/2},1,{s},2,1
--resize[-1] $width,$height,1,{s},3,1
-sub[0] [-1]
-remove[-1]
noise1=@{-variance_noise}
-if {$noise1>$2}
-denoise[-1] 10,{$noise1*$1},3,5,0,0
-endif
--resize[-1] {$width/4},{$height/4},1,{s},2,1
--resize[-1] {$width/2},{$height/2},1,{s},3,1
-sub[1] [-1]
-remove[-1]
noise2=@{-variance_noise}
-if {$noise2>$2}
-denoise[-1] 10,{$noise2*$1},3,5,0,1
-endif
--resize[-1] {$width/8},{$height/8},1,{s},2,1
--resize[-1] {$width/4},{$height/4},1,{s},3,1
-sub[2] [-1]
-remove[-1]
noise3=@{-variance_noise}
-if {$noise3>$2}
-denoise[-1] 10,{$noise3*$1},3,5,0,1
-endif
-resize[-1] {$width/4},{$height/4},1,{s},3,1
-add[-2] [-1]
-remove[-1]
-resize[-1] {$width/2},{$height/2},1,{s},3,1
-add[-2] [-1]
-remove[-1]
-resize[-1] {$width/1},{$height/1},1,{s},3,1
-add[-2] [-1]
-remove[-1]
-crop 0,0,{$cropwidth-1},{$cropheight-1}
fft_tile3_fft:
--fftpolar[0]
100%,100%,1,1,1
-ellipse[-1] 50%,50%,50%,50%,0,1,$4
-ellipse[-1] 50%,50%,15%,15%,0,1,$5
-ellipse[-1] 50%,50%,5%,5%,0,1,$6
--add[1] [-1]
-threshold[-1] $1
-set[-1] 1,50%,50%
-mul[1] [-1]
--ifftpolar[1,2]
-remove[0,1,2]
-keep[-1]
fft_tile3_clean:
tc={round(w/$2)} tr={round(h/$2)}
-split_tiles $tc,$tr
-repeat @# -local[@{>,-1}]
-fft_tile3_fft[0--1] $1,$2,$3,$4,$5,$6
-endlocal -done
-append_tiles $tc,$tr
-c 0,255
fft_tile3:
--resize[0] {w+$2},{h+$2},1,1,0,1,1,1
-resize[-1] {w+$2},{h+$2},1,1,0,1,0,0
-fft_tile3_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] $2,$2,{w-$2-1},{h-$2-1}
push={round($2*1.5)}
pull={$2-$push}
--resize[0] {w+$push},{h+$2},1,1,0,1,1,1
-resize[-1] {w+$pull},{h+$2},1,1,0,1,0,0
-fft_tile3_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] {$push},{$2},{w-$pull-1},{h-($2)-1}
--resize[0] {w+$2},{h+$push},1,1,0,1,1,1
-resize[-1] {w+$2},{h+$pull},1,1,0,1,0,0
-fft_tile3_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] $2,{$push},{w-$2-1},{h-$pull-1}
dia1={round($2/3)}
dia2={$2-$dia1}
--resize[0] {w+$dia1},{h+$dia1},1,1,0,1,1,1
-resize[-1] {w+$dia2},{h+$dia2},1,1,0,1,0,0
-fft_tile3_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] {$dia1},{$dia1},{w-$dia2-1},{h-$dia2-1}
--resize[0] {w+$dia2},{h+$dia2},1,1,0,1,1,1
-resize[-1] {w+$dia1},{h+$dia1},1,1,0,1,0,0
-fft_tile3_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] {$dia2},{$dia2},{w-$dia1-1},{h-$dia1-1}
-remove[0]
-med5stack16
nr3:
-mul 256
radius={0.05*(min(h,w))}
[0]
-rectangle[-1] 0,0,100%,$radius,1,{ia}
-rectangle[-1] 0,0,$radius,100%,1,{ia}
-rectangle[-1] 0,100%,100%,{h-$radius},1,{ia}
-rectangle[-1] {w-$radius},100%,100%,0,1,{ia}
-blur[-1] {$radius/2}
xmin=@{-1,xm}
ymin=@{-1,ym}
-remove[-1]
--crop[0] {$xmin-$radius},{$ymin-$radius},{$xmin+$radius},{$ymin+$radius}
minnoise={(@{-variance_noise})}
-remove[-1]
--sub[0] {250*256}
-abs[-1]
-rectangle[-1] 0,0,100%,$radius,1,{ia}
-rectangle[-1] 0,0,$radius,100%,1,{ia}
-rectangle[-1] 0,100%,100%,{h-$radius},1,{ia}
-rectangle[-1] {w-$radius},100%,100%,0,1,{ia}
-blur[-1] {$radius/2}
xmax=@{-1,xm}
ymax=@{-1,ym}
--crop[0] {$xmax-$radius},{$ymax-$radius},{$xmax+$radius},{$ymax+$radius}
maxnoise={(@{-variance_noise})}
-remove[-1]
--sub[0] {128*256}
-abs[-1]
-rectangle[-1] 0,0,100%,$radius,1,{ia}
-rectangle[-1] 0,0,$radius,100%,1,{ia}
-rectangle[-1] 0,100%,100%,{h-$radius},1,{ia}
-rectangle[-1] {w-$radius},100%,100%,0,1,{ia}
-blur[-1] {$radius/2}
xave=@{-1,xm}
yave=@{-1,ym}
-remove[-1]
--crop[0] {$xave-$radius},{$yave-$radius},{$xave+$radius},{$yave+$radius}
midnoise={(@{-variance_noise})}
-text[-1] $midnoise,0,0,25,1,{iM}
--sub[0] {64*256}
-abs[-1]
-rectangle[-1] 0,0,100%,$radius,1,{ia}
-rectangle[-1] 0,0,$radius,100%,1,{ia}
-rectangle[-1] 0,100%,100%,{h-$radius},1,{ia}
-rectangle[-1] {w-$radius},100%,100%,0,1,{ia}
-blur[-1] {$radius/2}
xshadow=@{-1,xm}
yshadow=@{-1,ym}
-remove[-1]
--crop[0] {$xshadow-$radius},{$yshadow-$radius},{$xshadow+$radius},{$yshadow+$radius}
shadownoise={(@{-variance_noise})}
--sub[0] {192*256}
-abs[-1]
-rectangle[-1] 0,0,100%,$radius,1,{ia}
-rectangle[-1] 0,0,$radius,100%,1,{ia}
-rectangle[-1] 0,100%,100%,{h-$radius},1,{ia}
-rectangle[-1] {w-$radius},100%,100%,0,1,{ia}
-blur[-1] {$radius/2}
xbright=@{-1,xm}
ybright=@{-1,ym}
-remove[-1]
--crop[0] {$xbright-$radius},{$ybright-$radius},{$xbright+$radius},{$ybright+$radius}
brightnoise={(@{-variance_noise})}
shadows={(($minnoise/$shadownoise)*64)}
mids={(($minnoise/$midnoise)*64)}
brights={(($minnoise/$brightnoise)*64)}
whites={(($minnoise/$maxnoise)*64)}
point1={$shadows+32}
point2={$mids+$shadows+32}
point3={$brights+$mids+$shadows+32}
point4={$whites+$brights+$mids+$shadows+32}
-keep[0]
cropwidth={w}
cropheight={h}
-resize[0] {w+(64-w%64)},{h+(64-h%64)},1,{s},0,1
width={w}
height={h}
-apply_curve[0] 0,0,0,{32*256},{32*256},{96*256},{$point1*256},{160*256},{$point2*256},{223*256},{$point3*256},{287*256},{$point4*256}
-sub {128*256} -mul .5 -add {128*256}
--hybrid16[0]
-autonr2[-1] $1,$2
-autonr2[-1] $1,$2
--sub[0] [1]
-add[-1] {128*256}
-remove[0]
-div[-1] 256
-fft_tile3[-1] {2000-$3},48,0,$4,$5,$6,1
-mul[-1] 256
-sub[-1] {128*256} -mul[-1] $7 -add[-1] {128*256}
-unsharp[0] $8,$9,$10
-unsharp[1] $11,$12,$13
-sub[1] {128*256}
-add[0] [1]
-remove[1]
-sub {128*256} -mul 2 -add {128*256}
-apply_curve[0] 0,0,0,{32*256},{32*256},{$point1*256},{96*256},{$point2*256},{160*256},{$point3*256},{223*256},{$point4*256},{287*256}
-div 256
-c 0,255
-crop 0,0,{$cropwidth-1},{$cropheight-1}
#@gimp Noise reduction 5 : nr5,nr5_preview(0)
#@gimp : 1 luma denoise = float (1.6,0,10)
#@gimp : 2 colour denoie = float (5,0,20)
#@gimp : Sep = separator ()
#@gimp : 3 recover details = bool(1)
#@gimp : 4 amount = float (1,0.1,10)
#@gimp : Sep = separator ()
#@gimp : Note = note("<b> sharpen details</b>")
#@gimp : 5 radius = float (.75,.25,5)
#@gimp : 6 amount = float (3,0,10)
#@gimp : 7 threshold = float (0,0,100)
#@gimp : Sep = separator ()
#@gimp : Note = note("<b> sharpen edges</b>")
#@gimp : 8 radius = float (.75,.25,5)
#@gimp : 9 amount = float (.5,0,10)
#@gimp : 10 threshold = float (0,0,100)
#@gimp : Sep = separator ()
#@gimp : Note = note("<b>Advanced options</b>")
#@gimp : 11 base luma method = choice (1,"Wavelet","Multi-scale patch smoothing","Semi-auto MS patch","Median first MS patch","Multi Scale Median")
#@gimp : 12 chroma method = choice (1,"Wavelet","Multi-scale patch smoothing")
#@gimp : Sep = separator ()
#@gimp : 13 adjust fine details = float (100,-5000,500)
#@gimp : 14 adjust medium details = float (0,-5000,500)
#@gimp : 15 adjust large details = float (-100,-5000,500)
#@gimp : Sep = separator ()
#@gimp : Experimental curves = bool(0)
#@gimp : Gamma = float (1.3,.3,2)
#@gimp : Show noise = bool(0)
#@gimp : Sep = separator ()
#@gimp : Note = note("Author : <i>Iain Fergusson</i>.      Latest update : 28 November 2012 - added abiltity to view noise")
med3stack16:
--max[0,1]
--min[0,1]
-keep[2,3,4]
--max[0,2]
--min[1,3]
-keep[-1]
med5stack16:
--min[0,1]
--max[0,1]
-remove[0,1]
--min[0,4]
--max[0,4]
-remove[0,4]
--min[0,4]
--max[0,4]
-remove[0,4]
--min[0,4]
--max[0,4]
-remove[0,4]
--min[0,1]
--max[0,1]
-remove[0,1]
--min[0,4]
--max[0,4]
-remove[0,4]
--min[0,4]
--max[0,4]
-remove[0,4]
--min[1,2]
--max[1,2]
-remove[1,2]
--max[1,4]
-keep[-1]
fft_tile3_fft:
--fftpolar[0]
100%,100%,1,1,1
-ellipse[-1] 50%,50%,50%,50%,0,1,$4
-ellipse[-1] 50%,50%,15%,15%,0,1,$5
-ellipse[-1] 50%,50%,5%,5%,0,1,$6
--add[1] [-1]
-threshold[-1] $1
-set[-1] 1,50%,50%
-mul[1] [-1]
--ifftpolar[1,2]
-remove[0,1,2]
-keep[-1]
fft_tile3_clean:
tc={round(w/$2)} tr={round(h/$2)}
-split_tiles $tc,$tr
-repeat @# -local[@{>,-1}]
-fft_tile3_fft[0--1] $1,$2,$3,$4,$5,$6
-endlocal -done
-append_tiles $tc,$tr
-c 0,255
fft_tile3:
--resize[0] {w+$2},{h+$2},1,1,0,1,1,1
-resize[-1] {w+$2},{h+$2},1,1,0,1,0,0
-fft_tile3_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] $2,$2,{w-$2-1},{h-$2-1}
-if {$8>2}
push={round($2*1.5)}
pull={$2-$push}
--resize[0] {w+$push},{h+$2},1,1,0,1,1,1
-resize[-1] {w+$pull},{h+$2},1,1,0,1,0,0
-fft_tile3_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] {$push},{$2},{w-$pull-1},{h-($2)-1}
--resize[0] {w+$2},{h+$push},1,1,0,1,1,1
-resize[-1] {w+$2},{h+$pull},1,1,0,1,0,0
-fft_tile3_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] $2,{$push},{w-$2-1},{h-$pull-1}
-endif
-if {$8>1}
dia1={round($2/3)}
dia2={$2-$dia1}
--resize[0] {w+$dia1},{h+$dia1},1,1,0,1,1,1
-resize[-1] {w+$dia2},{h+$dia2},1,1,0,1,0,0
-fft_tile3_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] {$dia1},{$dia1},{w-$dia2-1},{h-$dia2-1}
--resize[0] {w+$dia2},{h+$dia2},1,1,0,1,1,1
-resize[-1] {w+$dia1},{h+$dia1},1,1,0,1,0,0
-fft_tile3_clean[-1] $1,$2,$3,$4,$5,$6
-crop[-1] {$dia2},{$dia2},{w-$dia1-1},{h-$dia1-1}
-endif
-remove[0]
-if {$8==3}
-med5stack16
-endif
-if {$8==2}
-med3stack16
-endif
nr5:
luma_strength=$1
colour_strength=$2
recovery=$3
detail_recovery={5000-($4*500)}
fine_detials=$13
medium_detials=$14
large_details=$15
detail_radius=$5
detail_amount=$6
detail_threshold=$7
edge_radius=$8
edge_amount=$9
edge_threshold=$10
quality=3
-if {$16==1}
-mul[0] 256
radius={0.05*(min(h,w))}
[0]
-rectangle[-1] 0,0,100%,$radius,1,{ia}
-rectangle[-1] 0,0,$radius,100%,1,{ia}
-rectangle[-1] 0,100%,100%,{h-$radius},1,{ia}
-rectangle[-1] {w-$radius},100%,100%,0,1,{ia}
-blur[-1] {$radius/2}
xmin=@{-1,xm}
ymin=@{-1,ym}
-remove[-1]
--crop[0] {$xmin-$radius},{$ymin-$radius},{$xmin+$radius},{$ymin+$radius}
minnoise={(@{-variance_noise})}
-remove[-1]
--sub[0] {250*256}
-abs[-1]
-rectangle[-1] 0,0,100%,$radius,1,{ia}
-rectangle[-1] 0,0,$radius,100%,1,{ia}
-rectangle[-1] 0,100%,100%,{h-$radius},1,{ia}
-rectangle[-1] {w-$radius},100%,100%,0,1,{ia}
-blur[-1] {$radius/2}
xmax=@{-1,xm}
ymax=@{-1,ym}
--crop[0] {$xmax-$radius},{$ymax-$radius},{$xmax+$radius},{$ymax+$radius}
maxnoise={(@{-variance_noise})}
-remove[-1]
--sub[0] {128*256}
-abs[-1]
-rectangle[-1] 0,0,100%,$radius,1,{ia}
-rectangle[-1] 0,0,$radius,100%,1,{ia}
-rectangle[-1] 0,100%,100%,{h-$radius},1,{ia}
-rectangle[-1] {w-$radius},100%,100%,0,1,{ia}
-blur[-1] {$radius/2}
xave=@{-1,xm}
yave=@{-1,ym}
-remove[-1]
--crop[0] {$xave-$radius},{$yave-$radius},{$xave+$radius},{$yave+$radius}
midnoise={(@{-variance_noise})}
-text[-1] $midnoise,0,0,25,1,{iM}
--sub[0] {64*256}
-abs[-1]
-rectangle[-1] 0,0,100%,$radius,1,{ia}
-rectangle[-1] 0,0,$radius,100%,1,{ia}
-rectangle[-1] 0,100%,100%,{h-$radius},1,{ia}
-rectangle[-1] {w-$radius},100%,100%,0,1,{ia}
-blur[-1] {$radius/2}
xshadow=@{-1,xm}
yshadow=@{-1,ym}
-remove[-1]
--crop[0] {$xshadow-$radius},{$yshadow-$radius},{$xshadow+$radius},{$yshadow+$radius}
shadownoise={(@{-variance_noise})}
--sub[0] {192*256}
-abs[-1]
-rectangle[-1] 0,0,100%,$radius,1,{ia}
-rectangle[-1] 0,0,$radius,100%,1,{ia}
-rectangle[-1] 0,100%,100%,{h-$radius},1,{ia}
-rectangle[-1] {w-$radius},100%,100%,0,1,{ia}
-blur[-1] {$radius/2}
xbright=@{-1,xm}
ybright=@{-1,ym}
-remove[-1]
--crop[0] {$xbright-$radius},{$ybright-$radius},{$xbright+$radius},{$ybright+$radius}
brightnoise={(@{-variance_noise})}
shadows={(($minnoise/$shadownoise)*64)}
mids={(($minnoise/$midnoise)*64)}
brights={(($minnoise/$brightnoise)*64)}
whites={(($minnoise/$maxnoise)*64)}
point1={$shadows+32}
point2={$mids+$shadows+32}
point3={$brights+$mids+$shadows+32}
point4={$whites+$brights+$mids+$shadows+32}
-keep[0]
## cropwidth={w}
## cropheight={h}
## -resize[0] {w+(64-w%64)},{h+(64-h%64)},1,{s},0,1
## width={w}
## height={h}
-apply_curve[0] 0,0,0,{32*256},{32*256},{96*256},{$point1*256},{160*256},{$point2*256},{223*256},{$point3*256},{287*256},{$point4*256}
-div[0] 256
-else
-apply_gamma {1/$17}
-endif
-rgb2ycbcr
-split c
-if {$1>0}
-if {$11==0}
--denoise_haar[0] $luma_strength,0,{$quality*10}
-endif
-if {$11==1}
--ms_patch[0] 10,{$luma_strength*2.5},3,5,0,1,1,0,{$luma_strength*.75},{$luma_strength*.5},{$luma_strength*0},{$luma_strength*0},1,1,1,0
-endif
-if {$11==2}
--autonr2[0] $luma_strength,1
-endif
-if {$11==3}
--median[0] 3
-ms_patch[-1] 10,{$luma_strength*2.5},3,5,0,1,1,0,{$luma_strength*.75},{$luma_strength*.5},{$luma_strength*0},{$luma_strength*0},1,1,1,0
-endif
-if {$11==4}
--msmed2[0] 3
-repeat $1
-msmed2[-1] 3
-done
-endif
--sub[0] [-1]
-add[-1] {128}
-remove[0]
-if {$recovery==1}
-resize[-1] {w+48},{h+48},{d},{s},0,0,0,0
-resize[-1] {w+48},{h+48},{d},{s},0,0,1,1
-rectangle[-1] 0,0,100%,48,1,128
-rectangle[-1] 0,0,48,100%,1,128
-rectangle[-1] 0,100%,100%,{h-48},1,128
-rectangle[-1] {w-48},100%,100%,0,1,128
-fft_tile3[-1] {$detail_recovery},48,0,$fine_detials,$medium_detials,$large_details,1,$quality
-crop[-1] 48,48,{w-49},{h-49}
-else
-fill[-1] 128
-endif
-unsharp[-1] $detail_radius,$detail_amount,$detail_threshold
-unsharp[2] $edge_radius,$edge_amount,$edge_threshold
-sub[-1] {128}
-add[2] [-1]
-remove[-1]
-else
-move[0] 3
-endif
-if {$2>0}
-median[0,1] 3
-median[0,1] 3
-if {$12==1}
-ms_patch[0] 10,1,3,5,0,1,1,0,{$colour_strength*1},{$colour_strength*.5},{$colour_strength*.25},{$colour_strength*0},0,1,1,0
-ms_patch[1] 10,1,3,5,0,1,1,0,{$colour_strength*1},{$colour_strength*.5},{$colour_strength*.25},{$colour_strength*0},0,1,1,0
-endif
-if {$12==0}
-denoise_haar[0] $colour_strength,0,{$quality*3}
-denoise_haar[1] $colour_strength,0,{$quality*3}
-endif
-endif
-move[-1] 0
-append c
-ycbcr2rgb
-if {16==1}
-mul[0] 256
-apply_curve[0] 0,0,0,{32*256},{32*256},{$point1*256},{96*256},{$point2*256},{160*256},{$point3*256},{223*256},{$point4*256},{287*256}
## -n 0,{256*256}
-div[0] 256
-else
-apply_gamma $17
-endif
-c 0,255
ms_patch_smoothing:
-ac "-repeat $7 -denoise $1,$2,$3,$4,$5,$6 -done",$8,0 -c 0,255
ms_patch_2:
--resize[0] 50%,50%,1,{s},2
--ms_patch_smoothing[-1] $1,$2,$3,$4,$5,$6,$7,$8
--resize[1] @{0,w},@{0,h},1,{s},5
--sub[0] [3]
-resize[2] @{0,w},@{0,h},1,{s},5
--add[2] [4]
-keep[-1]
-c 0,255
ms_patch_3:
--resize[0] 25%,25%,1,{s},2
--ms_patch_smoothing[-1] $1,$2,$3,$4,$5,$6,$7,$8
--resize[1] @{0,w},@{0,h},1,{s},5
--sub[0] [3]
-resize[2] @{0,w},@{0,h},1,{s},5
--add[2] [4]
-keep[-1]
-c 0,255
ms_patch_4:
--resize[0] 12.5%,12.5%,1,{s},2
--ms_patch_smoothing[-1] $1,$2,$3,$4,$5,$6,$7,$8
--resize[1] @{0,w},@{0,h},1,{s},5
--sub[0] [3]
-resize[2] @{0,w},@{0,h},1,{s},5
--add[2] [4]
-keep[-1]
-c 0,255
ms_patch_5:
--resize[0] 6.125%,6.125%,1,{s},2
--ms_patch_smoothing[-1] $1,$2,$3,$4,$5,$6,$7,$8
--resize[1] @{0,w},@{0,h},1,{s},5
--sub[0] [3]
-resize[2] @{0,w},@{0,h},1,{s},5
--add[2] [4]
-keep[-1]
-c 0,255
ms_patch:
-apply_gamma {1/$14}
-repeat $15
-if {$13==1}
-ms_patch_smoothing[-1] $1,$2,$3,$4,$5,$6,$7,$8
-endif
-if {$9>0.1}
-ms_patch_2 $1,$9,$3,$4,$5,$6,$7,$8
-endif
-if {$10>0.1}
-ms_patch_3 $1,$10,$3,$4,$5,$6,$7,$8
-endif
-if {$11>0.1}
-ms_patch_4 $1,$11,$3,$4,$5,$6,$7,$8
-endif
-if {$12>0.1}
-ms_patch_5 $1,$12,$3,$4,$5,$6,$7,$8
-endif
-done
-apply_gamma $14
-c 0,255
msmed2:
medlvl2=2
medlvl3=3
medlvl4=4
medlvl5=6
medlvl6=6
medlvl7=7
-median $1
-median $1
-name[0] full
--resize[full] @{full,w/$medlvl2},@{full,h/$medlvl2},1,{s},2
-name[-1] level2
--resize[level2] @{0,w},@{0,h},1,{s},3,1
-name[-1] low2
--compose_grainextract[full,low2]
-name[-1] level2high
-remove[low2]
-median[level2] $1
-median[level2] $1
-name[1] level2
--resize[level2] @{full,w/$medlvl3},@{full,h/$medlvl3},1,{s},2
-name[-1] level3
--resize[level3] @{level2,w},@{level2,h},1,{s},3,1
-name[-1] low3
--compose_grainextract[level2,low3]
-name[-1] level3high
-remove[1,low3]
-median[2] $1
-median[2] $1
-name[2] level3
--resize[level3] @{full,w/$medlvl4},@{full,h/$medlvl4},1,{s},2
-name[-1] level4
--resize[level4] @{level3,w},@{level3,h},1,{s},3,1
-name[-1] low4
--compose_grainextract[level3,low4]
-name[-1] level4high
-remove[2,low4]
-median[-2] $1
-median[-2] $1
-name[-2] base
-resize[base] @{level4high,w},@{level4high,h},1,{s},3,1
-compose_grainmerge[-1,-2]
-name[-1] base
-resize[base] @{level3high,w},@{level3high,h},1,{s},3,1
-compose_grainmerge[-1,-2]
-resize[-1] @{full,w},@{full,h},1,{s},3,1
-compose_grainmerge[-1,-2]
-keep[-1]
nr5_preview:
-if {$-1==0}
-nr5 $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17
-endif
-if {$-1==1}
--nr5 $1,$2,$3,$4,$5,0,$7,$8,0,$10,$11,$12,$13,$14,$15,$16,$17
-sub[0] [1]
-keep[0]
-mul 2
-add 128
-endif
#@gimp Savenoiseprint :  iain_savenoiseprint, iain_savenoiseprint_p(0)
#@gimp : Pass = choice ("pass 1 create noise print","pass 2 remove noise")
#@gimp : Detail threshold = float (1,0,5)
#@gimp : Gamma = float(1.4,1,4)
#@gimp : Note = note("This filter requires 2 images as input, the bottom image should be noisey and the top image should be the same image only with some kind of noise reduction.")
#@gimp : Note = note("You need to do 2 passes of this filter to get the results. The first pass analyses the residual noise and creates a noise print and saves it to your computer. On the 1st pass you can click apply and the noise print will be generated after a while. When that has finished switch to 2nd pass and adjust the Detail Threshold to your liking and hit okay or apply.")
#@gimp : Note = note("<b> Set output mode to 'New Layers'</b>")
iain_savenoiseprint_p:
-if {$1==0}
-text "creating noiseprint",0,0,50,1,255
-elif {$1==1}
-iain_savenoiseprint[0,1] $1,$2,$3
-endif
iain_savenoiseprint:
-remove_opacity
-rgb2yuv8
-split c
-remove[-1,-2]
-l[0,3]
-apply_parallel_overlap[0] "-mul {1/255} -pow $3 -mul 255 ",0,0
-apply_parallel_overlap[1] "-mul {1/255} -pow $3 -mul 255 ",0,0
--sub[1] [0]
-add[-1] 128
-l[-1]
-if {$1==0}
--l
size=48
cropwidth={w}
cropheight={h}
-resize[0] {w+($size-w%$size)},{h+($size-h%$size)},1,{s},0,1
tc={round(w/$size)} tr={round(h/$size)}
-l[0]
-split_tiles $tc,$tr
-repeat @# -local[@{>,-1}]
-fftpolar[0]
-append[0,1] z
-endl -done
-median_median
-endl
-o noiseprint.cimg
-rm
-endl
-elif {$1==1}
size=48
cropwidth={w}
cropheight={h}
-resize[0] {w+($size-w%$size)},{h+($size-h%$size)},1,{s},0,1
tc={round(w/$size)} tr={round(h/$size)}
-i noiseprint.cimg
-mul[-1] $2
--l[0,1]
-split_tiles[0] $tc,$tr
-repeat {@#-1}
-l[@{>,-1},-1]
[-1]
-l[0,1]
-fftpolar[0]
-l[0,-1]
-split[1] z
-rm[-1]
--gt[0] [1]
-circle[-1] 50%,50%,1%,1,1
-mul[0] [-1]
-keep[0]
-endl
-ifftpolar
-endl
-endl
-done
-rm[-1]
-append_tiles $tc,$tr
-endl
--l[0,1]
-shift[0] 16,16,0,0
-split_tiles[0] $tc,$tr
-repeat {@#-1}
-l[@{>,-1},-1]
[-1]
-l[0,1]
-fftpolar[0]
-l[0,-1]
-split[1] z
-rm[-1]
--gt[0] [1]
-circle[-1] 50%,50%,1%,1,1
-mul[0] [-1]
-keep[0]
-endl
-ifftpolar
-endl
-endl
-done
-rm[-1]
-append_tiles $tc,$tr
-shift[0] -16,-16,0,0
-endl
-l[0,1]
-shift[0] 32,32,0,0
-split_tiles[0] $tc,$tr
-repeat {@#-1}
-l[@{>,-1},-1]
[-1]
-l[0,1]
-fftpolar[0]
-l[0,-1]
-split[1] z
-rm[-1]
--gt[0] [1]
-circle[-1] 50%,50%,1%,1,1
-mul[0] [-1]
-keep[0]
-endl
-ifftpolar
-endl
-endl
-done
-rm[-1]
-append_tiles $tc,$tr
-shift[0] -32,-32,0,0
-endl
-iain_fast_median_stack
-crop 0,0,{$cropwidth-1},{$cropheight-1}
-c 0,255
-endif
-endl
-sub[-1] 128
-add[0] [-1]
-keep[0]
-apply_parallel_overlap[0] "-mul {1/255} -pow {1/$3} -mul 255 ",0,0
-endl
-append c
-yuv82rgb
-c 0,255
-if {$1==0}
-rm
-endif
median_median:
-repeat {@#/3-(@#%3)}
-l[@{>,-1},{@{>,-1}+1},{@{>,-1}+2}]
-iain_fast_median_stack
-endl
-done
-repeat {@#/3-(@#%3)}
-l[@{>,-1},{@{>,-1}+1},{@{>,-1}+2}]
-iain_fast_median_stack
-endl
-done
-repeat {@#/3-(@#%3)}
-l[@{>,-1},{@{>,-1}+1},{@{>,-1}+2}]
-iain_fast_median_stack
-endl
-done
num=@#
-add
-div $num
#@gimp Skin mask : iain_gimp_skin_mask,iain_gimp_skin_mask_pr
#@gimp : Note = note("<b>Main Controls</b>")
#@gimp : Magenta ratio = float (55,0,255)
#@gimp : Cyan ratio = float (200,2,255)
#@gimp : Sep = separator()
#@gimp : Note = note("<b>Refine Hue Range</b>")
#@gimp : Remove reds = float (0,0,255)
#@gimp : Remove yellows = float(0,0,100)
#@gimp : Sep = separator()
#@gimp : Output = choice ("Masked Image","Just the Mask")
#@gimp : Preview shows = choice (1,"Output","Highlighted Mask")
#@gimp : Sep = separator()
#@gimp : Note = note("Skin mask uses CMYK colour model to selct skin tones. Skin tones generally have a predictable ratios of Cyan, Magetna and Yellow. Different ethnicies have slighty different ratios. ")
#@gimp : Note = note("<small><b>Magenta Ratio:</b> This sets how much the Magenta content is allowed to be below the Yellow content. Increase to include dark skin tones and shadows.</small>")
#@gimp : Note = note("<small><b>Cyan Ratio:</b> This set the how much the Cyan content is allowed to be below the Yellow content. Increase to include pale skin tones and highlights.</small>")
#@gimp : Note = note("<small><b>Refine Hue Range:</b> This allows you to remove tones that pass through the main controls but are not present in your subject.</small>")
#@gimp : Sep = separator()
#@gimp : Note = note("<small>Author : <i>Iain Fergusson</i>.</small>")
iain_gimp_skin_mask_pr:
-if {$6==0}
-iain_skin_mask $1,$2,$3,$4,$5
-elif {$6==1}
--iain_skin_mask $1,$2,$3,$4,1
-n[-1] 0.6,1
-mul
-endif
iain_gimp_skin_mask:
-tic
-apply_parallel_overlap[0] "-iain_skin_mask[0] ${1--1}",0,0
-toc
iain_skin_mask:
dark={$1}
pale={255-$2}
red={255-$3}
yellow={255-$4}
-to_rgb
[0]
[0]
[0]
-l[1]
-if {$3>0}
red={255-$3}
-fill if(i(x,y,z,0)-i(x,y,z,1)<{$red},i,0)
-gt 0
-else
-fill 1
-endif
-endl
-l[2]
-rgb2cmyk
dark={$1}
pale={255-$2}
-fill if(i(x,y,z,2)>i(x,y,z,1),if(i(x,y,z,2)-i(x,y,z,1)<{$dark},if((i(x,y,z,0)+{$pale})<i(x,y,z,2),i,255),255),255)
-cmyk2rgb
-gt 0
-endl
-l[3]
-if {$4>0}
yellow={255-$4}
-rgb2hsv
-split c
-keep[0]
-add[0] 180
-mod[0] 360
-lt[0] $yellow
-else
-fill 1
-endif
-endl
-mul[1,2,3]
-mul[1] 255
-channels[1] 0
-if {$5}
-keep[1]
-else
-append c
-endif
#@gimp Smart demosaic : iain_smartdemos, iain_smartdemos(0)
#@gimp : Starting pattern = choice(0,"Red-Green","Blue-Green","Green-Red","Green-Blue")
#@gimp : Blurradius = float (1.5,.5,3)
#@gimp : Wrong way--zippers = float (2,0,5)
iain_smartdemos:
cropwidth={w}
cropheight={h}
-resize[0] {w+(64-w%64)},{h+(64-h%64)},{d},{s},0,2
-apply_parallel_overlap "
-to_rgb
-add 1000
-rgb2bayer[0] $1,1
--l[0]
--l[0]
-split c
-l[0,2]
(0,0,.5;0,1,0;0.5,0,0)
-convolve[0] [-1]
-convolve[1] [-1]
-rm[-1]
(0,0,.25;0,.5,0;0.25,0,0)
-convolve[0] [-1]
-convolve[1] [-1]
-rm[-1]
-endl
-endl
-split[0] c
-name[0] red -name[1] green -name[2] blue
-name[3] redblur -name[4] greenblur -name[5] blueblur
--div[redblur] [blueblur]
-replace_nan 0
--mul[blue] [-1]
-add[-1] [red]
--div[blueblur] [redblur]
-replace_nan 0
--mul[red] [-1]
-add[-1] [blue]
-keep[1,-1,-3]
-reverse[0,1]
-append c
-endl
-l[0]
--l[0]
-split c
-l[0,2]
(0.5,0,0;0,1,0;0,0,0.5)
-convolve[0] [-1]
-convolve[1] [-1]
-rm[-1]
(0.25,0,0;0,.5,0;0,0,0.25)
-convolve[0] [-1]
-convolve[1] [-1]
-rm[-1]
-endl
-endl
-split[0] c
-name[0] red -name[1] green -name[2] blue
-name[3] redblur -name[4] greenblur -name[5] blueblur
--div[redblur] [blueblur]
-replace_nan 0
--mul[blue] [-1]
-add[-1] [red]
--div[blueblur] [redblur]
-replace_nan 0
--mul[red] [-1]
-add[-1] [blue]
-keep[1,-1,-3]
-reverse[0,1]
-append c
-endl
--l[0]
(.33,0,0,0,0;0,.66,0,0,0;0,0,-2,0,0;0,0,0,.66,0;0,0,0,0,.33)
-convolve[0] [1]
-rm[1]
-abs
-split c
-rm[1]
-max
-endl
--l[1]
(0,0,0,0,.33;0,0,0,.66,0;0,0,-2,0,0;0,.66,0,0,0;.33,0,0,0,0)
-convolve[0] [1]
-rm[1]
-abs
-split c
-rm[1]
-max
-endl
-blur[-1,-2] 2
-sub[-1,-2]
-gt[-1] 0
-mul[-1] 255
-append[1,2] c
-blend alpha,1,0
--l[0]
-split[0] c
-add[0,2]
-mul[0] 0.5
-reverse
## -remove[-2,-4]
-nm[0] green -nm[1] magenta
[0] [1]
-nm[-2] greenblur -nm[-1] mblur
(0.25;.5;0.5;.5;0.25)
-convolve[mblur] [-1] -rm[-1]
(0.5;1;0.5)
-convolve[greenblur] [-1]
-rm[-1]
--div[greenblur] [mblur]
-replace_nan 0
-nm[-1] mmul
-rm[greenblur,mblur]
-mul[magenta] [mmul]
-keep[green,magenta]
-add
-endl
--l[0]
-split[0] c
-add[0,2]
-mul[0] 0.5
-reverse
## -remove[-2,-4]
-nm[0] green -nm[1] magenta
[0] [1]
-nm[-2] greenblur -nm[-1] mblur
(0.25,.5,0.5,.5,0.25)
-convolve[mblur] [-1] -rm[-1]
(0.5,1,0.5)
-convolve[greenblur] [-1]
-rm[-1]
--div[greenblur] [mblur]
-replace_nan 0
-nm[-1] mmul
-rm[greenblur,mblur]
-mul[magenta] [mmul]
-keep[green,magenta]
-add
-endl
-sub 1000
-c 0,255
--l[0,1]
-rgb2bayer[0] $1,1
--to_rgb[1]
-rgb2bayer[-1] $1,1
-split[0] c
-split[-1] c
-sub[0] [4]
-sub[2] [6]
(0.25,0.5,0.25;0.5,1,0.5;0.25,0.5,0.25)
-convolve[0] [-1]
-convolve[2] [-1]
-remove[-1]
-add[0] [3]
-add[2] [3]
-remove[1,4,5,6]
-reverse[1,2]
-append c
-endl
-l[0,2]
-rgb2bayer[0] $1,1
--to_rgb[1]
-rgb2bayer[-1] $1,1
-split[0] c
-split[-1] c
-sub[0] [4]
-sub[2] [6]
(0.25,0.5,0.25;0.5,1,0.5;0.25,0.5,0.25)
-convolve[0] [-1]
-convolve[2] [-1]
-remove[-1]
-add[0] [3]
-add[2] [3]
-remove[1,4,5,6]
-reverse[1,2]
-append c
-endl
-rm[1]
-replace_inf 255
-replace_nan 0
-reverse
-l[0]
--blur $2
-sub[0] [1]
-add[0] 128
-endl
-l[2]
--blur $2
-sub[0] [1]
-add[0] 128
-endl
-l[0,2]
-nozip $3
-endl
-l[-1,-2]
--l[0]
--l
-split c
-add
-div 3
-endl
-sub
--blur 3
-sub
-abs
-split c
-max
-endl
--l[1]
--l
-split c
-add
-div 3
-endl
-sub
--blur 3
-sub
-abs
-split c
-max
-endl
-l[-1,-2]
-blur 2
-sub
-gt 0
-mul 255
-endl
-append[1,2] c
-blend alpha,1,0
-endl
-sub[0] 128
-add
-c 0,255
",16,0
-crop 0,0,{$cropwidth-1},{$cropheight-1}
time=@|
#@gimp Spot mask : spot_mask,spot_mask_preview(0)
#@gimp : Spot size = float (4,1,10)
#@gimp : Threshold = float (80,0,100)
#@gimp : Mask dilation = int (5,0,10)
spot_mask:
-to_gray[-1]
--resize[0] {w/$1},{h/$1},1,3,2
--iain_pixel_denoise[-1] 1,0
-sub[-1] [-2]
-abs[-1]
-remove[1]
-threshold[-1] $2%
-to_gray[-1]
-dilate_circ[-1] $3
-n 0,255
-resize[-1] @{0,w},@{0,h},1,3,3
-keep[-1]
spot_mask_preview:
--spot_mask $1,$2,$3
-n[-1] 0,255
-add[0] [1]
-keep[0]
-n 0,255
#@gimp Star tone : star_tone, star_tone(0)
#@gimp : Scale = float(100,10,200)
star_tone:
sx1=50
sx2=194
sx3=281
sx4=511
sx5=742
sx6=829
sx7=972
sx8=829
sx9=742
sx10=511
sx11=281
sx12=192
sy1=450
sy2=633
sy3=849
sy4=817
sy5=849
sy6=633
sy7=450
sy8=267
sy9=50
sy10=83
sy11=50
sy12=267
level=10
-luminance
--l
-rm
2000,2000,1,1,0
-repeat 8
-polygon 12,$sx1,$sy1,$sx2,$sy2,$sx3,$sy3,$sx4,$sy4,$sx5,$sy5,$sx6,$sy6,$sx7,$sy7,$sx8,$sy8,$sx9,$sy9,$sx10,$sy10,$sx11,$sy11,$sx12,$sy12,1,$level
sx2={$sx2+40}
sx6={$sx6-40}
sx8={$sx8-40}
sx12={$sx12+40}
sy2={$sy2-23}
sy4={$sy4-47}
sy6={$sy6-23}
sy8={$sy8+23}
sy10={$sy10+47}
sy12={$sy12+23}
level={$level+25}
-done
-n 0,255
-resize 200,200,1,1,3
--shift[0] -69,-40,0,0
--shift[0] -69,40,0,0
--shift[0] 69,-40,0,0
--shift[0] 69,40,0,0
-add
-crop 5,5,142,84
-endl
-resize[-1] $1,$1,1,1,2
width=@{-1,w}
height=@{-1,h}
w_tiles={round(@{0,w}/$width)}
h_tiles={round(@{0,h}/$height)}
total_tiles=$h_tiles*$w_tiles
[-1]x{$total_tiles-1}
-append_tiles[1--1] $w_tiles,$h_tiles
-equalize[-1] 256
-blend alpha,0.5,1
-gt 128
-mul 255
#@gimp Turbulent halftone : iain_turbulent_halftone_preview, iain_turbulent_halftone(0)
#@gimp : Amplitude = float(15,0,30)
#@gimp : Smoothness = float(20,0,40)
#@gimp : Orientation = float(0,0,180)
#@gimp : Deviation = float(1,0,1)
#@gimp : Tile size = int(512,128,2048)
#@gimp : Blur = float(0.75,0,4)
#@gimp : Colour model = choice("RGB","CMYK","Luminance")
#@gimp : Enhance detail = float(0,0,10)
iain_turbulent_halftone:
-if {$8>0}
--iain_fast_denoise $8,0,1,0,0
-sub[1] [0]
-mul[1] -1
-add
-endif
-if {$7==1}
-rgb2cmyk
-endif
-if {$7==2}
-luminance
-endif
-split c
-repeat @# -local[@{>,-1}]
--l[0]
-channels 0
tsize={min($5,w,h)}
xtile={(round(w/$tsize))+1}
ytile={(round(h/$tsize))+1}
$tsize,$tsize
-gimp_seamless_turbulence[-1] $1,$2,$3,$4,.25,0
[-1]x{$xtile*$ytile}
-append_tiles[1--1] $xtile,$ytile
-remove[-1]
-crop[-1] 0,0,@{0,w},@{0,h}
-keep[-1]
-endl
-blur[-1] $6
-equalize[-1] 256
-blend alpha,0.5,1
-gt 128
-mul 255
-endlocal -done
-append c
-if {$7==1}
-cmyk2rgb
-endif
iain_turbulent_halftone_preview:
-iain_turbulent_halftone $1,$2,$3,$4,@{0,w},$6,$7,$8
#@gimp _
#@gimp <i>J&#233;j&#233;</i>
#@gimp 3d rendering : jeje_render3d, jeje_render3d_preview
#@gimp : Input image = file()
#@gimp : Size = int(8,4,16)
#@gimp : Quality = int(6,2,16)
#@gimp : Opacity = float(0.1,0,1)
#@gimp : Angle x = float(240,0,360)
#@gimp : Angle y = float(0,0,360)
#@gimp : Angle z = float(30,0,360)
#@gimp : Zoom = float(1,0,3)
#@gimp : Top color = color(32,32,64,255)
#@gimp : Bottom color = color(64,128,96,255)
#@gimp : Render = bool(false)
#@gimp : Sep = separator(), note = note(<b>Note:</b>Adjust the 3D view first and then enable render to compute the volume rendering.)
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>. Latest update: <i>2013/05/29</i>.</small>")
jeje_render3d:
W=@{0,w}
1,2,1,4 -f[-1] $9,$13,$10,$14,$11,$15,$12,$16 -resize[-1] @{0,w},@{0,h},1,4,5
-blend alpha
-i $1 -a[1--1] z
-l[-1]
-if $17 -display_volume $2,$3,$4 -else  -boundingbox3d 20 -endif
-rotate3d 0,0,1,$7
-rotate3d 0,1,0,$6
-rotate3d 1,0,0,$5
-c3d -n3d -*3d {3*$W*$8/4}
-endl
-object3d[0] [1],50%,50%,0,1
-n 0,255
-rm[1]
jeje_render3d_preview:
-jeje_render3d $*
#@gimp Deconvolve : jeje_deconvolve, jeje_deconvolve_preview
#@gimp : Iterations = int(20,1,100)
#@gimp : Algorithm = choice(0,"Richardson-Lucy","Gold-Meinel")
#@gimp : Channel(s) = choice(3,"All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Alpha","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>J&#233;r&#244;me Boulanger</i>. Latest update: <i>2014/01/27</i>.</small>")
jeje_deconvolve:
-reverse
-if {$2==1}
-apply_channels_old "-deconvolve_goldmeinel $1 -n[0] 0,255",$3,0
-else
-apply_channels_old "-deconvolve_richardsonlucy $1 -n[0] 0,255",$3,0
-endif
jeje_deconvolve_preview:
-gimp_split_preview "-jeje_deconvolve $1,$2,$3",$4
#@gimp _
#@gimp <i>Jayprich</i>
#@gimp About : _none_, jpr_about
#@gimp : Note = note{"@jayprich filters for <b>G'MIC</b>\nare proposed to you by James Prichard"}
#@gimp : Note = note{"source code http://www.h-ps.demon.co.uk/GMIC/jayprich.gmic"}
jpr_about : -gimp_logo "@jayprich filters"
#@gimp Jpr colourillusion : jpr_colourillusion,jpr_colourillusion(1)
#@gimp : Note = note("recreated from a Java example http://fiji.sc/wiki/ see Spirals Macro")
#@gimp : Arms = int(2,2,10)
#@gimp : Scale = float(25,10,50)
#@gimp : Updateauthornote = note("<small>update 2013-Feb-06 author @jayprich</small>")
jpr_colourillusion :
-v -
arm={$1*1.5-1}
{w},{h},1,1,A=10+atan2(x-{w/2},y-{h/2})*$arm/pi;R=sqrt((x-{w/2})^2+(y-{h/2})^2)/$2+A;(int(A+R/$arm)+int(R*6-A/$arm)%2)%3
(250,200,0^20,200,190^160,100,150)
-map[-2] [-1]
-k[-2]
-v +
#@gimp Jpr coltexindex : jpr_coltexindex,jpr_coltexindex(1)
#@gimp : Note = note{"Index the image using its colour channels plus the local analysis of its luminance channel."}
#@gimp : Note = note{"Inspired by questions on masking for similar textures and how to make poster art from a photo."}
#@gimp : Note = note{"Watch out for JPEG block-artifacts in colour channels"}
#@gimp : Number of types = int(5,3,20)
#@gimp : X1 = float(55,0,100)
#@gimp : Y1 = float(55,0,100)
#@gimp : X1 = float(45,0,100)
#@gimp : Y2 = float(45,0,100)
#@gimp : Factor (x1,y1) vs (x2,y2) = float(1,0,5)
#@gimp : Display (x,y) = bool(1)
#@gimp : Sep =separator(),note = note{"<small>Luminance Y</small>"}
#@gimp : Smoothness = float(0,0,5)
#@gimp : Black = float(0.05,0,1)
#@gimp : Midtone = float(0.5,0,1)
#@gimp : Highlight = float(0.95,0,1)
#@gimp : Sep =separator(),note = note{"<small>Colour &amp; Texture</small>"}
#@gimp : Colour smoothing = float(0.5,0,5)
#@gimp : Sep =separator(),note = note{"<small>Locally Average Gradient Norm or Variance from Luminance</small>"}
#@gimp : Use gradient norm = bool(1)
#@gimp : Local size = float(2,1,9)
#@gimp : Weight = float(0.7,0.2,2)
#@gimp : Updateauthornote = note("<small>update 2013-Mar-17 author @jayprich</small>")
jpr_coltexindex : -skip ${7=1}
-e[^-1] "Index colour and texture of image$? with $1 types ($2,$3) v ($4,$5) x $6 and Smoothness $8 Black $9 Mid $10 White $11"
-v -
-repeat @#
-l[$<]
-rgb2yuv -s c
--b[-3] $8
--ge[-1] $10
--le[-2] $11
-ge[-3] $9
-b[-5,-4] $12
-if $13
-gradient[-6] xy,4
-a[-7,-6] c
-norm[-6]
-b[-6] $14
-else
--b[-6] {$14*0.5}
--[-7,-1]
-sqr[-6]
-b[-6] {$14}
-sqrt[-6]
-endif
-n[-6] 0,1
-*[-6] $15
---[-6] {@{-6,i(0.01*w*$2,0.01*h*$3)}}
-*[-1] {@{-1,i(0.01*w*$4,0.01*h*$5)}}
---[-6] {@{-6,i(0.01*w*$2,0.01*h*$3)}}
-*[-1] {@{-1,i(0.01*w*$4,0.01*h*$5)}}
-+[-2,-1]
---[-5] {@{-5,i(0.01*w*$2,0.01*h*$3)}}
-*[-1] {@{-1,i(0.01*w*$4,0.01*h*$5)}}
-+[-2,-1]
-/[-1] {@{-1,i(0.01*w*$4,0.01*h*$5)}+0.00001}
-c[-1] 0,1
-*[-1] $6
-a[-7--5,-1] c
--[-4] 2
-*[-4,-1]
-+[-3] 2
-*[-3,-2]
--colormap[-2] $1,1,1
-index[-3] [-1]
-rm[-1]
-*[-2] 2
-+[-2,-1]
-n 0,255
-to_rgb
-if $7
-circle $2%,$3%,1%,1,,64,128,255
-circle $4%,$5%,1%,1,,255,64,128
-endif
-endl
-done
-v +
#@gimp Jpr decimate : jpr_decimate,jpr_decimate(1)
#@gimp : Note = note{"Rescale in linear RGB space by cropping the frequency domain weighted"}
#@gimp : Note = note{"to decrease high frequency akin to Lanczos window on Sinc lobes."}
#@gimp : Note = note{"This filter may corrupt the alpha channel"}
#@gimp : Note = note{"High sharpness just crops frequency and gives bad halo"}
#@gimp : Downsample scale = float(0.375,0.1,1)
#@gimp : Sharpness factor = float(2,1.5,4)
#@gimp : Updateauthornote = note("<small>update 2013-Jun-24 author @jayprich</small>")
jpr_decimate : -skip ${1=0.375},${2=5}
-e[^-1] "Decimate scale $1 sharpness $2"
-v -
-srgb2rgb
-repeat @#
-l[$<]
nw={round($1*w/2)}
nh={round($1*h/2)}
sc={4*$nw/w*$nh/h}
mid={round(0.5/$1-0.5)}
-shift -$mid,-$mid
-fft
-shift $nw,$nh,0,0,2
-z 0,0,{2*$nw-1},{2*$nh-1}
-shift -$nw,-$nh,0,0,2
-f i*min(1,abs(2*x/w-1)*$2)*min(1,abs(2*y/h-1)*$2)
-ifft
-rm[-1]
-* $sc
-endl
-done
-rgb2srgb
-v +
tiff3d : -e[^-1] "Load the file $1 as a 3D image"
-v - n=@#
-i $1 -a[{$n}--1] z
-v +
toff3d : -e[^-1] "Save the 3D image as a tiff file"
-v -
-repeat @#
-o[$>] @{"-filename \"$1\","$>}
-done
-v +
boundingbox3d : -skip ${1=10}
-e[^-1] "3D Bounding box"
-repeat @# -l[$>]
-box3d @{0,w},@{0,h},@{0,d} -primitives3d[-1] 1  -opacity3d[-1] .1
-if {$1>0}
-plane3d @{0,w},@{0,h},$1,{round(@{0,h}/@{0,w}*$1)} -primitives3d[-1] 1 -opacity3d[-1] .1
-endif
-rm[0]
-+3d
-endl -done
rendervolumeold: -skip ${1=8},${2=5},${3=.1}
-e[^-1] "Pseudo volumic rendering of image with size $1 quality $2 and opactiy $3"
-v - -repeat @# -l[$>]
-mirror x
-repeat $2 --l[0]
--threshold2 {($>+1)/($2+1)*(iM-im)+im},{($>+2)/($2+1)*(iM-im)+im+1}
-*[-2,-1]
-if {im!=iM} -pointcloud3d -gaussians3d $1,{$3*($<+1)/$2} -else -rm -endif
-endl -done -rm[0] -+3d -md3d -1  -+3d {.5},{.5},{.5}
-endl -done -v +
render_volume: -check "${1=8}>3&${2=5}>2&${3=.1}>0"
-v - -repeat @# -l[$>]
-mirror x
--tones {$2+1} -rm[1,2] -r[1--1] 100%,100%,100%,@{0,s} -*[1--1] [0] -rm[0]
-reverse
-repeat @# i=$< -l[$<]
-if {im!=iM}
-pointcloud3d -gaussians3d $1,{$3*($i+1)/$2}
-else
-rm
-endif
-endl -done
-+3d -md3d -1 -+3d {.5},{.5},{.5}
-endl -done -v +
display_volume: -check "${1=8}>3&${2=5}>2&${3=.1}>0"
-e[^-1] "display_volume with size $1 quality $2 and opactiy $3"
-v -
--boundingbox3d 20
-render_volume[0] $1,$2,$3
-+3d
-v +
d3d_black : 1 -d3d[0--2] [-1] -rm[-1]
view3d : -skip ${1=25},${2=-120}
-e[^-1] "Apply 3D view"
-v - -repeat @# -l[$>]
-rotate3d 0,0,1,$1 -rotate3d 1,0,0,$2
-endl -done -v +
colordepth: -skip ${1=5}
-e "colordepth coding with lut $1"
-v - -repeat @# -l[$>]
-_colordepth_volume $1 -s z -+
-endl -done -v +
_colordepth_volume: -skip ${1=5}
-v - -repeat @# -l[$>]
-i [0] -f[-1] 'z/(d-1)*255' -map[-1] $1 -resize[0] 100%,100%,100%,3 -*
-endl -done -v +
colordepth_scale: -skip ${1=5}
10,@{0,h-10} -f[-1] '(h-y)/(h-1)*255' -map[-1] $1 -frame[-1] 5,5,0,0,0
make_axis:
-v - -repeat @# -l[$>]
-frame 1,1,0
100%,24,1,3,255 -axes[-1] $1,$2,{-1},{-1}
24,@{0,h},1,3,255 -axes[-1] {w},{w},$4,$3 24,24,1,3,255 -a[-1,-2] y
-a[0,1] y -reverse -a[0,1] x
-frame 12,12,255 100%,5,1,3,255,255,255 -reverse -a y
-endl -done -v +
xlabel:
-e[^-1] "Add a x label"
-v - -repeat @# -l[$>]
0 -text[-1] "$1",0,0,18,1,255,255,255 -negative[-1] --lt[-1] 90%
-image[0] [-2],{@{0,w}/2-@{1,w}/2},{@{0,h}-@{1,h}},0,0,1,[-1] -k[0]
-endl -done -v +
ylabel:
-e[^-1] "Add a y label"
-v - -repeat @# -l[$>]
0 -text[-1] "$1",0,0,18,1,255,255,255 -negative[-1] -rotate[-1] -90 --lt[-1] 90%   -image[0] [-2],0,{@{0,h}/2-@{1,h/2}},0,0,1,[-1] -k[0]
-endl -done -v +
title:
-e[^-1] "Add a title"
-v - -repeat @# -l[$>]
0 -text[-1] "$1",0,0,18,1,255,255,255 -negative[-1] --lt[-1] 90%
-image[0] [-2],{@{0,w}/2-@{1,w}/2},0,0,0,1,[-1] -k[0]
-endl -done -v +
quiver2d:
-e[^-1] "Cumulative sum along z-axis"
-s z -repeat {@#/2} -l[$>,{$>+@#/2}] -quiver[0] [1],10,1,1,1,255 -endl -done -rm[{@#/2}--1] -a z
warp2d:
-s z -repeat {@#/2} -l[$>,{$>+@#/2}] -warp[0] [1],1,1,1 -endl -done -rm[{@#/2}--1] -a z
lucas_kanade: -skip ${1=2},${2=1}
-e[^-1] "Motion estimation with Lucas et Kanade algorithm"
-v - -repeat @# -l[$>]
-blur_xy $2 -structuretensors 0 -blur_xy $1,$1,0
--l -s c -rm[0,-1] -*[1,2] -*[0,2] -reverse -- -endl
--l[0] -s c -rm[3,5] -*[0,3] -*[1,2] -- -endl
-l[0] -s c -rm[2,4,5] -*[0,2] -sqr[1] -- -endl
-/[1,2] [0]  -rm[0] -a c
-endl -done -v +
unwarp: -skip ${3=1}
-e[^-1] "Unwarp an 2d+t volume"
-v - -repeat @# -l[$>]
[0] 100%,100%,100%,2,0
-repeat $1
-if {$3==0} s=1 -else  s={($>+1)/$1} -endif  scale={$s*100}%
--l[1]
-luminance -r $scale,$scale,100%,1,2 -lucas_kanade {max(.75,$2*$s)}
-* {1/$s} -zcumsum
-endl
-r[-1] [-2],5  -+[-1,-2]
--l[0,-1] -warp2d -endl -rm[1] -reverse[-1,-2]
-done -rm[0,2]
-endl -done -v +
estimate_shift_core:
-e[^-1] "Translation estimation with Lucas et Kanade algorithm"
-v - -pass$1 0 -repeat {@#-1} -l[$>,-1]
-blur_xy 1 --gradient[0] xy,0 --[0,1] --sqr[1,2] --*[1,2] [0] -*[1,2] -rm[0]
Ixy=@{0,ia} Ixx=@{1,ia} Iyy=@{2,ia} Ixt=@{3,ia} Iyt=@{4,ia}
vx={-($Iyy*$Ixt-$Ixy*$Iyt)/($Ixx*$Iyy-$Ixy*$Ixy)}
vy={-($Ixx*$Iyt-$Ixy*$Ixt)/($Ixx*$Iyy-$Ixy*$Ixy)}
-rm 1,2,1,1,$vx,$vy
-endl -done -v +
multi_resolution_pyramide:
-v - -repeat @# -l[$<]
-repeat {$1-1} --resize[-1] 50%,50%,50%,100%,2 -done -reverse
-endl -done -v +
shift_subpixel :
-v - -pass$1 0 -repeat {@#-1} -l[$>,-1]
@{0,w},@{0,h},1,2 -f[-1] 'if(c==0,@{1,i(0)},@{1,i(0,1)})'
-warp[0] [2],1,2,1 -rm[1,2]
-endl -done -v +
estimate_shift:
-e[^-1] "Estimate translation between images and image [$1]"
-v - -pass$1 0 -repeat {@#-1} -l[$>,-1]
N={round(log2(min(@{0,w},@{0,h}))-2,1,-1)}
-multi_resolution_pyramide $N
1,2
-repeat 3 -repeat $N
--*[-1] {-2.0^(-($N-$>-1))} --shift_subpixel[{$N+$>}] [-1] -rm[-2]
-estimate_shift_core[-1] [$>]
-*[-1] {2.0^($N-$>-1)}
-+[-1,-2]
-done -done
-k[-1] -*[-1] -1
-endl -done -v +
unshift: -skip ${1=1}
-e[^-1] "unshift image stack"
-v - -repeat @# -l[$>]
-repeat $1
-s z -repeat {@#-1} -l[$>,{$>+1}]
--estimate_shift[1] [0] -*[-1] -1
-shift_subpixel[1] [-1] -rm[-1]
-endl -done -a z
-done
-endl -done -v +
register_lucas_kanade : -skip ${1=10},${2=10}
--lucas_kanade $2 -zcumsum[-1] --warp2d
-repeat $1
-lucas_kanade[-1] $2 -zcumsum[-1] -+[-1,-2] --warp2d
-done
detect_events : -skip ${1=1},${2=1},${3=9}
-e[^-1] "detect events with scale_xy $1 scale_z $2 and threshold $3"
-v - -repeat @# -l[$>]
-blur_xy $1 -blur_z $2 -structuretensors -blur_xy $1 -blur_z $2
-s z -repeat @# -l[$>] -eigen -k[0] -s c -k[2] -endl -done -a z
-sqrt
thres={@{0,ia}+$3*sqrt(@{0,iv})}
--max_patch[0] 8 -threshold[0] $thres -*
-endl -done -v +
detect_spots : -skip ${1=1},${2=4}
-e[^-1] "detect events with scale $1 and threshold $2"
-v - -repeat @# -l[$>]
-blur $1 --blur $1 -- thres={$2*@{-mad[0]}}
--max_patch[0] 3 --threshold[0] $thres -*
-endl -done -v +
local_moments : -skip ${1=1}
-v - -repeat @# -l[$>]
-norm
-if {d==1}
--mul[0] 'x'   --mul[0] 'y'   --mul[0] 'x*x'
--mul[0] 'x*y' --mul[0] 'y*y' -blur $1
--sqr[1] -/[-1] [0] --[3,-1] -/[3] [0]
--*[1,2] -/[-1] [0] --[4,-1] -/[4] [0]
--sqr[2] -/[-1] [0] --[5,-1] -/[5] [0]
-k[3-5] -a c
-else
--mul[0] 'x'   --mul[0] 'y'   --mul[0] 'z'   --mul[0] 'x*x'
--mul[0] 'x*y' --mul[0] 'x*z' --mul[0] 'y*y' --mul[0] 'y*z'
--mul[0] 'z*z' -blur $1
--sqr[1] -/[-1] [0] --[4,-1] -/[4] [0]
--*[1,2] -/[-1] [0] --[5,-1] -/[5] [0]
--*[1,3] -/[-1] [0] --[6,-1] -/[6] [0]
--sqr[2] -/[-1] [0] --[7,-1] -/[7] [0]
--*[2,3] -/[-1] [0] --[8,-1] -/[8] [0]
--sqr[3] -/[-1] [0] --[9,-1] -/[9] [0]
-k[4-9] -a c
-endif
-endl -done -v +
smooth_moments: -check "${1=1}>0&${2=100}>0&${3=1}>0"
-v - -repeat @# -l[$>]
--local_moments[-1] $1 -smooth[0] [1],$2,$3,0 -k[0]
-endl -done -v +
pointscoordinates :
-e[^-1] "return the list of points in the image"
-v - -repeat @# -l[$>]
-if {iM>0} -pointcloud3d -s3d -k[2] -split y,{h/3} -a x -else 0 -endif
-endl -done -v +
pair_distance:
-repeat @# -l[$>] -s y -a c -endl -done
-repeat @{1,w}
--l[0,1]
-shift[1] $>,0,0,0,2
-- -norm
-endl
-done
-rm[0,1]
-a y
-s x -repeat @# -shift[$>] 0,$>,0,0,2 -done -a x
circles : -skip ${1=10},${2=1},${3=255},${4=255},${5=255}
-e[^-1] "draw @{1,w} circles on image [0]"
-v -
-repeat {@{1,w}}
-if {@{0,d}>1}
x={@{1,i($>,0)}} y={@{1,i($>,1)}} z={@{1,i($>,2)}}
-repeat @{0,s} -sh[0] $z,$z,$> -ellipse[-1] $x,$y,$1,$1,0,$2,0xFFFFFF,$3,$4,$5 -rm[-1] -done
-else
x=@{1,i($>,0)} y=@{1,i($>,1)}
-ellipse[0] $x,$y,$1,$1,0,$2,0xFFFFFF,$3,$4,$5
-endif
-done
add_text : -skip ${1=21},${2=1},${3=255}
-e[^-1] "add text labels from @{1,w} points"
-v -
-repeat {@{1,w}}
-if {@{0,d}>1}
x={@{1,i($>,0)}} y={@{1,i($>,1)}} z={@{1,i($>,2)}} id={$>+1}
-repeat @{0,s} -sh[0] $z,$z,$> -text[-1] $id,$x,$y,$1,$2,$3 -rm[-1] -done
-else
x=@{1,i($>,0)} y=@{1,i($>,1)} id={$>+1}
-text[0] $id,$x,$y,$1,$2,$3
-endif
-done
croparound :  -skip ${1=10},${2=10}
-e[^-1] "crop image [0] around "@{1,w}" coordinates given by image [1]"
-v -
-repeat {@{1,w}}
-if {@{0,d}>1}
x=@{1,i($>,0)} y=@{1,i($>,1)} z=@{1,i($>,2)}
--crop[0] {$x-$1},{$y-$1},{$z-$2},{$x+$1},{$y+$1},{$z+$2}
-else
x=@{1,i($>,0)} y=@{1,i($>,1)}
--crop[0] {$x-$1},{$y-$1},{$x+$1},{$y+$1}
-endif
-done -rm[0,1] -v +
random_walks :
number=$4 width=$1 height=$2 length=$3 speed=$5
$number,3
-l[-1]
-noise 1,1
-sh 0,0,0,0 -n[-1] 1,{$width-1} -rm[-1]
-sh 1,1,0,0 -n[-1] 1,{$height-1} -rm[-1]
-sh 2,2,0,0 -f[-1] 0 -rm[-1]
-repeat {$length-1} --l[-1]
-noise 1
-sh 0,0,0,0 -c[-1] 1,{$width-2} -rm[-1]
-sh 1,1,0,0 -c[-1] 1,{$height-2} -rm[-1]
-sh 2,2,0,0 -f[-1] '$>+1' -rm[-1]
-endl -done -a x
-endl
movavg : -check "$1>=1"
-e[^-1] "moving average with size "$1 -v -
n={$1-1}
-repeat $n
-repeat {{@#}-1} --+[{$>},{$>+1}] -*[-1] .5 -rm[$>] -mv[-1] $> -done
-reverse
-done
-if {$n%2!=0} -reverse -endif
-v +
zmean :
-v - -repeat @# -l[$>]
n=@{0,d} -s z -+ -/ $n
-endl -done -v +
zstd :
-v - -repeat @# -l[$>]
--zmean -sqr[-1]
-l[0] -sqr -zmean -endl
-- -sqrt
-endl -done -v +
zmax :
-v - -repeat @# -l[$>]
-s z -max
-endl -done -v +
zmin :
-v - -repeat @# -l[$>]
-s z -min
-endl -done -v +
zcumsum:
-e[^-1] "Cumulative sum along z-axis"
-v - -repeat @# -l[$>]
-s z -repeat {@#-1} -+[{$>+1}] [$>] -done -a z
-v + -endl -done
kymoline:
--select 1
x1=@{-1,i(0,0)} y1=@{-1,i(0,1)} x2=@{-1,i(0,3)} y2=@{-1,i(0,4)}
d={sqrt(($x2-$x1)^2+($y2-$y1)^2)}
u={($x2-$x1)/$d} v={($y2-$y1)/$d}
-rm[-1]
-f 'if(x<=$d&&y==0,i($x1+x*$u,$y1+x*$v,z,c,1),5)'
-crop 0,0,{int($d-1)},0
fftshift :
-v - -repeat @# -l[$>]
-shift {-int(w/2)},{-int(h/2)},{-int(d/2)},0,2
-endl -done -v +
whiten_frequency : -check "${1=.25}>=0"
-e[^-1] "Whiten the frequency with parameter "$1
-v - -repeat @# -l[$>]
-fft --a c -norm[-1] -pow[-1] $1 -max[-1] 1e-12 -/[-1] {ia} -/[0-1] [2] -rm[2] -ifft -k[0]
-endl -done -v +
deblur_goldmeinel2 : -check "$1>=0 && ${2=8}>=0 && ${3=1}>=0" -skip ${4=1} -skip ${5=1}
-e[^-1] "Deblur image$? using Gold-Meinel algorithm, with sigma $1, $2 iterations, acceleration $3 and "@{-arg\ 1+!$4,"",quasi-}"gaussian kernel."
-v - -repeat @# -l[$>]
[0] -r[-1] 200%,200%,200%,100%,5 -repeat $2
--b[-1] $1,1,$4 -r[-1] 50%,50%,50% --/[0,-1] -rm[-2] -^[-1] $3 -r[-1] 200%,200%,200%,100%,5 -*[-1,-2]
-done -rm[0]
-endl -done -v +
deblur_richardsonlucy2 : -check "$1>=0 && ${2=50}>=0" -skip ${3=1} -skip ${4=1}
-e[^-1] "Deblur image$? using Richardson-Lucy algorithm, with sigma $1, $2 iterations and "@{-arg\ 1+!$3,"",quasi-}"gaussian kernel."
-v - -repeat @# -l[$>]
[0] -r[-1] 200%,200%,200%,100%,5 -repeat $2
--b[-1] $1,1,{$3!=0} -r[-1] 50%,50%,50%,100%,5 --/[0,-1] -rm[-2] -r[-1] 200%,200%,200%,100%,5 -b[-1] $1,1,{$3!=0}  -*[-1,-2]
-done -rm[0]
-endl -done -v +
deblur_richardsonlucy2sp : -check "$1>=0 && ${2=50}>=0" -skip ${3=1} -skip ${4=1}
-e[^-1] "Deblur image$? using Richardson-Lucy algorithm, with sigma $1, $2 iterations and "@{-arg\ 1+!$3,"",quasi-}"gaussian kernel."
-v - -repeat @# -l[$>]
[0] a={ia} -r[-1] 200%,200%,200%,100%,5 -repeat $2
--b[-1] $1,1,{$3!=0} -r[-1] 50%,50%,50%,100%,5 --/[0,-1] -rm[-2] -r[-1] 200%,200%,200%,100%,5 -b[-1] $1,1,{$3!=0}  -*[-1,-2]
--laplacian[-1] -*[-1] 0.1 -+[-1,-2] -threshold[-1] 1%,1 -*[-1] {$a/ia} -max 0 -w[-1]
-done -rm[0]
-endl -done -v +
deblur_richardsonlucysp : -check "$1>=0 && ${2=50}>=0" -skip ${3=1} -skip ${4=1}
-e[^-1] "Deblur image$? using Richardson-Lucy algorithm, with sigma $1, $2 iterations and "@{-arg\ 1+!$3,"",quasi-}"gaussian kernel."
-v - -repeat @# -l[$>]
[0] a={ia} -repeat $2
--b[-1] $1,1,{$3!=0} --[-1] [0] -*[-1] .25 --[-1,-2]
--iee[-1] -*[-1] 0.25 -+[-1,-2]
-threshold[-1] 10%,1 -* {$a/ia}
-max 0
-w[-1]
-done -rm[0]
-endl -done -v +
correlate_fft :
-e[^-1] "Correlate image with image [$1]"
-v - -pass$1 0 -repeat {@#-1} -l[$>,-1]
w2={int(@{0,w}/2)} h2={int(@{0,h}/2)} d2={int(@{0,d}/2)}
-r[1] [0],[0],[0],1,0,0,0.5,0.5,0.5,0.5  -shift[1] -$w2,-$h2,-$d2,0,2
-fft[0] -fft[2] -*[3] -1
--*[-4] [-1] --*[-4] [-3] -+[-2,-1]
-*[-5,-3] -*[-3,-2] --[-3,-2]
-ifft -rm[-1]
-endl -done -v +
deconvolve_richardsonlucy : -check @{-is_image_arg\ $1}" && ${2=5}>=1"
-e[^-1] "Deblur image using Richardson-Lucy algorithm with filter [$1]."
-v - -pass$1 0
-repeat {@#-1} -l[$>,-1]
-r[1] @{0,w},@{0,h},@{0,d},100%,0,0,.5,.5,.5 -normalize_sum[1] [0]
-repeat $2
--convolve_fft[-1] [1] -max[-1] 1e-6 --/[0] [-1] -rm[-2]
-correlate_fft[-1] [1] -*[-1,-2]
-done -rm[0,1]
-endl -done -v +
deconvolve_goldmeinel : -check @{-is_image_arg\ $1}" && ${2=5}>=1 && ${3=1}>=1"
-e[^-1] "Deblur image using Gold-Meinel algorithm with filter $1, $2 iterationsand acceleration $3."
-v - -pass$1 0
-repeat {@#-1} -l[$>,-1]
-r[1] @{0,w},@{0,h},@{0,d},100%,0,0,.5,.5,.5 -normalize_sum[1] [0]
-repeat $2
--convolve_fft[-1] [1] -max[-1] 1e-6 --/[0] [-1] -rm[-2]
-^[-1] $3 -*[-1,-2]
-done -rm[0,1]
-endl -done -v +
blend_sharpness:
-e[^-1] "Blend images according to their sharpness"
-v -
N=@# --gradient_norm
--+[$N--1] -max[$N--1] .01 -/[$N--2] [-1] -rm[-1] -a[$N--1] z -d[-1] -s[-1] z
-a[0-{$N-1}] x -a[1--1] x -* -s x,$N -+
-v +
auto_deblur: -skip ${2=1}
-e[^-1] "Auto deblur"
-v - -repeat @# -l[$>] -max 1e-6
#
lambda={-0.5/($2*@{-noise_std})^2}
--* {-$lambda} 100%,100%,100%,1,{-$lambda}
-echo_stdout {exp(100*$lambda)}
-repeat $1
sigma={.25*$>+.75}
--deblur_richardsonlucy[0] $sigma,30
--blur[-1] $sigma,1,1 --[-1] [0] -sqr[-1]
-l[-1] -blur $sigma,1,1 -s c -+ -* {$lambda} -exp -endl
-echo_stdout $sigma'\t'{round(@{-1,ia},.1)} -w[-1]
-*[-2] [-1] -+[1] [-2] -+[2] [-1] -rm[-1,-2]
-done
-/[1] [2]
-k[1]
-endl -done -v +
reconstruct_laplacian:
-e[^-1] "Reconstruct an image from its laplacian"
-v - -repeat @# -l[$>]
-s c -repeat @# -l[$>]
-fft a=@{0,i(0,0)} b=@{1,i(0,0)}
100%,100%,1,1,'-(4-2*cos(2*x*pi/w)-2*cos(2*y*pi/h))'
-=[-1] 1 -+[-1] $1
-/[0,1] [-1] -k[0,1] -=[0] $a -=[1] $b -ifft -k[0]
-endl -done -a c
-endl -done -v -
local_variance: -skip ${1=2},${2=0}
-e[^-1] "Estimate local variance with scale "$1" and robustness "$2
-v - -repeat @# -l[$>]
-if {$2==0}
--blur $1,1,1 -- -sqr -blur $1,1,1
-else
--median {2*$1+1} -- -abs -median {2*$1+1} -* 1.4826 -sqr
-endif
-endl -done -v +
local_noise_variance: -skip ${1=2},${2=0}
-e[^-1] "Estimate local variance with scale "$1" and robustness "$2
-v - -repeat @# -l[$>]
-laplacian -if {d==1} -* {1/sqrt(20)} -else -* {1/sqrt(42)} -endif -local_variance $1,$2
-endl -done -v +
normalize_local_variance: -skip ${1=50},${2=2},${3=25},${4=1}
-e[^-1] "Normalize local variance with amplitude $1, scale $2, threshold $3 (x$4 times)."
-v -  -repeat @# -l[$>]
-repeat $4
--local_variance $2 -sqrt[-1] -max[-1] $3
--blur[0] $2,1,1 ---[0,-1] -/[-1] [1] -*[-1] $1 -+[-2,-1] -k[-1]
-done
-endl -done -v +
local_wiener : -skip ${1=2}
-e[^-1] "Local Wiener filtering"
-v - -repeat @# -l[$>]
sigma=@{-noise_std}
--blur $1
--local_variance[0] $1 ---[-1] {$sigma*$sigma} -reverse[-1,-2] -/[-1,-2]
---[0,1]
-*[-1,-2] -+[-1,-2] -k[-1]
-endl -done -v +
periodize :
-e[^-1] "periodize"
-v - -repeat @# -l[$>]
-if {w>1} --mirror x -a x -endif
-if {h>1} --mirror y -a y -endif
-if {d>1} --mirror z -a z -endif
-endl -done -v +
tape :
-e[^-1] "apply a Hann tapering window"
-v - -repeat @# -l[$>]
-if {w>1} -f 'i*sin(pi*x/(w-1))^2' -endif
-if {h>1} -f 'i*sin(pi*y/(h-1))^2' -endif
-if {d>1} -f 'i*sin(pi*z/(d-1))^2' -endif
-endl -done -v +
powerspectrum :
-e[^-1] "Compute power spectrum"
-v - -repeat @# -l[$>]
-display_fft -k[0]
-endl -done -v +
fouriermix : -skip ${1=50%}
-e[^-1] "fourier mix images."
-fft[0] -fft[2] -fftshift
100%,100% -circle[-1] 50%,50%,$1,1,1 -blur[-1] 1,1,1 -n[-1] 0,1 -d
-*[0,1] [-1] -negative[-1] -*[2,3] [-1] -rm[-1] -+[0,2] -+[1,2] -fftshift
-ifft  -k[0]
fouriercut : -skip ${1=1}
-e[^-1] "Threshold Fourier coefficients with threshold "$1"."
-v - -repeat @# -l[$>]
--l[-1] -powerspectrum -threshold $1 -fftshift -endl
-fft[0] -*[0] [-1] -*[1] [-1] -rm[-1] -ifft -k[0]
-endl -done -v +
unstrip : -skip ${1=25},${2=20},${3=4}
-e[^-1] "Remove stripes"
-v - -repeat @# -l[$>]
--l[-1]
-tape -powerspectrum -norm -detect_spots 1,$3 -dilate_circ $2 -gt 0
-n 0,1 -negative -circle 50%,50%,$2,1,1
-if {@{-1,im}<.9}
active=1 -blur $1 -n 0,1 -fftshift -if {iM==0} -f 1 -endif
-else
active=0
-endif
-endl
-if {$active==1}
-fft[0] -*[0] [-1] -*[1] [-1] -rm[-1] -ifft
-endif
-k[0]
-endl -done -v +
autocorrelate :
-e[^-1] "Compute autocorrelation"
-v - -repeat @# -l[$>]
-fft -sqr -+ -sqrt -ifft -k[0] -fftshift
-endl -done -v +
psf : -skip ${1=1.40},${2=1.33},${3=488},${4=160},${5=200}
C={2*pi/$3*$1/$2*50}
-v - -repeat @# -l[$>]
-f 'dx=x-w/2;dy=y-h/2;dz=z-d/2;if($C*sqrt(dx*dx+dy*dy)<(d-abs(dz)),1,0)'
-blur 1
-s z -repeat @# -l[$>] -fftpolar -k[0] -endl -done -a z
-sqr
-endl -done -v +
beads2psf : -skip ${1=5}
-e[^-1] "Compute a PSF from an image bead using autocorrelation method"
-v - -repeat @# -l[$>]
-tape -autocorrelate -- {sqrt(@{0,iv})} -threshold 0,1
-f 'dx=x-w/2;dy=y-h/2;dz=z-d/2;sigma=9+$1*dz*dz;i*exp(-.5*(dx*dx+dy*dy)/(sigma))/sqrt(2*pi*sigma)'
-sqr -* {1/(ia*w*h*d*s)}
-endl -done -v +
simmod :
--+ -*[-1] {1/(@#-1)} -/[0--2] [-1] -rm[-1]
spotify : -check "${1=1}>0 && ${2=1}>0"
-e[^-1] "Spotify with scale $1 with $2 iterations"
-v - -repeat @# -l[$>]
-if {@{0,m}!=@{0,M}}
s=@{0,a}
-repeat $2
-b $1 --b {2*$1} -- -max 0 -* '{$s/@{0,a}}'
-done
-endif
-endl -done -v +
deblur_sparse : -check "${1=1}>0 && ${2=10}>0 && ${3=10}>1 && ${4=.001}>=0"
-e[^-1] "Deblur with sparsity constraint with scale $1 with $2 iterations"
-v - -repeat @# -l[$>]
s=@{0,a} [0]
-repeat $3
--blur[1] $1 --[2] [0] -blur[2] $1 -*[2] -.25 -+[-1,-2]
-if {$4>0} --laplacian[-1] -*[-1] $4 -+[-1,-2] -endif
-- $2 -max 0 -* '@{0,$s/ia}'
-done -k[1]
-endl -done -v +
depthmap:
-e[^-1] "Depth map"
-v - -repeat @# -l[$>]
--blur 2 -gradient_norm -reverse -/ -f '1/sqrt(i*i)-1'
-fft 100%,100%,1,1,'-(4-2*cos(2*x*pi/w)-2*cos(2*y*pi/h))'
-=[-1] 1 -/[-3,-2] [-1] -rm[-1] -ifft -k[0] -n 0,1
-endl -done -v +
mapblur: -check "${1=10}>0"
-e[^-1] "Blur images using a blur map (works using pairs of images)."
-v - -repeat {@#/2} -l[{2*$>},{2*$>+1}]
smin=@{1,im} smax=@{1,iM}
-l[0] -repeat $1 --blur[0] {$smin+$>*($smax-$smin)/($1)} -done -rm[0] -a z -endl
-l[1] -tones $1 -gt 0 -blur 1 -a z -endl
-* -s z -+
-endl -done -v +
tubeness : -check "${1=1}>0"
-e[^-1] "Tubeness with scale $1."
-v - -repeat @# -l[$>]
-blur $1
-s c -repeat @# -l[$>]
-hessian -a c -eigen -k[0] -s c -k[1] -* -1 -cut 0,100%
-endl -done -a c
-endl -done -v +
bgsubstract:  -check "${1=5}>0"
-e[^-1] "Temporal background substraction with length $1."
-v - -repeat @# -l[$>]
1,1,$1 -f[-1] 1 --erode[0] [1] --[0] [-1] -rm[1,-1]
-endl -done -v +
schizo : -skip ${1=100},${2=-50},${3=5},${4=.75}
-e[^-1] "Schizo filter smoothing with // $1 and T $2 and $3 iterations."
-v - -repeat @# -l[$>]
[0]
-repeat $3
-l[-1]
--iee -*[-1] {$1/(0.0001+max(abs(@{-1,m}),abs(@{-1,M})))}
--inn[0] -*[-1] {$2/(0.0001+max(abs(@{-1,m}),abs(@{-1,M})))}
-+
-endl
-*[-1] $4  --*[0] {1-$4} -+[-1,-2]
-done -rm[0]
-endl -done -v +
scandoc: -skip ${1=3},${2=100},${3=10%},${4=90%}
-v - -repeat @# -l[$>] -split_opacity -l[0]
-median $1 --blur $2 -- -min 0
-s c -n 0,1 -a c -c $3,$4 -n 0,255
-endl -a c -endl -done -v +
oblur: -skip ${1=1},${2=6}
-v - -repeat @# -l[$>]
-repeat $1 s={2^($>+2)} -repeat $2 a={$>/@#*180}
-echo_stdout $s", "$a
--l[0] -blur_linear $s,1,$a  --blur 1 -- -endl
-if {@#==3}  -max[1,2] -endif
-done -done
-rm[0]
-endl -done -v +
oheat: -skip ${1=1},${2=6}
-v - -repeat @# -l[$>]
-repeat $1  -repeat $2 a={$>/@#*180}
--l[0] -blur_linear 2,.5,$a  --blur 1 -- -endl
-done
-max[1--1] -+
-done
-endl -done -v +
warp_affine :
--l[0,1]
params=(@{1,i(0,0)},@{1,i(1,0)},@{1,i(2,0)};\
@{1,i(0,1)},@{1,i(1,1)},@{1,i(2,1)};\
@{1,i(0,2)},@{1,i(1,2)},@{1,i(2,2)})
@{0,w},@{0,h},1,1,1 --f[-1] x --f[-1] y -a[-3--1] c
-mix_channels[-1] $params
-channels[-1] 1,2
-warp[0] [-1],0,2,0 -rm[-1,-2]
-endl
-rm[0,1]
midway :
-repeat @# -l[$>]
--l[0]
-resize 20%,20%
-s c -unroll y -l[0] 1,@{0,h},1,1,1 -a x -endl  -transpose[0]
-l[0] -svd -f[-2] 'if(i>1e-6,1/i,0)' -diagonal[-2] -transpose[-1] -mmul -endl -mmul
a=@{0,0} b=@{0,1} -rm[-1]
-endl
-s c
-+[-1] {$b} -*[-1] {1/$a} -a c
-endl -done
midway2:
--l[0] -s c -y y 1,@{0,h},1,1,1 -a x -svd -k[-1] -endl
params=(@{1,i(0,0)},@{1,i(1,0)},@{1,i(2,0)};\
@{1,i(0,1)},@{1,i(1,1)},@{1,i(2,1)};\
@{1,i(0,2)},@{1,i(1,2)},@{1,i(2,2)})
-rm[1]
-echo_stdout $params
-mix_channels[0] $params  -n 0,255
vobs : -check "${1=1}>0 && ${2=3}>0"
-e[^-1] "Motion quantity with scale $1"
-v - -repeat @# -l[$>]
-gradient -a[0,1] c -norm[0] -abs[1] -*[1] [0] -sqr[0] -blur $1,1,1 -reverse -max[1] 5% -/
-endl -done -v +
display_vobs :
--vobs 1 A={round(@{-1,im},0.001)} B={round(@{-1,iM},0.001)} -*[-1] '{128/max(im,iM)}' -+[-1] 128  -map[-1] 5
-resize[0] 100%,100%,100%,3,1 -apply_gamma[0] 1.5 -n[0] 0,255
-l[0] -s z -frame 5,12,64 -shift 0,5,0,0,2 -text "Original sequence",5,0,13,1,255 -a z -endl
-l[1] -s z -repeat @# -l[$>] 1,100% -f[-1] 'h-y' -n 0,255  -map[-1] 5 -resize[-1] 5,@{0,h},1,3,5 -frame[-1] 3,0,64  -resize[-1] 100%,@{0,h},1,3,5 -a x
-frame 5,12,64 -shift 0,5,0,0,2
-text "Vobs ["$A":"$B"]",5,0,13,1,255 -endl -done -a z -endl
-a x
display_pseudocolor : -skip ${1=5}
-e[^-1] "Display an indexed image in pseudocolors using map "$1
-v - -repeat @# -l[$>]
A={round(@{-1,im},0.0001)} B={round(@{-1,iM},0.0001)}
-n[-1] 0,255 -map[-1] $1
-rectangle {w-50-5},{h/4-5},{w-5},{h-h/4+5},.5,0,0,0
-add_colorbar[-1] {w-50},{h/4},{w-40},{h-h/4},$A,$B,6,255
-endl -done -v +
display_colordepth :
-e[^-1] "display the 3D image with a depth color coded."
-v - -repeat @# -l[$>]
H={d*$1} -colordepth , -a z -min {ia+10*sqrt(iv)} -n 0,255 -s z
-rectangle {w-50-5},{h/4-5},{w-5},{h-h/4+5},.5,0,0,0
-add_colorbar[-1] {w-50},{h/4},{w-40},{h-h/4},0,$H,6,255
-endl -done -v +
map_hilo:
-v - -repeat @# -l[$>]
-round m=@{0,im} -- $m
1,1,1,3,0,0,@{0,iM} {@{0,iM}-1},1,1,3,'x+1' 1,1,1,3,@{0,iM},0,0 -a[1,2,3] x
-map[0] [1]
-+ $m -rm[1]
-endl -done -v +
add_colorbar :
-skip ${5=0},${6=255},${7=6},${8=255},${9=""},${10=5}
-repeat @# -l[$>]
{$3-$1},{$4-$2} -l[-1] -f 'h-y' -n 0,255 -map $10 -endl
-frame[1] 1,1,$8 -image[0] [1],$1,$2,0,0,1 -k[0]
-repeat $7
val={round($5+$>/($7-1)*($6-$5),.001)}
-text "- "$val" "$9,{$3+1},{$4-$>*($4-$2-5)/($7-1)-10},13,1,$8
-done
-endl -done
local_diffusion_coefficient : -check "${1=2}>0 && ${2=.5}>=0"
-e[^-1] "Local diffusion coefficient estimation using scale $1 and threshold $2"
-v - -repeat @# -l[$>]
--l[0] -s z -laplacian -a z -endl
--l[0] -s z -gradient_norm -a z -sqr -endl
-gradient[0] z,1
-l[0,1]
R={@{1,ia}+$2*sqrt(@{1,v})}
-a c -f 'b=i(x,y,z,0);a=i(x,y,z,1);if(abs(a)>abs(b),b/a,if(abs(b)>$R,1/(b/a),0))'
-channels 0
-endl
-*[0] [1] -blur $1,1,1 -max[1] {@{1,ia}+$2*sqrt(@{1,v})}  -/
-channels 0
-v + -endl -done
ldc :
-local_diffusion_coefficient $*
ldc_residuals :
--l[0] -s z -laplacian -a z -endl
-gradient[0] z,1
-*[1,2]
-- -abs -blur 1
display_ldc :
--ldc 2,3 A={round(@{-1,im},0.001)} B={round(@{-1,iM},0.001)} -*[-1] '{128/max(im,iM)}' -+[-1] 128  -map[-1] 5
-resize[0] 100%,100%,100%,3,1 -apply_gamma[0] 1.5 -n[0] 0,255
-l[0] -s z -frame 5,12,64 -shift 0,5,0,0,2 -text "Original sequence",5,0,13,1,255 -a z -endl
-l[1] -s z -repeat @# -l[$>] 1,100% -f[-1] 'h-y' -n 0,255  -map[-1] 5 -resize[-1] 5,@{0,h},1,3,5 -frame[-1] 3,0,64  -resize[-1] 100%,@{0,h},1,3,5 -a x
-frame 5,12,64 -shift 0,5,0,0,2
-text "Local diffusion coefficient ["$A":"$B"]",5,0,13,1,255 -endl -done -a z -endl
-a x
print_psnr : -skip ${1=255}
-e[^-1] "Compute PSNR with image 0 and print it on the other images."
-v - --psnr $1
-repeat {@#-2} -text_outline[{$>+1}] "PSNR:"{round(@{-1,i(0,$>+1)},.01)}"dB",5,5,30,1 -done
-rm[-1] -v +
noise_std :
-e[^-1] "Compute noise std."
-v - --laplacian -if {@{0,d}==1}  -u {@{-mad[-1]}/sqrt(20.0)} -else -u {@{-mad[-1]}/sqrt(42.0)} -endif -rm[-1]
-v +
pca :
-e[^-1] "Principal component analysis"
-v - -repeat @# -l[$>]
n=@{-1,w} -- 'ia' --transpose[-1] -**[-2,-1] -/ $n -eigen
-endl -done -v +
spca: -skip ${2=20}
-v - -repeat @# -l[$>]
-repeat $2
p={sqrt(h)}
--l --pca -k[0,-1]  -reverse -transpose[0] --** -threshold[-1] $1,1 -rm[1] -transpose[0] -** -endl
-*[0] .25 -*[1] .75 -+
-done
-pca
-endl -done -v +
kpca: -skip ${2=20}
-v - -repeat @# -l[$>]
-repeat $2
p={sqrt(h)}
--l --pca -k[0,-1] -reverse -crop[0] 0,{$1-1} -transpose[0] --** -rm[1] -transpose[0] -** -endl
-*[0] .25 -*[1] .75 -+
-done
-pca -crop[0] 0,0,1,{$1-1} -crop[1] 0,{$1-1}
-endl -done -v +
denoise_klt:
-v - -repeat @# -l[$>]
-split_tiles 64,64 oW=@{0,w} oH=@{0,h} oS=@{0,s}
-y y -a x --pca -k[0,-1] -reverse -crop[0] 0,$1
-transpose[0] --** -rm[1] -transpose[0] -** -s x
-resize $oW,$oH,1,$oS,-1 -append_tiles ,
-endl -done -v +
dlearn:
-split_tiles 64,64 -y y -a x -kpca 10,$1 -k[-1]
ddenoise:
-l[1] -split_tiles 64,64 -y y -a x -endl
-transpose[0] --** -threshold[-1] $1,1 -rm[1] -transpose[0] -** -s x -resize 8,8,1,1,-1 -append_tiles
denoise_kpca:
-v - -repeat @# -l[$>]
-parallel "
--l
-split_tiles 64,64 -y y -a x --kpca 10,$1 -k[0,-1] -reverse -transpose[0] --** -threshold[-1] $1,1 -rm[1] -transpose[0] -** -s x -resize 8,8,1,1,-1 -append_tiles ,
-endl","
--l[0]
-shift 4,4,0,0,2
-split_tiles 64,64 -y y -a x --kpca 10,$1 -k[0,-1] -reverse -transpose[0] --** -threshold[-1] $1,1 -rm[1] -transpose[0] -** -s x -resize 8,8,1,1,-1 -append_tiles ,
-shift -4,-4,0,0,2
-endl","
--l[0]
-shift 4,0,0,0,2
-split_tiles 64,64 -y y -a x --kpca 10,$1 -k[0,-1] -reverse -transpose[0] --** -threshold[-1] $1,1 -rm[1] -transpose[0] -** -s x -resize 8,8,1,1,-1 -append_tiles ,
-shift -4,0,0,0,2
-endl","
--l[0]
-shift 0,4,0,0,2
-split_tiles 64,64 -y y -a x --kpca 10,$1 -k[0,-1] -reverse -transpose[0] --** -threshold[-1] $1,1 -rm[1] -transpose[0] -** -s x -resize 8,8,1,1,-1 -append_tiles ,
-shift 0,-4,0,0,2
-endl"
-rm[0]
-+ -/ 4
-endl -done -v +
denoise_patch_dict: -skip ${1=8},${2=8},${3=1.1},${4=1.1}
-e[^-1] "Denoising using a dictionnary of "$1"x"$1" patches with "$2" shifts, threshold $3x(noise std) for components and $4x(std) for coefficients."
-v - -repeat @# -l[$>]
Sigma=@{-noise_std[0]}
--crop 0,0,$1,100% -mirror[-1] x -reverse --crop[-1] {w-$1-1},0,100%,100% -mirror[-1] x -a x
--crop 0,0,100%,$1 -mirror[-1] y -reverse --crop[-1] 0,{h-$1-1},100%,100% -mirror[-1] y -a y
oW=@{0,w} oH=@{0,h} oS=@{0,s} nW={$1*round($oW/$1,1,1)} nH={$1*round($oH/$1,1,1)}
--crop {2*$oW-$nW},0,100%,100% -mirror[-1] x -a x
--crop 0,{2*$oH-$nH},100%,100% -mirror[-1] y -a y
NtileX={round($nW/$1)}  NtileY={round($nH/$1)}
--l[-1]
-repeat $2
-if {$2>1} dx={round(?(0,$1))} dy={round(?(0,$1))} -else dx=0 dy=0 -endif
--shift[0] $dx,$dy,0,0,2
-split_tiles[-1] $NtileX,$NtileY pW=@{1,w} pH=@{1,h}
-done -rm[0]
-y y -a x n=@{-1,w} -- 'ia' --transpose[-1] -**[-2,-1] -/ $n -eigen
-l[-2] -unroll x -sqrt -gt {$3*$Sigma} -f 'abs(i(x+1)-i(x))'
T=@{-1,C} 4 -f[-1] $T T=@{-1,i(0)} -endl
-if {$T==0} T=100% -endif -k[-1] -columns 0,$T
-endl
-repeat $2
-if {$2>1} dx={round(?(0,$1))} dy={round(?(0,$1))} -else dx=0 dy=0 -endif
--shift[0] $dx,$dy,0,0,2
-l[1,-1]
-l[1] -split_tiles $NtileX,$NtileY -unroll y -a x -endl
-transpose[0] --**
t=@{-mad[-1]}
-f[-1] 'if(abs(i)<$4*$t,0,i)'
-rm[1] -transpose[0] --** -rm[-2]
-endl
-l[-1]
-s x -resize $pW,$pH,1,$oS,-1
-append_tiles $NtileX,$NtileY
-shift {-$dx},{-$dy},0,0,2
-endl
-done
-rm[0,1]
-+ -/ $2
-crop {$1+1},{$1+1},{$oW-$1-2},{$oH-$1-2}
-endl -done -v +
std_noise :
-v - --laplacian[-1] -u {@{-mad[-1]}/sqrt(if(d==1,20,42))} -rm[-1] -v +
iuwt: -skip ${1=3},${2=3}
-e[^-1] "Compute isotropic undecimated wavelet transform"
-v - -repeat @# -l[$<]
50
-l[-1]
-f 'if(x==w/2|x==w/2-1,1,0)' -i [0]
-repeat $2 -convolve[-1] [0] -done
-k[-1] -autocrop 0 -/ {ia*w}
-endl
-repeat {$1-1}
-l[-1,-2]
--convolve[0] [1]
-y[1] y -convolve[-1] [1]
---[0] [-1] -rm[0] -reverse
-endl
-l[-1] -y y 100% -a x -s y -s x -rm[-1] -a x -endl
-done
-rm[-1] -reverse
-endl -done -v +
iuwt_std:
-v - -repeat @# -l[$>]
sigma=@{-noise_std}
-if 1
-f 1 -noise $sigma -iuwt $1,$2
-repeat @# -l[$>]
x={sqrt(iv)} -rm 1 -f $x
-endl -done -a x
-else -rm
50
-l[-1]
-f 'if(x==w/2|x==w/2-1,1,0)' -i [0]
-repeat $2 -convolve[-1] [0] -done
-k[-1] -autocrop 0 -/ {ia*w}
-endl
-sqr
alpha=@{-1,+} -rm
$1,1,1,1,'$sigma*sqrt((1+$alpha)*$alpha^(w-x-1))'
-endif
-endl -done -v +
denoise_iuwt: -check "${1=1.4}>0&&${2=4}>1&&${3=1}>0"
-e[^-1] "Denoise using the isotropic undecimated B"$3" spline wavelet transform"
-v - -repeat @# -l[$>]
--iuwt_std[0] $2,$3 -reverse
-iuwt[-1] $2,$3
-repeat {@#-2} -threshold[{$>+2}] {$1*@{0,i($>+1)}},1 -done
-+[1--1]
-rm[0]
-endl -done  -v +
safir_core: -check @{-is_image_arg\ $1}" && "@{-is_image_arg\ $2}" && $3>0 && $4>0"
-e[^-1] "Apply non-local means denoising using weight images $1, scaling map $2, patch size $3 and spatial bandwidth $4."
-v - -pass$1 0 -pass$2 0
-repeat {@#-2} -l[$>,-1,-2]
100%,100%,100%,@{0,s},0 100%,100%,100%,@{1,s},0
100%,100%,100%,@{1,s},0 100%,100%,100%,@{1,s},0
-if {@{0,d}==1}
-repeat {2*$4+1} j={$>-$4-1} -repeat {2*$4+1} i={$>-$4-1}
-if {$i!=0||$j!=0}
--shift[0,1] $i,$j,0,0,2 --[8] [1]
-sqr[8] -blur[8] $3 -*[8] [2] -exp[7]
-*[6] [7] -max[5] [7] -+[4,7] -+[3,6]
-endif
-done -done
-else
-repeat {2*$4+1} k={$>-$4-1} -repeat {2*$4+1} j={$>-$4-1} -repeat {2*$4+1} i={$>-$4-1}
-if {$i!=0||$j!=0||$k!=0}
--shift[0,1] $i,$j,0,0,2 --[7] [1]
-sqr[7] -blur[7] $3 -*[7] [2] -exp[7]
-*[6] [7] -max[5] [7] -+[4,7] -+[3,6]
-endif
-done -done -done
-endif
-max[5] 1e-6 -rm[1,2]
-*[0] [3] -+[1,0] -+[1,2]
-/
-endl -done -v +
safir: -check "${1=4}>0 && ${2=4}>0 && ${3=10}>0"
-e[^-1] "Apply safir denoising with patch size $1, spatial bandwidth $2 and tonal bandwidth $3."
-v - -repeat @# -l[$>]
--luminance
--local_noise_variance 5
-safir_core[0] [1],[2],$1,$2
-rm[-1,-2]
-endl -done -v +
contour2d: -skip ${1=.1}
-v - -f 'if(abs(i-j(1,1))>$1||abs(i-j(1,0))>$1,1,0)' -v +
segment_snake: -skip ${1=100},${2=1},${3=.1},${4=.1},${5=10},${6=0}
-e[^-1] "Segment the image using active contours without edges using $1 iterations and time step $2, smoothness $3 and initialize with threshold of $4."
-v - -repeat @# -l[$>]
-if {s>1} -luminance -endif
--blur $5 -gt[-1] {ia+$4*sqrt(iv)}
-l[-1] --distance 0 -negative[0] -distance[0] 0 -*[0] -1 -+ -endl
-repeat $1
--lt[-1] 0 -blur[-1] 1 --*[0,-1] swx=@{-1,ia} sw=@{-2,ia} M1={$swx/$sw}
-sqr[-1] swx2=@{-1,ia}  S1={max(1e-3,$swx2/$sw^2-$M1^2)} -rm[-1,-2]
--gt[-1] 0 -blur[-1] 1 --*[0,-1] swx=@{-1,ia} sw=@{-2,ia} M2={$swx/$sw}
-sqr[-1] swx2=@{-1,ia}  S2={max(1e-3,$swx2/$sw^2-$M2^2)} -rm[-1,-2]
--iee[-1]
--f[0] '(1.0/$3)*(((i(x,y)-$M1)^2)/$S1-((i(x,y)-$M2)^2)/$S2)'
-+[-2,-1]
-*[-1] {$2/(0.0001+max(abs(@{-1,m}),abs(@{-1,M})))}
-+[-2,-1]
-if {$6==1}
--l -gt[1] 0 -contour2d[1] , -n 0,1 -a c -text $>,0,0,13,1,{iM} -w -wait 10  -rm -endl
-endif
-done
-blur[-1] 1 -gt[-1] 0 -rm[0]
-endl -done -v +
segment_cells: -skip ${1=3},${2=10},${3=1}
-v - -repeat @# -l[$>]
-blur $1 --blur $2 -- --gt  {ia+$3*@{-mad}} --distance[1] 0 -blur[-1] 1
-max_patch[0] , -*[0] [1] -label[0] 0 -watershed[0] [2] -rm[-1] -*
-endl -done -v +
_challenge:
108,86,1,3 -l[-1] -fractional_brownian_motion .25  -n 0,128 --norm -gt[-1] 60% -* -resize 1080,860,1,3,1  --l[-1] -blur 10 -shift[-1] 10,10 -endl -max -crop 10,10,100%,100% -negative -endl -n 0,255
periodic_dots : -skip ${1=6},${2=4},${3=.5}
-e[^-1] "Generate a periodic dot pattern with "$1" angles, scale "$2", and orientation "$3"."
-v - -repeat @# -l[$>]
-s c -repeat @# -l[$>]
--resize {max(w,h)},{max(w,h)},100%,100%,0
-l[-1]
-f 0
-repeat $1
-circle {w*(.5+.5/$2*cos(2*pi*($>+$3/180*pi)/$1))},{w*(.5+.5/$2*sin(2*pi*($>+$3/180*pi)/$1))},0,1,255
-done
-fft -a c -norm -fftshift -n 0,255
-endl
-resize[-1] [0],0
-k[-1]
-endl -done -a c
-endl -done -v +
turing_pattern: -skip ${1=2000},${2=.1},${3=0.899},${4=-0.91},${5=2},${6=.1},${7=.5},${8=0}
-v - -repeat @# -l[$>]
-r 100%,100%,100%,2 -f 0 -noise 1 -blur 1 -n 0,1
-repeat $1
-progress {$>/$1*100}
--laplacian[0] -mix_channels[-1] ($7,0;0,1)
--f[0] 'u=i(x,y,z,0);v=i(x,y,z,1);a=$3;b=$4;q=$5;r=$6;if(c==0,a*u*(1-q*v*v)+v*(1-r*u),v*(b+a*q*u*v)+u*(-a+r*v))'
-+[-1,-2]
-*[-1] {$2/(0.01+max(abs(im),abs(iM)))}
-+
-if {$8==1} --l -s c -n 0,1 -a c -text $> -w -rm -endl -endif
-done
-s c -n 0,1 -a c
-endl -done -v +
rays :
-e[^-1] "Generate a ray pattern centered in ($1,$2)"
-f 't=atan2(y-$2,x-$1);sin($3*t+$4)'
fractional_brownian_motion : -skip ${1=.5},${2=1} -check "$1>=0&&$1<=1" -check "$2>0"
-v - -repeat @# -l[$>]
-f 0 -noise 1
-fft -fftshift
-if {@{0,d}==1}
-f 'rx=x-w/2;ry=y-h/2;i*($2+sqrt(rx*rx+ry*ry))^(-2*$1-1)'
-else
-f 'rx=x-w/2;ry=y-h/2;rz=z-d/2;i*($2+sqrt(rx*rx+ry*ry+rz*rz))^(-2*$1-1)'
-endif
-fftshift -ifft
-k[0]
-endl -done -v +
clouds : -skip ${1=50%},${2=1},${3=.5},${4=1}
-v - -repeat @# -l[$>]
-channels 0
-fractional_brownian_motion $3,$4 -negative -min $1 -negative -resize 100%,100%,1,4
-n 0,255 -s c -n[0-2] 190,255  -n[3] 0,255 -a c
-endl -done -v +
clearbluesky :
-v - -repeat @# -l[$>]
1,2,1,3 -f[-1] '63,70,120,144,190,215' -resize[-1] [0],5 -k[-1]
-endl -done -v +
wavelength_color:
-v -
-if {$1>=380&$1<440}
R={-1*($1-440)/(440-380)}
G=0
B=1
-elif {$1>=440&$1<490}
R=0
G={($1-440)/(490-440)}
B=1
-elif {$1>=490&$1<510}
R=0
G=1
B={-1*($1-510)/(510-490)}
-elif {$1>=510&$1<580}
R={($1-510)/(580-510)}
G=1
B=0
-elif {$1>=580&$1<645}
R=1
G={-1*($1-645)/(645-580)}
B=0
-elif {$1>=645&$1<780}
R=1
G=0
B=0
-else
R=0
G=0
B=0
-endif
-repeat @# -l[$>]
-mix_channels ($R;$G;$B)
-endl -done
#@gimp Jpr gradient smooth : jpr_gradient_smooth,jpr_gradient_smooth(1)
#@gimp : Note = note("image and its gradient in x y are treated as solid angles and smoothed on the topology of the surface of a sphere\nthis means a loop bright/dark/bright cannot contract through the centre of the sphere")
#@gimp : Offset brightness = float(0,-0.9,0.9)
#@gimp : Smoothing amount = float(1.5,0.8,2.5)
#@gimp : Updateauthornote = note("<small>update 2013-Feb-03 author @jayprich</small>")
jpr_gradient_smooth:
-v -
-repeat @#
-l[$>]
-norm
--g xy,0
-n[0] {$1-1},{$1+1}
-a c
-repeat 25
--norm
-/[0,1]
-b {w*$2/500}
-done
-f atan2(i,abs(i(x,y,0,0)))
-channels 1,2
-endl
-r 100%,100%,1,3,0,1
-n 0,255
-done
-v +
#@gimp Jpr line edges : jpr_line_edges,jpr_line_edges(1)
#@gimp : Note = note{"combines the results in several orientations, each one blurs one way and looks for points of max gradient at 90 degrees to the blur"}
#@gimp : Note = note{"works best on photographs not line-art"}
#@gimp : Angles per quadrant = int(2,1,9)
#@gimp : Blurring = int(2,2,24)
#@gimp : Gradient threshold = float(4,0,30)
#@gimp : Anti alias = bool(1)
#@gimp : Updateauthornote = note("<small>update 2013-Jan-22 author @jayprich</small>")
jpr_line_edges : -skip ${1=5},${2=5},${3=1}
-e[^-1] "Find edges in image$? using $1 angles per quadrant with $2 blurring and $3 anti-alias"
-v -
-repeat @# -l[$>]
-norm
-fft
100%,100%,1,1,x-w/2
100%,100%,1,1,y-h/2
-shift[2,3] {-w/2},{-h/2},0,0,2
100%,100%,1,1
-repeat {$1}
ac={3*cos(($>+0.5)*pi/$1/2)/sqrt(pi)*$2/w}
as={3*sin(($>+0.5)*pi/$1/2)/sqrt(pi)*$2/w}
--*[2] $ac
--*[3] $as
-+[-2,-1]
--sqr[-1]
-*[-1] -1
-exp[-1]
-*[-2,-1]
--mirror[-1] x
-*[-1] -1
[1]x1
-*[-1] -1
[0]x1
-*[-2,-1] [-4]
-rm[-4]
-ifft[-2,-1]
-rm[-1]
[1]x1
-*[-1] -1
[0]x1
-*[-2,-1] [-4]
-rm[-4]
-ifft[-2,-1]
-rm[-1]
-abs[-2,-1]
-max[-2,-1] $3
ac={1.45*cos(($>+0.5)*pi/$1/2)}
as={1.45*sin(($>+0.5)*pi/$1/2)}
--shift[-2] {-$ac},{-$as}
--shift[-3] {$ac},{$as}
--shift[-3] {$ac},{-$as}
--shift[-4] {-$ac},{$as}
-if $4
--max[-6,-4,-3]
--min[-7,-5,-4]
--[-2,-1]
-+[-5,-4]
-*[-4] 0.5
--[-6,-4]
-/[-5,-1]
--[-4] 0.1
-max[-4] 0
-*[-4] 2
--[4,-4]
--max[-3,-2,-1]
--min[-4,-3,-2]
--[-2,-1]
-+[-3,-2]
-*[-2] 0.5
--[-3,-2]
-/[-2,-1]
--[-1] 0.1
-max[-1] 0
-*[-1] 2
--[4,-1]
-else
-max[-4,-3]
-gt[-5,-3]
--[4,-4]
-max[-2,-1]
-gt[-2,-1]
--[4,-1]
-endif
-done
-rm[0,1,2,3]
-n 0,255
-endl -done
-v +
#@gimp Jpr orientedthinning : jpr_orientedthinning,jpr_orientedthinning(1)
#@gimp : Note = note{"Skeleton of a shape against a zero-value (pure-black) background using locally oriented local maxima to find only relevant ridges - not micro ridges from a noisy boundary"}
#@gimp : Pre smooth borders = float(5,0,10)
#@gimp : Propagate direction = float(15,3,50)
#@gimp : Threshold width = int(1,1,10)
#@gimp : Preview orientation = bool(0)
#@gimp : Distance metric = choice(max |x| |y| chebyshev,|x|+|y| manhattan,|x y| euclidean)
#@gimp : Updateauthornote = note("<small>update 2013-Apr-14 author @jayprich</small>")
jpr_orientedthinning :
-e[^-1] "Oriented Thinning image$? with Pre-Smooth $1, Propagate Direction $2, Threshold Width $3"
-repeat @#
-l[$<]
-norm
--b $1
-structuretensors[-1] 0
-mix_channels[-1] (1,0,-1)
-b[-1] $2
-le[-1] 0
-if $4
-rm[-2]
-* 255
-else
(1.1,0^0,1.1)
-map[-2] [-1]
-rm[-1]
-distance[-2] 0,$5
-max[-2] $3
--warp[-2] [-1],1
-*[-2] -1
--warp[-3] [-2],1
-rm[-3]
-max[-2,-1]
-gt[-2,-1]
-* 255
-endif
-endl
-done
-v +
#@gimp Jpr phasecongruence : jpr_phasecongruence,jpr_phasecongruence(1)
#@gimp : Note = note{"Edge detect with directional Phase Congruence using proportionality to Local Energy."}
#@gimp : Start angle = float(45,0,360)
#@gimp : Directions = int(1,1,20)
#@gimp : Energy threshold = float(50,0,500)
#@gimp : Local maxima = bool(1)
#@gimp : Updateauthornote = note("<small>update 2013-Mar-31 author @jayprich</small>")
jpr_phasecongruence :
-e[^-1] "Phase Congruence image$? with StartAngle $1, Directions $2, Threshold $3, IsLines $4"
-v -
-repeat @#
-l[$<]
-norm
100%,100%,1,1,0
-repeat $2
[0]x1
t={($1/180+$</$2)*pi}
a={cos($t)}
b={sin($t)}
-fft[2]
-mv[3] 2
100%,100%,1,1,sx=if(x>w/2,x-w,x);sy=if(y>h/2,y-h,y);if(abs($a*sx+$b*sy)>0.7,sign($a*sx+$b*sy),0)
-*[3] -1
-*[2,3] [4]
-rm[4]
-ifft[2,3]
-rm[3]
c={max(abs($a),abs($b))*.8}
-abs[2]
-max[2] $3
-if $4
a={$a/$c}
b={$b/$c}
-f[2] i>i(x+$a,y+$b)&i>i(x-$a,y-$b)
-endif
-+[1,2]
-done
-rm[0]
-n 0,255
-endl
-done
-v +
#@gimp Jpr remove blocks1 : jpr_remove_blocks1,jpr_remove_blocks1(0)
#@gimp : Sep = separator()
#@gimp : Note = note("subtracts square edged blocks with limited-amplitude while masking less-smooth areas of an image\n\nthis can reduce low quality jpeg artifacts in very smooth parts of an image\n1. choose a block size in pixels to fit\n2. set smallest amplitude that catches block noise in smooth areas but masks real edges in the image\n3. fine tune the strength around 70, the amount of estimated block-noise to subtract")
#@gimp : Spatial block size = float(4,2,25)
#@gimp : Amplitude = float(3,1,64)
#@gimp : Strength fine-tune = float(70,20,300)
#@gimp : Updateauthornote = note("<small>update 2012-Nov-30 author @jayprich</small>")
jpr_remove_blocks1 :
-v -
-repeat @# -l[$<]
-keep[0]
spatial=$1
amplitude=$2
strength=$3
--b[0] {$spatial*1.2} --b[0] {$spatial*0.8} --[1,2] [0]
-c[1,2] {-$amplitude},{$amplitude}
--==[1,2] {-$amplitude}
--==[1,2] {$amplitude} -or[3,4,5,6]
wh={w},{h}
-shift[1] 2,2
-r[1,2] {w/$spatial},{h/$spatial},1,3,2
-r[1,2] $wh
-shift[1] -2,-2
-c[1,2] {-$amplitude/2},{$amplitude/2}
--==[1,2] {-$amplitude/2}
--==[1,2] {$amplitude/2} -or[3,4,5,6,7]
-compose_channels[3] or
-blur[3] {2*$spatial} -threshold[3] 0.1
-blur[3] {2*$spatial}
--[3] 1
-+[1] [2] -rm[2]
-*[1] [2] -rm[2]
-*[1] {0.01*$strength}
--[0] [1] -rm[1]
-endl -done
-v +
#@gimp Jpr shapes gradient : jpr_shapes_gradient,jpr_shapes_gradient(0)
#@gimp : Note = note("lots of local regressions using shapeaverage suppress noise in the gradients of small areas random areas chosen by watershed")
#@gimp : Pre blur = float(4.5,0,15)
#@gimp : Watershed threshold = float(0.25,0.05,1)
#@gimp : Gradient flatten = float(0.01,0.01,3)
#@gimp : Gradient cap = float(7,0.5,15)
#@gimp : Updateauthornote = note("<small>update 2013-Jan-31 author @jayprich</small>")
jpr_shapes_gradient:
-v -
-repeat @# -l[$<]
100%,100%,1,1,0.1*(x-w/2)
--norm[0]
-b[-1] $1
-segment_watershed[-1] $2,0
-gt[-1] 0
-*[1] [-1]
--blend_shapeaverage[1,-1]
--[1,-1]
--sqr[1]
[-2]x1
-blend_shapeaverage[-2,-1]
-+[-1] $3
-sqrt[-1]
-/[1,-1]
--blend_shapeaverage[0,-1]
-*[0] [-3]
-blend_shapeaverage[0,-2]
-c[0] -$4,$4
-*[0,1]
-+[0,1]
-c 0,255
-endl -done
-v +
#@gimp Jpr specularbumps : jpr_specularbumps,jpr_specularbumps(1)
#@gimp : Note = note{"Add highlights using brightness gradient."}
#@gimp : Gradient illuminate angle = float(270,0,360)
#@gimp : Pre smooth = float(1,0,5)
#@gimp : Gradient range = float(13,0,30)
#@gimp : Illumination adjust = float(0,-45,45)
#@gimp : Illumination offset = float(80,0,90)
#@gimp : Highlight size = float(0.1,0,0.25)
#@gimp : Roughness = float(0.1,0.05,0.35)
#@gimp : Output type = choice("black and white","white with alpha","compose to image")
#@gimp : Updateauthornote = note("<small>update 2013-Mar-31 author @jayprich</small>")
jpr_specularbumps :
-e[^-1] "Specular highlights image$? with GradientAngle $1, Pre-Smooth $2, GradientRange $3, AdjustAngle $4, IlluminationOffset $5, HighlightSize $6, Roughness $7, OutputType $8"
-v -
t={$1*pi/180}
a={cos($t)}
b={sin($t)}
-repeat @#
-l[$<]
-to_rgb
--b $2
-l[-1]
-norm
-gradient xy
-a c
-mix_channels ($a,$b;{-$b},$a)
-div $3
-c 0,1
--norm
-f[-1] "0.1/(0.1+i)"
-a c
--norm
-div[-2,-1]
-b 2
--norm
-div[-2,-1]
wh={w},{h},1,3
({cos((45+$4)*pi/180)*sin($5*pi/180)}^{sin((45+$4)*pi/180)*sin($5*pi/180)}^{cos($5*pi/180)})
-r $wh
--
-norm
-c $6,{$6+$7}
-* -1
-n 0,255
-endl
-if {$8==0}
-rm[-2]
-else
-if {$8==1}
-rm[-2]
100%,100%,1,3,255
-mv[-1] -2
-a[-2,-1] c
-else
-blend dodge
-endif
-endif
-endl
-done
-v +
#@gimp Jpr warpfromthreshold : jpr_warpfromthreshold,jpr_warpfromthreshold(1)
#@gimp : Note = note("a dummy 100x100 grid is warped using smoothed orientation as a map")
#@gimp : Brightness threshold = float(170,10,245)
#@gimp : Simplify regions = float(2,0,6)
#@gimp : Blur & renormalise loop = int(10,3,50)
#@gimp : Blur amount per step = float(2,1,10)
#@gimp : Updateauthornote = note("<small>update 2013-Feb-03 author @jayprich</small>")
jpr_warpfromthreshold:
-v -
-repeat @#
-l[$>]
-norm
--g xy
-a[1,2] c
-ge[0] $1
-b[0] $2
-ge[0] 0.5
-f[0] i!=i(x+1,y)|i!=i(x,y+1)
-repeat $3
--norm[1]
-*[2] [0]
-a[1,2] c
-f[1] if(i(x,y,0,2)==0,i,i/i(x,y,0,2))
-channels[1] 0,1
-b[1] $4
-done
-rm[0]
-s c
-n 0,100
-a c
100,100,1,3,((x/2)%4)==0|(c==2&((y/2)%4)==0)
-warp[1] [0]
-rm[0]
-n 0,255
-endl
-done
-v +
#@gimp _
#@gimp <i>Karo's tests</i>
#@gimp About : _none_, karos_about
#@gimp : Note = note{"
#@gimp : KaRo's test files for <b>G'MIC</b>\n\written by"}
#@gimp : Note = link("Karsten Rodenacker","http://K.Rodenacker.de")
#@gimp : Note = note{"\n"}
#@gimp : Note = note{"
#@gimp : The source code of this set of filters is available at :"}
#@gimp : Note = link("http://karo03.bplaced.net/gmic/karos.gmic")
#@gimp : "}
#@gimp : Sep = separator()
#@gimp : Note = note{"Several operations here rely on executables existing <i>in search PATH</i> ($PATH unter Mac/Unix).
#@gimp : This means that the executable is downloaded or built and properly located.
#@gimp : E. g. CImg examples have to be built and copied to a location in the search path, e.g. under unix <i>/usr/local/bin</i>.
#@gimp : Similar with PINK executables. For Mac they have to be built according the README with <i>./makelin</i>
#@gimp : and PATH as to be extended by <i>..pink location../linux/bin</i>."}
#@gimp : Sep = separator()
#@gimp : Note = note{"  CImg Skeleton: <i>use_skeleton</i> in search PATH"}
#@gimp : Note =link("http://cimg.cvs.sourceforge.net/viewvc/cimg/CImg/examples/use_skeleton.cpp?view=log")
#@gimp : Note = note{"  CImg nlmeans: <i>use_nlmeans</i> in search PATH"}
#@gimp : Note =link("http://cimg.cvs.sourceforge.net/viewvc/cimg/CImg/examples/use_nlmeans.cpp?view=log")
#@gimp : Note = note{"  mM Differences: \nmathematical morphology operation differences\nmM operation size - mM operation size2"}
#@gimp : Note = note{"  oC Differences: \nmathematical morphology open/close differences\nmM open size - mM close size"}
#@gimp : Note = note{"  Pink operations binary: <i>Pink applications</i> in search PATH"}
#@gimp : Note =link("http://pinkhq.com/")
#@gimp : Sep = separator()
#@gimp : Note = note{"\nThe functions defined are quite <i>experimental</i> and subject to changes.
#@gimp : Please do not rely on the fact that they will perform equally forever."}
karos_about :
-gimp_logo_version{round(?(0.5,3.49))} @. [0] -*[-1] 0 -text[-1] "KaRo's",10%,22%,57,1,255 -text[-1] "Tests",40%,60%,57,1,200 --to_gray[-1] -skeleton[-1] , -n[-1--2] 0,255 -dilate[-2] 2 --[-1--2] -+ -n 0,255
pseudo_c : -v - @{-1,M},1,1,3,?(255) -round[-1] -map[-2] [-1] -rm[-1] -v +
karo_close :
-e "Compute closing image$?, with size $1 (only 2d)."
-skip ${1=5},${2=0},${3=0},${4=0},${5=0}
-gimp_morpho 3,$1,$3,$2,$5,$4
karo_open :
-e "Compute opening image$?, with size $1 (only 2d)."
-skip ${1=5},${2=0},${3=0},${4=0},${5=0}
-gimp_morpho 2,$1,$3,$2,$5,$4
karo_doc :
-e "Compute difference of open/close and original image$?, with window size $1 (only 2d)." -v -
-skip ${1=5},${2=1},${3=0}
-repeat @# -l[@{<,-1}]
--karo_open[0] $1,$2,0,0,$3 --karo_close[0] $1,$2,0,0,$3
-+[-2,-1] -/[-1] 2 --
-endl -done -v +
karo_doo : -skip ${1=5},${2=7},${3=2},${4=1},${5=0},${6=0}
-e[^-1] "Compute difference of mm op on image$?, with sizes $1 and $2 (only 2d)." -v -
-repeat @# -l[@{<,-1}]
--gimp_morpho[-1] $3,$1,0,$4,$6,0
-gimp_morpho[-2] $3,$2,0,$4,$6,0
-if {{${3}&1}==0} -rv[-2,-1] -endif
--[-2,-1]
-if {$5==1} -n[-1] 0,255 -endif
-endl -done -v +
karo_label_sort :
-e[^-1] "Sort labelled image [1] by region size."
-v - -repeat @# -l[$>]
nb={1+iM} mn=@{-1,m} --histogram[-1] $nb,0,{$nb-1}
100%,1,1,1,x -a[-2,-1] y -sort[-1] -,x -rows[-1] 1
100%,1,1,1,x -a[-2,-1] y -sort[-1] +,x -rows[-1] 1
-map[-2] [-1] -rm[-1]
-endl -done -v +
karo_label : -check "$1>=0" -skip ${2=0} -skip ${3=0}
-e[^-1] "Label connected components on image [1], with tolerance $1, "@{-arg\ 1+!$2,high,low}" connectivity and "@{-arg\ 1+!$3,sorted,unsorted}
-v - -repeat @# -l[$>]
-label[-1] $1,$2
-if {$3}
nb={1+@{-1,M}} --histogram[-1] $nb,0,@{-1,M}
100%,1,1,1,x -a[-2,-1] y -sort[-1] -,x -rows[-1] 1
100%,1,1,1,x -a[-2,-1] y -sort[-1] +,x -rows[-1] 1
-map[-2] [-1] -rm[-1]
-endif
-endl -done -v +
karo_threshold : -skip ${1="triangle"} -skip "${2=0} ${3=0}"
-e[^-1] "Calculate "$1" thresholded mask from images$? with histogram in range [0,255] and binsize 1."
-v -
meth=$1
-if {$meth'=='otsu} -otsu 256 -else -repeat @#
-l[$>]
--histogram[-1] 256,0,255
-if {$2>0} -=[-1] 0,{$2-1} -endif
-if {$3!=0} tot=@{-1,+} -/[-1] $tot -blur_x[-1] $3 -/[-1] @{-1,+} -*[-1] $tot -round[-1] -endif
--_karo_$1[-1] 0,1 -rm[-1] th=@{}
-threshold[0] $th
-if {$>==0} sres=$th -else sres=$sres,$th -endif
-endl -done -u $sres -endif
-v +
_karo_triangle : -skip "${1=0} ${2=1}"
-e[^-1] "Calculate triangle threshold from 1d histogram$? in range ["$1","{$1+(w-1)*$2}"]."
-v -
-repeat @#
-l[@{>,-1}]
ac=@{-autocrop_coords[-1]} wd={w}
min={@{-arg\ 1,$ac}} -if {$min==1&&@{-1,0}!=0} min=0 -endif
-if {$min>0} min={$min-1} -endif
min2={@{-arg\ 4,$ac}} -if {$min2<{$wd-1}} min2={$min2+1} -endif
dmax={iM} max={xM}
-if {($max-$min)<($min2-$max)}
inverted=1 -mirror[0] x min={$wd-1-$min2} max={$wd-1-$max}
-else inverted=0 -endif
-if {$min==$max} split=$min -else
nx={i($max)} ny={$min-$max}
d={sqrt($nx*$nx+$ny*$ny)}
nx={$nx/$d} ny={$ny/$d}
d={$nx*$min+$ny*i($min)}
--f[-1] x -*[-1] $nx -*[-2] $ny -+[-1,-2] --[-1] $d
-crop[-1] {$min+1},$max
-if {$inverted} split={$wd-(xM+$min)} -else split={xM+$min+1} -endif
-endif
res={$1+$split*$2}
-if {@{>,-1}==0} sres=$res -else sres=$sres\,$res -endif
-rm[0] -endl
-done -u $sres -v +
_karo_yen :  -skip "${1=0} ${2=1}" -v -
-repeat @# -l[@{>,-1}]
total=@{0,+}
-*[0] {1/$total}
--cumul[0]
--sqr[0] -cumul[-1]
--mirror[0] x -sqr[-1] -cumul[-1] -mirror[-1] x
--*[-1,-2]
--gt[-1] 0 -c[-2] 0.000001%,100 -log[-2] -*[-2,-1] -*[-1] -1
--*[1] -1 -+[-1] 1 -*[1,-1] --gt[1] 0 -c[1] 0.000001%,100 -log[1] -*[1,-1] -*[1] 2
-+[-1,1] -k[1]
res={@{-karo_nth_max\ 2,1}*$2+$1}
-rm[0]
-if {@{>,-1}==0} -u $res -else -u @{},$res -endif
-endl -done -v +
_karo__otsu : -skip "${1=0} ${2=1}" -v -
-repeat @# -l[@{>,-1}]
im=$1 iM={$im+(w+1)*$2} total=@{-1,+}
--*[-1] 'x' sum=@{-1,+} -rm[-1]
sumB=0 wB=0 wF=0 varMax=0 threshold=0
-repeat {w}
wB={$wB+@{-1,$>}}
-if {$wB==0} -continue -endif
wF={$total-$wB}
-if {$wF==0} -break -endif
sumB={$sumB+$>*@{-1,$>}}
mB={$sumB/$wB}
mF={($sum-$sumB)/$wF}
varBetween={$wB*$wF*($mB-$mF)^2}
-if {$varBetween>$varMax} varMax=$varBetween threshold=$> -endif
-done -rm[-1]
res={$threshold*$2+$1} -u $res
-endl -done -v +
karo_select :
--select[-1] 0 x=@{-1,i(0,0)} y=@{-1,i(0,1)} z=@{-1,i(0,2)} -rm[-1] -u $x,$y,$z
hist_percentile :
-check "${1=25%}>0"
-skip ${2=0},${3=0},${4=1}
-e[^-1] "Calculate $1 percentile from 1d histogram$?."
-v - -repeat @#
-l[@{>,-1}]
-if {h>1||d>1||s>1} -v + -e[^-1] "Image "@{>,-1}" seemingly not 1d!" -v - -continue -endif
-if {$2!=0} -set[-1] 0,0 -endif
m0=@{-1,+}
N={if(@{"-is_percent $1"},$m0*$1,$1)}
--cumul[-1]
--ge[-1] $N mn={@{-arg\ 1,@{-1,C}}*$4+$3} -rm[-1]
--ge[-1] {@{-1,M}-$N} mx={@{-arg\ 1,@{-1,C}}*$4+$3} -rm[-1,-2]
res=$mn\,$mx
-if {@{>,-1}==0} sres=$res -else sres=$sres\,$res -endif
-endl
-done -u $sres -v +
hist_feature :
-check "${1=-2}>=-2&&$1<=5&&isint($1)&&isint(${2=1})&&$2>0"
-skip ${3=0},${4=0},${5=1}
-e[^-1] "Calculate md,m0,m1,m2,$2th-min,$2th-max,med from 1d histogram$?."
-v -
-repeat @#
-l[@{>,-1}]
-if {h>1||d>1||s>1} -v + -e[^-1] "Image "@{>,-1}" seemingly not 1d!" -v - -continue -endif
-if {$3!=0} -set[-1] 0,0 -endif
md={xM*$5+$4}
m0=@{-1,+}
--*[-1] 'x*$5+$4' m1={@{-1,+}/$m0} -rm[-1]
--*[-1] '(x*$5+$4)^2' m2={sqrt(@{-1,+}/$m0-$m1^2)} -rm[-1]
--cumul[-1]
--ge[-1] $2 mn={@{-arg\ 1,@{-1,C}}*$5+$4} -rm[-1]
-if {$2>1} --ge[-1] {@{-1,M}-$2} mx=@{-arg\ 1,@{-1,C}} -rm[-1] -else  mx=@{-arg\ 1,@{-1,C}} -endif
mx={$mx*$5+$4}
--ge[-1] {@{-1,M}/2} med1=@{-arg\ 1,@{-1,C}} -rm[-1]
--le[-1] {@{-1,M}/2} med2=@{-arg\ 1,@{-1,c}} -rm[-1,-2]
med={($med1+$med2)/2*$5+$4}
res=$md\,$m0\,$m1\,$m2\,$mn\,$mx\,$med
-if {$1>-2} res=@{-arg\ {$1+2},$res} -endif
-if {@{>,-1}==0} sres=$res -else sres=$sres\,$res -endif
-endl
-done -u $sres -v +
karo_nth_max : -check "isint(${1=1}) && $1>0" -skip ${2=0}
-e[^-1] "Return in the status the $1-th max of image$?."
-v - -repeat @# -l[$>]
[0] -repeat {$1-1} -set[-1] @{-1,m},@{-1,C} -done
-if $2 mx={xM} -else mx={iM} -endif -rm[-1]
-if {${>}==0} -u $mx -else -u @{},$mx -endif
-endl -done -v +
karo_nth_min : -check "isint(${1=1}) && $1>0" -skip ${2=0}
-e[^-1] "Return in the status the $1-th min of image$?."
-v - -repeat @# -l[$>]
[0] -repeat {$1-1} -set[-1] @{-1,M},@{-1,c} -done
-if $2 mn={xm} -else mn={-im} -endif -rm[-1]
-if {${>}==0} -u $mn -else -u @{},$mn -endif
-endl -done -v +
karo_xcimg :
filename=@{-file_rand}
-if {!@{-is_windows}}
-x "which "$1" >/dev/null 2>&1"
-if @{} -v + -e "executable \"$1\" not found in PATH, status = "@{}"!! Returning!!\n" -v -
{w},{h} -gimp_logo "exec Error !!" -return -endif
-endif
-o ${filename}.cimg
-x "$1 -i "${filename}".cimg $2 -o "${filename}".cimg"
-if @{} -v + -e "Status is "@{}"." -v - {w},{h} -gimp_logo "exec Error !!"
-else -i ${filename}.cimg -endif
-file_rm ${filename}.cimg
karo_li2st :
-v - -u "" -if {$#>=1} ({"'${1--1}'"}) -replace[-1] {','},{"' '"} -u @{-1,t} -rm[-1] -endif -v +
karo_skeleton : -v - -if {$#>0} -karo_li2st ${1--1} p=@{} -else p="" -endif -v +
-e "Compute use_skeleton exec with options "$p" on$?" -v -
-repeat @# -l[@{>,-1}]
s=@{-1,s} -if {$s>1} -s[-1] c -endif
-repeat @# -l[@{>,-1}] -karo_xcimg use_skeleton,${p}" -visu 0" -mv[-1] 0 -k[0] -endl -done
-if {$s>1} -a[-$s--1] c -endif
-endl -done -v +
karo_nlmeans : -v - -if {$#>0} -karo_li2st ${1--1} p=@{} -else p="" -endif -v +
-e "Compute use_nlmeans exec with options "${p}" on$?" -v -
-repeat @# -l[@{>,-1}]
s=@{-1,s} -if {$s>1} -s[-1] c -endif
-repeat @# -l[@{>,-1}] -karo_xcimg use_nlmeans,${p}" -visu 0" -mv[-1] 0 -k[0] -endl -done
-if {$s>1} -a[-$s--1] c -endif
-endl -done -v +
karo_VST :
-v - -skip ${1=0} -if $1 inv=" (inverse)." -else inv="." -endif -v +
-e[^-1] "Variance Stabilizing Transformation"$inv -v -
-repeat @# -l[$>]
-if $1 -/[0] 2 -sqr[0] --[0] {3/8} -else -+[0] {3/8} -sqrt[0] -*[0] 2 -endif
-endl -done -v +
pearson_correlation :
-e[^-1] "Compute pearson-correlation using two-by-two image$?."
-v - -repeat {int(@#/2)} -l[{$>*2},{$>*2+1}]
---[0] @{0,a} ---[1] @{1,a} --*[2,3]
-sqr[2,3]
r={@{-1,a}/sqrt(@{2,a}*@{3,a})}
-if {$>==0} -u $r -else -u @{},$r -endif
-rm[2-4]
-endl -done -v +
karo_extinction : -check "${1=100%}>0"
-e[^-1] "Convert transmission image$? into extinction with white value $1." -v -
-repeat @# -l[$>]
-if @{-is_percent\ $1} WW={iM*$1} -else WW=$1 -endif
-c[-1] 1,{iM} -/[-1] $WW -log10[-1] -*[-1] -1
-endl -done -v +
karo_rndbit0 :
-e[^-1] "Randomize in [0..255] image$? bit level 0." -v -
-repeat @# -l[$>]
-and 254 --rand 0,1 -threshold[-1] 0.5 -or
-endl -done -v +
#@gimp Cimg nlmeans : gimp_karo_cimg_nlmeans, gimp_karo_cimg_nlmeans_preview(0)
#@gimp : Add gauss noise = float(0.0,0.0,30.0)
#@gimp : Add uniform noise = float(0.0,0.0,30.0)
#@gimp : Add salt & pepper noise = float(0.0,0.0,30.0)
#@gimp : Half size of patch = int(1,1,15)
#@gimp : Band width lambda = float(-1,-1,25)
#@gimp : Noise sd sigma = float(-1,-1,25)
#@gimp : Neighborhood size alpha = int(3,1,15)
#@gimp : Sampling step size = int(2,1,5)
#@gimp : Sep = separator(), Preview type = choice(1,"Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note(Smoothing using CImg example plugin use_nlmeans.)
#@gimp : Note = note{"CImg nlmeans: <i>use_nlmeans</i> in search PATH"}
#@gimp : Sep = separator(), note = note("<small>Author : <i>KaRo</i>. Latest update : <i>2012/10/26</i>.</small>")
gimp_karo_cimg_nlmeans :
-skip "${1=0}","${2=0}","${3=0}","${4=1}","${5=-1}","${6=-1}","${7=2}"
-karo_nlmeans -ng,$1,-nu,$2,-ns,$3,-p,$4,-lambda,$5,-sigma,$6,-alpha,$7,-sampling,$8
gimp_karo_cimg_nlmeans_preview :
-gimp_split_preview "-gimp_karo_cimg_nlmeans ${1-8}",$9
#@gimp Cimg skeleton : gimp_karo_cimg_skel, gimp_karo_cimg_skel_preview(0)
#@gimp : Auto-threshold = bool(1)
#@gimp : Threshold \% = float(50,0,100)
#@gimp : Size median = int(0,0,15)
#@gimp : Invert = bool(false)
#@gimp : Threshold on flux = float(-0.3,-5,5)
#@gimp : Medial curve = bool(false)
#@gimp : Torsello correction =bool(false)
#@gimp : Discrete step = int(1,1,15)
#@gimp : Sep = separator(), Preview type = choice(1,"Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note(Skeleton using CImg example plugin use_skeleton.)
#@gimp : Note = note{"CImg Skeleton: <i>use_skeleton</i> in search PATH"}
#@gimp : Sep = separator(), note = note("<small>Author : <i>KaRo</i>. Latest update : <i>2012/10/26</i>.</small>")
gimp_karo_cimg_skel :
-if $1 -otsu 256 -else -t ${2}% -endif
-karo_skeleton -median,$3,-inv,$4,-t,$5,-curve,$6,-corr,$7,-dlt,$8 -n 0,255
gimp_karo_cimg_skel_preview :
-gimp_split_preview "-gimp_karo_cimg_skel ${1-8}",$9
#@gimp Mm differences : gimp_karo_mm_diff, gimp_karo_mm_diff_preview(0)
#@gimp : Size = int(5,1,25)
#@gimp : Size2 = int(7,1,25)
#@gimp : Operation = choice(2,"Erosion","Dilation","Open","Close")
#@gimp : Shape = choice(1,"Square","Octagon","Circle")
#@gimp : Channel(s) = choice(0,"All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Green chrominance","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Scale = bool(true)
#@gimp : Sep = separator(), Preview type = choice(1,"Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Best with odd sizes!
#@gimp : Sep = separator(), note = note("Arithmetical difference of a morphological operation of <i>size</i> and <i>size2</i>.")
#@gimp : Sep = separator(), note = note("<small>Author : <i>KaRo</i>. Latest update : <i>2012/10/26</i>.</small>")
gimp_karo_mm_diff :
-skip "${1=5}","${2=7}","${3=2}","${4=1}","${5=0}","${6=1}"
-if {$2<=$1} s2={$1+2} -else s2=$2 -endif
-karo_doo $1,${s2},$3,$4,$6,$5
gimp_karo_mm_diff_preview :
-gimp_split_preview "-gimp_karo_mm_diff ${1-6}",$7
#@gimp Oc differences : gimp_karo_oc_diff, gimp_karo_oc_diff_preview
#@gimp : Size = int(5,2,25)
#@gimp : Shape = choice(1,"Square","Octagon","Circle")
#@gimp : Channel(s) = choice(0,"All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Green chrominance","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Scale =bool(true)
#@gimp : Sep = separator(), Preview type = choice(1,"Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Best with odd sizes!
#@gimp : Sep = separator(), note = note("Difference of mean of morphological opening and closing with original.")
#@gimp : Sep = separator(), note = note("<small>Author : <i>KaRo</i>.           Latest update : <i>2013/07/04</i>.</small>")
gimp_karo_oc_diff :
-apply_channels_old "-karo_doc $1,$2,0",$3,$4
gimp_karo_oc_diff_preview :
-gimp_split_preview "-gimp_karo_oc_diff ${1-4}",$5
#@gimp Pink operator : gimp_pink, gimp_pink_preview(1)
#@gimp : Pink operator = choice("wshedtopo","wshedtopo inv","minima","maxima","heightminima","heightmaxima","grayskel","htkern","htkernu","lvkern","lvkernu","asf","asflin","asfr","asft","asftmed","asftndg","dilatballnum","erosballnum","lintophat")
#@gimp : Connectivity / dir = choice("Four/x","Eight/y")
#@gimp : Smoothness = float(0,0,5)
#@gimp : Height/rep = int(5,0,25)
#@gimp : Channel(s) = choice(0,"All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Green chrominance","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Note = link("http://pinkhq.com/")
gimp_pink :
-skip ${1=11},${2=0},${3=0},${4=5},${5=0}
-if   {$1==0}  -apply_channels_old "-b $3 -pink heightminima,{($2+1)*4},$4 -pink wshedtopo,{($2+1)*4}",$5,0
-elif {$1==1}  -apply_channels_old "-b $3 -pink heightmaxima,{($2+1)*4},$4 -pink wshedtopo,{($2+1)*4},i",$5,0
-elif {$1==2}  -apply_channels_old "-b $3 -pink minima,{($2+1)*4}",$5,0
-elif {$1==3}  -apply_channels_old "-b $3 -pink maxima,{($2+1)*4}",$5,0
-elif {$1==4}  -apply_channels_old "-b $3 -pink heightminima,{($2+1)*4},$4",$5,0
-elif {$1==5}  -apply_channels_old "-b $3 -pink heightmaxima,{($2+1)*4},$4",$5,0
-elif {$1==6}  -apply_channels_old "-b $3 -pink grayskel,null,4,$4",$5,0
-elif {$1==7}  -apply_channels_old "-b $3 -pink htkern,null,{($2+1)*4}",$5,0
-elif {$1==8}  -apply_channels_old "-b $3 -pink htkernu,null,{($2+1)*4}",$5,0
-elif {$1==9}  -apply_channels_old "-b $3 -pink lvkern,null,{($2+1)*4}",$5,0
-elif {$1==10} -apply_channels_old "-b $3 -pink lvkernu,null,{($2+1)*4}",$5,0
-elif {$1==11} -apply_channels_old "-b $3 -pink asf,$4",$5,0
-elif {$1==12}
-if {$2==0} -apply_channels_old "-b $3 [0]x2 -a z -pink asflin,x,$4 -s z -k[-1]",$5,0
-else -apply_channels_old "-b $3 [0]x2 -a z -pink asflin,y,$4 -s z -k[-1]",$5,0 -endif
-elif {$1==13} -apply_channels_old "-b $3 -pink asfr,$4",$5,0
-elif {$1==14} -apply_channels_old "-b $3 -pink asft,null,null,{($2+1)*4},$4",$5,0
-elif {$1==15} -apply_channels_old "-b $3 -pink asftmed,{($2+1)*4},$4",$5,0
-elif {$1==16} -apply_channels_old "-b $3 -pink asftndg,null,null,{($2+1)*4},$4",$5,0
-elif {$1==17} -apply_channels_old "-b $3 -pink dilatballnum,$4",$5,0
-elif {$1==18} -apply_channels_old "-b $3 -pink erosballnum,$4",$5,0
-elif {$1==19} -apply_channels_old "-b $3 -pink lintophat,$4",$5,0
-else          -apply_channels_old "-b $3 -pink heightminima,{($2+1)*4},$4 -pink wshedtopo,{($2+1)*4}",$5,0
-endif
gimp_pink_preview :
-gimp_split_preview "-gimp_pink ${1-5}",$6
#@gimp Pink operator binary : gimp_karo_pink_bin, gimp_karo_pink_bin_preview(1)
#@gimp : Auto-threshold = bool(1)
#@gimp : Threshold \% = int(50,0,100)
#@gimp : Pink operator = choice(3,"skelpar","skelend","skelcurv","skeleton","barycentre","border","closeball","openball","convexhull","dist","distc","label pla","Lantuejoul")
#@gimp : Connectivity / dir = choice("Four/x","Eight/y")
#@gimp : Height/rep = int(5,-1,25)
#@gimp : Algorithm = int(4,0,29)
#@gimp : Channel(s) = choice(0,"All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Green chrominance","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note(Binary operations with Pink externals.)
#@gimp : Note = note{"Diverse Pink executables in search PATH"}
#@gimp : Sep = separator(), note = note("<small>Author : <i>KaRo</i>.           Latest update : <i>2014/02/05</i>.</small>")
#@gimp : Note = link("http://pinkhq.com/")
gimp_karo_pink_bin :
-if   {$3==0}  -apply_channels_old "-if $1 -otsu 256 -else -threshold ${2}% -endif -pink_skelpar $6,$5 -n 0,255",$7,0
-elif {$3==1}  -apply_channels_old "-if $1 -otsu 256 -else -threshold ${2}% -endif -pink_skelend {($4+1)*4},$5 -n 0,255",$7,0
-elif {$3==2}  -apply_channels_old "-if $1 -otsu 256 -else -threshold ${2}% -endif -pink_skelcurv $6,{($4+1)*4} -n 0,255",$7,0
-elif {$3==3}  -apply_channels_old "-if $1 -otsu 256 -else -threshold ${2}% -endif -pink_skeleton $6,{($4+1)*4} -n 0,255",$7,0
-elif {$3==4}  -apply_channels_old "-if $1 -otsu 256 -else -threshold ${2}% -endif -pink barycentre,{($4+1)*4} -n 0,255",$7,0
-elif {$3==5}  -apply_channels_old "-if $1 -otsu 256 -else -threshold ${2}% -endif -pink border,{($4+1)*4} -n 0,255",$7,0
-elif {$3==6}  -apply_channels_old "-if $1 -otsu 256 -else -threshold ${2}% -endif -pink closeball,$5,$6 -n 0,255",$7,0
-elif {$3==7}  -apply_channels_old "-if $1 -otsu 256 -else -threshold ${2}% -endif -pink openball,$5,$6 -n 0,255",$7,0
-elif {$3==8}  -apply_channels_old "-if $1 -otsu 256 -else -threshold ${2}% -endif -pink convexhull,3 -n 0,255",$7,0
-elif {$3==9}  -apply_channels_old "-if $1 -otsu 256 -else -threshold ${2}% -endif -pink dist,$6 -n 0,255",$7,0
-elif {$3==10}  -apply_channels_old "-if $1 -otsu 256 -else -threshold ${2}% -endif -pink distc,$6 -n 0,255",$7,0
-elif {$3==11}  -apply_channels_old "-if $1 -otsu 256 -else -threshold ${2}% -endif -pink label,{($4+1)*4},pla",$7,0
-elif {$3==12}  -apply_channels_old "-if $1 -otsu 256 -else -threshold ${2}% -endif -pink lantuejoul,$6 -n 0,255",$7,0
-else
-endif
gimp_karo_pink_bin_preview :
-gimp_split_preview "-gimp_karo_pink_bin ${1-7}",$8
#@gimp Pink test operator bianca : gimp_karo_pink_bianca, gimp_karo_pink_bianca_preview(0)
#@gimp : Asf smooth size = int(5,1,10)
#@gimp : Threshold \% = int(60,0,100)
#@gimp : Watershed height min = int(5,0,20)
#@gimp : Opening radius = int(1,0,10)
#@gimp : Invert = bool(0)
#@gimp : Use g instead of b = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note(Pink test operator Bianca for RGB image; only B used.)
#@gimp : Note = note{"Pink executables in search PATH or C:\\Pink\\bin\\ for Windows"}
#@gimp : Sep = separator(), note = note("<small>Author : <i>KaRo</i>.           Latest update : <i>2012/10/26</i>.</small>")
#@gimp : Note = link("http://pinkhq.com/")
gimp_karo_pink_bianca :
-skip "${1=5}","${2=60}","${3=5}","${4=1}","${5=0}","${6=0}"
-if $5 -negative -endif
-if {!@{-is_windows}} exe="label" -else exe="C:\Pink\bin\label" -endif
-s c -if $6 -k[-2] -else -k[-1] -endif
--pink asf,$1 --- -k[-1,-3] -t[-1] ${2}%
--pink_wshed[-2] ,1,$3
-pink[-1] $exe,4,max -t[-1] 1
-erode_oct[-2] {$4*2+1} -dilate_oct[-2] {$4*2+1}
--*[-1,-2] -negative[-2] -n[-1,-2] 0,255 -a[-1,-2,-4] c -k[0]
gimp_karo_pink_bianca_preview :
-gimp_split_preview "-gimp_karo_pink_bianca ${1-6}",$7
#@gimp _
#@gimp <i>Lylejk</i>
#@gimp Blend [shape average] : gimp_blend_shapeaverage, gimp_blend_shapeaverage(0)
#@gimp : Preserve shading = bool(1)
#@gimp : Transparency = bool(0)
#@gimp : Revert layers = bool(0)
#@gimp : Note = note{"<small><b>Note:</b>
#@gimp : This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/19/2011</i>.</small>")
gimp_blend_shapeaverage :
-if ${3=0} -_gimp_revert_layers -endif
-to_rgb
-repeat {int(@#/2)}
-rv[-2,-1]
-if $1 -i[0] [-1] -endif
-blend[-2,-1] shapeaverage0
-if $1 -*[0,-1] -/[0] 255 -mv[0] @# -endif
-if $2 -to_rgba[-1] -replace_color[-1] 0,0,0,0,0,255,0,0,0,0 -endif
-mv[-1] 0 -done
#@gimp Lylejk's stencil : gimp_lylejk_stencil, gimp_lylejk_stencil(0)
#@gimp : Amplitude = int(5,1,10)
#@gimp : Sharpness = float(10,0,100)
#@gimp : Radius = float(3,0,10)
#@gimp : Channel(s) = choice("All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Alpha","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Lyle Kroll, David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_lylejk_stencil :
-apply_channels_old "-repeat $1 -b $3 -unsharp $3,$2 -c 0,255 -mv[-1] 0 -done",$4,0
#@gimp _
#@gimp <i>Naggobot</i>
#@gimp Abstract flood : gimp_AbstractFlood, gimp_AbstractFlood_Preview(1)
#@gimp : Sep = separator()
#@gimp : Note = note("Warning: Really really slow filter especially with Cubism enabled. Use a maximum of 1 megapixel image. Random walk algorihm is used to select new areas to flood. If Cubism is enabled the filter has to run cubims for every succesful repeat defined in the flood settings section.")
#@gimp : Preprocess with bilateral filtering = bool(1)
#@gimp : Spatial variance = float(10,0,100)
#@gimp : Value variance = float(7,0,100)
#@gimp : Iterations = int(2,1,10)
#@gimp : Sep = separator()
#@gimp : Note = note("Flood settings")
#@gimp : Activate flood = bool(0)
#@gimp : Repeats = int(10,1,1000)
#@gimp : Flood tolerance = int(5,0,100)
#@gimp : Flood base step = int(3,1,10)
#@gimp : Canvas color = color(255,255,255,255)
#@gimp : Sep = separator()
#@gimp : Note = note("Abstraction setting, Consider disabling preview if using high flood repeats!")
#@gimp : Activate cubism = bool(0)
#@gimp : Cubism iterations = int(300,1,2000)
#@gimp : Bloc size = float(10,0,40)
#@gimp : Angle = float(90,0,360)
#@gimp : Opacity = float(0.7,0.01,1)
#@gimp : Smoothness = float(0,0,5)
#@gimp : Note = note("Opacity threshold used to make decision about flooding. Use 0 if Cubism is not enabled.")
#@gimp : Opacity tolerance = int(0,0,254)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Arto Huotari</i>.      Latest update : <i>2013/09/28</i>.</small>")
#@gimp : Note = link("Filter Explained here","http://www.flickr.com/photos/naggobot/6243715666")
gimp_AbstractFlood :
Prep=$1
SpatialVariance=$2
ValueVariance=$3
Iterations=$4
ActivateFlood=$5
Repeats=$6
Tolerance=$7
FloodBaseStep=$8
CanvasR=$9
CanvasG=$10
CanvasB=$11
Opacity=$12
ActivateCubism=$13
CubismIterations=$14
Blocsize=$15
Angle=$16
CubismOpacity=$17
Smoothness=$18
StepThreshold={$19+0.1}
Step=$FloodBaseStep
Delta=1
DeltaOrg=$Delta
-to_rgba[0]
-if {$Prep==1}
-gimp_bilateral[0] $SpatialVariance,$ValueVariance,$Iterations,0,0
-endif
({$CanvasR}^{$CanvasG}^{$CanvasB}^0)
-to_rgba[1]
-r[1] [0]
X={(w)/2}
Y={(h)/2}
ImageH={(h)}
ImageW={(w)}
DoLoop=0
IsGood=0
-if {$ActivateFlood==1}
#A comment here is needed
-repeat $Repeats
-flood[0] {100*$X/w}%,{100*$Y/h}%,0,$Tolerance,0,1,@{0,($X,$Y,0,0)},@{0,($X,$Y,0,1)},@{0,($X,$Y,0,2)},@{0,($X,$Y,0,3)}
--gimp_select_color[0] 0,1,0,@{0,($X,$Y,0,0)},@{0,($X,$Y,0,1)},@{0,($X,$Y,0,2)},@{0,($X,$Y,0,3)},0,0
-if {$ActivateCubism==1}
-cubism[2] $CubismIterations,$Blocsize,$Angle,$CubismOpacity,$Smoothness
-endif
-blend[1,2] alpha
-do
Rstep={$Step+$Delta}
theta={?(360)}
Xnew={int($X+$Rstep*cos($theta))}
Ynew={int($Y+$Rstep*sin($theta))}
-if {{$Xnew>0}" && "{$Xnew<$ImageW}" && "{$Ynew>0}" && "{$Ynew<$ImageH}}
X=$Xnew
Y=$Ynew
-if {@{1,($X,$Y,0,3)}>$StepThreshold}
Delta={min({$Delta+$Delta*2},{max($ImageW,$ImageH)/5})}
-endif
-if {@{1,($X,$Y,0,3)}<$StepThreshold}
IsGood=10
-endif
-if {$DoLoop>100}
IsGood=10
-endif
-endif
DoLoop=$DoLoop+1
-while {$IsGood<1}
IsGood=0
DoLoop=0
Delta=$DeltaOrg
-done
-endif
({$CanvasR}^{$CanvasG}^{$CanvasB}^{$Opacity})
-r[2] [0]
-reverse[1,2]
-blend[1,2] alpha
-if {$ActivateFlood==1}
-keep[1]
-elif  {$ActivateFlood==0}
-keep[0]
-endif
gimp_AbstractFlood_Preview :
-gimp_split_preview "-gimp_AbstractFlood ${1--2}",$-1
#@gimp Black &amp; white film : gimp_bwfilmsimulate, gimp_bwfilmsimulate_preview(1)
#@gimp : Film type / RGB balance = choice(0,"Manual","Agfa 200X","Agfapan 25","Agfapan 100","Agfapan 400","Iford Delta 100","Iford Delta 400","Iford Delta 400 pro & 3200","Ilford FP4","Ilford HP4","Ilford Pan F","Ilford SFX","Ilford XP2 Super","Kodak Tmax 100","Kodak Tmax 400","Kodak Tri-X")
#@gimp : Note = note("Simpler version available in main tree. This filter will be removed in future from testing. PM me if you need this for some reason.")
#@gimp : Note = note("RGB sliders work only with manual selection")
#@gimp : Red level = float(0.299,0,1)
#@gimp : Red smoothness = float(0,0,10)
#@gimp : Green level = float(0.587,0,1)
#@gimp : Green smoothness = float(0,0,10)
#@gimp : Blue level = float(0.114,0,1)
#@gimp : Blue smoothness = float(0,0,10)
#@gimp : Sep = separator()
#@gimp : Gamma = float(1,0.01,5)
#@gimp : Contrast = float(1,0,4)
#@gimp : Brightness = float(0,-255,255)
#@gimp : Hue = float(0,0,360)
#@gimp : Saturation = float(0,0,1)
#@gimp : Sep = separator()
#@gimp : Grain (shadows) = float(0,0,200)
#@gimp : Grain (midtones) = float(0,0,200)
#@gimp : Grain (highlights) = float(0,0,200)
#@gimp : Grain tone fading = float(2,0,10)
#@gimp : Grain scale = float(0,0,3)
#@gimp : Grain type = choice("Gaussian","Uniform","Salt and pepper","Poisson")
#@gimp : Sep = separator()
#@gimp : Local contrast = float(0,0,60)
#@gimp : Radius = int(16,1,512)
#@gimp : Contrast smoothness = float(4,0,10)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>David Tschumperl&#233, Arto Huotari;</i>.      Latest update : <i>2019/09/28</i>.</small>")
gimp_bwfilmsimulate :
Choice=$1
P1=$2
P2=$3
P3=$4
P4=$5
P5=$6
P6=$7
P7=$8
P8=$9
P9=$10
P10=$11
P11=$12
P12=$13
P13=$14
P14=$15
P15=$16
P16=$17
P17=$18
P18=$19
P19=$20
P20=$21
-if {$Choice==1} P1={18/255} P3={41/255} P5={41/255} -endif
-if {$Choice==2} P1={25/255} P3={39/255} P5={36/255} -endif
-if {$Choice==3} P1={21/255} P3={40/255} P5={39/255} -endif
-if {$Choice==4} P1={20/255} P3={41/255} P5={39/255} -endif
-if {$Choice==5} P1={21/255} P3={42/255} P5={37/255} -endif
-if {$Choice==6} P1={22/255} P3={42/255} P5={36/255} -endif
-if {$Choice==7} P1={31/255} P3={36/255} P5={33/255} -endif
-if {$Choice==8} P1={28/255} P3={41/255} P5={31/255} -endif
-if {$Choice==9} P1={23/255} P3={37/255} P5={40/255} -endif
-if {$Choice==10} P1={33/255} P3={36/255} P5={31/255} -endif
-if {$Choice==11} P1={36/255} P3={31/255} P5={33/255} -endif
-if {$Choice==12} P1={21/255} P3={42/255} P5={37/255} -endif
-if {$Choice==13} P1={24/255} P3={37/255} P5={39/255} -endif
-if {$Choice==14} P1={37/255} P3={36/255} P5={37/255} -endif
-if {$Choice==15} P1={25/255} P3={35/255} P5={40/255} -endif
-repeat @#
-l[-1] -split_opacity -rv -to_rgb[-1] -s[-1] c
-*[-3] $P1 -b[-3] $P2%
-*[-2] $P3 -b[-2] $P4%
-*[-1] $P5 -b[-1] $P6%
-+[-3--1] -/[-1] {$P1+$P3+$P5} -c[-1] 0,255
-apply_gamma[-1] $P7
--[-1] 128 -*[-1] $P8 -+[-1] 128 -+[-1] $P9 -c[-1] 0,255
100%,100% [-1]x2
-noise[-3] 100,$P17 -b[-3] $P16% -n[-3] -$P12,$P12
-noise[-2] 100,$P17 -b[-2] $P16% -n[-2] -$P13,$P13
-noise[-1] 100,$P17 -b[-1] $P16% -n[-1] -$P14,$P14
--tones[-4] 3 -b[-3--1] $P15%
-*[-6,-3] -*[-4,-2] -*[-2,-1]
-+[-4--1] -c[-1] 0,255
-if {$P10||$P11}
-/[-1] 255
-i[-2] 100%,100%,1,1,$P11
-i[-3] 100%,100%,1,1,$P10
-a[-3--1] c -hsv2rgb[-1]
-endif
-rv -a c -endl -mv[-1] 0 -done
-normalize_local $P18,$P19,$P20,2%,1,0,255
gimp_bwfilmsimulate_preview :
-gimp_split_preview "-gimp_bwfilmsimulate ${1--2}",$-1
#@gimp Composition analysis : gimp_CompositionAnalysis, gimp_no_preview
#@gimp : Note = note("A tool to abstract the image for subjective composition analysis. Two different methods are available. Set filter output to New layers. For actual analysis the aesthetic sense of the artist is required.")
#@gimp : Method = choice(0,"Thumbnail abstraction","Value and lines")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Arto Huotari</i>.      Latest update : <i>2015/01/17</i>.</small>")
sub_thumbnailabstraction :
-to_rgb[0]
IWidth=@{0,w}
IHeight=@{0,w}
-if {$IWidth>=$IHeight}
ScaleByWidth=1
-endif
-if {$ScaleByWidth==1}
--resize2dx[0] 200,5
-blur[-1] 2
#Resize to 1024 px
-resize2dx[-1] 1024,5
#Segmentation
-gimp_segment_watershed[-1] 0.5,5,0,0
-elif
--resize2dy[0] 200,5
-blur[-1] 2
#Resize to 1024 px
-resize2dy[-1] 1024,5
#Segmentation
-gimp_segment_watershed[-1] 0.5,5,0,0
-endif
-resize[-1] [0]
--rgb2lab[0]
-split[-1] c
-rm[-1,-2]
-blur[-1] 10%
-normalize[-1] 0,255
-blend[-1,-2] hardlight,1,1
-keep[-1]
sub_colors_and_lines :
image_width=@{0,w}
image_height=@{0,h}
-resize2dx 1024
-luminance[0]
-normalize 0,255
-to_rgb[0]
-gimp_bilateral[0] 2,15,2,0,0,24,0
-gimp_colormap[0] 0,0,3,3,0,0,0,255,255,255,255,0,0,0,255,0,0,0,255,255,255,0,255,0,255,0,255,255,0
--gimp_anisotropic_smoothing[0] 300,0.1,1,0,10,1,1,1,0,1,1,0,0,24,0
-gimp_gradient_norm[-1] 0,0.5,0,100,1,0
-blend[0,1] multiply,1
-resize[-1] $image_width,$image_height,1,3,5,1
gimp_CompositionAnalysis :
method=$1
-if {$method==0} -sub_thumbnailabstraction -endif
-if {$method==1} -sub_colors_and_lines -endif
#@gimp Dodge sketch : gimp_dodgesketch, gimp_dodgesketchpreview(0)
#@gimp : Note = note("Simple BW sketch"),note = link("Method is described here","http://www.gimpusers.com/tutorials/making-a-pencil-drawing-from-a-photo.html")
#@gimp : Note = note("in addition an option to color the sketch is included")
#@gimp : Sep = separator(), note = note("Power setting for sketch")
#@gimp : Power = int(3,0,10)
#@gimp : Sep = separator(), note = note("Presmoothing settins of bilateral filter")
#@gimp : Spatial variance = float(10,0,100)
#@gimp : Value variance = float(7,0,100)
#@gimp : Iterations = int(2,1,10)
#@gimp : Sep = separator()
#@gimp : Colored? = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Arto Huotari</i>.      Latest update : <i>2013/09/28</i>.</small>")
gimp_dodgesketch:
-to_rgb[0]
Power=$1
SpatialVariance=$2
ValueVariance=$3
Iterations=$4
Colored=$5
--gimp_mix_hsv[0] 1,0,0,0,-1,0,1,0,0,0,2,0
--gimp_bilateral[-1] $SpatialVariance,$ValueVariance,$Iterations,0,0
-negative[-1]
-blend[-1,-2] alpha,0.5,0
[-1]
--blend[-1,-2] dodge,1,0
-keep[0,-1]
-repeat $Power
[-1]
-blend[-1,-2] multiply
-done
-if {$Colored==1}
--blend[-1,-2] hardlight
-remove[-2]
-gimp_transfer_colors[-1,-2] 0,0
-endif
-keep[-1]
gimp_dodgesketchpreview :
-gimp_split_preview "-gimp_dodgesketch ${1--2}",$-1
#@gimp Exposure fusion weight map : gimp_ExposureWeightMap, gimp_ExposureWeightMapPreview(1)
#@gimp : Sep = separator()
#@gimp : Note = note("Create exposure fusion weight map")
#@gimp : Sep = separator()
#@gimp : Note = note("Set filter output to "New layers". Copy filter output to corresponding layer mask. Use aligned layers to combine multiple exposures.")
#@gimp : Sep = separator()
#@gimp : Contrast bias = float(0.3,0,1)
#@gimp : Saturation bias = float(0.3,0,1)
#@gimp : Exposure sigma = float(0.2,0,1)
#@gimp : Exposure bias = float(0.3,0,1)
#@gimp : Blurmap = bool(1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small> Author: Arto Huotari Latest update : <i>2014/11/30 v2</i>.</small>")
#@gimp : Note = link("Based on article","http://research.edm.uhasselt.be/tmertens/papers/exposure_fusion_reduced.pdf")
Sub_Contrast_Bias:
-div[-1] 255
-to_gray[-1]
-laplacian[-1]
-abs[-1]
Sub_Saturation_Bias:
-div[-1] 255
--split[0] c
-blend[-1,-2,-3] average
-split[0] c
--sub[0] [1]
-rm[1]
--sub[0] [1]
-rm[1]
--sub[0] [1]
-rm[1]
-rm[0]
-pow[0] 2
-pow[1] 2
-pow[2] 2
-add[1] [2]
-rm[2]
-add[0] [1]
-rm[1]
-div[0] 3
-sqrt[0]
Sub_Exposure_Bias :
-div[0] 255
-sub[0] 0.5
-pow[0] 2
-div[0] {2*$1*$1}
-mul[0] -1
-exp[0]
-split[0] c
-mul[0] [2]
-rm[2]
-mul[0] [1]
-rm[1]
Sub_BlurPyramid :
size={min(@{0,w},@{0,h})}
levels={round(log($size)/log(5))}
Deviation=1
-blur[0] $Deviation,1,1
-repeat {$levels-1}
--resize[-1] 50%,50%,5,1
-blur[-1] $Deviation,1,1
-done
blndalpha=0.5
-repeat {$levels-1}
index={-1*(@{<,0}+1)}
-resize[$index] [0],5,1
-blend[0,$index] alpha,$blndalpha,0
blndalpha={$blndalpha/2}
-done
gimp_ExposureWeightMap :
wc=$1
ws=$2
sigma=$3
we=$4
BlurMap=$5
-to_rgb[0]
--Sub_Contrast_Bias[0]
--Sub_Saturation_Bias[0]
--Sub_Exposure_Bias[0] $sigma
-rm[0]
-pow[0] $wc
-pow[1] $ws
-pow[2] $we
-add[0] [1]
-add[0] [2]
-keep[0]
-normalize[0] 0,255
-if {$BlurMap==1}
-Sub_BlurPyramid[0]
-endif
gimp_ExposureWeightMapPreview :
-gimp_split_preview "-gimp_ExposureWeightMap ${1--2}",$-1
#@gimp Gmic structure tensors : gimp_StructureTensors, gimp_StructureTensorsPreview(0)
#@gimp : Sep = separator()
#@gimp : Note = note("Structure tensors calculation for Gimp plugin. This is just an interface to built in GMic Structure tensors command")
#@gimp : Power = float(0.1,0.1,2)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Arto Huotari</i>.      Latest update : <i>2011/12/06</i>.</small>")
#@gimp : Note = link("Filter Explained here","http://gmic.sourceforge.net/reference.shtml")
gimp_StructureTensors:
-structuretensors -abs -pow $1
-normalize 0,255
gimp_StructureTensorsPreview :
-gimp_split_preview "-gimp_StructureTensors ${1--2}",$-1
#@gimp Import 16bit image : gimp_import_image_16_info, gimp_import_image_16_info
#@gimp : Note = note("This filter has been moved to main tree Various section")
gimp_import_image_16_info:
#@gimp Luminance to alpha : gimp_split_luminance, gimp_split_luminance(1)
#@gimp : Note = note("Filter splits image to different levels of Luminance. Set preview output to "all outputs". Order of output to Gimp from top to bottom is Midtones,Light,LL,..,Dark,DD,.. If reduced overlap is used then first Light layer is removed from output as redundant if more than one level is processed. Mutilevel output becomes Midtones,,LL,LLL,..,Dark,DD,DDD.. with intermediary light and dark levels containing midtones. ")
#@gimp : Sep = separator()
#@gimp : Levels = int (1,1,6)
#@gimp : Output as alpha = bool(1)
#@gimp : Reduce overlap = bool(1)
#@gimp : Sep = separator(), note = note("Use -keep[] or -remove[] to select output images")
#@gimp : Keep custom = bool(0)
#@gimp : Keep custom = text(0,-keep[-1])
#@gimp : Sep = separator(), note = note("<small>Author: <i>Arto Huotari;</i>.      Latest update: <i>2014/04/13</i>.</small>")
intersect_images:
--lt[0] [1]
-mul[-1] 255
--lt[1] [0]
-mul[-1] 255
-sub[0] [-1]
-sub[1] [-2]
-remove[-1,-2]
-cut[0] 0,255
-cut[1] 0,255
-add[0] [1]
-remove[1]
create_base_levels:
Levels=$1
-repeat {$Levels-1}
#Multiply D level with loop index+1
--mul[2] {@{>,0}+1}
#Subtract i*D from L
--sub[1] [-1]
-remove[-2]
-cut[-1] 0,255
-done
-repeat {$Levels-1}
#Multiply L with loop index + 1
--mul[1] {@{>,0}+1}
#Subtract i*L from D
--sub[2] [-1]
-remove[-2]
-cut[-1] 0,255
-done
reorder_stack :
Levels=$1
-move[3] 1
-if {$Levels>1}
-reverse[2,3]
-move[2] {-$Levels+1}
-endif
reduce_overlap :
Levels=$1
-repeat {$Levels-1}
-sub[{2+@{>,-1}}] [{3+@{>,-1}}]
-cut[{2+@{>,-1}}] 0,255
-done
-repeat {$Levels-1}
-sub[{-$Levels+@{>,-1}}] [{-$Levels+@{>,-1}+1}]
-cut[{-$Levels+@{>,-1}}] 0,255
-done
-sub[1] [{-$Levels-1}]
-sub[1] [-1]
-cut[1] 0,255
gimp_split_luminance:
Levels=$1
AlphaOutput=$2
ReduceOverlap=$3
KeepCustom=$4
KeepText=$5
-to_rgb
--rgb2lab
-split[-1] c
-rm[-1,-2]
-normalize[-1] 0,255
--negative[-1]
--intersect_images[-1,-2]
-if {$ReduceOverlap==0}
-normalize[-1] 0,255
-endif
-create_base_levels $Levels
-reorder_stack $Levels
-if {{$ReduceOverlap==1}" && "{$Levels>1}}
-reduce_overlap $Levels
-endif
-repeat {@#-1}
#add 1 to alpha  and cut 0,225 to avoid cutting of colour channels
#no idea why this is necessary, it yields correct results
#Ma and ma are already 0 and even though 1 is added the output is still
#0 for transparent areas of the mask.
-add[{@{>,-1}+1}] 1
-cut[@{>,-1}] 0,255
-done
-if $AlphaOutput
-repeat {@#-1}
--append[0,1] c
-remove[1]
-done
-endif
-if {{$ReduceOverlap==1}" && "{$Levels>1}}
#D and L are now equal, remove first
-remove[2]
-endif
-remove[0]
-if $KeepCustom
$KeepText
-endif
#@gimp Make old squiggly : gimp_OldSquiggly, gimp_OldSquiggly
#@gimp : Note = note("Development version. This version will be removed in future from sources so if you prefer this then copy and save the source to your local .gmic file")
#@gimp : Spread noise amount = float(2,0,20)
#@gimp : Segmentation edge threshold = float(12,0,15)
#@gimp : Segmentation smoothness = float(0.8,0,5)
#@gimp : Gradiennormsmoothness = float(0,0,10)
#@gimp : Gradiennormlinearity = float(0.5,0,1.5)
#@gimp : Increasechroma1 = float(3,1,4)
#@gimp : Tone threshold = float(0.2,0,1)
#@gimp : Tone gamma = float(0.4,0,1)
#@gimp : Paper grayness = int(50,0,255)
#@gimp : Paper whiteness = int(245,0,255)
#@gimp : Squiggle gamma = int(45,1,128)
#@gimp : Squiggle multiplier = float(0.5,0,1)
gimp_OldSquiggly :
--gimp_spread[0] $1,$1,0,0
-gimp_segment_watershed[1] $2,$3,0,0
--gimp_gradient_norm[1] $4,$5,0,100,0,0
--blend[2,1] multiply
-gimp_mix_ycbcr[3] 1,0,0,$6,0,0,$6,0,0,0,2,0
-gimp_map_tones[0] $7,$8,0.1,30,0,0
-blend[0,3] darken
-remove[1,2]
--gimp_plasma 0.5,10,8,0
-gimp_blackandwhite[1] 0.299,0,0.587,0,0.114,0,1,1,0,0,0,0,0,0,2,0,0,0,16,4,0,0,0
-gimp_apply_curve[1] $9,-1,128,-1,128,-1,128,-1,128,-1,128,$10,1,3,0,0,0
-gimp_apply_curve[0] 0,$11,128,-1,128,-1,128,-1,128,-1,128,255,1,3,0,0,0
-mul[0] {0.5*(1+$12)}
-mul[1] {0.5*(1-$12)}
--add[0] [1]
--blend[0,2] softlight
-remove[0,1,2]
#@gimp Mapped smoothing : gimp_MappedSmooth, gimp_MappedSmooth
#@gimp : Sep = separator()
#@gimp : Note =note("Two layers required if automap is not used. <b>Set input to active and below</b>. Filter Smooths image with a vector field map. Map is created from R and G channels so that R128,G128 becomes [0 0]. Experiment with solid 128,128,0 color layer and add hues of red and green. Angle shift rotates the vector field and Zero point offset moves the default 0 0 point. This is somewhat a development version, sample art is still missing.")
#@gimp : Sep = separator()
#@gimp : Map type = choice("Automap","Layer Map")
#@gimp : Angle shift = float(0,-180,180)
#@gimp : Zero point offset = float(0,-128,128)
#@gimp : Amplitude = float(300,10,10000)
#@gimp : Vector length multipler = float(1,0.1,5)
#@gimp : Sep = separator()
#@gimp : Note = note("Optional viewing of vector field")
#@gimp : Show quiver = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Arto Huotari</i>.      Latest update : <i>2012/02/25</i>.</small>")
gimp_MappedSmooth :
MapType=$1
fi={$2*3.1415/180}
ZeroOffset=$3
Amplitude=$4
LMult=$5
ShowQuiver=$6
-if {$MapType==0}
--gimp_local_orientation 0.5,0,100,0,4,0
-endif
cosfi={cos($fi)}
sinfi={sin($fi)}
-to_rgb[-2,-1]
--[-1] {128+$ZeroOffset}
-split[-1] c
-mul[3] 0
--mul[1] $cosfi
--mul[2] $sinfi
-sub[4] [5]
-rm[5]
--mul[1] $sinfi
--mul[2] $cosfi
-add[5] [6]
-rm[6]
-rm[1,2]
-rm[1]
100%,100%,100%,1,0
-append[1,2,3] c
-/[-1] {128/$LMult}
-channels[-1] 0,1
-if {$ShowQuiver==0}
-vector2tensor[-1]
-smooth[-2] [-1],$Amplitude
-endif
-if {$ShowQuiver==1}
-quiver[-2] [-1],10,{$Amplitude/20},1,0.8,255
-endif
-rm[-1]
#@gimp Night hdr image black noise correction : gimp_fix_HDR_black, gimp_fix_HDR_black_preview(0)
#@gimp : Note =note("Filter to remove blue, magenta and red noise from the black areas of HDR images. Filter is designed specifically for HDR night shots but may work on other images as well. Bilateral filtering and Haar Wavelets are used to filter the noise from the image and mask is used to apply the noise removal only to dark areas.")
#@gimp : Sep = separator(), note=note("Mask opacity settings, Black values must be lower than Highlight values. Tick Show mask to view mask and to see the effect of the sliders.")
#@gimp : Note =note("Black cutoff")
#@gimp : X-coord(1) = int(20,0,255)
#@gimp : Y-coord(1) = int(25,0,255)
#@gimp : Note =note("Highlight raising")
#@gimp : X-coord(2) = int(50,0,255)
#@gimp : Y-coord(2) = int(200,0,255)
#@gimp : Show mask = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small> Author: Arto Huotari Latest update : <i>2013/11/02</i>.</small>")
gimp_fix_HDR_black:
-to_rgb[0]
X1=$1
Y1=$2
X2=$3
Y2=$4
ShowMask=$5
--gimp_bilateral[-1] 4,8,6,4,0
-gimp_haar_smoothing[-1] 0.6,5,2,3,1,24
--rgb2lab[-1]
-split[-1] c
-rm[-1,-2]
-gimp_apply_curve[-1] 0,$X1,$Y1,$X2,$Y2,-1,128,-1,128,-1,128,255,1,0,0,21,0
-if {$ShowMask==0}
-negative[-1]
-append[-2,-1] c
-to_rgba[-1]
-blend[0,-1] alpha
-keep[0]
-endif
gimp_fix_HDR_black_preview :
-gimp_split_preview "-gimp_fix_HDR_black ${1--2}",$-1
#@gimp Noise painting : gimp_noisepainting, gimp_noisepainting_preview(0)
#@gimp : Note = note("A preprocess suggestion for the painting filter.")
#@gimp : Sep = separator(), note = note("Pre process for painting")
#@gimp : Spread noise = int(0,0,20)
#@gimp : Additive noise = int(0,0,30)
#@gimp : Luminance only = bool(0)
#@gimp : Sep = separator(), note = note("Painting abstration")
#@gimp : Abstraction = int(5,1,10)
#@gimp : Details scale = float(2.5,0,5)
#@gimp : Color = float(1.5,0,4)
#@gimp : Smoothness = float(50,0,1000)
#@gimp : Sharpen shades = bool(1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small> Author: Arto Huotari Latest update : <i>2012/07/12</i>.</small>")
gimp_noisepainting :
DegrLarge=$1
DegrSmall=$2
Channel=$3
Abstr=$4
Details=$5
Color=$6
Smooth=$7
Sharp=$8
-to_rgb[0]
-if {$Channel} Channel=3 -elif Channel=0 -endif
-if $PreProcess -gimp_segment_watershed $EdgeThresh,$WaterSmooth,0,0 -endif
-if {$DegrLarge!=0} -gimp_spread $DegrLarge,$DegrLarge,0,0 -endif
-if {$DegrSmall!=0} -gimp_noise $DegrSmall,2,$Channel,0,0 -endif
-gimp_painting $Abstr,$Details,$Color,$Smooth,$Sharp,0
gimp_noisepainting_preview :
-gimp_split_preview "-gimp_noisepainting ${1--2}",$-1
#@gimp Pastell art : gimp_pastell, gimp_pastell_preview(1)
#@gimp : Masteropacity = float(0.6,0.3,1)
#@gimp : Bg textured = bool(1)
#@gimp : Reverse effect = bool(0)
#@gimp : Sep = separator(),note = note("Rodilius settings")
#@gimp : Amplitude = float(20,0,30)
#@gimp : Thickness = float(30,0,100)
#@gimp : Sharpness = float(300,0,1000)
#@gimp : Orientations = int(1,1,36)
#@gimp : Offset = float(30,0,180)
#@gimp : Color mode = choice(1,"Darker","Lighter")
#@gimp : Sep = separator(),note = note("Gradient settings")
#@gimp : Smoothness = float(1,0,10)
#@gimp : Linearity = float(0.5,0,1.5)
#@gimp : Negative colors = bool(0)
#@gimp : Sep = separator(),Activate Shakes = bool(0)
#@gimp : Amount = float(10,0,30)
#@gimp : Strenth = float(3,1,300)
#@gimp : Sep = separator(),Activate Lizards = bool(0)
#@gimp : Toes = float(9,0,300)
#@gimp : Shivers = float(3,0,4)
#@gimp : Sep = separator(),Activate Pink elephants = bool(0)
#@gimp : Trunks = float(12,0,100)
#@gimp : Sep = separator()
#@gimp : Sep = separator(), Preview type = choice(0,"Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Arto Huotari</i>.      Latest update : <i>2013/09/28</i>.</small>")
#@gimp : Note = link("Filter Explained here","http://www.flickr.com/photos/naggobot/6294075073/")
gimp_pastell :
MasterOpacity=$1
BgTextured=$2
ReverseEffect=$3
RAmplitude=$4
RThickness=$5
RSharpness=$6
ROrientations=$7
ROffset=$8
RColormode=$9
GSmoothness=$10
GLinearity=$11
GNegativeColors=$12
ActivateShakes=$13
RiAmplitude=$14
RiSize=$15
ActivateLizards=$16
WAmplitude=$17
WSmoothness=$18
ActivatePink=$19
RDeform=$20
RChannels=0
GMinThreshold=0
GMaxThreshold=100
RiShape=3
RiAngle=135
-if {$ActivatePink==1} -deform[0] $RDeform -endif
--gimp_rodilius[0] $RAmplitude,$RThickness,$RSharpness,$ROrientations,$ROffset,$RColormode,$RChannels,0
--gimp_gradient_norm[0] $GSmoothness,$GLinearity,$GMinThreshold,$GMaxThreshold,$GNegativeColors,0
-gimp_bilateral[0] 15,10,3,3,0
-if {$ActivateLizards==1} -water[0,2] $WAmplitude,$WSmoothness -endif
-if {$ActivateShakes==1} -ripple[0,2] $RiAmplitude,$RiSize,$RiShape,$RiAngle,0 -endif
-if {$ReverseEffect==1} -reverse[0,2] -endif
--blend[0,2] divide,1,0
-reverse[1,3]
-blend[1,3] value,1,0
-if {$BgTextured==1} -gimp_ellipsionism[0] 20,2,10,0.5,1,1,0 -endif
-blend[0,1] alpha,$MasterOpacity,0
-keep[0]
gimp_pastell_preview :
-gimp_split_preview "-gimp_pastell ${1--2}",$-1
#@gimp Smooth sketch : gimp_SmoothSketch, gimp_SmoothSketch_preview(0)
#@gimp : Note = note("Convert image to black and white sketch. By default gradient edges are used but if filter input set to Active and Below a premade edge layer can be used from the layer below. Sketch strength slider will not have any effect if premade edges layer is used.")
#@gimp : Sep = separator()
#@gimp : Note = note("Sketch and edges")
#@gimp : Create sketch = bool(1)
#@gimp : Sketch strength = float(6,0,20)
#@gimp : Sharpness = float(0.8,0,1)
#@gimp : Anisotropy = float(0.3,0.1,1)
#@gimp : Smoother scaling = float(0.3,0.1,2.5)
#@gimp : Smoother degradation = float(0,0,1)
#@gimp : Smoothing amplitude = float(1000,1,3000)
#@gimp : Smudge angle = float(0,-180,180)
#@gimp : Sep = separator()
#@gimp : Note = note("Empty area coloring")
#@gimp : Coloring density = float(50,0,200)
#@gimp : Coloring stroke length = float(10,0,100)
#@gimp : Coloring style = choice(2,"Linear","Angular","Linear wavy","Angular wavy")
#@gimp : Coloring opacity = float(0.6,0,1)
#@gimp : Sep = separator()
#@gimp : Note = note("Post processing parameters")
#@gimp : Post gamma = float(0.55,0.1,2)
#@gimp : Fast = bool(1)
#@gimp : Sep = separator(), Preview type = choice(0,"Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author : <i>Arto Huotari</i>.      Latest update : <i>2014/08/31</i>.</small>")
#@gimp : Note = link("Filter Explained here","http://www.flickr.com/groups/gmic/discuss/72157628307225747")
gimp_SmoothSketch :
UsmRadius=5
CreateSketch=$1
UsmAmount=$1
Sharpness=$2
Anisotropy=$3
SmScale=$4
SmAccuracy={$5}
Amplitude=$6
fi=$7
Density=$8
BlurLength=$9
Style=$10
BgOpacity=$11
PostGamma=$12
OptimizedResult=$13
-if $OptimizedResult
OriginalWidth=@{0,w}
#Resize to 1024 width (all in case a bottom layer is included
-resize2dx 1024
-gimp_selective_smoothing[-1] 5,0.5,5,1,0,0,24,0
-endif
-if {$CreateSketch==1}
#Unsharp to enhance edges and detail
#-unsharp[-1] $UsmRadius,$UsmAmount
-gimp_unsharp[-1] 0,$UsmRadius,30,$UsmAmount,0,1,1,1,0,0,0
#Gradient norm for lines
--gradient_norm[-1]
#Invert for white bg
-negative[-1]
#Normalize for max range
-normalize[-1] 0,255
-endif
(255;255;255)
-r[-1] [-2]
-gimp_noise[-1] $Density,0,3,0,0
-if {$Style==0}
-gimp_blur_linear[-1] $BlurLength,0,135,500,1,3,0,0
-endif
-if {$Style==1}
-gimp_blur_angular[-1] $BlurLength,1.2,1.2,0,0,0
-endif
-if {$Style==2}
-gimp_blur_linear[-1] $BlurLength,0,135,500,1,3,0,0
-deform[-1] {$Density/5}
-endif
-if {$Style==3}
-gimp_blur_angular[-1] $BlurLength,1.2,1.2,0,0,0
-deform[-1] {$Density/5}
-endif
-blend[-1,-2] multiply,$BgOpacity,0
-normalize[-1] 0,255
--diffusiontensors[0] $Sharpness,$Anisotropy,0.6,1.1,0
-rotation3d 0,0,1,{$fi}
-mix_channels[-2] (@{-1,0-2};@{-1,3-5};@{-1,6-8})
-rm[-1]
-mul[-1] {$SmScale/max(abs(@{-1,M}),abs(@{-1,m}))}
-noise[-1] {$SmAccuracy*max(abs(@{-1,M}),abs(@{-1,m}))}
-reverse[-1,-2]
-smooth[-1] [-2],$Amplitude
-keep[-1]
-apply_gamma[-1] $PostGamma
-if $OptimizedResult
-resize2dx $OriginalWidth
-endif
gimp_SmoothSketch_preview :
-gimp_split_preview "-gimp_SmoothSketch ${1--2}",$-1
#@gimp Vector field rotation demo : gimp_DemoVecRot, gimp_DemoVecRot
#@gimp : Note =note("Vector field rotation and quiver sample")
#@gimp : Angle shift = float(0,-180,180)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Arto Huotari</i> with help from <i>David Tschumperl&#233;</i>.     Latest update : <i>2012/02/25</i>.</small>")
gimp_DemoVecRot :
angle=$1
-to_rgb[0]
[0]
-to_rgb[-1]
-split[-1] c
--[-2] 128
--[-3] 128
-append[-3,-2,-1] c
-channels[-1] 0,1
-/[-1] 128
#200,200,1,2 200x200x1 px only two channels
-rotation3d 0,0,1,$angle
-z[-1] 0,0,1,1
-mix_channels[-2] (@{-1,0-1};@{-1,2-3})
-rm[-1]
-quiver[-2] [-1],10,10,1,0.8,255
-keep[-2]
#@gimp Warp test : gimp_WarpTest, gimp_WarpTest
#@gimp : Sep = separator()
#@gimp : Note =note("Two layers required if automap is not used. <b>Set input to active and below</b>. Filter offsetts image with a vector field map. Map is created from R and G channels so that R128,G128 becomes [0 0]. Experiment with solid 128,128,0 color layer and add hues of red and green. Angle shift rotates the vector field and Zero point offset moves the default 0 0 point. This is mainly for fun and testing.")
#@gimp : Sep = separator()
#@gimp : Map type = choice("Automap","Layer Map")
#@gimp : Angle shift = float(0,-180,180)
#@gimp : Zero point offset = float(0,-128,128)
#@gimp : Vector length multipler = float(1,0.1,128)
#@gimp : Sep = separator()
#@gimp : Note = note("Optional viewing of vector field")
#@gimp : Show quiver = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author : <i>Arto Huotari</i>.      Latest update : <i>2012/02/28</i>.</small>")
gimp_WarpTest :
MapType=$1
fi={$2*3.1415/180}
ZeroOffset=$3
LMult=$4
ShowQuiver=$5
-if {$MapType==0}
--gimp_local_orientation 0.5,0,100,0,4,0
-endif
cosfi={cos($fi)}
sinfi={sin($fi)}
-to_rgb[-2,-1]
--[-1] {128+$ZeroOffset}
-split[-1] c
-mul[3] 0
--mul[1] $cosfi
--mul[2] $sinfi
-sub[4] [5]
-rm[5]
--mul[1] $sinfi
--mul[2] $cosfi
-add[5] [6]
-rm[6]
-rm[1,2]
-rm[1]
100%,100%,100%,1,0
-append[1,2,3] c
-/[-1] {128/$LMult}
-channels[-1] 0,1
-if {$ShowQuiver==0}
-warp[-2] [-1],1,1,0
-endif
-if {$ShowQuiver==1}
-quiver[-2] [-1],10,{$LMult/100},1,0.8,255
-endif
-rm[-1]
#@gimp _
#@gimp <i>Okyl168</i>
#@gimp Jobs colors : gimp_jobs_colors, gimp_jobs_colors_preview
#@gimp : Gamma = float(0,-2,2)
#@gimp : Equalize = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Oberon Leung</i>.      Latest update: <i>01/25/2014</i>.</small>")
gimp_jobs_colors :
-n 0,255 -if $2 -equalize 256 -endif
-luminance -apply_gamma {10^$1} -n 0,9 -round
(22,187,20,36,235,240,245,243,247,209^18,97,147,157,79,110,121,142,170,200^19,158,192,60,67,65,64,64,64,185)
-map[^-1] [-1] -rm[-1]
gimp_jobs_colors_preview :
-gimp_split_preview "-gimp_jobs_colors $*",$-1
#@gimp _
#@gimp <i>Photocomix</i>
#@gimp B&amp;W steampunk pencil : gimp_steampen, gimp_steampen_preview(0)
#@gimp : Sep = separator()
#@gimp : Radius = float(0.95,0,4)
#@gimp : Amplitude = float(14,0,200)
#@gimp : Iterations = int(2,1,20)
#@gimp : Steam pressure = int(2,1,30)
#@gimp : Lubrication = float(0.9,0,1.9)
#@gimp : Sep = separator()
#@gimp : Contrast fx = choice("None-Skip","L Normalization","Mask","Boost","Fast Tone Map")
#@gimp : Equalize = bool(true)
#@gimp : Sep = separator()
#@gimp : Note = note(" For a more "painted" effect")
#@gimp : Add painter's touch = bool(false)
#@gimp : Note = note("If unchecked the 3 sliders below are disabled")
#@gimp : Sep = separator ()
#@gimp : Painter's touch sharpness = float(0.5,0,2)
#@gimp : Painter's edge protection flow = float(0.75,0,1)
#@gimp : Painter's smoothness = float(0.48,0,10)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Last update : <i>2011/6/29 </i>.</small>")
gimp_steampen :
-repeat @# -l[$>] -split_opacity -l[0]
-gimp_pencilbw $1,$2,0,0,0
-gimp_kuwahara $3,$4,0,0
-blur_xy $5
-if {$6==1} -gimp_normalize_local 4.8,22,6.89,20,1,3,0
-elif {$6==2} -gimp_contrast_swm 2,0,1
-elif {$6==3} -gimp_contrast_swm 2,1,1
-elif {$6==4} -gimp_map_tones_fast 3,0.5,3, -endif
-if {$7==1} -equalize 255 -endif
-if {$8==1} -gimp_anisotropic_smoothing 60,$9,$10,$11,1.1,0.8,30,2,0,1,1,0 -endif
-endl -a c -endl -done
gimp_steampen_preview :
-gimp_split_preview "-gimp_steampen ${1--2}",$-1
#@gimp Boost screen : gimp_compose_boostscreen,gimp_compose_boostscreen
#@gimp : Opacity = float(0.7,0,1)
#@gimp : Revert layers = bool(0)
#@gimp : Opacity 2 = float(0.7,0,1)
#@gimp : Note = note ("This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>11/13/2011</i>.</small>")
gimp_compose_boostscreen :
-repeat @# -l[$>]
-gimp_compose_screen $1,$2 [-1] -gimp_compose_grainmerge $3,0
-endl -done
#@gimp Color doping : gimp_compose_colordoping , gimp_compose_colordoping
#@gimp : Opacity = float(1,0,1)
#@gimp : Revert layers = bool(0)
#@gimp : Note = note ("This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>11/13/2011</i>.</small>")
gimp_compose_colordoping :
-reverse -gimp_compose_lightness 1,$2 [^] -gimp_compose_multiply $1,0
#@gimp Color sketch : gimp_colorsketchbw, gimp_colorsketchbw_preview(0)
#@gimp : Amplitude = float(300,0,4000)
#@gimp : Density = float(50,0,100)
#@gimp : Smoothness = float(1,0,10)
#@gimp : Opacity = float(0.1,0,1)
#@gimp : Edge = float(20,0,100)
#@gimp : Fast approximation = bool(1)
#@gimp : Negative = bool(0)
#@gimp : Quantize colors = int (20,2,255)
#@gimp : Color smoothness = float(2,0.50,30)
#@gimp : Mixer mode = choice( "Color Doping","Darken","Hard Light","Grain Merge","Lightness","Multiply","Value")
#@gimp : Color intensity =float (1,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>12/29/2010</i>.</small>")
gimp_colorsketchbw :
--blur $3 -hardsketchbw[-1] $1,$2,$4,$5,$6
-if $7 -negative[-1] -endif
-quantize[-2] $8  -to_rgb  -blur_xy[-2] $9,$9
-if {$10==0} -gimp_compose_colordoping $11,0
-elif {$10==1} -gimp_compose_darken $11,0
-elif {$10==2} -gimp_compose_hardlight $11,1
-elif {$10==3} -gimp_compose_grainmerge $11,1
-elif {$10==4} -gimp_compose_lightness $11,1
-elif {$10==5} -gimp_compose_multiply $11,0
-elif {$10==6} -gimp_compose_value $11,1 -endif
gimp_colorsketchbw_preview :
-gimp_split_preview "-gimp_colorsketchbw ${1--2}",$-1
#@gimp Color stamp : gimp_colorstamp, gimp_colorstamp_preview(0)
#@gimp : Note = note ("BW module,analog to "Stamp"filter")
#@gimp : Sep = separator()
#@gimp : Auto-threshold = bool(1)
#@gimp : Threshold = int(50,0,100)
#@gimp : Sep = separator()
#@gimp : Note = note ("Color module")
#@gimp : Activate color module = bool(1)
#@gimp : Quantize colors =int(20,2,255)
#@gimp : Color smoothness = float(2,0,20)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Authors: <i>PhotoComiX , Antaron, Mahvin, David Tschumperl&#233;</i>.             Latest update : 05/17/2011.</small>")
gimp_colorstamp :
-repeat @# -l[$>] -split_opacity -l[0]
--norm
-if $1 -otsu[-1] 256 -else -t[-1] $2% -endif
-n[-1] 0,255
-apply_curve[-1] 1,0,0,101,33,170,229,255,255
-if {$3==1} -quantize[-2] $4 -to_rgb -blur_xy[-2] $5
-gimp_compose_darken 1,0 -endif
-endl -a c -endl -done
gimp_colorstamp_preview :
-gimp_split_preview "-gimp_colorstamp ${1--2}",$-1
#@gimp Comix colors : gimp_compose_comix_color,gimp_compose_comix_color
#@gimp : Opacity = float(1,0,1)
#@gimp : Revert layers = bool(0)
#@gimp : Opacity 2 = float(1,0,1)
#@gimp : Note = note ("This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>11/13/2011</i>.</small>")
gimp_compose_comix_color :
-rv -gimp_compose_lightness $1,$2 [^] -gimp_compose_grainmerge $3,0
#@gimp Dark edges : gimp_compose_darkedges, gimp_compose_darkedges(0)
#@gimp : Opacity = float(1,0,1)
#@gimp : Edges smoothness = float(0.5,0,5)
#@gimp : Revert layers = bool(0)
#@gimp : Opacity 2 = float(0.7,0,1)
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>11/13/2011</i>.</small>")
gimp_compose_darkedges :
-gimp_compose_edges $1,$2,$3 [^] -gimp_compose_multiply $4,0
#@gimp Dark screen : gimp_compose_darkscreen,gimp_compose_darkscreen
#@gimp : Opacity = float(0.7,0,1)
#@gimp : Revert layers = bool(0)
#@gimp : Opacity 2 = float(0.7,0,1)
#@gimp : Note = note ("This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>11/13/2011</i>.</small>")
gimp_compose_darkscreen :
-repeat @# -l[$>]
-gimp_compose_screen $1,$2 [-1] -gimp_compose_multiply $3,0
-endl -done
#@gimp Graphic colors : gimp_compose_graphicolor,gimp_compose_graphicolor
#@gimp : Opacity = float(0.6,0,1)
#@gimp : Revert layers = bool(0)
#@gimp : Opacity 2 = float(0.8,0,1)
#@gimp : Note = note ("This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers. ")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>11/13/2011</i>.</small>")
gimp_compose_graphicolor :
-reverse --gimp_compose_luminance $1,$2, -rm[-2] -gimp_compose_softlight $3,0
#@gimp Graphic novel-old : gimp_novelfx, gimp_novelfx_preview(0)
#@gimp : Sep = separator ()
#@gimp : Note = note("Apply Local Normalization")
#@gimp : Skip this step = bool(false)
#@gimp : Sep = separator ()
#@gimp : Note = note(" Local Normalization Controls")
#@gimp : Ln amplititude = float(2,0,60)
#@gimp : Ln size = float(6,0,64)
#@gimp : Ln neightborhood-smoothness = float(5,0,40)
#@gimp : Ln average-smoothness = float(20,0,40)
#@gimp : Sep = separator()
#@gimp : Skip all other steps = bool(false)
#@gimp : Sep = separator()
#@gimp : Sep = separator()
#@gimp : Note = note(" Pencil Options")
#@gimp : Pencil size = float(0.62,0,4)
#@gimp : Pencil amplitude = float(14,0,200)
#@gimp : Sep = separator()
#@gimp : Skip all other steps = bool(false)
#@gimp : Sep = separator()
#@gimp : Sep = separator()
#@gimp : Activate "pencil smoother" = bool(true)
#@gimp : Note = note(" If unchecked the 3 sliders below are disabled ")
#@gimp : Sep = separator()
#@gimp : Pencil smoother sharpness = float(0.5,0,2)
#@gimp : Pencil smoother edge protection = float(0.78,0,1)
#@gimp : Pencil smoother smoothness = float(1.92,0,10)
#@gimp : Sep = separator()
#@gimp : Skip all other steps = bool(false)
#@gimp : Sep = separator ()
#@gimp : Sep = separator()
#@gimp : Note = note ("Boost Merging Options")
#@gimp : Swap layers = bool (false)
#@gimp : Boost merging option = choice("Overlay","Multiply","Soft light","Color Burn","Darken","Stamp","Hard Light","Value","Grain Merge","Freeze")
#@gimp : Opacity = float(1,0,1)
#@gimp : Sep = separator ()
#@gimp : Add painter's touch = bool(true)
#@gimp : Sep = separator ()
#@gimp : Painter's touch sharpness = float(0.5,0,2)
#@gimp : Painter's edge protection flow = float(0.8,0,1)
#@gimp : Painter's smoothness =float(1.28,0,10)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>04/24/2011</i>.</small>")
#@gimp : Note = link("Filter explained here","http://www.gimpchat.com/viewtopic.php?f=9&t=1582")
gimp_novelfx :
-repeat @# -l[$>] -split_opacity -l[0]
-if {$1==0} -gimp_normalize_local $2,$3,$4,$5,1,3,0 -endif
-if {$6==0} --gimp_pencilbw $7,$8,0,0,0 -endif
-if {$9==1} -keep[-1] -break -endif
-if {$10==1} -gimp_anisotropic_smoothing[-1] 60,$11,$12,$13,1.1,0.8,30,2,0,1,1,0 -endif
-if {$14==1} -keep[-1] -break -endif
-if {$15==1} -reverse -endif
-if {$16==0} -gimp_compose_overlay[-1,0] $17
-elif {$16==1} -gimp_compose_multiply[-1,0] $17
-elif {$16==2} -gimp_compose_softlight[-1,0] $17
-elif {$16==3} -gimp_compose_colorburn[-1,0] $17
-elif {$16==4} -gimp_compose_darken[-1,0] $17
-elif {$16==5} -gimp_compose_stamp[-1,0] $17
-elif {$16==6} -gimp_compose_hardlight[-1,0] $17
-elif {$16==7} -reverse[1,0] -gimp_compose_value[-1,0] $17,0
-elif {$16==8} -gimp_compose_grainmerge[-1,0] $17
-elif {$16==8} -gimp_compose_freeze[-1,0] $17 -endif
-if {$18==1} -gimp_anisotropic_smoothing 60,$19,$20,$21,1.1,0.8,30,2,0,1,1,0 -endif
-endl -a c -endl -done
gimp_novelfx_preview :
-gimp_split_preview "-gimp_novelfx ${1--2}",$-1
#@gimp Graphix colors : gimp_compose_graphixcolor,gimp_compose_graphixcolor
#@gimp : Opacity = float(1,0,1)
#@gimp : Revert layers = bool(0)
#@gimp : Note = note ("This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>11/13/2011</i>.</small>")
gimp_compose_graphixcolor :
-reverse --gimp_compose_value 1,$2 -keep[-1,-3] -gimp_compose_grainmerge $1,0
@gimp Graphic boost-old : gimp_graphic_boost, gimp_graphic_boost_preview(0)
#@gimp : Sep = separator ()
#@gimp : Note = note("Unsharp Mask controls")
#@gimp : Radius = float(1.25,0,20)
#@gimp : Darken = float(2,0,10)
#@gimp : Sep = separator()
#@gimp : Skip others steps = bool(false)
#@gimp : Note = note("Check for visual control, UNcheck to reactivate the other controls")
#@gimp : Sep = separator()
#@gimp : Sep = separator()
#@gimp : Note = note("BW_Pencil Controls")
#@gimp : Pencil size = float(0.15,0,4)
#@gimp : Pencil amplitude = float(14,0,200)
#@gimp : Sep = separator()
#@gimp : Skip others steps = bool(false)
#@gimp : Sep = separator ()
#@gimp : Sep = separator ()
#@gimp : Activate "pencil smoother" = bool(true)
#@gimp : Note = note(" If unchecked the 3 sliders below are disabled ")
#@gimp : Pencil smoother sharpness = float(0.5,0,2)
#@gimp : Pencil smoother edge protection = float(0.45,0,1)
#@gimp : Pencil smoother smoothness = float (2,0,10)
#@gimp : Sep = separator()
#@gimp : Skip others steps = bool(false)
#@gimp : Sep = separator ()
#@gimp : Sep = separator ()
#@gimp : Note = note("Merging Options")
#@gimp : Swap layers = bool (True)
#@gimp : Note = note (""Swap" change the effect of Merging and Intesity")
#@gimp : Merging option = choice( "Hard Light","Grain Merge","Multiply","Color Burn","Overlay" ,"Value","Darken" ,"Stamp" )
#@gimp : Intensity = float(1,0,1)
#@gimp : Sep = separator ()
#@gimp : Add painter's touch = bool(true)
#@gimp : Note = note("If unchecked the 3 sliders below are disabled")
#@gimp : Sep = separator ()
#@gimp : Painter's touch sharpness = float(0.5,0,2)
#@gimp : Painter's edge protection flow = float(0.45,0,1)
#@gimp : Painter's smoothness =float(1,0,10)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>01/10/2011</i>.</small>")
#@gimp : Note = link("Filter explained here","http://www.gimpchat.com/viewtopic.php?f=9&t=775")
gimp_graphic_boost :
-repeat @# -l[$>] -split_opacity -l[0]
-gimp_unsharp 1,$1,30,3,0,$2,0.40,1,0,0,0
-if {$3==1} -break -endif
--gimp_pencilbw $4,$5,0,0,0
-if {$6==1} -keep[-1] -break -endif
-if {$7==1} -gimp_anisotropic_smoothing[1] 60,$8,$9,$10,1.1,0.8,30,2,0,1,1,0 -endif
-if {$11==1} -keep[-1] -break -endif
-if {$12==1}  -reverse -endif
-if {$13==0} -gimp_compose_hardlight $14
-elif {$13==1} -gimp_compose_grainmerge $14
-elif {$13==2} -gimp_compose_multiply $14
-elif {$13==3} -gimp_compose_colorburn $14
-elif {$13==4} -gimp_compose_overlay $14
-elif {$13==5} -gimp_compose_value $14,0
-elif {$13==6} -gimp_compose_darken $14
-elif {$13==7} -gimp_compose_stamp $14 -endif
-if {$15==1} -gimp_anisotropic_smoothing 60,$16,$17,$18,1.1,0.8,30,2,0,1,1,0 -endif
-endl -a c -endl -done
gimp_graphic_boost_preview :
-gimp_split_preview "-gimp_graphic_boost ${1--2}",$-1
#@gimp Heavy screen : gimp_compose_heavyscreen, gimp_compose_heavyscreen
#@gimp : Opacity = float(0.6,0,1)
#@gimp : Revert layers = bool(0)
#@gimp : Opacity 2 = float(0.7,0,1)
#@gimp : Note = note ("This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers ")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>11/13/2011</i>.</small>")
gimp_compose_heavyscreen :
-repeat @# -l[$>]
-gimp_compose_screen $1,$2 [-1] -gimp_compose_colorburn $3,0
-endl -done
#@gimp Metallic grain : gimp_metalgrain, gimp_metalgrain_preview
#@gimp : Note = note("add a metallic grain adapt to pictorial and special effects")
#@gimp : Sep = separator()
#@gimp : Note = note("dependent from "Couleurs Metalliques" by Samj ")
#@gimp : Sep = separator()
#@gimp : Intensity = float(0.5,0.1,1)
#@gimp : Swap layers = bool(false)
#@gimp : Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComix,a hack of a Samj filter</i>.      Latest update : <i>02/29/2012</i>.</small>")
gimp_metalgrain :
--Couleurs_Metalliques 1,1,19.86,0,0,0,7.4,11,3.96,20,1,0,0,1,1.9,10.2,1,0,0
-gimp_compose_overlay  $1,$2
gimp_metalgrain_preview :
-gimp_split_preview "-gimp_metalgrain ${1--2}",$-1
#@gimp Metallic stencils : gimp_metallicstencils , gimp_metallicstencils_preview
#@gimp : Set mode = choice("Darken","Lighten","Overlay")
#@gimp : Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComix,a hack of a Samj filter</i>.      Latest update : <i>10/03/2012</i>.</small>")
gimp_metallicstencils :
--Couleurs_Metalliques 0,1,22,0,0,1,7.8,9,7.6,16.6,1,0,0,1,2.4,8.2,1,0
--gimp_lylejk_stencil[0] 4,26.7045,2.41477,0
-rm[0]
-if {$1==0} -gimp_compose_darken 1,0
-elif {$1==1} -gimp_compose_lighten 1,0
-elif {$1==2} -gimp_compose_overlay 1,0 -endif
gimp_metallicstencils_preview :
-gimp_split_preview "-gimp_metallicstencils ${1--2}",$-1
jl_hsv_to_rgb :
({360*$1}^$2^$3) -hsv2rgb[-1] -u @-1 -rm[-1]
levels :
_inplow={int($1)}
_inphigh={int($2)}
_gamma=$3
_outlow={int($4)}
_outhigh={int($5)}
_tmp2=""
-if {$_gamma!=1}
_tmp2="-apply_gamma "$_gamma
-apply_channels_old $_tmp2,$6,0
-endif
_curve1="0,"
-if {$_inplow>0}
_tmp1="0,"
_curve1=$_curve1$_tmp1$_outlow","
-endif
_curve1=$_curve1$_inplow","$_outlow","$_inphigh","$_outhigh
-if {$_inphigh<255}
_curve1=$_curve1",255,"$_outhigh
-endif
-if {$_curve1'!='"0,0,0,255,255"}
_tmp2="-apply_curve "$_curve1
-apply_channels_old $_tmp2,$6,0
-endif
gimp_equalize_s :
-repeat @# -l[$>] -split_opacity -l[0] -to_rgb
-rgb2hsv -sh 1,1 -*[-1] $1 -+[-1] $2 -c[-1] 0,1 -rm[-1] -hsv2rgb
-endl -a c -endl -done
#@gimp Phoenix steam-pencil : gimp_phoenix, gimp_phoenix_preview(0)
#@gimp : Sep = separator()
#@gimp : Note = note( "Controls for "Pencil" applied on a copy of original )
#@gimp : Sep = separator()
#@gimp : Radius = float(0.95,0,4)
#@gimp : Amplitude = float(14,0,200)
#@gimp : Sep = separator()
#@gimp : Note = note( "Controls for "Steam" applied on the Pencil layer )
#@gimp : Sep = separator()
#@gimp : Iterations = int(2,1,7)
#@gimp : Steam pressure = int(2,1,7)
#@gimp : Lubrication = float(0.9,0,1.9)
#@gimp : Sep = separator()
#@gimp : Note = note( "To exit here or merge with the original")
#@gimp : Bw or colours = choice ( "Black and White", "Colours" )
#@gimp : Note = note(" to activate the Merging Options below chose "Colours"" )
#@gimp : Sep = separator()
#@gimp : Swap layers = bool(0)
#@gimp : Merging options = choice("Value","Lightness","Luminance","*Colors Doping*","*Comix Colors*","Graphic Colors*" ,*Dark Edges*", "*Vivid Edges*","Multiply","Color Burn","Darken","Lighten","Hard Light","Soft Light","Overlay","Grain Merge","Edges","Interpolation" )
#@gimp : Opacity = float (1,0,1)
#@gimp : *intensity* = float (1,0,1)
#@gimp : Sep = separator(),
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Last update : <i>2011/11/14 </i>.</small>")
#@gimp : Note = link("Filter how to and help","http://www.gimpchat.com/viewtopic.php?f=9&t=2983")
gimp_phoenix :
--gimp_pencilbw $1,$2,0,0,0
-gimp_kuwahara[1] $3,$4,0,0
-to_rgb[-1] -blur_xy[1] $5
-if {$6==0} -remove[0] -return -endif
-if {$8==0} -reverse -gimp_compose_value $9,$7
-elif {$8==1} -reverse -gimp_compose_lightness $9,$7
-elif {$8==2} -reverse -gimp_compose_luminance $9,$7
-elif {$8==3} -gimp_compose_colordoping $9,$7
-elif {$8==4} -gimp_compose_comix_color $9,$7,$10
-elif {$8==5} -gimp_compose_graphicolor $9,0,$7
-elif {$8==6} -gimp_compose_graphixcolor $9,$7
-elif {$8==7} -gimp_compose_vividedges $9,0.50,$7,$10
-elif {$8==8} -gimp_compose_darkedges $9,0.50,$7,$10
-elif {$8==6} -gimp_compose_multiply $9,$7
-elif {$8==7} -gimp_compose_colorburn $9,$7
-elif {$8==8} -gimp_compose_darken $9,$7
-elif {$8==9} -gimp_compose_lighten $9,$7
-elif {$8==10} -gimp_compose_screen $9,$7
-elif {$8==11} -gimp_compose_hardlight $9,$7
-elif {$8==12} -gimp_compose_softlight $9,$7
-elif {$8==13} -gimp_compose_overlay $9,$7
-elif {$8==14} -gimp_compose_grainmerge $9,$7
-elif {$8==15} -gimp_compose_edges $9,0.80,$7
-elif {$8==16} -gimp_compose_interpolation $9,$7  -endif
gimp_phoenix_preview :
-gimp_split_preview "-gimp_phoenix ${1--2}",$-1
#@gimp Photocomix smoothing : gimp_anisotropic_smoothing, gimp_anisotropic_smoothing(0)
#@gimp : Amplitude = float(60,0,1000)
#@gimp : Sharpness = float(0.16,0,2)
#@gimp : Anisotropy = float(0.63,0,1)
#@gimp : Gradient smoothness = float(0.6,0,10)
#@gimp : Tensor smoothness = float(2.35,0,10)
#@gimp : Spatial precision = float(0.8,0.1,2)
#@gimp : Angular precision = float(30,1,180)
#@gimp : Value precision = float(2,0.1,5)
#@gimp : Interpolation = choice(0,"Nearest neighbor","Linear","Runge-Kutta")
#@gimp : Fast approximation = bool(1)
#@gimp : Iterations = int(1,1,10)
#@gimp : Channel(s) = choice("RGB","Luminance","Blue & Red chrominances","Blue chrominance","Red chrominance")
#@gimp : Tiles = int(1,1,10)
#@gimp : Note = note{"\n<small><b>Note : </b>This set of anisotropic smoothing parameters has been suggested by PhotoComiX.</small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>12/29/2010</i>.</small>")
#@gimp Psychedelic glasswork tiler : gimp_psyglass, gimp_psyglass_preview(1)
#@gimp : Sep = separator()
#@gimp : Note = note("Stained Glass controls")
#@gimp : White separators = bool(false)
#@gimp : Edges = float(20,0,100)
#@gimp : Shading = float(0.1,0,0.5)
#@gimp : Thin separators = bool(1)
#@gimp : Equalize = bool(1)
#@gimp : Sep = separator()
#@gimp : Sep = separator()
#@gimp : Note = note("To skip Layer Fx set Opacity to 0")
#@gimp : Sep = separator()
#@gimp : Layer fx = choice("Grain Merge","Hard Light","Soft Light","Overlay","Color Burn ","Multiply")
#@gimp : Opacity = float(1,0,1)
#@gimp : Sep = separator()
#@gimp : Sep = separator()
#@gimp : Note = note("Quick Corrections and Special Fx")
#@gimp : Apply mask = bool(true)
#@gimp : Note = note(" Contrast Mask preset")
#@gimp : Sep = separator()
#@gimp : Raise local contrast = bool(false)
#@gimp : Note = note("Local Normalization preset")
#@gimp : Sep = separator()
#@gimp : Sep = separator()
#@gimp : Note = note("Mirrors Controls")
#@gimp : Activate mirrors = bool(true)
#@gimp : Sep = separator()
#@gimp : Iterations = int(1,1,10)
#@gimp : X-offset = float(0,0,100)
#@gimp : Y-offset = float(0,0,100)
#@gimp : Array mode = choice(2,"X-axis","Y-axis","XY-axes","2XY-axes")
#@gimp : Initialization = choice("Original","Mirror X","Mirror Y","Rotate 90 deg.","Rotate 180 deg.","Rotate 270 deg.")
#@gimp : Expand size = _bool(false)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator()
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>. Latest update : <i>03/30/2011</i>.</small>")
gimp_psyglass :
-repeat @# -l[$>] -split_opacity -l[0]
-if {$1==0}
-blur 0.1 -stained_glass $2,$3,$4 -n 0,255
-elif {$1==1}
-negative -blur 0.1 -stained_glass $2,$3,$4 -n 0,255 -negative
-endif
-if $5 -equalize 256 -endif
--blur 0.9
-if {$6==0} -gimp_compose_grainmerge $7
-elif {$6==1} -gimp_compose_hardlight $7
-elif {$6==2} -gimp_compose_softlight $7
-elif {$6==3} -gimp_compose_overlay $7
-elif {$6==4} -gimp_compose_colorburn $7
-elif {$6==5} -gimp_compose_multiply $7
-endif
-if {$8==1} -gimp_contrast_swm 2,0,1,0 -endif
-if {$9==1} -gimp_normalize_local 2,6,5,20,1,3,0 -endif
-if $10
-if {$15==1} -mirror x
-elif {$15==2} -mirror y
-elif {$15==3} -rotate 90
-elif {$15==4} -rotate 180
-elif {$15==5} -rotate 270
-endif
-array_mirror $11,$14,$16
-shift -$12%,-$13%,0,0,2
-endif
-endl -a c -endl -done
gimp_psyglass_preview :
-gimp_split_preview " -gimp_psyglass ${1--2}",$-1
#@gimp Scale down neat : gimp_scaledown3, gimp_scaledown3_preview(0)
#@gimp : Sep = separator()
#@gimp : Note = (" To scale down preserving clean edges and smoothly sharpen")
#@gimp : Sep = separator()
#@gimp : Automatic pre-blur = bool(false)
#@gimp : Sep = separator()
#@gimp : Note = note(  "Automatic pre-blur" disable the 2 sliders below" )
#@gimp : Sep = separator()
#@gimp : Blur x = float (1,0.2,4)
#@gimp : Blur y = float (1,0.2,4)
#@gimp : Sep = separator()
#@gimp : Scale down to = choice(1," New Width and Height  ", " preserve_image_ratio Set new Width " , "preserve_image_ratio Set new Height",)
#@gimp : New width = int(1600,16,3200)
#@gimp : New height = int(1600,16,3200)
#@gimp : Sep = separator()
#@gimp : Skip post sharpening = bool(false)
#@gimp : Sep = separator()
#@gimp : Note = note( ""Skip Post Sharpening": if chosen will deactivate all controls below " )
#@gimp : Sep = separator()
#@gimp : Amount = float(2.3,0,10)
#@gimp : Darkness/lightness level = float(1,0,4)
#@gimp : Channel(s) = choice(3,"All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Alpha","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator()
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComix</i>.      Latest update : <i>09/25/2012</i>.</small>")
gimp_scaledown3 :
-if {$1==0 && $4==0} -blur_xy {w/$5},{h/$6}
-elif {$1==0 && $4==1} -blur_xy {w/$5},{w/$6}
-elif {$1==0 && $4==2} -blur_xy {h/$5},{w/$6}
-elif {$1==1 && $4==0} -blur_xy $2 ,$3
-elif {$1==1 && $4==1} -blur_xy $2 ,$3
-elif {$1==1 && $4==2} -blur_xy $2 ,$3
-endif
-if {$4==0}
-resize $5,$6,2
-elif {$4==1}
-resize2dx $5,2
-elif {$4==2}
-resize2dy $6,2
-endif
-if {$7==0}
-gimp_unsharp 0,1.25,30,$8,0,$9,{$9/3},1,0,$10
-endif
gimp_scaledown3_preview :
-gimp_split_preview "-gimp_scaledown3 ${1--2}",$-1
#@gimp Symmetry master : gimp_viral,gimp_viral
#@gimp : Scale = float(3,0,15)
#@gimp : Mixer = choice ("Average","Grain Extract","Vivid Edges","Difference", "Exclusion"," Negation")
#@gimp : Remix = choice ( "Vivid Edges", "Average", "Difference","Negation","Dark Edges")
#@gimp : Photocomix preset = choice( "Neat Merge","Lighty Smooth","Dream","Moody","Soft","Naif","Dark Boost","Whitening"," None- Skip" )
#@gimp : Activate mirror = choice ("No-Skip", XY Mirror"," 2XY Mirror")
#@gimp : Sep = separator()
#@gimp : Note = note("WARNING,"Expanding Mirrors" multiply image size of x4 or if "2XY Mirrors" x9")
#@gimp : Sep = separator()
#@gimp : Expanding mirrors = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComix</i>.      Latest update : <i>11/13/2011</i>.</small>")
gimp_viral :
-gimp_rorschach $1,1,1
--mirror y
-if {$2==0} -gimp_compose_average 1,0
-elif {$2==1} -gimp_compose_grainextract 1,0
-elif {$2==1} -gimp_compose_vividedges 1,1,0.5,1 -endif
--gimp_array_mirror 1,0,0,2,0,0
-if {$3==0} -gimp_compose_vividedges 1,1,0.5,1
-elif {$3==1} -gimp_compose_average 1,0
-elif {$3==2} -gimp_compose_difference 1,0
-elif {$3==3} -gimp_compose_negation 1,0
-elif {$3==4} -gimp_compose_negation 1,0
-elif {$3==5} -gimp_compose_darkedges 1,1,0.8,1 -endif
-if {$4==0} -gimp_graphic_novelfxl 0,2,6,5,20,0,0.62,14,0,1,0.5,0.78,1.92,0,0,12,1,1,1,0.5,0.8,1.28,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,0,1,1,1,0.5,0.45,1
-elif {$4==1}-gimp_graphic_novelfxl 0,7.2,14.65,5,20,0,1.06,36.14,0,1,0.5,0.85,1.93,0,0,8,1,1,1,0.5,0.95,2.89,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,0,1,1,1,0.5,0.45,1
-elif {$4==2} -gimp_graphic_novelfxl 0,7.22892,14.6506,5,20,0,1.6,36.1,0,1,0.5,0.6,3.6,0,0,11,1,1,1,0.5,0.8,2.16,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,7,1,1,1,0.5,0.45,1
-elif {$4==3}  -gimp_graphic_novelfxl 0,7.22892,14.6506,5,20,0,1.59036,36.1446,0,1,0.5,0.590361,3.61446,0,1,17,1,1,1,0.5,0.795181,2.16867,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,7,1,1,1,0.5,0.45,1
-elif {$4==4} -gimp_graphic_novelfxl 0,7.22892,14.6506,5,20,0,1.59036,36.1446,0,1,0.5,0.855422,1.92771,0,0,8,1,1,1,0.5,0.373494,2.89157,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,0,1,1,1,0.5,0.45,1
-elif {$4==5} -gimp_graphic_novelfxl 1,7.22892,14.6506,5,20,0,1.06024,14,0,1,0.5,0.855422,1.3253,0,0,12,1,1,1,0.5,0.8,1.28,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,0,1,1,1,0.5,0.45,1
-elif {$4==6} -gimp_graphic_novelfxl 1,7.22892,14.6506,5,20,0,1.06024,36.1446,0,1,0.5,0.855422,1.92771,0,0,7,1,1,1,0.5,0.951807,1.92771,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,0,1,1,1,0.5,0.45,1
-elif {$4==7} -gimp_graphic_novelfxl 1,7.22892,14.6506,5,20,0,1.59036,36.1446,0,1,0.5,0.590361,3.61446,0,1,18,1,1,1,0.5,0.795181,2.16867,1.25,2,0,0.15,14,0,1,0.5,0.45,2,0,1,0,1,1,1,0.5,0.45,1 -endif
-if {$5==1} -gimp_array_mirror 1,0,0,2,0,$6
-elif {$5==2} -gimp_array_mirror 1,0,0,3,0,$6 -endif
#@gimp Vivid colors : gimp_compose_vivid_color,gimp_compose_vivid_color
#@gimp : Opacity = float(1,0,1)
#@gimp : Revert layers = bool(0)
#@gimp : Opacity 2 = float(1,0,1)
#@gimp : Note = note ("This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>11/13/2011</i>.</small>")
gimp_compose_vivid_color :
-reverse -gimp_compose_lightness $1,$2 [^] -gimp_compose_softlight $3,0
#@gimp Vivid edges : gimp_compose_vividedges, gimp_compose_vividedges
#@gimp : Opacity = float(1,0,1)
#@gimp : Edges smoothness = float(0.5,0,5)
#@gimp : Revert layers = bool(0)
#@gimp : Opacity 2 = float(0.7,0,1)
#@gimp : Note = note ("This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>11/13/2011</i>.</small>")
gimp_compose_vividedges :
-gimp_compose_edges $1,$2,$3 [^] -gimp_compose_overlay $4,0
#@gimp Vivid screen : gimp_compose_vividscreen , gimp_compose_vividscreen
#@gimp : Opacity = float(0.6,0,1)
#@gimp : Revert layers = bool(0)
#@gimp : Opacity 2 = float(0.7,0,1)
#@gimp : Note = note ("This filter needs two layers to work properly. Set the <i>Input layers</i> option to handle multiple input layers.")
#@gimp : Sep = separator(), note = note("<small>Author: <i>PhotoComiX</i>.      Latest update : <i>11/13/2011</i>.</small>")
gimp_compose_vividscreen :
-repeat @# -l[$>]
-gimp_compose_screen $1,$2 [-1] -gimp_compose_overlay $3,0
-endl -done
#@gimp Wild cartoonizer : gimp_m_l_unsharp2 , gimp_m_l_unsharp2_preview(0)
#@gimp : Sep = separator ()
#@gimp : Sep = separator ()
#@gimp : Radius 1 = float(12,0,100)
#@gimp : Amount 1 = float (2.18,0,10)
#@gimp : Radius 2 = float(0.3,0,100)
#@gimp : Amount 2 = float (1.5,0,10)
#@gimp : Darken merge opacity = float (1,0,1)
#@gimp : Lighten merge opacity = float (0.5,0,1)
#@gimp : Sep = separator ()
#@gimp : Note = note(" Additional Painter Module ")
#@gimp : Sep = separator ()
#@gimp : Add painter's touch = bool(false)
#@gimp : Painter's touch sharpness = float(0.5,0,2)
#@gimp : Painter's edge protection flow = float(0.8,0,1)
#@gimp : Painter's smoothness =float(1.28,0,10)
#@gimp : Sep = separator() Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Note = note("<small>Author: <i>PhotoComiX</i>. Latest update : <i>12/29/2010</i>.</small>")
gimp_m_l_unsharp2 :
--unsharp $1,$2,0
-unsharp $3,$4,0[1] -reverse -gimp_compose_darken $5
--unsharp $3,$4,0 -reverse -gimp_compose_lighten $6
-if {$7==1} -gimp_anisotropic_smoothing 60,$8,$9,$10,1.1,0.8,30,2,0,1,1,0 -endif
gimp_m_l_unsharp2_preview :
-gimp_split_preview "-gimp_m_l_unsharp2 ${1--2}",$-1
#@gimp _
#@gimp <i>Rl</i>
#@gimp Plasma transition : plasma_transition, plasma_transition
#@gimp : Balance = float(0.5,0,1)
#@gimp : Scale = int(5,0,50)
#@gimp : Smoothness = float(1,0,10)
#@gimp : Random initialization = int(42,1,100)
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Jean-Baptiste Rolland, Julien Levillain</i>.      Latest update: <i>03/28/2013</i>.</small>")
plasma_transition: -check "isint(${4=42}) && isint(${2=5}) && ${1=0.5}>=0  && $1<=1 && $2>=0 && ${3=1}>=0"
-repeat {int(@#/2.0)}
-local[{$>},{$>+1}]
-if {@#<2} -return -endif
-r @{-max_whds},3
100%,100% -srand $4 -plasma[-1] 1,0,$2 -n[-1] 0,1
--le[-1] $1 -b[-1] $3
-rm[-2]
-j[-3] [-2],0,0,0,0,1,[-1]
-keep[-3]
-endlocal
-done
#@gimp Randomwaves : randomwaves, randomwaves
#@gimp : Steps number = int(84,1,1000)
#@gimp : Probability of impulse (% / step) = float(80.,1.,100.)
#@gimp : Lessening = float(1.2,0.01,10.)
#@gimp : Random initialization = int(42,1,100)
#@gimp : Sep = separator(), note = note("<small>Authors: <i>Jean-Baptiste Rolland, Julien Levillain</i>.      Latest update: <i>03/28/2013</i>.</small>")
randomwaves:  -check  "isint(${1=84})  &&  ${2=80}>=0  &&  $2<=100  && ${3=1.2}>0. && isint(${4=42})"
-srand $4
(0,1,0;1,0,1;0,1,0) -/[-1] 2
-nm[-1] matconv
@{0,w},@{0,h},1,1 -set[-1] 255,{?(100)}%,{?(100)}%
[-1]
-repeat $1
[-1]
-if {${2}>=?(100)}
-circle[-1] {?(100)}%,{?(100)}%,{?(3)},,255
-endif
-convolve[-1] [matconv] -div[-1] $3 -sub[-1] [-3]
-rm[-3]
-done
-rm[-2,matconv]
-g[-1] -a[-1,-2] c -warp[0] [-1],1 -rm[-1]
#@gimp _
#@gimp <i>Ronounours</i>
#@gimp Auto-adjust orientation : gimp_adjust_orientation, gimp_adjust_orientation(1)
#@gimp : Threshold = float(5,0,100)
gimp_adjust_orientation :
-repeat @#
M={max(w,h)}
--gradient_norm[-1] -ge[-1] $1%
--*[-1] '1+y' -*[-2] '1+x' -a[-2,-1] c
-r[-1] {w*h},2,1,1,-1 -sort[-1] +,x -autocrop[-1] 0
-/[-1] $M --r[-1] 1,2,1,1,2 -r[-1] [-2] --[-2,-1]
--transpose[-1] -**[-2,-1]
-eigen[-1] -rm[-2] -z[-1] 0,0
-if {i<0} -*[-1] -1 -endif
theta={180*atan2(i(0,1),i)/pi}
-rm[-1]
-if {w>h} -rotate[-1] {-$theta},1,0,50%,50%
-else -rotate[-1] {-$theta+90},1,0,50%,50%
-endif
-mv[-1] 0 -done
#@gimp Circlism : gimp_circlism, gimp_no_preview
#@gimp : Min radius = int(2,1,100)
#@gimp : Max radius = int(10,1,100)
#@gimp : Smoothness = float(1,0,10)
#@gimp : Edge linearity = float(0.4,0.01,5)
#@gimp : Location linearity = float(3,0.01,5)
#@gimp : Shape = choice(2,"Diamonds","Squares","Circles")
#@gimp : Transparency = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>10/16/2011</i>.</small>")
gimp_circlism :
-to_rgb -circlism ${1-6}
-if $7 -to_rgba -replace_color 0,0,0,0,0,255,0,0,0,0 -endif
#@gimp Clean skin : gimp_clean_skin, gimp_clean_skin_preview(0)
#@gimp : Amplitude = float(0.8,0,1)
#@gimp : Scale = float(2,0,10)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_clean_skin :
-repeat @# -l[$>]
--channels 0
--split_details[-2] 4,$2%,0.3%
-l[1,4]
-s c
--bilateral[-2,-1] [0],20,10
-j[2] [-2],0,0,0,0,$1,[0],255
-j[3] [-1],0,0,0,0,$1,[0],255
-rm[-2,-1]
-a[^0] c
-endl
-rm[0,1]
-+ -c 0,255
-endl -done
gimp_clean_skin_preview :
-gimp_split_preview "-gimp_clean_skin $*",$-1
#@gimp Convolve fft : gimp_convolve_fft, gimp_convolve_fft(1)
#@gimp : Note = note("<small><b>Note:</b> Set <i>Input layers</i> to <i>All</i>, and use it with two layers to make this filter work properly.\Bottom layer is the convolution kernel, top layer is the image to convolve.</small>")
#@gimp : Sep = separator()
#@gimp : Equalization = choice("None","Standard","High")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>03/28/2014</i>.</small>")
gimp_convolve_fft :
-convolve_fft -n 0,255
-if $1 -equalize 256 -endif
-if {$1>1} -normalize_local , -endif
#@gimp Faded mirror : gimp_faded_mirror, gimp_faded_mirror(1)
#@gimp : Axis = choice("x-axis","y-axis")
#@gimp : Fading = float(10,0,100)
#@gimp : Overlapping = float(10,0,100)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>05/29/2013</i>.</small>")
gimp_faded_mirror :
-repeat @# -l[$>]
-if {$1==0}
100%,1,1,1,"a=1/(1-w*$2%);b=-a*(w-1);a*x+b" -c[-1] 0.01,1 -*[-2] [-1]
-r[-1] 100%,[-2] -a c -r {2*w-w*$3%},100%,1,100%,0 --mirror x
-else
1,100%,1,1,"a=1/(1-h*$2%);b=-a*(h-1);a*y+b" -c[-1] 0.01,1 -r[-1] [-2],100% -*[-2] [-1]
-a c -r 100%,{2*h-h*$3%},1,100%,0 --mirror y
-endif
-+ -s[-1] c,-{s-1} -/[-2,-1]
-endl -done
#@gimp Generate film data : gimp_generate_film_data, gimp_no_preview
#@gimp : Output folder = _folder("")
#@gimp : Jpeg quality = int(75,0,100)
#@gimp : Thumbnail width = int(196,32,768)
#@gimp : Add thumbnail decoration = bool(1)
#@gimp : Sep = separator(), note = note("<small><b>Warning:</b> Don't forget to select <i>Input layers</i> to <i>All</i> to generate image data for all your image samples.</small>")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>08/26/2014</i>.</small>")
#@gimp Grain [old] : gimp_grain, gimp_grain_preview(0)
#@gimp : Amplitude = float(40,0,512)
#@gimp : Tone smoothness = float(5,0,15)
#@gimp : Grain type = choice("Gaussian","Uniform")
#@gimp : Channel(s) = choice(2,"All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Green chrominance","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Shadows:</b></small>")
#@gimp : Strength = float(0.8,0,1)
#@gimp : Scale = float(0.5,0,2)
#@gimp : Channel correlation = float(0.5,0,1)
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Mid-tones:</b></small>")
#@gimp : Strength = float(1,0,1)
#@gimp : Scale = float(0,0,2)
#@gimp : Channel correlation = float(0.5,0,1)
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Highlights:</b></small>")
#@gimp : Strength = float(0.6,0,1)
#@gimp : Scale = float(0.2,0,2)
#@gimp : Channel correlation = float(0.5,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>11/21/2013</i>.</small>")
gimp_grain :
-repeat @# -l[$>] -apply_channels_old "-_gimp_grain ${1-13}",$4,0 -endl -done
_gimp_grain :
-if {!$1} -return -endif
s={s} --luminance
-if $5
100%,100%,1,$s -noise[-1] 1,$3 -b[-1] $6 -*[-1] {(1-$7)/max(abs(im),abs(iM))}
100%,100%,1,1 -noise[-1] 1,$3 -b[-1] $6 -*[-1] {$7/max(abs(im),abs(iM))}
-+[-2,-1] --t2[1] 0,85 -b[-1] $2 -n[-1] 0,1 -*[-2,-1] -*[-1] $5
-endif
-if $8
100%,100%,1,$s -noise[-1] 1,$3 -b[-1] $9 -*[-1] {(1-$10)/max(abs(im),abs(iM))}
100%,100%,1,1 -noise[-1] 1,$3 -b[-1] $9 -*[-1] {$10/max(abs(im),abs(iM))}
-+[-2,-1] --t2[1] 86,169 -b[-1] $2 -n[-1] 0,1 -*[-2,-1] -*[-1] $8
-endif
-if $11
100%,100%,1,$s -noise[-1] 1,$3 -b[-1] $12 -*[-1] {(1-$13)/max(abs(im),abs(iM))}
100%,100%,1,1 -noise[-1] 1,$3 -b[-1] $12 -*[-1] {$13/max(abs(im),abs(iM))}
-+[-2,-1] --t2[1] 170,256 -b[-1] $2 -n[-1] 0,1 -*[-2,-1] -*[-1] $11
-endif
-rm[1] -+[-3--1] -n[-1] -$1,$1 -+ -c 0,255
gimp_grain_preview :
-gimp_split_preview "-gimp_grain $*",$-1
#@gimp Perspective scale : gimp_perspective_scale, gimp_perspective_scale_preview(1)
#@gimp : Iterations = int(2,2,10)
#@gimp : Factor = float(75,0,100)
#@gimp : X-offset = float(0,-100,100)
#@gimp : Y-offset = float(0,-100,100)
#@gimp : Output mode = _choice("Single layer","Multiple layers")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>02/08/2013</i>.</small>")
gimp_perspective_scale :
-repeat @# -l[$<] -to_rgba
w={w} h={h}
f=100 -repeat {$1-1} f={$f*$2%} --r[0] $f%,$f%,1,4,2 -done
-repeat {@#-1} -l[{$>+1}]
sx={($>+1)*$w*$3%/($1-1)}
sy={($>+1)*$h*$4%/($1-1)}
-r $w,$h,1,4,0,0,0.5,0.5 -shift[-1] $sx,$sy,0,0,0
-endl -done
-if {!$5} -repeat {@#-1} -blend[0,1] alpha,1,1 -done -endif
-endl -done
gimp_perspective_scale_preview :
-gimp_perspective_scale ${1-4},0
#@gimp Shaded segmentation : dt_segment_shaded,dt_segment_shaded(0)
#@gimp : Density = float(1,0,3)
#@gimp : Shading = float(0.7,0,2)
#@gimp : Smoothness = float(1,0,10)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>02/01/2013</i>.</small>")
dt_segment_shaded :
-repeat @# -l[$>]
-b $3 -segment_watershed $1,1
--g xy,1 -a[-2,-1] c -norm[-1] -neq[-1] 0 -distance[1] 1 -normalize_local[-1] 1000
-n[-1] 0,1 -^[-1] {max(1e-5,$2)} -n[-1] 0,255
-blend value
-endl -done
#@gimp Sharpen [unsharp mask; 16bits] : gimp_unsharp16, gimp_unsharp16_preview(0)
#@gimp : Input image = file()
#@gimp : Output image = text("gmic_unsharp16.png")
#@gimp : Note = note("\n<b>Filter parameters :</b>")
#@gimp : Sharpening type = choice(0,"Gaussian","Bilateral")
#@gimp : Spatial radius = float(1.25,0,20)
#@gimp : Bilateral radius = float(30,0,60)
#@gimp : Amount = float(3,0,10)
#@gimp : Threshold = float(0,0,20)
#@gimp : Darkness level = float(1,0,4)
#@gimp : Lightness level = float(1,0,4)
#@gimp : Iterations = int(1,1,10)
#@gimp : Negative effect = bool(0)
#@gimp : Channel(s) = choice("All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Alpha","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Note = note{"\n\n<small><b>Note: </b>
#@gimp : This filter is inspired by the original <i>Unsharp Mask</i> filter in GIMP, with additional parameters.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_unsharp16 :
-rm -i $1 -/ 256
-gimp_unsharp ${3--1}
-* 256 -if {narg($2)} -o $2 -endif -/ 256
gimp_unsharp16_preview :
-i $1 -z[-1] {max(0,(w-@{-2,w})/2)},{max(0,(h-@{-2,h})/2)},{min(w-1,(w+@{-2,w})/2)},{min(h-1,(h+@{-2,h})/2)} -k[-1] -/ 256
-gimp_unsharp ${3--1}
#@gimp Smooth [anisotropic; 16bits] : gimp_anisotropic_smoothing16, gimp_anisotropic_smoothing16_preview(0)
#@gimp : Input image = file()
#@gimp : Output image = text("gmic_anisotropic16.png")
#@gimp : Note = note("\n<b>Filter parameters :</b>")
#@gimp : Amplitude = float(60,0,1000)
#@gimp : Sharpness = float(0.7,0,2)
#@gimp : Anisotropy = float(0.3,0,1)
#@gimp : Gradient smoothness = float(0.6,0,10)
#@gimp : Tensor smoothness = float(1.1,0,10)
#@gimp : Spatial precision = float(0.8,0.1,2)
#@gimp : Angular precision = float(30,1,180)
#@gimp : Value precision = float(2,0.1,5)
#@gimp : Interpolation = choice(0,"Nearest neighbor","Linear","Runge-Kutta")
#@gimp : Fast approximation = bool(1)
#@gimp : Iterations = int(1,1,10)
#@gimp : Channel(s) = choice("All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Alpha","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Tiles = int(1,1,10)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_anisotropic_smoothing16 :
-rm -i $1 -/ 256
-gimp_anisotropic_smoothing ${3--1}
-* 256 -if {narg($2)} -o $2 -endif -/ 256
gimp_anisotropic_smoothing16_preview :
-i $1 -z[-1] {max(0,(w-@{-2,w})/2)},{max(0,(h-@{-2,h})/2)},{min(w-1,(w+@{-2,w})/2)},{min(h-1,(h+@{-2,h})/2)} -k[-1] -/ 256
-gimp_anisotropic_smoothing ${3--1}
#@gimp Smooth [patch-based; 16bits] : gimp_patch_smoothing16, gimp_patch_smoothing16_preview(0)
#@gimp : Input image = file()
#@gimp : Output image = text("gmic_patch16.png")
#@gimp : Note = note("\n<b>Filter parameters :</b>")
#@gimp : Spatial variance = float(10,0.1,200)
#@gimp : Patch variance = float(10,0.1,200)
#@gimp : Patch size = int(3,2,21)
#@gimp : Lookup size = int(5,2,21)
#@gimp : Patch smoothness = float(0,0,4)
#@gimp : Fast approximation = bool(1)
#@gimp : Iterations = int(1,1,10)
#@gimp : Channel(s) = choice("All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Alpha","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_patch_smoothing16 :
-rm -i $1 -/ 256
-gimp_patch_smoothing ${3--1}
-* 256 -if {narg($2)} -o $2 -endif -/ 256
gimp_patch_smoothing16_preview :
-i $1 -z[-1] {max(0,(w-@{-2,w})/2)},{max(0,(h-@{-2,h})/2)},{min(w-1,(w+@{-2,w})/2)},{min(h-1,(h+@{-2,h})/2)} -k[-1] -/ 256
-gimp_patch_smoothing ${3--1}
#@gimp _
#@gimp <i>Samj</i>
#@gimp About : _none_, samj_about
#@gimp : Note = note(<b>Informations - Compilations :</b>)
#@gimp : Note = link("http://www.aljacom.com/~gmic/","http://www.aljacom.com/~gmic/")
#@gimp : Note = link("http://samjcreations.blogspot.ca/","http://samjcreations.blogspot.ca/")
#@gimp : Note = note(<b>Filtres :</b>)
#@gimp : Note = note("Les filtres contenus dans ce r\303\251pertoire sont majoritairement traduits en fran\303\247ais et/ou en cours de d\303\251veloppement.")
#@gimp : Note = note("The filters included in this directory are mostly translated into French and/or experimental.")
#@gimp : Note = note("Version 20150302 GMIC 1.9.1.0")
samj_about :
-text_outline Bonjour!,{{min({w},{h})}/20},{{min({w},{h})}/20},{{min({w},{h})}/5},1,255,255,255,255
samj_rien_arrays_and_tiles :
-Je_passe_l_hiver_en_Floride[-1]
#@gimp <i>Arrays &amp; tiles</i>
#@gimp Samj coeurs hearts 002 : samj_Coeurs_Hearts_002, samj_Coeurs_Hearts_002(1)
#@gimp : Sep = separator(), note = note("<span foreground="red">Des c&#339;urs aux couleurs de l'image.</span>")
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>C&#339;urs / Hearts</small></span>")
#@gimp : R\303\251solution = int(16,4,128)
#@gimp : Remplissage % = float(100,20,100)
#@gimp : Angle rotation = int(0,0,360)
#@gimp : Flou / blur = float(0,0,2)
#@gimp : Coeurs / hearts = bool(1)
#@gimp : Interpolation = int(0,0,3)
#@gimp : Couleur fond / background color = color(255,255,255,255)
#@gimp : Gris = bool(0)
#@gimp : Amplification couleurs / colors boost = bool(0)
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>M\303\251lange / Blend</small></span>")
#@gimp : Type avant plan / foreground = choice(0,"Type A","Type B")
#@gimp : Mode = choice{1,"Add","Alpha","And","Average","Blue","Burn","Darken","Difference",
#@gimp : "Divide","Dodge","Edges","Exclusion","Freeze","Grain extract","Grain merge","Green","Hard light",
#@gimp : "Hard mix","Hue","Interpolation","Lighten","Lightness","Linear burn","Linear light","Luminance",
#@gimp : "Multiply","Negation","Or","Overlay","Pin light","Red","Reflect","Saturation",
#@gimp : "Shape Average","Shape Average0","Soft burn","Soft dodge","Soft light","Screen","Stamp","Subtract","Value",
#@gimp : "Vivid light","Xor"}
#@gimp : Opacit\303\251 / opacity = float(1,0,1)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/13</i>.</small>")
samj_Coeurs_Hearts_002 :
Resolution=$1
Remplissage=$2
Angle_Rotation_Motif=$3
flou=$4
Coeurs_Hearts=$5
Interpolation=$6
R_Couleur=$7
V_Couleur=$8
B_Couleur=$9
A_Couleur=$10
Gris=$11
Boost=$12
Type_Avant_Plan=$13
Mode_blend=$14
Opacity_blend=$15
-if {$Type_Avant_Plan==1}
--Je_passe_l_hiver_en_Floride[-1]
-to_rgb[-2]
-negative[-2]
-endif
-to_rgb[-1]
-negative[-1]
-if {$Interpolation==0}
-resize[-1] {{w}/$Resolution},{{h}/$Resolution}
-c[-1] 0,255
-elif {$Interpolation==1}
-resize[-1] {{w}/$Resolution},{{h}/$Resolution},1,3,3
-c[-1] 0,255
-elif {$Interpolation==2}
-resize[-1] {{w}/$Resolution},{{h}/$Resolution}
-n[-1] 0,255
-elif {$Interpolation==3}
-resize[-1] {{w}/$Resolution},{{h}/$Resolution},1,3,3
-n[-1] 0,255
-endif
-if {$Type_Avant_Plan==1}
-resize[-2] {{w}*$Resolution},{{h}*$Resolution}
-rm[-1]
-else
-resize[-1] {{w}*$Resolution},{{h}*$Resolution}
-endif
-if {$Gris==1}
-to_gray[-1]
-endif
-c[-1] 0,255
-if {$Boost==1}
-gimp_balance_gamma[-1] 128,128,128,1
-endif
-negative[-1]
-to_rgba[-1]
$Resolution,$Resolution,1,4
-fill_color[-1] 0,0,0,0
-if {$Coeurs_Hearts==1}
(0,0,0,1,1,1,0,0,0,0,1,1,1,0,0,0;0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0;0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0;1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1;1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1;1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1;0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0;0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0;0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0;0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0;0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0;0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0;0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0;0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0)
-else
(1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0;1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0;1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0;1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0;1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0;1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0;1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0;1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0;0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1;0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1;0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1;0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1;0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1;0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1;0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1;0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1)
-endif
-if {$Angle_Rotation_Motif>0}
-rotate[-1] $Angle_Rotation_Motif,0,0
-autocrop[-1] 0
-endif
-resize[-1] {$Resolution*$Remplissage/100},{$Resolution*$Remplissage/100}
-compose_alpha[-1,-2]
-resize[-1] [-2],[-2],1,1,0,2
-to_rgba[-1]
#-replace_color[-1] 100%,0,0,0,0,255,0,0,0,0
#-replace_color[-1] 100%,0,0,0,0,255,255,255,255,255
-replace_color[-1] 100%,0,0,0,0,255,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-replace_color[-1] 100%,0,1,1,1,255,0,0,0,0
-gimp_blend[-2,-1] $Mode_blend,2,$Opacity_blend,0
-if {$flou>0}
-blur[-1] $flou,0
-endif
samj_rien_atistic :
-Je_passe_l_hiver_en_Floride[-1]
#@gimp _
#@gimp <i>Artistic</i>
#@gimp Chalk it up : samj_chalkitup, samj_chalkitup_preview
#@gimp : Note = note("Inspir\303\251 du didacticiel propos\303\251 par Lylejk")
#@gimp : Note = note("Inspired by the tutorial proposed by Lylejk")
#@gimp : Note = link("http://justpaste.it/chalk_it_up","http://justpaste.it/chalk_it_up")
#@gimp : Sep = separator(), note = note("<small>Param\303\250tres peinturage / Painting parameters</small>")
#@gimp : Abstraction = int(5,0,10)
#@gimp : Pr\303\251cision details / details scale = float(2.5,0,10)
#@gimp : Couleur / color = float(1.5,0,5)
#@gimp : Douceur / smoothness = float(50,0,200)
#@gimp : Accentuation nuances / sharpen shades = bool(1)
#@gimp : Sep = separator(), note = note("<small>Param\303\250tres filtre Morpho / Morpho parameters</small>")
#@gimp : Action = choice(5,"Erosion","Dilation","Opening","Closing","Original - Erosion","Dilation - Original","Original - Opening","Closing - Original")
#@gimp : Taille / size = int(5,0,32)
#@gimp : Inversion couleurs / invert colors = bool(0)
#@gimp : Modeler / shape = int(0,0,1)
#@gimp : Canaux / channel(s) = choice(2,"All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), note = note("<small>Param\303\250tres filtre Spread / Spread parameters</small>")
#@gimp : X-variations = float(0.8,-5,5)
#@gimp : Y-variations = float(1.9,-5,5)
#@gimp : Canaux / channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Sep = separator(), Type Aper\303\247u = choice("Tout","Rendu en bas","Rendu a droite","Rendu en haut","Rendu a gauche")
#@gimp : Sep = separator(), note = note("<small>Auteurs / Authors : <i>Lylejk/samj/Ronounours</i>.      Derni\303\250re mise \303\240 jour : <i>2015/03/03</i>.</small>")
samj_chalkitup :
#gimp_painting
Abstraction=$1
Details_scale=$2
Color=$3
Smoothness=$4
Sharpen_shades=$5
#gimp_morpho
Action=$6
Size=$7
Invert_colors=$8
Shape=$9
Channel_morpho=$10
#gimp_spread
X_variations=$11
Y_variations=$12
Channel_spread=$13
-repeat @# -l[$>]
-remove_opacity
-gimp_painting $Abstraction,$Details_scale,$Color,$Smoothness,$Sharpen_shades
-gimp_morpho $Action,$Size,$Invert_colors,$Shape,$Channel_morpho,0
-gimp_spread $X_variations,$Y_variations,$Channel_spread,0
-endl -done
samj_chalkitup_preview :
-gimp_split_preview "-samj_chalkitup ${1--2}",$-1
#@gimp Granular texture : samj_Texture_Granuleuse, samj_Texture_Granuleuse_preview(0)
#@gimp : Note = note("<small>Texture Granuleuse / Granular Texture</small>")
#@gimp : Sep = separator()
#@gimp : Douceur / smoothness gradient RGB = float(0,0.5,2)
#@gimp : Maximum seuil d\303\251grad\303\251 / max threshold gradient RGB = float(20,10,50)
#@gimp : Sep = separator()
#@gimp : Amplitude bruit / noise = float(80.0,40,200)
#@gimp : Sep = separator()
#@gimp : Couleurs / colors = float(0,-20,20)
#@gimp : Balance des couleurs automatique / automatic color balance = bool(0)
#@gimp : Sep = separator()
#@gimp : Sep = separator(), Type Aper\303\247u = choice("Tout","Rendu en bas","Rendu a droite","Rendu en haut","Rendu a gauche")
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/07</i>.</small>")
samj_Texture_Granuleuse :
-repeat @# -l[$>]
Smoothness_Gradient_RGB=$1
Max_threshold_Gradient_RGB=$2
Amplitude_Noise=$3
Colors=$4
Automatic_color_balance=$5
--Je_passe_l_hiver_en_Floride[-1]
-gimp_gradient2rgb[-1] $Smoothness_Gradient_RGB,0,$Max_threshold_Gradient_RGB,0,0
{w},{h},1,3
-fill_color[-1] 255,255,255
-to_rgb[-1]
-gimp_noise[-1] $Amplitude_Noise,0,2,0
-blend[-1,-2] negation,1,1
-gimp_tk_colortemp[-1] $Colors,$Automatic_color_balance
-gimp_local_orientation[-1] 0,0,100,0,7
-gimp_normalize_local[-1] 0,6,5,20,1,2
-blend[0,-1] grainmerge,1,1
-endl -done
samj_Texture_Granuleuse_preview :
-gimp_split_preview "-samj_Texture_Granuleuse $*",$-1
samj_rien_black_and_white :
-Je_passe_l_hiver_en_Floride[-1]
#@gimp _
#@gimp <i>Black &amp; white</i>
#@gimp Hard sketch xy : XY_hardsketchbw_samj, XY_hardsketchbw_samj(0)
#@gimp : Sep = separator(), note = note("<small>Param\303\250tres Filtre Hard Sketch BW</small>")
#@gimp : Xy = float(0.2,0,1)
#@gimp : Densit\303\251 / amplitude = float(300,0,4000)
#@gimp : Density = float(50,0,100)
#@gimp : Douceur / smoothness = float(1,0,10)
#@gimp : Opacit\303\251 / opacity = float(0.1,0,1)
#@gimp : Bordure / edge = float(20,0,100)
#@gimp : Approximation rapide / fast approximation = bool(0)
#@gimp : Color model = choice("Black on white","White on black","Black on transparent white","White on transparent black","Color on white")
#@gimp : Sep = separator(), note = note("<small>Calques / Layers</small>")
#@gimp : Nb. = choice(0,"1 : XY","2 : XY + Hard Sketch BW Normal")
#@gimp : Sep = separator(), note = note("<small>Nettet\303\251 / Sharpen</small>")
#@gimp : Filtre octave sharpening = bool(0)
#@gimp : Sep = separator(), note = note("<small>XY_hardsketch Color</small>")
#@gimp : Couleur / color = color(180,40,160,255)
#@gimp : Remplir / fill = bool(0)
#@gimp : Sep = separator(), note = note("samj      Derni\303\250re mise \303\240 jour : <i>2015/03/10</i>.</small>")
XY_hardsketchbw_samj :
XY=$1
Amplitude=$2
Density=$3
Smoothness=$4
Opacity=$5
Edge=$6
Fast_approximation=$7
Negative=$8
Calques=$9
Octave_Sharpening=$10
R_Transparence=$11
V_Transparence=$12
B_Transparence=$13
A_Transparence=$14
Remplir=$15
Largeur={w}
Hauteur={h}
-to_rgba[-1]
--Je_passe_l_hiver_en_Floride[-1]
-if {$Calques==1} --Je_passe_l_hiver_en_Floride[-1] -endif
-if {$Largeur>$Hauteur}
Grande_dimension={$Largeur*1.5}
-else
Grande_dimension={$Hauteur*1.5}
-endif
Origine_X={round({{{$Grande_dimension}-$Largeur}/2})}
Origine_Y={round({{{$Grande_dimension}-$Hauteur}/2})}
-expand_x[-1] $Origine_X,2
-expand_y[-1] $Origine_Y,2
-twirl_ancien_euclidean2polar_ancien_polar2euclidean[-1] $XY,0.5,0.5,1
-gimp_hardsketchbw[-1] $Amplitude,$Density,$Smoothness,$Opacity,$Edge,$Fast_approximation,$Negative
-twirl_ancien_euclidean2polar_ancien_polar2euclidean[-1] -$XY,0.5,0.5,1
-expand_x[-2] $Origine_X,2
-expand_y[-2] $Origine_Y,2
-twirl_ancien_euclidean2polar_ancien_polar2euclidean[-2] -$XY,0.5,0.5,1
-gimp_hardsketchbw[-2] $Amplitude,$Density,$Smoothness,$Opacity,$Edge,$Fast_approximation,$Negative
-twirl_ancien_euclidean2polar_ancien_polar2euclidean[-2] $XY,0.5,0.5,1
#average
-blend[-1,-2] average,1,0
-crop[-1] $Origine_X,$Origine_Y,{$Largeur+$Origine_X-1},{$Hauteur+$Origine_Y-1}
-if {$Octave_Sharpening==1}
-gimp_unsharp_octave 4,5,3,0,0,0,24,0
-endif
-if {$Calques==1}
-gimp_hardsketchbw[-2] $Amplitude,$Density,$Smoothness,$Opacity,$Edge,$Fast_approximation,$Negative
-reverse[-1,-2]
-endif
-if {$Remplir==1}
$Largeur,$Hauteur,1,4
-fill_color[-1] $R_Transparence,$V_Transparence,$B_Transparence,$A_Transparence
-if {$Calques==1}
-reverse[-1,-2]
-endif
-blend[-1,-2] screen,1,1
-if {$Calques==1}
-reverse[-1,-2]
-endif
-endif
samj_rien_colors :
-Je_passe_l_hiver_en_Floride[-1]
#@gimp _
#@gimp <i>Colors</i>
#@gimp Couleurs metalliques : Couleurs_Metalliques, Couleurs_Metalliques_preview
#@gimp : Sep = separator(), note = note("<small>Rendu - Rendering</small>")
#@gimp : Transparence / transparency = choice(0,"Conserver / Preserve","Supprimer / Remove")
#@gimp : Rendu / rendering = choice("Saturation","Lightness","RGB","Red","Green","Blue","Alpha")
#@gimp : Sep = separator(), note = note("<small>Param\303\250tres Filtre Noise - Noise parameters</small>")
#@gimp : Amplitude = float(22,0,200)
#@gimp : Type de bruit / noise type = choice("Gaussian","Uniform","Salt and pepper","Poisson")
#@gimp : \303\211tendue / value range = choice("Cut","Normalize")
#@gimp : Sep = separator(), note = note("<small>Param\303\250tres Filtre Local normalization - Local normalization parameters</small>")
#@gimp : Double effet = bool(0)
#@gimp : Amplitude = float(0,0,60)
#@gimp : Rayon / radius = int(6,1,64)
#@gimp : Lissage voisinage / neighborhood smoothness = float(5,0,40)
#@gimp : Lissage moyenne / average smoothness = float(20,0,40)
#@gimp : Imposer valeurs / constrain values = bool(1)
#@gimp : Canaux / channel(s) = choice(0,"All","RGBA","RGB","Luminance","Blue/red chrominances","Blue chrominance","Red chrominance","Lightness","ab-components","a-component","b-component","Hue","Saturation","Value","Key","Alpha","ch-components","c-component","h-component","Red","Green","Blue","Alpha")
#@gimp : Sep = separator(), note = note("<small>Param\303\250tres Filtre Boost-Fade - Boost-Fade parameters : Si-If Amplitude Sup. 0</small>")
#@gimp : Amplitude = float(0,0,10)
#@gimp : Sep = separator(), note = note("<small>PhotoComix Options</small>")
#@gimp : Utiliser / use pc options = bool(0)
#@gimp : Filtre pencilbw taille / size = float(0.3,0,5)
#@gimp : Filtre pencilbw amplitude = float(60,0,200)
#@gimp : Opacit\303\251 m\303\251lange / blend opacity = float(1,0,1)
#@gimp : M\303\251lange permuter calques / blend revert layers = bool(1)
#@gimp : Sep = separator()
#@gimp : Sep = separator(), Type Aper\303\247u = choice("Tout","Rendu en bas","Rendu a droite","Rendu en haut","Rendu a gauche")
#@gimp : Sep = separator(), note = note("samj      Derni\303\250re mise \303\240 jour : <i>2015/03/03</i>.</small>")
Couleurs_Metalliques :
Transparence=$1
Rendu=$2
Amplitude=$3
Noise_type=$4
Noise_Channel=7
Value_range=$5
Double_effet=$6
Local_normalization_Amplitude=$7
Radius=$8
Neighborhood_smoothness=$9
Average_smoothness=$10
Constrain_values=$11
Local_normalization_Channel=$12
boost_fade_Amplitude=$13
Utiliser_Photocomix_Options=$14
Pencilbw_Size=$15
Pencilbw_Amplitude=$16
Blend_soft_light_Opacity=$17
Blend_soft_light_Revert_layers=$18
-repeat @# -l[$>]
-if {$Rendu==0}
Rendu_local_orientation_channels=12
-elif {$Rendu==1}
Rendu_local_orientation_channels=7
-elif {$Rendu==2}
Rendu_local_orientation_channels=2
-elif {$Rendu==3}
Rendu_local_orientation_channels=19
-elif {$Rendu==4}
Rendu_local_orientation_channels=20
-elif {$Rendu==5}
Rendu_local_orientation_channels=21
-elif {$Rendu==6}
Rendu_local_orientation_channels=22
-endif
-if {$Transparence==1}
-remove_opacity[-1]
-endif
-if {$Utiliser_Photocomix_Options==1}
--pencilbw[-1] $Pencilbw_Size,$Pencilbw_Amplitude
-if {$Double_effet==1}
-gimp_normalize_local[-2] $Local_normalization_Amplitude,$Radius,$Neighborhood_smoothness,$Average_smoothness,$Constrain_values,$Local_normalization_Channel
-endif
-gimp_noise[-2] $Amplitude,$Noise_type,$Noise_Channel,$Value_range
-gimp_local_orientation[-2] 0,0,100,0,$Rendu_local_orientation_channels
-gimp_normalize_local[-2] $Local_normalization_Amplitude,$Radius,$Neighborhood_smoothness,$Average_smoothness,$Constrain_values,$Local_normalization_Channel
-if {$boost_fade_Amplitude>0}
-gimp_boost_fade[-2] $boost_fade_Amplitude
-endif
-blend[-2,-1] softlight,$Blend_soft_light_Opacity,$Blend_soft_light_Revert_layers
-else
-if {$Double_effet==1}
-gimp_normalize_local[-1] $Local_normalization_Amplitude,$Radius,$Neighborhood_smoothness,$Average_smoothness,$Constrain_values,$Local_normalization_Channel
-endif
-gimp_noise[-1] $Amplitude,$Noise_type,$Noise_Channel,$Value_range
-gimp_local_orientation[-1] 0,0,100,0,$Rendu_local_orientation_channels
-gimp_normalize_local[-1] $Local_normalization_Amplitude,$Radius,$Neighborhood_smoothness,$Average_smoothness,$Constrain_values,$Local_normalization_Channel
-if {$boost_fade_Amplitude>0}
-gimp_boost_fade[-1] $boost_fade_Amplitude
-endif
-endif
-endl -done
Couleurs_Metalliques_preview :
-gimp_split_preview "-Couleurs_Metalliques ${1--2}",$-1
samj_rien_contours :
-Je_passe_l_hiver_en_Floride[-1]
samj_rien_deformations :
-Je_passe_l_hiver_en_Floride[-1]
samj_rien_degradations :
-Je_passe_l_hiver_en_Floride[-1]
samj_rien_details :
-Je_passe_l_hiver_en_Floride[-1]
samj_rien_frames :
-Je_passe_l_hiver_en_Floride[-1]
samj_rien_layers :
-Je_passe_l_hiver_en_Floride[-1]
samj_rien_lights_and_shadows :
-Je_passe_l_hiver_en_Floride[-1]
samj_rien_patterns :
-Je_passe_l_hiver_en_Floride[-1]
#@gimp _
#@gimp <i>Patterns</i>
#@gimp Denim texture : Denim_samj, Denim_samj(0)
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Texture</small></span>")
#@gimp : Dimension motif base = int(5,2,30)
#@gimp : Dilatation motif = int(2,0,5)
#@gimp : Retourner motif = bool(0)
#@gimp : D\303\251formation 1 = int(40,0,200)
#@gimp : D\303\251formation 2 = int(40,0,200)
#@gimp : Denim [bruit] = int(25,0,100)
#@gimp : Usure [bruit] = int(50,0,100)
#@gimp : Nettet\303\251 = float(0,0,500)
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Couleur</small></span>")
#@gimp : Couleur denim = color(43,108,126,255)
#@gimp : Sep = separator(), note = note("<small>samj - Version : <i>2015/03/15</i>.</small>")
Denim_samj :
Dimension_Motif=$1
Dilatation=$2
Retourner_motif=$3
Deformation_1=$4
Deformation_2=$5
Amplitude_Bruit=$6
Amplitude_Bruit_2=$7
Nettete=$8
R_Couleur_Denim=$9
V_Couleur_Denim=$10
B_Couleur_Denim=$11
A_Couleur_Denim=$12
Largeur={w}
Hauteur={h}
$Largeur,$Hauteur,1,4
-fill_color[-1] $R_Couleur_Denim,$V_Couleur_Denim,$B_Couleur_Denim,$A_Couleur_Denim
-to_rgba[-1]
-gimp_noise[-1] $Amplitude_Bruit,0,7,0
$Dimension_Motif,$Dimension_Motif,1,4
-if {$Retourner_motif==0}
-line[-1] 0,$Dimension_Motif,$Dimension_Motif,0,1,0,0,0,255
-else
-line[-1] 0,0,$Dimension_Motif,$Dimension_Motif,1,0,0,0,255
-endif
-resize[-1] [-2],[-2],1,100%,0,2
-dilate_circ[-1] $Dilatation
#alpha
-blend[-1,-2] alpha,1,1
-water[-1] {$Deformation_1/1000},{$Deformation_2/100}
-gimp_noise[-1] $Amplitude_Bruit_2,0,22,0
-sharpen[-1] $Nettete
-reverse[-2,-1]
-rm[-1]
#@gimp Motifs degrades cie : samj_Degrades_XYZ_CIE, samj_Degrades_XYZ_CIE(0)
#@gimp : Sep = separator(), note = note("<small>D\303\251grad\303\251 Rendu CIE Lab</small>")
#@gimp : Type d\303\251grad\303\251 = choice(6,"V Couleur A","H Couleur A","V Couleur B","H Couleur B","V Couleurs A/B Inv.","H Couleurs A/B Inv.","V Couleurs A/B","H Couleurs A/B")
#@gimp : Dimensions image = int(800,128,2048)
#@gimp : Couleur a = color(240,240,40,255)
#@gimp : Couleur b = color(120,40,240,255)
#@gimp : D\303\251calage l = float(0,0,100)
#@gimp : D\303\251calage a = float(0,-128,127)
#@gimp : D\303\251calage b = float(0,-128,127)
#@gimp : Variation l = float(100,0,100)
#@gimp : Variation a = float(64,0,255)
#@gimp : Variation b = float(64,0,255)
#@gimp : Valider variations canal alpha = bool(0)
#@gimp : Trou noir = choice(0,"Non","Mode A","Mode B")
#@gimp : D\303\251grad\303\251s al\303\251atoires = bool(1)
#@gimp : L min. ded. al\303\251a. = float(0,0,100)
#@gimp : L max. ded. al\303\251a. = float(100,0,100)
#@gimp : A min. ded. al\303\251a. = float(-128,-128,127)
#@gimp : A max. ded. al\303\251a. = float(128,-128,127)
#@gimp : B min. ded. al\303\251a. = float(-128,-128,127)
#@gimp : B max. ded. al\303\251a. = float(128,-128,127)
#@gimp : Inverser d\303\251grad\303\251 = bool(0)
#@gimp : Formes = choice(11,"Non","Sinus V - Param A B","Sinus H - Param A B","Cercles - Param A B","Rayons - Param A B","Lignes V Norm - Param A B","Lignes H Norm - Param A B","Plaid","Carre","Croix","Perspective - Param A","Sphere A","Sphere B")
#@gimp : Param\303\250tre forme a = int(0,0,100)
#@gimp : Param\303\250tre forme b = int(0,0,100)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/09</i>.</small>")
samj_Degrades_XYZ_CIE :
Type_Degrade=$1
Dimensions=$2
Ra=$3
Ga=$4
Ba=$5
Aa=$6
Rb=$7
Gb=$8
Bb=$9
Ab=$10
Decalage_L=$11
Decalage_a=$12
Decalage_b=$13
Variation_L=$14
Variation_a=$15
Variation_b=$16
Valider_Variations_Canal_A=$17
Trou_Noir=$18
Degrades_aleatoires=$19
L_Min_Ded_Alea=$20
L_Max_Ded_Alea=$21
a_Min_Ded_Alea=$22
a_Max_Ded_Alea=$23
b_Min_Ded_Alea=$24
b_Max_Ded_Alea=$25
Inverser_Degrade=$26
Variations_Formes=$27
Parametre_Forme_A=$28
Parametre_Forme_B=$29
Nb_Boucles=0
Inc_L=0
Inc_a=0
Inc_b=0
Inc_Alpha=0
# Conversions RGB > XYZ   http://www.newtone.fr/formules_conversion_colorimetrie.php
# Matrices    http://www.brucelindbloom.com/index.html?Eqn_RGB_XYZ_Matrix.html
nt_Ra={$Ra/255}
nt_Ga={$Ga/255}
nt_Ba={$Ba/255}
-if {$nt_Ra>0.04045}
nt_Ra={{{$nt_Ra+0.055}/1.055}^2.4}
-else
nt_Ra={$nt_Ra/12.92}
-endif
-if {$nt_Ga>0.04045}
nt_Ga={{{$nt_Ga+0.055}/1.055}^2.4}
-else
nt_Ga={$nt_Ga/12.92}
-endif
-if {$nt_Ba>0.04045}
nt_Ba={{{$nt_Ba+0.055}/1.055}^2.4}
-else
nt_Ba={$nt_Ba/12.92}
-endif
nt_Ra={$nt_Ra*100}
nt_Ga={$nt_Ga*100}
nt_Ba={$nt_Ba*100}
#Observateur. = 2, Illuminant = D65 sRGB
Xa={$nt_Ra*0.4124564+$nt_Ga*0.3575761+$nt_Ba*0.1804375}
Ya={$nt_Ra*0.2126729+$nt_Ga*0.7151522+$nt_Ba*0.0721750}
Za={$nt_Ra*0.0193339+$nt_Ga*0.1191920+$nt_Ba*0.9503041}
Xca=$Xa
Yca=$Ya
Zca=$Za
ref_Xa=95.047
ref_Ya=100.000
ref_Za=108.883
nt_Xa={$Xca/$ref_Xa}
nt_Ya={$Yca/$ref_Ya}
nt_Za={$Zca/$ref_Za}
-if {$nt_Xa>0.008856}
nt_Xa={$nt_Xa^{1/3}}
-else
nt_Xa={{7.787*$nt_Xa}+{16/116}}
-endif
-if {$nt_Ya>0.008856}
nt_Ya={$nt_Ya^{1/3}}
-else
nt_Ya={{7.787*$nt_Ya}+{16/116}}
-endif
-if {$nt_Za>0.008856}
nt_Za={$nt_Za^{1/3}}
-else
nt_Za={{7.787*$nt_Za}+{16/116}}
-endif
CIE_La={{116*$nt_Ya}-16}
CIE_aa={500*{$nt_Xa-$nt_Ya}}
CIE_ba={200*{$nt_Ya-$nt_Za}}
nt_Ra={$Rb/255}
nt_Ga={$Gb/255}
nt_Ba={$Bb/255}
-if {$nt_Ra>0.04045}
nt_Ra={{{$nt_Ra+0.055}/1.055}^2.4}
-else
nt_Ra={$nt_Ra/12.92}
-endif
-if {$nt_Ga>0.04045}
nt_Ga={{{$nt_Ga+0.055}/1.055}^2.4}
-else
nt_Ga={$nt_Ga/12.92}
-endif
-if {$nt_Ba>0.04045}
nt_Ba={{{$nt_Ba+0.055}/1.055}^2.4}
-else
nt_Ba={$nt_Ba/12.92}
-endif
nt_Ra={$nt_Ra*100}
nt_Ga={$nt_Ga*100}
nt_Ba={$nt_Ba*100}
#Observateur. = 2, Illuminant = D65 sRGB
Xb={$nt_Ra*0.4124564+$nt_Ga*0.3575761+$nt_Ba*0.1804375}
Yb={$nt_Ra*0.2126729+$nt_Ga*0.7151522+$nt_Ba*0.0721750}
Zb={$nt_Ra*0.0193339+$nt_Ga*0.1191920+$nt_Ba*0.9503041}
Xca=$Xb
Yca=$Yb
Zca=$Zb
ref_Xa=95.047
ref_Ya=100.000
ref_Za=108.883
nt_Xa={$Xca/$ref_Xa}
nt_Ya={$Yca/$ref_Ya}
nt_Za={$Zca/$ref_Za}
-if {$nt_Xa>0.008856}
nt_Xa={$nt_Xa^{1/3}}
-else
nt_Xa={{7.787*$nt_Xa}+{16/116}}
-endif
-if {$nt_Ya>0.008856}
nt_Ya={$nt_Ya^{1/3}}
-else
nt_Ya={{7.787*$nt_Ya}+{16/116}}
-endif
-if {$nt_Za>0.008856}
nt_Za={$nt_Za^{1/3}}
-else
nt_Za={{7.787*$nt_Za}+{16/116}}
-endif
CIE_Lb={{116*$nt_Ya}-16}
CIE_ab={500*{$nt_Xa-$nt_Ya}}
CIE_bb={200*{$nt_Ya-$nt_Za}}
-if {$Variations_Formes==1}
-if {$Type_Degrade==1}
Type_Degrade=0
-elif {$Type_Degrade==3}
Type_Degrade=2
-elif {$Type_Degrade==5}
Type_Degrade=4
-elif {$Type_Degrade==7}
Type_Degrade=6
-endif
-elif {$Variations_Formes==2}
-if {$Type_Degrade==0}
Type_Degrade=1
-elif {$Type_Degrade==2}
Type_Degrade=3
-elif {$Type_Degrade==4}
Type_Degrade=5
-elif {$Type_Degrade==6}
Type_Degrade=7
-endif
-elif {$Variations_Formes==3}
-if {$Type_Degrade==1}
Type_Degrade=0
-elif {$Type_Degrade==3}
Type_Degrade=2
-elif {$Type_Degrade==5}
Type_Degrade=4
-elif {$Type_Degrade==7}
Type_Degrade=6
-endif
Valider_Variations_Canal_A=0
-elif {$Variations_Formes==4}
-if {$Type_Degrade==0}
Type_Degrade=1
-elif {$Type_Degrade==2}
Type_Degrade=3
-elif {$Type_Degrade==4}
Type_Degrade=5
-elif {$Type_Degrade==6}
Type_Degrade=7
-endif
Valider_Variations_Canal_A=0
-elif {$Variations_Formes==5}
-if {$Type_Degrade==1}
Type_Degrade=0
-elif {$Type_Degrade==3}
Type_Degrade=2
-elif {$Type_Degrade==5}
Type_Degrade=4
-elif {$Type_Degrade==7}
Type_Degrade=6
-endif
-elif {$Variations_Formes==6}
-if {$Type_Degrade==0}
Type_Degrade=1
-elif {$Type_Degrade==2}
Type_Degrade=3
-elif {$Type_Degrade==4}
Type_Degrade=5
-elif {$Type_Degrade==6}
Type_Degrade=7
-endif
-elif {$Variations_Formes==7}
-if {$Type_Degrade==1}
Type_Degrade=0
-elif {$Type_Degrade==3}
Type_Degrade=2
-elif {$Type_Degrade==5}
Type_Degrade=4
-elif {$Type_Degrade==7}
Type_Degrade=6
-endif
-elif {$Variations_Formes==8}
-if {$Type_Degrade==1}
Type_Degrade=0
-elif {$Type_Degrade==3}
Type_Degrade=2
-elif {$Type_Degrade==5}
Type_Degrade=4
-elif {$Type_Degrade==7}
Type_Degrade=6
-endif
-elif {$Variations_Formes==9}
-if {$Type_Degrade==0}
Type_Degrade=1
-elif {$Type_Degrade==2}
Type_Degrade=3
-elif {$Type_Degrade==4}
Type_Degrade=5
-elif {$Type_Degrade==6}
Type_Degrade=7
-endif
-elif {$Variations_Formes==10}
-if {$Type_Degrade==1}
Type_Degrade=0
-elif {$Type_Degrade==3}
Type_Degrade=2
-elif {$Type_Degrade==5}
Type_Degrade=4
-elif {$Type_Degrade==7}
Type_Degrade=6
-endif
-elif {$Variations_Formes==11}
-if {$Type_Degrade==0}
Type_Degrade=1
-elif {$Type_Degrade==2}
Type_Degrade=3
-elif {$Type_Degrade==4}
Type_Degrade=5
-elif {$Type_Degrade==6}
Type_Degrade=7
-endif
-elif {$Variations_Formes==12}
-if {$Type_Degrade==1}
Type_Degrade=0
-elif {$Type_Degrade==3}
Type_Degrade=2
-elif {$Type_Degrade==5}
Type_Degrade=4
-elif {$Type_Degrade==7}
Type_Degrade=6
-endif
-endif
-rm[-1]
######
-if {{$Type_Degrade==0}||{$Type_Degrade==1}||{$Type_Degrade==2}||{$Type_Degrade==3}}
-if {{$Type_Degrade==2}||{$Type_Degrade==3}}
CIE_La=$CIE_Lb
CIE_aa=$CIE_ab
CIE_ba=$CIE_bb
Aa=$Ab
-endif
Nb_Boucles=0
Inc_L={$Variation_L/$Dimensions}
Inc_a={$Variation_a/$Dimensions}
Inc_b={$Variation_b/$Dimensions}
$Dimensions,$Dimensions,1,4
-repeat $Dimensions
-if {$Degrades_aleatoires==1}
-if {{{$Nb_Boucles+1}%{round(?(2,{$Dimensions/{2+$Type_Degrade}}))}}==0}
-if {{$L_Max_Ded_Alea}>{$L_Min_Ded_Alea}} CIE_La={round(?($L_Min_Ded_Alea,$L_Max_Ded_Alea))} -else CIE_La={round(?($L_Max_Ded_Alea,$L_Min_Ded_Alea))} -endif
-if {{$a_Max_Ded_Alea}>{$a_Min_Ded_Alea}} CIE_aa={round(?($a_Min_Ded_Alea,$a_Max_Ded_Alea))} -else CIE_aa={round(?($a_Max_Ded_Alea,$a_Min_Ded_Alea))} -endif
-if {{$b_Max_Ded_Alea}>{$b_Min_Ded_Alea}} CIE_ba={round(?($b_Min_Ded_Alea,$b_Max_Ded_Alea))} -else CIE_ba={round(?($b_Max_Ded_Alea,$b_Min_Ded_Alea))} -endif
-endif
-endif
-if {$Inverser_Degrade==0}
CIE_Lca={$CIE_La+$Decalage_L+{$Nb_Boucles*$Inc_L}}
CIE_aca={$CIE_aa+$Decalage_a+{$Nb_Boucles*$Inc_a}}
CIE_bca={$CIE_ba+$Decalage_b+{$Nb_Boucles*$Inc_b}}
-else
CIE_Lca={$CIE_La+$Decalage_L-{$Nb_Boucles*$Inc_L}}
CIE_aca={$CIE_aa+$Decalage_a-{$Nb_Boucles*$Inc_a}}
CIE_bca={$CIE_ba+$Decalage_b-{$Nb_Boucles*$Inc_b}}
-endif
-if {$Trou_Noir==0}
-if {$CIE_Lca>100} CIE_Lca=100 -endif
-if {$CIE_Lca<0} CIE_Lca=0 -endif
-if {$CIE_aca>127} CIE_aca=127 -endif
-if {$CIE_aca<-128} CIE_aca=-128 -endif
-if {$CIE_bca>127} CIE_bca=127 -endif
-if {$CIE_bca<-128} CIE_bca=-128 -endif
-elif {$Trou_Noir==1}
-if {$CIE_Lca>100} Inc_L={-1*$Inc_L} CIE_Lca=100  -endif
-if {$CIE_Lca<0} Inc_L={-1*$Inc_L} CIE_Lca=0 -endif
-if {$CIE_aca>127} Inc_a={-1*$Inc_a} CIE_aca=0 -endif
-if {$CIE_aca<-128} Inc_a={-1*$Inc_a} CIE_aca=0 -endif
-if {$CIE_bca>127} Inc_b={-1*$Inc_b} CIE_bca=0 -endif
-if {$CIE_bca<-128} Inc_b={-1*$Inc_b} CIE_bca=0 -endif
-elif {$Trou_Noir==2}
-if {$CIE_Lca>100} CIE_Lca={$CIE_Lca-100} -endif
-if {$CIE_Lca<0} CIE_Lca={$CIE_Lca+100} -endif
-if {$CIE_aca>127} CIE_aca={$CIE_aca-255} -endif
-if {$CIE_aca<-128} CIE_aca={$CIE_aca+255} -endif
-if {$CIE_bca>127} CIE_bca={$CIE_bca-255} -endif
-if {$CIE_bca<-128} CIE_bca={$CIE_bca+255} -endif
-endif
# Conversions Lab > XYZ   http://www.newtone.fr/formules_conversion_colorimetrie.php
nt_Yca={{$CIE_Lca+16}/116}
nt_Xca={$CIE_aca/500+$nt_Yca}
nt_Zca={$nt_Yca-$CIE_bca/200}
-if {{$nt_Yca^3}>0.008856}
nt_Yca={$nt_Yca^3}
-else
nt_Yca={{$nt_Yca-16/116}/7.787}
-endif
-if {{$nt_Xca^3}>0.008856}
nt_Xca={$nt_Xca^3}
-else
nt_Xca={{$nt_Xca-16/116}/7.787}
-endif
-if {{$nt_Zca^3}>0.008856}
nt_Zca={$nt_Zca^3}
-else
nt_Zca={{$nt_Zca-16/116}/7.787}
-endif
ref_Xca=95.047
ref_Yca=100.000
ref_Zca=108.883
Xca={$ref_Xca*$nt_Xca}
Yca={$ref_Yca*$nt_Yca}
Zca={$ref_Zca*$nt_Zca}
# Conversions XYZ > Lab   http://www.newtone.fr/formules_conversion_colorimetrie.php
# Matrices    http://www.brucelindbloom.com/index.html?Eqn_RGB_XYZ_Matrix.html
vcXa=$Xca
vcYa=$Yca
vcZa=$Zca
nt_X={$vcXa/100}
nt_Y={$vcYa/100}
nt_Z={$vcZa/100}
nt_R={$nt_X*3.2404542+$nt_Y*-1.5371385+$nt_Z*-0.4985314}
nt_G={$nt_X*-0.9692660+$nt_Y*1.8760108+$nt_Z*0.0415560}
nt_B={$nt_X*0.0556434+$nt_Y*-0.2040259+$nt_Z*1.0572252}
-if {$nt_R>0.0031308}
nt_R={1.055*{$nt_R^{1/2.4}}-0.055}
-else
nt_R={12.92*$nt_R}
-endif
-if {$nt_G>0.0031308}
nt_G={1.055*{$nt_G^{1/2.4}}-0.055}
-else
nt_G={12.92*$nt_G}
-endif
-if {$nt_B>0.0031308}
nt_B={1.055*{$nt_B^{1/2.4}}-0.055}
-else
nt_B={12.92*$nt_B}
-endif
Rconv={$nt_R*255}
Gconv={$nt_G*255}
Bconv={$nt_B*255}
-if {$Rconv>255} Rconv=255 -endif
-if {$Rconv<0} Rconv=0 -endif
-if {$Gconv>255} Gconv=255 -endif
-if {$Gconv<0} Gconv=0 -endif
-if {$Bconv>255} Bconv=255 -endif
-if {$Bconv<0} Bconv=0 -endif
-if {{$Type_Degrade==0}||{$Type_Degrade==2}}
-line[-1] $Nb_Boucles,0,$Nb_Boucles,{$Dimensions-1},1,$Rconv,$Gconv,$Bconv,$Aa
-elif {{$Type_Degrade==1}||{$Type_Degrade==3}}
-line[-1] 0,$Nb_Boucles,{$Dimensions-1},$Nb_Boucles,1,$Rconv,$Gconv,$Bconv,$Aa
-endif
Nb_Boucles={$Nb_Boucles+1}
-done
-endif
######
-if {{$Type_Degrade==4}||{$Type_Degrade==5}||{$Type_Degrade==6}||{$Type_Degrade==7}}
Nb_Boucles=0
Inc_L={{$CIE_La-$CIE_Lb}/$Dimensions}
Inc_a={{$CIE_aa-$CIE_ab}/$Dimensions}
Inc_b={{$CIE_ba-$CIE_bb}/$Dimensions}
Inc_Alpha={{$Ab-$Aa}/$Dimensions}
$Dimensions,$Dimensions,1,4
-repeat $Dimensions
-if {$Degrades_aleatoires==1}
-if {{{$Nb_Boucles+1}%{round(?(2,{$Dimensions/{2+$Type_Degrade}}))}}==0}
-if {{$L_Max_Ded_Alea}>{$L_Min_Ded_Alea}} CIE_La={round(?($L_Min_Ded_Alea,$L_Max_Ded_Alea))} -else CIE_La={round(?($L_Max_Ded_Alea,$L_Min_Ded_Alea))} -endif
-if {{$a_Max_Ded_Alea}>{$a_Min_Ded_Alea}} CIE_aa={round(?($a_Min_Ded_Alea,$a_Max_Ded_Alea))} -else CIE_aa={round(?($a_Max_Ded_Alea,$a_Min_Ded_Alea))} -endif
-if {{$b_Max_Ded_Alea}>{$b_Min_Ded_Alea}} CIE_ba={round(?($b_Min_Ded_Alea,$b_Max_Ded_Alea))} -else CIE_ba={round(?($b_Max_Ded_Alea,$b_Min_Ded_Alea))} -endif
-endif
-endif
-if {$Inverser_Degrade==0}
CIE_Lca={$CIE_La+$Decalage_L+{$Nb_Boucles*$Inc_L}}
CIE_aca={$CIE_aa+$Decalage_a+{$Nb_Boucles*$Inc_a}}
CIE_bca={$CIE_ba+$Decalage_b+{$Nb_Boucles*$Inc_b}}
-endif
-if {$Inverser_Degrade==1||{$Type_Degrade==6}||{$Type_Degrade==7}}
CIE_Lca={$CIE_La+$Decalage_L-{$Nb_Boucles*$Inc_L}}
CIE_aca={$CIE_aa+$Decalage_a-{$Nb_Boucles*$Inc_a}}
CIE_bca={$CIE_ba+$Decalage_b-{$Nb_Boucles*$Inc_b}}
-endif
-if {$Valider_Variations_Canal_A==1}
Aa={$Aa+$Inc_Alpha}
-if {$Aa>255} Aa=255 -endif
-if {$Aa<0} Aa=0 -endif
-endif
-if {$Trou_Noir==0}
-if {$CIE_Lca>100} CIE_Lca=100 -endif
-if {$CIE_Lca<0} CIE_Lca=0 -endif
-if {$CIE_aca>127} CIE_aca=127 -endif
-if {$CIE_aca<-128} CIE_aca=-128 -endif
-if {$CIE_bca>127} CIE_bca=127 -endif
-if {$CIE_bca<-128} CIE_bca=-128 -endif
-elif {$Trou_Noir==1}
-if {$CIE_Lca>100} Inc_L={-1*$Inc_L} CIE_Lca=$CIE_Lb  -endif
-if {$CIE_Lca<0} Inc_L={-1*$Inc_L} CIE_Lca=$CIE_La -endif
-if {$CIE_aca>127} Inc_a={-1*$Inc_a} CIE_aca=0 -endif
-if {$CIE_aca<-128} Inc_a={-1*$Inc_a} CIE_aca=0 -endif
-if {$CIE_bca>127} Inc_b={-1*$Inc_b} CIE_bca=0 -endif
-if {$CIE_bca<-128} Inc_b={-1*$Inc_b} CIE_bca=0 -endif
-elif {$Trou_Noir==2}
-if {$CIE_Lca>100} CIE_Lca={$CIE_Lca-100} -endif
-if {$CIE_Lca<0} CIE_Lca={$CIE_Lca+100} -endif
-if {$CIE_aca>127} CIE_aca={$CIE_aca-255} -endif
-if {$CIE_aca<-128} CIE_aca={$CIE_aca+255} -endif
-if {$CIE_bca>127} CIE_bca={$CIE_bca-255} -endif
-if {$CIE_bca<-128} CIE_bca={$CIE_bca+255} -endif
-endif
# Conversions Lab > XYZ   http://www.newtone.fr/formules_conversion_colorimetrie.php
nt_Yca={{$CIE_Lca+16}/116}
nt_Xca={$CIE_aca/500+$nt_Yca}
nt_Zca={$nt_Yca-$CIE_bca/200}
-if {{$nt_Yca^3}>0.008856}
nt_Yca={$nt_Yca^3}
-else
nt_Yca={{$nt_Yca-16/116}/7.787}
-endif
-if {{$nt_Xca^3}>0.008856}
nt_Xca={$nt_Xca^3}
-else
nt_Xca={{$nt_Xca-16/116}/7.787}
-endif
-if {{$nt_Zca^3}>0.008856}
nt_Zca={$nt_Zca^3}
-else
nt_Zca={{$nt_Zca-16/116}/7.787}
-endif
ref_Xca=95.047
ref_Yca=100.000
ref_Zca=108.883
Xca={$ref_Xca*$nt_Xca}
Yca={$ref_Yca*$nt_Yca}
Zca={$ref_Zca*$nt_Zca}
# Conversions XYZ > Lab   http://www.newtone.fr/formules_conversion_colorimetrie.php
# Matrices    http://www.brucelindbloom.com/index.html?Eqn_RGB_XYZ_Matrix.html
vcXa=$Xca
vcYa=$Yca
vcZa=$Zca
nt_X={$vcXa/100}
nt_Y={$vcYa/100}
nt_Z={$vcZa/100}
nt_R={$nt_X*3.2404542+$nt_Y*-1.5371385+$nt_Z*-0.4985314}
nt_G={$nt_X*-0.9692660+$nt_Y*1.8760108+$nt_Z*0.0415560}
nt_B={$nt_X*0.0556434+$nt_Y*-0.2040259+$nt_Z*1.0572252}
-if {$nt_R>0.0031308}
nt_R={1.055*{$nt_R^{1/2.4}}-0.055}
-else
nt_R={12.92*$nt_R}
-endif
-if {$nt_G>0.0031308}
nt_G={1.055*{$nt_G^{1/2.4}}-0.055}
-else
nt_G={12.92*$nt_G}
-endif
-if {$nt_B>0.0031308}
nt_B={1.055*{$nt_B^{1/2.4}}-0.055}
-else
nt_B={12.92*$nt_B}
-endif
Rconv={$nt_R*255}
Gconv={$nt_G*255}
Bconv={$nt_B*255}
-if {$Rconv>255} Rconv=255 -endif
-if {$Rconv<0} Rconv=0 -endif
-if {$Gconv>255} Gconv=255 -endif
-if {$Gconv<0} Gconv=0 -endif
-if {$Bconv>255} Bconv=255 -endif
-if {$Bconv<0} Bconv=0 -endif
-if {{$Type_Degrade==4}||{$Type_Degrade==6}}
-line[-1] $Nb_Boucles,0,$Nb_Boucles,{$Dimensions-1},1,$Rconv,$Gconv,$Bconv,$Aa
-elif {{$Type_Degrade==5}||{$Type_Degrade==7}}
-line[-1] 0,$Nb_Boucles,{$Dimensions-1},$Nb_Boucles,1,$Rconv,$Gconv,$Bconv,$Aa
-endif
Nb_Boucles={$Nb_Boucles+1}
-done
-endif
#####
-if {$Variations_Formes==1}
-gimp_custom_deformation[-1] "(w+h)/"{20+$Parametre_Forme_A}" * cos(y*"{10+$Parametre_Forme_B}"/h)","1",1,1,1
-elif {$Variations_Formes==2}
-gimp_custom_deformation[-1] "1","(w+h)/"{20+$Parametre_Forme_A}" * sin(x*"{10+$Parametre_Forme_B}"/w)",1,1,1
-elif {$Variations_Formes==3}
-if {$Parametre_Forme_A<50} Parametre_Forme_A={{$Parametre_Forme_A+50}/100} -else Parametre_Forme_A={{$Parametre_Forme_A-50}/100} -endif
-if {$Parametre_Forme_B<50} Parametre_Forme_B={{$Parametre_Forme_B+50}/100} -else Parametre_Forme_B={{$Parametre_Forme_B-50}/100} -endif
-gimp_euclidean2polar[-1] $Parametre_Forme_A,$Parametre_Forme_B,1,1,1
-elif {$Variations_Formes==4}
-if {$Parametre_Forme_A<50} Parametre_Forme_A={{$Parametre_Forme_A+50}/100} -else Parametre_Forme_A={{$Parametre_Forme_A-50}/100} -endif
-if {$Parametre_Forme_B<50} Parametre_Forme_B={{$Parametre_Forme_B+50}/100} -else Parametre_Forme_B={{$Parametre_Forme_B-50}/100} -endif
-gimp_euclidean2polar[-1] $Parametre_Forme_A,$Parametre_Forme_B,1,1,1
-elif {$Variations_Formes==5}
-gimp_normalize_local[-1] {$Parametre_Forme_A+6},6,5,20,1,{{$Parametre_Forme_B+3}%23}
-elif {$Variations_Formes==6}
-gimp_normalize_local[-1] {$Parametre_Forme_A+6},6,5,20,1,{{$Parametre_Forme_B+3}%23}
-elif {$Variations_Formes==7}
-gimp_plaid_texture[-1] 50,2,0,90,0,300
-elif {$Variations_Formes==8}
-gimp_symmetrizoscope[-1] 5,0,1,0
-elif {$Variations_Formes==9}
-gimp_symmetrizoscope[-1] 5,0,1,0
-elif {$Variations_Formes==10}
-gimp_warp_perspective[-1] 1.73,0,1,50,50,$Parametre_Forme_A,0,2
-elif {$Variations_Formes==11}
-gimp_map_sphere[-1] {min($Dimensions,$Dimensions)},{min($Dimensions,$Dimensions)},90,0.5,0,0,20,0,0,0,0.5
-elif {$Variations_Formes==12}
-gimp_map_sphere[-1] {min($Dimensions,$Dimensions)},{min($Dimensions,$Dimensions)},90,0.5,0,0,20,0,0,0,0.5
-endif
samj_rien_rendering :
-Je_passe_l_hiver_en_Floride[-1]
#@gimp Points aleatoires 001 : samj_Points_Aleatoires_001, gimp_no_preview
#@gimp : Sep = separator()
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Points</small></span>")
#@gimp : It\303\251rations = int(10,1,200)
#@gimp : Couleur point = color(255,255,0,255)
#@gimp : Mode = choice(3,"XY Aleatoire","X Aleatoire","Y Aleatoire","Cavalier","Fou","Tour","Reine")
#@gimp : Couleurs al\303\251atoires = bool(0)
#@gimp : Continuit\303\251 entre it\303\251rations = bool(1)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/15</i>.</small>")
samj_Points_Aleatoires_001 :
Iterations=$1
R_Point=$2
V_Point=$3
B_Point=$4
A_Point=$5
Mode=$6
Couleurs_Aleatoires=$7
Continuite=$8
Choix=0
Cavalier=0
Largeur_Origine={w}
Hauteur_Origine={h}
Position_X={round(?(0,{$Largeur_Origine-1}))}
Position_Y={round(?(0,{$Hauteur_Origine-1}))}
{w},{h},1,4
-fill_color[-1] 0,0,0,0
-rm[-2]
-repeat $Iterations
-if {$Couleurs_Aleatoires==1}
R_Point={round(?(0,255))}
V_Point={round(?(0,255))}
B_Point={round(?(0,255))}
A_Point=255
-endif
-if {$Continuite==0}
Position_X={round(?(0,{$Largeur_Origine-1}))}
Position_Y={round(?(0,{$Hauteur_Origine-1}))}
-endif
-repeat {$Largeur_Origine+$Hauteur_Origine}
Choix={round(?(0,1))}
-if {$Mode==0}
Inc_X={{round(?(0,2))}-1}
Inc_Y={{round(?(0,2))}-1}
-elif {$Mode==1}
Inc_X={{round(?(0,2))}-1}
Inc_Y={{round(?(0,{@|}))%3}-1}
-elif {$Mode==2}
Inc_X={{round(?(0,{@|}))%3}-1}
Inc_Y={{round(?(0,2))}-1}
-elif {$Mode==3}
-if {$Choix==0}
Cavalier={round(?(0,7))}
-else
Cavalier={round(?(0,4095)%8)}
-endif
-if {$Cavalier==0}
Inc_X=-1
Inc_Y=2
-elif {$Cavalier==1}
Inc_X=1
Inc_Y=2
-elif {$Cavalier==2}
Inc_X=2
Inc_Y=1
-elif {$Cavalier==3}
Inc_X=2
Inc_Y=-1
-elif {$Cavalier==4}
Inc_X=1
Inc_Y=-2
-elif {$Cavalier==5}
Inc_X=-1
Inc_Y=-2
-elif {$Cavalier==6}
Inc_X=-2
Inc_Y=-1
-elif {$Cavalier==7}
Inc_X=-2
Inc_Y=1
-endif
-elif {$Mode==4}
Inc_X={{round(?(0,8))}-{round(?(0,8))}}
-if {$Choix==0}
Inc_Y=$Inc_X
-else
Inc_Y={0-$Inc_X}
-endif
-elif {$Mode==5}
-if {$Choix==0}
Inc_X={{round(?(0,8))}-{round(?(0,8))}}
Inc_Y=0
-else
Inc_X=0
Inc_Y={{round(?(0,8))}-{round(?(0,8))}}
-endif
-elif {$Mode==6}
Choix={round(?(0,3))}
-if {$Choix==0}
Inc_X={{round(?(0,8))}-{round(?(0,8))}}
Inc_Y=$Inc_X
-elif {$Choix==1}
Inc_X={{round(?(0,8))}-{round(?(0,8))}}
Inc_Y=0
-elif {$Choix==2}
Inc_X=0
Inc_Y={{round(?(0,8))}-{round(?(0,8))}}
-elif {$Choix==3}
Inc_X={{round(?(0,8))}-{round(?(0,8))}}
Inc_Y={0-$Inc_X}
-endif
-endif
Position_X={$Position_X+$Inc_X}
-if {$Position_X<0}
Position_X={$Largeur_Origine-1}
-endif
-if {$Position_X>{$Largeur_Origine-1}}
Position_X=0
-endif
Position_Y={$Position_Y+$Inc_Y}
-if {$Position_Y<0}
Position_Y={$Hauteur_Origine-1}
-endif
-if {$Position_Y>{$Hauteur_Origine-1}}
Position_Y=0
-endif
-point[-1] $Position_X,$Position_Y,0,1,$R_Point,$V_Point,$B_Point,$A_Point
-done
-done
#@gimp Random pattern courtepointe : samj_Courtepointe, gimp_no_preview
#@gimp : Note = note("Motif au rendu al\303\251atoire / Random Pattern")
#@gimp : Sep = separator()
#@gimp : Cossin 1 / parameter 1 = int(20,1,100)
#@gimp : Cossin 2 / parameter 2 = bool(0)
#@gimp : R\303\251petition / repeat = int(1,1,5)
#@gimp : Croix / cross = bool(0)
#@gimp : Texture = bool(1)
#@gimp : Courbes des couleurs /  color curves = choice("RGB","CMY","CMYK","HSI","HSL","HSV","Lab","Lch","YCbCr")
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/07</i>.</small>")
samj_Courtepointe :
Cossin=$1
Cossin_Deux=$2
Repetition=$3
Croix=$4
Texture=$5
Courbes_Interactives_Couleurs=$6
-rorschach[-1] {$Cossin}%,1
-if {$Cossin_Deux==1}
-n[-1] 64,192
-endif
-n[-1] 0,255
-repeat $Repetition
-gimp_array_mirror[-1] 1,0,0,2,0,0
-done
-if {$Croix==1}
-gimp_symmetrizoscope[-1] 5,0,1,0
-endif
-if {$Texture==1}
-samj_Texture_Granuleuse[-1] 0.5,20,80,0,0
-endif
-if {$Courbes_Interactives_Couleurs==0}
-x_color_curves[-1] rgb
-elif {$Courbes_Interactives_Couleurs==1}
-x_color_curves[-1] cmy
-elif {$Courbes_Interactives_Couleurs==2}
-x_color_curves[-1] cmyk
-elif {$Courbes_Interactives_Couleurs==3}
-x_color_curves[-1] hsi
-elif {$Courbes_Interactives_Couleurs==4}
-x_color_curves[-1] hsl
-elif {$Courbes_Interactives_Couleurs==5}
-x_color_curves[-1] hsv
-elif {$Courbes_Interactives_Couleurs==6}
-x_color_curves[-1] lab
-elif {$Courbes_Interactives_Couleurs==7}
-x_color_curves[-1] lch
-elif {$Courbes_Interactives_Couleurs==8}
-x_color_curves[-1] ycbcr
-endif
#@gimp _
#@gimp <i>Rendering</i>
#@gimp Adjacent rectangles : samj_Rectangles_Adjacents, samj_Rectangles_Adjacents(1)
#@gimp : Sep = separator(), note = note("<small>Rendu - Rendering</small>")
#@gimp : Position x haut gauche / top left = float(10,-100,100)
#@gimp : Position y haut gauche / top left = float(10,-100,100)
#@gimp : Position x bas droite / down right = float(80,0,100)
#@gimp : Position y bas droite / down right = float(80,0,100)
#@gimp : Type / location contact = choice(0,"Haut - Top","Bas - Down","Gauche - Left","Droite - Right")
#@gimp : Position contact = float(50,0,100)
#@gimp : Nb rectangles = int(6,2,25)
#@gimp : Type n = choice(0,"Inc 1","Lin 0.1","Lin 0.2","Lin 0.3","Rand","M1","M2")
#@gimp : Angle inclinaison / tilt = float(0,0,360)
#@gimp : Contours = color(0,0,0,255)
#@gimp : Affichage / display contours = bool(1)
#@gimp : Rectangle a = color(255,255,0,127)
#@gimp : Rectangle b = color(0,0,255,127)
#@gimp : Couleurs al\303\251atoires / random colors = bool(0)
#@gimp : Miroir /  mirror = choice(0,"Sans - Wihout"," X "," Y "," X Y ")
#@gimp : Flou / blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,100)
#@gimp : Ombre / shadow = bool(0)
#@gimp : X-ombre x-shadow = float(0.5,-5,5)
#@gimp : Y-ombre y-shadow = float(0.5,-5,5)
#@gimp : Douceur ombre / smoothness shadow = float(1.8,0,5)
#@gimp : Courbure ombre / curvature shadow = float(0,0,1)
#@gimp : D\303\251calage ombre x / shadow offset x = float(0,-20,20)
#@gimp : D\303\251calage ombre y / shadow offset y = float(0,-20,20)
#@gimp : Canal alpha = bool(0)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/06</i>.</small>")
samj_Rectangles_Adjacents :
X_Haut_Gauche=$1
Y_Haut_Gauche=$2
X_Bas_Droite=$3
Y_Bas_Droite=$4
Type_Contact=$5
Position_Contact=$6
Nb_Rectangles=$7
Type_n=$8
Angle_inclinaison=$9
R_Contours=$10
V_Contours=$11
B_Contours=$12
A_Contours=$13
Affichage_Contours=$14
R_a=$15
V_a=$16
B_a=$17
A_a=$18
R_b=$19
V_b=$20
B_b=$21
A_b=$22
Couleurs_aleatoires=$23
Inversions=$24
Flou=$25
Dilatation=$26
Deformation=$27
Bruit=$28
Ombre=$29
X_Ombre=$30
Y_Ombre=$31
Smoothness_Ombre=$32
Curvature_Ombre=$33
Compensation_Decalage_Ombre_X=$34
Compensation_Decalage_Ombre_Y=$35
Canal_Alpha=$36
Largeur_Origine={w}
Hauteur_Origine={h}
Nb_boucles=0
Dimension_Image_Rotation={round({{{{$Largeur_Origine*$Largeur_Origine}+{$Hauteur_Origine*$Hauteur_Origine}}^0.5}+2})}
Decalage_X={round({{$Dimension_Image_Rotation-$Largeur_Origine}/2})}
Decalage_Y={round({{$Dimension_Image_Rotation-$Hauteur_Origine}/2})}
X_H_G_origine={$Decalage_X+{round({$Largeur_Origine*{$X_Haut_Gauche/100}})}}
Y_H_G_origine={$Decalage_Y+{round({$Hauteur_Origine*{$Y_Haut_Gauche/100}})}}
Largeur_Rectangle_origine={round({$Largeur_Origine*{$X_Bas_Droite/100}})}
Hauteur_Rectangle_origine={round({$Hauteur_Origine*{$Y_Bas_Droite/100}})}
Largeur_A_Imprimer=$Largeur_Rectangle_origine
Hauteur_A_Imprimer=$Hauteur_Rectangle_origine
-if {$Type_Contact==0}
X_Contact={$X_H_G_origine+{round({$Largeur_Rectangle_origine*{$Position_Contact/100}})}}
Y_Contact=$Y_H_G_origine
-elif {$Type_Contact==1}
X_Contact={$X_H_G_origine+{round({$Largeur_Rectangle_origine*{$Position_Contact/100}})}}
Y_Contact={$Y_H_G_origine+$Hauteur_Rectangle_origine}
-elif {$Type_Contact==2}
X_Contact=$X_H_G_origine
Y_Contact={$Y_H_G_origine+{round({$Hauteur_Rectangle_origine*{$Position_Contact/100}})}}
-elif {$Type_Contact==3}
X_Contact={$X_H_G_origine+$Largeur_Rectangle_origine}
Y_Contact={$Y_H_G_origine+{round({$Hauteur_Rectangle_origine*{$Position_Contact/100}})}}
-endif
X_H_G_A_Imprimer=$X_H_G_origine
Y_H_G_A_Imprimer=$Y_H_G_origine
-if {$Canal_Alpha==0}
-to_rgb[-1]
-else
-to_rgba[-1]
-endif
-if {$Affichage_Contours==1}
$Dimension_Image_Rotation,$Dimension_Image_Rotation,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Dimension_Image_Rotation-1},0,{$Dimension_Image_Rotation-1},{$Dimension_Image_Rotation-1},0,{$Dimension_Image_Rotation-1},1,0xFFFFFFFF,0,0,0,1 -endif
-endif
$Dimension_Image_Rotation,$Dimension_Image_Rotation,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Dimension_Image_Rotation-1},0,{$Dimension_Image_Rotation-1},{$Dimension_Image_Rotation-1},0,{$Dimension_Image_Rotation-1},1,0xFFFFFFFF,0,0,0,1 -endif
-repeat $Nb_Rectangles
Nb_boucles={$Nb_boucles+1}
-if {$Couleurs_aleatoires==1}
R_a={round(?(0,255))}
V_a={round(?(0,255))}
B_a={round(?(0,255))}
R_b={round(?(0,255))}
V_b={round(?(0,255))}
B_b={round(?(0,255))}
-endif
-if {{($Nb_boucles%2)}==0}
-polygon[-1] 4,$X_H_G_A_Imprimer,$Y_H_G_A_Imprimer,{$X_H_G_A_Imprimer+$Largeur_A_Imprimer},$Y_H_G_A_Imprimer,{$X_H_G_A_Imprimer+$Largeur_A_Imprimer},{$Y_H_G_A_Imprimer+$Hauteur_A_Imprimer},$X_H_G_A_Imprimer,{$Y_H_G_A_Imprimer+$Hauteur_A_Imprimer},1,$R_a,$V_a,$B_a,$A_a
-else
-polygon[-1] 4,$X_H_G_A_Imprimer,$Y_H_G_A_Imprimer,{$X_H_G_A_Imprimer+$Largeur_A_Imprimer},$Y_H_G_A_Imprimer,{$X_H_G_A_Imprimer+$Largeur_A_Imprimer},{$Y_H_G_A_Imprimer+$Hauteur_A_Imprimer},$X_H_G_A_Imprimer,{$Y_H_G_A_Imprimer+$Hauteur_A_Imprimer},1,$R_b,$V_b,$B_b,$A_b
-endif
-if {$Affichage_Contours==1}
-polygon[-2] 4,$X_H_G_A_Imprimer,$Y_H_G_A_Imprimer,{$X_H_G_A_Imprimer+$Largeur_A_Imprimer},$Y_H_G_A_Imprimer,{$X_H_G_A_Imprimer+$Largeur_A_Imprimer},{$Y_H_G_A_Imprimer+$Hauteur_A_Imprimer},$X_H_G_A_Imprimer,{$Y_H_G_A_Imprimer+$Hauteur_A_Imprimer},1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-if {$Type_n==0}
Largeur_A_Imprimer={$Largeur_Rectangle_origine/{$Nb_boucles+1}}
Hauteur_A_Imprimer={$Hauteur_Rectangle_origine/{$Nb_boucles+1}}
-elif {$Type_n==1}
Largeur_A_Imprimer={$Largeur_A_Imprimer*0.9}
Hauteur_A_Imprimer={$Hauteur_A_Imprimer*0.9}
-elif {$Type_n==2}
Largeur_A_Imprimer={$Largeur_A_Imprimer*0.8}
Hauteur_A_Imprimer={$Hauteur_A_Imprimer*0.8}
-elif {$Type_n==3}
Largeur_A_Imprimer={$Largeur_A_Imprimer*0.7}
Hauteur_A_Imprimer={$Hauteur_A_Imprimer*0.7}
-elif {$Type_n==4}
Largeur_A_Imprimer={$Largeur_A_Imprimer*{?(0.7,0.9)}}
Hauteur_A_Imprimer={$Hauteur_A_Imprimer*{?(0.7,0.9)}}
-elif {$Type_n==5}
Largeur_A_Imprimer={$Largeur_Rectangle_origine/{$Nb_boucles+1}}
Hauteur_A_Imprimer={$Hauteur_A_Imprimer*0.9}
-elif {$Type_n==6}
Largeur_A_Imprimer={$Largeur_A_Imprimer*0.9}
Hauteur_A_Imprimer={$Hauteur_Rectangle_origine/{$Nb_boucles+1}}
-endif
-if {$Type_Contact==0}
X_H_G_A_Imprimer={$X_Contact-{$Largeur_A_Imprimer/2}}
Y_H_G_A_Imprimer=$Y_Contact
-elif {$Type_Contact==1}
X_H_G_A_Imprimer={$X_Contact-{$Largeur_A_Imprimer/2}}
Y_H_G_A_Imprimer={$Y_Contact-$Hauteur_A_Imprimer}
-elif {$Type_Contact==2}
X_H_G_A_Imprimer=$X_Contact
Y_H_G_A_Imprimer={$Y_Contact-{$Hauteur_A_Imprimer/2}}
-elif {$Type_Contact==3}
X_H_G_A_Imprimer={$X_Contact-$Largeur_A_Imprimer}
Y_H_G_A_Imprimer={$Y_Contact-{$Hauteur_A_Imprimer/2}}
-endif
-done
-if {$Affichage_Contours==1}
-if {$Dilatation>1} -dilate_circ[-2] $Dilatation -endif
-if {$Flou>0} -blur[-1,-2] $Flou,0 -endif
-if {$Deformation>0} -deform[-1,-2] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-2] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-2] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-blend[-2,-1] alpha,1,1
-else
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-1] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-1] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-endif
-if {$Inversions==1}
-mirror[-1] x
-elif {$Inversions==2}
-mirror[-1] y
-elif {$Inversions==3}
-mirror[-1] x
-mirror[-1] y
-endif
-if {$Angle_inclinaison>0} -rotate[-1] $Angle_inclinaison,1,0,{{w}/2},{{h}/2} -endif
-crop[-1] {{{w}-$Largeur_Origine}/2},{{{h}-$Hauteur_Origine}/2},{$Largeur_Origine+{{{w}-$Largeur_Origine-1}/2}-1},{$Hauteur_Origine+{{{h}-$Hauteur_Origine-1}/2}-1}
-blend[-1,-2] alpha,1,0
#@gimp Annular steiner chains : samj_Annular_Steiner_Chains, samj_Annular_Steiner_Chains(1)
#@gimp : Note = link("http://en.wikipedia.org/wiki/Steiner_chain","http://en.wikipedia.org/wiki/Steiner_chain")
#@gimp : Sep = separator(), note = note("<small>Rendu - Rendering</small>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Rayon cercle ext\303\251rieur / radius outer circle a (>0 w%) (<0 h%) = float(50,-400,400)
#@gimp : Nb cercles ext\303\251rieurs / circles surrounding = int(6,3,360)
#@gimp : Angle inclinaison / tilt = float(0,0,360)
#@gimp : Contours = color(0,0,0,255)
#@gimp : Affichage / display contours = choice(1,"Sans","CE CI CA","CE CI CA CC","CE CI CA CC CT","CE CI CA CT","CE CA","CI CA","CA")
#@gimp : Cercle ext\303\251rieur / exterior circle a = color(255,255,0,127)
#@gimp : Cercle centre  / centre circle b = color(64,192,128,127)
#@gimp : Cercle / circle c = color(0,255,0,127)
#@gimp : Cercle / circle d = color(0,0,255,127)
#@gimp : Couleurs al\303\251atoires / random colors = bool(0)
#@gimp : Inversions = int(0,0,3)
#@gimp : Flou / blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,100)
#@gimp : Ombre / shadow = bool(0)
#@gimp : X-ombre x-shadow = float(0.5,-5,5)
#@gimp : Y-ombre y-shadow = float(0.5,-5,5)
#@gimp : Douceur ombre / smoothness shadow = float(1.8,0,5)
#@gimp : Courbure ombre / curvature shadow = float(0,0,1)
#@gimp : D\303\251calage ombre x / shadow offset x = float(0,-20,20)
#@gimp : D\303\251calage ombre y / shadow offset y = float(0,-20,20)
#@gimp : Canal alpha = bool(0))
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/08</i>.</small>")
samj_Annular_Steiner_Chains :
X={round({{w}*{$1/100}})}
Y={round({{h}*{$2/100}})}
-if {$3>0}
Rayon_Cercle_Exterieur={round({{w}*$3/{100}})}
-else
Rayon_Cercle_Exterieur={round({-{h}*$3/{100}})}
-endif
Nb_Circles_Surrounding=$4
Angle_inclinaison=$5
R_Contours=$6
V_Contours=$7
B_Contours=$8
A_Contours=$9
Affichage_Contours=$10
R_CE=$11
V_CE=$12
B_CE=$13
A_CE=$14
R_PC=$15
V_PC=$16
B_PC=$17
A_PC=$18
R_c=$19
V_c=$20
B_c=$21
A_c=$22
R_d=$23
V_d=$24
B_d=$25
A_d=$26
Couleurs_aleatoires=$27
Inversions=$28
Flou=$29
Dilatation=$30
Deformation=$31
Bruit=$32
Ombre=$33
X_Ombre=$34
Y_Ombre=$35
Smoothness_Ombre=$36
Curvature_Ombre=$37
Compensation_Decalage_Ombre_X=$38
Compensation_Decalage_Ombre_Y=$39
Canal_Alpha=$40
Largeur_Origine={w}
Hauteur_Origine={h}
Angle_Theta={pi/$Nb_Circles_Surrounding}
Rayon_Cercle_Centre={{$Rayon_Cercle_Exterieur*{1-{sin($Angle_Theta)}}}/{{1+{sin($Angle_Theta)}}}}
Rayon_Cercles_Ext={{$Rayon_Cercle_Exterieur-$Rayon_Cercle_Centre}/2}
Rayon_Centres_C_Ext={$Rayon_Cercle_Centre+$Rayon_Cercles_Ext}
Rayon_Tang={{{$Rayon_Centres_C_Ext*$Rayon_Centres_C_Ext}-{$Rayon_Cercles_Ext*$Rayon_Cercles_Ext}}^0.5}
Nb_boucles=0
X_ext=0
Y_ext=0
Angle=0
-if {$Canal_Alpha==0}
-to_rgb[-1]
-else
-to_rgba[-1]
-endif
-if {$Couleurs_aleatoires==1}
R_CE={round(?(0,255))}
V_CE={round(?(0,255))}
B_CE={round(?(0,255))}
R_PC={round(?(0,255))}
V_PC={round(?(0,255))}
B_PC={round(?(0,255))}
-endif
-if {$Affichage_Contours>0}
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-if {{$Affichage_Contours==1}||{$Affichage_Contours==2}||{$Affichage_Contours==3}||{$Affichage_Contours==4}||{$Affichage_Contours==5}}
-ellipse[-1] $X,$Y,$Rayon_Cercle_Exterieur,$Rayon_Cercle_Exterieur,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-if {{$Affichage_Contours==1}||{$Affichage_Contours==2}||{$Affichage_Contours==3}||{$Affichage_Contours==4}||{$Affichage_Contours==6}}
-ellipse[-1] $X,$Y,$Rayon_Cercle_Centre,$Rayon_Cercle_Centre,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-if {{$Affichage_Contours==2}||{$Affichage_Contours==3}}
-ellipse[-1] $X,$Y,$Rayon_Centres_C_Ext,$Rayon_Centres_C_Ext,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-if {{$Affichage_Contours==3}||{$Affichage_Contours==4}}
-ellipse[-1] $X,$Y,$Rayon_Tang,$Rayon_Tang,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-endif
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-ellipse[-1] $X,$Y,$Rayon_Cercle_Exterieur,$Rayon_Cercle_Exterieur,0,1,$R_CE,$V_CE,$B_CE,$A_CE
-ellipse[-1] $X,$Y,$Rayon_Cercle_Centre,$Rayon_Cercle_Centre,0,1,$R_PC,$V_PC,$B_PC,$A_PC
-repeat $Nb_Circles_Surrounding
Angle={$Nb_boucles*{360/$Nb_Circles_Surrounding}}
X_ext={$X+{$Rayon_Centres_C_Ext*{cos({pi/180*{$Angle+$Angle_inclinaison}})}}}
Y_ext={$Y+{$Rayon_Centres_C_Ext*{sin({pi/180*{$Angle+$Angle_inclinaison}})}}}
Nb_boucles={$Nb_boucles+1}
-if {$Couleurs_aleatoires==1}
R_c={round(?(0,255))}
V_c={round(?(0,255))}
B_c={round(?(0,255))}
R_d={round(?(0,255))}
V_d={round(?(0,255))}
B_d={round(?(0,255))}
-endif
-if {{($Nb_Circles_Surrounding%2)}==0}
-if {{($Nb_boucles%2)}==0}
-ellipse[-1] $X_ext,$Y_ext,$Rayon_Cercles_Ext,$Rayon_Cercles_Ext,0,1,$R_c,$V_c,$B_c,$A_c
-else
-ellipse[-1] $X_ext,$Y_ext,$Rayon_Cercles_Ext,$Rayon_Cercles_Ext,0,1,$R_d,$V_d,$B_d,$A_d
-endif
-else
-ellipse[-1] $X_ext,$Y_ext,$Rayon_Cercles_Ext,$Rayon_Cercles_Ext,0,1,$R_c,$V_c,$B_c,$A_c
-endif
-if {$Affichage_Contours>0}
-ellipse[-2] $X_ext,$Y_ext,$Rayon_Cercles_Ext,$Rayon_Cercles_Ext,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-done
-if {$Affichage_Contours>0}
-if {$Dilatation>1} -dilate_circ[-2] $Dilatation -endif
-if {$Flou>0} -blur[-1,-2] $Flou,0 -endif
-if {$Deformation>0} -deform[-1,-2] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-2] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-2] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-blend[-2,-1] alpha,1,1
-else
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-1] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-1] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-endif
-if {$Inversions==1}
-mirror[-1] x
-elif {$Inversions==2}
-mirror[-1] y
-elif {$Inversions==3}
-mirror[-1] x
-mirror[-1] y
-endif
-blend[-1,-2] alpha,1,0
#@gimp Chryzodes : samj_Chryzodes, samj_Chryzodes(1)
#@gimp : Note = link("http://www.chryzode.org/fr/ligne.htm","http://www.chryzode.org/fr/ligne.htm")
#@gimp : Sep = separator(), note = note("<small><b><span foreground="red">New Image</span></b></small>")
#@gimp : Image dimensions = float(100,30,400)
#@gimp : Background color = color(0,0,0,255)
#@gimp : Sep = separator(), note = note("<small><b><span foreground="blue">Rendering</span></b></small>")
#@gimp : Examples = choice(0,"None","431/7/VC=0","353/3/VC=0","619/4/VC=0","691/12/VC=0","613/20/VC=0","358/13/VC=1","118/20/VC=1","699/6/VC=0")
#@gimp : X position (%) = float(50,0,100)
#@gimp : Y position (%) = float(50,0,100)
#@gimp : External circle radius = float(45,10,200)
#@gimp : Number of points - module = int(79,10,1080)
#@gimp : Multiplier = int(3,3,33)
#@gimp : First point = int(1,1,1080)
#@gimp : Color straight lines = color(240,128,64,255)
#@gimp : Tilt angle = float(0,-360,360)
#@gimp : Type straight lines = choice(0,"Lines Inside The Circle","Over The Entire Image")
#@gimp : Random colors = choice(0,"None","Variations","Lines")
#@gimp : Sep = separator(), note = note("<small><b><span foreground="blue">Variations Rendering Image Filter</span></b></small>")
#@gimp : Variations a = int(0,0,1080)
#@gimp : Variations b = int(0,0,3)
#@gimp : Variation c = bool(0)
#@gimp : Sep = separator(), note = note("<small><b><span foreground="blue">Changes Rendering Image Filter</span></b></small>")
#@gimp : Blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : Deform = float(0,0,5)
#@gimp : Noise = float(0,0,100)
#@gimp : Draw the circle = bool(0)
#@gimp : Sep = separator(), note = note("<small>samj - Latest update : <i>2015/03/03</i>.</small>")
samj_Chryzodes :
Dimension={round({{max({w},{h})}*$1/100})}
R_fond=$2
V_fond=$3
B_fond=$4
A_fond=$5
Demo=$6
X={round({$Dimension*{$7/100}})}
Y={round({$Dimension*{$8/100}})}
Rayon_Cercle={round({$Dimension*$9/100})}
Nb_Points=$10
Multiplicateur=$11
Premier_Point=$12
R_l=$13
V_l=$14
B_l=$15
A_l=$16
Angle_Inclinaison=$17
Type_De_Lignes=$18
Couleurs_aleatoires=$19
Variations_A=$20
Variations_B=$21
Variations_C=$22
Flou=$23
Dilatation=$24
Deformation=$25
Bruit=$26
Tracer_Cercle=$27
-if {$Demo==1}
Nb_Points=431
Multiplicateur=7
Variations_A=0
Variations_B=0
Variations_C=0
-elif {$Demo==2}
Nb_Points=353
Multiplicateur=3
Variations_A=0
Variations_B=0
Variations_C=0
-elif {$Demo==3}
Nb_Points=619
Multiplicateur=4
Variations_A=0
Variations_B=0
Variations_C=0
-elif {$Demo==4}
Nb_Points=691
Multiplicateur=12
Variations_A=0
Variations_B=0
Variations_C=0
-elif {$Demo==5}
Nb_Points=613
Multiplicateur=20
Variations_A=0
Variations_B=0
Variations_C=0
-elif {$Demo==6}
Nb_Points=358
Multiplicateur=13
Variations_A=0
Variations_B=0
Variations_C=1
-elif {$Demo==7}
Nb_Points=118
Multiplicateur=20
Variations_A=0
Variations_B=0
Variations_C=1
-elif {$Demo==8}
Nb_Points=699
Multiplicateur=6
Variations_A=0
Variations_B=0
Variations_C=0
Demo=8
-endif
Largeur_Origine={w}
Hauteur_Origine={h}
Angle_Base={360/$Nb_Points}
Point_Origine=0
Sortie_Boucle_Lignes=0
Nb_Boucle_Lignes=0
Nb_Boucle_Points=0
Point_A=0
Angle_A=0
X_Imp_A=0
Y_Imp_A=0
Point_B=0
Angle_B=0
X_Imp_B=0
Y_Imp_B=0
a_Ligne=0
b_Ligne=0
X_Ex_a=0
Y_Ex_a=0
X_Ex_b=0
Y_Ex_b=0
-if {$Variations_A==0}
Boucles_Rendu=1
Variations_A=1
-else
Boucles_Rendu=2
-endif
-rm[-1]
$Dimension,$Dimension,1,4
-fill_color[-1] 0,0,0,0
Point_A=$Premier_Point
Angle_A={$Angle_Base*$Point_A}
X_Imp_A={$X+{$Rayon_Cercle*{cos({pi/180*{$Angle_A+$Angle_Inclinaison}})}}}
Y_Imp_A={$Y+{$Rayon_Cercle*{sin({pi/180*{$Angle_A+$Angle_Inclinaison}})}}}
Point_Origine=$Point_A
test=0
-repeat {$Boucles_Rendu+$Variations_B}
-if {$Couleurs_aleatoires==1}
R_l={round(?(0,255))}
V_l={round(?(0,255))}
B_l={round(?(0,255))}
-endif
-do
-if {$Couleurs_aleatoires==2}
R_l={round(?(0,255))}
V_l={round(?(0,255))}
B_l={round(?(0,255))}
-endif
-if {$Variations_C==0}
Point_B={{$Point_A*$Multiplicateur}%$Nb_Points}
-else
Point_B={{$Point_A*$Multiplicateur*2}%$Nb_Points}
-endif
Angle_B={$Angle_Base*$Point_B}
X_Imp_B={$X+{$Rayon_Cercle*{cos({pi/180*{$Angle_B+$Angle_Inclinaison}})}}}
Y_Imp_B={$Y+{$Rayon_Cercle*{sin({pi/180*{$Angle_B+$Angle_Inclinaison}})}}}
-if {$Type_De_Lignes==1}
-if {{round({$X_Imp_A*1000000000000})}=={round({$X_Imp_B*1000000000000})}}
X_Ex_a=$X_Imp_A
Y_Ex_a=0
X_Ex_b=$X_Imp_B
Y_Ex_b={$Dimension-1}
-line[-1] $X_Ex_a,$Y_Ex_a,$X_Ex_b,$Y_Ex_b,1,$R_l,$V_l,$B_l,$A_l
-else
a_Ligne={{$Y_Imp_B-$Y_Imp_A}/{$X_Imp_B-$X_Imp_A}}
b_Ligne={$Y_Imp_B-{$a_Ligne*$X_Imp_B}}
X_Ex_a=0
Y_Ex_a=$b_Ligne
X_Ex_b={$Dimension-1}
Y_Ex_b={{$a_Ligne*$X_Ex_b}+$b_Ligne}
-line[-1] $X_Ex_a,$Y_Ex_a,$X_Ex_b,$Y_Ex_b,1,$R_l,$V_l,$B_l,$A_l
-endif
-else
-line[-1] $X_Imp_A,$Y_Imp_A,$X_Imp_B,$Y_Imp_B,1,$R_l,$V_l,$B_l,$A_l
-endif
-if {{$Point_B}=={$Point_Origine}} Sortie_Boucle_Lignes=1 -endif
-if {{$Nb_Boucle_Lignes}>{$Nb_Points*$Multiplicateur}} Sortie_Boucle_Lignes=1 -endif
-if {$Variations_C==1}
-if {{$Nb_Boucle_Lignes}>{$Nb_Points}} Sortie_Boucle_Lignes=1 -endif
-endif
Point_A=$Point_B
X_Imp_A=$X_Imp_B
Y_Imp_A=$Y_Imp_B
Nb_Boucle_Lignes={$Nb_Boucle_Lignes+1}
-while {$Sortie_Boucle_Lignes==0}
Nb_Boucle_Points={$Nb_Boucle_Points+1}
Point_A={$Premier_Point+{1/$Nb_Points*$Nb_Boucle_Points/$Variations_A}}
Angle_A={$Angle_Base*$Point_A}
X_Imp_A={$X+{$Rayon_Cercle*{cos({pi/180*{$Angle_A+$Angle_Inclinaison}})}}}
Y_Imp_A={$Y+{$Rayon_Cercle*{sin({pi/180*{$Angle_A+$Angle_Inclinaison}})}}}
Point_Origine=$Point_A
Sortie_Boucle_Lignes=0
Nb_Boucle_Lignes=0
-done
-if {$Tracer_Cercle==1}
-ellipse[-1] $X,$Y,$Rayon_Cercle,$Rayon_Cercle,0,1,0xFFFFFFFF,$R_l,$V_l,$B_l,$A_l
-endif
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
$Dimension,$Dimension,1,4
-fill_color[-1] $R_fond,$V_fond,$B_fond,$A_fond
-gimp_blend[-2,-1] 1,0,1,0,1
#@gimp Dessiner un polygone - draw a polygon : samj_dessiner_un_polygone, samj_dessiner_un_polygone(1)
#@gimp : Sep = separator(), note = note("<small>Polygone / Polygone</small>")
#@gimp : Nombre de c\303\264t\303\251s / number of sides = int(5,3,90)
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Angle inclinaison = float(0,0,120)
#@gimp : Rayon cercle circonscrit / circumcircle radius (>0 w%) (<0 h%) = float(40,-400,400)
#@gimp : Rayon cercle int\303\251rieur / inner circle radius (%) = float(50,0,100)
#@gimp : Remplir polygone ext\303\251rieur / fill = bool(1)
#@gimp : Couleur polygone ext\303\251rieur = color(255,255,0)
#@gimp : Contour polygone ext\303\251rieur = bool(0)
#@gimp : Couleur contour polygone ext\303\251rieur = color(0,0,0)
#@gimp : Remplir polygone int\303\251rieur / fill = bool(1)
#@gimp : Couleur polygone int\303\251rieur = color(0,0,255)
#@gimp : Contour polygone int\303\251rieur = bool(0)
#@gimp : Couleur contour polygone int\303\251rieur = color(0,255,0)
#@gimp : Variation de couleur / color variation = choice("Pas de variation / No change","Couleurs aleatoires / Random colors","Faiblement nuancee / Poorly nuanced","Moyennement nuancee / Moderately nuanced","Fortement nuancee / Highly nuanced")
#@gimp : Sep = separator(), note = note("<small>cercles / circles</small>")
#@gimp : Remplir cercle int\303\251rieur / fill = bool(0)
#@gimp : Couleur cercle int\303\251rieur = color(127,127,127)
#@gimp : Contour cercle int\303\251rieur = bool(0)
#@gimp : Couleur contour cercle int\303\251rieur = color(0,0,0)
#@gimp : Remplir cercle ext\303\251rieur / fill = bool(0)
#@gimp : Couleur cercle ext\303\251rieur = color(255,255,255)
#@gimp : Contour cercle ext\303\251rieur = bool(0)
#@gimp : Couleur contour cercle ext\303\251rieur = color(0,0,0)
#@gimp : Dilatation (\303\251paisseur) = int(1,1,48)
#@gimp : Sep = separator(), note = note("<small>Transparence / Transparency</small>")
#@gimp : Transparence des couleurs / color transparency = int(255,0,255)
#@gimp : Sep = separator(), note = note("<small>Divers / Foo</small>")
#@gimp : Flou / blur = float(0,0,10)
#@gimp : Spread = float(0,0,10)
#@gimp : D\303\251formation = float(0,0,25)
#@gimp : Sep = separator(), note = note("<small>M\303\251lange / Blend</small>")
#@gimp : Mode = choice(1,"Add","Alpha","And","Average","Blue","Burn","Darken","Difference",
#@gimp : "Divide","Dodge","Exclusion","Freeze","Grain extract","Grain merge","Green","Hard light",
#@gimp : "Hard mix","Hue","Interpolation","Lighten","Lightness","Linear burn","Linear light","Luminance",
#@gimp : "Multiply","Negation","Or","Overlay","Pin light","Red","Reflect","Saturation",
#@gimp : "Shape Average","Shape Average0","Soft burn","Soft dodge","Soft light","Screen","Stamp","Subtract","Value",
#@gimp : "Vivid light","Xor")
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/08</i>.</small>")
samj_dessiner_un_polygone:
Nombre_de_cotes=$1
X_centre_cercle_circonscrit={$2/100*w}
Y_centre_cercle_circonscrit={$3/100*h}
Angle_inclinaison=$4
-if {$5>0}
Rayon_cercle_circonscrit={round({{w}*$5/{100}})}
-else
Rayon_cercle_circonscrit={round({-{h}*$5/{100}})}
-endif
Rayon_cercle_interieur={round({$Rayon_cercle_circonscrit/100*$6})}
Remplir_polygone_exterieur=$7
## ATTENTION variables $8,$9,$10 utilises + loin dans le script
R_Couleur_polygone_exterieur=$8
V_Couleur_polygone_exterieur=$9
B_Couleur_polygone_exterieur=$10
Contour_polygone_exterieur=$11
R_Couleur_contour_polygone_exterieur=$12
V_Couleur_contour_polygone_exterieur=$13
B_Couleur_contour_polygone_exterieur=$14
Remplir_polygone_interieur=$15
## ATTENTION variables $16,$17,$18 utilises + loin dans le script
R_Couleur_polygone_interieur=$16
V_Couleur_polygone_interieur=$17
B_Couleur_polygone_interieur=$18
Contour_polygone_interieur=$19
R_Couleur_contour_polygone_interieur=$20
V_Couleur_contour_polygone_interieur=$21
B_Couleur_contour_polygone_interieur=$22
Variation_de_couleur=$23
Remplir_cercle_interieur=$24
R_CI_plein=$25
V_CI_plein=$26
B_CI_plein=$27
Contour_cercle_interieur=$28
R_CI_contour=$29
V_CI_contour=$30
B_CI_contour=$31
Remplir_cercle_exterieur=$32
R_CE_plein=$33
V_CE_plein=$34
B_CE_plein=$35
Contour_cercle_exterieur=$36
R_CE_contour=$37
V_CE_contour=$38
B_CE_contour=$39
Valeur_dilate_circ=$40
Transparence_des_couleurs=$41
Flou_polygone=$42
Spread_polygone=$43
Deform_polygone=$44
blend=$45
{w},{h},1,4
-fill_color[-1] 0,0,0,0
#
-if {$Remplir_cercle_exterieur==1}
-ellipse[-1] $X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$Rayon_cercle_circonscrit,$Rayon_cercle_circonscrit,0,1,$R_CE_plein,$V_CE_plein,$B_CE_plein,$Transparence_des_couleurs
-endif
#
-if {$Contour_cercle_exterieur==1}
-ellipse[-1] $X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$Rayon_cercle_circonscrit,$Rayon_cercle_circonscrit,0,1,0xFFFFFF,$R_CE_contour,$V_CE_contour,$B_CE_contour,$Transparence_des_couleurs
-endif
#
Increment_angle={360/$Nombre_de_cotes}
Nb_boucle=$Nombre_de_cotes
-do
-if {$Variation_de_couleur==0}
X_point_exterieur={$X_centre_cercle_circonscrit+{round({$Rayon_cercle_circonscrit*{cos({pi/180*{$Increment_angle+$Angle_inclinaison+{360/$Nombre_de_cotes}}})}})}}
Y_point_exterieur={$Y_centre_cercle_circonscrit+{round({$Rayon_cercle_circonscrit*{sin({pi/180*{$Increment_angle+$Angle_inclinaison+{360/$Nombre_de_cotes}}})}})}}
X_point_interieur={$X_centre_cercle_circonscrit+{round({$Rayon_cercle_interieur*{cos({pi/180*{$Increment_angle+$Angle_inclinaison+{360/$Nombre_de_cotes}}})}})}}
Y_point_interieur={$Y_centre_cercle_circonscrit+{round({$Rayon_cercle_interieur*{sin({pi/180*{$Increment_angle+$Angle_inclinaison+{360/$Nombre_de_cotes}}})}})}}
-if {$Nb_boucle==$Nombre_de_cotes}
Points_polygone_exterieur=$X_point_exterieur,$Y_point_exterieur
Points_polygone_interieur=$X_point_interieur,$Y_point_interieur
-else
Points_polygone_exterieur=$Points_polygone_exterieur,$X_point_exterieur,$Y_point_exterieur
Points_polygone_interieur=$Points_polygone_interieur,$X_point_interieur,$Y_point_interieur
-endif
-if {$Nb_boucle==1}
-if {$Remplir_polygone_exterieur==1}
-polygon[-1] $Nombre_de_cotes,$Points_polygone_exterieur,1,$R_Couleur_polygone_exterieur,$V_Couleur_polygone_exterieur,$B_Couleur_polygone_exterieur,$Transparence_des_couleurs
-endif
-if {$Contour_polygone_exterieur==1}
-polygon[-1] $Nombre_de_cotes,$Points_polygone_exterieur,1,0xFFFFFF,$R_Couleur_contour_polygone_exterieur,$V_Couleur_contour_polygone_exterieur,$B_Couleur_contour_polygone_exterieur,$Transparence_des_couleurs
-endif
-if {$Remplir_cercle_interieur==1}
-ellipse[-1] $X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$Rayon_cercle_interieur,$Rayon_cercle_interieur,0,1,$R_CI_plein,$V_CI_plein,$B_CI_plein,$Transparence_des_couleurs
-endif
-if {$Contour_cercle_interieur==1}
-ellipse[-1] $X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$Rayon_cercle_interieur,$Rayon_cercle_interieur,0,1,0xFFFFFF,$R_CI_contour,$V_CI_contour,$B_CI_contour,$Transparence_des_couleurs
-endif
-if {$Remplir_polygone_interieur==1}
-polygon[-1] $Nombre_de_cotes,$Points_polygone_interieur,1,$R_Couleur_polygone_interieur,$V_Couleur_polygone_interieur,$B_Couleur_polygone_interieur,$Transparence_des_couleurs
-endif
-if {$Contour_polygone_interieur==1}
-polygon[-1] $Nombre_de_cotes,$Points_polygone_interieur,1,0xFFFFFF,$R_Couleur_contour_polygone_interieur,$V_Couleur_contour_polygone_interieur,$B_Couleur_contour_polygone_interieur,$Transparence_des_couleurs
-endif
-endif
-endif
-if {$Variation_de_couleur==1}
X_point_exterieur_1={$X_centre_cercle_circonscrit+{round({$Rayon_cercle_circonscrit*{cos({pi/180*{$Increment_angle+$Angle_inclinaison+{180/$Nombre_de_cotes}}})}})}}
Y_point_exterieur_1={$Y_centre_cercle_circonscrit+{round({$Rayon_cercle_circonscrit*{sin({pi/180*{$Increment_angle+$Angle_inclinaison+{180/$Nombre_de_cotes}}})}})}}
X_point_exterieur_2={$X_centre_cercle_circonscrit+{round({$Rayon_cercle_circonscrit*{cos({pi/180*{$Increment_angle+$Angle_inclinaison-{180/$Nombre_de_cotes}}})}})}}
Y_point_exterieur_2={$Y_centre_cercle_circonscrit+{round({$Rayon_cercle_circonscrit*{sin({pi/180*{$Increment_angle+$Angle_inclinaison-{180/$Nombre_de_cotes}}})}})}}
-if {$Remplir_polygone_exterieur==1}
-polygon[-1] 3,$X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$X_point_exterieur_1,$Y_point_exterieur_1,$X_point_exterieur_2,$Y_point_exterieur_2,1,{round(?(0,255))},{round(?(0,255))},{round(?(0,255))},$Transparence_des_couleurs
-endif
-if {$Contour_polygone_exterieur==1}
-polygon[-1] 3,$X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$X_point_exterieur_1,$Y_point_exterieur_1,$X_point_exterieur_2,$Y_point_exterieur_2,1,0xFFFFFF,{round(?(0,255))},{round(?(0,255))},{round(?(0,255))},$Transparence_des_couleurs
-endif
X_point_interieur_1={$X_centre_cercle_circonscrit+{round({$Rayon_cercle_interieur*{cos({pi/180*{$Increment_angle+$Angle_inclinaison+{180/$Nombre_de_cotes}}})}})}}
Y_point_interieur_1={$Y_centre_cercle_circonscrit+{round({$Rayon_cercle_interieur*{sin({pi/180*{$Increment_angle+$Angle_inclinaison+{180/$Nombre_de_cotes}}})}})}}
X_point_interieur_2={$X_centre_cercle_circonscrit+{round({$Rayon_cercle_interieur*{cos({pi/180*{$Increment_angle+$Angle_inclinaison-{180/$Nombre_de_cotes}}})}})}}
Y_point_interieur_2={$Y_centre_cercle_circonscrit+{round({$Rayon_cercle_interieur*{sin({pi/180*{$Increment_angle+$Angle_inclinaison-{180/$Nombre_de_cotes}}})}})}}
-if {$Remplir_polygone_interieur==1}
-polygon[-1] 3,$X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$X_point_interieur_1,$Y_point_interieur_1,$X_point_interieur_2,$Y_point_interieur_2,1,{round(?(0,255))},{round(?(0,255))},{round(?(0,255))},$Transparence_des_couleurs
-endif
-if {$Contour_polygone_interieur==1}
-polygon[-1] 3,$X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$X_point_interieur_1,$Y_point_interieur_1,$X_point_interieur_2,$Y_point_interieur_2,1,0xFFFFFF,{round(?(0,255))},{round(?(0,255))},{round(?(0,255))},$Transparence_des_couleurs
-endif
-if {$Nb_boucle==1}
-if {$Remplir_cercle_interieur==1}
-ellipse[-1] $X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$Rayon_cercle_interieur,$Rayon_cercle_interieur,0,1,$R_CI_plein,$V_CI_plein,$B_CI_plein,$Transparence_des_couleurs
-endif
-if {$Contour_cercle_interieur==1}
-ellipse[-1] $X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$Rayon_cercle_interieur,$Rayon_cercle_interieur,0,1,0xFFFFFF,$R_CI_contour,$V_CI_contour,$B_CI_contour,$Transparence_des_couleurs
-endif
-endif
-endif
-if {$Variation_de_couleur>1}
Valeur_variation_couleur=16
-if {$Variation_de_couleur==3}
Valeur_variation_couleur=32
-endif
-if {$Variation_de_couleur==4}
Valeur_variation_couleur=64
-endif
R_Couleur_polygone_exterieur={round({$8+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$R_Couleur_polygone_exterieur>255}
R_Couleur_polygone_exterieur=$8
-endif
-if {$R_Couleur_polygone_exterieur<0}
R_Couleur_polygone_exterieur=$8
-endif
V_Couleur_polygone_exterieur={round({$9+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$V_Couleur_polygone_exterieur>255}
V_Couleur_polygone_exterieur=$9
-endif
-if {$V_Couleur_polygone_exterieur<0}
V_Couleur_polygone_exterieur=$9
-endif
B_Couleur_polygone_exterieur={round({$10+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$B_Couleur_polygone_exterieur>255}
B_Couleur_polygone_exterieur=$10
-endif
-if {$B_Couleur_polygone_exterieur<0}
B_Couleur_polygone_exterieur=$10
-endif
R_Couleur_polygone_interieur={round({$16+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$R_Couleur_polygone_interieur>255}
R_Couleur_polygone_interieur=$16
-endif
-if {$R_Couleur_polygone_interieur<0}
R_Couleur_polygone_interieur=$16
-endif
V_Couleur_polygone_interieur={round({$17+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$V_Couleur_polygone_interieur>255}
V_Couleur_polygone_interieur=$17
-endif
-if {$V_Couleur_polygone_interieur<0}
V_Couleur_polygone_interieur=$17
-endif
B_Couleur_polygone_interieur={round({$18+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$B_Couleur_polygone_interieur>255}
B_Couleur_polygone_interieur=$18
-endif
-if {$B_Couleur_polygone_interieur<0}
B_Couleur_polygone_interieur=$18
-endif
X_point_exterieur_1={$X_centre_cercle_circonscrit+{round({$Rayon_cercle_circonscrit*{cos({pi/180*{$Increment_angle+$Angle_inclinaison+{180/$Nombre_de_cotes}}})}})}}
Y_point_exterieur_1={$Y_centre_cercle_circonscrit+{round({$Rayon_cercle_circonscrit*{sin({pi/180*{$Increment_angle+$Angle_inclinaison+{180/$Nombre_de_cotes}}})}})}}
X_point_exterieur_2={$X_centre_cercle_circonscrit+{round({$Rayon_cercle_circonscrit*{cos({pi/180*{$Increment_angle+$Angle_inclinaison-{180/$Nombre_de_cotes}}})}})}}
Y_point_exterieur_2={$Y_centre_cercle_circonscrit+{round({$Rayon_cercle_circonscrit*{sin({pi/180*{$Increment_angle+$Angle_inclinaison-{180/$Nombre_de_cotes}}})}})}}
-if {$Remplir_polygone_exterieur==1}
-polygon[-1] 3,$X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$X_point_exterieur_1,$Y_point_exterieur_1,$X_point_exterieur_2,$Y_point_exterieur_2,1,$R_Couleur_polygone_exterieur,$V_Couleur_polygone_exterieur,$B_Couleur_polygone_exterieur,$Transparence_des_couleurs
-endif
-if {$Contour_polygone_exterieur==1}
-polygon[-1] 3,$X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$X_point_exterieur_1,$Y_point_exterieur_1,$X_point_exterieur_2,$Y_point_exterieur_2,1,0xFFFFFF,$R_Couleur_contour_polygone_exterieur,$V_Couleur_contour_polygone_exterieur,$B_Couleur_contour_polygone_exterieur,$Transparence_des_couleurs
-endif
X_point_interieur_1={$X_centre_cercle_circonscrit+{round({$Rayon_cercle_interieur*{cos({pi/180*{$Increment_angle+$Angle_inclinaison+{180/$Nombre_de_cotes}}})}})}}
Y_point_interieur_1={$Y_centre_cercle_circonscrit+{round({$Rayon_cercle_interieur*{sin({pi/180*{$Increment_angle+$Angle_inclinaison+{180/$Nombre_de_cotes}}})}})}}
X_point_interieur_2={$X_centre_cercle_circonscrit+{round({$Rayon_cercle_interieur*{cos({pi/180*{$Increment_angle+$Angle_inclinaison-{180/$Nombre_de_cotes}}})}})}}
Y_point_interieur_2={$Y_centre_cercle_circonscrit+{round({$Rayon_cercle_interieur*{sin({pi/180*{$Increment_angle+$Angle_inclinaison-{180/$Nombre_de_cotes}}})}})}}
-if {$Remplir_polygone_interieur==1}
-polygon[-1] 3,$X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$X_point_interieur_1,$Y_point_interieur_1,$X_point_interieur_2,$Y_point_interieur_2,1,$R_Couleur_polygone_interieur,$V_Couleur_polygone_interieur,$B_Couleur_polygone_interieur,$Transparence_des_couleurs
-endif
-if {$Contour_polygone_interieur==1}
-polygon[-1] 3,$X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$X_point_interieur_1,$Y_point_interieur_1,$X_point_interieur_2,$Y_point_interieur_2,1,0xFFFFFF,$R_Couleur_contour_polygone_interieur,$V_Couleur_contour_polygone_interieur,$B_Couleur_contour_polygone_interieur,$Transparence_des_couleurs
-endif
-if {$Nb_boucle==1}
-if {$Remplir_cercle_interieur==1}
-ellipse[-1] $X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$Rayon_cercle_interieur,$Rayon_cercle_interieur,0,1,$R_CI_plein,$V_CI_plein,$B_CI_plein,$Transparence_des_couleurs
-endif
-if {$Contour_cercle_interieur==1}
-ellipse[-1] $X_centre_cercle_circonscrit,$Y_centre_cercle_circonscrit,$Rayon_cercle_interieur,$Rayon_cercle_interieur,0,1,0xFFFFFF,$R_CI_contour,$V_CI_contour,$B_CI_contour,$Transparence_des_couleurs
-endif
-endif
-endif
Increment_angle={$Increment_angle+{360/$Nombre_de_cotes}}
Nb_boucle={$Nb_boucle-1}
-while {$Nb_boucle>0}
-if {$Valeur_dilate_circ>1}
-dilate_circ[-1] $Valeur_dilate_circ
-endif
-blur[-1] $Flou_polygone
-spread[-1] $Spread_polygone
-deform[-1] $Deform_polygone
-gimp_blend[-2,-1] $blend,1,1,1
#@gimp Egg oeuf granville : samj_Egg_Oeuf_Granville, samj_Egg_Oeuf_Granville(1)
#@gimp : Note = link("http://en.wikipedia.org/wiki/William_Anthony_Granville","http://en.wikipedia.org/wiki/William_Anthony_Granville")
#@gimp : Note = link("http://www.mathcurve.com/courbes2d/oeuf/oeufgranville.shtml","http://www.mathcurve.com/courbes2d/oeuf/oeufgranville.shtml")
#@gimp : Sep = separator(), note = note("<small>Rendu - Rendering</small>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : D\303\251calage x = float(0,-100,100)
#@gimp : Valeur a forme = float(20,0,100)
#@gimp : Valeur b forme = float(30,1,100)
#@gimp : Valeur r forme = float(10,0.1,99)
#@gimp : Angle inclinaison = float(0,0,360)
#@gimp : Contours = color(0,0,0,255)
#@gimp : Affichage contours = choice(1,"Sans","Egg Oeuf","Egg Oeuf CA CB CR")
#@gimp : Couleur = color(255,255,0,127)
#@gimp : Couleur al\303\251atoire / random color = bool(0)
#@gimp : Inversions = int(0,0,3)
#@gimp : Flou / blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,100)
#@gimp : Ombre = bool(0)
#@gimp : X-ombre = float(0.5,-5,5)
#@gimp : Y-ombre = float(0.5,-5,5)
#@gimp : Douceur / smoothness ombre = float(1.8,0,5)
#@gimp : Courbure / curvature ombre = float(0,0,1)
#@gimp : Compensation d\303\251calage ombre x = float(0,-50,50)
#@gimp : Compensation d\303\251calage ombre y = float(0,-50,50)
#@gimp : Canal alpha = bool(0)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/14</i>.</small>")
samj_Egg_Oeuf_Granville :
X={round({{w}*{$1/100}})}
Y={round({{h}*{$2/100}})}
Decalage_X={round({{min({w},{h})}*$3/100})}
Valeur_A={round({{min({w},{h})}*$4/40})}
Valeur_B={round({{min({w},{h})}*$5/40})}
Valeur_R={round({{min({w},{h})}*$6/40})}
Angle_Rotation=$7
R_Contours=$8
V_Contours=$9
B_Contours=$10
A_Contours=$11
Affichage_Contours=$12
R_a=$13
V_a=$14
B_a=$15
A_a=$16
Couleurs_aleatoires=$17
Inversions=$18
Flou=$19
Dilatation=$20
Deformation=$21
Bruit=$22
Ombre=$23
X_Ombre=$24
Y_Ombre=$25
Smoothness_Ombre=$26
Curvature_Ombre=$27
Compensation_Decalage_Ombre_X=$28
Compensation_Decalage_Ombre_Y=$29
Canal_Alpha=$30
Resolution=720
Largeur_Origine={w}
Hauteur_Origine={h}
Nb_boucles=0
Angle=0
X_Oeuf_A_Imprimer=0
Y_Oeuf_A_Imprimer=0
# X_Oeuf_A_Imprimer_Precedent={$X+{$Dimension*{     }}}
# Y_Oeuf_A_Imprimer_Precedent={$Y+{$Dimension*{     }}}
X_Oeuf_A_Imprimer_Precedent={{$X-{$Valeur_B+{$Valeur_R/2}}}+{$Decalage_X+{$Valeur_B+{$Valeur_R*{cos({pi/180*$Angle})}}}}}
Y_Oeuf_A_Imprimer_Precedent={$Y+{{{$Valeur_A*$Valeur_R*{sin({pi/180*$Angle})}}/{$Valeur_B+{$Valeur_R*{cos({pi/180*$Angle})}}}}}}
-if {$Canal_Alpha==0}
-to_rgb[-1]
-else
-to_rgba[-1]
-endif
-if {$Affichage_Contours>0}
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-endif
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-if {$Couleurs_aleatoires==1}
R_a={round(?(0,255))}
V_a={round(?(0,255))}
B_a={round(?(0,255))}
-endif
-if {$Affichage_Contours==2}
-ellipse[-2] {$X+$Decalage_X},$Y,$Valeur_A,$Valeur_A,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-ellipse[-2] {$X+$Decalage_X},$Y,$Valeur_B,$Valeur_B,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-ellipse[-2] {$X+$Decalage_X},$Y,$Valeur_R,$Valeur_R,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-repeat $Resolution
Nb_boucles={$Nb_boucles+1}
Angle={$Nb_boucles*{360/$Resolution}}
X_Oeuf_A_Imprimer={{$X-{$Valeur_B+{$Valeur_R/2}}}+{$Decalage_X+{$Valeur_B+{$Valeur_R*{cos({pi/180*$Angle})}}}}}
Y_Oeuf_A_Imprimer={$Y+{{{$Valeur_A*$Valeur_R*{sin({pi/180*$Angle})}}/{$Valeur_B+{$Valeur_R*{cos({pi/180*$Angle})}}}}}}
-polygon[-1] 3,{$X+$Decalage_X},$Y,$X_Oeuf_A_Imprimer_Precedent,$Y_Oeuf_A_Imprimer_Precedent,$X_Oeuf_A_Imprimer,$Y_Oeuf_A_Imprimer,1,$R_a,$V_a,$B_a,$A_a
-if {$Affichage_Contours>0}
-line[-2] $X_Oeuf_A_Imprimer_Precedent,$Y_Oeuf_A_Imprimer_Precedent,$X_Oeuf_A_Imprimer,$Y_Oeuf_A_Imprimer,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
X_Oeuf_A_Imprimer_Precedent=$X_Oeuf_A_Imprimer
Y_Oeuf_A_Imprimer_Precedent=$Y_Oeuf_A_Imprimer
-done
-if {$Affichage_Contours>0}
-if {$Dilatation>1} -dilate_circ[-2] $Dilatation -endif
-if {$Flou>0} -blur[-1,-2] $Flou,0 -endif
-if {$Deformation>0} -deform[-1,-2] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-2] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-2] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-blend[-2,-1] alpha,1,1
-else
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-1] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-1] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-endif
-if {$Inversions==1}
-mirror[-1] x
-elif {$Inversions==2}
-mirror[-1] y
-elif {$Inversions==3}
-mirror[-1] x
-mirror[-1] y
-endif
-if {$Angle_Rotation>0} -rotate[-1] $Angle_Rotation,1,0,{{w}/2},{{h}/2} -endif
-blend[-1,-2] alpha,1,0
#@gimp Egg oeuf hugelschaffer : samj_Egg_Oeuf_Hugelschaffer, samj_Egg_Oeuf_Hugelschaffer(1)
#@gimp : Note = link("http://www.mathcurve.com/courbes2d/oeuf/oeuf.shtml","http://www.mathcurve.com/courbes2d/oeuf/oeuf.shtml")
#@gimp : Sep = separator(), note = note("<small>Rendu - Rendering</small>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Dimension = float(50,0,100)
#@gimp : Valeur a forme = float(6,0,10)
#@gimp : Valeur b forme = float(48,0,100)
#@gimp : Valeur d forme = float(0,0,24)
#@gimp : Angle inclinaison = float(0,0,360)
#@gimp : Contours = color(0,0,0,255)
#@gimp : Affichage contours = choice(1,"Sans","Egg Oeuf","Egg Oeuf CA CB")
#@gimp : Couleur = color(255,255,0,127)
#@gimp : Couleur al\303\251atoire / random color = bool(0)
#@gimp : Inversions = int(0,0,3)
#@gimp : Flou / blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,100)
#@gimp : Ombre = bool(0)
#@gimp : X-ombre = float(0.5,-5,5)
#@gimp : Y-ombre = float(0.5,-5,5)
#@gimp : Douceur / smoothness ombre = float(1.8,0,5)
#@gimp : Courbure / curvature ombre = float(0,0,1)
#@gimp : Compensation d\303\251calage ombre x = float(0,-20,20)
#@gimp : Compensation d\303\251calage ombre y = float(0,-20,20)
#@gimp : Canal alpha = bool(0)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/14</i>.</small>")
samj_Egg_Oeuf_Hugelschaffer :
X={round({{w}*{$1/100}})}
Y={round({{h}*{$2/100}})}
Dimension={round({{min({w},{h})}*$3/5000})}
Valeur_A=$4
Valeur_B=$5
Valeur_D=$6
Angle_Rotation=$7
R_Contours=$8
V_Contours=$9
B_Contours=$10
A_Contours=$11
Affichage_Contours=$12
R_a=$13
V_a=$14
B_a=$15
A_a=$16
Couleurs_aleatoires=$17
Inversions=$18
Flou=$19
Dilatation=$20
Deformation=$21
Bruit=$22
Ombre=$23
X_Ombre=$24
Y_Ombre=$25
Smoothness_Ombre=$26
Curvature_Ombre=$27
Compensation_Decalage_Ombre_X=$28
Compensation_Decalage_Ombre_Y=$29
Canal_Alpha=$30
Resolution=720
Largeur_Origine={w}
Hauteur_Origine={h}
Nb_boucles=0
Angle=0
X_Oeuf_A_Imprimer=0
Y_Oeuf_A_Imprimer=0
X_Oeuf_A_Imprimer_Precedent={$X+{$Dimension*{{{{$Valeur_A*$Valeur_A}-{$Valeur_D*$Valeur_D*{sin({pi/180*$Angle})}*{sin({pi/180*$Angle})}}^0.5}+{$Valeur_D*{cos({pi/180*$Angle})}}}*{cos({pi/180*$Angle})}}}}
Y_Oeuf_A_Imprimer_Precedent={$Y+{$Dimension*{$Valeur_B*{sin({pi/180*$Angle})}}}}
-if {$Canal_Alpha==0}
-to_rgb[-1]
-else
-to_rgba[-1]
-endif
-if {$Affichage_Contours>0}
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-endif
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-if {$Couleurs_aleatoires==1}
R_a={round(?(0,255))}
V_a={round(?(0,255))}
B_a={round(?(0,255))}
-endif
-if {$Affichage_Contours==2}
-ellipse[-2] $X,$Y,{$Dimension*$Valeur_A},{$Dimension*$Valeur_A},0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-ellipse[-2] $X,$Y,{$Dimension*$Valeur_B},{$Dimension*$Valeur_B},0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-repeat $Resolution
Nb_boucles={$Nb_boucles+1}
Angle={$Nb_boucles*{360/$Resolution}}
X_Oeuf_A_Imprimer={$X+{$Dimension*{{{{$Valeur_A*$Valeur_A}-{$Valeur_D*$Valeur_D*{sin({pi/180*$Angle})}*{sin({pi/180*$Angle})}}^0.5}+{$Valeur_D*{cos({pi/180*$Angle})}}}*{cos({pi/180*$Angle})}}}}
Y_Oeuf_A_Imprimer={$Y+{$Dimension*{$Valeur_B*{sin({pi/180*$Angle})}}}}
-polygon[-1] 3,$X,$Y,$X_Oeuf_A_Imprimer_Precedent,$Y_Oeuf_A_Imprimer_Precedent,$X_Oeuf_A_Imprimer,$Y_Oeuf_A_Imprimer,1,$R_a,$V_a,$B_a,$A_a
-if {$Affichage_Contours>0}
-line[-2] $X_Oeuf_A_Imprimer_Precedent,$Y_Oeuf_A_Imprimer_Precedent,$X_Oeuf_A_Imprimer,$Y_Oeuf_A_Imprimer,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
X_Oeuf_A_Imprimer_Precedent=$X_Oeuf_A_Imprimer
Y_Oeuf_A_Imprimer_Precedent=$Y_Oeuf_A_Imprimer
-done
-if {$Affichage_Contours>0}
-if {$Dilatation>1} -dilate_circ[-2] $Dilatation -endif
-if {$Flou>0} -blur[-1,-2] $Flou,0 -endif
-if {$Deformation>0} -deform[-1,-2] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-2] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-2] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-blend[-2,-1] alpha,1,1
-else
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-1] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-1] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-endif
-if {$Inversions==1}
-mirror[-1] x
-elif {$Inversions==2}
-mirror[-1] y
-elif {$Inversions==3}
-mirror[-1] x
-mirror[-1] y
-endif
-if {$Angle_Rotation>0} -rotate[-1] $Angle_Rotation,1,0,{{w}/2},{{h}/2} -endif
-blend[-1,-2] alpha,1,0
#@gimp Egg oeuf rosillo : samj_Egg_Oeuf_Rosillo, samj_Egg_Oeuf_Rosillo(1)
#@gimp : Note = link("http://www.mathcurve.com/courbes2d/rosillo/rosillo.shtml","http://www.mathcurve.com/courbes2d/rosillo/rosillo.shtml")
#@gimp : Sep = separator(), note = note("<small>Rendu - Rendering</small>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Valeur a dimension = float(40,0,100)
#@gimp : Valeur b forme 200%a = float(200,0,400)
#@gimp : Valeur c forme 300%a = float(300,0,400)
#@gimp : Angle inclinaison = float(0,0,360)
#@gimp : Contours = color(0,0,0,255)
#@gimp : Affichage contours = choice(1,"Sans","Egg Oeuf","Egg Oeuf CA CB CC")
#@gimp : Couleur = color(255,255,0,127)
#@gimp : Couleur al\303\251atoire / random color = bool(0)
#@gimp : Inversions = int(0,0,3)
#@gimp : Flou / blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,100)
#@gimp : Ombre = bool(0)
#@gimp : X-ombre = float(0.5,-5,5)
#@gimp : Y-ombre = float(0.5,-5,5)
#@gimp : Douceur / smoothness ombre = float(1.8,0,5)
#@gimp : Courbure / curvature ombre = float(0,0,1)
#@gimp : Compensation d\303\251calage ombre x = float(0,-50,50)
#@gimp : Compensation d\303\251calage ombre y = float(0,-50,50)
#@gimp : Canal alpha = bool(0)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/14</i>.</small>")
samj_Egg_Oeuf_Rosillo :
X={round({{w}*{$1/100}})}
Y={round({{h}*{$2/100}})}
Valeur_A={round({{{w}+{h}}*$3/200})}
Valeur_B={$Valeur_A*$4/100}
Valeur_C={$Valeur_A*$5/100}
Angle_Rotation=$6
R_Contours=$7
V_Contours=$8
B_Contours=$9
A_Contours=$10
Affichage_Contours=$11
R_a=$12
V_a=$13
B_a=$14
A_a=$15
Couleurs_aleatoires=$16
Inversions=$17
Flou=$18
Dilatation=$19
Deformation=$20
Bruit=$21
Ombre=$22
X_Ombre=$23
Y_Ombre=$24
Smoothness_Ombre=$25
Curvature_Ombre=$26
Compensation_Decalage_Ombre_X=$27
Compensation_Decalage_Ombre_Y=$28
Canal_Alpha=$29
Resolution=720
Largeur_Origine={w}
Hauteur_Origine={h}
Nb_boucles=0
Angle=0
X_Oeuf_A_Imprimer=0
Y_Oeuf_A_Imprimer=0
# X_Oeuf_A_Imprimer_Precedent={$X+{$Dimension*{     }}}
# Y_Oeuf_A_Imprimer_Precedent={$Y+{$Dimension*{     }}}
X_Oeuf_A_Imprimer_Precedent={$X+{$Valeur_A*{cos({pi/180*$Angle})}}}
Y_Oeuf_A_Imprimer_Precedent={$Y+{{$Valeur_B-{$Valeur_A*{cos({pi/180*$Angle})}}}/{$Valeur_C-{$Valeur_A*{cos({pi/180*$Angle})}}}*{$Valeur_A*{sin({pi/180*$Angle})}}}}
-if {$Canal_Alpha==0}
-to_rgb[-1]
-else
-to_rgba[-1]
-endif
-if {$Affichage_Contours>0}
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-endif
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-if {$Couleurs_aleatoires==1}
R_a={round(?(0,255))}
V_a={round(?(0,255))}
B_a={round(?(0,255))}
-endif
-if {$Affichage_Contours==2}
-ellipse[-2] $X,$Y,$Valeur_A,$Valeur_A,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-ellipse[-2] $X,$Y,$Valeur_B,$Valeur_B,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-ellipse[-2] $X,$Y,$Valeur_C,$Valeur_C,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-repeat $Resolution
Nb_boucles={$Nb_boucles+1}
Angle={$Nb_boucles*{360/$Resolution}}
X_Oeuf_A_Imprimer={$X+{$Valeur_A*{cos({pi/180*$Angle})}}}
Y_Oeuf_A_Imprimer={$Y+{{$Valeur_B-{$Valeur_A*{cos({pi/180*$Angle})}}}/{$Valeur_C-{$Valeur_A*{cos({pi/180*$Angle})}}}*{$Valeur_A*{sin({pi/180*$Angle})}}}}
-polygon[-1] 3,$X,$Y,$X_Oeuf_A_Imprimer_Precedent,$Y_Oeuf_A_Imprimer_Precedent,$X_Oeuf_A_Imprimer,$Y_Oeuf_A_Imprimer,1,$R_a,$V_a,$B_a,$A_a
-if {$Affichage_Contours>0}
-line[-2] $X_Oeuf_A_Imprimer_Precedent,$Y_Oeuf_A_Imprimer_Precedent,$X_Oeuf_A_Imprimer,$Y_Oeuf_A_Imprimer,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
X_Oeuf_A_Imprimer_Precedent=$X_Oeuf_A_Imprimer
Y_Oeuf_A_Imprimer_Precedent=$Y_Oeuf_A_Imprimer
-done
-if {$Affichage_Contours>0}
-if {$Dilatation>1} -dilate_circ[-2] $Dilatation -endif
-if {$Flou>0} -blur[-1,-2] $Flou,0 -endif
-if {$Deformation>0} -deform[-1,-2] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-2] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-2] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-blend[-2,-1] alpha,1,1
-else
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-1] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-1] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-endif
-if {$Inversions==1}
-mirror[-1] x
-elif {$Inversions==2}
-mirror[-1] y
-elif {$Inversions==3}
-mirror[-1] x
-mirror[-1] y
-endif
-if {$Angle_Rotation>0} -rotate[-1] $Angle_Rotation,1,0,{{w}/2},{{h}/2} -endif
-blend[-1,-2] alpha,1,0
#@gimp Etoiles remplies triangles sierpinski : samj_Etoiles_Remplies_Triangles_Sierpinski, samj_Etoiles_Remplies_Triangles_Sierpinski(1)
#@gimp : Sep = separator(), note = note("<small>Rendu - Rendering</small>")
#@gimp : Nombre de sommets = int(6,2,18)
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Rayon cercle ext\303\251rieur / outer circle radius (>0 w%) (<0 h%) = float(50,-400,400)
#@gimp : Rayon cercle int\303\251rieur / inner circle radius (%) = float(40,0,100)
#@gimp : Angle inclinaison = float(30,0,60)
#@gimp : Excentricit\303\251 / eccentricity (%) = float(0,0,100)
#@gimp : Angle excentricit\303\251 / eccentricity angle = float(0,0,360)
#@gimp : Contours = color(0,0,0,255)
#@gimp : Affichage = choice(1,"Pas De Contours A","Pas De Contours B","Pas De Contours C","Pas De Contours D","Contours A","Contours B","Contours C","Contours D")
#@gimp : Recursions sierpinski = int(4,0,7)
#@gimp : Centre a = color(255,0,0,127)
#@gimp : Centre b = color(255,192,64,127)
#@gimp : Sommets a = color(0,0,255,127)
#@gimp : Sommets b = color(0,255,255,127)
#@gimp : Cercle = color(255,255,0,127)
#@gimp : Couleurs al\303\251atoires / random colors = bool(0)
#@gimp : Inversions = int(0,0,3)
#@gimp : Flou / blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,100)
#@gimp : Ombre / shadow = bool(0)
#@gimp : X-ombre x-shadow = float(0.5,-5,5)
#@gimp : Y-ombre y-shadow = float(0.5,-5,5)
#@gimp : Douceur ombre / smoothness shadow = float(1.8,0,5)
#@gimp : Courbure ombre / curvature shadow = float(0,0,1)
#@gimp : D\303\251calage ombre x / shadow offset x = float(0,-20,20)
#@gimp : D\303\251calage ombre y / shadow offset y = float(0,-20,20)
#@gimp : Canal alpha = bool(0)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/08</i>.</small>")
samj_Etoiles_Remplies_Triangles_Sierpinski :
Nombre_de_sommets=$1
X={round({{w}*{$2/100}})}
Y={round({{h}*{$3/100}})}
-if {$4>0}
Rayon_cercle_exterieur={round({{w}*$4/{100}})}
-else
Rayon_cercle_exterieur={round({-{h}*$4/{100}})}
-endif
Rayon_cercle_interieur={round({$Rayon_cercle_exterieur*$5/100})}
Angle_inclinaison=$6
Pourcentage_excentricite=$7
Angle_excentricite=$8
R_Contours=$9
V_Contours=$10
B_Contours=$11
A_Contours=$12
Affichage=$13
Recursions_Sierpinski=$14
R_Centre=$15
V_Centre=$16
B_Centre=$17
A_Centre=$18
R_Centreb=$19
V_Centreb=$20
B_Centreb=$21
A_Centreb=$22
R_Sommet=$23
V_Sommet=$24
B_Sommet=$25
A_Sommet=$26
R_Sommetb=$27
V_Sommetb=$28
B_Sommetb=$29
A_Sommetb=$30
R_Cercle=$31
V_Cercle=$32
B_Cercle=$33
A_Cercle=$34
Couleurs_aleatoires=$35
Inversions=$36
Flou=$37
Dilatation=$38
Deformation=$39
Bruit=$40
Ombre=$41
X_Ombre=$42
Y_Ombre=$43
Smoothness_Ombre=$44
Curvature_Ombre=$45
Compensation_Decalage_Ombre_X=$46
Compensation_Decalage_Ombre_Y=$47
Canal_Alpha=$48
Largeur_Origine={w}
Hauteur_Origine={h}
Nb_Boucle=0
Angle=0
Increment_angle={360/$Nombre_de_sommets}
Longueur_excentricite={$Pourcentage_excentricite/100*{$Rayon_cercle_exterieur-$Rayon_cercle_interieur}}
Decalage_X_excentricite={round({$Longueur_excentricite*{cos(pi/180*$Angle_excentricite)}})}
Decalage_Y_excentricite={round({$Longueur_excentricite*{sin(pi/180*$Angle_excentricite)}})}
X_centre_cercle_interieur={$X+$Decalage_X_excentricite}
Y_centre_cercle_interieur={$Y+$Decalage_Y_excentricite}
-if {$Canal_Alpha==0}
-to_rgb[-1]
-else
-to_rgba[-1]
-endif
#Couleurs alatoires
-if {$Couleurs_aleatoires==1}
R_Centre={round(?(0,255))}
V_Centre={round(?(0,255))}
B_Centre={round(?(0,255))}
R_Centreb={round(?(0,255))}
V_Centreb={round(?(0,255))}
B_Centreb={round(?(0,255))}
R_Sommet={round(?(0,255))}
V_Sommet={round(?(0,255))}
B_Sommet={round(?(0,255))}
R_Sommetb={round(?(0,255))}
V_Sommetb={round(?(0,255))}
B_Sommetb={round(?(0,255))}
R_Sommetb_Deux={round(?(0,255))}
V_Sommetb_Deux={round(?(0,255))}
B_Sommetb_Deux={round(?(0,255))}
R_Cercle={round(?(0,255))}
V_Cercle={round(?(0,255))}
B_Cercle={round(?(0,255))}
-endif
-if {$Affichage>3}
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-endif
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-if {{$Affichage==2}||{$Affichage==3}||{$Affichage==6}||{$Affichage==7}}
-ellipse[-1] $X,$Y,$Rayon_cercle_exterieur,$Rayon_cercle_exterieur,0,1,$R_Cercle,$V_Cercle,$B_Cercle,$A_Cercle
-endif
-repeat $Nombre_de_sommets
-if {$Couleurs_aleatoires==1}
R_Centre={round(?(0,255))}
V_Centre={round(?(0,255))}
B_Centre={round(?(0,255))}
R_Centreb={round(?(0,255))}
V_Centreb={round(?(0,255))}
B_Centreb={round(?(0,255))}
R_Sommet={round(?(0,255))}
V_Sommet={round(?(0,255))}
B_Sommet={round(?(0,255))}
R_Sommetb={round(?(0,255))}
V_Sommetb={round(?(0,255))}
B_Sommetb={round(?(0,255))}
R_Sommetb_Deux={round(?(0,255))}
V_Sommetb_Deux={round(?(0,255))}
B_Sommetb_Deux={round(?(0,255))}
R_Cercle={round(?(0,255))}
V_Cercle={round(?(0,255))}
B_Cercle={round(?(0,255))}
-endif
Nb_Boucle={$Nb_Boucle+1}
X_point_exterieur={$X+{round({$Rayon_cercle_exterieur*{cos({pi/180*{$Angle+$Angle_inclinaison}})}})}}
Y_point_exterieur={$Y+{round({$Rayon_cercle_exterieur*{sin({pi/180*{$Angle+$Angle_inclinaison}})}})}}
X_point_interieur_a={$X_centre_cercle_interieur+{round({$Rayon_cercle_interieur*{cos({pi/180*{$Angle+$Angle_inclinaison+{180/$Nombre_de_sommets}}})}})}}
Y_point_interieur_a={$Y_centre_cercle_interieur+{round({$Rayon_cercle_interieur*{sin({pi/180*{$Angle+$Angle_inclinaison+{180/$Nombre_de_sommets}}})}})}}
X_point_interieur_b={$X_centre_cercle_interieur+{round({$Rayon_cercle_interieur*{cos({pi/180*{$Angle+$Angle_inclinaison-{180/$Nombre_de_sommets}}})}})}}
Y_point_interieur_b={$Y_centre_cercle_interieur+{round({$Rayon_cercle_interieur*{sin({pi/180*{$Angle+$Angle_inclinaison-{180/$Nombre_de_sommets}}})}})}}
-if {{($Nombre_de_sommets%2)}==0}
-if {{($Nb_Boucle%2)}==0}
-if {$Recursions_Sierpinski==0}
-polygon[-1] 3,$X_point_exterieur,$Y_point_exterieur,$X_point_interieur_a,$Y_point_interieur_a,$X_point_interieur_b,$Y_point_interieur_b,1,$R_Sommet,$V_Sommet,$B_Sommet,$A_Sommet
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_point_exterieur,$Y_point_exterieur,$X_point_interieur_a,$Y_point_interieur_a,$X_point_interieur_b,$Y_point_interieur_b,$R_Sommet,$V_Sommet,$B_Sommet,$A_Sommet
-endif
-if {{($Affichage%2)}==1}
-if {$Recursions_Sierpinski==0}
-polygon[-1] 3,$X,$Y,$X_point_interieur_a,$Y_point_interieur_a,$X_point_interieur_b,$Y_point_interieur_b,1,$R_Centre,$V_Centre,$B_Centre,$A_Centre
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X,$Y,$X_point_interieur_a,$Y_point_interieur_a,$X_point_interieur_b,$Y_point_interieur_b,$R_Centre,$V_Centre,$B_Centre,$A_Centre
-endif
-endif
-else
-if {$Recursions_Sierpinski==0}
-polygon[-1] 3,$X_point_exterieur,$Y_point_exterieur,$X_point_interieur_a,$Y_point_interieur_a,$X_point_interieur_b,$Y_point_interieur_b,1,$R_Sommetb,$V_Sommetb,$B_Sommetb,$A_Sommetb
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_point_exterieur,$Y_point_exterieur,$X_point_interieur_a,$Y_point_interieur_a,$X_point_interieur_b,$Y_point_interieur_b,$R_Sommetb,$V_Sommetb,$B_Sommetb,$A_Sommetb
-endif
-if {{($Affichage%2)}==1}
-if {$Recursions_Sierpinski==0}
-polygon[-1] 3,$X,$Y,$X_point_interieur_a,$Y_point_interieur_a,$X_point_interieur_b,$Y_point_interieur_b,1,$R_Centreb,$V_Centreb,$B_Centreb,$A_Centreb
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X,$Y,$X_point_interieur_a,$Y_point_interieur_a,$X_point_interieur_b,$Y_point_interieur_b,$R_Centreb,$V_Centreb,$B_Centreb,$A_Centreb
-endif
-endif
-endif
-else
-if {$Recursions_Sierpinski==0}
-polygon[-1] 3,$X_point_exterieur,$Y_point_exterieur,$X_point_interieur_a,$Y_point_interieur_a,$X_point_interieur_b,$Y_point_interieur_b,1,$R_Sommet,$V_Sommet,$B_Sommet,$A_Sommet
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_point_exterieur,$Y_point_exterieur,$X_point_interieur_a,$Y_point_interieur_a,$X_point_interieur_b,$Y_point_interieur_b,$R_Sommet,$V_Sommet,$B_Sommet,$A_Sommet
-endif
-if {{($Affichage%2)}==1}
-if {$Recursions_Sierpinski==0}
-polygon[-1] 3,$X,$Y,$X_point_interieur_a,$Y_point_interieur_a,$X_point_interieur_b,$Y_point_interieur_b,1,$R_Centre,$V_Centre,$B_Centre,$A_Centre
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X,$Y,$X_point_interieur_a,$Y_point_interieur_a,$X_point_interieur_b,$Y_point_interieur_b,$R_Centre,$V_Centre,$B_Centre,$A_Centre
-endif
-endif
-endif
-if {$Affichage>3}
-polygon[-2] 3,$X_point_exterieur,$Y_point_exterieur,$X_point_interieur_a,$Y_point_interieur_a,$X_point_interieur_b,$Y_point_interieur_b,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
Angle={$Increment_angle*$Nb_Boucle}
-done
-if {$Affichage>5}
-ellipse[-2] $X,$Y,$Rayon_cercle_exterieur,$Rayon_cercle_exterieur,0,1,0xFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-if {$Affichage>3}
-if {$Dilatation>1} -dilate_circ[-2] $Dilatation -endif
-if {$Flou>0} -blur[-1,-2] $Flou,0 -endif
-if {$Deformation>0} -deform[-1,-2] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-2] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-2] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-blend[-2,-1] alpha,1,1
-else
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-1] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-1] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-endif
-if {$Inversions==1}
-mirror[-1] x
-elif {$Inversions==2}
-mirror[-1] y
-elif {$Inversions==3}
-mirror[-1] x
-mirror[-1] y
-endif
-blend[-1,-2] alpha,1,0
#@gimp Etoile de pompei triangles sierpinski : samj_Etoile_De_Pompei_Triangles_Sierpinski, samj_Etoile_De_Pompei_Triangles_Sierpinski(1)
#@gimp : Sep = separator(), note = note("<small>Rendu - Rendering</small>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Angle inclinaison = float(30,0,60)
#@gimp : Dimension (>0 w%) (<0 h%) = float(100,-400,400)
#@gimp : Cadre = color(0,0,0,255)
#@gimp : Afficher cadre = choice(0,"Pas Affichage","Affichage Contours Centre","Affichage Contours")
#@gimp : R\303\251cursions sierpinski = int(5,1,7)
#@gimp : Centre a = color(255,0,0,127)
#@gimp : Centre b = color(255,0,255,127)
#@gimp : Triangle = color(0,0,255,127)
#@gimp : Demi losange a = color(0,255,255,127)
#@gimp : Demi losange b = color(255,255,0,127)
#@gimp : Cercle = color(0,63,255,64)
#@gimp : Couleurs al\303\251atoires / random colors = bool(0)
#@gimp : Inversions = int(0,0,3)
#@gimp : Flou / blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,100)
#@gimp : Ombre / shadow = bool(0)
#@gimp : X-ombre x-shadow = float(0.5,-5,5)
#@gimp : Y-ombre y-shadow = float(0.5,-5,5)
#@gimp : Douceur ombre / smoothness shadow = float(1.8,0,5)
#@gimp : Courbure ombre / curvature shadow = float(0,0,1)
#@gimp : D\303\251calage ombre x / shadow offset x = float(0,-20,20)
#@gimp : D\303\251calage ombre y / shadow offset y = float(0,-20,20)
#@gimp : Canal alpha = bool(0)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/08</i>.</small>")
samj_Etoile_De_Pompei_Triangles_Sierpinski :
X={round({{w}*{$1/100}})}
Y={round({{h}*{$2/100}})}
Angle_inclinaison=$3
-if {$4>0}
Dimension={round({{w}*$4/{400*{2^0.5}}})}
-else
Dimension={round({-{h}*$4/{400*{2^0.5}}})}
-endif
R_Cadre=$5
V_Cadre=$6
B_Cadre=$7
A_Cadre=$8
Afficher_Cadre=$9
Recursions_Sierpinski=$10
R_Centre=$11
V_Centre=$12
B_Centre=$13
A_Centre=$14
R_Centreb=$15
V_Centreb=$16
B_Centreb=$17
A_Centreb=$18
R_Triangle=$19
V_Triangle=$20
B_Triangle=$21
A_Triangle=$22
R_Demi_Losange=$23
V_Demi_Losange=$24
B_Demi_Losange=$25
A_Demi_Losange=$26
R_Demi_Losange_Deux=$27
V_Demi_Losange_Deux=$28
B_Demi_Losange_Deux=$29
A_Demi_Losange_Deux=$30
R_Cercle=$31
V_Cercle=$32
B_Cercle=$33
A_Cercle=$34
Couleurs_aleatoires=$35
Inversions=$36
Flou=$37
Dilatation=$38
Deformation=$39
Bruit=$40
Ombre=$41
X_Ombre=$42
Y_Ombre=$43
Smoothness_Ombre=$44
Curvature_Ombre=$45
Compensation_Decalage_Ombre_X=$46
Compensation_Decalage_Ombre_Y=$47
Canal_Alpha=$48
Largeur_Origine={w}
Hauteur_Origine={h}
Rayon_Cercle_1=$Dimension
Rayon_Cercle_2={{{2*$Dimension*$Dimension}-{2*$Dimension*$Dimension*{cos(pi/180*150)}}}^0.5}
Rayon_Cercle_3={$Dimension+{$Dimension*{3^0.5}}}
#angles degrs
dephasage_point1_carre={0+$Angle_inclinaison}
dephasage_point2_carre={60+$Angle_inclinaison}
dephasage_point3_carre={45+$Angle_inclinaison}
dephasage_point4_carre={15+$Angle_inclinaison}
dephasage_point5_triangle={30+$Angle_inclinaison}
Nb_Boucle=0
H_X_a=0
H_Y_a=0
H_X_b=0
H_Y_b=0
H_X_c=0
H_Y_c=0
H_X_d=0
H_Y_d=0
H_X_e=0
H_Y_e=0
H_X_f=0
H_Y_f=0
xca=0
yca=0
Angle_C=0
xcb=0
ycb=0
xcc=0
ycc=0
xcd=0
ycd=0
xce=0
yce=0
-if {$Canal_Alpha==0}
-to_rgb[-1]
-else
-to_rgba[-1]
-endif
#Couleurs alatoires
-if {$Couleurs_aleatoires==1}
R_Centre={round(?(0,255))}
V_Centre={round(?(0,255))}
B_Centre={round(?(0,255))}
R_Centreb={round(?(0,255))}
V_Centreb={round(?(0,255))}
B_Centreb={round(?(0,255))}
R_Triangle={round(?(0,255))}
V_Triangle={round(?(0,255))}
B_Triangle={round(?(0,255))}
R_Demi_Losange={round(?(0,255))}
V_Demi_Losange={round(?(0,255))}
B_Demi_Losange={round(?(0,255))}
R_Demi_Losange_Deux={round(?(0,255))}
V_Demi_Losange_Deux={round(?(0,255))}
B_Demi_Losange_Deux={round(?(0,255))}
R_Cercle={round(?(0,255))}
V_Cercle={round(?(0,255))}
B_Cercle={round(?(0,255))}
-endif
-if {$Afficher_Cadre>0}
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-endif
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-if {$Afficher_Cadre==2}
-ellipse[-2] $X,$Y,$Rayon_Cercle_3,$Rayon_Cercle_3,0,1,0xFFFFFFFF,$R_Cadre,$V_Cadre,$B_Cadre,$A_Cadre
-ellipse[-1] $X,$Y,$Rayon_Cercle_3,$Rayon_Cercle_3,0,1,$R_Cercle,$V_Cercle,$B_Cercle,$A_Cercle
-endif
#-point[-1] 30,30,0,1,255,255,0,255
-repeat 6
Nb_Boucle={$Nb_Boucle+1}
-if {$Couleurs_aleatoires==1}
R_Centreb={round(?(0,255))}
V_Centreb={round(?(0,255))}
B_Centreb={round(?(0,255))}
R_Triangle={round(?(0,255))}
V_Triangle={round(?(0,255))}
B_Triangle={round(?(0,255))}
R_Demi_Losange_Deux={round(?(0,255))}
V_Demi_Losange_Deux={round(?(0,255))}
B_Demi_Losange_Deux={round(?(0,255))}
-endif
point1_X={round({$Rayon_Cercle_1*{cos(pi/180*$dephasage_point1_carre)}})}
point1_Y={round({$Rayon_Cercle_1*{sin(pi/180*$dephasage_point1_carre)}})}
point2_X={round({$Rayon_Cercle_1*{cos(pi/180*{$dephasage_point2_carre})}})}
point2_Y={round({$Rayon_Cercle_1*{sin(pi/180*{$dephasage_point2_carre})}})}
point3_X={round({$Rayon_Cercle_2*{cos(pi/180*{$dephasage_point3_carre})}})}
point3_Y={round({$Rayon_Cercle_2*{sin(pi/180*{$dephasage_point3_carre})}})}
point4_X={round({$Rayon_Cercle_2*{cos(pi/180*{$dephasage_point4_carre})}})}
point4_Y={round({$Rayon_Cercle_2*{sin(pi/180*{$dephasage_point4_carre})}})}
-if {$Nb_Boucle==1}
H_X_a={$X+$point1_X}
H_Y_a={$Y+$point1_Y}
-elif {$Nb_Boucle==2}
H_X_b={$X+$point1_X}
H_Y_b={$Y+$point1_Y}
-elif {$Nb_Boucle==3}
H_X_c={$X+$point1_X}
H_Y_c={$Y+$point1_Y}
-elif {$Nb_Boucle==4}
H_X_d={$X+$point1_X}
H_Y_d={$Y+$point1_Y}
-elif {$Nb_Boucle==5}
H_X_e={$X+$point1_X}
H_Y_e={$Y+$point1_Y}
-elif {$Nb_Boucle==6}
H_X_f={$X+$point1_X}
H_Y_f={$Y+$point1_Y}
-endif
point5_X={round({$Rayon_Cercle_3*{cos(pi/180*{$dephasage_point5_triangle})}})}
point5_Y={round({$Rayon_Cercle_3*{sin(pi/180*{$dephasage_point5_triangle})}})}
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,{$X+$point3_X},{$Y+$point3_Y},{$X+$point4_X},{$Y+$point4_Y},{$X+$point5_X},{$Y+$point5_Y},$R_Triangle,$V_Triangle,$B_Triangle,$A_Triangle
point6_X={round({$Rayon_Cercle_3*{cos(pi/180*{$dephasage_point2_carre})}})}
point6_Y={round({$Rayon_Cercle_3*{sin(pi/180*{$dephasage_point2_carre})}})}
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,{$X+$point2_X},{$Y+$point2_Y},{$X+$point3_X},{$Y+$point3_Y},{$X+$point6_X},{$Y+$point6_Y},$R_Demi_Losange_Deux,$V_Demi_Losange_Deux,$B_Demi_Losange_Deux,$A_Demi_Losange_Deux
point7_X={round({$Rayon_Cercle_3*{cos(pi/180*{$dephasage_point1_carre})}})}
point7_Y={round({$Rayon_Cercle_3*{sin(pi/180*{$dephasage_point1_carre})}})}
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,{$X+$point1_X},{$Y+$point1_Y},{$X+$point4_X},{$Y+$point4_Y},{$X+$point7_X},{$Y+$point7_Y},$R_Demi_Losange,$V_Demi_Losange,$B_Demi_Losange,$A_Demi_Losange
-if {$Afficher_Cadre>0}
-polygon[-2] 3,{$X+$point3_X},{$Y+$point3_Y},{$X+$point4_X},{$Y+$point4_Y},{$X+$point5_X},{$Y+$point5_Y},1,0xFFFFFFFF,$R_Cadre,$V_Cadre,$B_Cadre,$A_Cadre
-polygon[-2] 3,{$X+$point2_X},{$Y+$point2_Y},{$X+$point3_X},{$Y+$point3_Y},{$X+$point6_X},{$Y+$point6_Y},1,0xFFFFFFFF,$R_Cadre,$V_Cadre,$B_Cadre,$A_Cadre
-polygon[-2] 3,{$X+$point1_X},{$Y+$point1_Y},{$X+$point4_X},{$Y+$point4_Y},{$X+$point7_X},{$Y+$point7_Y},1,0xFFFFFFFF,$R_Cadre,$V_Cadre,$B_Cadre,$A_Cadre
-endif
-if {$Afficher_Cadre==2}
-polygon[-2] 4,{$X+$point1_X},{$Y+$point1_Y},{$X+$point2_X},{$Y+$point2_Y},{$X+$point3_X},{$Y+$point3_Y},{$X+$point4_X},{$Y+$point4_Y},1,0xFFFFFFFF,$R_Cadre,$V_Cadre,$B_Cadre,$A_Cadre
-endif
dephasage_point1_carre={$dephasage_point1_carre+60}
dephasage_point2_carre={$dephasage_point2_carre+60}
dephasage_point3_carre={$dephasage_point3_carre+60}
dephasage_point4_carre={$dephasage_point4_carre+60}
dephasage_point5_triangle={$dephasage_point5_triangle+60}
-done
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$H_X_a,$H_Y_a,$H_X_b,$H_Y_b,$X,$Y,$R_Centre,$V_Centre,$B_Centre,$A_Centre
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$H_X_b,$H_Y_b,$H_X_c,$H_Y_c,$X,$Y,$R_Centreb,$V_Centreb,$B_Centreb,$A_Centreb
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$H_X_c,$H_Y_c,$H_X_d,$H_Y_d,$X,$Y,$R_Centre,$V_Centre,$B_Centre,$A_Centre
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$H_X_d,$H_Y_d,$H_X_e,$H_Y_e,$X,$Y,$R_Centreb,$V_Centreb,$B_Centreb,$A_Centreb
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$H_X_e,$H_Y_e,$H_X_f,$H_Y_f,$X,$Y,$R_Centre,$V_Centre,$B_Centre,$A_Centre
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$H_X_f,$H_Y_f,$H_X_a,$H_Y_a,$X,$Y,$R_Centreb,$V_Centreb,$B_Centreb,$A_Centreb
-if {$Afficher_Cadre==0}
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-1] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-1] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-elif {$Afficher_Cadre==1}
-polygon[-2] 6,$H_X_a,$H_Y_a,$H_X_b,$H_Y_b,$H_X_c,$H_Y_c,$H_X_d,$H_Y_d,$H_X_e,$H_Y_e,$H_X_f,$H_Y_f,1,0xFFFFFFFF,$R_Cadre,$V_Cadre,$B_Cadre,$A_Cadre
-endif
-if {$Afficher_Cadre>0}
-if {$Dilatation>1} -dilate_circ[-2] $Dilatation -endif
-if {$Flou>0} -blur[-1,-2] $Flou,0 -endif
-if {$Deformation>0} -deform[-1,-2] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-2] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-2] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-blend[-2,-1] alpha,1,1
-endif
-if {$Inversions==1}
-mirror[-1] x
-elif {$Inversions==2}
-mirror[-1] y
-elif {$Inversions==3}
-mirror[-1] x
-mirror[-1] y
-endif
-blend[-1,-2] alpha,1,0
#@gimp Flocon de neige : samj_Flocon_De_Neige, samj_Flocon_De_Neige(1)
#@gimp : Note = note("<small>Ah! comme la neige a neig&#233;! <i>Soir d'hiver / &#278;mile Nelligan</i></small>")
#@gimp : Sep = separator(), note = note("<small>Rendu - Rendering</small>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Nb branches / rays = int(6,3,12)
#@gimp : Rayon cercle ext\303\251rieur / radius outer circle a (>0 w%) (<0 h%) = float(50,-400,400)
#@gimp : Rayon cercle milieu / radius middle circle = float(40,1,100)
#@gimp : Angle inclinaison / tilt = float(0,0,360)
#@gimp : R\303\251cursions contours = int(3,0,5)
#@gimp : Contours = color(192,192,192)
#@gimp : Opacit\303\251 / opacity contours = float(1,0,1)
#@gimp : Affichage / display contours = choice(0,"Non / No","Contours + Flocon/Snowflake","Contours")
#@gimp : Recursions flocon / snowflake = int(3,0,5)
#@gimp : Flocon / snowflake = color(255,255,255)
#@gimp : Opacit\303\251 flocon / opacity snowflake = float(0.7,0,1)
#@gimp : Type flocon / snowflake = choice(0,"A","B","C","A2","B2","C2")
#@gimp : Couleurs al\303\251atoires / random colors = bool(0)
#@gimp : Inversions = int(0,0,3)
#@gimp : Flou / blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,100)
#@gimp : Ombre / shadow = bool(0)
#@gimp : X-ombre x-shadow = float(0.5,-5,5)
#@gimp : Y-ombre y-shadow = float(0.5,-5,5)
#@gimp : Douceur ombre / smoothness shadow = float(1.8,0,5)
#@gimp : Courbure ombre / curvature shadow = float(0,0,1)
#@gimp : D\303\251calage ombre x / shadow offset x = float(0,-20,20)
#@gimp : D\303\251calage ombre y / shadow offset y = float(0,-20,20)
#@gimp : Canal alpha = bool(0))
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2014/04/24</i>.</small>")
samj_Flocon_De_Neige :
X={round({{w}*{$1/100}})}
Y={round({{h}*{$2/100}})}
Nb_Branches=$3
-if {$4>0}
Rayon_cercle_exterieur_flocon={round({{w}*$4/{100}})}
-else
Rayon_cercle_exterieur_flocon={round({-{h}*$4/{100}})}
-endif
Rayon_Cercle_Milieu={round($Rayon_cercle_exterieur_flocon*2)}
Rayon_Cercle_Milieu={round($Rayon_cercle_exterieur_flocon*$5/100)}
Angle_inclinaison=$6
Recursions_Contours=$7
R_Contours=$8
V_Contours=$9
B_Contours=$10
Opacity_Contours=$11
Affichage_Contours=$12
Recursions_Flocon=$13
R_F=$14
V_F=$15
B_F=$16
Opacity_Flocon=$17
Type_Flocon=$18
Couleurs_aleatoires=$19
Inversions=$20
Flou=$21
Dilatation=$22
Deformation=$23
Bruit=$24
Ombre=$25
X_Ombre=$26
Y_Ombre=$27
Smoothness_Ombre=$28
Curvature_Ombre=$29
Compensation_Decalage_Ombre_X=$30
Compensation_Decalage_Ombre_Y=$31
Canal_Alpha=$32
Largeur_Origine={w}
Hauteur_Origine={h}
Angle_Theta={360/$Nb_Branches}
Nb_boucles=0
X_ext=0
Y_ext=0
X_exta=0
Y_exta=0
X_extb=0
Y_extb=0
X_mil=0
Y_mil=0
Angle=0
-if {$Canal_Alpha==0}
-to_rgb[-1]
-else
-to_rgba[-1]
-endif
-if {$Affichage_Contours>0}
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-endif
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-repeat $Nb_Branches
Angle={$Nb_boucles*$Angle_Theta}
X_ext={$X+{$Rayon_cercle_exterieur_flocon*{cos({pi/180*{$Angle+$Angle_inclinaison+$Angle_Theta}})}}}
Y_ext={$Y+{$Rayon_cercle_exterieur_flocon*{sin({pi/180*{$Angle+$Angle_inclinaison+$Angle_Theta}})}}}
X_exta={$X+{$Rayon_cercle_exterieur_flocon/3*{cos({pi/180*{$Angle+$Angle_inclinaison+$Angle_Theta}})}}}
Y_exta={$Y+{$Rayon_cercle_exterieur_flocon/3*{sin({pi/180*{$Angle+$Angle_inclinaison+$Angle_Theta}})}}}
X_extb={$X+{$Rayon_cercle_exterieur_flocon/3*2*{cos({pi/180*{$Angle+$Angle_inclinaison+$Angle_Theta}})}}}
Y_extb={$Y+{$Rayon_cercle_exterieur_flocon/3*2*{sin({pi/180*{$Angle+$Angle_inclinaison+$Angle_Theta}})}}}
X_mil={$X+{$Rayon_Cercle_Milieu*{cos({pi/180*{$Angle+$Angle_inclinaison+{$Angle_Theta/2}}})}}}
Y_mil={$Y+{$Rayon_Cercle_Milieu*{sin({pi/180*{$Angle+$Angle_inclinaison+{$Angle_Theta/2}}})}}}
Nb_boucles={$Nb_boucles+1}
-if {$Couleurs_aleatoires==1}
R_F={round(?(0,255))}
V_F={round(?(0,255))}
B_F={round(?(0,255))}
-endif
-if {$Type_Flocon==0}
-if {$Affichage_Contours<2}
-samj_snowflake_absolu[-1] $Recursions_Flocon,$X,$Y,$X_extb,$Y_extb,$X,$Y,$Opacity_Flocon,$R_F,$V_F,$B_F
-samj_snowflake_absolu[-1] $Recursions_Flocon,$X_extb,$Y_extb,$X_ext,$Y_ext,$X_extb,$Y_extb,$Opacity_Flocon,$R_F,$V_F,$B_F
-samj_snowflake_absolu[-1] $Recursions_Flocon,$X,$Y,$X_mil,$Y_mil,$X,$Y,$Opacity_Flocon,$R_F,$V_F,$B_F
-endif
-if {$Affichage_Contours>0}
-samj_snowflake_contours_absolu[-2] $Recursions_Flocon,$X,$Y,$X_extb,$Y_extb,$X,$Y,$Opacity_Contours,$R_Contours,$V_Contours,$B_Contours
-samj_snowflake_contours_absolu[-2] $Recursions_Flocon,$X_extb,$Y_extb,$X_ext,$Y_ext,$X_extb,$Y_extb,$Opacity_Contours,$R_Contours,$V_Contours,$B_Contours
-samj_snowflake_contours_absolu[-2] $Recursions_Contours,$X,$Y,$X_mil,$Y_mil,$X,$Y,$Opacity_Contours,$R_Contours,$V_Contours,$B_Contours
-endif
-elif {$Type_Flocon==1}
-if {$Affichage_Contours<2}
-samj_snowflake_absolu[-1] $Recursions_Flocon,$X,$Y,$X_exta,$Y_exta,$X,$Y,$Opacity_Flocon,$R_F,$V_F,$B_F
-samj_snowflake_absolu[-1] $Recursions_Flocon,$X_exta,$Y_exta,$X_extb,$Y_extb,$X_exta,$Y_exta,$Opacity_Flocon,$R_F,$V_F,$B_F
-samj_snowflake_absolu[-1] $Recursions_Flocon,$X_extb,$Y_extb,$X_ext,$Y_ext,$X_extb,$Y_extb,$Opacity_Flocon,$R_F,$V_F,$B_F
-samj_snowflake_absolu[-1] $Recursions_Flocon,$X,$Y,$X_mil,$Y_mil,$X,$Y,$Opacity_Flocon,$R_F,$V_F,$B_F
-endif
-if {$Affichage_Contours>0}
-samj_snowflake_contours_absolu[-2] $Recursions_Flocon,$X,$Y,$X_exta,$Y_exta,$X,$Y,$Opacity_Contours,$R_Contours,$V_Contours,$B_Contours
-samj_snowflake_contours_absolu[-2] $Recursions_Flocon,$X_exta,$Y_exta,$X_extb,$Y_extb,$X_exta,$Y_exta,$Opacity_Contours,$R_Contours,$V_Contours,$B_Contours
-samj_snowflake_contours_absolu[-2] $Recursions_Flocon,$X_extb,$Y_extb,$X_ext,$Y_ext,$X_extb,$Y_extb,$Opacity_Contours,$R_Contours,$V_Contours,$B_Contours
-samj_snowflake_contours_absolu[-2] $Recursions_Contours,$X,$Y,$X_mil,$Y_mil,$X,$Y,$Opacity_Contours,$R_Contours,$V_Contours,$B_Contours
-endif
-elif {$Type_Flocon==2}
-if {$Affichage_Contours<2}
-samj_snowflake_absolu[-1] $Recursions_Flocon,$X,$Y,$X_ext,$Y_ext,$X,$Y,$Opacity_Flocon,$R_F,$V_F,$B_F
-samj_snowflake_absolu[-1] $Recursions_Flocon,$X,$Y,$X_mil,$Y_mil,$X,$Y,$Opacity_Flocon,$R_F,$V_F,$B_F
-endif
-if {$Affichage_Contours>0}
-samj_snowflake_contours_absolu[-2] $Recursions_Contours,$X,$Y,$X_ext,$Y_ext,$X,$Y,$Opacity_Contours,$R_Contours,$V_Contours,$B_Contours
-samj_snowflake_contours_absolu[-2] $Recursions_Contours,$X,$Y,$X_mil,$Y_mil,$X,$Y,$Opacity_Contours,$R_Contours,$V_Contours,$B_Contours
-endif
-elif {$Type_Flocon==3}
-if {$Affichage_Contours<2}
-samj_snowflake_absolu[-1] $Recursions_Flocon,$X,$Y,$X_extb,$Y_extb,$X,$Y,$Opacity_Flocon,$R_F,$V_F,$B_F
-samj_snowflake_absolu[-1] $Recursions_Flocon,$X_extb,$Y_extb,$X_ext,$Y_ext,$X_extb,$Y_extb,$Opacity_Flocon,$R_F,$V_F,$B_F
-endif
-if {$Affichage_Contours>0}
-samj_snowflake_contours_absolu[-2] $Recursions_Flocon,$X,$Y,$X_extb,$Y_extb,$X,$Y,$Opacity_Contours,$R_Contours,$V_Contours,$B_Contours
-samj_snowflake_contours_absolu[-2] $Recursions_Flocon,$X_extb,$Y_extb,$X_ext,$Y_ext,$X_extb,$Y_extb,$Opacity_Contours,$R_Contours,$V_Contours,$B_Contours
-endif
-elif {$Type_Flocon==4}
-if {$Affichage_Contours<2}
-samj_snowflake_absolu[-1] $Recursions_Flocon,$X,$Y,$X_exta,$Y_exta,$X,$Y,$Opacity_Flocon,$R_F,$V_F,$B_F
-samj_snowflake_absolu[-1] $Recursions_Flocon,$X_exta,$Y_exta,$X_extb,$Y_extb,$X_exta,$Y_exta,$Opacity_Flocon,$R_F,$V_F,$B_F
-samj_snowflake_absolu[-1] $Recursions_Flocon,$X_extb,$Y_extb,$X_ext,$Y_ext,$X_extb,$Y_extb,$Opacity_Flocon,$R_F,$V_F,$B_F
-endif
-if {$Affichage_Contours>0}
-samj_snowflake_contours_absolu[-2] $Recursions_Flocon,$X,$Y,$X_exta,$Y_exta,$X,$Y,$Opacity_Contours,$R_Contours,$V_Contours,$B_Contours
-samj_snowflake_contours_absolu[-2] $Recursions_Flocon,$X_exta,$Y_exta,$X_extb,$Y_extb,$X_exta,$Y_exta,$Opacity_Contours,$R_Contours,$V_Contours,$B_Contours
-samj_snowflake_contours_absolu[-2] $Recursions_Flocon,$X_extb,$Y_extb,$X_ext,$Y_ext,$X_extb,$Y_extb,$Opacity_Contours,$R_Contours,$V_Contours,$B_Contours
-endif
-elif {$Type_Flocon==5}
-if {$Affichage_Contours<2}
-samj_snowflake_absolu[-1] $Recursions_Flocon,$X,$Y,$X_ext,$Y_ext,$X,$Y,$Opacity_Flocon,$R_F,$V_F,$B_F
-endif
-if {$Affichage_Contours>0}
-samj_snowflake_contours_absolu[-2] $Recursions_Contours,$X,$Y,$X_ext,$Y_ext,$X,$Y,$Opacity_Contours,$R_Contours,$V_Contours,$B_Contours
-endif
-endif
-done
-if {$Affichage_Contours>0}
-if {$Dilatation>1} -dilate_circ[-2] $Dilatation -endif
-if {$Flou>0} -blur[-1,-2] $Flou,0 -endif
-if {$Deformation>0} -deform[-1,-2] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-2] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-2] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-blend[-2,-1] alpha,1,1
-else
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-1] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-1] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-endif
-if {$Inversions==1}
-mirror[-1] x
-elif {$Inversions==2}
-mirror[-1] y
-elif {$Inversions==3}
-mirror[-1] x
-mirror[-1] y
-endif
-blend[-1,-2] alpha,1,0
#@gimp Gradient cie Lab [linear] : samj_Linear_Gradient_CIE_Lab, samj_Linear_Gradient_CIE_Lab(1)
#@gimp : Note = link("http://samjcreations.blogspot.ca","http://samjcreations.blogspot.ca")
#@gimp : Sep = separator(), note = note("<small>D\303\251grad\303\251 / Gradient CIE Lab</small>")
#@gimp : Type h / v = choice(0,"H","V")
#@gimp : Swap colors = bool(0)
#@gimp : Starting color a = color(240,40,160,255)
#@gimp : Ending color b = color(240,240,40,255)
#@gimp : Sep = separator(), note = note("<small>samj - Latest update : <i>2015/03/02</i>.</small>")
samj_Linear_Gradient_CIE_Lab :
Type_Degrade=$1
Swap_colors=$2
Ra=$3
Ga=$4
Ba=$5
Aa=$6
Rb=$7
Gb=$8
Bb=$9
Ab=$10
-if {$Swap_colors==1}
Ra=$7
Ga=$8
Ba=$9
Aa=$10
Rb=$3
Gb=$4
Bb=$5
Ab=$6
-endif
# Conversions RGB > XYZ   http://www.newtone.fr/formules_conversion_colorimetrie.php
# Matrices    http://www.brucelindbloom.com/index.html?Eqn_RGB_XYZ_Matrix.html
# couleur a Linear RGB
nt_Ra={$Ra/255}
nt_Ga={$Ga/255}
nt_Ba={$Ba/255}
-if {$nt_Ra>0.04045}
nt_Ra={{{$nt_Ra+0.055}/1.055}^2.4}
-else
nt_Ra={$nt_Ra/12.92}
-endif
-if {$nt_Ga>0.04045}
nt_Ga={{{$nt_Ga+0.055}/1.055}^2.4}
-else
nt_Ga={$nt_Ga/12.92}
-endif
-if {$nt_Ba>0.04045}
nt_Ba={{{$nt_Ba+0.055}/1.055}^2.4}
-else
nt_Ba={$nt_Ba/12.92}
-endif
nt_Ra={$nt_Ra*100}
nt_Ga={$nt_Ga*100}
nt_Ba={$nt_Ba*100}
#Observateur. = 2, Illuminant = D65 sRGB
Xa={$nt_Ra*0.4124564+$nt_Ga*0.3575761+$nt_Ba*0.1804375}
Ya={$nt_Ra*0.2126729+$nt_Ga*0.7151522+$nt_Ba*0.0721750}
Za={$nt_Ra*0.0193339+$nt_Ga*0.1191920+$nt_Ba*0.9503041}
Xca=$Xa
Yca=$Ya
Zca=$Za
ref_Xa=95.047
ref_Ya=100.000
ref_Za=108.883
nt_Xa={$Xca/$ref_Xa}
nt_Ya={$Yca/$ref_Ya}
nt_Za={$Zca/$ref_Za}
-if {$nt_Xa>0.008856}
nt_Xa={$nt_Xa^{1/3}}
-else
nt_Xa={{7.787*$nt_Xa}+{16/116}}
-endif
-if {$nt_Ya>0.008856}
nt_Ya={$nt_Ya^{1/3}}
-else
nt_Ya={{7.787*$nt_Ya}+{16/116}}
-endif
-if {$nt_Za>0.008856}
nt_Za={$nt_Za^{1/3}}
-else
nt_Za={{7.787*$nt_Za}+{16/116}}
-endif
CIE_La={{116*$nt_Ya}-16}
CIE_aa={500*{$nt_Xa-$nt_Ya}}
CIE_ba={200*{$nt_Ya-$nt_Za}}
# couleur b Linear RGB
nt_Ra={$Rb/255}
nt_Ga={$Gb/255}
nt_Ba={$Bb/255}
-if {$nt_Ra>0.04045}
nt_Ra={{{$nt_Ra+0.055}/1.055}^2.4}
-else
nt_Ra={$nt_Ra/12.92}
-endif
-if {$nt_Ga>0.04045}
nt_Ga={{{$nt_Ga+0.055}/1.055}^2.4}
-else
nt_Ga={$nt_Ga/12.92}
-endif
-if {$nt_Ba>0.04045}
nt_Ba={{{$nt_Ba+0.055}/1.055}^2.4}
-else
nt_Ba={$nt_Ba/12.92}
-endif
nt_Ra={$nt_Ra*100}
nt_Ga={$nt_Ga*100}
nt_Ba={$nt_Ba*100}
#Observateur. = 2, Illuminant = D65 sRGB
Xb={$nt_Ra*0.4124564+$nt_Ga*0.3575761+$nt_Ba*0.1804375}
Yb={$nt_Ra*0.2126729+$nt_Ga*0.7151522+$nt_Ba*0.0721750}
Zb={$nt_Ra*0.0193339+$nt_Ga*0.1191920+$nt_Ba*0.9503041}
Xca=$Xb
Yca=$Yb
Zca=$Zb
ref_Xa=95.047
ref_Ya=100.000
ref_Za=108.883
nt_Xa={$Xca/$ref_Xa}
nt_Ya={$Yca/$ref_Ya}
nt_Za={$Zca/$ref_Za}
-if {$nt_Xa>0.008856}
nt_Xa={$nt_Xa^{1/3}}
-else
nt_Xa={{7.787*$nt_Xa}+{16/116}}
-endif
-if {$nt_Ya>0.008856}
nt_Ya={$nt_Ya^{1/3}}
-else
nt_Ya={{7.787*$nt_Ya}+{16/116}}
-endif
-if {$nt_Za>0.008856}
nt_Za={$nt_Za^{1/3}}
-else
nt_Za={{7.787*$nt_Za}+{16/116}}
-endif
CIE_Lb={{116*$nt_Ya}-16}
CIE_ab={500*{$nt_Xa-$nt_Ya}}
CIE_bb={200*{$nt_Ya-$nt_Za}}
######
{w},{h},1,4
-rm[-2]
Nb_Boucles=0
Decalage_L=0
Decalage_a=0
Decalage_b=0
-if {$Type_Degrade==0}
Dimensions={w}
Inc_L={{$CIE_La-$CIE_Lb}/{w}}
Inc_a={{$CIE_aa-$CIE_ab}/{w}}
Inc_b={{$CIE_ba-$CIE_bb}/{w}}
Inc_Alpha={{$Ab-$Aa}/{w}}
-elif {$Type_Degrade==1}
Dimensions={h}
Inc_L={{$CIE_La-$CIE_Lb}/{h}}
Inc_a={{$CIE_aa-$CIE_ab}/{h}}
Inc_b={{$CIE_ba-$CIE_bb}/{h}}
Inc_Alpha={{$Ab-$Aa}/{h}}
-endif
-repeat $Dimensions
Aa={$Aa+$Inc_Alpha}
-if {$Aa>255} Aa=255 -endif
-if {$Aa<0} Aa=0 -endif
CIE_Lca={$CIE_La+$Decalage_L-{$Nb_Boucles*$Inc_L}}
CIE_aca={$CIE_aa+$Decalage_a-{$Nb_Boucles*$Inc_a}}
CIE_bca={$CIE_ba+$Decalage_b-{$Nb_Boucles*$Inc_b}}
-if {$CIE_Lca>100} CIE_Lca=100 -endif
-if {$CIE_Lca<0} CIE_Lca=0 -endif
-if {$CIE_aca>127} CIE_aca=127 -endif
-if {$CIE_aca<-128} CIE_aca=-128 -endif
-if {$CIE_bca>127} CIE_bca=127 -endif
-if {$CIE_bca<-128} CIE_bca=-128 -endif
nt_Yca={{$CIE_Lca+16}/116}
nt_Xca={$CIE_aca/500+$nt_Yca}
nt_Zca={$nt_Yca-$CIE_bca/200}
-if {{$nt_Yca^3}>0.008856}
nt_Yca={$nt_Yca^3}
-else
nt_Yca={{$nt_Yca-16/116}/7.787}
-endif
-if {{$nt_Xca^3}>0.008856}
nt_Xca={$nt_Xca^3}
-else
nt_Xca={{$nt_Xca-16/116}/7.787}
-endif
-if {{$nt_Zca^3}>0.008856}
nt_Zca={$nt_Zca^3}
-else
nt_Zca={{$nt_Zca-16/116}/7.787}
-endif
ref_Xca=95.047
ref_Yca=100.000
ref_Zca=108.883
Xca={$ref_Xca*$nt_Xca}
Yca={$ref_Yca*$nt_Yca}
Zca={$ref_Zca*$nt_Zca}
vcXa=$Xca
vcYa=$Yca
vcZa=$Zca
nt_X={$vcXa/100}
nt_Y={$vcYa/100}
nt_Z={$vcZa/100}
nt_R={$nt_X*3.2404542+$nt_Y*-1.5371385+$nt_Z*-0.4985314}
nt_G={$nt_X*-0.9692660+$nt_Y*1.8760108+$nt_Z*0.0415560}
nt_B={$nt_X*0.0556434+$nt_Y*-0.2040259+$nt_Z*1.0572252}
-if {$nt_R>0.0031308}
nt_R={1.055*{$nt_R^{1/2.4}}-0.055}
-else
nt_R={12.92*$nt_R}
-endif
-if {$nt_G>0.0031308}
nt_G={1.055*{$nt_G^{1/2.4}}-0.055}
-else
nt_G={12.92*$nt_G}
-endif
-if {$nt_B>0.0031308}
nt_B={1.055*{$nt_B^{1/2.4}}-0.055}
-else
nt_B={12.92*$nt_B}
-endif
Rconv={$nt_R*255}
Gconv={$nt_G*255}
Bconv={$nt_B*255}
-if {$Rconv>255} Rconv=255 -endif
-if {$Rconv<0} Rconv=0 -endif
-if {$Gconv>255} Gconv=255 -endif
-if {$Gconv<0} Gconv=0 -endif
-if {$Bconv>255} Bconv=255 -endif
-if {$Bconv<0} Bconv=0 -endif
-if {$Type_Degrade==0}
-line[-1] $Nb_Boucles,0,$Nb_Boucles,{{h}-1},1,$Rconv,$Gconv,$Bconv,$Aa
-elif {$Type_Degrade==1}
-line[-1] 0,$Nb_Boucles,{{w}-1},$Nb_Boucles,1,$Rconv,$Gconv,$Bconv,$Aa
-endif
Nb_Boucles={$Nb_Boucles+1}
-done
#@gimp Gradient cie Lab [shape] : samj_Shape_Linear_Gradient_CIE_Lab, samj_Shape_Linear_Gradient_CIE_Lab(1)
#@gimp : Note = link("http://samjcreations.blogspot.ca","http://samjcreations.blogspot.ca")
#@gimp : Note = note("D\303\251grad\303\251 / Gradient CIE Lab")
#@gimp : Sep = separator(), note = note("<small><b><span foreground="red">Starting Point / Diameter :</span></b></small>")
#@gimp : X0 = float(10,0,100)
#@gimp : Y0 = float(10,0,100)
#@gimp : Note = note("<small><b><span foreground="blue">Ending Point / Center :</span></b></small>")
#@gimp : X1 = float(90,0,100)
#@gimp : Y1 = float(90,0,100)
#@gimp : Note = note("<small><b><span foreground="black">Parameters :</span></b></small>")
#@gimp : Shape = choice(2,"Linear H","Linear V","Square","Square Overflow","Circle X0","Circle X0+YO")
#@gimp : Swap colors = bool(0)
#@gimp : Starting color a = color(240,40,160,255)
#@gimp : Ending color b = color(240,240,40,255)
#@gimp : Background = choice(0,"Image","Transparent","Color")
#@gimp : Background color = color(0,0,0,255)
#@gimp : Examples = choice(0,"None","10 10 90 90 Linear H","10 10 90 90 Linear V","10 10 90 90 Square","10 10 90 90 Square Overflow","40 40 50 50 Circle X0","40 40 50 50 Circle X0+YO","71 71 100 100 Circle X0+YO")
#@gimp : Sep = separator(), note = note("<small>samj - Latest update : <i>2014/04/29</i>.</small>")
samj_Shape_Linear_Gradient_CIE_Lab :
Xo={round({{w}/100*$1})}
Yo={round({{h}/100*$2})}
Xf={round({{w}/100*$3})}
Yf={round({{h}/100*$4})}
Type_Degrade=$5
Swap_colors=$6
Ra=$7
Ga=$8
Ba=$9
Aa=$10
Rb=$11
Gb=$12
Bb=$13
Ab=$14
Background=$15
Rback=$16
Gback=$17
Bback=$18
Aback=$19
Examples=$20
-if {$Swap_colors==1}
Ra=$11
Ga=$12
Ba=$13
Aa=$14
Rb=$7
Gb=$8
Bb=$9
Ab=$10
-endif
-if {$Xo>$Xf}
Xo=$3
Xf=$1
-elif {$Xo==$Xf}
Xo={$Xf-1}
-endif
-if {$Yo>$Yf}
Yo=$4
Yf=$2
-elif {$Yo==$Yf}
Yo={$Yf-1}
-endif
-if {{$Type_Degrade==4}||{$Type_Degrade==5}}
Xo={round({{w}/100*$1})}
Yo={round({{h}/100*$2})}
Xf={round({{w}/100*$3})}
Yf={round({{h}/100*$4})}
-endif
-if {$Examples==1}
Xo={round({{w}*0.1})}
Yo={round({{h}*0.1})}
Xf={round({{w}*0.9})}
Yf={round({{h}*0.9})}
Type_Degrade=0
-elif {$Examples==2}
Xo={round({{w}*0.1})}
Yo={round({{h}*0.1})}
Xf={round({{w}*0.9})}
Yf={round({{h}*0.9})}
Type_Degrade=1
-elif {$Examples==3}
Xo={round({{w}*0.1})}
Yo={round({{h}*0.1})}
Xf={round({{w}*0.9})}
Yf={round({{h}*0.9})}
Type_Degrade=2
-elif {$Examples==4}
Xo={round({{w}*0.1})}
Yo={round({{h}*0.1})}
Xf={round({{w}*0.9})}
Yf={round({{h}*0.9})}
Type_Degrade=3
-elif {$Examples==5}
Xo={round({{w}*0.4})}
Yo={round({{h}*0.4})}
Xf={round({{w}*0.5})}
Yf={round({{h}*0.5})}
Type_Degrade=4
-elif {$Examples==6}
Xo={round({{w}*0.4})}
Yo={round({{h}*0.4})}
Xf={round({{w}*0.5})}
Yf={round({{h}*0.5})}
Type_Degrade=5
-elif {$Examples==7}
Xo={round({{w}*0.71})}
Yo={round({{h}*0.71})}
Xf={w}
Yf={h}
Type_Degrade=5
-endif
# Conversions RGB > XYZ   http://www.newtone.fr/formules_conversion_colorimetrie.php
# Matrices    http://www.brucelindbloom.com/index.html?Eqn_RGB_XYZ_Matrix.html
# couleur a Linear RGB
nt_Ra={$Ra/255}
nt_Ga={$Ga/255}
nt_Ba={$Ba/255}
-if {$nt_Ra>0.04045}
nt_Ra={{{$nt_Ra+0.055}/1.055}^2.4}
-else
nt_Ra={$nt_Ra/12.92}
-endif
-if {$nt_Ga>0.04045}
nt_Ga={{{$nt_Ga+0.055}/1.055}^2.4}
-else
nt_Ga={$nt_Ga/12.92}
-endif
-if {$nt_Ba>0.04045}
nt_Ba={{{$nt_Ba+0.055}/1.055}^2.4}
-else
nt_Ba={$nt_Ba/12.92}
-endif
nt_Ra={$nt_Ra*100}
nt_Ga={$nt_Ga*100}
nt_Ba={$nt_Ba*100}
#Observateur. = 2, Illuminant = D65 sRGB
Xa={$nt_Ra*0.4124564+$nt_Ga*0.3575761+$nt_Ba*0.1804375}
Ya={$nt_Ra*0.2126729+$nt_Ga*0.7151522+$nt_Ba*0.0721750}
Za={$nt_Ra*0.0193339+$nt_Ga*0.1191920+$nt_Ba*0.9503041}
Xca=$Xa
Yca=$Ya
Zca=$Za
ref_Xa=95.047
ref_Ya=100.000
ref_Za=108.883
nt_Xa={$Xca/$ref_Xa}
nt_Ya={$Yca/$ref_Ya}
nt_Za={$Zca/$ref_Za}
-if {$nt_Xa>0.008856}
nt_Xa={$nt_Xa^{1/3}}
-else
nt_Xa={{7.787*$nt_Xa}+{16/116}}
-endif
-if {$nt_Ya>0.008856}
nt_Ya={$nt_Ya^{1/3}}
-else
nt_Ya={{7.787*$nt_Ya}+{16/116}}
-endif
-if {$nt_Za>0.008856}
nt_Za={$nt_Za^{1/3}}
-else
nt_Za={{7.787*$nt_Za}+{16/116}}
-endif
CIE_La={{116*$nt_Ya}-16}
CIE_aa={500*{$nt_Xa-$nt_Ya}}
CIE_ba={200*{$nt_Ya-$nt_Za}}
# couleur b Linear RGB
nt_Ra={$Rb/255}
nt_Ga={$Gb/255}
nt_Ba={$Bb/255}
-if {$nt_Ra>0.04045}
nt_Ra={{{$nt_Ra+0.055}/1.055}^2.4}
-else
nt_Ra={$nt_Ra/12.92}
-endif
-if {$nt_Ga>0.04045}
nt_Ga={{{$nt_Ga+0.055}/1.055}^2.4}
-else
nt_Ga={$nt_Ga/12.92}
-endif
-if {$nt_Ba>0.04045}
nt_Ba={{{$nt_Ba+0.055}/1.055}^2.4}
-else
nt_Ba={$nt_Ba/12.92}
-endif
nt_Ra={$nt_Ra*100}
nt_Ga={$nt_Ga*100}
nt_Ba={$nt_Ba*100}
#Observateur. = 2, Illuminant = D65 sRGB
Xb={$nt_Ra*0.4124564+$nt_Ga*0.3575761+$nt_Ba*0.1804375}
Yb={$nt_Ra*0.2126729+$nt_Ga*0.7151522+$nt_Ba*0.0721750}
Zb={$nt_Ra*0.0193339+$nt_Ga*0.1191920+$nt_Ba*0.9503041}
Xca=$Xb
Yca=$Yb
Zca=$Zb
ref_Xa=95.047
ref_Ya=100.000
ref_Za=108.883
nt_Xa={$Xca/$ref_Xa}
nt_Ya={$Yca/$ref_Ya}
nt_Za={$Zca/$ref_Za}
-if {$nt_Xa>0.008856}
nt_Xa={$nt_Xa^{1/3}}
-else
nt_Xa={{7.787*$nt_Xa}+{16/116}}
-endif
-if {$nt_Ya>0.008856}
nt_Ya={$nt_Ya^{1/3}}
-else
nt_Ya={{7.787*$nt_Ya}+{16/116}}
-endif
-if {$nt_Za>0.008856}
nt_Za={$nt_Za^{1/3}}
-else
nt_Za={{7.787*$nt_Za}+{16/116}}
-endif
CIE_Lb={{116*$nt_Ya}-16}
CIE_ab={500*{$nt_Xa-$nt_Ya}}
CIE_bb={200*{$nt_Ya-$nt_Za}}
######
-if {$Background==1}
{w},{h},1,4
-rm[-2]
-elif {$Background==2}
{w},{h},1,4
-fill_color[-1] $Rback,$Gback,$Bback,$Aback
-rm[-2]
-endif
Nb_Boucles=0
-if {$Type_Degrade==0}
Dimensions={$Xf-$Xo}
-elif {$Type_Degrade==1}
Dimensions={$Yf-$Yo}
-elif {$Type_Degrade==2}
-if {{$Xf-$Xo}>{$Yf-$Yo}}
Dimensions={round({{$Yf-$Yo+1}/2})}
-else
Dimensions={round({{$Xf-$Xo+1}/2})}
-endif
-elif {$Type_Degrade==3}
-if {{$Xf-$Xo}>{$Yf-$Yo}}
Dimensions={round({{$Xf-$Xo+1}/2})}
-else
Dimensions={round({{$Yf-$Yo+1}/2})}
-endif
-elif {$Type_Degrade==4}
Dimensions=$Xo
-elif {$Type_Degrade==5}
Dimensions={$Xo+$Yo}
-endif
Inc_L={{$CIE_La-$CIE_Lb}/$Dimensions}
Inc_a={{$CIE_aa-$CIE_ab}/$Dimensions}
Inc_b={{$CIE_ba-$CIE_bb}/$Dimensions}
Inc_Alpha={{$Ab-$Aa}/$Dimensions}
Decalage_L=0
Decalage_a=0
Decalage_b=0
-repeat $Dimensions
Aa={$Aa+$Inc_Alpha}
-if {$Aa>255} Aa=255 -endif
-if {$Aa<0} Aa=0 -endif
CIE_Lca={$CIE_La+$Decalage_L-{$Nb_Boucles*$Inc_L}}
CIE_aca={$CIE_aa+$Decalage_a-{$Nb_Boucles*$Inc_a}}
CIE_bca={$CIE_ba+$Decalage_b-{$Nb_Boucles*$Inc_b}}
-if {$CIE_Lca>100} CIE_Lca=100 -endif
-if {$CIE_Lca<0} CIE_Lca=0 -endif
-if {$CIE_aca>127} CIE_aca=127 -endif
-if {$CIE_aca<-128} CIE_aca=-128 -endif
-if {$CIE_bca>127} CIE_bca=127 -endif
-if {$CIE_bca<-128} CIE_bca=-128 -endif
nt_Yca={{$CIE_Lca+16}/116}
nt_Xca={$CIE_aca/500+$nt_Yca}
nt_Zca={$nt_Yca-$CIE_bca/200}
-if {{$nt_Yca^3}>0.008856}
nt_Yca={$nt_Yca^3}
-else
nt_Yca={{$nt_Yca-16/116}/7.787}
-endif
-if {{$nt_Xca^3}>0.008856}
nt_Xca={$nt_Xca^3}
-else
nt_Xca={{$nt_Xca-16/116}/7.787}
-endif
-if {{$nt_Zca^3}>0.008856}
nt_Zca={$nt_Zca^3}
-else
nt_Zca={{$nt_Zca-16/116}/7.787}
-endif
ref_Xca=95.047
ref_Yca=100.000
ref_Zca=108.883
Xca={$ref_Xca*$nt_Xca}
Yca={$ref_Yca*$nt_Yca}
Zca={$ref_Zca*$nt_Zca}
vcXa=$Xca
vcYa=$Yca
vcZa=$Zca
nt_X={$vcXa/100}
nt_Y={$vcYa/100}
nt_Z={$vcZa/100}
nt_R={$nt_X*3.2404542+$nt_Y*-1.5371385+$nt_Z*-0.4985314}
nt_G={$nt_X*-0.9692660+$nt_Y*1.8760108+$nt_Z*0.0415560}
nt_B={$nt_X*0.0556434+$nt_Y*-0.2040259+$nt_Z*1.0572252}
-if {$nt_R>0.0031308}
nt_R={1.055*{$nt_R^{1/2.4}}-0.055}
-else
nt_R={12.92*$nt_R}
-endif
-if {$nt_G>0.0031308}
nt_G={1.055*{$nt_G^{1/2.4}}-0.055}
-else
nt_G={12.92*$nt_G}
-endif
-if {$nt_B>0.0031308}
nt_B={1.055*{$nt_B^{1/2.4}}-0.055}
-else
nt_B={12.92*$nt_B}
-endif
Rconv={$nt_R*255}
Gconv={$nt_G*255}
Bconv={$nt_B*255}
-if {$Rconv>255} Rconv=255 -endif
-if {$Rconv<0} Rconv=0 -endif
-if {$Gconv>255} Gconv=255 -endif
-if {$Gconv<0} Gconv=0 -endif
-if {$Bconv>255} Bconv=255 -endif
-if {$Bconv<0} Bconv=0 -endif
-if {$Type_Degrade==0}
-line[-1] {$Xo+$Nb_Boucles},$Yo,{$Xo+$Nb_Boucles},$Yf,1,$Rconv,$Gconv,$Bconv,$Aa
-elif {$Type_Degrade==1}
-line[-1] $Xo,{$Yo+$Nb_Boucles},$Xf,{$Yo+$Nb_Boucles},1,$Rconv,$Gconv,$Bconv,$Aa
-elif {$Type_Degrade==2}
-polygon[-1] 4,{$Xo+$Nb_Boucles},{$Yo+$Nb_Boucles},{$Xf-$Nb_Boucles},{$Yo+$Nb_Boucles},{$Xf-$Nb_Boucles},{$Yf-$Nb_Boucles},{$Xo+$Nb_Boucles},{$Yf-$Nb_Boucles},1,0xFFFFFFFF,$Rconv,$Gconv,$Bconv,$Aa
-elif {$Type_Degrade==3}
-polygon[-1] 4,{$Xo+$Nb_Boucles},{$Yo+$Nb_Boucles},{$Xf-$Nb_Boucles},{$Yo+$Nb_Boucles},{$Xf-$Nb_Boucles},{$Yf-$Nb_Boucles},{$Xo+$Nb_Boucles},{$Yf-$Nb_Boucles},1,0xFFFFFFFF,$Rconv,$Gconv,$Bconv,$Aa
-elif {$Type_Degrade==4}
-ellipse[-1] $Xf,$Yf,{$Dimensions-$Nb_Boucles},{$Dimensions-$Nb_Boucles},0,1,$Rconv,$Gconv,$Bconv,$Aa
-elif {$Type_Degrade==5}
-ellipse[-1] $Xf,$Yf,{$Dimensions-$Nb_Boucles},{$Dimensions-$Nb_Boucles},0,1,$Rconv,$Gconv,$Bconv,$Aa
-endif
Nb_Boucles={$Nb_Boucles+1}
-done
#@gimp Harmonograph : Harmonograph_samj, Harmonograph_samj(1)
#@gimp : Note = link("http://en.wikipedia.org/wiki/Harmonograph")
#@gimp : Sep = separator(), note = note("<small>Centre / Center</small>")
#@gimp : Centre / center x (%) = float(50,0,100)
#@gimp : Centre / center y (%) = float(50,0,100)
#@gimp : Sep = separator(), note = note("<small>Harmonograph</small>")
#@gimp : Stylo / pen (couleur/color) = color(192,128,64,255)
#@gimp : Stylo / pen (variation de couleur/color variation) = choice("Pas de variation / No change","Couleurs aleatoires / Random colors","Faiblement nuancee / Poorly nuanced","Moyennement nuancee / Moderately nuanced","Fortement nuancee / Highly nuanced")
#@gimp : Stylo / pen (dilate pixels) = int(0,0,32)
#@gimp : It\303\251rations = int(1000,2,30000)
#@gimp : Multiplier = choice(0,"Iterations * 1","Iterations * 5 LENT / SLOW","Iterations * 10 TRES LENT / VERY SLOW")
#@gimp : Increment temps / time increment [*10000] = float(400,10,500)
#@gimp : Sep = separator(), note = note("<small>Amplitude</small>")
#@gimp : Amplitude 1 (>0 w) (<0 h) = float(150,-1000,1000)
#@gimp : Amplitude 2 (>0 w) (<0 h) = float(200,-1000,1000)
#@gimp : Amplitude 3 (>0 w) (<0 h) = float(200,-1000,1000)
#@gimp : Amplitude 4 (>0 w) (<0 h) = float(100,-1000,1000)
#@gimp : Sep = separator(), note = note("<small>Fr\303\251quence / Frequency</small>")
#@gimp : Fr\303\251quence 1 = float(4,0,16)
#@gimp : Fr\303\251quence 2 = float(6,0,16)
#@gimp : Fr\303\251quence 3 = float(2,0,16)
#@gimp : Fr\303\251quence 4 = float(2,0,16)
#@gimp : Sep = separator(), note = note("<small>Phase</small>")
#@gimp : Phase 1 = float(15,0,360)
#@gimp : Phase 2 = float(270,0,360)
#@gimp : Phase 3 = float(75,0,360)
#@gimp : Phase 4 = float(60,0,360)
#@gimp : Sep = separator(), note = note("<small>Amortissement / Damping</small>")
#@gimp : Amortissement 1 = float(0.04,0,1)
#@gimp : Amortissement 2 = float(0.04,0,1)
#@gimp : Amortissement 3 = float(0.05,0,1)
#@gimp : Amortissement 4 = float(0.06,0,1)
#@gimp : Sep = separator(), note = note("<small>Divers / Foo</small>")
#@gimp : Flou / blur = float(0,0,10)
#@gimp : Spread = float(0,0,10)
#@gimp : D\303\251formation = float(0,0,25)
#@gimp : Sep = separator(), note = note("<small>M\303\251lange / Blend</small>")
#@gimp : Mode = choice{1,"Add","Alpha","And","Average","Blue","Burn","Darken","Difference",
#@gimp : "Divide","Dodge","Edges","Exclusion","Freeze","Grain extract","Grain merge","Green","Hard light",
#@gimp : "Hard mix","Hue","Interpolation","Lighten","Lightness","Linear burn","Linear light","Luminance",
#@gimp : "Multiply","Negation","Or","Overlay","Pin light","Red","Reflect","Saturation",
#@gimp : "Shape Average","Shape Average0","Soft burn","Soft dodge","Soft light","Screen","Stamp","Subtract","Value",
#@gimp : "Vivid light","Xor"}
#@gimp : Opacit\303\251 / opacity = float(1,0,1)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/15</i>.</small>")
Harmonograph_samj :
centre_origine_X={$1/100*w}
centre_origine_Y={$2/100*h}
R_Couleur_Stylo=$3
V_Couleur_Stylo=$4
B_Couleur_Stylo=$5
A_Couleur_Stylo=$6
Variation_de_couleur=$7
Dilate_Stylo=$8
Iterations=$9
Multiplier_Iterations=$10
Increment_temps=$11
-if {$12>0}
Amplitude1={{w}*$12/{1000}}
-else
Amplitude1={-{h}*$12/{1000}}
-endif
-if {$13>0}
Amplitude2={{w}*$13/{1000}}
-else
Amplitude2={-{h}*$13/{1000}}
-endif
-if {$14>0}
Amplitude3={{w}*$14/{1000}}
-else
Amplitude3={-{h}*$14/{1000}}
-endif
-if {$15>0}
Amplitude4={{w}*$15/{1000}}
-else
Amplitude4={-{h}*$15/{1000}}
-endif
Frequence1=$16
Frequence2=$17
Frequence3=$18
Frequence4=$19
Phase1=$20
Phase2=$21
Phase3=$22
Phase4=$23
Amort1=$24
Amort2=$25
Amort3=$26
Amort4=$27
Flou_Harmonograph=$28
Spread_Harmonograph=$29
Deform_Harmonograph=$30
blend=$31
opacite=$32
Revert_layers=0
-to_rgba
{w},{h},1,4
Nb_Boucle=1
temps=0
Ancien_point_X=0
Nouveau_point_X=0
Ancien_point_Y=0
Nouveau_point_Y=0
R_Couleur_origine=$R_Couleur_Stylo
V_Couleur_origine=$V_Couleur_Stylo
B_Couleur_origine=$B_Couleur_Stylo
A_Couleur_origine=$A_Couleur_Stylo
Increment_temps={$Increment_temps/10000}
Phase1={$Phase1/180*{pi}}
Phase2={$Phase2/180*{pi}}
Phase3={$Phase3/180*{pi}}
Phase4={$Phase4/180*{pi}}
-if {$Multiplier_Iterations>0}
Iterations={$Iterations*$Multiplier_Iterations*5}
-endif
-repeat $Iterations
-if {$Variation_de_couleur==1}
R_Couleur_Stylo={round({(?(255))})}
V_Couleur_Stylo={round({(?(255))})}
B_Couleur_Stylo={round({(?(255))})}
-endif
-if {$Variation_de_couleur>1}
Valeur_variation_couleur=16
-if {$Variation_de_couleur==3}
Valeur_variation_couleur=32
-endif
-if {$Variation_de_couleur==4}
Valeur_variation_couleur=64
-endif
R_Couleur_Stylo={round({$R_Couleur_origine+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$R_Couleur_Stylo>255}
R_Couleur_Stylo=$R_Couleur_origine
-endif
-if {$R_Couleur_Stylo<0}
R_Couleur_Stylo=$R_Couleur_origine
-endif
V_Couleur_Stylo={round({$V_Couleur_origine+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$V_Couleur_Stylo>255}
V_Couleur_Stylo=$V_Couleur_origine
-endif
-if {$V_Couleur_Stylo<0}
V_Couleur_Stylo=$V_Couleur_origine
-endif
B_Couleur_Stylo={round({$B_Couleur_origine+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$B_Couleur_Stylo>255}
B_Couleur_Stylo=$B_Couleur_origine
-endif
-if {$B_Couleur_Stylo<0}
B_Couleur_Stylo=$B_Couleur_origine
-endif
-endif
Nouveau_point_X={$centre_origine_X+{{$Amplitude1*{sin({{$Frequence1*$temps}+$Phase1})}*{exp({-$Amort1*$temps})}}+{$Amplitude2*{sin({{$Frequence2*$temps}+$Phase2})}*{exp({-$Amort2*$temps})}}}}
Nouveau_point_Y={$centre_origine_Y+{{$Amplitude3*{sin({{$Frequence3*$temps}+$Phase3})}*{exp({-$Amort3*$temps})}}+{$Amplitude4*{sin({{$Frequence4*$temps}+$Phase4})}*{exp({-$Amort4*$temps})}}}}
-if {$Nb_Boucle>1}
-line[-1] $Ancien_point_X,$Ancien_point_Y,$Nouveau_point_X,$Nouveau_point_Y,1,$R_Couleur_Stylo,$V_Couleur_Stylo,$B_Couleur_Stylo,$A_Couleur_Stylo
-endif
Ancien_point_X=$Nouveau_point_X
Ancien_point_Y=$Nouveau_point_Y
temps={$temps+$Increment_temps}
Nb_Boucle={$Nb_Boucle+1}
-done
-if {$Dilate_Stylo>0} -dilate_circ[-1] $Dilate_Stylo -endif
-if {$Flou_Harmonograph>0} -blur[-1] $Flou_Harmonograph,0 -endif
-if {$Spread_Harmonograph>1} -spread[-1] $Spread_Harmonograph -endif
-if {$Deform_Harmonograph>0} -deform[-1] $Deform_Harmonograph -endif
-gimp_blend[-1,-2] $blend,1,$opacite,$Revert_layers,1
#
#-text_outline[0] $Amplitude1,10,10,64,1,1,255,255,255
#@gimp Hawaiian earring : samj_Hawaiian_Earring, samj_Hawaiian_Earring(1)
#@gimp : Note = link("http://en.wikipedia.org/wiki/Hawaiian_earring","http://en.wikipedia.org/wiki/Hawaiian_earring")
#@gimp : Sep = separator(), note = note("<small>Rendu - Rendering</small>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Rayon cercle a / circle a radius (%) = float(40,1,200)
#@gimp : Nb cercles / circles = int(6,2,25)
#@gimp : Type n = choice(0,"Inc 1","Lin 0.1","Lin 0.2","Lin 0.3","Rand")
#@gimp : Angle inclinaison / tilt = float(0,0,360)
#@gimp : Contours = color(0,0,0,255)
#@gimp : Affichage / display contours = bool(1)
#@gimp : Cercle a / circle a = color(255,255,0,127)
#@gimp : Cercles b / circles b = color(0,0,255,127)
#@gimp : Couleurs al\303\251atoires / random colors = bool(0)
#@gimp : Miroir /  mirror = choice(0,"Sans - Wihout"," X "," Y "," X Y ")
#@gimp : Flou / blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,100)
#@gimp : Ombre / shadow = bool(0)
#@gimp : X-ombre x-shadow = float(0.5,-5,5)
#@gimp : Y-ombre y-shadow = float(0.5,-5,5)
#@gimp : Douceur ombre / smoothness shadow = float(1.8,0,5)
#@gimp : Courbure ombre / curvature shadow = float(0,0,1)
#@gimp : D\303\251calage ombre x / shadow offset x = float(0,-20,20)
#@gimp : D\303\251calage ombre y / shadow offset y = float(0,-20,20)
#@gimp : Canal alpha = bool(0)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/06</i>.</small>")
samj_Hawaiian_Earring :
X={round({{w}*{$1/100}})}
Y={round({{h}*{$2/100}})}
Rayon_Cercle_Exterieur={round({{{w}+{h}}*$3/200})}
Nb_Circles=$4
Type_n=$5
Angle_inclinaison=$6
R_Contours=$7
V_Contours=$8
B_Contours=$9
A_Contours=$10
Affichage_Contours=$11
R_a=$12
V_a=$13
B_a=$14
A_a=$15
R_b=$16
V_b=$17
B_b=$18
A_b=$19
Couleurs_aleatoires=$20
Inversions=$21
Flou=$22
Dilatation=$23
Deformation=$24
Bruit=$25
Ombre=$26
X_Ombre=$27
Y_Ombre=$28
Smoothness_Ombre=$29
Curvature_Ombre=$30
Compensation_Decalage_Ombre_X=$31
Compensation_Decalage_Ombre_Y=$32
Canal_Alpha=$33
Largeur_Origine={w}
Hauteur_Origine={h}
Nb_boucles=0
X_Cercle_A_Imprimer=$X
Y_Cercle_A_Imprimer=$Y
Rayon_Centre_Cercle_A_Imprimer=0
Rayon_Cercle_A_Imprimer=$Rayon_Cercle_Exterieur
-if {$Canal_Alpha==0}
-to_rgb[-1]
-else
-to_rgba[-1]
-endif
-if {$Affichage_Contours==1}
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-endif
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-repeat $Nb_Circles
Nb_boucles={$Nb_boucles+1}
-if {$Couleurs_aleatoires==1}
R_a={round(?(0,255))}
V_a={round(?(0,255))}
B_a={round(?(0,255))}
R_b={round(?(0,255))}
V_b={round(?(0,255))}
B_b={round(?(0,255))}
-endif
-if {{($Nb_boucles%2)}==0}
-ellipse[-1] $X_Cercle_A_Imprimer,$Y_Cercle_A_Imprimer,$Rayon_Cercle_A_Imprimer,$Rayon_Cercle_A_Imprimer,0,1,$R_a,$V_a,$B_a,$A_a
-else
-ellipse[-1] $X_Cercle_A_Imprimer,$Y_Cercle_A_Imprimer,$Rayon_Cercle_A_Imprimer,$Rayon_Cercle_A_Imprimer,0,1,$R_b,$V_b,$B_b,$A_b
-endif
-if {$Affichage_Contours==1}
-ellipse[-2] $X_Cercle_A_Imprimer,$Y_Cercle_A_Imprimer,$Rayon_Cercle_A_Imprimer,$Rayon_Cercle_A_Imprimer,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-if {$Type_n==0}
Rayon_Cercle_A_Imprimer={$Rayon_Cercle_Exterieur/{$Nb_boucles+1}}
-elif {$Type_n==1}
Rayon_Cercle_A_Imprimer={$Rayon_Cercle_A_Imprimer-{$Rayon_Cercle_A_Imprimer*0.1}}
-elif {$Type_n==2}
Rayon_Cercle_A_Imprimer={$Rayon_Cercle_A_Imprimer-{$Rayon_Cercle_A_Imprimer*0.2}}
-elif {$Type_n==3}
Rayon_Cercle_A_Imprimer={$Rayon_Cercle_A_Imprimer-{$Rayon_Cercle_A_Imprimer*0.3}}
-elif {$Type_n==4}
Rayon_Cercle_A_Imprimer={$Rayon_Cercle_A_Imprimer-{$Rayon_Cercle_A_Imprimer*{?(0.1,0.3)}}}
-endif
Rayon_Centre_Cercle_A_Imprimer={$Rayon_Cercle_Exterieur-$Rayon_Cercle_A_Imprimer}
X_Cercle_A_Imprimer={$X-{$Rayon_Centre_Cercle_A_Imprimer*{cos(pi/180*$Angle_inclinaison)}}}
Y_Cercle_A_Imprimer={$Y-{$Rayon_Centre_Cercle_A_Imprimer*{sin(pi/180*$Angle_inclinaison)}}}
-done
-if {$Affichage_Contours==1}
-if {$Dilatation>1} -dilate_circ[-2] $Dilatation -endif
-if {$Flou>0} -blur[-1,-2] $Flou,0 -endif
-if {$Deformation>0} -deform[-1,-2] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-2] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-2] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-blend[-2,-1] alpha,1,1
-else
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-1] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-1] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-endif
-if {$Inversions==1}
-mirror[-1] x
-elif {$Inversions==2}
-mirror[-1] y
-elif {$Inversions==3}
-mirror[-1] x
-mirror[-1] y
-endif
-blend[-1,-2] alpha,1,0
#@gimp Lines of varying thickness : samj_Lignes_Epaisseur_Variable, samj_Lignes_Epaisseur_Variable(1)
#@gimp : Note = note("Lignes \303\211paisseur Variable / Lines Of Varying Thickness")
#@gimp : Sep = separator(), note = note("<small>Rendu - Rendering</small>")
#@gimp : Orientation lignes / lines = choice(0,"Vertical lines","Horizontal lines")
#@gimp : R\303\251solution largeur / width = int(32,16,64)
#@gimp : \303\211paisseur ligne / line thickness = int(3,1,7)
#@gimp : Fond / background = color(0,0,0,255)
#@gimp : Ligne / line = color(255,255,255,255)
#@gimp : Inverser fond-ligne / invert background-line = bool(0)
#@gimp : Couleurs al\303\251atoires / random colors = bool(0)
#@gimp : Resize = choice(1,"Non / No","Dim. Origines")
#@gimp : Flou / blur = int(0,0,200)
#@gimp : Deblur = int(0,0,48)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation / deform = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,100)
#@gimp : Ombre / shadow = bool(0)
#@gimp : X-ombre x-shadow = float(0.5,-5,5)
#@gimp : Y-ombre y-shadow = float(0.5,-5,5)
#@gimp : Douceur ombre / smoothness shadow = float(1.8,0,5)
#@gimp : Courbure ombre / curvature shadow = float(0,0,1)
#@gimp : Canal alpha = bool(0)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/05</i>.</small>")
samj_Lignes_Epaisseur_Variable :
Motif_Sprite=$1
Resolution_Largeur=$2
Trait_Largeur=$3
R_fond=$4
V_fond=$5
B_fond=$6
A_fond=$7
R_a=$8
V_a=$9
B_a=$10
A_a=$11
Inverser_Fond_Trait=$12
Couleurs_aleatoires=$13
Resize_Image=$14
Antialiasing=$15
R_Deblur=$16
Dilatation=$17
Deformation=$18
Bruit=$19
Ombre=$20
X_Ombre=$21
Y_Ombre=$22
Smoothness_Ombre=$23
Curvature_Ombre=$24
Canal_Alpha=$25
Largeur_Origine={w}
Hauteur_Origine={h}
Nb_boucles=0
Nb_boucles_motif=0
Origine_Trait=0
-if {$Inverser_Fond_Trait==0}
R_F=$R_fond
V_F=$V_fond
B_F=$B_fond
A_F=$A_fond
R_M=$R_a
V_M=$V_a
B_M=$B_a
A_M=$A_a
-else
R_F=$R_a
V_F=$V_a
B_F=$B_a
A_F=$A_a
R_M=$R_fond
V_M=$V_fond
B_M=$B_fond
A_M=$A_fond
-endif
Largeur_Sprite={{7*2}+{7*$Trait_Largeur}}
Hauteur_Sprite=$Largeur_Sprite
-if {$Canal_Alpha==0}
-to_rgb[-1]
-else
-to_rgba[-1]
-endif
-resize[-1] $Resolution_Largeur,{round({$Hauteur_Origine/$Largeur_Origine*$Resolution_Largeur})}
-repeat 7
Nb_boucles={$Nb_boucles+1}
-if {$Nb_boucles==1}
-if {$Couleurs_aleatoires==1}
R_F={round(?(0,255))}
V_F={round(?(0,255))}
B_F={round(?(0,255))}
-endif
$Largeur_Sprite,$Hauteur_Sprite,1,4
-fill_color[-1] $R_F,$V_F,$B_F,$A_F
-endif
-if {$Couleurs_aleatoires==1}
R_F={round(?(0,255))}
V_F={round(?(0,255))}
B_F={round(?(0,255))}
R_M={round(?(0,255))}
V_M={round(?(0,255))}
B_M={round(?(0,255))}
-endif
$Largeur_Sprite,$Hauteur_Sprite,1,4
-fill_color[-1] $R_F,$V_F,$B_F,$A_F
Nb_boucles_motif=0
-if {{$Motif_Sprite==0}||{$Motif_Sprite==1}}
Origine_Trait={round({{$Largeur_Sprite-{$Trait_Largeur*$Nb_boucles}}/2})}
-repeat {$Trait_Largeur*$Nb_boucles}
-line[-1] {$Origine_Trait+$Nb_boucles_motif},0,{$Origine_Trait+$Nb_boucles_motif},{$Hauteur_Sprite-1},1,$R_M,$V_M,$B_M,$A_M
Nb_boucles_motif={$Nb_boucles_motif+1}
-done
-endif
-done
-if {$Motif_Sprite==1}
-rotate[-1,-2,-3,-4,-5,-6,-7,-8] 90,0,0
-endif
-map_sprites[-1,-2,-3,-4,-5,-6,-7,-8,-9] 8,0
-if {$Resize_Image==1}
-resize[-1] $Largeur_Origine,$Hauteur_Origine
-endif
-if {$Antialiasing>0} -apply_channels_old[-1] "-smooth "$Antialiasing",0.7,0.3,0.6,5,5,0",1 -endif
-if {$R_Deblur>0} -apply_channels_old[-1] "-deblur "$R_Deblur",10,20,0.1,1",1 -endif
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-1] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-endif
#@gimp Pappus chain : samj_Cercles_Tangents_Dans_Cercle, samj_Cercles_Tangents_Dans_Cercle(1)
#@gimp : Note = link("http://en.wikipedia.org/wiki/Pappus_chain","http://en.wikipedia.org/wiki/Pappus_chain")
#@gimp : Note = link("http://en.wikipedia.org/wiki/Steiner_chain","http://en.wikipedia.org/wiki/Steiner_chain")
#@gimp : Sep = separator(), note = note("<small>Rendu - Rendering</small>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Rayon cercle ext\303\251rieur / radius outer circle a (>0 w%) (<0 h%) = float(50,-400,400)
#@gimp : Rayon premier cercle b = float(40,0,99)
#@gimp : Angle inclinaison / tilt = float(0,0,360)
#@gimp : Contours = color(0,0,0,255)
#@gimp : Affichage / display contours = bool(1)
#@gimp : Cercle ext\303\251rieur / outer circle a = color(127,127,127,127)
#@gimp : Premier cercle / first circle b = color(255,0,0,127)
#@gimp : Cercle / circle c = color(0,255,0,127)
#@gimp : Cercle / circle d = color(0,0,255,127)
#@gimp : Cercle / circle e = color(255,0,255,127)
#@gimp : Cercle / circle f = color(255,255,0,127)
#@gimp : Cercle / circle g = color(0,255,255,127)
#@gimp : Cercle / circle h = color(192,128,64,127)
#@gimp : Cercle / circle i = color(64,192,128,127)
#@gimp : Cercle / circle j = color(128,64,192,127)
#@gimp : Cercle / circle k = color(192,64,128,127)
#@gimp : Couleurs al\303\251atoires / random colors = bool(0)
#@gimp : Inversions = int(0,0,3)
#@gimp : Flou / blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,100)
#@gimp : Ombre / shadow = bool(0)
#@gimp : X-ombre x-shadow = float(0.5,-5,5)
#@gimp : Y-ombre y-shadow = float(0.5,-5,5)
#@gimp : Douceur ombre / smoothness shadow = float(1.8,0,5)
#@gimp : Courbure ombre / curvature shadow = float(0,0,1)
#@gimp : D\303\251calage ombre x / shadow offset x = float(0,-20,20)
#@gimp : D\303\251calage ombre y / shadow offset y = float(0,-20,20)
#@gimp : Canal alpha = bool(0))
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/08</i>.</small>")
samj_Cercles_Tangents_Dans_Cercle :
X={round({{w}*{$1/100}})}
Y={round({{h}*{$2/100}})}
-if {$3>0}
Rayon_Cercle_Exterieur={round({{w}*$3/{100}})}
-else
Rayon_Cercle_Exterieur={round({-{h}*$3/{100}})}
-endif
Rayon_Premier_Cercle={round({$Rayon_Cercle_Exterieur*$4/100})}
Angle_inclinaison=$5
R_Contours=$6
V_Contours=$7
B_Contours=$8
A_Contours=$9
Affichage_Contours=$10
R_CE=$11
V_CE=$12
B_CE=$13
A_CE=$14
R_PC=$15
V_PC=$16
B_PC=$17
A_PC=$18
R_c=$19
V_c=$20
B_c=$21
A_c=$22
R_d=$23
V_d=$24
B_d=$25
A_d=$26
R_e=$27
V_e=$28
B_e=$29
A_e=$30
R_f=$31
V_f=$32
B_f=$33
A_f=$34
R_g=$35
V_g=$36
B_g=$37
A_g=$38
R_h=$39
V_h=$40
B_h=$41
A_h=$42
R_i=$43
V_i=$44
B_i=$45
A_i=$46
R_j=$47
V_j=$48
B_j=$49
A_j=$50
R_k=$51
V_k=$52
B_k=$53
A_k=$54
Couleurs_aleatoires=$55
Inversions=$56
Flou=$57
Dilatation=$58
Deformation=$59
Bruit=$60
Ombre=$61
X_Ombre=$62
Y_Ombre=$63
Smoothness_Ombre=$64
Curvature_Ombre=$65
Compensation_Decalage_Ombre_X=$66
Compensation_Decalage_Ombre_Y=$67
Canal_Alpha=$68
Largeur_Origine={w}
Hauteur_Origine={h}
X_Cb={{$Rayon_Cercle_Exterieur-$Rayon_Premier_Cercle}*{cos({pi/180*$Angle_inclinaison})}}
Y_Cb={{$Rayon_Cercle_Exterieur-$Rayon_Premier_Cercle}*{sin({pi/180*$Angle_inclinaison})}}
X_Cc={$Rayon_Premier_Cercle*{cos({pi/180*{$Angle_inclinaison+180}})}}
Y_Cc={$Rayon_Premier_Cercle*{sin({pi/180*{$Angle_inclinaison+180}})}}
R_Cc={$Rayon_Cercle_Exterieur-$Rayon_Premier_Cercle}
#####
# Rayon Cercle rang 1 Pappus
R_Pappus={$R_Cc/$Rayon_Cercle_Exterieur}
n_Pappus=1
b_Pappus={$R_Cc}
a_Pappus={$Rayon_Premier_Cercle}
R_Cercle_d={{$a_Pappus*$b_Pappus*{$a_Pappus+$b_Pappus}}/{{$n_Pappus*$a_Pappus*$a_Pappus}+{$b_Pappus*{$a_Pappus+$b_Pappus}}}}
Va={$R_Cc+$R_Cercle_d}
Vb={$Rayon_Premier_Cercle+$R_Cercle_d}
# Centres des 2 Cercles rang 1 Pappus , adaptation des codes http://paulbourke.net/geometry/circlesphere/
# d_x and d_y are the vertical and horizontal distances between the circle centers. dx  dy
d_x={$X_Cb-$X_Cc}
d_y={$Y_Cb-$Y_Cc}
# Determine the straight-line distance between the centers. d
d_between_centers={{{$d_y*$d_y}+{$d_x*$d_x}}^0.5}
# Determine the distance from point 0 to point 2. a
d_p0_p2={{{$Va*$Va}-{$Vb*$Vb}+{$d_between_centers*$d_between_centers}}/{2*$d_between_centers}}
# Determine the coordinates of point 2. x2 y2
c_x2={$X_Cc+{$d_x*$d_p0_p2/$d_between_centers}}
c_y2={$Y_Cc+{$d_y*$d_p0_p2/$d_between_centers}}
# Determine the distance from point 2 to either of the intersection points. h
d_h={{{$Va*$Va}-{$d_p0_p2*$d_p0_p2}}^0.5}
# Now determine the offsets of the intersection points from point 2. rx  ry
o_rx={-$d_y*$d_h/$d_between_centers}
o_ry={$d_x*$d_h/$d_between_centers}
# Determine the absolute intersection points.
X_Cercle_da={$c_x2+$o_rx}
Y_Cercle_da={$c_y2+$o_ry}
X_Cercle_db={$c_x2-$o_rx}
Y_Cercle_db={$c_y2-$o_ry}
#####
# Rayon Cercle rang 4 Pappus
R_Pappus={$R_Cc/$Rayon_Cercle_Exterieur}
n_Pappus=4
b_Pappus={$R_Cc}
a_Pappus={$Rayon_Premier_Cercle}
R_Cercle_e={{$a_Pappus*$b_Pappus*{$a_Pappus+$b_Pappus}}/{{$n_Pappus*$a_Pappus*$a_Pappus}+{$b_Pappus*{$a_Pappus+$b_Pappus}}}}
Vb={$R_Cc+$R_Cercle_e}
Va={$R_Cercle_d+$R_Cercle_e}
# Centres des 2 Cercles rang 4 Pappus , adaptation des codes http://paulbourke.net/geometry/circlesphere/
# d_x and d_y are the vertical and horizontal distances between the circle centers. dx  dy
d_x={$X_Cc-$X_Cercle_da}
d_y={$Y_Cc-$Y_Cercle_da}
# Determine the straight-line distance between the centers. d
d_between_centers={{{$d_y*$d_y}+{$d_x*$d_x}}^0.5}
# Determine the distance from point 0 to point 2. a
d_p0_p2={{{$Va*$Va}-{$Vb*$Vb}+{$d_between_centers*$d_between_centers}}/{2*$d_between_centers}}
# Determine the coordinates of point 2. x2 y2
c_x2={$X_Cercle_da+{$d_x*$d_p0_p2/$d_between_centers}}
c_y2={$Y_Cercle_da+{$d_y*$d_p0_p2/$d_between_centers}}
# Determine the distance from point 2 to either of the intersection points. h
d_h={{{$Va*$Va}-{$d_p0_p2*$d_p0_p2}}^0.5}
# Now determine the offsets of the intersection points from point 2. rx  ry
o_rx={-$d_y*$d_h/$d_between_centers}
o_ry={$d_x*$d_h/$d_between_centers}
# Determine the absolute intersection points.
## comp.  X_Cercle_ea={$c_x2+$o_rx}
## comp.  Y_Cercle_ea={$c_y2+$o_ry}
X_Cercle_eb={$c_x2-$o_rx}
Y_Cercle_eb={$c_y2-$o_ry}
# Centres des 2 Cercles rang 4 Pappus , adaptation des codes http://paulbourke.net/geometry/circlesphere/
# d_x and d_y are the vertical and horizontal distances between the circle centers. dx  dy
d_x={$X_Cc-$X_Cercle_db}
d_y={$Y_Cc-$Y_Cercle_db}
# Determine the straight-line distance between the centers. d
d_between_centers={{{$d_y*$d_y}+{$d_x*$d_x}}^0.5}
# Determine the distance from point 0 to point 2. a
d_p0_p2={{{$Va*$Va}-{$Vb*$Vb}+{$d_between_centers*$d_between_centers}}/{2*$d_between_centers}}
# Determine the coordinates of point 2. x2 y2
c_x2={$X_Cercle_db+{$d_x*$d_p0_p2/$d_between_centers}}
c_y2={$Y_Cercle_db+{$d_y*$d_p0_p2/$d_between_centers}}
# Determine the distance from point 2 to either of the intersection points. h
d_h={{{$Va*$Va}-{$d_p0_p2*$d_p0_p2}}^0.5}
# Now determine the offsets of the intersection points from point 2. rx  ry
o_rx={-$d_y*$d_h/$d_between_centers}
o_ry={$d_x*$d_h/$d_between_centers}
# Determine the absolute intersection points.
X_Cercle_ea={$c_x2+$o_rx}
Y_Cercle_ea={$c_y2+$o_ry}
## comp.  X_Cercle_eb={$c_x2-$o_rx}
## comp.  Y_Cercle_eb={$c_y2-$o_ry}
#####
# Rayon Cercle rang 9 Pappus
R_Pappus={$R_Cc/$Rayon_Cercle_Exterieur}
n_Pappus=9
b_Pappus={$R_Cc}
a_Pappus={$Rayon_Premier_Cercle}
R_Cercle_f={{$a_Pappus*$b_Pappus*{$a_Pappus+$b_Pappus}}/{{$n_Pappus*$a_Pappus*$a_Pappus}+{$b_Pappus*{$a_Pappus+$b_Pappus}}}}
Vb={$R_Cc+$R_Cercle_f}
Va={$R_Cercle_e+$R_Cercle_f}
# Centres des 2 Cercles rang 9 Pappus , adaptation des codes http://paulbourke.net/geometry/circlesphere/
# d_x and d_y are the vertical and horizontal distances between the circle centers. dx  dy
d_x={$X_Cc-$X_Cercle_ea}
d_y={$Y_Cc-$Y_Cercle_ea}
# Determine the straight-line distance between the centers. d
d_between_centers={{{$d_y*$d_y}+{$d_x*$d_x}}^0.5}
# Determine the distance from point 0 to point 2. a
d_p0_p2={{{$Va*$Va}-{$Vb*$Vb}+{$d_between_centers*$d_between_centers}}/{2*$d_between_centers}}
# Determine the coordinates of point 2. x2 y2
c_x2={$X_Cercle_ea+{$d_x*$d_p0_p2/$d_between_centers}}
c_y2={$Y_Cercle_ea+{$d_y*$d_p0_p2/$d_between_centers}}
# Determine the distance from point 2 to either of the intersection points. h
d_h={{{$Va*$Va}-{$d_p0_p2*$d_p0_p2}}^0.5}
# Now determine the offsets of the intersection points from point 2. rx  ry
o_rx={-$d_y*$d_h/$d_between_centers}
o_ry={$d_x*$d_h/$d_between_centers}
# Determine the absolute intersection points.
X_Cercle_fa={$c_x2+$o_rx}
Y_Cercle_fa={$c_y2+$o_ry}
## comp.  X_Cercle_fb={$c_x2-$o_rx}
## comp.  Y_Cercle_fb={$c_y2-$o_ry}
# Centres des 2 Cercles rang 9 Pappus , adaptation des codes http://paulbourke.net/geometry/circlesphere/
# d_x and d_y are the vertical and horizontal distances between the circle centers. dx  dy
d_x={$X_Cc-$X_Cercle_eb}
d_y={$Y_Cc-$Y_Cercle_eb}
# Determine the straight-line distance between the centers. d
d_between_centers={{{$d_y*$d_y}+{$d_x*$d_x}}^0.5}
# Determine the distance from point 0 to point 2. a
d_p0_p2={{{$Va*$Va}-{$Vb*$Vb}+{$d_between_centers*$d_between_centers}}/{2*$d_between_centers}}
# Determine the coordinates of point 2. x2 y2
c_x2={$X_Cercle_eb+{$d_x*$d_p0_p2/$d_between_centers}}
c_y2={$Y_Cercle_eb+{$d_y*$d_p0_p2/$d_between_centers}}
# Determine the distance from point 2 to either of the intersection points. h
d_h={{{$Va*$Va}-{$d_p0_p2*$d_p0_p2}}^0.5}
# Now determine the offsets of the intersection points from point 2. rx  ry
o_rx={-$d_y*$d_h/$d_between_centers}
o_ry={$d_x*$d_h/$d_between_centers}
# Determine the absolute intersection points.
## comp.  X_Cercle_fa={$c_x2+$o_rx}
## comp.  Y_Cercle_fa={$c_y2+$o_ry}
X_Cercle_fb={$c_x2-$o_rx}
Y_Cercle_fb={$c_y2-$o_ry}
#####
# Rayon Cercle rang 16 Pappus
R_Pappus={$R_Cc/$Rayon_Cercle_Exterieur}
n_Pappus=16
b_Pappus={$R_Cc}
a_Pappus={$Rayon_Premier_Cercle}
R_Cercle_g={{$a_Pappus*$b_Pappus*{$a_Pappus+$b_Pappus}}/{{$n_Pappus*$a_Pappus*$a_Pappus}+{$b_Pappus*{$a_Pappus+$b_Pappus}}}}
Vb={$R_Cc+$R_Cercle_g}
Va={$R_Cercle_f+$R_Cercle_g}
# Centres des 2 Cercles rang 16 Pappus , adaptation des codes http://paulbourke.net/geometry/circlesphere/
# d_x and d_y are the vertical and horizontal distances between the circle centers. dx  dy
d_x={$X_Cc-$X_Cercle_fa}
d_y={$Y_Cc-$Y_Cercle_fa}
# Determine the straight-line distance between the centers. d
d_between_centers={{{$d_y*$d_y}+{$d_x*$d_x}}^0.5}
# Determine the distance from point 0 to point 2. a
d_p0_p2={{{$Va*$Va}-{$Vb*$Vb}+{$d_between_centers*$d_between_centers}}/{2*$d_between_centers}}
# Determine the coordinates of point 2. x2 y2
c_x2={$X_Cercle_fa+{$d_x*$d_p0_p2/$d_between_centers}}
c_y2={$Y_Cercle_fa+{$d_y*$d_p0_p2/$d_between_centers}}
# Determine the distance from point 2 to either of the intersection points. h
d_h={{{$Va*$Va}-{$d_p0_p2*$d_p0_p2}}^0.5}
# Now determine the offsets of the intersection points from point 2. rx  ry
o_rx={-$d_y*$d_h/$d_between_centers}
o_ry={$d_x*$d_h/$d_between_centers}
# Determine the absolute intersection points.
X_Cercle_ga={$c_x2+$o_rx}
Y_Cercle_ga={$c_y2+$o_ry}
## comp.  X_Cercle_gb={$c_x2-$o_rx}
## comp.  Y_Cercle_gb={$c_y2-$o_ry}
# Centres des 2 Cercles rang 16 Pappus , adaptation des codes http://paulbourke.net/geometry/circlesphere/
# d_x and d_y are the vertical and horizontal distances between the circle centers. dx  dy
d_x={$X_Cc-$X_Cercle_fb}
d_y={$Y_Cc-$Y_Cercle_fb}
# Determine the straight-line distance between the centers. d
d_between_centers={{{$d_y*$d_y}+{$d_x*$d_x}}^0.5}
# Determine the distance from point 0 to point 2. a
d_p0_p2={{{$Va*$Va}-{$Vb*$Vb}+{$d_between_centers*$d_between_centers}}/{2*$d_between_centers}}
# Determine the coordinates of point 2. x2 y2
c_x2={$X_Cercle_fb+{$d_x*$d_p0_p2/$d_between_centers}}
c_y2={$Y_Cercle_fb+{$d_y*$d_p0_p2/$d_between_centers}}
# Determine the distance from point 2 to either of the intersection points. h
d_h={{{$Va*$Va}-{$d_p0_p2*$d_p0_p2}}^0.5}
# Now determine the offsets of the intersection points from point 2. rx  ry
o_rx={-$d_y*$d_h/$d_between_centers}
o_ry={$d_x*$d_h/$d_between_centers}
# Determine the absolute intersection points.
## comp.  X_Cercle_ga={$c_x2+$o_rx}
## comp.  Y_Cercle_ga={$c_y2+$o_ry}
X_Cercle_gb={$c_x2-$o_rx}
Y_Cercle_gb={$c_y2-$o_ry}
-if {$Canal_Alpha==0}
-to_rgb[-1]
-else
-to_rgba[-1]
-endif
-if {$Couleurs_aleatoires==1}
R_CE={round(?(0,255))}
V_CE={round(?(0,255))}
B_CE={round(?(0,255))}
R_PC={round(?(0,255))}
V_PC={round(?(0,255))}
B_PC={round(?(0,255))}
R_c={round(?(0,255))}
V_c={round(?(0,255))}
B_c={round(?(0,255))}
R_d={round(?(0,255))}
V_d={round(?(0,255))}
B_d={round(?(0,255))}
R_e={round(?(0,255))}
V_e={round(?(0,255))}
B_e={round(?(0,255))}
R_f={round(?(0,255))}
V_f={round(?(0,255))}
B_f={round(?(0,255))}
R_g={round(?(0,255))}
V_g={round(?(0,255))}
B_g={round(?(0,255))}
R_h={round(?(0,255))}
V_h={round(?(0,255))}
B_h={round(?(0,255))}
R_i={round(?(0,255))}
V_i={round(?(0,255))}
B_i={round(?(0,255))}
R_j={round(?(0,255))}
V_j={round(?(0,255))}
B_j={round(?(0,255))}
R_k={round(?(0,255))}
V_k={round(?(0,255))}
B_k={round(?(0,255))}
-endif
-if {$Affichage_Contours>0}
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-ellipse[-1] $X,$Y,$Rayon_Cercle_Exterieur,$Rayon_Cercle_Exterieur,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-ellipse[-1] {$X+$X_Cb},{$Y+$Y_Cb},$Rayon_Premier_Cercle,$Rayon_Premier_Cercle,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-ellipse[-1] {$X+$X_Cc},{$Y+$Y_Cc},$R_Cc,$R_Cc,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-ellipse[-1] {$X+$X_Cercle_da},{$Y+$Y_Cercle_da},$R_Cercle_d,$R_Cercle_d,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-ellipse[-1] {$X+$X_Cercle_db},{$Y+$Y_Cercle_db},$R_Cercle_d,$R_Cercle_d,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-ellipse[-1] {$X+$X_Cercle_ea},{$Y+$Y_Cercle_ea},$R_Cercle_e,$R_Cercle_e,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-ellipse[-1] {$X+$X_Cercle_eb},{$Y+$Y_Cercle_eb},$R_Cercle_e,$R_Cercle_e,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-ellipse[-1] {$X+$X_Cercle_fa},{$Y+$Y_Cercle_fa},$R_Cercle_f,$R_Cercle_f,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-ellipse[-1] {$X+$X_Cercle_fb},{$Y+$Y_Cercle_fb},$R_Cercle_f,$R_Cercle_f,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-ellipse[-1] {$X+$X_Cercle_ga},{$Y+$Y_Cercle_ga},$R_Cercle_g,$R_Cercle_g,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-ellipse[-1] {$X+$X_Cercle_gb},{$Y+$Y_Cercle_gb},$R_Cercle_g,$R_Cercle_g,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-ellipse[-1] $X,$Y,$Rayon_Cercle_Exterieur,$Rayon_Cercle_Exterieur,0,1,$R_CE,$V_CE,$B_CE,$A_CE
-ellipse[-1] {$X+$X_Cb},{$Y+$Y_Cb},$Rayon_Premier_Cercle,$Rayon_Premier_Cercle,0,1,$R_PC,$V_PC,$B_PC,$A_PC
-ellipse[-1] {$X+$X_Cc},{$Y+$Y_Cc},$R_Cc,$R_Cc,0,1,$R_c,$V_c,$B_c,$A_c
-ellipse[-1] {$X+$X_Cercle_da},{$Y+$Y_Cercle_da},$R_Cercle_d,$R_Cercle_d,0,1,$R_d,$V_d,$B_d,$A_d
-ellipse[-1] {$X+$X_Cercle_db},{$Y+$Y_Cercle_db},$R_Cercle_d,$R_Cercle_d,0,1,$R_e,$V_e,$B_e,$A_e
-ellipse[-1] {$X+$X_Cercle_ea},{$Y+$Y_Cercle_ea},$R_Cercle_e,$R_Cercle_e,0,1,$R_f,$V_f,$B_f,$A_f
-ellipse[-1] {$X+$X_Cercle_eb},{$Y+$Y_Cercle_eb},$R_Cercle_e,$R_Cercle_e,0,1,$R_g,$V_g,$B_g,$A_g
-ellipse[-1] {$X+$X_Cercle_fa},{$Y+$Y_Cercle_fa},$R_Cercle_f,$R_Cercle_f,0,1,$R_h,$V_h,$B_h,$A_h
-ellipse[-1] {$X+$X_Cercle_fb},{$Y+$Y_Cercle_fb},$R_Cercle_f,$R_Cercle_f,0,1,$R_i,$V_i,$B_i,$A_i
-ellipse[-1] {$X+$X_Cercle_ga},{$Y+$Y_Cercle_ga},$R_Cercle_g,$R_Cercle_g,0,1,$R_j,$V_j,$B_j,$A_j
-ellipse[-1] {$X+$X_Cercle_gb},{$Y+$Y_Cercle_gb},$R_Cercle_g,$R_Cercle_g,0,1,$R_k,$V_k,$B_k,$A_k
-if {$Affichage_Contours>0}
-if {$Dilatation>1} -dilate_circ[-2] $Dilatation -endif
-if {$Flou>0} -blur[-1,-2] $Flou,0 -endif
-if {$Deformation>0} -deform[-1,-2] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-2] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-2] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-blend[-2,-1] alpha,1,1
-else
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-1] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-1] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-endif
-if {$Inversions==1}
-mirror[-1] x
-elif {$Inversions==2}
-mirror[-1] y
-elif {$Inversions==3}
-mirror[-1] x
-mirror[-1] y
-endif
-blend[-1,-2] alpha,1,0
#@gimp Pintograph : Pintograph_samj, Pintograph_samj(1)
#@gimp : Note = link("http://en.wikipedia.org/wiki/Pintograph")
#@gimp : Sep = separator(), note = note("<small>Centre / Center</small>")
#@gimp : Centre / center x (%) = float(50,0,100)
#@gimp : Centre / center y (%) = float(50,0,100)
#@gimp : Sep = separator(), note = note("<small>Pintograph</small>")
#@gimp : Stylo / pen (couleur/color) = color(192,128,64,255)
#@gimp : Stylo / pen (variation de couleur/color variation) = choice("Pas de variation / No change","Couleurs aleatoires / Random colors","Faiblement nuancee / Poorly nuanced","Moyennement nuancee / Moderately nuanced","Fortement nuancee / Highly nuanced")
#@gimp : Stylo / pen (dilate pixels) = int(0,0,32)
#@gimp : It\303\251rations = int(1000,2,30000)
#@gimp : Multiplier = choice(0,"Iterations * 1","Iterations * 5 LENT / SLOW","Iterations * 10 TRES LENT / VERY SLOW")
#@gimp : Increment temps / time increment [*10000] = float(400,10,500)
#@gimp : Sep = separator(), note = note("<small>Amplitude</small>")
#@gimp : Amplitude 1 (>0 w) (<0 h) = float(150,-1000,1000)
#@gimp : Amplitude 2 (>0 w) (<0 h) = float(200,-1000,1000)
#@gimp : Amplitude 3 (>0 w) (<0 h) = float(200,-1000,1000)
#@gimp : Amplitude 4 (>0 w) (<0 h) = float(100,-1000,1000)
#@gimp : Sep = separator(), note = note("<small>Fr\303\251quence / Frequency</small>")
#@gimp : Fr\303\251quence 1 = float(4.00,0,16)
#@gimp : Fr\303\251quence 2 = float(4.05,0,16)
#@gimp : Fr\303\251quence 3 = float(4.16,0,16)
#@gimp : Fr\303\251quence 4 = float(4.32,0,16)
#@gimp : Sep = separator(), note = note("<small>Phase</small>")
#@gimp : Phase 1 = float(75,0,360)
#@gimp : Phase 2 = float(150,0,360)
#@gimp : Phase 3 = float(75,0,360)
#@gimp : Phase 4 = float(60,0,360)
#@gimp : Sep = separator(), note = note("<small>Divers / Foo</small>")
#@gimp : Flou / blur = float(0,0,10)
#@gimp : Spread = float(0,0,10)
#@gimp : D\303\251formation = float(0,0,25)
#@gimp : Sep = separator(), note = note("<small>M\303\251lange / Blend</small>")
#@gimp : Mode = choice{1,"Add","Alpha","And","Average","Blue","Burn","Darken","Difference",
#@gimp : "Divide","Dodge","Edges","Exclusion","Freeze","Grain extract","Grain merge","Green","Hard light",
#@gimp : "Hard mix","Hue","Interpolation","Lighten","Lightness","Linear burn","Linear light","Luminance",
#@gimp : "Multiply","Negation","Or","Overlay","Pin light","Red","Reflect","Saturation",
#@gimp : "Shape Average","Shape Average0","Soft burn","Soft dodge","Soft light","Screen","Stamp","Subtract","Value",
#@gimp : "Vivid light","Xor"}
#@gimp : Opacit\303\251 / opacity = float(1,0,1)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/15</i>.</small>")
Pintograph_samj :
centre_origine_X={$1/100*w}
centre_origine_Y={$2/100*h}
R_Couleur_Stylo=$3
V_Couleur_Stylo=$4
B_Couleur_Stylo=$5
A_Couleur_Stylo=$6
Variation_de_couleur=$7
Dilate_Stylo=$8
Iterations=$9
Multiplier_Iterations=$10
Increment_temps=$11
-if {$12>0}
Amplitude1={{w}*$12/{1000}}
-else
Amplitude1={-{h}*$12/{1000}}
-endif
-if {$13>0}
Amplitude2={{w}*$13/{1000}}
-else
Amplitude2={-{h}*$13/{1000}}
-endif
-if {$14>0}
Amplitude3={{w}*$14/{1000}}
-else
Amplitude3={-{h}*$14/{1000}}
-endif
-if {$15>0}
Amplitude4={{w}*$15/{1000}}
-else
Amplitude4={-{h}*$15/{1000}}
-endif
Frequence1=$16
Frequence2=$17
Frequence3=$18
Frequence4=$19
Phase1=$20
Phase2=$21
Phase3=$22
Phase4=$23
Flou_Pintograph=$24
Spread_Pintograph=$25
Deform_Pintograph=$26
blend=$27
opacite=$28
Revert_layers=0
-to_rgba
{w},{h},1,4
Nb_Boucle=1
temps=0
Ancien_point_X=0
Nouveau_point_X=0
Ancien_point_Y=0
Nouveau_point_Y=0
R_Couleur_origine=$R_Couleur_Stylo
V_Couleur_origine=$V_Couleur_Stylo
B_Couleur_origine=$B_Couleur_Stylo
A_Couleur_origine=$A_Couleur_Stylo
Increment_temps={$Increment_temps/10000}
Phase1={$Phase1/180*{pi}}
Phase2={$Phase2/180*{pi}}
Phase3={$Phase3/180*{pi}}
Phase4={$Phase4/180*{pi}}
-if {$Multiplier_Iterations>0}
Iterations={$Iterations*$Multiplier_Iterations*5}
-endif
-repeat $Iterations
-if {$Variation_de_couleur==1}
R_Couleur_Stylo={round({(?(255))})}
V_Couleur_Stylo={round({(?(255))})}
B_Couleur_Stylo={round({(?(255))})}
-endif
-if {$Variation_de_couleur>1}
Valeur_variation_couleur=16
-if {$Variation_de_couleur==3}
Valeur_variation_couleur=32
-endif
-if {$Variation_de_couleur==4}
Valeur_variation_couleur=64
-endif
R_Couleur_Stylo={round({$R_Couleur_origine+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$R_Couleur_Stylo>255}
R_Couleur_Stylo=$R_Couleur_origine
-endif
-if {$R_Couleur_Stylo<0}
R_Couleur_Stylo=$R_Couleur_origine
-endif
V_Couleur_Stylo={round({$V_Couleur_origine+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$V_Couleur_Stylo>255}
V_Couleur_Stylo=$V_Couleur_origine
-endif
-if {$V_Couleur_Stylo<0}
V_Couleur_Stylo=$V_Couleur_origine
-endif
B_Couleur_Stylo={round({$B_Couleur_origine+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$B_Couleur_Stylo>255}
B_Couleur_Stylo=$B_Couleur_origine
-endif
-if {$B_Couleur_Stylo<0}
B_Couleur_Stylo=$B_Couleur_origine
-endif
-endif
Nouveau_point_X={$centre_origine_X+{{$Amplitude1*{sin({{$Frequence1*$temps}+$Phase1})}}+{$Amplitude2*{sin({{$Frequence2*$temps}+$Phase2})}}}}
Nouveau_point_Y={$centre_origine_Y+{{$Amplitude3*{sin({{$Frequence3*$temps}+$Phase3})}}+{$Amplitude4*{sin({{$Frequence4*$temps}+$Phase4})}}}}
-if {$Nb_Boucle>1}
-line[-1] $Ancien_point_X,$Ancien_point_Y,$Nouveau_point_X,$Nouveau_point_Y,1,$R_Couleur_Stylo,$V_Couleur_Stylo,$B_Couleur_Stylo,$A_Couleur_Stylo
-endif
Ancien_point_X=$Nouveau_point_X
Ancien_point_Y=$Nouveau_point_Y
temps={$temps+$Increment_temps}
Nb_Boucle={$Nb_Boucle+1}
-done
-if {$Dilate_Stylo>0} -dilate_circ[-1] $Dilate_Stylo -endif
-if {$Flou_Pintograph>0} -blur[-1] $Flou_Pintograph,0 -endif
-if {$Spread_Pintograph>1} -spread[-1] $Spread_Pintograph -endif
-if {$Deform_Pintograph>0} -deform[-1] $Deform_Pintograph -endif
-gimp_blend[-1,-2] $blend,1,$opacite,$Revert_layers,1
#@gimp Poisson d avril : samj_Poisson_D_Avril, samj_Poisson_D_Avril(1)
#@gimp : Note = link("http://www.mathcurve.com/courbes2d/poisson/poisson.shtml","http://www.mathcurve.com/courbes2d/poisson/poisson.shtml")
#@gimp : Sep = separator(), note = note("<small>Rendu - Rendering</small>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Valeur a dimension = float(40,1,100)
#@gimp : Valeur k = float(2,0,4)
#@gimp : Angle inclinaison = float(0,0,360)
#@gimp : Contours = color(0,0,0,255)
#@gimp : Affichage contours = choice(1,"Sans","Poisson","Poisson CA")
#@gimp : Couleur a = color(250,60,10,255)
#@gimp : Couleur b = color(255,255,255,255)
#@gimp : Couleur al\303\251atoire / random color = bool(0)
#@gimp : Inversions = int(0,0,3)
#@gimp : Flou / blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,100)
#@gimp : Ombre = bool(0)
#@gimp : X-ombre = float(0.5,-5,5)
#@gimp : Y-ombre = float(0.5,-5,5)
#@gimp : Douceur / smoothness ombre = float(1.8,0,5)
#@gimp : Courbure / curvature ombre = float(0,0,1)
#@gimp : Compensation d\303\251calage ombre x = float(0,-50,50)
#@gimp : Compensation d\303\251calage ombre y = float(0,-50,50)
#@gimp : Canal alpha = bool(0)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/14</i>.</small>")
samj_Poisson_D_Avril :
X={round({{w}*{$1/100}})}
Y={round({{h}*{$2/100}})}
Valeur_A={round({{{w}+{h}}*$3/500})}
Valeur_K=$4
Angle_Rotation=$5
R_Contours=$6
V_Contours=$7
B_Contours=$8
A_Contours=$9
Affichage_Contours=$10
R_a=$11
V_a=$12
B_a=$13
A_a=$14
R_b=$15
V_b=$16
B_b=$17
A_b=$18
Couleurs_aleatoires=$19
Inversions=$20
Flou=$21
Dilatation=$22
Deformation=$23
Bruit=$24
Ombre=$25
X_Ombre=$26
Y_Ombre=$27
Smoothness_Ombre=$28
Curvature_Ombre=$29
Compensation_Decalage_Ombre_X=$30
Compensation_Decalage_Ombre_Y=$31
Canal_Alpha=$32
Resolution=720
Largeur_Origine={w}
Hauteur_Origine={h}
Nb_boucles=0
Angle=0
X_Poisson_A_Imprimer=0
Y_Poisson_A_Imprimer=0
X_Poisson_A_Imprimer_Precedent={{$X-$Valeur_A}+{$Valeur_A*{{cos({pi/180*$Angle})}+{$Valeur_K*{cos({pi/180*{$Angle/2}})}}}}}
Y_Poisson_A_Imprimer_Precedent={$Y+{$Valeur_A*{sin({pi/180*$Angle})}}}
-if {$Canal_Alpha==0}
-to_rgb[-1]
-else
-to_rgba[-1]
-endif
-if {$Affichage_Contours>0}
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-endif
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-if {$Affichage_Contours==2}
-ellipse[-2] $X,$Y,$Valeur_A,$Valeur_A,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-if {$Couleurs_aleatoires==1}
R_a={round(?(0,255))}
V_a={round(?(0,255))}
B_a={round(?(0,255))}
-endif
-repeat $Resolution
Nb_boucles={$Nb_boucles+1}
Angle={$Nb_boucles*{360/$Resolution}}
X_Poisson_A_Imprimer={{$X-$Valeur_A}+{$Valeur_A*{{cos({pi/180*$Angle})}+{$Valeur_K*{cos({pi/180*{$Angle/2}})}}}}}
Y_Poisson_A_Imprimer={$Y+{$Valeur_A*{sin({pi/180*$Angle})}}}
-polygon[-1] 3,{$X-{2*$Valeur_A}},$Y,$X_Poisson_A_Imprimer_Precedent,$Y_Poisson_A_Imprimer_Precedent,$X_Poisson_A_Imprimer,$Y_Poisson_A_Imprimer,1,$R_a,$V_a,$B_a,$A_a
-if {$Affichage_Contours>0}
-line[-2] $X_Poisson_A_Imprimer_Precedent,$Y_Poisson_A_Imprimer_Precedent,$X_Poisson_A_Imprimer,$Y_Poisson_A_Imprimer,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
X_Poisson_A_Imprimer_Precedent=$X_Poisson_A_Imprimer
Y_Poisson_A_Imprimer_Precedent=$Y_Poisson_A_Imprimer
-done
Nb_boucles=0
Angle=0
X_Poisson_A_Imprimer_Precedent={{$X-$Valeur_A}+{$Valeur_A*{{cos({pi/180*$Angle})}+{$Valeur_K*{cos({pi/180*{$Angle/2}})}}}}}
Y_Poisson_A_Imprimer_Precedent={$Y-{$Valeur_A*{sin({pi/180*$Angle})}}}
-if {$Couleurs_aleatoires==1}
R_b={round(?(0,255))}
V_b={round(?(0,255))}
B_b={round(?(0,255))}
-endif
-repeat $Resolution
Nb_boucles={$Nb_boucles+1}
Angle={$Nb_boucles*{360/$Resolution}}
X_Poisson_A_Imprimer={{$X-$Valeur_A}+{$Valeur_A*{{cos({pi/180*$Angle})}+{$Valeur_K*{cos({pi/180*{$Angle/2}})}}}}}
Y_Poisson_A_Imprimer={$Y-{$Valeur_A*{sin({pi/180*$Angle})}}}
-polygon[-1] 3,{$X-{2*$Valeur_A}},$Y,$X_Poisson_A_Imprimer_Precedent,$Y_Poisson_A_Imprimer_Precedent,$X_Poisson_A_Imprimer,$Y_Poisson_A_Imprimer,1,$R_b,$V_b,$B_b,$A_b
-if {$Affichage_Contours>0}
-line[-2] $X_Poisson_A_Imprimer_Precedent,$Y_Poisson_A_Imprimer_Precedent,$X_Poisson_A_Imprimer,$Y_Poisson_A_Imprimer,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
X_Poisson_A_Imprimer_Precedent=$X_Poisson_A_Imprimer
Y_Poisson_A_Imprimer_Precedent=$Y_Poisson_A_Imprimer
-done
-if {$Affichage_Contours>0}
-if {$Dilatation>1} -dilate_circ[-2] $Dilatation -endif
-if {$Flou>0} -blur[-1,-2] $Flou,0 -endif
-if {$Deformation>0} -deform[-1,-2] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-2] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-2] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-blend[-2,-1] alpha,1,1
-else
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-1] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-1] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-endif
-if {$Inversions==1}
-mirror[-1] x
-elif {$Inversions==2}
-mirror[-1] y
-elif {$Inversions==3}
-mirror[-1] x
-mirror[-1] y
-endif
-if {$Angle_Rotation>0} -rotate[-1] $Angle_Rotation,1,0,{{w}/2},{{h}/2} -endif
-blend[-1,-2] alpha,1,0
#@gimp Rosace triangles sierpinski : samj_Rosace_Triangles_Sierpinski, samj_Rosace_Triangles_Sierpinski(1)
#@gimp : Sep = separator(), note = note("<small>Rendu - Rendering</small>")
#@gimp : Nombre de zones = int(6,3,24)
#@gimp : Nombre de couches = int(6,1,50)
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Rayon premier cercle (>0 w%) (<0 h%) = float(50,-400,400)
#@gimp : D\303\251calage angle = float(-15,-30,30)
#@gimp : Dimension triangle = float(25,0,100)
#@gimp : Recouvrement triangle = float(5,0,100)
#@gimp : Angle inclinaison = float(30,0,360)
#@gimp : Contours = color(0,0,0,255)
#@gimp : Affichage contours = choice(0,"Sans","Triangle A et B","Triangle A","Triangle B","Triangle A et B et Cercle","Triangle A et Cercle","Triangle B et Cercle")
#@gimp : Type triangles a = choice(0,"JDH","JDE","JDB","JAH","JAE","JAB","Sans")
#@gimp : Type triangles b = choice(0,"HBI","HBF","HBC","Sans")
#@gimp : Type decalage = choice(0,"Couches","Cercles","Couches et Cercles")
#@gimp : Recursions sierpinski = int(3,0,7)
#@gimp : Triangle a = color(0,0,255,127)
#@gimp : Triangle ab = color(255,255,0,127)
#@gimp : Triangle b = color(128,64,192,127)
#@gimp : Triangle ba = color(64,128,192,127)
#@gimp : Cercle = color(0,255,255,127)
#@gimp : Afficher cercle = bool(0)
#@gimp : Couleurs al\303\251atoires / random colors = bool(0)
#@gimp : Inversions = int(0,0,3)
#@gimp : Flou / blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,100)
#@gimp : Ombre / shadow = bool(0)
#@gimp : X-ombre x-shadow = float(0.5,-5,5)
#@gimp : Y-ombre y-shadow = float(0.5,-5,5)
#@gimp : Douceur ombre / smoothness shadow = float(1.8,0,5)
#@gimp : Courbure ombre / curvature shadow = float(0,0,1)
#@gimp : D\303\251calage ombre x / shadow offset x = float(0,-20,20)
#@gimp : D\303\251calage ombre y / shadow offset y = float(0,-20,20)
#@gimp : Canal alpha = bool(0)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/08</i>.</small>")
samj_Rosace_Triangles_Sierpinski :
Nombre_de_zones=$1
Nombre_de_couches=$2
X={round({{w}*{$3/100}})}
Y={round({{h}*{$4/100}})}
-if {$5>0}
Rayon_Premier_Cecle={round({{w}*$5/{400*{2^0.5}}})}
-else
Rayon_Premier_Cecle={round({-{h}*$5/{400*{2^0.5}}})}
-endif
Decalage_Angle=$6
Hauteur_Triangle={round({{{w}+{h}}*$7/2400})}
Recouvrement_Triangle={round({{{w}+{h}}*$8/4800})}
Angle_inclinaison=$9
R_Contours=$10
V_Contours=$11
B_Contours=$12
A_Contours=$13
Affichage_Contours=$14
Type_Triangles_A=$15
Type_Triangles_B=$16
Type_Decalage=$17
Recursions_Sierpinski=$18
R_Tr=$19
V_Tr=$20
B_Tr=$21
A_Tr=$22
R_Trb=$23
V_Trb=$24
B_Trb=$25
A_Trb=$26
R_Tr_B=$27
V_Tr_B=$28
B_Tr_B=$29
A_Tr_B=$30
R_Tr_Bb=$31
V_Tr_Bb=$32
B_Tr_Bb=$33
A_Tr_Bb=$34
R_Cercle=$35
V_Cercle=$36
B_Cercle=$37
A_Cercle=$38
Afficher_Cercle=$39
Couleurs_aleatoires=$40
Inversions=$41
Flou=$42
Dilatation=$43
Deformation=$44
Bruit=$45
Ombre=$46
X_Ombre=$47
Y_Ombre=$48
Smoothness_Ombre=$49
Curvature_Ombre=$50
Compensation_Decalage_Ombre_X=$51
Compensation_Decalage_Ombre_Y=$52
Canal_Alpha=$53
Largeur_Origine={w}
Hauteur_Origine={h}
Angle=$Angle_inclinaison
Increment_angle={360/$Nombre_de_zones}
Rayon_Cercle_Origine=$Rayon_Premier_Cecle
Rayon_Cercle_A=0
Rayon_Cercle_B=0
Rayon_Cercle_C=0
Rayon_Cercle_D=0
H_Tr_A=0
H_Tr_B=0
H_Tr_C=0
H_Tr_D=0
Nb_Cercles=0
-if {$Canal_Alpha==0}
-to_rgb[-1]
-else
-to_rgba[-1]
-endif
-if {$Affichage_Contours>0}
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-endif
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
Nb_boucles_couches=0
-repeat $Nombre_de_couches
Nb_boucles_couches={$Nb_boucles_couches+1}
H_Tr_A={$Hauteur_Triangle*$Nb_Cercles}
Nb_Cercles={$Nb_Cercles+1}
H_Tr_B={$Hauteur_Triangle*$Nb_Cercles}
Nb_Cercles={$Nb_Cercles+1}
H_Tr_C={$Hauteur_Triangle*$Nb_Cercles}
Nb_Cercles={$Nb_Cercles+1}
H_Tr_D={$Hauteur_Triangle*$Nb_Cercles}
Rayon_Cercle_A={$Rayon_Cercle_Origine+$H_Tr_A}
Rayon_Cercle_B={$Rayon_Cercle_Origine+$H_Tr_B}
Rayon_Cercle_C={$Rayon_Cercle_Origine+$H_Tr_C}
Rayon_Cercle_D={$Rayon_Cercle_Origine+$H_Tr_D}
Angle=$Angle_inclinaison
Nb_boucles_zones=0
-repeat $Nombre_de_zones
Nb_boucles_zones={$Nb_boucles_zones+1}
-if {$Couleurs_aleatoires==1}
R_Tr={round(?(0,255))}
V_Tr={round(?(0,255))}
B_Tr={round(?(0,255))}
R_Trb={round(?(0,255))}
V_Trb={round(?(0,255))}
B_Trb={round(?(0,255))}
R_Tr_B={round(?(0,255))}
V_Tr_B={round(?(0,255))}
B_Tr_B={round(?(0,255))}
R_Tr_Bb={round(?(0,255))}
V_Tr_Bb={round(?(0,255))}
B_Tr_Bb={round(?(0,255))}
R_Cercle={round(?(0,255))}
V_Cercle={round(?(0,255))}
B_Cercle={round(?(0,255))}
-endif
-if {$Type_Decalage==0}
X_A={$X+{$Rayon_Cercle_A*{cos({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}+{180/$Nombre_de_zones}}})}}}
Y_A={$Y+{$Rayon_Cercle_A*{sin({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}+{180/$Nombre_de_zones}}})}}}
X_B={$X+{$Rayon_Cercle_A*{cos({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}}})}}}
Y_B={$Y+{$Rayon_Cercle_A*{sin({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}}})}}}
X_C={$X+{$Rayon_Cercle_A*{cos({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}-{180/$Nombre_de_zones}}})}}}
Y_C={$Y+{$Rayon_Cercle_A*{sin({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}-{180/$Nombre_de_zones}}})}}}
X_D={$X+{$Rayon_Cercle_B*{cos({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}+{180/$Nombre_de_zones}}})}}}
Y_D={$Y+{$Rayon_Cercle_B*{sin({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}+{180/$Nombre_de_zones}}})}}}
X_E={$X+{$Rayon_Cercle_B*{cos({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}}})}}}
Y_E={$Y+{$Rayon_Cercle_B*{sin({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}}})}}}
X_F={$X+{$Rayon_Cercle_B*{cos({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}-{180/$Nombre_de_zones}}})}}}
Y_F={$Y+{$Rayon_Cercle_B*{sin({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}-{180/$Nombre_de_zones}}})}}}
X_G={$X+{$Rayon_Cercle_C*{cos({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}+{180/$Nombre_de_zones}}})}}}
Y_G={$Y+{$Rayon_Cercle_C*{sin({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}+{180/$Nombre_de_zones}}})}}}
X_H={$X+{$Rayon_Cercle_C*{cos({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}}})}}}
Y_H={$Y+{$Rayon_Cercle_C*{sin({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}}})}}}
X_I={$X+{$Rayon_Cercle_C*{cos({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}-{180/$Nombre_de_zones}}})}}}
Y_I={$Y+{$Rayon_Cercle_C*{sin({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}-{180/$Nombre_de_zones}}})}}}
X_J={$X+{{$Recouvrement_Triangle+$Rayon_Cercle_D}*{cos({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}+{180/$Nombre_de_zones}}})}}}
Y_J={$Y+{{$Recouvrement_Triangle+$Rayon_Cercle_D}*{sin({pi/180*{$Angle+{$Decalage_Angle*$Nb_boucles_couches}+{180/$Nombre_de_zones}}})}}}
-elif {$Type_Decalage==1}
X_A={$X+{$Rayon_Cercle_A*{cos({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-3}}+{180/$Nombre_de_zones}}})}}}
Y_A={$Y+{$Rayon_Cercle_A*{sin({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-3}}+{180/$Nombre_de_zones}}})}}}
X_B={$X+{$Rayon_Cercle_A*{cos({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-3}}}})}}}
Y_B={$Y+{$Rayon_Cercle_A*{sin({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-3}}}})}}}
X_C={$X+{$Rayon_Cercle_A*{cos({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-3}}-{180/$Nombre_de_zones}}})}}}
Y_C={$Y+{$Rayon_Cercle_A*{sin({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-3}}-{180/$Nombre_de_zones}}})}}}
X_D={$X+{$Rayon_Cercle_B*{cos({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-2}}+{180/$Nombre_de_zones}}})}}}
Y_D={$Y+{$Rayon_Cercle_B*{sin({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-2}}+{180/$Nombre_de_zones}}})}}}
X_E={$X+{$Rayon_Cercle_B*{cos({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-2}}}})}}}
Y_E={$Y+{$Rayon_Cercle_B*{sin({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-2}}}})}}}
X_F={$X+{$Rayon_Cercle_B*{cos({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-2}}-{180/$Nombre_de_zones}}})}}}
Y_F={$Y+{$Rayon_Cercle_B*{sin({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-2}}-{180/$Nombre_de_zones}}})}}}
X_G={$X+{$Rayon_Cercle_C*{cos({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-1}}+{180/$Nombre_de_zones}}})}}}
Y_G={$Y+{$Rayon_Cercle_C*{sin({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-1}}+{180/$Nombre_de_zones}}})}}}
X_H={$X+{$Rayon_Cercle_C*{cos({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-1}}}})}}}
Y_H={$Y+{$Rayon_Cercle_C*{sin({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-1}}}})}}}
X_I={$X+{$Rayon_Cercle_C*{cos({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-1}}-{180/$Nombre_de_zones}}})}}}
Y_I={$Y+{$Rayon_Cercle_C*{sin({pi/180*{$Angle+{$Decalage_Angle/3*{$Nb_Cercles-1}}-{180/$Nombre_de_zones}}})}}}
X_J={$X+{{$Recouvrement_Triangle+$Rayon_Cercle_D}*{cos({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_Cercles}+{180/$Nombre_de_zones}}})}}}
Y_J={$Y+{{$Recouvrement_Triangle+$Rayon_Cercle_D}*{sin({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_Cercles}+{180/$Nombre_de_zones}}})}}}
-elif {$Type_Decalage==2}
X_A={$X+{$Rayon_Cercle_A*{cos({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-3}}+{180/$Nombre_de_zones}}})}}}
Y_A={$Y+{$Rayon_Cercle_A*{sin({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-3}}+{180/$Nombre_de_zones}}})}}}
X_B={$X+{$Rayon_Cercle_A*{cos({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-3}}}})}}}
Y_B={$Y+{$Rayon_Cercle_A*{sin({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-3}}}})}}}
X_C={$X+{$Rayon_Cercle_A*{cos({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-3}}-{180/$Nombre_de_zones}}})}}}
Y_C={$Y+{$Rayon_Cercle_A*{sin({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-3}}-{180/$Nombre_de_zones}}})}}}
X_D={$X+{$Rayon_Cercle_B*{cos({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-2}}+{180/$Nombre_de_zones}}})}}}
Y_D={$Y+{$Rayon_Cercle_B*{sin({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-2}}+{180/$Nombre_de_zones}}})}}}
X_E={$X+{$Rayon_Cercle_B*{cos({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-2}}}})}}}
Y_E={$Y+{$Rayon_Cercle_B*{sin({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-2}}}})}}}
X_F={$X+{$Rayon_Cercle_B*{cos({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-2}}-{180/$Nombre_de_zones}}})}}}
Y_F={$Y+{$Rayon_Cercle_B*{sin({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-2}}-{180/$Nombre_de_zones}}})}}}
X_G={$X+{$Rayon_Cercle_C*{cos({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-1}}+{180/$Nombre_de_zones}}})}}}
Y_G={$Y+{$Rayon_Cercle_C*{sin({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-1}}+{180/$Nombre_de_zones}}})}}}
X_H={$X+{$Rayon_Cercle_C*{cos({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-1}}}})}}}
Y_H={$Y+{$Rayon_Cercle_C*{sin({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-1}}}})}}}
X_I={$X+{$Rayon_Cercle_C*{cos({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-1}}-{180/$Nombre_de_zones}}})}}}
Y_I={$Y+{$Rayon_Cercle_C*{sin({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*{$Nb_Cercles-1}}-{180/$Nombre_de_zones}}})}}}
X_J={$X+{{$Recouvrement_Triangle+$Rayon_Cercle_D}*{cos({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*$Nb_Cercles}+{180/$Nombre_de_zones}}})}}}
Y_J={$Y+{{$Recouvrement_Triangle+$Rayon_Cercle_D}*{sin({pi/180*{$Angle+{$Decalage_Angle/3*$Nb_boucles_couches*$Nb_Cercles}+{180/$Nombre_de_zones}}})}}}
-endif
-if {$Type_Triangles_A==0}
-if {{($Nb_boucles_couches%2)}==0}
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_J,$Y_J,$X_D,$Y_D,$X_H,$Y_H,$R_Tr,$V_Tr,$B_Tr,$A_Tr
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_J,$Y_J,$X_D,$Y_D,$X_H,$Y_H,$R_Trb,$V_Trb,$B_Trb,$A_Trb
-endif
-if {{$Affichage_Contours==1}||{$Affichage_Contours==2}||{$Affichage_Contours==4}||{$Affichage_Contours==5}}
-polygon[-2] 3,$X_J,$Y_J,$X_D,$Y_D,$X_H,$Y_H,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-elif {$Type_Triangles_A==1}
-if {{($Nb_boucles_couches%2)}==0}
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_J,$Y_J,$X_D,$Y_D,$X_E,$Y_E,$R_Tr,$V_Tr,$B_Tr,$A_Tr
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_J,$Y_J,$X_D,$Y_D,$X_E,$Y_E,$R_Trb,$V_Trb,$B_Trb,$A_Trb
-endif
-if {{$Affichage_Contours==1}||{$Affichage_Contours==2}||{$Affichage_Contours==4}||{$Affichage_Contours==5}}
-polygon[-2] 3,$X_J,$Y_J,$X_D,$Y_D,$X_E,$Y_E,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-elif {$Type_Triangles_A==2}
-if {{($Nb_boucles_couches%2)}==0}
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_J,$Y_J,$X_D,$Y_D,$X_B,$Y_B,$R_Tr,$V_Tr,$B_Tr,$A_Tr
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_J,$Y_J,$X_D,$Y_D,$X_B,$Y_B,$R_Trb,$V_Trb,$B_Trb,$A_Trb
-endif
-if {{$Affichage_Contours==1}||{$Affichage_Contours==2}||{$Affichage_Contours==4}||{$Affichage_Contours==5}}
-polygon[-2] 3,$X_J,$Y_J,$X_D,$Y_D,$X_B,$Y_B,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-elif {$Type_Triangles_A==3}
-if {{($Nb_boucles_couches%2)}==0}
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_J,$Y_J,$X_A,$Y_A,$X_H,$Y_H,$R_Tr,$V_Tr,$B_Tr,$A_Tr
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_J,$Y_J,$X_A,$Y_A,$X_H,$Y_H,$R_Trb,$V_Trb,$B_Trb,$A_Trb
-endif
-if {{$Affichage_Contours==1}||{$Affichage_Contours==2}||{$Affichage_Contours==4}||{$Affichage_Contours==5}}
-polygon[-2] 3,$X_J,$Y_J,$X_A,$Y_A,$X_H,$Y_H,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-elif {$Type_Triangles_A==4}
-if {{($Nb_boucles_couches%2)}==0}
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_J,$Y_J,$X_A,$Y_A,$X_E,$Y_E,$R_Tr,$V_Tr,$B_Tr,$A_Tr
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_J,$Y_J,$X_A,$Y_A,$X_E,$Y_E,$R_Trb,$V_Trb,$B_Trb,$A_Trb
-endif
-if {{$Affichage_Contours==1}||{$Affichage_Contours==2}||{$Affichage_Contours==4}||{$Affichage_Contours==5}}
-polygon[-2] 3,$X_J,$Y_J,$X_A,$Y_A,$X_E,$Y_E,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-elif {$Type_Triangles_A==5}
-if {{($Nb_boucles_couches%2)}==0}
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_J,$Y_J,$X_A,$Y_A,$X_B,$Y_B,$R_Tr,$V_Tr,$B_Tr,$A_Tr
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_J,$Y_J,$X_A,$Y_A,$X_B,$Y_B,$R_Trb,$V_Trb,$B_Trb,$A_Trb
-endif
-if {{$Affichage_Contours==1}||{$Affichage_Contours==2}||{$Affichage_Contours==4}||{$Affichage_Contours==5}}
-polygon[-2] 3,$X_J,$Y_J,$X_A,$Y_A,$X_B,$Y_B,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-endif
-if {$Type_Triangles_B==0}
-if {{($Nb_boucles_couches%2)}==0}
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_H,$Y_H,$X_B,$Y_B,$X_I,$Y_I,$R_Tr_B,$V_Tr_B,$B_Tr_B,$A_Tr_B
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_H,$Y_H,$X_B,$Y_B,$X_I,$Y_I,$R_Tr_Bb,$V_Tr_Bb,$B_Tr_Bb,$A_Tr_Bb
-endif
-if {{$Affichage_Contours==1}||{$Affichage_Contours==3}||{$Affichage_Contours==4}||{$Affichage_Contours==6}}
-polygon[-2] 3,$X_H,$Y_H,$X_B,$Y_B,$X_I,$Y_I,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-elif {$Type_Triangles_B==1}
-if {{($Nb_boucles_couches%2)}==0}
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_H,$Y_H,$X_B,$Y_B,$X_F,$Y_F,$R_Tr_B,$V_Tr_B,$B_Tr_B,$A_Tr_B
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_H,$Y_H,$X_B,$Y_B,$X_F,$Y_F,$R_Tr_Bb,$V_Tr_Bb,$B_Tr_Bb,$A_Tr_Bb
-endif
-if {{$Affichage_Contours==1}||{$Affichage_Contours==3}||{$Affichage_Contours==4}||{$Affichage_Contours==6}}
-polygon[-2] 3,$X_H,$Y_H,$X_B,$Y_B,$X_F,$Y_F,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-elif {$Type_Triangles_B==2}
-if {{($Nb_boucles_couches%2)}==0}
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_H,$Y_H,$X_B,$Y_B,$X_C,$Y_C,$R_Tr_B,$V_Tr_B,$B_Tr_B,$A_Tr_B
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_H,$Y_H,$X_B,$Y_B,$X_C,$Y_C,$R_Tr_Bb,$V_Tr_Bb,$B_Tr_Bb,$A_Tr_Bb
-endif
-if {{$Affichage_Contours==1}||{$Affichage_Contours==3}||{$Affichage_Contours==4}||{$Affichage_Contours==6}}
-polygon[-2] 3,$X_H,$Y_H,$X_B,$Y_B,$X_C,$Y_C,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-endif
Angle={$Angle_inclinaison+{$Increment_angle*$Nb_boucles_zones}}
-done
Nb_Cercles={$Nb_Cercles-3}
H_Tr=$H_Tr_C
Rayon_Cercle_Origine=$Rayon_Cercle_D
-done
-if {$Afficher_Cercle==1}
$Largeur_Origine,$Hauteur_Origine,1,4
-polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1
-ellipse[-1] $X,$Y,$Rayon_Cercle_D,$Rayon_Cercle_D,0,1,$R_Cercle,$V_Cercle,$B_Cercle,$A_Cercle
-blend[-2,-1] alpha,1,1
-endif
-if {$Affichage_Contours>0}
-if {$Affichage_Contours>3}
-ellipse[-2,-3] $X,$Y,$Rayon_Cercle_D,$Rayon_Cercle_D,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-if {$Dilatation>1} -dilate_circ[-2] $Dilatation -endif
-if {$Flou>0} -blur[-1,-2] $Flou,0 -endif
-if {$Deformation>0} -deform[-1,-2] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-2] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-2] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-blend[-2,-1] alpha,1,1
-else
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-1] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-1] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-endif
-if {$Inversions==1}
-mirror[-1] x
-elif {$Inversions==2}
-mirror[-1] y
-elif {$Inversions==3}
-mirror[-1] x
-mirror[-1] y
-endif
-blend[-1,-2] alpha,1,0
samj_rien_repair :
-Je_passe_l_hiver_en_Floride[-1]
samj_rien_sequences :
-Je_passe_l_hiver_en_Floride[-1]
samj_rien_various :
-Je_passe_l_hiver_en_Floride[-1]
trait_epais_samj :
## Variables
-verbose -
-if {{$3-$1}==0} X1={$1-{$5/2}} Y1=$2 X2={$3-{$5/2}} Y2=$4 X3={$3+{$5/2}} Y3=$4 X4={$1+{$5/2}} Y4=$2
-else
-if {{$4-$2}==0} X1=$1 Y1={$2+{$5/2}} X2=$3 Y2={$4+{$5/2}} X3=$3 Y3={$4-{$5/2}} X4=$1 Y4={$2-{$5/2}}
-else angle_triangle={{{pi}/2}-{atan({{$4-$2}/{$3-$1}})}} X_triangle={{$5/2}*{cos($angle_triangle)}} Y_triangle={{$5/2}*{sin($angle_triangle)}}
X1={$1-$X_triangle} Y1={$2+$Y_triangle} X2={$3-$X_triangle} Y2={$4+$Y_triangle} X3={$3+$X_triangle} Y3={$4-$Y_triangle} X4={$1+$X_triangle} Y4={$2-$Y_triangle}
-endif
-endif
-polygon[-1] 4,$X1,$Y1,$X2,$Y2,$X3,$Y3,$X4,$Y4,1,$7,$8,$9,$10
-if {$6==1} -circle[-1] $1,$2,{$5/2},1,$7,$8,$9,$10 -circle[-1] $3,$4,{$5/2},1,$7,$8,$9,$10 -endif
-verbose +
samj_sierpinski_absolu : -check ${1=7}>=0 -skip ${2=0},${3=0},${4=10},${5=100},${6=150},${7=20},${8=255},${9=255},${10=0},${11=255}
-e[^-1] "Draw Sierpinski triangle of degree $1 on image$?."
-v - -_samj_sierpinski_absolu ${2-11},$1  -v +
_samj_sierpinski_absolu :
-if {$11<=0} -polygon 3,$1,$2,$3,$4,$5,$6,1,$7,$8,$9,$10 -return -endif
-_samj_sierpinski_absolu $1,$2,{($1+$3)/2},{($2+$4)/2},{($1+$5)/2},{($2+$6)/2},$7,$8,$9,$10,{$11-1}
-_samj_sierpinski_absolu {($1+$3)/2},{($2+$4)/2},$3,$4,{($3+$5)/2},{($4+$6)/2},$7,$8,$9,$10,{$11-1}
-_samj_sierpinski_absolu {($1+$5)/2},{($2+$6)/2},$5,$6,{($3+$5)/2},{($4+$6)/2},$7,$8,$9,$10,{$11-1}
samj_snowflake_absolu :
-v -
-to_rgba
-polygon 3,$2,$3,$4,$5,$6,$7,${8--1},255
-_samj_snowflake_absolu $1,$2,$3,$6,$7,${8--1}
-_samj_snowflake_absolu $1,$6,$7,$4,$5,${8--1}
-_samj_snowflake_absolu $1,$4,$5,$2,$3,${8--1}
-v +
_samj_snowflake_absolu :
x0={$2+($4-$2)/3} y0={$3+($5-$3)/3}
x1={$2+2*($4-$2)/3} y1={$3+2*($5-$3)/3}
c={cos(-pi/3)} s={sin(-pi/3)}
x2={$x0+($x1-$x0)*$c-($y1-$y0)*$s} y2={$y0+($x1-$x0)*$s+($y1-$y0)*$c}
-polygon 3,$x0,$y0,$x1,$y1,$x2,$y2,${6--1},255
-if $1
-_samj_snowflake_absolu {$1-1},$2,$3,$x0,$y0,${6--1}
-_samj_snowflake_absolu {$1-1},$x0,$y0,$x2,$y2,${6--1}
-_samj_snowflake_absolu {$1-1},$x2,$y2,$x1,$y1,${6--1}
-_samj_snowflake_absolu {$1-1},$x1,$y1,$4,$5,${6--1}
-endif
samj_snowflake_contours_absolu :
-v -
-to_rgba
-polygon 3,$2,$3,$4,$5,$6,$7,$8,0xFFFFFFFF,$9,$10,$11,255
-_samj_snowflake_contours_absolu $1,$2,$3,$6,$7,${8--1}
-_samj_snowflake_contours_absolu $1,$6,$7,$4,$5,${8--1}
-_samj_snowflake_contours_absolu $1,$4,$5,$2,$3,${8--1}
-v +
_samj_snowflake_contours_absolu :
x0={$2+($4-$2)/3} y0={$3+($5-$3)/3}
x1={$2+2*($4-$2)/3} y1={$3+2*($5-$3)/3}
c={cos(-pi/3)} s={sin(-pi/3)}
x2={$x0+($x1-$x0)*$c-($y1-$y0)*$s} y2={$y0+($x1-$x0)*$s+($y1-$y0)*$c}
-polygon 3,$x0,$y0,$x1,$y1,$x2,$y2,$6,0xFFFFFFFF,${7--1},255
-if $1
-_samj_snowflake_contours_absolu {$1-1},$2,$3,$x0,$y0,${6--1}
-_samj_snowflake_contours_absolu {$1-1},$x0,$y0,$x2,$y2,${6--1}
-_samj_snowflake_contours_absolu {$1-1},$x2,$y2,$x1,$y1,${6--1}
-_samj_snowflake_contours_absolu {$1-1},$x1,$y1,$4,$5,${6--1}
-endif
twirl_ancien_euclidean2polar_ancien_polar2euclidean : -skip ${1=1},${2=50%},${3=50%},${4=1}
-e[^-1] "Apply twirl deformation on image$?, with amplitude $1 and center point at ($2%,$3%)."
-v - -euclidean2polar_ancien $2,$3,1,$4 -repeat @#
[$>],[$>],1,1,$1*x -channels[-1] -1,0 -warp[$>] [-1],1,1,2 -rm[-1]
-done -polar2euclidean_ancien $2,$3,1,1 -v +
euclidean2polar_ancien : -skip ${1=0.5},${2=0.5},${3=1},${4=1}
-e[^-1] "Apply euclidean to polar transform on image$?."
-v - -repeat @# -l[$>]
({w},{h}) ($1,$2) -*[-2,-1] ({"sqrt(max("@{-1,0}","@{-2,w}"-"@{-1,0}")^2 + max("@{-1,1}","@{-2,h}"-"@{-1,1}")^2)"})
-a[-2,-1] x
[-2],[-2],1,1,@{-1,2}"*(x/w)^$3*cos(y*2*pi/h)" -+[-1] @{-2,0}
[-1],[-1],1,1,@{-2,2}"*(x/w)^$3*sin(y*2*pi/h)" -+[-1] @{-3,1}
-rm[-3] -a[-2,-1] c -warp[-2] [-1],0,1,$4 -rm[-1]
-endl -done -v +
polar2euclidean_ancien : -skip ${1=0.5},${2=0.5},${3=1},${4=1}
-e[^-1] "Apply polar to euclidean transform on image$?."
-v - -repeat @# -l[$>]
({w},{h}) ($1,$2) -*[-2,-1] ({"sqrt(max("@{-1,0}","@{-2,w}"-"@{-1,0}")^2 + max("@{-1,1}","@{-2,h}"-"@{-1,1}")^2)"})
-a[-2,-1] x
[-2],[-2],1,1,"w*(sqrt((x-"@{-1,0}")^2 + (y-"@{-1,1}")^2)/"@{-1,2}")^(1/$3)"
[-1],[-1],1,1,"(atan2(y-"@{-2,1}",x-"@{-2,0}")*h/(2*pi)+h)%h"
-rm[-3] -a[-2,-1] c -warp[-2] [-1],0,1,$4 -rm[-1]
-endl -done -v +
#@gimp Rotating circles : samj_Cercles_Qui_Tournent, samj_Cercles_Qui_Tournent(1)
#@gimp : Note = note("Cercles Qui Tournent / Rotating Circles")
#@gimp : Note = link("http://rouxjeanbernard.ch/AM/html/amch57.html","http://rouxjeanbernard.ch/AM/html/amch57.html")
#@gimp : Sep = separator(), note = note("<small>Nouvelle New Image</small>")
#@gimp : Dimension image = int(800,2,32768)
#@gimp : Fond / background = color(255,255,255,255)
#@gimp : Sep = separator(), note = note("<small>Exemples Examples</small>")
#@gimp : Examples = choice(0,"Non No","A","B","C","D","E","F")
#@gimp : Sep = separator(), note = note("<small>Param. X</small>")
#@gimp : Cax = float(1,0.5,2)
#@gimp : Cbx = float(0.5,0.05,5)
#@gimp : Ccx = float(0.33,0.05,5)
#@gimp : Vbx = int(7,-50,50)
#@gimp : Vcx = int(17,-50,50)
#@gimp : Sep = separator(), note = note("<small>Param. Y</small>")
#@gimp : Cay = float(1,0.5,2)
#@gimp : Cby = float(0.5,0.05,5)
#@gimp : Ccy = float(0.33,0.05,5)
#@gimp : Vby = int(7,-50,50)
#@gimp : Vcy = int(17,-50,50)
#@gimp : Sep = separator(), note = note("<small>Rendu Rendering</small>")
#@gimp : \303\211galite / equality : param. x & param. y = bool(1)
#@gimp : Th\303\252ta = int(10,1,5000)
#@gimp : Ligne / line = color(0,0,0,255)
#@gimp : Angle inclinaison = float(0,-360,360)
#@gimp : Couleurs al\303\251atoires / random colors = bool(0)
#@gimp : Flou / blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,200)
#@gimp : Ombre / shadow = bool(0)
#@gimp : X-ombre x-shadow = float(0.5,-5,5)
#@gimp : Y-ombre y-shadow = float(0.5,-5,5)
#@gimp : Douceur ombre / smoothness shadow = float(1.8,0,5)
#@gimp : Courbure ombre / curvature shadow = float(0,0,1)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/05</i>.</small>")
samj_Cercles_Qui_Tournent :
Dimension=$1
R_fond=$2
V_fond=$3
B_fond=$4
A_fond=$5
Exemples=$6
Cax=$7
Cbx=$8
Ccx=$9
Vbx=$10
Vcx=$11
Cay=$12
Cby=$13
Ccy=$14
Vby=$15
Vcy=$16
Egalite_Param_X_Y=$17
Theta=$18
R_a=$19
V_a=$20
B_a=$21
A_a=$22
Angle_Rotation=$23
Couleurs_aleatoires=$24
Flou=$25
Dilatation=$26
Deformation=$27
Bruit=$28
Ombre=$29
X_Ombre=$30
Y_Ombre=$31
Smoothness_Ombre=$32
Curvature_Ombre=$33
-if {$Exemples==1}
Egalite_Param_X_Y=1
Cax=1
Cbx=0.5
Ccx=0.25
Vbx=7
Vcx=21
Theta=1000
-elif {$Exemples==2}
Egalite_Param_X_Y=1
Cax=1
Cbx=5
Ccx=2
Vbx=3
Vcx=10
Theta=4693
-elif {$Exemples==3}
Egalite_Param_X_Y=0
Cax=1
Cbx=0.5
Ccx=0.33
Vbx=7
Vcx=17
Cay=1
Cby=0.5
Ccy=0.33
Vby=11
Vcy=17
Theta=4886
-elif {$Exemples==4}
Egalite_Param_X_Y=0
Cax=1
Cbx=0.5
Ccx=0.33
Vbx=7
Vcx=17
Cay=1
Cby=0.5
Ccy=0.33
Vby=7
Vcy=3
Theta=4520
-elif {$Exemples==5}
Egalite_Param_X_Y=0
Cax=1
Cbx=0.5
Ccx=0.25
Vbx=1
Vcx=6
Cay=0.8
Cby=0.2
Ccy=1
Vby=9
Vcy=12
Theta=493
-elif {$Exemples==6}
Egalite_Param_X_Y=1
Cax=1
Cbx=0.5
Ccx=0.33
Vbx=-5
Vcx=17
Theta=10
-endif
-if {$Egalite_Param_X_Y==1}
Cay=$Cax
Cby=$Cbx
Ccy=$Ccx
Vby=$Vbx
Vcy=$Vcx
-endif
-rm[-1]
$Dimension,$Dimension,1,4
-fill_color[-1] 0,0,0,0
# tracer la courbe en couleur noire sans Antialiasing , sans Decoration ,   X(t) :  cos(t)+(0.5*cos(7*t))+((cos((3.14/2)-(17*t)))/3)  ,  Y(t) :  (sin(t)+(0.5*sin(7*t))+((sin((3.14/2)-(17*t)))/3)
-gimp_equation_parametric[-1] "(cos(t)*"$Cax")+("$Cbx"*cos("$Vbx"*t))+((cos(("{pi/2}")-("$Vcx"*t)))*"$Ccx")","(sin(t)*"$Cay")+("$Cby"*sin("$Vby"*t))+((sin(("{pi/2}")-("$Vcy"*t)))*"$Ccy")",0,$Theta,$Dimension,1,1,0,0,0,0,0,0,1,0,0
-to_rgba[-1]
-replace_color[-1] 100%,0,255,255,255,255,0,0,0,0
-replace_color[-1] 100%,0,0,0,0,255,$R_a,$V_a,$B_a,$A_a
-if {$Couleurs_aleatoires==0}
-replace_color[-1] 100%,0,0,0,0,255,$R_a,$V_a,$B_a,$A_a
-else
$Dimension,$Dimension,1,4
-fill_color[-1] 0,0,0,0
-gimp_corner_gradient[-1] {round(?(0,255))},{round(?(0,255))},{round(?(0,255))},255,{round(?(0,255))},{round(?(0,255))},{round(?(0,255))},255,{round(?(0,255))},{round(?(0,255))},{round(?(0,255))},255,{round(?(0,255))},{round(?(0,255))},{round(?(0,255))},255
-blend[-1,-2] add,1,0
-to_rgba[-1]
-endif
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Ombre>0}
-drop_shadow[-1] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-endif
-if {$Angle_Rotation>0} -rotate[-1] $Angle_Rotation,1,0,{$Dimension/2},{$Dimension/2} -endif
$Dimension,$Dimension,1,4
-fill_color[-1] $R_fond,$V_fond,$B_fond,$A_fond
-if {$Bruit>0} -apply_channels_old[-1] "-gimp_noise "$Bruit",0,22,1",1 -endif
#-blend[-2,-1] alpha,1,1
-gimp_blend[-2,-1] 1,0,1,0,1
#@gimp Simple geometric shapes : samj_Formes_Geometriques_Simples, samj_Formes_Geometriques_Simples(1)
#@gimp : Sep = separator(), note = note("<span foreground="black">Formes G\303\251ometriques Simples / Simple Geometric Shapes</span>")
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Effet</small></span>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Couleur externe / external color = color(127,127,127,127)
#@gimp : Couleur interne / interior color = color(255,255,0,255)
#@gimp : Couleur / color contour = color(0,0,255,255)
#@gimp : Forme / shape = choice(5,"Polygone Inscrit Dimension 1","Polygone Inscrit Dimension 2","Cercle / Ellipse","Etoile Star Dimension 1","Etoile Star Dimension 2","Polygone Etoile Star Dimension 1","Polygone Etoile Star Dimension 2")
#@gimp : Dimension 1  (% width) = float(40,0,400)
#@gimp : Dimension 2  (% height) = float(40,0,400)
#@gimp : Nb c\303\264t\303\251s / number of sides = int(4,3,26)
#@gimp : Angle inclinaison / tilt = float(0,0,120)
#@gimp : Dilate = int(0,0,48)
#@gimp : Blend = bool(1)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/09</i>.</small>")
samj_Formes_Geometriques_Simples :
X_Position={round({{w}*{$1/100}})}
Y_Position={round({{h}*{$2/100}})}
R_Externe=$3
V_Externe=$4
B_Externe=$5
A_Externe=$6
R_Interne=$7
V_Interne=$8
B_Interne=$9
A_Interne=$10
R_Contour=$11
V_Contour=$12
B_Contour=$13
A_Contour=$14
Forme=$15
Dimension_Un={round({{w}*{$16/100}})}
Dimension_Deux={round({{h}*{$17/100}})}
Nb_Cotes=$18
Angle_Inclinaison=$19
Dilatation=$20
Melange=$21
Largeur_Origine={w}
Hauteur_Origine={h}
Valeur_Angle=0
Nb_Boucles=0
Rayon_Cercle_Circonscrit=0
-if {$Forme==0}
Rayon_Cercle_Circonscrit=$Dimension_Un
-elif {$Forme==1}
Rayon_Cercle_Circonscrit=$Dimension_Deux
-elif {$Forme==3}
Rayon_Cercle_Circonscrit=$Dimension_Un
-if {$Nb_Cotes<5} Nb_Cotes=5 -endif
-elif {$Forme==4}
Rayon_Cercle_Circonscrit=$Dimension_Deux
-if {$Nb_Cotes<5} Nb_Cotes=5 -endif
-elif {$Forme==5}
Rayon_Cercle_Circonscrit=$Dimension_Un
-if {$Nb_Cotes<5} Nb_Cotes=5 -endif
-elif {$Forme==6}
Rayon_Cercle_Circonscrit=$Dimension_Deux
-if {$Nb_Cotes<5} Nb_Cotes=5 -endif
-endif
-if {$Melange==0}
-rm[-1]
-else
-to_rgba[-1]
-endif
$Largeur_Origine,$Hauteur_Origine,1,4
-fill_color[-1] $R_Externe,$V_Externe,$B_Externe,$A_Externe
-if {$Forme==2}
-ellipse[-1] $X_Position,$Y_Position,$Dimension_Un,$Dimension_Deux,$Angle_Inclinaison,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-ellipse[-1] $X_Position,$Y_Position,$Dimension_Un,$Dimension_Deux,$Angle_Inclinaison,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-else
-repeat $Nb_Cotes
Nb_Boucles={$Nb_Boucles+1}
-if {$Nb_Boucles==1}
X_a={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_a={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==2}
X_b={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_b={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==3}
X_c={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_c={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==4}
X_d={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_d={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==5}
X_e={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_e={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==6}
X_f={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_f={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==7}
X_g={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_g={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==8}
X_h={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_h={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==9}
X_i={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_i={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==10}
X_j={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_j={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==11}
X_k={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_k={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==12}
X_l={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_l={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==13}
X_m={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_m={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==14}
X_n={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_n={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==15}
X_o={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_o={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==16}
X_p={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_p={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==17}
X_q={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_q={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==18}
X_r={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_r={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==19}
X_s={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_s={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==20}
X_t={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_t={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==21}
X_u={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_u={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==22}
X_v={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_v={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==23}
X_w={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_w={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==24}
X_x={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_x={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==25}
X_y={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_y={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-elif {$Nb_Boucles==26}
X_z={$X_Position+{round({$Rayon_Cercle_Circonscrit*{cos({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
Y_z={$Y_Position+{round({$Rayon_Cercle_Circonscrit*{sin({pi/180*{$Valeur_Angle+$Angle_Inclinaison+{360/$Nb_Cotes}}})}})}}
-endif
Valeur_Angle={$Valeur_Angle+{360/$Nb_Cotes}}
-done
-endif
-if {$Forme==0||$Forme==1}
-if {$Nb_Cotes==3}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==4}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==5}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==6}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==7}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==8}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==9}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==10}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==11}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==12}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==13}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==14}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==15}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==16}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==17}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==18}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==19}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==20}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==21}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==22}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,$X_v,$Y_v,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,$X_v,$Y_v,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==23}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,$X_v,$Y_v,$X_w,$Y_w,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,$X_v,$Y_v,$X_w,$Y_w,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==24}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,$X_v,$Y_v,$X_w,$Y_w,$X_x,$Y_x,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,$X_v,$Y_v,$X_w,$Y_w,$X_x,$Y_x,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==25}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,$X_v,$Y_v,$X_w,$Y_w,$X_x,$Y_x,$X_y,$Y_y,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,$X_v,$Y_v,$X_w,$Y_w,$X_x,$Y_x,$X_y,$Y_y,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==26}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,$X_v,$Y_v,$X_w,$Y_w,$X_x,$Y_x,$X_y,$Y_y,$X_z,$Y_z,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,$X_v,$Y_v,$X_w,$Y_w,$X_x,$Y_x,$X_y,$Y_y,$X_z,$Y_z,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-endif
-endif
-if {$Forme==3||$Forme==4}
# Etoiles Impaires
-if {$Nb_Cotes==5}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_c,$Y_c,$X_e,$Y_e,$X_b,$Y_b,$X_d,$Y_d,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_c,$Y_c,$X_e,$Y_e,$X_b,$Y_b,$X_d,$Y_d,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==7}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_d,$Y_d,$X_g,$Y_g,$X_c,$Y_c,$X_f,$Y_f,$X_b,$Y_b,$X_e,$Y_e,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_d,$Y_d,$X_g,$Y_g,$X_c,$Y_c,$X_f,$Y_f,$X_b,$Y_b,$X_e,$Y_e,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==9}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_e,$Y_e,$X_i,$Y_i,$X_d,$Y_d,$X_h,$Y_h,$X_c,$Y_c,$X_g,$Y_g,$X_b,$Y_b,$X_f,$Y_f,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_e,$Y_e,$X_i,$Y_i,$X_d,$Y_d,$X_h,$Y_h,$X_c,$Y_c,$X_g,$Y_g,$X_b,$Y_b,$X_f,$Y_f,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==11}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_f,$Y_f,$X_k,$Y_k,$X_e,$Y_e,$X_j,$Y_j,$X_d,$Y_d,$X_i,$Y_i,$X_c,$Y_c,$X_h,$Y_h,$X_b,$Y_b,$X_g,$Y_g,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_f,$Y_f,$X_k,$Y_k,$X_e,$Y_e,$X_j,$Y_j,$X_d,$Y_d,$X_i,$Y_i,$X_c,$Y_c,$X_h,$Y_h,$X_b,$Y_b,$X_g,$Y_g,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==13}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_g,$Y_g,$X_m,$Y_m,$X_f,$Y_f,$X_l,$Y_l,$X_e,$Y_e,$X_k,$Y_k,$X_d,$Y_d,$X_j,$Y_j,$X_c,$Y_c,$X_i,$Y_i,$X_b,$Y_b,$X_h,$Y_h,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_g,$Y_g,$X_m,$Y_m,$X_f,$Y_f,$X_l,$Y_l,$X_e,$Y_e,$X_k,$Y_k,$X_d,$Y_d,$X_j,$Y_j,$X_c,$Y_c,$X_i,$Y_i,$X_b,$Y_b,$X_h,$Y_h,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==15}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_h,$Y_h,$X_o,$Y_o,$X_g,$Y_g,$X_n,$Y_n,$X_f,$Y_f,$X_m,$Y_m,$X_e,$Y_e,$X_l,$Y_l,$X_d,$Y_d,$X_k,$Y_k,$X_c,$Y_c,$X_j,$Y_j,$X_b,$Y_b,$X_i,$Y_i,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_h,$Y_h,$X_o,$Y_o,$X_g,$Y_g,$X_n,$Y_n,$X_f,$Y_f,$X_m,$Y_m,$X_e,$Y_e,$X_l,$Y_l,$X_d,$Y_d,$X_k,$Y_k,$X_c,$Y_c,$X_j,$Y_j,$X_b,$Y_b,$X_i,$Y_i,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==17}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_i,$Y_i,$X_q,$Y_q,$X_h,$Y_h,$X_p,$Y_p,$X_g,$Y_g,$X_o,$Y_o,$X_f,$Y_f,$X_n,$Y_n,$X_e,$Y_e,$X_m,$Y_m,$X_d,$Y_d,$X_l,$Y_l,$X_c,$Y_c,$X_k,$Y_k,$X_b,$Y_b,$X_j,$Y_j,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_i,$Y_i,$X_q,$Y_q,$X_h,$Y_h,$X_p,$Y_p,$X_g,$Y_g,$X_o,$Y_o,$X_f,$Y_f,$X_n,$Y_n,$X_e,$Y_e,$X_m,$Y_m,$X_d,$Y_d,$X_l,$Y_l,$X_c,$Y_c,$X_k,$Y_k,$X_b,$Y_b,$X_j,$Y_j,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==19}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_j,$Y_j,$X_s,$Y_s,$X_i,$Y_i,$X_r,$Y_r,$X_h,$Y_h,$X_q,$Y_q,$X_g,$Y_g,$X_p,$Y_p,$X_f,$Y_f,$X_o,$Y_o,$X_e,$Y_e,$X_n,$Y_n,$X_d,$Y_d,$X_m,$Y_m,$X_c,$Y_c,$X_l,$Y_l,$X_b,$Y_b,$X_k,$Y_k,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_j,$Y_j,$X_s,$Y_s,$X_i,$Y_i,$X_r,$Y_r,$X_h,$Y_h,$X_q,$Y_q,$X_g,$Y_g,$X_p,$Y_p,$X_f,$Y_f,$X_o,$Y_o,$X_e,$Y_e,$X_n,$Y_n,$X_d,$Y_d,$X_m,$Y_m,$X_c,$Y_c,$X_l,$Y_l,$X_b,$Y_b,$X_k,$Y_k,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==21}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_k,$Y_k,$X_u,$Y_u,$X_j,$Y_j,$X_t,$Y_t,$X_i,$Y_i,$X_s,$Y_s,$X_h,$Y_h,$X_r,$Y_r,$X_g,$Y_g,$X_q,$Y_q,$X_f,$Y_f,$X_p,$Y_p,$X_e,$Y_e,$X_o,$Y_o,$X_d,$Y_d,$X_n,$Y_n,$X_c,$Y_c,$X_m,$Y_m,$X_b,$Y_b,$X_l,$Y_l,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_k,$Y_k,$X_u,$Y_u,$X_j,$Y_j,$X_t,$Y_t,$X_i,$Y_i,$X_s,$Y_s,$X_h,$Y_h,$X_r,$Y_r,$X_g,$Y_g,$X_q,$Y_q,$X_f,$Y_f,$X_p,$Y_p,$X_e,$Y_e,$X_o,$Y_o,$X_d,$Y_d,$X_n,$Y_n,$X_c,$Y_c,$X_m,$Y_m,$X_b,$Y_b,$X_l,$Y_l,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==23}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_l,$Y_l,$X_w,$Y_w,$X_k,$Y_k,$X_v,$Y_v,$X_j,$Y_j,$X_u,$Y_u,$X_i,$Y_i,$X_t,$Y_t,$X_h,$Y_h,$X_s,$Y_s,$X_g,$Y_g,$X_r,$Y_r,$X_f,$Y_f,$X_q,$Y_q,$X_e,$Y_e,$X_p,$Y_p,$X_d,$Y_d,$X_o,$Y_o,$X_c,$Y_c,$X_n,$Y_n,$X_b,$Y_b,$X_m,$Y_m,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_l,$Y_l,$X_w,$Y_w,$X_k,$Y_k,$X_v,$Y_v,$X_j,$Y_j,$X_u,$Y_u,$X_i,$Y_i,$X_t,$Y_t,$X_h,$Y_h,$X_s,$Y_s,$X_g,$Y_g,$X_r,$Y_r,$X_f,$Y_f,$X_q,$Y_q,$X_e,$Y_e,$X_p,$Y_p,$X_d,$Y_d,$X_o,$Y_o,$X_c,$Y_c,$X_n,$Y_n,$X_b,$Y_b,$X_m,$Y_m,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==25}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_m,$Y_m,$X_y,$Y_y,$X_l,$Y_l,$X_x,$Y_x,$X_k,$Y_k,$X_w,$Y_w,$X_j,$Y_j,$X_v,$Y_v,$X_i,$Y_i,$X_u,$Y_u,$X_h,$Y_h,$X_t,$Y_t,$X_g,$Y_g,$X_s,$Y_s,$X_f,$Y_f,$X_r,$Y_r,$X_e,$Y_e,$X_q,$Y_q,$X_d,$Y_d,$X_p,$Y_p,$X_c,$Y_c,$X_o,$Y_o,$X_b,$Y_b,$X_n,$Y_n,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_m,$Y_m,$X_y,$Y_y,$X_l,$Y_l,$X_x,$Y_x,$X_k,$Y_k,$X_w,$Y_w,$X_j,$Y_j,$X_v,$Y_v,$X_i,$Y_i,$X_u,$Y_u,$X_h,$Y_h,$X_t,$Y_t,$X_g,$Y_g,$X_s,$Y_s,$X_f,$Y_f,$X_r,$Y_r,$X_e,$Y_e,$X_q,$Y_q,$X_d,$Y_d,$X_p,$Y_p,$X_c,$Y_c,$X_o,$Y_o,$X_b,$Y_b,$X_n,$Y_n,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
# toiles Paires
-elif {$Nb_Cotes==6}
-polygon[-1] {$Nb_Cotes/2},$X_a,$Y_a,$X_c,$Y_c,$X_e,$Y_e,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] {$Nb_Cotes/2},$X_b,$Y_b,$X_d,$Y_d,$X_f,$Y_f,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] {$Nb_Cotes/2},$X_a,$Y_a,$X_c,$Y_c,$X_e,$Y_e,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] {$Nb_Cotes/2},$X_b,$Y_b,$X_d,$Y_d,$X_f,$Y_f,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==8}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_d,$Y_d,$X_g,$Y_g,$X_b,$Y_b,$X_e,$Y_e,$X_h,$Y_h,$X_c,$Y_c,$X_f,$Y_f,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_d,$Y_d,$X_g,$Y_g,$X_b,$Y_b,$X_e,$Y_e,$X_h,$Y_h,$X_c,$Y_c,$X_f,$Y_f,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==10}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_h,$Y_h,$X_e,$Y_e,$X_b,$Y_b,$X_i,$Y_i,$X_f,$Y_f,$X_c,$Y_c,$X_j,$Y_j,$X_g,$Y_g,$X_d,$Y_d,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_h,$Y_h,$X_e,$Y_e,$X_b,$Y_b,$X_i,$Y_i,$X_f,$Y_f,$X_c,$Y_c,$X_j,$Y_j,$X_g,$Y_g,$X_d,$Y_d,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==12}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_f,$Y_f,$X_k,$Y_k,$X_d,$Y_d,$X_i,$Y_i,$X_b,$Y_b,$X_g,$Y_g,$X_l,$Y_l,$X_e,$Y_e,$X_j,$Y_j,$X_c,$Y_c,$X_h,$Y_h,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_f,$Y_f,$X_k,$Y_k,$X_d,$Y_d,$X_i,$Y_i,$X_b,$Y_b,$X_g,$Y_g,$X_l,$Y_l,$X_e,$Y_e,$X_j,$Y_j,$X_c,$Y_c,$X_h,$Y_h,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==14}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_j,$Y_j,$X_e,$Y_e,$X_n,$Y_n,$X_i,$Y_i,$X_d,$Y_d,$X_m,$Y_m,$X_h,$Y_h,$X_c,$Y_c,$X_l,$Y_l,$X_g,$Y_g,$X_b,$Y_b,$X_k,$Y_k,$X_f,$Y_f,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_j,$Y_j,$X_e,$Y_e,$X_n,$Y_n,$X_i,$Y_i,$X_d,$Y_d,$X_m,$Y_m,$X_h,$Y_h,$X_c,$Y_c,$X_l,$Y_l,$X_g,$Y_g,$X_b,$Y_b,$X_k,$Y_k,$X_f,$Y_f,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==16}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_h,$Y_h,$X_o,$Y_o,$X_f,$Y_f,$X_m,$Y_m,$X_d,$Y_d,$X_k,$Y_k,$X_b,$Y_b,$X_i,$Y_i,$X_p,$Y_p,$X_g,$Y_g,$X_n,$Y_n,$X_e,$Y_e,$X_l,$Y_l,$X_c,$Y_c,$X_j,$Y_j,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_h,$Y_h,$X_o,$Y_o,$X_f,$Y_f,$X_m,$Y_m,$X_d,$Y_d,$X_k,$Y_k,$X_b,$Y_b,$X_i,$Y_i,$X_p,$Y_p,$X_g,$Y_g,$X_n,$Y_n,$X_e,$Y_e,$X_l,$Y_l,$X_c,$Y_c,$X_j,$Y_j,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==18}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_h,$Y_h,$X_o,$Y_o,$X_d,$Y_d,$X_k,$Y_k,$X_r,$Y_r,$X_g,$Y_g,$X_n,$Y_n,$X_c,$Y_c,$X_j,$Y_j,$X_q,$Y_q,$X_f,$Y_f,$X_m,$Y_m,$X_b,$Y_b,$X_i,$Y_i,$X_p,$Y_p,$X_e,$Y_e,$X_l,$Y_l,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_h,$Y_h,$X_o,$Y_o,$X_d,$Y_d,$X_k,$Y_k,$X_r,$Y_r,$X_g,$Y_g,$X_n,$Y_n,$X_c,$Y_c,$X_j,$Y_j,$X_q,$Y_q,$X_f,$Y_f,$X_m,$Y_m,$X_b,$Y_b,$X_i,$Y_i,$X_p,$Y_p,$X_e,$Y_e,$X_l,$Y_l,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==20}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_j,$Y_j,$X_s,$Y_s,$X_h,$Y_h,$X_q,$Y_q,$X_f,$Y_f,$X_o,$Y_o,$X_d,$Y_d,$X_m,$Y_m,$X_b,$Y_b,$X_k,$Y_k,$X_t,$Y_t,$X_i,$Y_i,$X_r,$Y_r,$X_g,$Y_g,$X_p,$Y_p,$X_e,$Y_e,$X_n,$Y_n,$X_c,$Y_c,$X_l,$Y_l,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_j,$Y_j,$X_s,$Y_s,$X_h,$Y_h,$X_q,$Y_q,$X_f,$Y_f,$X_o,$Y_o,$X_d,$Y_d,$X_m,$Y_m,$X_b,$Y_b,$X_k,$Y_k,$X_t,$Y_t,$X_i,$Y_i,$X_r,$Y_r,$X_g,$Y_g,$X_p,$Y_p,$X_e,$Y_e,$X_n,$Y_n,$X_c,$Y_c,$X_l,$Y_l,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==22}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_j,$Y_j,$X_s,$Y_s,$X_f,$Y_f,$X_o,$Y_o,$X_b,$Y_b,$X_k,$Y_k,$X_t,$Y_t,$X_g,$Y_g,$X_p,$Y_p,$X_c,$Y_c,$X_l,$Y_l,$X_u,$Y_u,$X_h,$Y_h,$X_q,$Y_q,$X_d,$Y_d,$X_m,$Y_m,$X_v,$Y_v,$X_i,$Y_i,$X_r,$Y_r,$X_e,$Y_e,$X_n,$Y_n,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_j,$Y_j,$X_s,$Y_s,$X_f,$Y_f,$X_o,$Y_o,$X_b,$Y_b,$X_k,$Y_k,$X_t,$Y_t,$X_g,$Y_g,$X_p,$Y_p,$X_c,$Y_c,$X_l,$Y_l,$X_u,$Y_u,$X_h,$Y_h,$X_q,$Y_q,$X_d,$Y_d,$X_m,$Y_m,$X_v,$Y_v,$X_i,$Y_i,$X_r,$Y_r,$X_e,$Y_e,$X_n,$Y_n,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==24}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_l,$Y_l,$X_w,$Y_w,$X_j,$Y_j,$X_u,$Y_u,$X_h,$Y_h,$X_s,$Y_s,$X_f,$Y_f,$X_q,$Y_q,$X_d,$Y_d,$X_o,$Y_o,$X_b,$Y_b,$X_m,$Y_m,$X_x,$Y_x,$X_k,$Y_k,$X_v,$Y_v,$X_i,$Y_i,$X_t,$Y_t,$X_g,$Y_g,$X_r,$Y_r,$X_e,$Y_e,$X_p,$Y_p,$X_c,$Y_c,$X_n,$Y_n,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_l,$Y_l,$X_w,$Y_w,$X_j,$Y_j,$X_u,$Y_u,$X_h,$Y_h,$X_s,$Y_s,$X_f,$Y_f,$X_q,$Y_q,$X_d,$Y_d,$X_o,$Y_o,$X_b,$Y_b,$X_m,$Y_m,$X_x,$Y_x,$X_k,$Y_k,$X_v,$Y_v,$X_i,$Y_i,$X_t,$Y_t,$X_g,$Y_g,$X_r,$Y_r,$X_e,$Y_e,$X_p,$Y_p,$X_c,$Y_c,$X_n,$Y_n,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-elif {$Nb_Cotes==26}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_l,$Y_l,$X_w,$Y_w,$X_h,$Y_h,$X_s,$Y_s,$X_d,$Y_d,$X_o,$Y_o,$X_z,$Y_z,$X_k,$Y_k,$X_v,$Y_v,$X_g,$Y_g,$X_r,$Y_r,$X_c,$Y_c,$X_n,$Y_n,$X_y,$Y_y,$X_j,$Y_j,$X_u,$Y_u,$X_f,$Y_f,$X_q,$Y_q,$X_b,$Y_b,$X_m,$Y_m,$X_x,$Y_x,$X_i,$Y_i,$X_t,$Y_t,$X_e,$Y_e,$X_p,$Y_p,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_l,$Y_l,$X_w,$Y_w,$X_h,$Y_h,$X_s,$Y_s,$X_d,$Y_d,$X_o,$Y_o,$X_z,$Y_z,$X_k,$Y_k,$X_v,$Y_v,$X_g,$Y_g,$X_r,$Y_r,$X_c,$Y_c,$X_n,$Y_n,$X_y,$Y_y,$X_j,$Y_j,$X_u,$Y_u,$X_f,$Y_f,$X_q,$Y_q,$X_b,$Y_b,$X_m,$Y_m,$X_x,$Y_x,$X_i,$Y_i,$X_t,$Y_t,$X_e,$Y_e,$X_p,$Y_p,1,0xFFFFFFFF,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-endif
-endif
-if {$Forme==5||$Forme==6}
# Polygones + toiles Impaires
-if {$Nb_Cotes==5}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_c,$Y_c,$X_e,$Y_e,$X_b,$Y_b,$X_d,$Y_d,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==7}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_d,$Y_d,$X_g,$Y_g,$X_c,$Y_c,$X_f,$Y_f,$X_b,$Y_b,$X_e,$Y_e,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==9}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_e,$Y_e,$X_i,$Y_i,$X_d,$Y_d,$X_h,$Y_h,$X_c,$Y_c,$X_g,$Y_g,$X_b,$Y_b,$X_f,$Y_f,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==11}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_f,$Y_f,$X_k,$Y_k,$X_e,$Y_e,$X_j,$Y_j,$X_d,$Y_d,$X_i,$Y_i,$X_c,$Y_c,$X_h,$Y_h,$X_b,$Y_b,$X_g,$Y_g,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==13}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_g,$Y_g,$X_m,$Y_m,$X_f,$Y_f,$X_l,$Y_l,$X_e,$Y_e,$X_k,$Y_k,$X_d,$Y_d,$X_j,$Y_j,$X_c,$Y_c,$X_i,$Y_i,$X_b,$Y_b,$X_h,$Y_h,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==15}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_h,$Y_h,$X_o,$Y_o,$X_g,$Y_g,$X_n,$Y_n,$X_f,$Y_f,$X_m,$Y_m,$X_e,$Y_e,$X_l,$Y_l,$X_d,$Y_d,$X_k,$Y_k,$X_c,$Y_c,$X_j,$Y_j,$X_b,$Y_b,$X_i,$Y_i,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==17}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_i,$Y_i,$X_q,$Y_q,$X_h,$Y_h,$X_p,$Y_p,$X_g,$Y_g,$X_o,$Y_o,$X_f,$Y_f,$X_n,$Y_n,$X_e,$Y_e,$X_m,$Y_m,$X_d,$Y_d,$X_l,$Y_l,$X_c,$Y_c,$X_k,$Y_k,$X_b,$Y_b,$X_j,$Y_j,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==19}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_j,$Y_j,$X_s,$Y_s,$X_i,$Y_i,$X_r,$Y_r,$X_h,$Y_h,$X_q,$Y_q,$X_g,$Y_g,$X_p,$Y_p,$X_f,$Y_f,$X_o,$Y_o,$X_e,$Y_e,$X_n,$Y_n,$X_d,$Y_d,$X_m,$Y_m,$X_c,$Y_c,$X_l,$Y_l,$X_b,$Y_b,$X_k,$Y_k,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==21}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_k,$Y_k,$X_u,$Y_u,$X_j,$Y_j,$X_t,$Y_t,$X_i,$Y_i,$X_s,$Y_s,$X_h,$Y_h,$X_r,$Y_r,$X_g,$Y_g,$X_q,$Y_q,$X_f,$Y_f,$X_p,$Y_p,$X_e,$Y_e,$X_o,$Y_o,$X_d,$Y_d,$X_n,$Y_n,$X_c,$Y_c,$X_m,$Y_m,$X_b,$Y_b,$X_l,$Y_l,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==23}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,$X_v,$Y_v,$X_w,$Y_w,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_l,$Y_l,$X_w,$Y_w,$X_k,$Y_k,$X_v,$Y_v,$X_j,$Y_j,$X_u,$Y_u,$X_i,$Y_i,$X_t,$Y_t,$X_h,$Y_h,$X_s,$Y_s,$X_g,$Y_g,$X_r,$Y_r,$X_f,$Y_f,$X_q,$Y_q,$X_e,$Y_e,$X_p,$Y_p,$X_d,$Y_d,$X_o,$Y_o,$X_c,$Y_c,$X_n,$Y_n,$X_b,$Y_b,$X_m,$Y_m,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==25}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,$X_v,$Y_v,$X_w,$Y_w,$X_x,$Y_x,$X_y,$Y_y,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_m,$Y_m,$X_y,$Y_y,$X_l,$Y_l,$X_x,$Y_x,$X_k,$Y_k,$X_w,$Y_w,$X_j,$Y_j,$X_v,$Y_v,$X_i,$Y_i,$X_u,$Y_u,$X_h,$Y_h,$X_t,$Y_t,$X_g,$Y_g,$X_s,$Y_s,$X_f,$Y_f,$X_r,$Y_r,$X_e,$Y_e,$X_q,$Y_q,$X_d,$Y_d,$X_p,$Y_p,$X_c,$Y_c,$X_o,$Y_o,$X_b,$Y_b,$X_n,$Y_n,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
# Polygones + toiles Paires
-elif {$Nb_Cotes==6}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] {$Nb_Cotes/2},$X_a,$Y_a,$X_c,$Y_c,$X_e,$Y_e,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-polygon[-1] {$Nb_Cotes/2},$X_b,$Y_b,$X_d,$Y_d,$X_f,$Y_f,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==8}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_d,$Y_d,$X_g,$Y_g,$X_b,$Y_b,$X_e,$Y_e,$X_h,$Y_h,$X_c,$Y_c,$X_f,$Y_f,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==10}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_h,$Y_h,$X_e,$Y_e,$X_b,$Y_b,$X_i,$Y_i,$X_f,$Y_f,$X_c,$Y_c,$X_j,$Y_j,$X_g,$Y_g,$X_d,$Y_d,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==12}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_f,$Y_f,$X_k,$Y_k,$X_d,$Y_d,$X_i,$Y_i,$X_b,$Y_b,$X_g,$Y_g,$X_l,$Y_l,$X_e,$Y_e,$X_j,$Y_j,$X_c,$Y_c,$X_h,$Y_h,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==14}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_j,$Y_j,$X_e,$Y_e,$X_n,$Y_n,$X_i,$Y_i,$X_d,$Y_d,$X_m,$Y_m,$X_h,$Y_h,$X_c,$Y_c,$X_l,$Y_l,$X_g,$Y_g,$X_b,$Y_b,$X_k,$Y_k,$X_f,$Y_f,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==16}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_h,$Y_h,$X_o,$Y_o,$X_f,$Y_f,$X_m,$Y_m,$X_d,$Y_d,$X_k,$Y_k,$X_b,$Y_b,$X_i,$Y_i,$X_p,$Y_p,$X_g,$Y_g,$X_n,$Y_n,$X_e,$Y_e,$X_l,$Y_l,$X_c,$Y_c,$X_j,$Y_j,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==18}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_h,$Y_h,$X_o,$Y_o,$X_d,$Y_d,$X_k,$Y_k,$X_r,$Y_r,$X_g,$Y_g,$X_n,$Y_n,$X_c,$Y_c,$X_j,$Y_j,$X_q,$Y_q,$X_f,$Y_f,$X_m,$Y_m,$X_b,$Y_b,$X_i,$Y_i,$X_p,$Y_p,$X_e,$Y_e,$X_l,$Y_l,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==20}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_j,$Y_j,$X_s,$Y_s,$X_h,$Y_h,$X_q,$Y_q,$X_f,$Y_f,$X_o,$Y_o,$X_d,$Y_d,$X_m,$Y_m,$X_b,$Y_b,$X_k,$Y_k,$X_t,$Y_t,$X_i,$Y_i,$X_r,$Y_r,$X_g,$Y_g,$X_p,$Y_p,$X_e,$Y_e,$X_n,$Y_n,$X_c,$Y_c,$X_l,$Y_l,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==22}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,$X_v,$Y_v,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_j,$Y_j,$X_s,$Y_s,$X_f,$Y_f,$X_o,$Y_o,$X_b,$Y_b,$X_k,$Y_k,$X_t,$Y_t,$X_g,$Y_g,$X_p,$Y_p,$X_c,$Y_c,$X_l,$Y_l,$X_u,$Y_u,$X_h,$Y_h,$X_q,$Y_q,$X_d,$Y_d,$X_m,$Y_m,$X_v,$Y_v,$X_i,$Y_i,$X_r,$Y_r,$X_e,$Y_e,$X_n,$Y_n,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==24}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,$X_v,$Y_v,$X_w,$Y_w,$X_x,$Y_x,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_l,$Y_l,$X_w,$Y_w,$X_j,$Y_j,$X_u,$Y_u,$X_h,$Y_h,$X_s,$Y_s,$X_f,$Y_f,$X_q,$Y_q,$X_d,$Y_d,$X_o,$Y_o,$X_b,$Y_b,$X_m,$Y_m,$X_x,$Y_x,$X_k,$Y_k,$X_v,$Y_v,$X_i,$Y_i,$X_t,$Y_t,$X_g,$Y_g,$X_r,$Y_r,$X_e,$Y_e,$X_p,$Y_p,$X_c,$Y_c,$X_n,$Y_n,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-elif {$Nb_Cotes==26}
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_b,$Y_b,$X_c,$Y_c,$X_d,$Y_d,$X_e,$Y_e,$X_f,$Y_f,$X_g,$Y_g,$X_h,$Y_h,$X_i,$Y_i,$X_j,$Y_j,$X_k,$Y_k,$X_l,$Y_l,$X_m,$Y_m,$X_n,$Y_n,$X_o,$Y_o,$X_p,$Y_p,$X_q,$Y_q,$X_r,$Y_r,$X_s,$Y_s,$X_t,$Y_t,$X_u,$Y_u,$X_v,$Y_v,$X_w,$Y_w,$X_x,$Y_x,$X_y,$Y_y,$X_z,$Y_z,1,$R_Contour,$V_Contour,$B_Contour,$A_Contour
-polygon[-1] $Nb_Cotes,$X_a,$Y_a,$X_l,$Y_l,$X_w,$Y_w,$X_h,$Y_h,$X_s,$Y_s,$X_d,$Y_d,$X_o,$Y_o,$X_z,$Y_z,$X_k,$Y_k,$X_v,$Y_v,$X_g,$Y_g,$X_r,$Y_r,$X_c,$Y_c,$X_n,$Y_n,$X_y,$Y_y,$X_j,$Y_j,$X_u,$Y_u,$X_f,$Y_f,$X_q,$Y_q,$X_b,$Y_b,$X_m,$Y_m,$X_x,$Y_x,$X_i,$Y_i,$X_t,$Y_t,$X_e,$Y_e,$X_p,$Y_p,1,$R_Interne,$V_Interne,$B_Interne,$A_Interne
-endif
-endif
-if {$Dilatation>1}
-dilate_circ[-1] $Dilatation
-endif
#-text_outline[-1] $X_Position,10,10,32,1,1,255,255,255
#-text_outline[-1] $Y_Position,10,35,32,1,1,255,255,255
#-text_outline[-1] $Dimension_Un,10,60,32,1,1,255,255,255
#-text_outline[-1] $Dimension_Deux,10,85,32,1,1,255,255,255
#-text_outline[-1] $Nb_Cotes,10,110,32,1,1,255,255,255
#-text_outline[-1] $Angle_Inclinaison,10,135,32,1,1,255,255,255
-if {$Melange==1}
-blend[-1,-2] alpha,1,0
-endif
#@gimp Spirographe samj : Spirographe_samj, Spirographe_samj(1)
#@gimp : Note = link("http://en.wikipedia.org/wiki/Spirograph")
#@gimp : Sep = separator(), note = note("<small>Centre / Center</small>")
#@gimp : Centre / center x (%) = float(50,0,100)
#@gimp : Centre / center y (%) = float(50,0,100)
#@gimp : Sep = separator(), note = note("<small>Spirographe</small>")
#@gimp : Rayon/radius r (>0 w) (<0 h) = float(200,-500,500)
#@gimp : Rayon/radius r (>0 w) (<0 h) = float(50,-500,500)
#@gimp : Stylo / pen (position) (>0 w) (<0 h) = float(150,-500,500)
#@gimp : Stylo / pen (couleur/color) = color(192,128,64,255)
#@gimp : Stylo / pen (variation de couleur/color variation) = choice("Pas de variation / No change","Couleurs aleatoires / Random colors","Faiblement nuancee / Poorly nuanced","Moyennement nuancee / Moderately nuanced","Fortement nuancee / Highly nuanced")
#@gimp : Stylo / pen (dilate pixels) = int(0,0,32)
#@gimp : Nombre de tours / number of turns = float(3,0.01,20)
#@gimp : Multiplier = choice(0,"Tours / Turns * 1","Tours / Turns * 10 LENT / SLOW","Tours / Turns * 100 TRES LENT / VERY SLOW")
#@gimp : Incr\303\251ment angulaire / angular increment (degr\303\251s) = float(1,1,360)
#@gimp : Diviser / divide = choice(0,"Increment angulaire-Angular increment / 1","Increment angulaire-Angular increment /10 LENT / SLOW","Increment angulaire-Angular increment /100 TRES LENT / VERY SLOW")
#@gimp : Type de rendu / rendering type = choice("Formule/Formula 1","Formule/Formula 2","Formule/Formula 3","Formule/Formula 4","Formule/Formula 5","Formule/Formula 6","Formule/Formula 7","Formule/Formula 8")
#@gimp : Points (rayon/radius) = int(0,0,32)
#@gimp : Points (couleur/color) = color(255,0,0,255)
#@gimp : Lignes (epaisseur/thickness) = int(0,0,32)
#@gimp : Lignes (couleur/color) = color(255,255,0,255)
#@gimp : Sep = separator(), note = note("<small>Divers / Foo</small>")
#@gimp : Flou / blur = float(0,0,10)
#@gimp : Spread = float(0,0,10)
#@gimp : D\303\251formation = float(0,0,25)
#@gimp : Sep = separator(), note = note("<small>M\303\251lange / Blend</small>")
#@gimp : Mode = choice{1,"Add","Alpha","And","Average","Blue","Burn","Darken","Difference",
#@gimp : "Divide","Dodge","Edges","Exclusion","Freeze","Grain extract","Grain merge","Green","Hard light",
#@gimp : "Hard mix","Hue","Interpolation","Lighten","Lightness","Linear burn","Linear light","Luminance",
#@gimp : "Multiply","Negation","Or","Overlay","Pin light","Red","Reflect","Saturation",
#@gimp : "Shape Average","Shape Average0","Soft burn","Soft dodge","Soft light","Screen","Stamp","Subtract","Value",
#@gimp : "Vivid light","Xor"}
#@gimp : Opacit\303\251 / opacity = float(1,0,1)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/15</i>.</small>")
Spirographe_samj :
centre_origine_X={$1/100*w}
centre_origine_Y={$2/100*h}
-if {$3>0}
Rayon_1={{w}*$3/{1000}}
-else
Rayon_1={-{h}*$3/{1000}}
-endif
-if {$4>0}
Rayon_2={{w}*$4/{1000}}
-else
Rayon_2={-{h}*$4/{1000}}
-endif
-if {$5>0}
Position_Stylo={{w}*$5/{1000}}
-else
Position_Stylo={-{h}*$5/{1000}}
-endif
R_Couleur_Stylo=$6
V_Couleur_Stylo=$7
B_Couleur_Stylo=$8
A_Couleur_Stylo=$9
Variation_de_couleur=$10
Dilate_Stylo=$11
Nombre_de_tours=$12
Multiplier_tours=$13
Increment_angulaire=$14
Diviser_Increment_angulaire=$15
Type_de_rendu=$16
Points_Rayon=$17
R_Couleur_Points=$18
V_Couleur_Points=$19
B_Couleur_Points=$20
A_Couleur_Points=$21
Lignes_epaisseur=$22
R_Couleur_Lignes=$23
V_Couleur_Lignes=$24
B_Couleur_Lignes=$25
A_Couleur_Lignes=$26
Flou_Spirographe=$27
Spread_Spirographe=$28
Deform_Spirographe=$29
blend=$30
opacite=$31
Revert_layers=0
-to_rgba
{w},{h},1,4
Nb_Boucle=1
theta=0
Ancien_point_X=0
Nouveau_point_X=0
Ancien_point_Y=0
Nouveau_point_Y=0
-if {$Rayon_2==0}
Rayon_2=1
-endif
-if {$Multiplier_tours==1}
Nombre_de_tours={$Nombre_de_tours*10}
-endif
-if {$Multiplier_tours==2}
Nombre_de_tours={$Nombre_de_tours*100}
-endif
-if {$Diviser_Increment_angulaire==1}
Increment_angulaire={$Increment_angulaire/10}
-endif
-if {$Diviser_Increment_angulaire==2}
Increment_angulaire={$Increment_angulaire/100}
-endif
Nombre_de_tours={$Nombre_de_tours/$Increment_angulaire*360}
R_Couleur_origine=$R_Couleur_Stylo
V_Couleur_origine=$V_Couleur_Stylo
B_Couleur_origine=$B_Couleur_Stylo
A_Couleur_origine=$A_Couleur_Stylo
-if {$Dilate_Stylo>0}
-repeat $Nombre_de_tours
-if {$Variation_de_couleur==1}
R_Couleur_Stylo={round({(?(255))})}
V_Couleur_Stylo={round({(?(255))})}
B_Couleur_Stylo={round({(?(255))})}
-endif
-if {$Variation_de_couleur>1}
Valeur_variation_couleur=16
-if {$Variation_de_couleur==3}
Valeur_variation_couleur=32
-endif
-if {$Variation_de_couleur==4}
Valeur_variation_couleur=64
-endif
R_Couleur_Stylo={round({$R_Couleur_origine+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$R_Couleur_Stylo>255}
R_Couleur_Stylo=$R_Couleur_origine
-endif
-if {$R_Couleur_Stylo<0}
R_Couleur_Stylo=$R_Couleur_origine
-endif
V_Couleur_Stylo={round({$V_Couleur_origine+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$V_Couleur_Stylo>255}
V_Couleur_Stylo=$V_Couleur_origine
-endif
-if {$V_Couleur_Stylo<0}
V_Couleur_Stylo=$V_Couleur_origine
-endif
B_Couleur_Stylo={round({$B_Couleur_origine+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$B_Couleur_Stylo>255}
B_Couleur_Stylo=$B_Couleur_origine
-endif
-if {$B_Couleur_Stylo<0}
B_Couleur_Stylo=$B_Couleur_origine
-endif
-endif
-if {$Type_de_rendu==0}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1+$Rayon_2}*{cos(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{cos({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1+$Rayon_2}*{sin(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{sin({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==1}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1+$Rayon_2}*{cos(pi/180*$theta)}}-{$Position_Stylo*{cos({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1+$Rayon_2}*{sin(pi/180*$theta)}}-{$Position_Stylo*{sin({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==2}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1+$Rayon_2}*{cos(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{cos({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1+$Rayon_2}*{sin(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{sin({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==3}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1+$Rayon_2}*{cos(pi/180*$theta)}}-{$Position_Stylo*{cos({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1+$Rayon_2}*{sin(pi/180*$theta)}}-{$Position_Stylo*{sin({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==4}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1-$Rayon_2}*{cos(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{cos({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1-$Rayon_2}*{sin(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{sin({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==5}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1-$Rayon_2}*{cos(pi/180*$theta)}}-{$Position_Stylo*{cos({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1-$Rayon_2}*{sin(pi/180*$theta)}}-{$Position_Stylo*{sin({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==6}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1-$Rayon_2}*{cos(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{cos({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1-$Rayon_2}*{sin(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{sin({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==7}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1-$Rayon_2}*{cos(pi/180*$theta)}}-{$Position_Stylo*{cos({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1-$Rayon_2}*{sin(pi/180*$theta)}}-{$Position_Stylo*{sin({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Nb_Boucle>1}
-line[-1] $Ancien_point_X,$Ancien_point_Y,$Nouveau_point_X,$Nouveau_point_Y,1,$R_Couleur_Stylo,$V_Couleur_Stylo,$B_Couleur_Stylo,$A_Couleur_Stylo
-endif
Ancien_point_X=$Nouveau_point_X
Ancien_point_Y=$Nouveau_point_Y
theta={$theta+$Increment_angulaire}
Nb_Boucle={$Nb_Boucle+1}
-done
-dilate_circ[-1] $Dilate_Stylo
Nb_Boucle=1
theta=0
Ancien_point_X=0
Nouveau_point_X=0
Ancien_point_Y=0
Nouveau_point_Y=0
-if {{$Lignes_epaisseur>0}||{$Points_Rayon>0}}
-repeat $Nombre_de_tours
-if {$Type_de_rendu==0}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1+$Rayon_2}*{cos(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{cos({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1+$Rayon_2}*{sin(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{sin({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==1}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1+$Rayon_2}*{cos(pi/180*$theta)}}-{$Position_Stylo*{cos({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1+$Rayon_2}*{sin(pi/180*$theta)}}-{$Position_Stylo*{sin({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==2}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1+$Rayon_2}*{cos(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{cos({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1+$Rayon_2}*{sin(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{sin({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==3}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1+$Rayon_2}*{cos(pi/180*$theta)}}-{$Position_Stylo*{cos({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1+$Rayon_2}*{sin(pi/180*$theta)}}-{$Position_Stylo*{sin({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==4}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1-$Rayon_2}*{cos(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{cos({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1-$Rayon_2}*{sin(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{sin({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==5}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1-$Rayon_2}*{cos(pi/180*$theta)}}-{$Position_Stylo*{cos({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1-$Rayon_2}*{sin(pi/180*$theta)}}-{$Position_Stylo*{sin({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==6}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1-$Rayon_2}*{cos(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{cos({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1-$Rayon_2}*{sin(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{sin({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==7}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1-$Rayon_2}*{cos(pi/180*$theta)}}-{$Position_Stylo*{cos({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1-$Rayon_2}*{sin(pi/180*$theta)}}-{$Position_Stylo*{sin({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Nb_Boucle>1}
-if {$Lignes_epaisseur>0}
-if {$Points_Rayon>0}
-circle[-1] $Ancien_point_X,$Ancien_point_Y,$Points_Rayon,1,$R_Couleur_Points,$V_Couleur_Points,$B_Couleur_Points,$A_Couleur_Points
-endif
-trait_epais_samj $Ancien_point_X,$Ancien_point_Y,$Nouveau_point_X,$Nouveau_point_Y,$Lignes_epaisseur,1,$R_Couleur_Lignes,$V_Couleur_Lignes,$B_Couleur_Lignes,$A_Couleur_Lignes
-if {$Points_Rayon>0}
-circle[-1] $Nouveau_point_X,$Nouveau_point_Y,$Points_Rayon,1,$R_Couleur_Points,$V_Couleur_Points,$B_Couleur_Points,$A_Couleur_Points
-endif
-endif
-if {$Points_Rayon>0}
-if {$Variation_de_couleur==1}
R_Couleur_Points={round({(?(255))})}
V_Couleur_Points={round({(?(255))})}
B_Couleur_Points={round({(?(255))})}
-endif
-circle[-1] $Ancien_point_X,$Ancien_point_Y,$Points_Rayon,1,$R_Couleur_Points,$V_Couleur_Points,$B_Couleur_Points,$A_Couleur_Points
-endif
-endif
Ancien_point_X=$Nouveau_point_X
Ancien_point_Y=$Nouveau_point_Y
theta={$theta+$Increment_angulaire}
Nb_Boucle={$Nb_Boucle+1}
-done
-endif
-else
-repeat $Nombre_de_tours
-if {$Variation_de_couleur==1}
R_Couleur_Stylo={round({(?(255))})}
V_Couleur_Stylo={round({(?(255))})}
B_Couleur_Stylo={round({(?(255))})}
-endif
-if {$Variation_de_couleur>1}
Valeur_variation_couleur=16
-if {$Variation_de_couleur==3}
Valeur_variation_couleur=32
-endif
-if {$Variation_de_couleur==4}
Valeur_variation_couleur=64
-endif
R_Couleur_Stylo={round({$R_Couleur_origine+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$R_Couleur_Stylo>255}
R_Couleur_Stylo=$R_Couleur_origine
-endif
-if {$R_Couleur_Stylo<0}
R_Couleur_Stylo=$R_Couleur_origine
-endif
V_Couleur_Stylo={round({$V_Couleur_origine+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$V_Couleur_Stylo>255}
V_Couleur_Stylo=$V_Couleur_origine
-endif
-if {$V_Couleur_Stylo<0}
V_Couleur_Stylo=$V_Couleur_origine
-endif
B_Couleur_Stylo={round({$B_Couleur_origine+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$B_Couleur_Stylo>255}
B_Couleur_Stylo=$B_Couleur_origine
-endif
-if {$B_Couleur_Stylo<0}
B_Couleur_Stylo=$B_Couleur_origine
-endif
-endif
-if {$Type_de_rendu==0}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1+$Rayon_2}*{cos(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{cos({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1+$Rayon_2}*{sin(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{sin({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==1}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1+$Rayon_2}*{cos(pi/180*$theta)}}-{$Position_Stylo*{cos({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1+$Rayon_2}*{sin(pi/180*$theta)}}-{$Position_Stylo*{sin({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==2}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1+$Rayon_2}*{cos(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{cos({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1+$Rayon_2}*{sin(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{sin({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==3}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1+$Rayon_2}*{cos(pi/180*$theta)}}-{$Position_Stylo*{cos({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1+$Rayon_2}*{sin(pi/180*$theta)}}-{$Position_Stylo*{sin({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==4}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1-$Rayon_2}*{cos(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{cos({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1-$Rayon_2}*{sin(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{sin({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==5}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1-$Rayon_2}*{cos(pi/180*$theta)}}-{$Position_Stylo*{cos({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1-$Rayon_2}*{sin(pi/180*$theta)}}-{$Position_Stylo*{sin({{$Rayon_1-$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==6}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1-$Rayon_2}*{cos(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{cos({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1-$Rayon_2}*{sin(pi/180*$theta)}}-{{$Rayon_2+$Position_Stylo}*{sin({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Type_de_rendu==7}
Nouveau_point_X={$centre_origine_X+{{{$Rayon_1-$Rayon_2}*{cos(pi/180*$theta)}}-{$Position_Stylo*{cos({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
Nouveau_point_Y={$centre_origine_Y+{{{$Rayon_1-$Rayon_2}*{sin(pi/180*$theta)}}-{$Position_Stylo*{sin({{$Rayon_1+$Rayon_2}/$Rayon_2}*{pi/180*$theta})}}}}
-endif
-if {$Nb_Boucle>1}
-if {$Lignes_epaisseur>0}
-if {$Points_Rayon>0}
-circle[-1] $Ancien_point_X,$Ancien_point_Y,$Points_Rayon,1,$R_Couleur_Points,$V_Couleur_Points,$B_Couleur_Points,$A_Couleur_Points
-endif
-trait_epais_samj $Ancien_point_X,$Ancien_point_Y,$Nouveau_point_X,$Nouveau_point_Y,$Lignes_epaisseur,1,$R_Couleur_Lignes,$V_Couleur_Lignes,$B_Couleur_Lignes,$A_Couleur_Lignes
-if {$Points_Rayon>0}
-circle[-1] $Nouveau_point_X,$Nouveau_point_Y,$Points_Rayon,1,$R_Couleur_Points,$V_Couleur_Points,$B_Couleur_Points,$A_Couleur_Points
-endif
-endif
-if {$Lignes_epaisseur<1}
-line[-1] $Ancien_point_X,$Ancien_point_Y,$Nouveau_point_X,$Nouveau_point_Y,1,$R_Couleur_Stylo,$V_Couleur_Stylo,$B_Couleur_Stylo,$A_Couleur_Stylo
-endif
-if {$Points_Rayon>0}
-if {$Variation_de_couleur==1}
R_Couleur_Points={round({(?(255))})}
V_Couleur_Points={round({(?(255))})}
B_Couleur_Points={round({(?(255))})}
-endif
-circle[-1] $Ancien_point_X,$Ancien_point_Y,$Points_Rayon,1,$R_Couleur_Points,$V_Couleur_Points,$B_Couleur_Points,$A_Couleur_Points
-endif
-endif
Ancien_point_X=$Nouveau_point_X
Ancien_point_Y=$Nouveau_point_Y
theta={$theta+$Increment_angulaire}
Nb_Boucle={$Nb_Boucle+1}
-done
-endif
-if {$Flou_Spirographe>0} -blur[-1] $Flou_Spirographe,0 -endif
-if {$Spread_Spirographe>1} -spread[-1] $Spread_Spirographe -endif
-if {$Deform_Spirographe>0} -deform[-1] $Deform_Spirographe -endif
-gimp_blend[-1,-2] $blend,1,$opacite,$Revert_layers,1
#@gimp Straight lines : samj_Des_Lignes_002, samj_Des_Lignes_002(1)
#@gimp : Sep = separator(), note = note("<small>Des Lignes / Straight Lines</small>")
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Param\303\250tres des lignes</small></span>")
#@gimp : Nombre lignes / number of lines = int(100,1,4096)
#@gimp : Couleurs al\303\251atoires / random colors = bool(0)
#@gimp : Gris / gray = bool(0)
#@gimp : Couleur / color = color(192,128,64,255)
#@gimp : Sym\303\251trie / symmetry = int(0,0,3)
#@gimp : Effet / effect = choice(0,"1","2","3","4","5","6","7","8","9","10","11","12")
#@gimp : Etendue / extent = float(1,1,10)
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Effet 12 / Effect 12</small></span>")
#@gimp : Origine x (% w) = float(50,-400,400)
#@gimp : Origine y (% h) = float(50,-400,400)
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>Distorsions</small></span>")
#@gimp : Flou / blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,100)
#@gimp : Sep = separator(), note = note("<span foreground="orangered"><small>M\303\251lange / Blend</small></span>")
#@gimp : M\303\251lange / blend = bool(1)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/09</i>.</small>")
samj_Des_Lignes_002 :
Nombre_Lignes=$1
Random_Colors=$2
Gris=$3
R_Couleur=$4
V_Couleur=$5
B_Couleur=$6
A_Couleur=$7
Symetrie=$8
Effet=$9
Etendue=$10
point_X={{w}/100*$11}
point_Y={{h}/100*$12}
Flou=$13
Dilatation=$14
Deformation=$15
Bruit=$16
Melange=$17
Inc_L={{w}/{{$Nombre_Lignes+1}*$Etendue}}
Inc_H={{h}/{{$Nombre_Lignes+1}*$Etendue}}
Origine_L=0
Origine_H=0
-if {$Melange==1}
{w},{h},1,4
-else
-to_rgba[-1]
-fill_color[-1] 0,0,0,0
-endif
-repeat $Nombre_Lignes
Origine_L={$Origine_L+$Inc_L}
Origine_H={$Origine_H+$Inc_H}
-if {$Random_Colors==1}
R_Couleur={round(?(0,255))}
V_Couleur={round(?(0,255))}
B_Couleur={round(?(0,255))}
-endif
-if {$Gris==1}
R_Couleur={{$R_Couleur+$V_Couleur+$B_Couleur}/3}
V_Couleur=$R_Couleur
B_Couleur=$R_Couleur
-endif
-if {$Effet==0}
-line[-1] $Origine_L,0,{w},$Origine_H,1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==1}
-line[-1] $Origine_L,0,{w},$Origine_H,1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==3}
-line[-1] $Origine_L,0,{w},$Origine_H,1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==5}
-line[-1] $Origine_L,0,{w},$Origine_H,1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==9}
-line[-1] $Origine_L,0,{w},$Origine_H,1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==11}
-line[-1] $point_X,$point_Y,{w},$Origine_H,1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-line[-1] $point_X,$point_Y,{{w}-$Origine_L},{h},1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-line[-1] $point_X,$point_Y,0,{{h}-$Origine_H},1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-line[-1] $point_X,$point_Y,$Origine_L,0,1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-endif
-if {$Random_Colors==1}
R_Couleur={round(?(0,255))}
V_Couleur={round(?(0,255))}
B_Couleur={round(?(0,255))}
-endif
-if {$Gris==1}
R_Couleur={{$R_Couleur+$V_Couleur+$B_Couleur}/3}
V_Couleur=$R_Couleur
B_Couleur=$R_Couleur
-endif
-if {$Effet==0}
-line[-1] {w},$Origine_H,{{w}-$Origine_L},{h},1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==2}
-line[-1] {w},$Origine_H,{{w}-$Origine_L},{h},1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==3}
-line[-1] {w},$Origine_H,{{w}-$Origine_L},{h},1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==6}
-line[-1] {w},$Origine_H,{{w}-$Origine_L},{h},1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==10}
-line[-1] {w},$Origine_H,{{w}-$Origine_L},{h},1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-endif
-if {$Random_Colors==1}
R_Couleur={round(?(0,255))}
V_Couleur={round(?(0,255))}
B_Couleur={round(?(0,255))}
-endif
-if {$Gris==1}
R_Couleur={{$R_Couleur+$V_Couleur+$B_Couleur}/3}
V_Couleur=$R_Couleur
B_Couleur=$R_Couleur
-endif
-if {$Effet==0}
-line[-1] {{w}-$Origine_L},{h},0,{{h}-$Origine_H},1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==1}
-line[-1] {{w}-$Origine_L},{h},0,{{h}-$Origine_H},1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==4}
-line[-1] {{w}-$Origine_L},{h},0,{{h}-$Origine_H},1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==7}
-line[-1] {{w}-$Origine_L},{h},0,{{h}-$Origine_H},1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==10}
-line[-1] {{w}-$Origine_L},{h},0,{{h}-$Origine_H},1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-endif
-if {$Random_Colors==1}
R_Couleur={round(?(0,255))}
V_Couleur={round(?(0,255))}
B_Couleur={round(?(0,255))}
-endif
-if {$Gris==1}
R_Couleur={{$R_Couleur+$V_Couleur+$B_Couleur}/3}
V_Couleur=$R_Couleur
B_Couleur=$R_Couleur
-endif
-if {$Effet==0}
-line[-1] 0,{{h}-$Origine_H},$Origine_L,0,1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==2}
-line[-1] 0,{{h}-$Origine_H},$Origine_L,0,1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==4}
-line[-1] 0,{{h}-$Origine_H},$Origine_L,0,1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==8}
-line[-1] 0,{{h}-$Origine_H},$Origine_L,0,1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-elif {$Effet==9}
-line[-1] 0,{{h}-$Origine_H},$Origine_L,0,1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-endif
-done
-if {$Symetrie==1}
-mirror[-1] x
-elif {$Symetrie==2}
-mirror[-1] y
-elif {$Symetrie==3}
-mirror[-1] x
-mirror[-1] y
-endif
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Melange==1}
-blend[-1,-2] alpha,1,0
-endif
# -text_outline[-1] $Effet,10,10,64,1,1,255,255,255
#@gimp Superposition triangles sierpinski : samj_Superposition_Triangles_Sierpinski, samj_Superposition_Triangles_Sierpinski(1)
#@gimp : Sep = separator(), note = note("<small>Rendu - Rendering</small>")
#@gimp : Nombre de zones = int(6,3,24)
#@gimp : Nombre de superpositions = int(6,1,50)
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Dimension premier cercle (>0 w%) (<0 h%) = float(50,-400,400)
#@gimp : Coeff. superpositions = float(1,0,4)
#@gimp : Hauteur triangle = float(20,0,100)
#@gimp : Angle inclinaison = float(30,0,360)
#@gimp : Contours = color(0,0,0,255)
#@gimp : Affichage = choice(1,"Sans Contours Triangles Ext.","Sans Contours Triangles Int.","Sans Contours Triangles Ext. et Lat.","Sans Contours Triangles Int. et Lat.","Triangles Ext.","Triangles Int.","Triangles Ext. et Lat.","Triangles Int. et Lat.")
#@gimp : Recursions sierpinski = int(4,0,7)
#@gimp : Triangle a = color(0,0,255,127)
#@gimp : Triangle b = color(255,255,0,127)
#@gimp : Triangle lat. a = color(128,64,192,127)
#@gimp : Triangle lat. b = color(64,128,192,127)
#@gimp : Cercle = color(0,255,255,127)
#@gimp : Afficher cercle = bool(0)
#@gimp : Couleurs al\303\251atoires / random colors = bool(0)
#@gimp : Inversions = int(0,0,3)
#@gimp : Flou / blur = float(0,0,5)
#@gimp : Dilate = int(0,0,48)
#@gimp : D\303\251formation = float(0,0,5)
#@gimp : Bruit / noise = float(0,0,100)
#@gimp : Ombre / shadow = bool(0)
#@gimp : X-ombre x-shadow = float(0.5,-5,5)
#@gimp : Y-ombre y-shadow = float(0.5,-5,5)
#@gimp : Douceur ombre / smoothness shadow = float(1.8,0,5)
#@gimp : Courbure ombre / curvature shadow = float(0,0,1)
#@gimp : D\303\251calage ombre x / shadow offset x = float(0,-20,20)
#@gimp : D\303\251calage ombre y / shadow offset y = float(0,-20,20)
#@gimp : Canal alpha = bool(0)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/08</i>.</small>")
samj_Superposition_Triangles_Sierpinski :
Nombre_de_zones=$1
Nombre_de_superpositions=$2
X={round({{w}*{$3/100}})}
Y={round({{h}*{$4/100}})}
-if {$5>0}
Rayon_Premier_Cecle={round({{w}*$5/{200*{2^0.5}}})}
-else
Rayon_Premier_Cecle={round({-{h}*$5/{200*{2^0.5}}})}
-endif
Coeff_Superpositions=$6
Hauteur_Triangle={round({{{w}+{h}}*$7/2400})}
Angle_inclinaison=$8
R_Contours=$9
V_Contours=$10
B_Contours=$11
A_Contours=$12
Affichage=$13
Recursions_Sierpinski=$14
R_Tr=$15
V_Tr=$16
B_Tr=$17
A_Tr=$18
R_Trb=$19
V_Trb=$20
B_Trb=$21
A_Trb=$22
R_Lat=$23
V_Lat=$24
B_Lat=$25
A_Lat=$26
R_Latb=$27
V_Latb=$28
B_Latb=$29
A_Latb=$30
R_Cercle=$31
V_Cercle=$32
B_Cercle=$33
A_Cercle=$34
Afficher_Cercle=$35
Couleurs_aleatoires=$36
Inversions=$37
Flou=$38
Dilatation=$39
Deformation=$40
Bruit=$41
Ombre=$42
X_Ombre=$43
Y_Ombre=$44
Smoothness_Ombre=$45
Curvature_Ombre=$46
Compensation_Decalage_Ombre_X=$47
Compensation_Decalage_Ombre_Y=$48
Canal_Alpha=$49
Largeur_Origine={w}
Hauteur_Origine={h}
Angle=$Angle_inclinaison
Increment_angle={360/$Nombre_de_zones}
Rayon_Cercle_A=$Rayon_Premier_Cecle
H_Tr=$Hauteur_Triangle
Rayon_Cercle_B=0
Rayon_Cercle_C=0
Rayon_Contour=0
-if {$Canal_Alpha==0}
-to_rgb[-1]
-else
-to_rgba[-1]
-endif
-if {$Affichage>3}
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
-endif
$Largeur_Origine,$Hauteur_Origine,1,4
-if {$Ombre>0} -polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1 -endif
Nb_boucles_superpositions=0
-repeat $Nombre_de_superpositions
Nb_boucles_superpositions={$Nb_boucles_superpositions+1}
Nb_boucles_zones=0
Angle=$Angle_inclinaison
-repeat $Nombre_de_zones
Nb_boucles_zones={$Nb_boucles_zones+1}
-if {$Couleurs_aleatoires==1}
R_Tr={round(?(0,255))}
V_Tr={round(?(0,255))}
B_Tr={round(?(0,255))}
R_Trb={round(?(0,255))}
V_Trb={round(?(0,255))}
B_Trb={round(?(0,255))}
R_Lat={round(?(0,255))}
V_Lat={round(?(0,255))}
B_Lat={round(?(0,255))}
R_Latb={round(?(0,255))}
V_Latb={round(?(0,255))}
B_Latb={round(?(0,255))}
R_Cercle={round(?(0,255))}
V_Cercle={round(?(0,255))}
B_Cercle={round(?(0,255))}
-endif
Rayon_Cercle_B={{{$Rayon_Cercle_A*$Rayon_Cercle_A}+{{$Rayon_Cercle_A*{tan({pi/180*{180/$Nombre_de_zones}})}}*{$Rayon_Cercle_A*{tan({pi/180*{180/$Nombre_de_zones}})}}}}^0.5}
X_A={$X+{{$Rayon_Cercle_A+$H_Tr}*{cos({pi/180*$Angle})}}}
Y_A={$Y+{{$Rayon_Cercle_A+$H_Tr}*{sin({pi/180*$Angle})}}}
X_B={$X+{$Rayon_Cercle_B*{cos({pi/180*{$Angle+{180/$Nombre_de_zones}}})}}}
Y_B={$Y+{$Rayon_Cercle_B*{sin({pi/180*{$Angle+{180/$Nombre_de_zones}}})}}}
X_C={$X+{$Rayon_Cercle_B*{cos({pi/180*{$Angle-{180/$Nombre_de_zones}}})}}}
Y_C={$Y+{$Rayon_Cercle_B*{sin({pi/180*{$Angle-{180/$Nombre_de_zones}}})}}}
Rayon_Cercle_C={{{{$Rayon_Cercle_A+$H_Tr}*{$Rayon_Cercle_A+$H_Tr}}+{{{$Rayon_Cercle_A+$H_Tr}*{tan({pi/180*{180/$Nombre_de_zones}})}}*{{$Rayon_Cercle_A+$H_Tr}*{tan({pi/180*{180/$Nombre_de_zones}})}}}}^0.5}
X_D={$X+{$Rayon_Cercle_A*{cos({pi/180*$Angle})}}}
Y_D={$Y+{$Rayon_Cercle_A*{sin({pi/180*$Angle})}}}
X_E={$X+{$Rayon_Cercle_C*{cos({pi/180*{$Angle+{180/$Nombre_de_zones}}})}}}
Y_E={$Y+{$Rayon_Cercle_C*{sin({pi/180*{$Angle+{180/$Nombre_de_zones}}})}}}
X_F={$X+{$Rayon_Cercle_C*{cos({pi/180*{$Angle-{180/$Nombre_de_zones}}})}}}
Y_F={$Y+{$Rayon_Cercle_C*{sin({pi/180*{$Angle-{180/$Nombre_de_zones}}})}}}
-if {{($Affichage%2)}==0}
Rayon_Contour={$Rayon_Cercle_A+$H_Tr}
-if {$Recursions_Sierpinski==0}
-if {{($Nb_boucles_superpositions%2)}==0}
-polygon[-1] 3,$X_A,$Y_A,$X_B,$Y_B,$X_C,$Y_C,1,$R_Tr,$V_Tr,$B_Tr,$A_Tr
-else
-polygon[-1] 3,$X_A,$Y_A,$X_B,$Y_B,$X_C,$Y_C,1,$R_Trb,$V_Trb,$B_Trb,$A_Trb
-endif
-else
-if {{($Nb_boucles_superpositions%2)}==0}
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_A,$Y_A,$X_B,$Y_B,$X_C,$Y_C,$R_Tr,$V_Tr,$B_Tr,$A_Tr
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_A,$Y_A,$X_B,$Y_B,$X_C,$Y_C,$R_Trb,$V_Trb,$B_Trb,$A_Trb
-endif
-endif
-if {{$Affichage==2}||{$Affichage==6}}
-if {{($Nb_boucles_superpositions%2)}==0}
-polygon[-1] 3,$X_A,$Y_A,$X_B,$Y_B,$X_E,$Y_E,1,$R_Lat,$V_Lat,$B_Lat,$A_Lat
-polygon[-1] 3,$X_A,$Y_A,$X_C,$Y_C,$X_F,$Y_F,1,$R_Lat,$V_Lat,$B_Lat,$A_Lat
-else
-polygon[-1] 3,$X_A,$Y_A,$X_B,$Y_B,$X_E,$Y_E,1,$R_Latb,$V_Latb,$B_Latb,$A_Latb
-polygon[-1] 3,$X_A,$Y_A,$X_C,$Y_C,$X_F,$Y_F,1,$R_Latb,$V_Latb,$B_Latb,$A_Latb
-endif
-endif
-if {$Affichage>3}
-polygon[-2] 3,$X_A,$Y_A,$X_B,$Y_B,$X_C,$Y_C,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-else
Rayon_Contour=$Rayon_Cercle_C
-if {$Recursions_Sierpinski==0}
-if {{($Nb_boucles_superpositions%2)}==0}
-polygon[-1] 3,$X_D,$Y_D,$X_E,$Y_E,$X_F,$Y_F,1,$R_Tr,$V_Tr,$B_Tr,$A_Tr
-else
-polygon[-1] 3,$X_D,$Y_D,$X_E,$Y_E,$X_F,$Y_F,1,$R_Trb,$V_Trb,$B_Trb,$A_Trb
-endif
-else
-if {{($Nb_boucles_superpositions%2)}==0}
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_D,$Y_D,$X_E,$Y_E,$X_F,$Y_F,$R_Tr,$V_Tr,$B_Tr,$A_Tr
-else
-samj_sierpinski_absolu[-1] $Recursions_Sierpinski,$X_D,$Y_D,$X_E,$Y_E,$X_F,$Y_F,$R_Trb,$V_Trb,$B_Trb,$A_Trb
-endif
-endif
-if {{$Affichage==3}||{$Affichage==7}}
-if {{($Nb_boucles_superpositions%2)}==0}
-polygon[-1] 3,$X_D,$Y_D,$X_B,$Y_B,$X_E,$Y_E,1,$R_Lat,$V_Lat,$B_Lat,$A_Lat
-polygon[-1] 3,$X_D,$Y_D,$X_C,$Y_C,$X_F,$Y_F,1,$R_Lat,$V_Lat,$B_Lat,$A_Lat
-else
-polygon[-1] 3,$X_D,$Y_D,$X_B,$Y_B,$X_E,$Y_E,1,$R_Latb,$V_Latb,$B_Latb,$A_Latb
-polygon[-1] 3,$X_D,$Y_D,$X_C,$Y_C,$X_F,$Y_F,1,$R_Latb,$V_Latb,$B_Latb,$A_Latb
-endif
-endif
-if {$Affichage>3}
-polygon[-2] 3,$X_D,$Y_D,$X_E,$Y_E,$X_F,$Y_F,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-endif
Angle={$Angle_inclinaison+{$Increment_angle*$Nb_boucles_zones}}
-done
Rayon_Cercle_A={$Rayon_Cercle_A+$H_Tr}
H_Tr={$Hauteur_Triangle*$Nb_boucles_superpositions*$Coeff_Superpositions}
-done
-if {$Afficher_Cercle==1}
$Largeur_Origine,$Hauteur_Origine,1,4
-polygon[-1] 4,0,0,{$Largeur_Origine-1},0,{$Largeur_Origine-1},{$Hauteur_Origine-1},0,{$Hauteur_Origine-1},1,0xFFFFFFFF,0,0,0,1
-ellipse[-1] $X,$Y,$Rayon_Contour,$Rayon_Contour,0,1,$R_Cercle,$V_Cercle,$B_Cercle,$A_Cercle
-blend[-2,-1] alpha,1,1
-if {$Affichage>3}
-ellipse[-2] $X,$Y,$Rayon_Contour,$Rayon_Contour,0,1,0xFFFFFFFF,$R_Contours,$V_Contours,$B_Contours,$A_Contours
-endif
-endif
-if {$Affichage>3}
-if {$Dilatation>1} -dilate_circ[-2] $Dilatation -endif
-if {$Flou>0} -blur[-1,-2] $Flou,0 -endif
-if {$Deformation>0} -deform[-1,-2] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-2] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-2] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-blend[-2,-1] alpha,1,1
-else
-if {$Dilatation>1} -dilate_circ[-1] $Dilatation -endif
-if {$Flou>0} -blur[-1] $Flou,0 -endif
-if {$Deformation>0} -deform[-1] $Deformation -endif
-if {$Bruit>0} -gimp_noise[-1] {$Bruit+50},0,22,1 -endif
-if {$Ombre>0}
-drop_shadow[-1] $X_Ombre,$Y_Ombre,$Smoothness_Ombre,$Curvature_Ombre
-shift[-1] {$Compensation_Decalage_Ombre_X}%,{$Compensation_Decalage_Ombre_Y}%,0,0,0
-endif
-endif
-if {$Inversions==1}
-mirror[-1] x
-elif {$Inversions==2}
-mirror[-1] y
-elif {$Inversions==3}
-mirror[-1] x
-mirror[-1] y
-endif
-blend[-1,-2] alpha,1,0
#@gimp Traits strokes : Traits_Strokes_samj, Traits_Strokes_samj(1)
#@gimp : Sep = separator(), note = note("<small>Origine</small>")
#@gimp : Position x (%) = float(50,0,100)
#@gimp : Position y (%) = float(50,0,100)
#@gimp : Sep = separator(), note = note("<small>Traits / Strokes</small>")
#@gimp : L o n g u e u r / length (>0 %w) (<0 $h) = float(35,-400,400)
#@gimp : Mode variations = choice(0,"Non / No","Plus / More","Moins / Less","Plus / More [milieu-middle]","Moins / Less [milieu-middle]")
#@gimp : Variations % (longueur/length) = float(100,0,1000)
#@gimp : \303\211loignement du centre (>0 %w) (<0 $h) = float(0,-400,400)
#@gimp : N o m b r e   d e   t r a i t s / number of strokes = int(30,1,2160)
#@gimp : Angle (d\303\251part / start) = float(0,0,360)
#@gimp : Angle (fin / end) = float(360,0,360)
#@gimp : Couleur/ color = color(240,60,120,255)
#@gimp : Variation de couleur / color variation = choice("Pas de variation / No change","Couleurs aleatoires / Random colors","Faiblement nuancee / Poorly nuanced","Moyennement nuancee / Moderately nuanced","Fortement nuancee / Highly nuanced")
#@gimp : \303\211paisseur / thickness = int(0,0,32)
#@gimp : Sep = separator(), note = note("<small>Sym\303\251trie / Symmetry</small>")
#@gimp : Sym\303\251trie / symmetry = bool(0)
#@gimp : Longueur / length (%) = float(20,0,100)
#@gimp : Sep = separator(), note = note("<small>Divers / Foo</small>")
#@gimp : Flou / blur = float(0,0,10)
#@gimp : Spread = float(0,0,10)
#@gimp : D\303\251formation = float(0,0,25)
#@gimp : Sep = separator(), note = note("<small>M\303\251lange / Blend</small>")
#@gimp : Mode = choice{1,"Add","Alpha","And","Average","Blue","Burn","Darken","Difference",
#@gimp : "Divide","Dodge","Edges","Exclusion","Freeze","Grain extract","Grain merge","Green","Hard light",
#@gimp : "Hard mix","Hue","Interpolation","Lighten","Lightness","Linear burn","Linear light","Luminance",
#@gimp : "Multiply","Negation","Or","Overlay","Pin light","Red","Reflect","Saturation",
#@gimp : "Shape Average","Shape Average0","Soft burn","Soft dodge","Soft light","Screen","Stamp","Subtract","Value",
#@gimp : "Vivid light","Xor"}
#@gimp : Opacit\303\251 / opacity = float(1,0,1)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/15</i>.</small>")
Traits_Strokes_samj:
Position_X={round({{w}*{$1/100}})}
Position_Y={round({{h}*{$2/100}})}
-if {$3>0}
Longueur={{w}*$3/{100}}
-else
Longueur={-{h}*$3/{100}}
-endif
Variations_Formes=$4
Variations_Longueur=$5
-if {$6>0}
Eloignement_du_centre={{w}*$6/{100}}
-else
Eloignement_du_centre={-{h}*$6/{100}}
-endif
Nombre_de_traits=$7
Angle_Depart=$8
Angle_Fin=$9
R_Couleur=$10
V_Couleur=$11
B_Couleur=$12
A_Couleur=$13
Variation_de_couleur=$14
Epaisseur=$15
Symetrie=$16
Pourcent_Longueur_Sym=$17
Flou_traits=$18
Spread_traits=$19
Deform_traits=$20
blend=$21
opacite=$22
Revert_layers=0
-to_rgba
{w},{h},1,4
Angle=$Angle_Depart
-if {$Angle_Depart>$Angle_Fin}
Angle_Fin={$Angle_Fin+360}
-endif
increment_theta={{$Angle_Fin-$Angle_Depart}/$Nombre_de_traits}
-if {$Variations_Formes==1}
Variation={{$Longueur/100*$Variations_Longueur}/$Nombre_de_traits}
-endif
-if {$Variations_Formes==2}
Variation={{-$Longueur/1000*$Variations_Longueur}/$Nombre_de_traits}
-endif
-if {$Variations_Formes==3}
Variation={{$Longueur/100*$Variations_Longueur}/{$Nombre_de_traits/2}}
-endif
-if {$Variations_Formes==4}
Variation={{-$Longueur/1000*$Variations_Longueur}/{$Nombre_de_traits/2}}
-endif
Longueur_calculee=$Longueur
Nb_Boucle=1
R_Couleur_origine=$R_Couleur
V_Couleur_origine=$V_Couleur
B_Couleur_origine=$B_Couleur
A_Couleur_origine=$A_Couleur
-repeat $Nombre_de_traits
-if {$Variation_de_couleur==1}
R_Couleur={round({(?(255))})}
V_Couleur={round({(?(255))})}
B_Couleur={round({(?(255))})}
A_Couleur={{round({(?(200))})}+55}
-endif
-if {$Variation_de_couleur>1}
Valeur_variation_couleur=16
-if {$Variation_de_couleur==3}
Valeur_variation_couleur=32
-endif
-if {$Variation_de_couleur==4}
Valeur_variation_couleur=64
-endif
R_Couleur={round({$R_Couleur_origine+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$R_Couleur>255}
R_Couleur=$R_Couleur_origine
-endif
-if {$R_Couleur<0}
R_Couleur=$R_Couleur_origine
-endif
V_Couleur={round({$V_Couleur_origine+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$V_Couleur>255}
V_Couleur=$V_Couleur_origine
-endif
-if {$V_Couleur<0}
V_Couleur=$V_Couleur_origine
-endif
B_Couleur={round({$B_Couleur_origine+{?(-$Valeur_variation_couleur,$Valeur_variation_couleur)}})}
-if {$B_Couleur>255}
B_Couleur=$B_Couleur_origine
-endif
-if {$B_Couleur<0}
B_Couleur=$B_Couleur_origine
-endif
-endif
Debut_X={$Position_X+{round(cos(pi/180*$Angle)*$Eloignement_du_centre)}}
Debut_Y={$Position_Y+{round(sin(pi/180*$Angle)*$Eloignement_du_centre)}}
Extremite_X={$Position_X+{round(cos(pi/180*$Angle)*{$Longueur_calculee+$Eloignement_du_centre})}}
Extremite_Y={$Position_Y+{round(sin(pi/180*$Angle)*{$Longueur_calculee+$Eloignement_du_centre})}}
-line[-1] $Debut_X,$Debut_Y,$Extremite_X,$Extremite_Y,1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-if {$Symetrie==1}
Debut_X={$Position_X+{round(cos(pi/180*{$Angle+180})*$Eloignement_du_centre)}}
Debut_Y={$Position_Y+{round(sin(pi/180*{$Angle+180})*$Eloignement_du_centre)}}
Extremite_X={$Position_X+{round(cos(pi/180*{$Angle+180})*{{$Longueur_calculee/100*$Pourcent_Longueur_Sym}+$Eloignement_du_centre})}}
Extremite_Y={$Position_Y+{round(sin(pi/180*{$Angle+180})*{{$Longueur_calculee/100*$Pourcent_Longueur_Sym}+$Eloignement_du_centre})}}
-line[-1] $Debut_X,$Debut_Y,$Extremite_X,$Extremite_Y,1,$R_Couleur,$V_Couleur,$B_Couleur,$A_Couleur
-endif
Angle={$Angle+$increment_theta}
-if {{$Variations_Formes==1}||{$Variations_Formes==2}}
Longueur_calculee={$Longueur_calculee+$Variation}
-endif
-if {{$Variations_Formes==3}||{$Variations_Formes==4}}
-if {$Nb_Boucle<{$Nombre_de_traits/2}}
Longueur_calculee={$Longueur_calculee+$Variation}
-else
Longueur_calculee={$Longueur_calculee-$Variation}
-endif
-endif
Nb_Boucle={$Nb_Boucle+1}
-done
-if {$Epaisseur>0}
-dilate_circ[-1] $Epaisseur
-endif
-blur[-1] $Flou_traits
-spread[-1] $Spread_traits
-deform[-1] $Deform_traits
-gimp_blend[-1,-2] $blend,1,$opacite,$Revert_layers,1
#@gimp _
#@gimp <i>Various</i>
#@gimp Do nothing : Je_passe_l_hiver_en_Floride, Je_passe_l_hiver_en_Floride
#@gimp : Note = note("<small><b>Note</b> : This filters does nothing on the image. Use it to manipulate layers in conjunction with the input/output options of the G'MIC plug-in.</small>")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>2010/12/29</i>.</small>")
Je_passe_l_hiver_en_Floride :
#@gimp Samj test a : samj_test_A, samj_test_A(1)
#@gimp : Note = note("samj_test_A")
#@gimp : A = int(64,0,255)
#@gimp : B = int(192,0,255)
#@gimp : C = int(500,0,10000)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/14</i>.</small>")
samj_test_A :
-or[-1] {$1} -to_rgb[-1] -and[-1] {$2} -smooth[-1] $3 -n[-1] 0,255 -Couleurs_Metalliques[-1] 0,0,22,0,0,0,0,6,5,20,1,0,0,0,0.3,60,1,1,0
#@gimp Samj test b : samj_test_B, gimp_no_preview
#@gimp : Note = note("samj_test_B")
#@gimp : A = int(100,10,200)
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/15</i>.</small>")
samj_test_B :
-samj_Points_Aleatoires_001[-1] $1,255,255,0,255,3,1,1 --Je_passe_l_hiver_en_Floride[-1] -gimp_flower[-1] 30,6,100,0,50,50,1 -to_rgb[-1] -smooth[-1] 500 -n[-1] 0,255 -Couleurs_Metalliques[-1] 0,0,22,0,0,0,0,6,5,20,1,0,0,0,0.3,60,1,1,0 -gimp_boost_chroma[-1] 1,0,0
#@gimp Test courbes : samj_test_x_color_curves, samj_test_x_color_curves(0)
#@gimp : Note = note("Demo. samj_test_x_color_curves")
#@gimp : Note = note("")
#@gimp : Utiliser = choice(1,"x_color_curves","gimp_curves_interactive")
#@gimp : Appliquer courbes = choice("Aucun","Appliquer le Dernier","RGB","CMY","CMYK","HSI","HSL","HSV","Lab","Lch","YCbCr")
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/04</i>.</small>")
samj_test_x_color_curves :
Utiliser=$1
Appliquer_courbes=$2
-if {$Utiliser==0}
-if {$Appliquer_courbes==0}
-blur[-1] 5
-elif {$Appliquer_courbes==1}
-x_color_curves[-1] last
-elif {$Appliquer_courbes==2}
-x_color_curves[-1] rgb
-elif {$Appliquer_courbes==3}
-x_color_curves[-1] cmy
-elif {$Appliquer_courbes==4}
-x_color_curves[-1] cmyk
-elif {$Appliquer_courbes==5}
-x_color_curves[-1] hsi
-elif {$Appliquer_courbes==6}
-x_color_curves[-1] hsl
-elif {$Appliquer_courbes==7}
-x_color_curves[-1] hsv
-elif {$Appliquer_courbes==8}
-x_color_curves[-1] lab
-elif {$Appliquer_courbes==9}
-x_color_curves[-1] lch
-elif {$Appliquer_courbes==10}
-x_color_curves[-1] ycbcr
-endif
-else
-if {$Appliquer_courbes==0}
-blur[-1] 5
-elif {$Appliquer_courbes==1}
-deform[-1] 20
-elif {$Appliquer_courbes==2}
-gimp_curves_interactive[-1] 0,0,0,0,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100
-elif {$Appliquer_courbes==3}
-gimp_curves_interactive[-1] 1,0,0,0,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100
-elif {$Appliquer_courbes==4}
-gimp_curves_interactive[-1] 2,0,0,0,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100
-elif {$Appliquer_courbes==5}
-gimp_curves_interactive[-1] 3,0,0,0,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100
-elif {$Appliquer_courbes==6}
-gimp_curves_interactive[-1] 4,0,0,0,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100
-elif {$Appliquer_courbes==7}
-gimp_curves_interactive[-1] 5,0,0,0,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100
-elif {$Appliquer_courbes==8}
-gimp_curves_interactive[-1] 6,0,0,0,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100
-elif {$Appliquer_courbes==9}
-gimp_curves_interactive[-1] 7,0,0,0,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100
-elif {$Appliquer_courbes==10}
-gimp_curves_interactive[-1] 8,0,0,0,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100,-1,0,0,100,100
-endif
-endif
#@gimp Tout interactif : samj_test_tout_interactif, gimp_no_preview
#@gimp : Note = note("Demo. Tout interactif")
#@gimp : Note = note("")
#@gimp : Note = note("2 filtres interactifs successifs : x_paint et threshold")
#@gimp : Note = note("x_paint : Choisir un pinceau, appliquer et fermer image")
#@gimp : Note = note("threshold : Appliquer la souris et fermer image")
#@gimp : Note = note("")
#@gimp : Note = note("2 successive interactive filters : x_paint et threshold")
#@gimp : Note = note("x_paint : Choose a brush, apply and close picture")
#@gimp : Note = note("threshold : Move the mouse and close picture")
#@gimp : Note = note("")
#@gimp : Sep = separator(), note = note("<small>samj - Derni\303\250re mise \303\240 jour : <i>2015/03/03</i>.</small>")
samj_test_tout_interactif :
-x_paint[-1]
-threshold[-1]
-n[-1] 0,255
#@gimp __
#@gimp <i>Telperion</i>
#@gimp Mc flou : mc_flou, mc_flou_preview
#@gimp : Sep = separator()
#@gimp : Sharp = float(30,10,400)
#@gimp : Blur = float(6,3,20)
#@gimp : Blend = float(1,0,1)
#@gimp : Sep = separator() ,note = note("Base image adjustement:")
#@gimp : Skip = bool(true)
#@gimp : Gamma = float(1,0.2,2)
#@gimp : Value min = int(0,0,127)
#@gimp : Value max = int(255,128,255)
#@gimp : Gamma r = float(1,0.2,2)
#@gimp : Gamma g = float(1,0.2,2)
#@gimp : Gamma b = float(1,0.2,2)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator() ,note = note("Apply a flou effect with edges protection. v.1.1")
mc_flou:
-if {$4==0}
-to_rgb
-apply_gamma[0] $5
-cut[0] $6,$7 -normalize[0] 0,255
-split[0] c
-apply_gamma[0] $8
-apply_gamma[1] $9
-apply_gamma[2] $10
-append[0,1,2] c
-endif
--gimp_gradient_norm[0] 0,1.5,0,50.38,1,0
-sharpen[0] $1
-b[1] 0.5
-normalize[1] 0,255
-equalize[1] 4,0%,98%
--append[0,1] c
-blur[2] $2
-blend[0,2] alpha,$3
-remove_opacity[0]
-keep[0]
mc_flou_preview:
-gimp_split_preview "-mc_flou $*",$-1
#@gimp Mc pendraw : mc_pendraw, mc_pendraw_preview
#@gimp : Sep = separator()
#@gimp : Amplitude = float(8,0,30)
#@gimp : Blur = float(0.8,0.1,2)
#@gimp : Sharp = float(450,100,2000)
#@gimp : Color = int(21,4,256)
#@gimp : Dithering = float(0.5,0,1)
#@gimp : Value = float(1,0,1)
#@gimp : Mode 2 = bool(false)
#@gimp : Color equal. = bool(false)
#@gimp : Equal. limit = int(255,100,255)
#@gimp : Sep = separator()
#@gimp : Lowers contrast = float(0,0,1)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
mc_pendraw:
-repeat @# -l[$>]
-split_opacity
-l[0]
-to_rgb
-if {$10>0}
[0]
-b[0] 1
-negative[0]
-luminance[0]
-rv[0,1]
-blend[0,1] overlay,$10
-endif
--gimp_gradient_norm[0] 0,1.5,0,50.38,1,0
[0]
-smooth $1,0.2,1,3,3
-b $2
-sharpen $3
[0]
-r[0] 20,20,1,3,2
-equalize[0] 256,0%,98%
-index[3] [0],1,1
-rm[0]
-nm[0] linee
-nm[1] orig
-nm[2] pen
-if {$7==0}
-rv[pen,linee]
-blend[pen,linee] multiply,1
-elif {$7==1}
-rv[orig,linee]
-blend[orig,linee] multiply,1
-endif
-normalize[0] 5,250
-autoindex[0] $4,$5
-rv[0,1]
-blend[0,1] value,$6
-if {$8==1}
-equalize 21,30,$9
-endif
-endl -a c -endl -done
mc_pendraw_preview:
-gimp_split_preview "-mc_pendraw $*",$-1
#@gimp _
#@gimp <i>Tom keil</i>
#@gimp About : _none_, gimp_tk_about
#@gimp : Note = note{"
#@gimp : <span foreground ="purple">( <b>T</b>om Keils <b>F</b>ilter <b>S</b>et for <b>G'MIC</b>)</span>\n\nis proposed to you by"}
#@gimp : Note = note("Tom Keil")
#@gimp : Note = note{"\n"}
#@gimp : Sep = separator()
#@gimp : Note = note{"
#@gimp : The source code of this set of filters and additional informations and tutorials are available at :"}
#@gimp : Note = link("http://www.tkfilter.bplaced.net")
#@gimp : "}
#@gimp : Sep = separator()
#@gimp : Note = note{"\nThe filters in this folder are still under development and may be subject to changes. Some filters appearing here are also part of the main filter tree of GMIC. If they appear here too it means there are changes and updates not yet implemented in the main filter tree."}
gimp_tk_about :
-gimp_logo "Tom Keils Filters"
tk_gimp_channel_processing :
-gimp_channel_processing {log($1)},${2--1}
tk_gimp_select_color :
($4^$5^$6^$7) -_gimp_select_color[-1] $1 color=@-1 -rm[-1]
-repeat @#
-if {$8==0}
--_gimp_select_color[-1] $1
-select_color[-1] $2%,$color
-b[-1] $3%
-if $9 -*[-1] -1 -+[-1] 1 -endif
-to_rgba[-2] -s[-2] c -*[-2,-1] -a[-4--1] c
-else
-_gimp_select_color[-1] $1
-select_color[-1] $2%,$color
-b[-1] $3
-if $9 -*[-1] -1 -+[-1] 1 -endif
-*[-1] 255 -r[-1] 100%,100%,1,4
-endif
-mv[-1] 0 -done
tk_gimp_replace_color :
-to_rgba -replace_color $1,$2%,${3--1} -c 0,255
#@gimp Beauty retouch : gimp_tk_retouch, gimp_tk_retouch_preview(0)
#@gimp : Sep = separator()
#@gimp : Smoothness = float(30,0,100)
#@gimp : Details = float(3,0,10)
#@gimp : Smoothing strength = float(1,0,5)
#@gimp : Edge threshold = float(20,0,50)
#@gimp : Edge smoothness = float(1.5,0,10)
#@gimp : Sharpening radius = float(1,0,10)
#@gimp : Sharpening strength = float(2.5,0,5)
#@gimp : View edge mask = bool(0)
#@gimp : Smoothen skin tones only = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>.      Latest update: <i>01/05/2011</i>.</small>")
#@gimp : Note = link("Filter explained here","http://www.flickr.com/groups/gmic/discuss/72157625538669041/")
gimp_tk_retouch :
-repeat @# -l[$>]
-if {$8==1}
--gimp_edges $5,$4,0,0 -gimp_gaussian_blur {$5*5},0,0,1,1,0,0
-else
--to_rgba[0]  --to_gray[0] -gimp_edges[2] $5,$4,0,0
-gimp_gaussian_blur[2] {$5*5},0,0,1,1,0,0 -to_gray[2] --to_rgba[0] --negative[2]
-gimp_highpass[1] {$1},2,1,1,0
-gimp_gaussian_blur[1] $2,0,0,1,1,0,0
-to_rgba[0]
-if {$9==1}  --to_rgba[0] -channels[5] 0
-tk_gimp_channel_processing[5] 1,1,4,0,0,0,100,256,0,0,0,2,7,0
-gimp_gaussian_blur[5] {{w+h}/1000},0,0,1,0,0,0 -to_gray[5] -endif
-split[1] c  -reverse[4,5] -compose_multiply[4,5]
-if {$9==1} -reverse[4,-1] -compose_multiply[4,-1] -endif
-append[-6,-5,-4,-3] c
-reverse[0,1] -gimp_compose_softlight[0,1] {$3/5}
-gimp_unsharp[-2] 0,$6,30,$7,0.00,1.00,0.5,1,0,7,0
-split[-2] c  -reverse[-1,-2] -compose_multiply[-1,-2] -append[-4,-3,-2,-1] c
-compose_alpha[0,1]
-endif
-endl -done
gimp_tk_retouch_preview :
-gimp_split_preview "-gimp_tk_retouch ${1--2}",$-1
#@gimp Dof manipulation : gimp_tk_dof, gimp_tk_dof_preview(1)
#@gimp : Sep = separator()
#@gimp : Focal point x = float (50,0,100)
#@gimp : Focal point y = float (50,0,100)
#@gimp : Dof 1 = int (30,0,255)
#@gimp : Dof 2 = int (60,0,255)
#@gimp : Transition = float(5,0,25)
#@gimp : Defocus strength = float(15,0,200)
#@gimp : Defocus style = choice(2,"median","gaussian","mixed")
#@gimp : Depth estimation model = choice("automatic depth estimation","daylight scene","individual focus field mask","individual depth map")
#@gimp : Bokeh strength = float(0,0,1)
#@gimp : Highlights threshold = float(200,0,255)
#@gimp : Bokeh size = float(40,2,200)
#@gimp : Bokeh blur = float(2,0,20)
#@gimp : Aperture type = choice("circular","octogonal")
#@gimp : Remove blurring artifacts = bool(0)
#@gimp : Sep = separator()
#@gimp : Scheimpflug effect = choice("none","vertical blend","horizontal blend","vertical only","horizontal only")
#@gimp : Tilt plane 1 = float(0,0,100)
#@gimp : Tilt plane 2 = float(0.01,0,100)
#@gimp : Sep = separator()
#@gimp : Output mode = choice("image","layers in focus/out of focus","focus field mask only","depth estimation only")
#@gimp : Computation mode = choice(1,"high quality","normal","high speed")
#@gimp : Use treshold mask mode = bool(0)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>      Latest update: <i>21/01/2012</i>.</small>")
#@gimp : Note = link("Filter explained here",http://www.tkfilter.bplaced.net/TKFilter%20tutorials%20DOF%20manipulation.html)
gimp_tk_dof :
-if {{$8==0}||{$8==1}} -if {{@#}!=1} -error[] "Select input mode ACTIVE. This option is available for single layer only."
-endif -endif
-if {{$8==2}||{$8==3}} -if {{$15==3}||{$15==4}||{$17==3}} -error[] "Option not available for individual mask" -endif -endif
-if {{$8==2}||{$8==3}} -if {{@#}!=2} -error[] "For individual mask select input mode ACTIVE AND BELOW" -endif -endif
tr={$5} dfs={$6} bsi={$11} bsb={$12}
-if {$19==1} scdo=50 scup=200 tr={$5/2} dfs={$6/2} bsi={$11/2} bsb={$12/2} -endif
-if {$19==2} scdo=25 scup=400 tr={$5/4} dfs={$6/4} bsi={$11/4} bsb={$12/4} -endif
-if {{$8==0}||{$8==1}} -if {$19!=0} --r[0] $scdo%,$scdo% -else [0] -endif
-else -if {$19!=0} -r[-1] $scdo%,$scdo% -endif -endif
-if {$19!=0} --r[0] $scdo%,$scdo% -else [0] -endif
-if {{$8==2}||{$8==3}} -rv[-1,-2] -endif
-if {{$15==0}||{$15==1}||{$15==2}}
-if {$8==0} -gimp_tk_autodepth[-1]
-elif {$8==1} -gimp_tk_depthmap[-1] 1,20,0,0,0,0,0
-elif {{$8==2}||{$8==3}} -endif
-if {$18!=3} -if {$8!=2}
-if {$20==1} -to_rgb[-1]
--f[-1] if(i>={{255-$3}+{$4/2}},0,i)
--f[-1] if(i<={{255-$3}-{$4/2}},0,i) -compose_darken[-1,-2]
-n[-1] 0,255 -f[-1] if(i>=1,255,i) -rm[-2]
-else
-local_similarity_mask[-1] $1,$2,$3,$4,4,0
-endif
-blur_xy[-1] $tr
-endif -endif
-endif
-if {{$15==1}||{$15==3}}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,1,180,100,$16
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,180,0,$17
-compose_darken[-1,-2]
-endif
-if {{$15==2}||{$15==4}}
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,1,90,100,$16
--gimp_linear_gradient[-1] 0,0,0,255,255,255,255,255,0,90,0,$17
-compose_darken[-1,-2]
-endif
-if {{$15==1}||{$15==2}} -rv[-1,-2] -compose_lighten[-1,-2] -endif
-if {{$15==3}||{$15==4}} -rm[-2] -endif
-if {{$18==0}||{$18==1}}
-if {$14==1} [-1,-2]
-blur_xy[-1] {$tr/2}
-t2[-1] 1,256 -n[-1] 0,255
-tk_gimp_replace_color[-1] 1,0,0,0,0,255,0,0,0,0
-inpaint[-2] [-1] -rm[-1,1] -rv[-1,-2]
-endif
-if {$7==0} -median[-2] $dfs
-elif {$7==1} -blur_xy[-2] $dfs
-elif {$7==2} -median[-2] {$dfs/2} -blur_xy[-1] {$dfs/5}
-endif
-if {$9!=0} -if {$19==0}  [0] -else --r[0] $scdo%,$scdo% -endif
-gimp_morpho[-1] 1,$bsi,0,{2-$13},0,1,0
-tk_gimp_replace_color[-1] {$10*1.765},0,0,0,0,255,0,0,0,0
-blur_xy[-1] $bsb
-rv[-1,-3] -gimp_compose_lighten[-1,-3] $9
-endif
-if {$19!=0} -r[1,2] $scup%,$scup% -endif
-to_rgba[0] -s[0] c -rv[3,5]
-compose_multiply[3,5] -to_gray[3]
-a[0,1,2,3] c
-if {$18==0} -rv[0,1] -compose_rgba[0,1] -endif
-endif
-if {$18!=1} -k[-1] -endif
-if {{$18==2}||{$18==3}} -if {$19!=0} -r[-1] $scup%,$scup% -endif -endif
gimp_tk_dof_preview :
-to_rgba
-if {{$8==0}||{$8==1}} -if {{@#}!=1} -error[] "Select input mode ACTIVE. This option is available for single layer only."
-endif -endif
-if {{$8!=2}&&{$8!=3}}
-gimp_split_preview "-gimp_tk_dof ${1--2}",$-1
-else -gimp_tk_dof ${1--1} -endif
-to_rgba
-if {$20==0}
-line 100%,$2%,{$1+5}%,$2%,1,255,0,0
-line 0%,$2%,{$1-5}%,$2%,1,255,0,0
-line $1%,100%,$1%,{$2+5}%,1,255,0,0
-line $1%,0%,$1%,{$2-5}%,1,255,0,0
-endif
#@gimp Infrared simulation : gimp_tk_infrared, gimp_tk_infrared_preview(1)
#@gimp : Filter density = float(0.75,0.01,0.99)
#@gimp : Wood effect saturation = float(0.5,0,1)
#@gimp : Wood effect color = int(-100,-180,180)
#@gimp : Wood effect falloff = float(0.75,0,1)
#@gimp : Sky color = int(0,-180,180)
#@gimp : Sky falloff = float(1,0,1)
#@gimp : Infrared defocus = float(0,0,3)
#@gimp : Exposure = int(0,-255,255)
#@gimp : Contrast = float(1,0,4)
#@gimp : Saturation = float(1,0,2)
#@gimp : Color / B&amp;W = bool(0)
#@gimp : Add grain = float(50,0,200)
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical")
#@gimp : Sep = separator(), note = note("<small>Author: <i>Tom Keil</i>      Latest update: <i>07/17/2012</i>.</small>")
gimp_tk_infrared :
-repeat @# -l[$>]
--gimp_hsv_equalizer 0,120,{240*$4},{if({$2==0},0,$3)},{if({$2==0},-$1,{-1+$2})},$1,240,{120*$6},$5,0,-$1,0,0,0,0,0
-blur[-1] $7 -gimp_compose_alpha $1,0
-tk_gimp_channel_processing 1,$9,$8,0,0,0,100,256,0,0,0,2,0,0
-gimp_mix_lab 1,0,0,$10,0,0,$10,0,0,0,2,0
-if {$11==1} -gimp_blackandwhite 0.299,0,0.587,0,0.114,0,1,1,0,0,0,$12,$12,$12,2,{{w+h}/60000},0,0,16,4,0,0,0 -endif
-endl -done
gimp_tk_infrared_preview :
-gimp_split_preview "-gimp_tk_infrared ${1--2}",$-1
#@gimp _
#@gimp <i>Zonderr</i>
#@gimp Demo mathmap ra : demo_ra, demo_ra
#@gimp : Note = note("mathmap ra: demo")
#@gimp : Sep = separator()
#@gimp : Radius scale = float(1,0,10)
#@gimp : Angle scale = float(1,0,10)
demo_ra:
-mathmap_ra "rmath*$1","amath*$2"
#@gimp Demo mathmap xy : demo_xy, demo_xy
#@gimp : Note = note("mathmap xy: demo")
#@gimp : Sep = separator()
#@gimp : X scale = float(1,0,10)
#@gimp : Y scale = float(1,0,10)
demo_xy:
-mathmap_xy "xmath*$1","ymath*$2"
#@gimp Fourier picture watermark : gimp_fourier_picture_watermark, _none_
#@gimp : Relative size = float(0.2,0.1,0.5)
#@gimp : Sep = separator()
#@gimp : Note = note("Note : To make the watermark visible afterwards, use the 'Fourier Analysis' filter. ")
gimp_fourier_picture_watermark :
-resize_ratio2d[0] {@{1,w}*$1},{@{1,h}*$1} -to_gray[0] -threshold[0] 127
-watermark_fourier2 -c 0,255
watermark_fourier2 :
-fft[-1] -shift[-2,-1] 50%,50%,0,0,2
[0],[0],1,{s}
-image[-3,-2] [-1],3,3,0,0,1,[0]
-mirror[0] x
-image[-3,-2] [-1],{@{-2,w}-2-@{0,w}},3,0,0,1,[0]
-mirror[0] y
-image[-3,-2] [-1],{@{-2,w}-2-@{0,w}},{@{-2,h}-2-@{0,h}},0,0,1,[0]
-mirror[0] x
-image[-3,-2] [-1],3,{@{-2,h}-2-@{0,h}},0,0,1,[0]
-mirror[0] y
-rm[-1] -shift[-2,-1] -50%,-50%,0,0,2 -ifft[-2,-1] -rm[-1]
-mv[-1] 1
-rm[0]
#@gimp Mathmap flag : mathmap_flag, mathmap_flag
#@gimp : Amp = float(0.05,0,1)
#@gimp : Len = float(5,0,50)
#@gimp : Speed = int(1,1,5)
#@gimp : Time = float(5,0,50)
mathmap_flag:
-mathmap_xy "xmath","ymath+$1*sin(pi*$2/1*(-xmath+$4*2*$3/$2))"
#@gimp Rel2ellv3 : mathmap_rel2ellv3,mathmap_rel2ellv3
mathmap_rel2ellv3:
-mathmap_xy "xmath/sqrt(1-4*(ymath/H)*(ymath/H))","ymath/sqrt(1-4*(xmath/W)*(xmath/W))"
#@gimp __
#@gimp <b>Various</b>
#@gimp Custom code (global) : gimp_custom_code, gimp_custom_code_preview(1)
#@gimp : Code = text(1,"-repeat @# -l[$>]\n\n  -to_rgb\n  --deform 20\n  -blend_edges 3\n\n-endl -done\n\n\n")
#@gimp : Sep = separator(), Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note{"<small><b>Note: </b>
#@gimp : This filter can execute any set of instructions understood by the <b>G'MIC</b> language interpreter.
#@gimp : Here, you can then test some commands before creating your own G'MIC custom commands and GIMP menu entries.\n\n
#@gimp : Please look at the documentation reference web page :</small>"}
#@gimp : Note = link("http://gmic.eu/reference.shtml")
#@gimp : Note = note{"<small>
#@gimp : to learn more about available <b>G'MIC</b> commands.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>06/14/2011</i>.</small>")
gimp_custom_code : -skip "${1=-skip ,}"
-m "_gimp_custom_code_start : $1"
-apply_channels "-_gimp_custom_code_start",$2,$3
-uncommand _gimp_custom_code_start
gimp_custom_code_preview : -skip "${1=-skip ,}"
w={w} h={h}
-l _gcp_arg="$1" -gimp_split_preview "-gimp_custom_code $_gcp_arg,${2--2}",$-1
-onfail
error_msg=@{}
-rr2d $w,$h,2,1
-gimp_print_preview "Syntax error:",,$error_msg,15,40
-endl
#@gimp Custom code (local) : gimp_custom_code, gimp_custom_code_preview(0)
#@gimp : Code = text(1,"-repeat @# -l[$>]\n\n  -to_rgb\n  --deform 20\n  -blend_edges 3\n\n-endl -done\n\n\n")
#@gimp : Sep = separator()
#@gimp : Channel(s) = choice("All","RGBA [all]","RGB [all]","RGB [red]","RGB [green]","RGB [blue]","RGBA [alpha]","YCbCr [luminance]","YCbCr [blue-red chrominances]","YCbCr [blue chrominance]","YCbCr [red chrominance]","YCbCr [green chrominance]","Lab [lightness]","Lab [ab-chrominances]","Lab [a-chrominance]","Lab [b-chrominance]","Lch [ch-chrominances]","Lch [c-chrominance]","Lch [h-chrominance]","HSV [hue]","HSV [saturation]","HSV [value]","HSI [intensity]","HSL [lightness]","CMYK [cyan]","CMYK [magenta]","CMYK [yellow]","CMYK [key]")
#@gimp : Value action = choice("None","Cut","Normalize")
#@gimp : Sep = separator(), Preview type = choice("Full","Forward horizontal","Forward vertical","Backward horizontal","Backward vertical","Duplicate horizontal","Duplicate vertical")
#@gimp : Sep = separator(), note = note{"<small><b>Note: </b>
#@gimp : This filter can execute any set of instructions understood by the <b>G'MIC</b> language interpreter.
#@gimp : Here, you can then test some commands before creating your own G'MIC custom commands and GIMP menu entries.\n\n
#@gimp : Please look at the documentation reference web page :</small>"}
#@gimp : Note = link("http://gmic.eu/reference.shtml")
#@gimp : Note = note{"<small>
#@gimp : to learn more about available <b>G'MIC</b> commands.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>06/14/2011</i>.</small>")
#@gimp Games &amp; demos : gimp_gmic_demos, gimp_gmic_demos_preview
#@gimp : Selection = choice("2048","Blobs editor","Bouncing balls","Fire effect","Fireworks","Fish-eye effect","Fourier filtering",
#@gimp : "Histogram","Hough transform","Jawbreaker","The Game of Life","Light effect","Mandelbrot explorer","3d Metaballs","Minesweeper",
#@gimp : "Minimal path","Pacman","Paint","Plasma effect","RGB Quantization","3d reflection","3d rubber object","Shadebobs","Spline editor",
#@gimp : "Tetris","Tic-Tac-Toe","3d waves","Fractal whirl")
#@gimp : Sep = separator()
#@gimp : Note = note("<small><b>Note:</b> This filter proposes a showcase of some interactive demos, all written as G'MIC scripts.
#@gimp : </small>")
#@gimp : Note = note{"<small>On most demos, you can use the keyboard shortcut <b>CTRL+D</b> to double the window size (and <b>CTRL+C</b> to go back to the original size).
#@gimp : Also, feel free to use the mouse buttons, as they are often used to perform an action.
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>09/10/2014</i>.</small>")
gimp_gmic_demos :
coms=2048,blobs,bouncing,fire,fireworks,fisheye,fourier,histogram,hough,jawbreaker,life,light,\
mandelbrot,metaballs3d,minesweeper,minimal_path,pacman,paint,plasma,quantize_rgb,reflection3d,\
rubber3d,shadebobs,spline,tetris,tictactoe,waves,whirl
com=@{-arg\ {1+$1},$coms}
-if {@#>0} sel=0 -else sel= -endif
--l[$sel] -m "foo : -x_"$com -foo -rm -uncommand foo -endl
gimp_gmic_demos_preview :
-rm filename=@{-path_tmp}/gmic_demos.cimgz
-if $filename $filename
-else -l[] http://gmic.eu/img/gmic_demos.cimgz -o $filename -endl
-endif
-k[$1,-1] -rows[-1] $1 -map[0] [1] -k[0]
#@gimp Histogram analysis : _none_, gimp_display_histogram(1)
#@gimp : Clusters = int(256,2,256)
#@gimp : Luminance only = bool(0)
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_display_histogram :
-to_rgb -if $2 -luminance -endif
-repeat @#
-display_histogram[-1] {w},{h},$1,0,255
-mv[-1] 0 -done
#@gimp Import 16bit image : gimp_import_image_16, gimp_import_image_16
#@gimp : Note = note("Filter can be used to import and adjust 16 bit images to Gimp. Plugin may have limited set of import formats available depending on compilation. At minimum only .png should work reliably.")
#@gimp : Note = note("1. Create new empty image to Gimp")
#@gimp : Note = note("2. Open G'Mic from filters menu")
#@gimp : Note = note("3. Set G'Mic output to "new layers")
#@gimp : Note = note("4. Select 16 bit image from folder")
#@gimp : Note = note("5. Make adjustments using sliders")
#@gimp : Note = note("6. Image will be outputted to Gimp")
#@gimp : Note = note("By default a scaled down image is processed. Before processing full size disable preview window from gui.")
#@gimp : Note = note("LAB adjustment often yields more aesthetic results than RGB adjustment.")
#@gimp : Input image = file()
#@gimp : Process selection = choice(1,"Preview Only", "Histogram", "Logarithmic Histogram", "Full resolution")
#@gimp : Gamma = float(2.2,0,5)
#@gimp : Sep = separator(), Note = note("LAB adjustment")
#@gimp : Brightness = float(0,-1,1)
#@gimp : Contrast = float(1,0,3)
#@gimp : Equalize = float(0,0,1)
#@gimp : Saturation = float(0,-1,10)
#@gimp : A(r-g) = float(0,-1,1)
#@gimp : B(y-b) = float(0,-1,1)
#@gimp : Sep = separator(), Note = note("RGB cut and normalize histogram by percentage")
#@gimp : Cut high light values = float(100,0,100)
#@gimp : Cut dark values = float(0,0,100)
#@gimp : Sep = separator(), note = note("<small>Author: <i>Arto Huotari;</i>.      Latest update: <i>2014/04/02</i>.</small>")
gimp_import_image_16 :
ProcessTo=$2
Gamma=$3
Brightness=$4
Contrast=$5
Equalize=$6
AB=$7
A=$8
B=$9
CutHigh=$10
CutLow=$11
-rm -i
"$1"
-to_rgb
-if {$ProcessTo!=3}
-resize2dx 520,1
-endif
-apply_gamma $Gamma
-if {@{0,M}>256}
-if $Equalize
--equalize 65535
-blend alpha,{$Equalize/2}
-endif
#Scale values to 0 to 1 range
-div 65535
#Separate luminance from colour
-rgb2lab
-split c
-if $Brightness
-add[-3] $Brightness
-endif
-if {$Contrast!=1}
-mul[-3] $Contrast
-endif
#Adjust saturation by multiplying both A and B channels
-if $AB
-mul[-2] $AB
-mul[-1] $AB
-endif
#Adjust colour balance by multiplying A or B channel.
-if $A
-mul[-2] {1+$A}
-endif
-if $B
-mul[-1] {1+$B}
-endif
-append c
-lab2rgb
#RGB cut and normalize
-if {$CutHigh!=100" || "$CutLow!=0}
Range=1
HighValue={$CutHigh/100*$Range}
LowValue={$CutLow/100*$HighValue}
-cut $LowValue,$HighValue
-normalize 0,1
-endif
#Scale to 255 for Gimp
-mul 255
#Cut 0,255 for Gimp
-cut 0,255
-if {$ProcessTo==1}
--display_histogram @{0,w},@{0,h},255,0,254,0
-blend lighten,0.7
-endif
-if {$ProcessTo==2}
--display_histogram @{0,w},@{0,h},255,0,254,0,log(1+i)-1
-blend lighten,0.7
-endif
-endif
#@gimp Import data : gimp_import_image, gimp_no_preview
#@gimp : Filename = file()
#@gimp : Normalize = bool(1)
#@gimp : Note = note{"\n<small><b>Note: </b>
#@gimp : This filter can import any image data read by the <b>G'MIC</b> language interpreter.
#@gimp : It includes exotic formats as : <i>Pandore, CImg, Inrimage, AVI/MPEG (requires FFMPEG installed), ...</i>
#@gimp : </small>"}
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>12/29/2010</i>.</small>")
gimp_import_image :
-rm -i "$1" -s z -if $2 -n 0,255 -else -c 0,255 -endif
#@gimp Solve maze : gimp_solve_maze, gimp_solve_maze_preview(1)
#@gimp : Starting x-coord = float(5,0,100)
#@gimp : Starting y-coord = float(5,0,100)
#@gimp : Ending x-coord = float(95,0,100)
#@gimp : Endind y-coord = float(95,0,100)
#@gimp : Smoothness = float(0.1,0,1)
#@gimp : Thickness = int(3,1,10)
#@gimp : Color = color(255,0,0)
#@gimp : Maze type = choice("Dark walls","White walls")
#@gimp : Sep = separator(), note = note("<small>Author: <i>David Tschumperl&#233;</i>.      Latest update: <i>09/01/2011</i>.</small>")
gimp_solve_maze :
-repeat @#
--norm[-1] ->=[-1] 50%
-if {!$10} -negative[-1] -endif
-*[-1] 255 --b[-1] $5% -*[-2] 1e10 -+[-2,-1]
-minimal_path[-1] $1%,$2%,0,$3%,$4%,0
-pointcloud[-1] 0 -dilate[-1] $6 -r[-1] [-2],[-2],1,1,0
-to_rgba[-1]
-replace_color[-1] 0,0,1,1,1,255,${7-9},255
-replace_color[-1] 0,0,0,0,0,255,0,0,0,0
-ellipse[-1] $1%,$2%,5,5,0,1,${7-9},255
-ellipse[-1] $3%,$4%,5,5,0,1,${7-9},255
-rv[-2,-1]
-mv[-2,-1] 0 -done
gimp_solve_maze_preview :
-drgba
-line $1%,$2%,$3%,$4%,1,0xCCCCCCCC,${7-9}
-ellipse $1%,$2%,3,3,0,1,${7-9}
-ellipse $1%,$2%,3,3,0,1,0x1,0
-ellipse $3%,$4%,3,3,0,1,${7-9}
-ellipse $3%,$4%,3,3,0,1,0x1,0
gmicol_logo_en :
-gimp_logo_version{round(?(0.5,3.49))} "    - Online -\n    "[" "@{-strver}" "]
gmicol_adjust_colors :
-repeat @# -l[$>]
avg={ia} -- $avg -* $1 -+ $avg
-+ {$2*256}
-if {$3!=1} -apply_gamma {10^$3} -endif
-if {$4%360}
-to_colormode {max(3,s)+1-s%2} -split_opacity -l[0]
-rgb2hsv -sh 0,0 -+[-1] $4 -%[-1] 360 -rm[-1] -hsv2rgb
-endl
-a c -endif
-endl -done -c 0,255
gmicol_adjust_colors_preview :
-gimp_split_preview "-gmicol_adjust_colors $*",$-1
gmicol_crop :
-z $1%,$2%,$3%,$4%
gmicol_crop_preview :
-rectangle $1%,$2%,$3%,$4%,0.5,128
-rectangle $1%,$2%,$3%,$4%,1,0xFFFFFFFF,0
-circle $1%,$2%,3,1,0,255,0 -circle $1%,$2%,3,1,0xFFFFFFFF,0
-circle $3%,$2%,3,1,0,255,0 -circle $3%,$2%,3,1,0xFFFFFFFF,0
-circle $3%,$4%,3,1,0,255,0 -circle $3%,$4%,3,1,0xFFFFFFFF,0
-circle $1%,$4%,3,1,0,255,0 -circle $1%,$4%,3,1,0xFFFFFFFF,0
gmicol_equalize :
-apply_channels "-equalize 256,0,255",$1,2
gmicol_equalize_preview :
-gimp_split_preview "-gmicol_equalize $*",$-1
gmicol_flip :
-if $1 -mirror y -else -mirror x -endif
gmicol_histogram :
-to_rgb -dh 640,480,$1
gmicol_histogram_preview :
-to_rgb -dh 320,240,$1
gmicol_resize :
-if {$1==0}
-r $2%,$2%,1,100%,6
-elif {$1==1}
-resize2dx $3,6
-else
-resize2dy $4,6
-endif
-c 0,255
gmicol_rotate :
-if $2
-rotate {90*round($1/90)},0,0
-else
-to_rgba -rotate $1,1,$3
-endif
_gmicol_rgb_distribution :
-distribution3d -colorcube3d -p3d[-1] 1 -+3d
-repeat 4
--snapshot3d[0] $1,0.9,255
-r3d[0] 0,1,0.2,90
-done
-rm[0] -autocrop -- 255
-r @{-max_wh},1,3,0,0,0.5,0.5 -+ 255 -frame 5,5,255 -frame 1,1,0 -append_tiles ,
gmicol_rgb_distribution :
-_gmicol_rgb_distribution 512
gmicol_rgb_distribution_preview :
-_gmicol_rgb_distribution 320
gmicol_animate_elevation3d :
-_gimp_elevation3d ${2-3}
-animate gimp_render3d,"${4-5},${7-16},$6",\
"${4-5},${17-26},$6",$1
-o $_output.gif,10
-rm
gmicol_animate_elevation3d_preview :
-gimp_animate_elevation3d_preview $1,1,0,\"\",${2--1}
gmicol_animate_extrude3d :
-gimp_animate_extrude3d $1,1,0,\"\",${2--1}
gmicol_animate_extrude3d_preview :
-gimp_animate_extrude3d_preview $1,1,0,\"\",${2--1}
gmicol_animate_imageobject3d :
-gimp_animate_imageobject3d $1,1,0,\"\",${2--1}
gmicol_animate_imageobject3d_preview :
-gimp_animate_imageobject3d_preview $1,1,0,\"\",${2--1}
variance_noise :
-u {@{-std_noise}^2}
guided : -skip ${3=""}
-if {!@{-is_image_arg\ $1}} -check "$1>=0 && $2>=0"
-e[0--3] "Blur image$? using fast guided-filtering, with radius $1 and regularization $2."
-v - -repeat @# -guided[$>] [$>],$1,$2 -done
-else -check "$2>=0 && $3>=0"
-e[0--3] "Blur image$? using fast guided-filtering, with guide $1, radius $2 and regularization $3."
-v - R={1+2*round($2)}
-repeat @# -pass$1 -l[$>,-1]
-i[0] [1] -i[1] 100%,100%,1,1,1 --*[2,3] --sqr[3]
-apply_parallel[1-5] "-_guided "$R,$R",1,0" -/[2-5] [1]
--*[2,3] --[4,-1] --sqr[3] --[5,-1] -+[-1] $3 -/[-2,-1]
--*[-1] [-2] --[2,-1] -rm[-2]
-_guided[2,3] $R,$R,1,0 -/[2,3] [1] -rm[1]
-*[2] [0] -+[1,2] -k[-1]
-endl -done
-endif -v +
_guided : -check "$1>=1 && ${2=$1}>=1 && ${3=1}>=1" -skip ${4=1}
-e[^-1] "Convolve image$? by a box filter of size $1x$2x$3, with "@{-arg\ 1+!$4,neumann,dirichlet}" boundary conditions."
-v - p1={int($1/2)} p2={$1-$p1} q1={int($2/2)} q2={$2-$q1} r1={int($3/2)} r2={$3-$r1}
-repeat @# -l[$>]
-if {d!=1}
-if $4 -expand_z $r2,1 -endif
-f '>i+j(0,0,-1)' --shift 0,0,$r2,0,1 -shift[-2] 0,0,-$r1,0,1 --
-if $4 -shrink_z $r2 -endif
-endif
-if {h!=1}
-if $4 -expand_y $q2,1 -endif
-f '>i+j(0,-1)' --shift 0,$q2,0,0,1 -shift[-2] 0,-$q1,0,0,1 --
-if $4 -shrink_y $q2 -endif
-endif
-if {w!=1}
-if $4 -expand_x $p2,1 -endif
-f '>i+j(-1)' --shift $p2,0,0,0,1 -shift[-2] -$p1,0,0,0,1 --
-if $4 -shrink_x $p2 -endif
-endif
-endl -done -v +
cumul : -cumulate -skip 1
cumulate :
-e[^-1] "Cumulate values in image$? [compatibility function]."
-v -
({'"$1"'}) axes=@-1 -f[-1] if((i>={'x'}&&i<={'z'})||i=={'c'},1,0) is_axis_argument={im} -rm[-1]
-if $is_axis_argument
-repeat {narg($axes)}
axis={arg(1+$>,$axes)}
-if {$axis=={'x'}} -f '>i+j(-1)'
-elif {$axis=={'y'}} -f '>i+j(0,-1)'
-elif {$axis=={'z'}} -f '>i+j(0,0,-1)'
-elif {$axis=={'c'}} -f '>i+j(0,0,0,-1)'
-endif
-done
-else -noarg -repeat @# -l[$>] whds={w},{h},{d},{s} -y x -f '>i+j(-1)' -r $whds,-1 -endl -done
-endif
-v +
threshold2 : -ir $*
t2 : -ir $*
gimp_split_freq :
-repeat @#
--b[-1] $1 --[-2] [-1] -/[-2] 2 -+[-2] 128 -rv[-2,-1]
-mv[-2,-1] 0 -done
gimp_compose_freq :
-repeat {int(@#/2)}
--[-1] 128 -*[-1] 2 -+[-2,-1] -c[-1] 0,255
-mv[-1] 0 -done
blend_shapeaverage : -blend shapeaverage0
compose_alpha :
-e[^-1] "Compose image$? two-by-two, using alpha blending."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-r[-1] [-2],[-2],[-2],100%,0,0,0.5,0.5
-to_colormode[-2] {a1=!(@{-2,s}%2);a2=!(s%2);max(@{-2,s}-a1,s-a2)+a1}
-to_colormode[-1] {a=max(@{-2,s},s);a+(a%2)}
-if {@{-2,s}==2||@{-2,s}==4}
-_compose_alpha[-2] -_compose_alpha[-1]
-sh[-1] {s-1},{s-1} --*[-3,-1] -rm[-2] -+[-3,-2] --[-2,-1]
-sh[-1] 0,{s-2} -sh[-2] {@{-2,s}-1},{@{-2,s}-1}
-max[-1] 1e-10 -/[-2] [-1] -*[-1] 255 -rm[-2,-1]
-else
-sh[-1] 0,{s-2} -sh[-2] {@{-2,s}-1},{@{-2,s}-1} --[-2] [-4] -*[-2,-1] -/[-1] 255 -rm[-1] -+[-2,-1]
-endif
-endl -done -c 0,255 -v +
_compose_alpha :
-sh[-1] 0,{s-2} -sh[-2] {@{-2,s}-1},{@{-2,s}-1} -max[-1] 1e-10 -/[-1] 255 -*[-2,-1] -rm[-1]
compose_average :
-e[^-1] "Compose image$? two-by-two, using average mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -+
-endl -done -/ 2 -v +
compose_colorburn :
-e[^-1] "Compose image$? two-by-two, using colorburn mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 --[-2] 255 -+[-1] 0.1 -/
-endl -done -* 256 -+ 255 -c 0,255 -v +
compose_darken :
-e[^-1] "Compose image$? two-by-two, using darken mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -min
-endl -done -v +
compose_difference :
-e[^-1] "Compose image$? two-by-two, using difference mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 --
-endl -done -abs -v +
compose_divide :
-e[^-1] "Compose image$? two-by-two, using divide mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -*[-2] 256 -+[-1] 1 -/
-endl -done -c 0,255 -v +
compose_dodge :
-e[^-1] "Compose image$? two-by-two, using dodge mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 --[-1] 255.1 -/
-endl -done -* -256 -c 0,255 -v +
compose_edges : -check {$1>=0}
-e[^-1] "Compose image$? using edge mode, with smoothness $1."
-if {@#>1} -v - -to_rgb -r[^0] [0],0,0,0.5,0.5 -repeat @# -l[$>]
--gradient_norm -+[-1] 1 -b[-1] $1 -n[-1] 1,10 -sqr[-1] -s[-2] c -*[-4--2] [-1] -a[-4--1] c
-endl -done -r[^0] [0],0,0,0.5,0.5 -+ -s[-1] c -/[-4--2] [-1] -rm[-1] -a[-3--1] c -v + -endif
compose_exclusion :
-e[^-1] "Compose image$? two-by-two, using exclusion mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 --*[-2] [-1] -/[-1] -128 -+
-endl -done -v +
compose_fade :
-e[^-1] "Compose image$? using fading mode."
-v - -r[^0] @{-max_whd},100%,3
-r[1--2] 100%,100%,100%,@{-max_s} -channels[-1] 0
-repeat {@#-1} ---[-1] $> -abs[-1] --[-1] 1 -*[-1] -1 -max[-1] 0 -*[$>,-1] -done
-rm[-1] -+ -v +
compose_freeze :
-e[^-1] "Compose image$? two-by-two, using freeze mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 --[-2] 255 -sqr[-2] -+[-1] 0.1 -/
-endl -done -- 255 -* -1 -c 0,255 -v +
compose_grainextract :
-e[^-1] "Compose image$? two-by-two, using grain extract mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 --
-endl -done -+ 128 -c 0,255 -v +
compose_grainmerge :
-e[^-1] "Compose image$? two-by-two, using grain merge mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -+
-endl -done -- 128 -c 0,255 -v +
compose_hardlight :
-e[^-1] "Compose image$? two-by-two, using hard light mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5
--ge[-1] 128 --*[-3] [-2] -/[-1] 128
--[-4,-3] 255 -*[-4,-3] -/[-3] 128 --[-3] 255 -*[-3] -1
-*[-3] [-2] -*[-2] -1 -+[-2] 1 -*[-2,-1] -+
-endl -done -v +
compose_hue :
-e[^-1] "Compose image$? two-by-two, using hue mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -to_rgba -sh 0,2
-rgb2hsv[-2,-1] -sh[-2] 0,0 -j[-2] [-1] -rm[-5,-3,-1] -hsv2rgb[-1] -rm[-1]
-endl -done -v +
compose_interpolation :
-e[^-1] "Compose image$? two-by-two, using interpolation mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -* 0.012271846 -cos -/ -4 -+
-endl -done -+ 0.5 -* 256 -v +
compose_lighten :
-e[^-1] "Compose image$? two-by-two, using lighten mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -max
-endl -done -v +
compose_lightness :
-e[^-1] "Compose image$? two-by-two, using lightness mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -to_rgba -sh 0,2
-rgb2lab[-2,-1] -sh[-2] 0,0 -j[-2] [-1],0,0,0,0 -rm[-5,-3,-1] -lab2rgb[-1] -rm[-1]
-endl -done -v +
compose_luminance :
-e[^-1] "Compose image$? two-by-two, using luminance mode."
-v - -repeat {int(@#/2)}
-to_colormode[-2,-1] 0 -r[-1] [-2],0,0,0.5,0.5 -to_rgba[-2,-1] -sh[-2,-1] 0,2
-rgb2ycbcr[-2,-1] -sh[-2] 0,0 -j[-2] [-1],0,0,0,0 -rm[-5,-3,-1] -ycbcr2rgb[-1] -rm[-1]
-mv[-1] 0 -done -v +
compose_median :
-e[^-1] "Compose image$? using median mode."
-if {@#==1} -return -endif
-v - -r[^0] [0],0,0,0.5,0.5 -a z -permute zxyc -s y,-64
-repeat @# -l[$>]
-r 100%,{w*100}%
-s z -median {w} w={w} -columns {int(w/2)} -r 1,{h/$w} -a z
-endl -done -a y -permute yzxc -v +
compose_multiply :
-e[^-1] "Compose image$? two-by-two, using multiply mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -*
-endl -done -/ 255 -v +
compose_negation :
-e[^-1] "Compose image$? two-by-two, using negation mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -+
-endl -done -- 255 -abs -- 255 -* -1 -v +
compose_overlay :
-e[^-1] "Compose image$? two-by-two, using overlay mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5
--ge[-2] 128
--*[-3] [-2] -/[-1] 128
--[-4,-3] 255 -*[-4,-3] -/[-3] 128 --[-3] 255 -*[-3] -1
-*[-3] [-2] -*[-2] -1 -+[-2] 1 -*[-2,-1] -+
-endl -done -v +
compose_reflect :
-e[^-1] "Compose image$? two-by-two, using reflect mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -sqr[-2] --[-1] 255.1 -/
-endl -done -* -1 -c 0,255 -v +
compose_rgba :
-e[^-1] "Compose image$? two-by-two, using alpha blending."
-v - -to_rgb[0--1:2] -compose_alpha -v +
compose_saturation :
-e[^-1] "Compose image$? two-by-two, using saturation mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -to_rgba -sh 0,2
-rgb2hsv[-2,-1] -sh[-2] 1,1 -j[-2] [-1],0,0,0,1 -rm[-5,-3,-1] -hsv2rgb[-1] -rm[-1]
-endl -done -v +
compose_screen :
-e[^-1] "Compose image$? two-by-two, using screen mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -- 255 -*
-endl -done -/ 256 -- 255 -* -1 -v +
compose_shapeaverage :
-e[^-1] "Compose image$? two-by-two, using shape average mode."
-v - -repeat {int(@#/2)} -l[-2,-1] nm=@{0,n}
-channels[-1] 0 -ge[-1] 50% -label_fg[-1] 0 nb={iM+1} -*[-1] 256
-rv[-2,-1] m={im} M={iM} -n[-1] 0,255 -s[-1] c -+[^0] [0]
-repeat {@#-1}
-histogram[-1] {$nb*256},0,{$nb*256-1}
-i[-2] 256,1,1,1,'x' -r[-2] {w},1,1,1,0,2 -*[-2] [-1] -r[-2,-1] $nb,1,1,1,2 -max[-1] 1 -/[-2,-1]
-mv[-1] 1 -done
-/[0] 256 -a[^0] c -*[-1] {($M-$m)/256} -+[-1] $m -point[-1] 0,0,0,1,0 -map[0] [-1] -rm[-1]
-nm $nm,1 -endl -mv[-1] 0 -done -v +
compose_softlight :
-e[^-1] "Compose image$? two-by-two, using soft light mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -/ 256 --*[-2] [-1] -*[-1] 2 -sqr[-3] -*[-2] [-3] -*[-2] -2 -+
-endl -done -* 256 -v +
compose_stamp :
-e[^-1] "Compose image$? two-by-two, using stamp mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -*[-1] 2 -+
-endl -done -- 255 -c 0,255 -v +
compose_value :
-e[^-1] "Compose image$? two-by-two, using value mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -to_rgba -sh 0,2
-rgb2hsv[-2,-1] -sh[-2] 2,2 -j[-2] [-1],0,0,0,2 -rm[-5,-3,-1] -hsv2rgb[-1] -rm[-1]
-endl -done -v +
compose_xor :
-e[^-1] "Compose image$? two-by-two, using xor mode."
-v - -repeat {int(@#/2)} -l[$>,{$>+1}]
-to_colormode 0 -r[-1] [-2],0,0,0.5,0.5 -xor
-endl -done -v +
_gimp_compose :
-repeat {int(@#/2)} --compose_$1[-2,-1] -rm[-3] -to_rgba[-1] -sh[-1] 3,3 -*[-1] $2 -rm[-1] -compose_alpha[-2,-1] -mv[-1] 0 -done
_gimp_revert_layers :
-repeat {int(@#/2)} -rv[{2*$>},{2*$>+1}] -done
gimp_compose_alpha :
-if ${2=0} -_gimp_revert_layers -endif
-repeat {int(@#/2)}
-to_rgba[-1] -sh[-1] 3,3 -*[-1] $1 -rm[-1]
-compose_alpha[-2,-1]
-mv[-1] 0 -done
gimp_compose_average :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose average,$1
gimp_compose_colorburn :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose colorburn,$1
gimp_compose_darken :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose darken,$1
gimp_compose_difference :
-if ${2=0} -_gimp_revert_layers -endif
-to_rgb -_gimp_compose difference,$1
gimp_compose_divide :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose divide,$1
gimp_compose_dodge :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose dodge,$1
gimp_compose_edges :
-if ${3=0} -_gimp_revert_layers -endif
-repeat {int(@#/2)} --compose_edges[-2,-1] $2 -rm[-3] -to_rgba[-1] -sh[-1] 3,3 -*[-1] $1 -rm[-1] -compose_alpha[-2,-1] -mv[-1] 0 -done
gimp_compose_exclusion :
-if ${2=0} -_gimp_revert_layers -endif
-to_rgb -_gimp_compose exclusion,$1
gimp_compose_fade :
-if {@#==1} -return -endif
-to_colormode 4
-if {$1==0} [0],[0],1,1,"$10"
-else -_gimp_compose_fade$1 $7,$8,$9 -r[-1] [0],[0],1,1,3
-endif
-n[-1] {-(@#-2)*$3},{(@#-2)*(1+$3)}
--[-1] {$2*(1+$3)*(@#-2)}
-c[-1] 0,{@#-2}
-if $6 -rv[^-1] -endif
-if $5 -round[-1] 1
-else -roundify[-1] $4
-endif
-compose_fade
-c 0,255
_gimp_compose_fade1 : [0],[0],1,1,"a=$1*pi/2; x*cos(a) + y*sin(a)"
_gimp_compose_fade2 : [0],[0],1,1,0 -=[-1] 1,{($1+1)*50}%,{($2+1)*50}% -distance[-1] 1
_gimp_compose_fade3 : [0],[0],1,1,0 -=[-1] 1,{($1+1)*50}%,{($2+1)*50}% -distance[-1] 1 -*[-1] {0.01+$3/2} -cos[-1]
_gimp_compose_fade4 : [0],[0],1,1,"((x-w*($1+0.5))*(y-h*($2+0.5)))%(0.2*w*h*(1.001+$3))"
gimp_compose_freeze :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose freeze,$1
gimp_compose_grainextract :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose grainextract,$1
gimp_compose_grainmerge :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose grainmerge,$1
gimp_compose_hardlight :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose hardlight,$1
gimp_compose_hue : -skip ${2=0}
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose hue,$1
gimp_compose_interpolation :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose interpolation,$1
gimp_compose_lighten :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose lighten,$1
gimp_compose_lightness : -skip ${2=0}
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose lightness,$1
gimp_compose_luminance : -skip ${2=0}
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose luminance,$1
gimp_compose_multiply :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose multiply,$1
gimp_compose_negation :
-if ${2=0} -_gimp_revert_layers -endif
-to_rgb -_gimp_compose negation,$1
gimp_compose_overlay :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose overlay,$1
gimp_compose_reflect :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose reflect,$1
gimp_compose_saturation : -skip ${2=0}
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose saturation,$1
gimp_compose_screen :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose screen,$1
gimp_compose_shapeaverage :
-if ${3=0} -_gimp_revert_layers -endif
-to_rgb
-repeat {int(@#/2)}
-rv[-2,-1]
-if $1 -i[0] [-1] -endif
-compose_shapeaverage[-2,-1]
-if $1 -*[0,-1] -/[0] 255 -mv[0] @# -endif
-if $2 -to_rgba[-1] -replace_color[-1] 0,0,0,0,0,255,0,0,0,0 -endif
-mv[-1] 0 -done
gimp_compose_softlight :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose softlight,$1
gimp_compose_stamp :
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose stamp,$1
gimp_compose_value : -skip ${2=0}
-if ${2=0} -_gimp_revert_layers -endif
-_gimp_compose value,$1
gimp_compose_xor :
-if ${2=0} -_gimp_revert_layers -endif
-to_rgb -_gimp_compose xor,$1
resize2x :
-scale2x
resize3x :
-scale3x
apply_channels_old : -skip ${3=0}
-if {{$2'=='all}" || "{$2'=='0}}
-e[^-1] "Apply command '$1' on image$?." -v -
-repeat @# -l[$>]
-_apply_channels_old "$1"
-if {$3==1} -c 0,255 -elif {$3==2} -n 0,255 -endif
-endl -done
-elif {{$2'=='rgba}" || "{$2'=='1}}
-e[^-1] "Apply command '$1' on RGBA channels of image$?." -v -
-to_rgba -repeat @# -l[$>]
-_apply_channels_old "$1"
-if {$3==1} -c 0,255 -elif {$3==2} -n 0,255 -endif
-endl -done
-elif {{$2'=='rgb}" || "{$2'=='2}}
-e[^-1] "Apply command '$1' on RGB channels of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0]
-_apply_channels_old[0] "$1"
-if {$3==1} -c[0] 0,255 -elif {$3==2} -n[0] 0,255 -endif
-to_rgb[0]
-a c
-endl -done
-elif {{$2'=='y}" || "{$2'=='3}}
-e[^-1] "Apply command '$1' on luminance Y of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2ycbcr[0] -s[0] c
-_apply_channels_old[0] "$1" -channels[0] 0
-if {$3==1} -c[0] 0,255 -elif {$3==2} -n[0] 0,255 -endif
-a[0-2] c -ycbcr2rgb[0] -a c
-endl -done
-elif {{$2'=='cbcr}" || "{$2'=='4}}
-e[^-1] "Apply command '$1' on blue and red chrominances CbCr of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2ycbcr[0] -s[0] c -a[1,2] c
-_apply_channels_old[1] "$1" -channels[1] 0,1
-if {$3==1} -c[1] 0,255 -elif {$3==2} -n[1] 0,255 -endif
-a[0-1] c -ycbcr2rgb[0] -a c
-endl -done
-elif {{$2'=='cb}" || "{$2'=='5}}
-e[^-1] "Apply command '$1' on blue chrominance Cb of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2ycbcr[0] -s[0] c
-_apply_channels_old[1] "$1" -channels[1] 0
-if {$3==1} -c[1] 0,255 -elif {$3==2} -n[1] 0,255 -endif
-a[0-2] c -ycbcr2rgb[0] -a c
-endl -done
-elif {{$2'=='cr}" || "{$2'=='6}}
-e[^-1] "Apply command '$1' on red chrominance Cr of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2ycbcr[0] -s[0] c
-_apply_channels_old[2] "$1" -channels[2] 0
-if {$3==1} -c[2] 0,255 -elif {$3==2} -n[2] 0,255 -endif
-a[0-2] c -ycbcr2rgb[0] -a c
-endl -done
-elif {{$2'=='l}" || "{$2'=='7}}
-e[^-1] "Apply command '$1' on lightness L of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2lab[0] -s[0] c
-*[0] 2.55 -_apply_channels_old[0] "$1" -channels[0] 0 -/[0] 2.55
-if {$3==1} -c[0] 0,100 -elif {$3==2} -n[0] 0,100 -endif
-a[0-2] c -lab2rgb[0] -a c
-endl -done
-elif {{$2'=='ab}" || "{$2'=='8}}
-e[^-1] "Apply command '$1' on a-b channels of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2lab[0] -s[0] c
-+[1] 86 -*[1] 1.38587 -+[2] 108 -*[2] 1.25616
-a[1,2] c -_apply_channels_old[1] "$1" -channels[1] 0,1 -s[1] c
-/[1] 1.38587 --[1] 86 -/[2] 1.25616 --[2] 108
-if {$3==2} -n[1] -86,98 -n[2] -108,95 -endif
-a[0-2] c -lab2rgb[0] -a c
-endl -done
-elif {{$2'=='a}" || "{$2'=='9}}
-e[^-1] "Apply command '$1' on a-channel of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2lab[0] -s[0] c
-+[1] 86 -*[1] 1.38587 -_apply_channels_old[1] "$1" -channels[1] 0 -/[1] 1.38587 --[1] 86
-if {$3==2} -n[1] -86,98 -endif
-a[0-2] c -lab2rgb[0] -a c
-endl -done
-elif {{$2'=='b}" || "{$2'=='10}}
-e[^-1] "Apply command '$1' on b-channel of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2lab[0] -s[0] c
-+[2] 108 -*[2] 1.25616 -_apply_channels_old[2] "$1" -channels[2] 0 -/[2] 1.25616 --[2] 108
-if {$3==2} -n[1] -108,95 -endif
-a[0-2] c -lab2rgb[0] -a c
-endl -done
-elif {{$2'=='h}" || "{$2'=='11}}
-e[^-1] "Apply command '$1' on hue H of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2hsv[0] -s[0] c
-*[0] 0.708333 -_apply_channels_old[0] "$1" -channels[0] 0 -/[0] 0.708333
-if {$3==1} -%[0] 360 -elif {$3==2} -n[0] 0,360 -endif
-a[0-2] c -hsv2rgb[0] -a c
-endl -done
-elif {{$2'=='s}" || "{$2'=='12}}
-e[^-1] "Apply command '$1' on saturation S of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2hsv[0] -s[0] c
-*[1] 255 -_apply_channels_old[1] "$1" -channels[1] 0 -/[1] 255
-if {$3==1} -c[1] 0,1 -elif {$3==2} -n[1] 0,1 -endif
-a[0-2] c -hsv2rgb[0] -a c
-endl -done
-elif {{$2'=='v}" || "{$2'=='13}}
-e[^-1] "Apply command '$1' on value V of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2hsv[0] -s[0] c
-*[2] 255 -_apply_channels_old[2] "$1" -channels[2] 0 -/[2] 255
-if {$3==1} -c[2] 0,1 -elif {$3==2} -n[2] 0,1 -endif
-a[0-2] c -hsv2rgb[0] -a c
-endl -done
-elif {{$2'=='k" || "{$2'=='14}}
-e[^-1] "Apply command '$1' on key channel K of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2cmyk[0] -s[0] c
-_apply_channels_old[3] "$1" -channels[3] 0
-if {$3==1} -c[3] 0,255 -elif {$3==2} -n[3] 0,255 -endif
-a[0-3] c -cmyk2rgb[0] -a c
-endl -done
-elif {{$2'=='cg}" || "{$2'=='15}}
-e[^-1] "Apply command(s) '$1' on green chrominance Cg of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -s[0] c -rv[1,2] -a[0-2] c -rgb2ycbcr[0] -s[0] c
-_apply_channels_old[1] "$1" -channels[1] 0
-if {$3==1} -c[1] 0,255 -elif {$3==2} -n[1] 0,255 -endif
-a[0-2] c -ycbcr2rgb[0] -s[0] c -rv[1,2] -a c
-endl -done
-elif {{$2'=='ch}" || "{$2'=='16}}
-e[^-1] "Apply command '$1' on c-h channels of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2lch[0] -s[0] c
-*[1] 2.55 -+[2] {pi} -*[2] {255/(2*pi)}
-a[1,2] c -_apply_channels_old[1] "$1" -channels[1] 0,1 -s[1] c
-/[1] 2.55 -/[2] {255/(2*pi)} --[2] {pi}
-if {$3==2} -n[1] 0,100 -n[2] -{pi},{pi} -endif
-a[0-2] c -lch2rgb[0] -a c
-endl -done
-elif {{$2'=='c}" || "{$2'=='17}}
-e[^-1] "Apply command '$1' on c-channel of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2lch[0] -s[0] c
-*[1] 2.55 -_apply_channels_old[1] "$1" -channels[1] 0 -/[1] 2.55
-if {$3==1} -c[1] 0,100 -elif {$3==2} -n[1] 0,100 -endif
-a[0-2] c -lch2rgb[0] -a c
-endl -done
-elif {{$2'=='h}" || "{$2'=='18}}
-e[^-1] "Apply command '$1' on h-channel of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -rgb2lch[0] -s[0] c
-+[2] {pi} -*[2] {255/(2*pi)} -_apply_channels_old[2] "$1" -channels[2] 0 -/[2] {255/(2*pi)} --[2] {pi}
-if {$3==2} -n[2] -{pi},{pi} -endif
-a[0-2] c -lch2rgb[0] -a c
-endl -done
-elif {{$2'=='r}" || "{$2'=='19}}
-e[^-1] "Apply command '$1' on red channel R of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -s[0] c
-_apply_channels_old[0] "$1"
-if {$3==1} -c[0] 0,255 -elif {$3==2} -n[0] 0,255 -endif
-to_gray[0]
-a c
-endl -done
-elif {{$2'=='g}" || "{$2'=='20}}
-e[^-1] "Apply command '$1' on green channel G of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -s[0] c
-_apply_channels_old[1] "$1"
-if {$3==1} -c[1] 0,255 -elif {$3==2} -n[1] 0,255 -endif
-to_gray[1]
-a c
-endl -done
-elif {{$2'=='b}" || "{$2'=='21}}
-e[^-1] "Apply command '$1' on blue channel B of image$?." -v -
-repeat @# -l[$>]
-split_opacity -to_rgb[0] -s[0] c
-_apply_channels_old[2] "$1"
-if {$3==1} -c[2] 0,255 -elif {$3==2} -n[2] 0,255 -endif
-to_gray[2]
-a c
-endl -done
-elif {{$2'=='alpha}" || "{$2'=='22}}
-e[^-1] "Apply command '$1' on alpha channel A of image$?." -v -
-repeat @# -l[$>]
-to_rgba -s c
-_apply_channels_old[3] "$1"
-if {$3==1} -c[3] 0,255 -elif {$3==2} -n[3] 0,255 -endif
-to_gray[3]
-a c
-endl -done
-endif
-v +
_apply_channels_old :
${1--1} -k[0] 